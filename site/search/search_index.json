{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u5728\u522b\u5904\u6216\u5728\u8def\u4e0a","text":"<p>Elsewhere, or on the road.</p> <p>Milan Kundera: Life is like weeds, life is elsewhere!</p> <p>Jack Kerouac: On the road, O ever youthful, O ever weeping.</p> <p></p> <p></p> <p>\u6bcf\u4e00\u4e2a\u4eba\u90fd\u9057\u61be\u4ed6\u4e0d\u80fd\u8fc7\u5176\u4ed6\u7684\u751f\u6d3b\uff0c\u6e34\u671b\u79bb\u5f00\u6b64\u5904\uff0c\u5411\u5f80\u8fdc\u65b9\u522b\u5904\u3002 \u4f60\u4e5f\u4f1a\u60f3\u8fc7\u4e00\u8fc7\u4f60\u6240\u6709\u672a\u5b9e\u73b0\u7684\u53ef\u80fd\u6027\uff0c\u4f60\u6240\u6709\u53ef\u80fd\u7684\u751f\u6d3b\u3002</p> <p>\u201c\u6211\u7684\u8eab\u4f53\u5728\u8fd9\u91cc\uff0c\u53ef\u5fc3\u5b83\u8eb2\u5728\u54ea\u91cc\uff1f\u6bcf\u5929\u5e7b\u60f3\u7684\u81ea\u5df1\uff0c\u603b\u5728\u53e6\u4e00\u4e2a\u5730\u65b9\u3002\u201d \u201c\u6b64\u5904\u5f88\u7f8e\uff0c\u4f46\u4f60\u5374\u6d51\u7136\u4e0d\u77e5.......\u7136\u540e\uff0c\u7ee7\u7eed\u5bfb\u627e\u65b0\u7684\u522b\u5904\uff0c\u6c38\u4e0d\u6ee1\u8db3\u3002\u201d</p> <p>\u5e26\u7740\u6700\u521d\u7684\u6fc0\u60c5\uff0c\u8ffd\u5bfb\u7740\u6700\u521d\u7684\u68a6\u60f3\uff0c\u611f\u53d7\u7740\u6700\u521d\u7684\u4f53\u9a8c\uff0c\u6211\u4eec\u4e0a\u8def\u5427\u3002 \u6211\u4e0d\u5047\u601d\u7d22\u5730\u4e0a\u8def\uff0c\u56e0\u4e3a\u51fa\u53d1\u7684\u611f\u89c9\u592a\u597d\u4e86\uff0c\u4e16\u754c\u7a81\u7136\u5145\u6ee1\u4e86\u53ef\u80fd\u6027\u3002</p> <p>\u5728\u8def\u4e0a\uff0c\u6211\u4eec\u6c38\u8fdc\u5e74\u8f7b\uff0c\u6c38\u8fdc\u70ed\u6cea\u76c8\u7736\uff0c\u6c38\u8fdc\u6ee1\u6000\u61a7\u61ac\u3002 \u6700\u597d\u7684\u65c5\u884c\uff0c\u662f\u5728\u964c\u751f\u7684\u5730\u65b9\uff0c\u53d1\u73b0\u4e86\u4e00\u79cd\u4e45\u8fdd\u7684\u611f\u52a8\u3002</p> <p>\u5f53\u751f\u6d3b\u5728\u522b\u5904\u65f6\uff0c\u90a3\u662f\u68a6\u548c\u653e\u9010\uff0c\u662f\u8bd7\u548c\u8fdc\u65b9\uff1b \u800c\u5f53\u522b\u5904\u4e00\u65e6\u53d8\u4e3a\u6b64\u5904\uff0c\u5d07\u9ad8\u611f\u968f\u5373\u88ab\u73b0\u5b9e\u6d88\u89e3\u3002</p> <p>\u6bcf\u4e00\u573a\u8bf4\u8d70\u5c31\u8d70\u7684\u6fc0\u60c5\u8fc7\u540e\uff0c\u7ec8\u7a76\u56de\u5f52\u5e73\u6de1\u3002 \u5fc3\u82e5\u6ca1\u6709\u6816\u606f\u5730\uff0c\u5728\u54ea\u513f\u90fd\u662f\u6d41\u6d6a\u3002</p> <p>home | less 1 &gt; elsewhere 2 &gt; homeless</p> <p>\u5317\u5b8b\u00b7\u82cf\u8f7c\u300a\u5b9a\u98ce\u6ce2\u00b7\u5357\u6d77\u5f52\u8d60\u738b\u5b9a\u56fd\u4f8d\u4eba\u5bd3\u5a18\u300b</p> <p>\u4e07\u91cc\u5f52\u6765\u989c\u6108\u5c11\u3002 \u5fae\u7b11\uff0c\u7b11\u65f6\u72b9\u5e26\u5cad\u6885\u9999\u3002 \u8bd5\u95ee\u5cad\u5357\u5e94\u4e0d\u597d\uff0c \u5374\u9053\uff1a\u6b64\u5fc3\u5b89\u5904\u662f\u543e\u4e61\u3002</p> <p></p> <p>\u672c\u7ad9\u603b\u8bbf\u95ee\u91cf pv\uff0c\u603b\u8bbf\u5ba2\u6570 uv\u3002</p>"},{"location":"about/","title":"About","text":""},{"location":"about/#\u5173\u4e8e\u6211","title":"\u5173\u4e8e\u6211","text":""},{"location":"about/#\u66fe\u7ecf\u7684\u6211","title":"\u66fe\u7ecf\u7684\u6211","text":"<p>\u90a3\u4e00\u5e74\uff0c\u4f60\u6b63\u5e74\u8f7b\u2026</p>"},{"location":"about/#\u73b0\u5728\u7684\u6211","title":"\u73b0\u5728\u7684\u6211","text":"<p>\u6d41\u5e74\u554a\uff0c\u4f60\u5948\u6211\u4f55\u2026</p>"},{"location":"about/#\u672a\u6765\u7684\u6211","title":"\u672a\u6765\u7684\u6211","text":"<p>\u5728\u522b\u5904\uff0c\u6216\u5728\u8def\u4e0a\u2026</p>"},{"location":"about/#\u5173\u4e8e\u5979","title":"\u5173\u4e8e\u5979","text":"<p>\u6211\u5df2\u5a5a\uff0c \u5979\u5df2\u5ac1\u3002</p>"},{"location":"about/#\u5173\u4e8e\u5bb6","title":"\u5173\u4e8e\u5bb6","text":"<p>\u6211\uff0c\u6211\u5988\u3002 \u5979\uff0c\u5979\u7238\uff0c\u5979\u5988\u3002 \u4e00\u4e2a8\u5c81\u7684\u513f\u5b50\u3002</p>"},{"location":"about/#\u5173\u4e8e\u6d3b","title":"\u5173\u4e8e\u6d3b","text":"<p>\u7231\u7f16\u7a0b\uff0c\u7231\u5409\u4ed6\u3002 \u751f\u5b58\u4ee5\u4e0a\uff0c\u751f\u6d3b\u4ee5\u4e0b\u3002</p> <p>\u6211\u4eec\u90fd\u5728\u5b64\u5c9b\u6c42\u751f\uff0c\u4f46\u6ca1\u6709\u4eba\u662f\u4e00\u5ea7\u5b64\u5c9b\u3002</p>"},{"location":"link/","title":"Link","text":"<p>Henry D. Thoreau, Walden</p> <p>One value even of the smallest well is, that when you look into it you see that earth is not continent but insular.</p> <ul> <li> <p> \u6811\u4e0b</p> <p>\u57fa\u4e8e flarum \u7684\u4e2a\u4eba\u8bba\u575b  shuxia</p> </li> <li> <p> \u5982\u6b4c</p> <p>\u6587\u827a\u9752\u5e74\u5728\u7ebf\u4e50\u5e93  awayto.top shuxia</p> </li> <li> <p> \u5f26\u82e6</p> <p> CSDN\u6545\u7eb8\u5806</p> </li> </ul> <p>John Donn, No Man Is An Island</p> <p>No man is an island, entire of itself; every man is a piece of the continent, a part of the main;</p>"},{"location":"blog/","title":"Blog","text":""},{"location":"blog/20211002/c-abstract-state-machine/","title":"C Data Types - Abstract State Machine","text":"<p>C programs run in an abstract state machine that is mostly independent of the speci\ufb01c computer where it is launched.</p> <p>5 Basic values and data:</p> <p>We will now change our focus from \u201chow things are to be done\u201d (statements and expressions) to the things on which C programs operate: <code>values</code> and <code>data</code>. A concrete program at an instance in time has to represent values.</p> <p>Similarly, representations of values on a computer can vary \u201cculturally\u201d from architecture to architecture or are determined by the type the programmer gave to the value. Therefore, we should try to reason primarily about values and not about representations if we want to write portable code.</p> <p>TAKEAWAY 5.1</p> <p>TAKEAWAY 5.1 C programs primarily reason about values and not about their representation.</p> <p>The representation that a particular value has should in most cases not be your concern; the compiler is there to organize the translation back and forth between values and representations.</p> <p>5.1 The abstract state machine:</p> <p>To explain the abstract state machine, we \ufb01rst have to look into the concepts of a value (what state are we in), the type (what this state represents), and the representation (how state is distinguished). As the term abstract suggests, C\u2019s mechanism allows different platforms to realize the abstract state machine of a given program differently according to their needs and capacities.</p>","tags":["data_type"]},{"location":"blog/20211002/c-abstract-state-machine/#511_values","title":"5.1.1 Values","text":"<p>A value in C is an abstract entity that usually exists beyond your program, the particular implementation of that program, and the representation of the value during a particular run of the program.</p> <p>So far, most of our examples of values have been some kind of numbers. This is not an accident, but relates to one of the major concepts of C.</p> <p>TAKEAWAY 5.2</p> <p>TAKEAWAY 5.2 All values are numbers or translate to numbers.</p> <p>This property really concerns all values a C program is about, whether these are the characters or text we print, truth values, measures that we take, or relations that we investigate. Think of these numbers as mathematical entities that are independent of your program and its concrete realization.</p> <p>The data of a program execution consists of all the assembled values of all objects at a given moment.</p> <p>The state of the program execution is determined by:</p> <ul> <li>The executable</li> <li>The current point of execution</li> <li>The data</li> <li>Outside intervention, such as IO from the user</li> </ul> <p>If we abstract from the last point, an executable that runs with the same data from the same point of execution must give the same result. But since C programs should be portable between systems, we want more than that. We don\u2019t want the result of a computation to depend on the executable (which is platform speci\ufb01c) but ideally to depend only on the program speci\ufb01cation itself. An important step to achieve this platform independence is the concept of types.</p>","tags":["data_type"]},{"location":"blog/20211002/c-abstract-state-machine/#512_types","title":"5.1.2 Types","text":"<p>A type is an additional property that C associates with values. Up to now, we have seen several such types, most prominently size_t, but also double and bool.</p> <p>TAKEAWAY 5.3~5.5</p> <ul> <li>TAKEAWAY 5.3 All values have a type that is statically determined.</li> <li>TAKEAWAY 5.4 Possible operations on a value are determined by its type.</li> <li>TAKEAWAY 5.5 A value\u2019s type determines the results of all operations.</li> </ul>","tags":["data_type"]},{"location":"blog/20211002/c-abstract-state-machine/#513_binary_representation_and_the_abstract_state_machine","title":"5.1.3 Binary representation and the abstract state machine","text":"<p>Unfortunately, the variety of computer platforms is not such that the C standard can completely impose the results of the operations on a given type. Things that are not completely speci\ufb01ed as such by the standard are, for example, how the sign of a signed type is represented the (sign representation), and the precision to which a double \ufb02oating-point operation is performed (\ufb02oating-point representation). C only imposes properties on representations such that the results of operations can be deduced a priori from two different sources:</p> <ul> <li>The values of the operands</li> <li>Some characteristic values that describe the particular platform</li> </ul> <p>For example, the operations on the type <code>size_t</code> can be entirely determined when inspecting the value of SIZE_MAX in addition to the operands. We call the model to represent values of a given type on a given platform the binary representation of the type.</p> <p>TAKEAWAY 5.6</p> <p>TAKEAWAY 5.6 A type\u2019s binary representation determines the results of all operations.</p> <p>Generally, all information we need to determine that model is within reach of any C program: the C library headers provide the necessary information through named values (such as SIZE_MAX), operators, and function calls.</p> <p>TAKEAWAY 5.7</p> <p>TAKEAWAY 5.7 A type\u2019s binary representation is observable.</p> <p>This binary representation is still a model and thus an abstract representation in the sense that it doesn\u2019t completely determine how values are stored in the memory of a computer or on a disk or other persistent storage device. That representation is the object representation. In contrast to the binary representation, the object representation usually is not of much concern to us, as long as we don\u2019t want to hack together values of objects in main memory or have to communicate between computers that have different platform models. Much later, in section 12.1, we will see that we can even observe the object representation, if such an object is stored in memory and we know its address.</p> <p>As a consequence, all computation is \ufb01xed through the values, types, and their binary representations that are speci\ufb01ed in the program. The program text describes an abstract state machine C that regulates how the program switches from one state to the next. These transitions are determined by value, type, and binary representation only.</p> <p>TAKEAWAY 5.8</p> <p>TAKEAWAY 5.8 (as-if) Programs execute as if following the abstract state machine.</p> <p>Copyright clarification</p> <p>Excerpt from Modern C, 1st Edition, 2019. Copyright credit to Jens Gustedt. \ud83e\udee1 For studying only, not commercial.</p>","tags":["data_type"]},{"location":"blog/20211004/c-binary-representation/","title":"C Basic Types - Binary Representions","text":"<p>Values have a type and a binary representation.</p> <p>The binary representation of a type is a model that describes the possible values for that type. It is not the same as the in-memory object representation that describes the more or less physical storage of values of a given type.</p> <p>TAKEAWAY 5.49</p> <p>TAKEAWAY 5.49 The same value may have different binary representations.</p>","tags":["data_type","binary_representation"]},{"location":"blog/20211004/c-binary-representation/#571_unsigned_integers","title":"5.7.1 Unsigned integers","text":"<p>We have seen that unsigned integer types are those arithmetic types for which the standard arithmetic operations have a nice, closed mathematical description. They are closed under arithmetic operations:</p> <p>Unsigned wrap</p> <p>TAKEAWAY 5.50 Unsigned arithmetic wraps nicely.</p> <p>In mathematical terms, they implement a ring, \\(\\Bbb{z}\\)<sub>N</sub>, the set of integers modulo some number \\(N\\). The values that are representable are \\(0, \\ldots, N\u22121\\). The maximum value \\(N\u22121\\) completely determines such an unsigned integer type and is made available through a macro with terminating <code>_MAX</code> in the name. For the basic unsigned integer types, these are <code>UINT_MAX</code>, <code>ULONG_MAX</code>, and <code>ULLONG_MAX</code> , and they are provided through &lt;limits.h&gt;. As we have seen, the one for <code>size_t</code> is <code>SIZE_MAX</code> from &lt;stdint.h&gt;.</p> <p>The binary representation for non-negative integer values is always exactly what the term indicates: such a number is represented by binary digits \\(b_0, b_1, \\ldots, b_{p-1}\\) called bits. Each of the bits has a value of 0 or 1. The value of such a number is computed as</p> \\[ \\sum_{i=0}^{p-1}b_i\\ast2^i \\] <p>The value p in that binary representation is called the precision of the underlying type. Bit \\(b_0\\) is called the least-signi\ufb01cant bit, and LSB, \\(b_{p\u22121}\\) is the most-signi\ufb01cant bit(MSB).</p> <p>Of the bits \\(b_i\\) that are 1, the one with minimal index i is called the least-signi\ufb01cant bit set, and the one with the highest index is the most-signi\ufb01cant bit set. For example, for an unsigned type with \\(p = 16\\), the value 240 would have \\(b_4 = 1, b_5 = 1, b_6 = 1\\), and \\(b_7 = 1\\). All other bits of the binary representation are 0, the least-signi\ufb01cant bit set i is \\(b_4\\), and the most-signi\ufb01cant bit set is \\(b_7\\). From (5.1), we see immediately that \\(2^p\\) is the \ufb01rst value that cannot be represented with the type. Thus \\(N = 2^p\\) and</p> <p>TAKEAWAY 5.51</p> <p>The maximum value of any integer type is of the form \\(2^p \u2212 1\\).</p> <p>Observe that for this discussion of the representation of non-negative values, we haven\u2019t argued about the signedness of the type. These rules apply equally to signed and unsigned types. Only for unsigned types, we are lucky, and what we have said so far completely suf\ufb01ces to describe such an unsigned type.</p> <p>TAKEAWAY 5.52</p> <p>Arithmetic on an unsigned integer type is determined by its precision.</p> <p>Finally, table 5.4 shows the bounds of some of the commonly used scalars throughout this book.</p> Name [min, max] Where Typical size_t [0, SIZE_MAX] &lt;stdint.h&gt; [0, 2<sup>w</sup>\u22121], w = 32, 64 double [\u00b1DBL_MIN, \u00b1DBL_MAX ] &lt;float.h&gt; [\u00b12<sup>\u2212w\u22122</sup>, \u00b12<sup>w</sup>], w = 1024 signed [INT_MIN, INT_MAX] &lt;limits.h&gt; [\u22122<sup>w</sup>, 2<sup>w</sup> \u2212 1], w = 31 unsigned [0, UINT_MAX] &lt;limits.h&gt; [0, 2<sup>w</sup>\u22121], w = 32 bool [false, true ] &lt;stdbool.h&gt; [0, 1] ptrdiff_t [PTRDIFF_MIN, PTRDIFF_MAX ] &lt;stdint.h&gt; [\u22122<sup>w</sup>, 2<sup>w</sup>\u22121], w = 31, 63 char [CHAR_MIN, CHAR_MAX ] &lt;limits.h&gt; [0, 2^w\u22121], w = 7, 8 unsigned char [0, UCHAR_MAX ] &lt;limits.h&gt; [0, 255]","tags":["data_type","binary_representation"]},{"location":"blog/20211004/c-binary-representation/#575_signed_integers","title":"5.7.5 Signed integers","text":"<p>Signed types are a bit more complicated than unsigned types. A C implementation has to decide about two points:</p> <ul> <li>What happens on arithmetic over\ufb02ow?</li> <li>How is the sign of a signed type represented?</li> </ul> <p>Signed and unsigned types come in pairs according to their integer rank, with the notable two exceptions from table 5.1: char and bool. The binary representation of the signed type is constrained by the inclusion diagram that we have seen above.</p> <p>TAKEAWAY 5.54</p> <p>TAKEAWAY 5.54 Positive values are represented independently from signedness.</p> <p>Or, stated otherwise, a positive value with a signed type has the same representation as in the corresponding unsigned type. That is why the maximum value for any integer type can be expressed so easily (takeaway 5.51): signed types also have a precision, p, that determines the maximum value of the type.</p> <p>The next thing the standard prescribes is that signed types have one additional bit, the sign bit. If it is 0, we have a positive value; if it is 1, the value is negative. Unfortunately, there are different concepts of how such a sign bit can be used to obtain a negative number. C allows three different sign representations:</p> <ul> <li>Sign and magnitude</li> <li>Ones\u2019 complement</li> <li>Two\u2019s complement</li> </ul> <p>The \ufb01rst two nowadays probably only have historical or exotic relevance: for sign and magnitude, the magnitude is taken as positive values, and the sign bit simply speci\ufb01es that there is a minus sign. Ones\u2019 complement takes the corresponding positive value and complements all bits. Both representations have the disadvantage that two values evaluate to 0: there is a positive and a negative 0.</p> <p>Commonly used on modern platforms is the two\u2019s complement representation. It performs exactly the same arithmetic as we have seen for unsigned types, but the upper half of unsigned values (those with a high-order bit of 1) is interpreted as being negative. The following two functions are basically all that is needed to interpret unsigned values as signed values:</p> is_signed_less.c<pre><code># inclue &lt;limits.h&gt;\n\nbool is_negative(unsigned a) {\n    unsigned const int_max = UINT_MAX/2;\n    return a &gt; int_max;\n}\n\nbool is_signed_less(unsigned a, unsigned b) {\n    if (is_negative(b) &amp;&amp; !is_negative(a)) return false;\n    else return a &lt; b;\n}\n</code></pre> <p>Table 5.6 shows an example of how the negative of our example value 240 can be constructed. For unsigned types, <code>-A</code> can be computed as <code>~A + 1</code>. Two\u2019s complement representation performs exactly the same bit operation for signed types as for unsigned types. It only interprets representations that have the high-order bit as being negative.</p> Op Value b15 \u2026 b0 A 240 0000000011110000 ~A 65295 1111111100001111 +1 65295 0000000000000001 -A 65296 1111111100010000 <p>Prove that for unsigned arithmetic:</p> <ul> <li>A + ~A is full of '1', the maximum value of 2<sup>w</sup> (w=16).</li> <li>A + ~A is \u22121.</li> <li>A + (~A + 1) == 0, 2<sup>w</sup>-1 overflow to 2<sup>w</sup>.</li> </ul> <p>When done that way, signed integer arithmetic will again behave more or less nicely. Unfortunately, there is a pitfall that makes the outcome of signed arithmetic dif\ufb01cult to predict: over\ufb02ow. Where unsigned values are forced to wrap around, the behavior of a signed over\ufb02ow is unde\ufb01ned. The following two loops look much the same:</p> <pre><code>for (unsigned i = 1; i; ++i) do_something();\nfor (signed i = 1; i; ++i) do_something();\n</code></pre> <p>We know what happens for the \ufb01rst loop: the counter is incremented up to <code>UINT_MAX</code> and then wraps around to 0. All of this may take some time, but after UINT_MAX-1 iterations, the loop stops because i will have reached <code>0</code>.</p> <p>For the second loop, everything looks similar. But because here the behavior of over\ufb02ow is unde\ufb01ned, the compiler is allowed to pretend that it will never happen. Since it also knows that the value at the start is positive, it may assume that i, as long as the program has de\ufb01ned behavior, is never negative or 0. The as-if Rule (takeaway 5.8) allows it to optimize the second loop to</p> <pre><code>while (true) do_something();\n</code></pre> <p>That\u2019s right, an in\ufb01nite loop.</p> <p>TAKEAWAY 5.55</p> <p>TAKEAWAY 5.55 Once the abstract state machine reaches an unde\ufb01ned state, no further assumption about the continuation of the execution can be made.</p> <p>Not only that, the compiler is allowed to do what it pleases for the operation itself (\u201cUnde\ufb01ned? so let\u2019s de\ufb01ne it\u201d), but it may also assume that it will never reach such a state and draw conclusions from that.</p> <p>Commonly, a program that has reached an unde\ufb01ned state is referred to as \u201chaving\u201d or \u201cshowing\u201d unde\ufb01ned behavior. This wording is a bit unfortunate; in many such cases, a program does not \u201cshow\u201d any visible signs of weirdness. In the contrary, bad things will be going on that you will not even notice for a long time.</p> <p>TAKEAWAY 5.56</p> <p>TAKEAWAY 5.56 It is your responsibility to avoid unde\ufb01ned behavior of all operations.</p> <p>What makes things even worse is that on some platforms with some standard compiler options, the compilation will just look right. Since the behavior is unde\ufb01ned, on such a platform, signed integer arithmetic might turn out to be basically the same as unsigned. But changing the platform, the compiler, or some options can change that. All of a sudden, your program that worked for years crashes out of nowhere.</p> <p>Basically, what we have discussed up to this chapter always had well-de\ufb01ned behavior, so the abstract state machine is always in a well-de\ufb01ned state. Signed arithmetic changes this, so as long as you don\u2019t need it, avoid it. We say that a program performs a trap C (or just traps) if it is terminated abruptly before its usual end.</p> <p>TAKEAWAY 5.57~5.59</p> <p>TAKEAWAY 5.57 Signed arithmetic may trap badly. TAKEAWAY 5.58 In two\u2019s complement representation, INT_MIN &lt; -INT_MAX. TAKEAWAY 5.59 Negation may over\ufb02ow for signed arithmetic.</p> <p>For signed types, bit operations work with the binary representation. So the value of a bit operation depends in particular on the sign representation. In fact, bit operations even allow us to detect the sign representation:</p> signed_magic.c<pre><code>char const * sign_rep[4] =\n{\n    [1] = \u201dsign and magnitude\u201d,\n    [2] = \u201dones' complement\u201d,\n    [3] = \u201dtwo's complement\u201d,\n    [0] = \u201dweird\u201d, \n};\nenum { sign_magic = -1&amp;3, };\n\n/* ... */\n\nprintf(\u201dSign representation: %s.\\n\u201d, sign_rep[sign_magic]);\n</code></pre> <p>The shift operations then become really messy. The semantics of what such an operation is for a negative value is not clear.</p> <p>TAKEAWAY 5.60</p> <p>TAKEAWAY 5.60 Use unsigned types for bit operations.</p>","tags":["data_type","binary_representation"]},{"location":"blog/20211004/c-binary-representation/#576_fixed-width_integer_types","title":"5.7.6 Fixed-width integer types","text":"<p>The precision for the integer types that we have seen so far can be inspected indirectly by using macros from &lt;limits.h&gt;, such as <code>UINT_MAX</code> and <code>LONG_MIN</code>. The C standard only gives us a minimal precision for them. For the unsigned types, these are</p> type minimal precision bool 1 unsigned char 8 unsigned short 16 unsigned 16 unsigned long 32 unsigned long long 64 <p>Under usual circumstances, these guarantees should give you enough information; but under some technical constraints, such guarantees might not be suf\ufb01cient, or you might want to emphasize a particular precision. This may be the case if you want to use an unsigned quantity to represent a bit set of a known maximal size. If you know that 32-bit will suf\ufb01ce for your set, depending on your platform, you might want to choose <code>unsigned</code> or <code>unsigned long</code> to represent it.</p> <p>The C standard provides names for exact-width integer types in &lt;stdint.h&gt;. As the name indicates, they are of an exact prescribed \u201cwidth,\u201d which for provided unsigned types is guaranteed to be the same as their precision.</p> <p>TAKEAWAY 5.61~5.62</p> <p>TAKEAWAY 5.61 If the type uintN_t is provided, it is an unsigned integer type with exactly N bits of width and precision. TAKEAWAY 5.62 If the type intN_t is provided, it is signed, with two\u2019s complement representation and has a width of exactly N bits and a precision of N \u2212 1.</p> <p>None of these types is guaranteed to exist, but for a convenient set of powers of two, the <code>typedef</code> must be provided if types with the corresponding properties exist.</p> <p>TAKEAWAY 5.63</p> <p>TAKEAWAY 5.63 If types with the required properties exist for values of N = 8, 16, 32, and 64, types uintN_t and intN_t, respectively, must be provided.</p> <p>Nowadays, platforms usually provide <code>uint8_t</code>, <code>uint16_t</code>, <code>uint32_t</code>, and <code>uint64_t</code> unsigned types and <code>int8_t</code>, <code>int16_t</code>, <code>int32_t</code>, and <code>int64_t</code> signed types.</p> <p>Copyright clarification</p> <p>Excerpt from Modern C, 1st Edition, 2019. Copyright credit to Jens Gustedt. \ud83e\udee1 For studying only, not commercial.</p>","tags":["data_type","binary_representation"]},{"location":"blog/20211003/c-data-types-basic-derived/","title":"C Data Types - Basic & Derived","text":"<p>All basic C types are kinds of numbers, but not all of them can be used directly for arithmetic.</p>","tags":["data_type"]},{"location":"blog/20211003/c-data-types-basic-derived/#5_basic_values_and_data","title":"5 Basic values and data","text":"<p>We will now change our focus from \u201chow things are to be done\u201d (statements and expressions) to the things on which C programs operate: <code>values</code> and <code>data</code>. A concrete program at an instance in time has to represent values.</p> <p>Similarly, representations of values on a computer can vary \u201cculturally\u201d from architecture to architecture or are determined by the type the programmer gave to the value. Therefore, we should try to reason primarily about values and not about representations if we want to write portable code.</p> <p>TAKEAWAY 5.1</p> <p>TAKEAWAY 5.1 C programs primarily reason about values and not about their representation.</p> <p>The representation that a particular value has should in most cases not be your concern; the compiler is there to organize the translation back and forth between values and representations.</p>","tags":["data_type"]},{"location":"blog/20211003/c-data-types-basic-derived/#51_the_abstract_state_machine","title":"5.1 The abstract state machine","text":"<p>To explain the abstract state machine, we \ufb01rst have to look into the concepts of a value (what state are we in), the type (what this state represents), and the representation (how state is distinguished). As the term abstract suggests, C\u2019s mechanism allows different platforms to realize the abstract state machine of a given program differently according to their needs and capacities.</p>","tags":["data_type"]},{"location":"blog/20211003/c-data-types-basic-derived/#52_basic_types","title":"5.2 Basic types","text":"<p>C has a series of basic types and means of constructing derived types from them.</p> <p>Mainly for historical reasons, the system of basic types is a bit complicated, and the syntax to specify such types is not completely straightforward. There is a \ufb01rst level of speci\ufb01cation that is done entirely with keywords of the language, such as signed, int, and double. This \ufb01rst level is mainly organized according to C internals. On top of that is a second level of speci\ufb01cation that comes through header \ufb01les, and we have already seen examples: <code>size_t</code> and <code>bool</code>. This second level is organized by type semantics, specifying what properties a particular type brings to the programmer.</p> <p>We will start with the \ufb01rst-level speci\ufb01cation of such types. As we discussed earlier (takeaway 5.2), all basic values in C are numbers, but there are different kinds of numbers. As a principal distinction, we have two different classes of numbers, each with two subclasses: unsigned integers, signed integers, real \ufb02oating-point numbers, and complex \ufb02oating-point numbers. Each of these four classes contains several types.They differ according to their precision, which determines the valid range of values that are allowed for a particular type. Table 5.1 contains an overview of the 18 base types.</p> <p>Types with a gray background don\u2019t allow for arithmetic; they are promoted before doing arithmetic. Type char is special since it can be unsigned or signed, depending on the platform. All types in this table are considered to be distinct types, even if they have the same class and precision.</p> Table 5.1 Base types according to the four main type classes <p>As you can see from the table, there are six types that we can\u2019t use directly for arithmetic, the so-called narrow types. They are promoted to one of the wider types before they are considered in an arithmetic expression. Nowadays, on any realistic platform, this promotion will be a signed int of the same value as the narrow type, regardless of whether the narrow type was signed.</p> <p>TAKEAWAY 5.10</p> <p>TAKEAWAY 5.10 Before arithmetic, narrow integer types are promoted to signed int.</p> <p>Observe that among the narrow integer types, we have two prominent members: <code>char</code> and <code>bool</code>. The \ufb01rst is C\u2019s type that handles printable characters for text, and the second holds truth values, false and true. As we said earlier, for C, even these are just some sort of numbers.</p> <p>The 12 remaining, unpromoted, types split nicely into the four classes.</p> <p>TAKEAWAY 5.11</p> <p>TAKEAWAY 5.11 Each of the four classes of base types has three distinct unpromoted types.</p> <p>Contrary to what many people believe, the C standard doesn\u2019t prescribe the precision of these 12 types: it only constrains them. They depend on a lot of factors that are implementation de\ufb01ned.</p> <p>One of the things the standard does prescribe is that the possible ranges of values for the signed types must include each other according to their rank:</p> <p>But this inclusion does not need to be strict. For example, on many platforms, the set of values of <code>int</code> and <code>long</code> are the same, although the types are considered to be different. An analogous inclusion holds for the six unsigned types:</p> <p>But remember that for any arithmetic or comparison, the narrow unsigned types are promoted to <code>signed int</code> and not to <code>unsigned int</code>, as this diagram might suggest.</p> <p>The comparison of the ranges of signed and unsigned types is more dif\ufb01cult. Obviously, an unsigned type can never include the negative values of a signed type. For the non-negative values, we have the following inclusion of the values of types with corresponding rank:</p> <p>That is, for a given rank, the non-negative values of the signed type \ufb01t into the unsigned type. On any modern platform you encounter, this inclusion is strict: the unsigned type has values that do not \ufb01t into the signed type. For example, a common pair of maximal values is 2<sup>31</sup> \u22121 = 2 147 483 647 for <code>signed int</code> and 2<sup>32</sup> \u2212 1 = 4 294 967 295 for <code>unsigned int</code>.</p> <p>Because the interrelationship between integer types depends on the platform, choosing the \u201cbest\u201d type for a given purpose in a portable way can be a tedious task. Luckily, we can get some help from the compiler implementation, which provides us with typedef s such as <code>size_t</code> that represent certain features.</p> <p>TAKEAWAY 5.12</p> <p>TAKEAWAY 5.12 Use <code>size_t</code> for sizes, cardinalities, or ordinal numbers.</p> <p>Remember that unsigned types are the most convenient types, since they are the only types that have an arithmetic that is de\ufb01ned consistently with mathematical properties: the modulo operation. They can\u2019t raise signals on over\ufb02ow and can be optimized best. They are described in more detail in section 5.7.1.</p> <p>TAKEAWAY 5.13</p> <p>TAKEAWAY 5.13 Use unsigned for small quantities that can\u2019t be negative.</p> <p>If your program really needs values that may be both positive and negative but don\u2019t have fractions, use a signed type (see section 5.7.5).</p> <p>TAKEAWAY 5.14~5.15</p> <ul> <li>TAKEAWAY 5.14 Use signed for small quantities that bear a sign.</li> <li>TAKEAWAY 5.15 Use <code>ptrdiff_t</code> for large differences that bear a sign.</li> </ul> <p>If you want to do fractional computation with a value such as 0.5 or 3.77189E+89, use \ufb02oating-point types (see section 5.7.7).</p> <p>TAKEAWAY 5.16~5.17</p> <ul> <li>TAKEAWAY 5.16 Use double for \ufb02oating-point calculations.</li> <li>TAKEAWAY 5.17 Use double complex for complex calculations.</li> </ul> <p>The C standard de\ufb01nes a lot of other types, among them other arithmetic types that model special use cases. Table 5.2 lists some of them. The second pair represents the types with maximal width that the platform supports. This is also the type in which the preprocessor does any of its arithmetic or comparison.</p> <p>The C standard de\ufb01nes a lot of other types, among them other arithmetic types that model special use cases. Table 5.2 lists some of them. The second pair represents the types with maximal width that the platform supports. This is also the type in which the preprocessor does any of its arithmetic or comparison.</p> <p>The two types <code>time_t</code> and <code>clock_t</code> are used to handle times. They are semantic types, because the precision of the time computation can be different from platform to platform. The way to have a time in seconds that can be used in arithmetic is the function difftime: it computes the difference of two timestamps. <code>clock_t</code> values present the platform\u2019s model of processor clock cycles, so the unit of time is usually much less than a second; CLOCKS_PER_SEC can be used to convert such values to seconds.</p>","tags":["data_type"]},{"location":"blog/20211003/c-data-types-basic-derived/#6_derived_data_types","title":"6 Derived data types","text":"<p>All other data types in C are derived from the basic types that we know now. There are four strategies for deriving data types. Two of them are called aggregate data types, because they combine multiple instances of one or several other data types:</p> <ul> <li>Arrays: These combine items that all have the same base type.</li> <li>Structures: These combine items that may have different base types.</li> </ul> <p>The two other strategies to derive data types are more involved:</p> <p>Pointers: Entities that refer to an object in memory.</p> <p>Pointers are by far the most involved concept, and we will delay a full discussion of them to chapter 11. Here, in section 6.2, we will only discuss them as opaque data types, without even mentioning the real purpose they ful\ufb01ll.</p> <p>Unions: These overlay items of different base types in the same memory location. Unions require a deeper understanding of C\u2019s memory model and are not of much use in a programmer\u2019s everyday life, so they are only introduced later, in section 12.2.</p> <p>There is a \ufb01fth strategy that introduces new names for types: typedef. Unlike the previous four, this does not create a new type in C\u2019s type system, but only creates a new name for an existing type. In that way, it is similar to the de\ufb01nition of macros with #define; thus the choice for the keyword for this feature.</p> <p>Copyright clarification</p> <p>Excerpt from Modern C, 1st Edition, 2019. Copyright credit to Jens Gustedt. \ud83e\udee1 For studying only, not commercial.</p>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/","title":"C Data Types","text":"<p>A C program, whatever its size, consists of functions and variables. A function contains statements that specify the computing operations to be done, and variables store values used during the computation.</p> <p>\u5728 C \u7a0b\u5e8f\u91cc\uff0c\u51fd\u6570\uff08function\uff09\u5c31\u662f\u6307\u4ee4\uff0c\u53d8\u91cf\uff08variable\uff09\u5c31\u662f\u6570\u636e\u3002\u6570\u636e\u7c7b\u578b\u5b9a\u4e49\u4e86\u53d8\u91cf\u7684\u5b58\u50a8\u548c\u8bbf\u95ee\u5c5e\u6027\uff0c\u7ea6\u675f\u4e86\u5176\u5927\u5c0f\u8fb9\u754c\uff08size/boundary\uff09\u3001\u53d6\u503c\u8303\u56f4\uff08value range\uff09\u3001\u89e3\u91ca\u5448\u73b0\uff08interpretation/representation\uff09\u548c\u53ef\u64cd\u4f5c\u96c6\uff08operation set\uff09\u3002</p>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#c_concepts","title":"C Concepts","text":"","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#c_program","title":"C Program","text":"<p>C Programming Language(2e) - Brian W. Kernighan, Dennis M. Ritchie, 1988</p> <p>1.1 Getting Started</p> <p>A C program, whatever its size, consists of functions and variables. A function contains statements that specify the computing operations to be done, and variables store values used during the computation.</p> <p>1.2 Variables and Arithmetic Expressions</p> <p>A declaration announces the properties of variables; it consists of a [type] name and a list of variables.</p> <p>\u300aC\u8bed\u8a00\u6807\u51c6\u4e0e\u5b9e\u73b0\u300b\u59da\u65b0\u989c\uff0c2004</p> <p>03 \u4ece\u6c47\u7f16\u8bed\u8a00\u5f00\u59cb\uff1a\u7b80\u5355\u5730\u8bf4\uff0c\u4e00\u4e2a\u7a0b\u5e8f\u6700\u91cd\u8981\u7684\u4e24\u4e2a\u90e8\u5206\u5206\u522b\u662f\u6570\u636e\u548c\u5bf9\u6570\u636e\u8fdb\u884c\u64cd\u4f5c\u7684\u6307\u4ee4\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u6e05\u695a\u5730\u4e86\u89e3\u4e00\u4e2a\u7a0b\u5e8f\u7684\u6570\u636e\u4e0e\u6307\u4ee4\u662f\u5982\u4f55\u88ab\u7ec4\u7ec7\u8d77\u6765\u7684\u3002 08 C \u8bed\u8a00\u7684\u53d8\u91cf\uff1a\u5728 C \u7a0b\u5e8f\u91cc\uff0c\u53d8\u91cf\uff08variable\uff09\u5c31\u662f\u6570\u636e\uff0c\u51fd\u6570\uff08function\uff09\u5c31\u662f\u6307\u4ee4\u3002</p> <p>\u300a\u6c47\u7f16\u8bed\u8a00(4e)\u300b\u738b\u723d, 2019</p> <p>1.5 \u6307\u4ee4\u548c\u6570\u636e\uff1a\u6307\u4ee4\u548c\u6570\u636e\u662f\u5e94\u7528\u4e0a\u7684\u6982\u5ff5\u3002\u5728\u5185\u5b58\u6216\u78c1\u76d8\u4e0a\uff0c\u6307\u4ee4\u548c\u6570\u636e\u6ca1\u6709\u4efb\u4f55\u533a\u522b\uff0c\u90fd\u662f\u4e8c\u8fdb\u5236\u4fe1\u606f\u3002CPU \u5728\u5de5\u4f5c\u7684\u65f6\u5019\u628a\u6709\u7684\u4fe1\u606f\u770b\u4f5c\u6307\u4ee4\uff0c\u6709\u7684\u4fe1\u606f\u770b\u4f5c\u6570\u636e\uff0c\u4e3a\u540c\u6837\u7684\u4fe1\u606f\u8d4b\u4e88\u4e86\u4e0d\u540c\u7684\u610f\u4e49\u3002</p>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#c_data_types","title":"C data types","text":"<p>C data types</p> <p>In the C programming language, <code>data types</code> constitute the semantics and characteristics of storage of data elements. They are expressed in the language syntax in form of declarations for memory locations or variables. Data types also determine the types of operations or methods of processing of data elements.</p> <p>The C language provides basic arithmetic types, such as integer and real number types, and syntax to build array and compound types. Headers for the C standard library, to be used via include directives, contain definitions of support types, that have additional properties, such as providing storage with an exact size, independent of the language implementation on specific hardware platforms.</p> <p>C \u8bed\u8a00\u4e2d\u7684\u57fa\u672c\u6570\u636e\u7c7b\u578b: char\u3001short\u3001int\u3001long\uff0cfloat\u3001double\u3002</p> <p>C \u8bed\u8a00\u5305\u542b\u7684\u6570\u636e\u7c7b\u578b\u5982\u56fe\u6240\u793a\uff1a</p> <p>The GNU C Reference Manual - 2 Data Types</p>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#type_support","title":"Type support","text":"<p>C language Basic Concepts - Type</p> <ul> <li>Type classification</li> <li>Compatible types</li> <li>Composite types</li> <li>Incomplete types</li> <li>Type names</li> </ul> <p>Type groups</p> <ul> <li>object types: all types that aren't function types</li> <li>character types:\u00a0char,\u00a0signed\u00a0char,\u00a0unsigned\u00a0char</li> <li>integer types:\u00a0char, signed integer types, unsigned integer types, enumerated types</li> <li>real types: integer types and real floating types</li> <li>arithmetic types: integer types and floating types</li> <li>scalar types: arithmetic types, pointer types, and\u00a0nullptr_t(since C23)</li> <li>aggregate types: array types and structure types</li> <li>derived declarator types: array types, function types, and pointer types</li> </ul> <p>Constructing a complete object type such that the number of bytes in its object representation is not representable in the type\u00a0size_t\u00a0(i.e. the result type of\u00a0<code>sizeof</code>\u00a0operator), including forming such a VLA type at runtime,(since C99)\u00a0is undefined behavior.</p> <p>Type support</p> <ul> <li>Additional basic types and convenience macros: &lt;stddef.h&gt;</li> <li> <p>Fixed width integer types (since C99)</p> <ul> <li>Types &amp; Macro constants: &lt;stdint.h&gt;</li> <li>Format macro constants: &lt;inttypes.h&gt;</li> </ul> </li> <li> <p>Numeric limits: &lt;limits.h&gt;, &lt;stdint.h&gt;</p> <ul> <li>Data Type Ranges | Microsoft Learn</li> <li>GNU A.5 Data Type Measurements : Width of an Integer Type &amp; Range of an Integer Type</li> </ul> </li> </ul> <p>The following table summarizes all available integer types and their properties:</p>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#printf_format_specifier","title":"printf format specifier","text":"<p>C data types - Main types - Format specifier</p> <p>printf(3) - Linux manual page @opengroup</p> <ul> <li>Flag characters</li> <li>Field width</li> <li>Precision</li> <li>Length modifier</li> <li>Conversion specifiers</li> </ul> <p>printf: cppreference.com, cplusplus.com</p> <p>Fixed width integer types (since C99)</p> <ul> <li>Format macro constants - Defined in header &lt;inttypes.h&gt;</li> <li>Format constants for the fprintf family of functions</li> <li>Each of the <code>PRI</code> macros listed here is defined if and only if the implementation defines the corresponding typedef name.</li> <li>\u9884\u5904\u7406 dump \u76f8\u5173\u683c\u5f0f\u5b8f\uff1a<code>echo \"#include &lt;inttypes.h&gt;\" | cpp -dM | grep 'FMT\\|PRI'</code>\u3002</li> </ul> <p>fmtlib/fmt: A modern formatting library Comparison of C++ Format and C library's printf</p>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#standard_variants","title":"Standard Variants","text":"<p>\u673a\u5668\u5b57\u957f\uff08Machine Word - <code>__WORDSIZE</code>\uff09\u548c\u5e73\u53f0\u91c7\u7528\u7684\u6570\u636e\u6a21\u578b\uff08Data Models\uff09\u51b3\u5b9a\u4e86 <code>long</code> \u548c <code>pointer</code> \u7684\u4f4d\u5bbd\uff08size in bytes\u3001width in bits\uff09\u3002</p> <p>Types varying by data model \u7684\u76f8\u5173\u7c7b\u578b\uff1a</p> <ol> <li><code>wchar_t</code>: \u5b9e\u73b0\u76f8\u5173</li> <li><code>size_t</code>: \u673a\u5668\u5b57\u957f\u76f8\u5173</li> <li><code>intptr_t</code>/<code>uintptr_t</code>: \u673a\u5668\u5b57\u957f\u76f8\u5173</li> <li><code>ptrdiff_t</code>: \u673a\u5668\u5b57\u957f\u76f8\u5173</li> </ol>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#wchar_t","title":"wchar_t","text":"<p>Null-terminated wide strings</p> <ul> <li>&lt;wchar.h&gt;(since C95): Extended multibyte and wide character utilities</li> <li>&lt;wctype.h&gt;(since C95): Functions to determine the type contained in wide character data</li> <li><code>wchar_t</code> : integer type that can hold any valid wide character(typedef)</li> </ul> <p>aapcs64 - 7 The standard variants - 10.1.2 Types varying by data model:</p> C/C++ Type ILP32 (Beta) LP64 LLP64 wchar_t unsigned word unsigned word unsigned halfword <p>\u5728 MSVC - C++ type system \u4e2d\u5b9a\u4e49 wchar_t \u4f4d\u5bbd\u4e3a 2 bytes\u3002</p> <p>\u76f8\u5173\u5b8f\uff1a</p> <ul> <li><code>__WCHAR_TYPE__</code></li> <li><code>__SIZEOF_WCHAR_T__</code>, <code>__WCHAR_WIDTH__</code></li> </ul>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#size_t","title":"size_t","text":"<p>Type support - &lt;stddef.h&gt;</p> <ul> <li><code>size_t</code>: unsigned integer type returned by the sizeof operator(typedef)</li> </ul> <p>aapcs64 - 7 The standard variants - 10.1.4 Additional types:</p> Typedef ILP32 (Beta) LP64 LLP64 size_t unsigned long unsigned long unsigned long long <p>\u76f8\u5173\u5b8f\uff1a</p> <ul> <li><code>__SIZE_TYPE__</code></li> <li><code>__SIZEOF_SIZE_T__</code>, <code>__SIZE_WIDTH__</code></li> </ul> <p>rpi4b-ubuntu \u7684 /usr/include/stdint.h \u4e2d\u5b9a\u4e49\u4e86\uff1a</p> <pre><code># define SIZE_WIDTH __WORDSIZE\n</code></pre>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#intptr_tuintptr_t","title":"intptr_t/uintptr_t","text":"<p>Fixed width integer types (since C99) - &lt;stdint.h&gt;</p> <ul> <li><code>intptr_t</code>: integer type capable of holding a pointer</li> <li><code>uintptr_t</code>: unsigned integer type capable of holding a pointer</li> </ul> <p>\u76f8\u5173\u5b8f\uff1a</p> <ul> <li><code>__INTPTR_TYPE__</code>, <code>__INTPTR_WIDTH__</code></li> <li><code>__UINTPTR_TYPE__</code>, <code>__UINTPTR_WIDTH__</code></li> </ul> <p>\u6307\u9488\u4f4d\u6570\u4e00\u822c\u548c <code>__WORDSIZE</code> \u76f8\u7b49\uff1a</p> <ul> <li>sizeof(<code>__INTPTR_TYPE__</code>) = sizeof(<code>__UINTPTR_TYPE__</code>) = <code>__SIZEOF_POINTER__</code></li> <li><code>__INTPTR_WIDTH__</code> = <code>__UINTPTR_WIDTH__</code> = <code>__POINTER_WIDTH__</code> = <code>__WORDSIZE</code></li> </ul> <p>rpi4b-ubuntu \u7684 /usr/include/stdint.h \u4e2d\u5b9a\u4e49\u4e86\uff1a</p> <pre><code># define INTPTR_WIDTH __WORDSIZE\n# define UINTPTR_WIDTH __WORDSIZE\n</code></pre>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#ptrdiff_t","title":"ptrdiff_t","text":"<p>Type support - &lt;stddef.h&gt;</p> <ul> <li><code>ptrdiff_t</code>: signed integer type returned when subtracting two pointers(typedef)</li> </ul> <p>aapcs64 - 7 The standard variants - 10.1.4 Additional types:</p> Typedef ILP32 (Beta) LP64 LLP64 ptrdiff_t signed long signed long signed long long <p>\u76f8\u5173\u5b8f\uff1a</p> <ul> <li><code>__PTRDIFF_TYPE__</code></li> <li><code>__PTRDIFF_WIDTH__</code></li> </ul> <p>rpi4b-ubuntu \u7684 /usr/include/stdint.h \u4e2d\u5b9a\u4e49\u4e86\uff1a</p> <pre><code># define PTRDIFF_WIDTH __WORDSIZE\n</code></pre>","tags":["data_type"]},{"location":"blog/20091003/c-data-types/#predefined_macros","title":"Predefined Macros","text":"<p>GCC/Clang \u7f16\u8bd1\u5668\u9884\u5b9a\u4e49\u7684\u5b8f\u53c2\u8003\uff1a</p> <ul> <li>GNU C Preprocessor - Common Predefined Macros</li> <li>Clang Preprocessor options - Dumping preprocessor state</li> </ul> <p>\u5728 Dump Compiler Options \u4e2d\u6709\u4ecb\u7ecd\u5982\u4f55 dump compiler predefined macros\u3002</p> dump prededined macros<pre><code>$ echo | cpp -dM\n$ echo | gcc -x c -E -dM -\n$ echo | g++ -x c++ -E -dM -\n\n# IA32/IA64\n$ llvm-gcc -x c -E -dM -arch i386 /dev/null\n$ llvm-gcc -x c -E -dM -arch x86_64 /dev/null\n\n# ARM32/ARM64\n$ llvm-gcc -x c -E -dM -arch armv7s /dev/null\n$ llvm-gcc -x c -E -dM -arch arm64 /dev/null\n</code></pre> <p>\u4f8b\u5982\uff1aNumeric limits - &lt;limits.h&gt; \u4e2d\u5b9a\u4e49\u4e86 <code>CHAR_BIT</code>\uff1a</p> <ul> <li><code>CHAR_BIT</code>: number of bits in a byte(macro constant)</li> </ul> <p>\u5728 macOS \u548c rpi4b-ubuntu \u4e0b\u6267\u884c <code>gcc -E -dM</code> \u547d\u4ee4\uff0cgrep \u8fc7\u6ee4\u6253\u5370\u51fa <code>__CHAR_BIT__</code>\uff08\u5176\u503c\u5747\u4e3a 8\uff09\u3002</p> <pre><code># macOS\nllvm-gcc -x c -E -dM -arch i386 /dev/null | grep \"__CHAR_BIT__\"\nllvm-gcc -x c -E -dM -arch x86_64 /dev/null | grep \"__CHAR_BIT__\"\nllvm-gcc -x c -E -dM -arch armv7s /dev/null | grep \"__CHAR_BIT__\"\nllvm-gcc -x c -E -dM -arch arm64 /dev/null | grep \"__CHAR_BIT__\"\n\n# rpi4b-ubuntu\necho | cpp -dM | grep \"__CHAR_BIT__\"\ngcc -x c -E -dM /dev/null | grep \"__CHAR_BIT__\"\n</code></pre> <p>\u5176\u4e2d\uff0c\u6d89\u53ca\u5230\u673a\u5668\u5b57\u957f\u5e76\u51b3\u5b9a\u6570\u636e\u6a21\u578b\u76f8\u5173\u7684\u5b8f\uff1a</p> <ul> <li><code>__SIZEOF_LONG__</code> @intel</li> <li><code>__SIZEOF_POINTER__</code>, <code>__POINTER_WIDTH__</code></li> </ul> <p>4 \u4e2a Standard Variants \u76f8\u5173\u7684\u5b8f\uff1a</p> <ol> <li><code>__WCHAR_TYPE__</code>, <code>__WCHAR_WIDTH__</code>, <code>__SIZEOF_WCHAR_T__</code></li> <li><code>__SIZE_TYPE__</code>, <code>__SIZE_WIDTH__</code>, <code>__SIZEOF_SIZE_T__</code></li> <li><code>__INTPTR_TYPE__</code>, <code>__INTPTR_WIDTH__</code>; <code>__UINTPTR_TYPE__</code>, <code>__UINTPTR_WIDTH__</code></li> <li><code>__PTRDIFF_TYPE__</code>, <code>__PTRDIFF_WIDTH__</code></li> </ol> <p>\u4ee5\u4e0b\u4e3a mbpa2991-macOS/arm64 \u548c rpi4b-ubuntu/aarch64 \u4e0b dump \u8fc7\u6ee4\u51fa\u6765\u7684\u76f8\u5173\u5b8f\u3002</p> macros varying by data model <pre><code># mbpa2991-macOS/arm64\n$ llvm-gcc -x c -E -dM -arch i386 /dev/null | grep -E \"__SIZEOF_LONG__|__SIZEOF_POINTER__|__WCHAR_TYPE__|__SIZE_TYPE__|__INTPTR_TYPE__|__UINTPTR_TYPE__|__PTRDIFF_TYPE__\"\n#define __INTPTR_TYPE__ long int\n#define __PTRDIFF_TYPE__ int\n#define __SIZEOF_LONG__ 4\n#define __SIZEOF_POINTER__ 4\n#define __SIZE_TYPE__ long unsigned int\n#define __UINTPTR_TYPE__ long unsigned int\n#define __WCHAR_TYPE__ int\n\n$ llvm-gcc -x c -E -dM -arch x86_64 /dev/null | grep -E \"__SIZEOF_LONG__|__SIZEOF_POINTER__|__WCHAR_TYPE__|__SIZE_TYPE__|__INTPTR_TYPE__|__UINTPTR_TYPE__|__PTRDIFF_TYPE__\"\n#define __INTPTR_TYPE__ long int\n#define __PTRDIFF_TYPE__ long int\n#define __SIZEOF_LONG__ 8\n#define __SIZEOF_POINTER__ 8\n#define __SIZE_TYPE__ long unsigned int\n#define __UINTPTR_TYPE__ long unsigned int\n#define __WCHAR_TYPE__ int\n\n$ llvm-gcc -x c -E -dM -arch armv7s /dev/null | grep -E \"__SIZEOF_LONG__|__SIZEOF_POINTER__|__WCHAR_TYPE__|__SIZE_TYPE__|__INTPTR_TYPE__|__UINTPTR_TYPE__|__PTRDIFF_TYPE__\"\n#define __INTPTR_TYPE__ long int\n#define __PTRDIFF_TYPE__ int\n#define __SIZEOF_LONG__ 4\n#define __SIZEOF_POINTER__ 4\n#define __SIZE_TYPE__ long unsigned int\n#define __UINTPTR_TYPE__ long unsigned int\n#define __WCHAR_TYPE__ int\n\n$ llvm-gcc -x c -E -dM -arch arm64 /dev/null | grep -E \"__SIZEOF_LONG__|__SIZEOF_POINTER__|__WCHAR_TYPE__|__SIZE_TYPE__|__INTPTR_TYPE__|__UINTPTR_TYPE__|__PTRDIFF_TYPE__\"\n#define __INTPTR_TYPE__ long int\n#define __PTRDIFF_TYPE__ long int\n#define __SIZEOF_LONG__ 8\n#define __SIZEOF_POINTER__ 8\n#define __SIZE_TYPE__ long unsigned int\n#define __UINTPTR_TYPE__ long unsigned int\n#define __WCHAR_TYPE__ int\n\n# rpi4b-ubuntu/aarch64\n$ gcc -x c -E -dM /dev/null | grep -E \"__SIZEOF_LONG__|__SIZEOF_POINTER__|__WCHAR_TYPE__|__SIZE_TYPE__|__INTPTR_TYPE__|__UINTPTR_TYPE__|__PTRDIFF_TYPE__\"\n#define __SIZEOF_LONG__ 8\n#define __SIZEOF_POINTER__ 8\n#define __SIZE_TYPE__ long unsigned int\n#define __INTPTR_TYPE__ long int\n#define __WCHAR_TYPE__ unsigned int\n#define __PTRDIFF_TYPE__ long int\n#define __UINTPTR_TYPE__ long unsigned int\n</code></pre>","tags":["data_type"]},{"location":"blog/20211006/c-memory-model/","title":"The C Memory Model","text":"<p>Pointers present us with a certain abstraction of the environment and state in which our program is executed, the C memory model. We may apply the unary operator &amp; to (almost) all objects to retrieve their address and use it to inspect and change the state of our execution.</p> <p>This access to objects via pointers is still an abstraction, because seen from C, no distinction of the \u201creal\u201d location of an object is made. It could reside in your computer\u2019s RAM or on a disk \ufb01le, or correspond to an IO port of a temperature sensor on the moon; you shouldn\u2019t care. C is supposed to do the right thing, regardless.</p> <p>And indeed, on modern operating systems, all you get via pointers is something called virtual memory, basically a \ufb01ction that maps the address space of your process to physical memory addresses of your machine.</p> <p>The only thing C must care about is the type of the object a pointer addresses. Each pointer type is derived from another type, its base type, and each such derived type is a distinct new type.</p> <p>Figure 12.1 The different levels of the value-memory model for an <code>int32_t</code>. Example of a platform that maps this type to a 32-bit signed int that has two\u2019s complement sign representation and little-endian object representation.</p> int32_t object representation <p>TAKEAWAY 12.1 Pointer types with distinct base types are distinct.</p> <p>In addition to providing a virtual view of physical memory, the memory model also simpli\ufb01es the view of objects themselves. It makes the assumption that each object is a collection of bytes, the object representation (section 12.1); 2 see \ufb01gure 12.1 for a schematic view. A convenient tool to inspect that object representation is unions (section 12.2). Giving direct access to the object representation (section 12.3) allows us to do some \ufb01ne tuning; but on the other hand, it also opens the door to unwanted or conscious manipulations of the state of the abstract machine: tools for that are untyped pointers (section 12.4) and casts (section 12.5). Effective types (section 12.6) and alignment (section 12.7) describe formal limits and platform constraints for such manipulations.</p>","tags":["memory_model","union","endianess"]},{"location":"blog/20211006/c-memory-model/#a_uniform_memory_model","title":"A uniform memory model","text":"<p>Even though generally all objects are typed, the memory model makes another simpli\ufb01cation: that all objects are an assemblage of bytes. The <code>sizeof</code> operator that we introduced in the context of arrays measures the size of an object in terms of the bytes that it uses. There are three distinct types that by de\ufb01nition use exactly one byte of memory: the character types <code>char</code>, <code>unsigned char</code>, and <code>signed char</code>.</p> <p>TAKEAWAY 12.2 sizeof(char) is 1 by de\ufb01nition.</p> <p>Not only can all objects be \u201caccounted\u201d in size as character types on a lower level, they can even be inspected and manipulated as if they were arrays of such character types. A little later, we will see how this can be achieved, but for the moment we will just note the following:</p> <p>TAKEAWAY 12.3 Every object A can be viewed as <code>unsigned char[sizeof A]</code>. TAKEAWAY 12.4 Pointers to character types are special.</p> <p>Unfortunately, the types that are used to compose all other object types are derived from char, the type we looked at for the characters of strings. This is merely a historical accident, and you shouldn\u2019t read too much into it. In particular, you should clearly distinguish the two different use cases.</p> <p>TAKEAWAY 12.5 Use the type <code>char</code> for character and string data. TAKEAWAY 12.6 Use the type <code>unsigned char</code> as the atom of all object types.</p> <p>The type <code>signed char</code> is of much less importance than the two others.</p> <p>As we have seen, the <code>sizeof</code> operator counts the size of an object in terms of how many <code>unsigned char</code>s it occupies.</p> <p>TAKEAWAY 12.7 The <code>sizeof</code> operator can be applied to objects and object types.</p> <p>In the previous discussion, we can also distinguish two syntactic variants for <code>sizeof</code>: with and without parentheses. Whereas the syntax for an application to objects can have both forms, the syntax for types needs parentheses:</p> <p>TAKEAWAY 12.8 The size of all objects of type T is given by <code>sizeof(T)</code>.</p>","tags":["memory_model","union","endianess"]},{"location":"blog/20211006/c-memory-model/#unions__endianess","title":"Unions &amp; Endianess","text":"<p>Let us now look at a way to examine the individual bytes of objects. Our preferred tool for this is the <code>union</code>. These are similar in declaration to <code>struct</code> but have different semantics:</p> endianness.c<pre><code>#include &lt;inttypes.h&gt;\n\ntypedef union unsignedInspect unsignedInspect;\nunion unsignedInspect {\nunsigned val;\nunsigned char bytes[sizeof(unsigned)];\n};\nunsignedInspect twofold = { .val = 0xAABBCCDD, };\n</code></pre> <p>The difference here is that such a <code>union</code> doesn\u2019t collect objects of different type into one bigger object, but rather overlays an object with a different type interpretation. That way, it is the perfect tool to inspect the individual bytes of an object of another type.</p> <p>Let us \ufb01rst try to \ufb01gure out what values we would expect for the individual bytes. In a slight abuse of language, let us speak of the different parts of an unsigned number that correspond to the bytes as representation digits. Since we view the bytes as being of type <code>unsigned char</code>, they can have values 0 ... <code>UCHAR_MAX</code>, inclusive, and thus we interpret the number as written with a base of <code>UCHAR_MAX+1</code>. In the example, on my machine, a value of type <code>unsigned</code> can be expressed with <code>sizeof(unsigned) == 4</code> such representation digits, and I chose the values 0xAA, 0xBB, 0xCC, and 0xDD for the highest- to lowest-order representation digit. The complete <code>unsigned</code> value can be computed using the following expression, where <code>CHAR_BIT</code> is the number of bits in a character type:</p> <pre><code>((0xAA &lt;&lt; (CHAR_BIT * 3)) \n    |(0xBB &lt;&lt; (CHAR_BIT * 2)) \n    |(0xCC &lt;&lt; CHAR_BIT) \n    |0xDD)\n</code></pre> <p>With the <code>union</code> de\ufb01ned earlier, we have two different facets to look at the same twofold object: twofold.val presents it as being an <code>unsigned</code>, and twofold.bytes presents it as an array of <code>unsigned char</code>. Since we chose the length of twofold.bytes to be exactly the size of twofold.val, it represents exactly its bytes, and thus gives us a way to inspect the object representation C of an <code>unsigned</code> value: all its representation digits:</p> endianness.c<pre><code>printf(\"value is 0x%.08X\\n\", twofold.val);\nfor (size_t i = 0; i &lt; sizeof twofold.bytes; ++i)\n    printf(\"byte[%zu]: 0x%.02hhX\\n\", i, twofold.bytes[i]);\n</code></pre> <p>On my computer, I receive a result as shown here:</p> <pre><code>value is 0xAABBCCDD\nbyte[0]: 0xDD\nbyte[1]: 0xCC\nbyte[2]: 0xBB\nbyte[3]: 0xAA\n</code></pre> <p>For my machine, we see that the output has the low-order representation digits of the integer \ufb01rst, then the next-lower order digits, and so on. At the end, the highest-order digits are printed. So the in-memory representation of such an integer on my machine has the loworder representation digits before the high-order ones.</p> <p>This is not normalized by the standard, but is an implementation-de\ufb01ned behavior.</p> <p>That is, a platform provider might decide to provide a storage order that has the highest-order digits \ufb01rst, and then print lower-order digits one by one. The storage order, the endianness, as given for my machine, is called little-endian. A system that has high-order representation digits \ufb01rst is called big-endian. Both orders are commonly used by modern processor types. Some processors are even able to switch between the two orders on the \ufb02y.</p> <p>The previous output also shows another implementation-de\ufb01ned behavior: I used the feature of my platform that one representation digit can be printed nicely by using two hexadecimal digits. In other words, I assumed that <code>UCHAR_MAX+1</code> is 256 and that the number of value bits in an <code>unsigned char</code>, <code>CHAR_BIT</code>, is 8. Again, this is implementation-de\ufb01ned behavior: although the vast majority of platforms have these properties, there are still some around that have wider character types.</p> <p>TAKEAWAY 12.10 On most architectures, <code>CHAR_BIT</code> is 8 and <code>UCHAR_MAX</code> is 255.</p> <p>In the example, we have investigated the in-memory representation of the simplest arithmetic base types, unsigned integers. Other base types have in-memory representations that are more complicated: signed integer types have to encode the sign; \ufb02oating-point types have to encode the sign, mantissa, and exponent; and pointer types may follow any internal convention that \ufb01ts the underlying architecture.</p> <p>Copyright clarification</p> <p>Excerpt from Modern C, 1st Edition, 2019. Copyright credit to Jens Gustedt. \ud83e\udee1 For studying only, not commercial.</p>","tags":["memory_model","union","endianess"]},{"location":"blog/20211001/c-standard-integer-types/","title":"C\u8bed\u8a00\u6807\u51c6\u4e0e\u5b9e\u73b0\u4e4b\u6574\u6570\u7c7b\u578b","text":"<p>\u5728 C \u8bed\u8a00\u521a\u521a\u88ab\u8bbe\u8ba1\u51fa\u6765\u7684\u65f6\u5019\uff0c\u4e00\u5171\u53ea\u6709\u4e24\u79cd\u6574\u6570\u7c7b\u578b \u2014\u2014 <code>char</code> \u548c <code>int</code>\u3002C89 \u5f15\u5165\u4e86\u4e24\u79cd\u65b0\u7684\u6574\u6570\u7c7b\u578b \u2014\u2014 <code>short</code> \u548c <code>long</code>\uff0cC99 \u518d\u589e\u52a0\u4e00\u79cd\u6574\u6570\u7c7b\u578b \u2014\u2014 long long\u3002</p> <p>\u540e\u6765\uff0c\u968f\u7740 C \u8bed\u8a00\u7684\u8fdb\u4e00\u6b65\u53d1\u5c55\uff0cK&amp;R C \u5f15\u5165\u4e86\u65e0\u7b26\u53f7\u6574\u6570\u7684\u6982\u5ff5\u4ee5\u53ca <code>unsigned</code> \u5173\u952e\u5b57\u3002<code>char</code> \u65e2\u4e0d\u5c5e\u4e8e\u6807\u51c6\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b\u4e5f\u4e0d\u5c5e\u4e8e\u6807\u51c6\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b\uff0c\u5b83\u5c5e\u4e8e\u5386\u53f2\u9057\u7269\u3002</p> <p>C89 \u5f15\u5165 <code>signed</code> \u5173\u952e\u5b57\u540e\uff0c\u53ef\u663e\u5f0f\u58f0\u660e <code>signed char</code>\uff0c\u660e\u786e\u8868\u8fbe\u6700\u5c0f\u7684\u6807\u51c6\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b\u3002</p> <p>\u4e3a\u4ec0\u4e48 <code>getchar()</code> \u8fd4\u56de\u7684\u7c7b\u578b\u662f int\uff0c\u800c\u4e0d\u662f char\uff1f</p>","tags":["data_type","standard","integer"]},{"location":"blog/20211001/c-standard-integer-types/#signedness_representation","title":"signedness representation","text":"<p>\u7c97\u7565\u5730\u6982\u62ec\uff0c\u6574\u6570\u7c7b\u578b\u5206\u4e3a\u4e24\u5927\u7c7b\uff1a\u65e0\u7b26\u53f7\u6574\u6570\uff08<code>unsigned</code> integer\uff09\u548c\u5e26\u7b26\u53f7\u6574\u6570\uff08<code>signed</code> integer\uff09\u3002</p> <p>\u5bf9\u4e8e\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u6240\u6709\u7684\u6570\u4f4d\u90fd\u88ab\u7528\u6765\u8868\u793a\u6570\u503c\u3002 \u5bf9\u4e8e\u5e26\u7b26\u53f7\u6574\u6570\uff0c\u6570\u4f4d\u88ab\u5212\u5206\u4e3a\u7b26\u53f7\u4f4d\uff08\u53ea\u80fd\u5360\u4e00\u4f4d\uff09\u4e0e\u6570\u503c\u4f4d\uff08\u5269\u4f59\u7684\u5176\u5b83\u4f4d\uff09\u3002</p> <p>\u7b26\u53f7\u4f4d\u7684\u6743\u503c\u6709\u4e0d\u540c\u7684\u89e3\u91ca\uff1a</p> <ol> <li>\u6743\u503c\u662f\u96f6\uff08\u7b26\u53f7\u4f4d\u662f\u201c1\u201d\u5219\u8868\u793a\u6570\u503c\u4e3a\u8d1f\uff09\uff0c\u79f0\u4e3a\u201c\u7b26\u53f7-\u7edd\u5bf9\u503c\u201d\u6a21\u5f0f\u3002</li> <li>\u6743\u503c\u662f \u20132<sup>N-1</sup>\uff0c\u201c2\u7684\u8865\u7801\u201d\u65b9\u5f0f\u3002</li> <li>\u6743\u503c\u662f \u2013(2<sup>N-1</sup>-1)\uff0c\u201c1\u7684\u8865\u7801\u201d\u65b9\u5f0f\u3002</li> </ol> <p>\u81f3\u4e8e\u5177\u4f53\u6839\u636e\u54ea\u4e00\u79cd\u60c5\u51b5\u5bf9\u5e26\u7b26\u53f7\u6574\u6570\u4f5c\u51fa\u89e3\u91ca\u5219\u7531\u6bcf\u4e00 \u79cd\u5b9e\u73b0\u81ea\u884c\u5b9a\u4e49\u3002\u4e0d\u8fc7\uff0c\u51e0\u4e4e\u6240\u6709\u7684\u73b0\u4ee3\u8ba1\u7b97\u673a\u67b6\u6784\u5747\u91c7\u7528\u201c2\u7684\u8865\u7801\u201d\u89e3\u91ca\u5e26\u7b26\u53f7\u6574\u6570\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u4e00\u4e2a\u5b9e\u73b0\u6ca1\u6709\u7279\u522b\u8bf4\u660e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u5c31\u662f\u57fa\u4e8e\u201c2\u7684\u8865\u7801\u201d\u65b9\u5f0f\u3002</p> <p>\u4e0d\u96be\u5f97\u51fa\u7ed3\u8bba\uff0c\u4e00\u4e2a N \u4f4d\u7684\u5e26\u7b26\u53f7\u6574\u6570\u80fd\u591f\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u5728\u4e09\u79cd\u60c5\u5f62\u4e0b\u5206\u522b\u662f\uff1a</p> <ol> <li>[-(2<sup>N-1</sup>-1), (2<sup>N-1</sup>-1)]</li> <li>[-2<sup>N-1</sup>, (2<sup>N-1</sup>-1)]</li> <li>[\u2013(2<sup>N-1</sup>-1), (2<sup>N-1</sup>-1)]</li> </ol> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u60c5\u5f621\u548c\u60c5\u5f623\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e2a\u91cd\u590d\u7684\u96f6\u503c\uff1a\u5bf9\u4e8e\u60c5\u5f621\uff0c\u7b26\u53f7\u4f4d\u662f\u201c1\u201d\u5176\u5b83\u4f4d\u5168\u662f\u96f6\u7684\u503c\u6309\u7167\u4e0a\u9762\u7684\u89e3\u91ca\u4e5f\u662f\u96f6\uff1b\u5bf9\u4e8e\u60c5\u5f623\uff0c\u6240\u6709\u4f4d\u90fd\u662f\u201c1\u201d\u7684\u503c\u6309\u7167\u4e0a\u9762\u7684\u89e3\u91ca\u4e5f\u662f\u96f6\u3002</p> <p>\u5f88\u591a\u65f6\u5019\u4eba\u4eec\u5bb9\u6613\u5fd8\u8bb0\u65e0\u7b26\u53f7\u6574\u6570\u7684\u4e00\u4e2a\u6700\u57fa\u672c\u7684\u7279\u6027\uff1a\u6c38\u4e0d\u4e3a\u8d1f\uff0c\u4e8e\u662f\u5728\u67d0\u4e9b\u573a\u5408\u4e00\u4e0d\u5c0f\u5fc3\u5c31\u51fa\u73b0\u611a\u8822\u7684\u9519\u8bef\uff0c\u5176\u4e2d\u6bd4\u8f83\u5e38\u89c1\u7684\u662f\u8ba1\u6570\u5668\u53d8\u91cf\uff08\u4e0b\u9762\u7684\u4ee3\u7801\u8bd5\u56fe\u4ece\u5927\u5230\u5c0f\u6253\u5370 [0\uff0c99] \u533a\u95f4\u5185\u7684\u6240\u6709\u6574\u6570\uff09\uff1a</p> unsigned-decrement-gteq.c<pre><code>unsigned i;\nfor (i = 99; i &gt;= 0; --i)\n    printf(\"%u\\n\", i);\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u7684\u610f\u56fe\u5f88\u660e\u663e\uff0c\u8ba1\u6570\u5668 i \u4ece 99 \u5f00\u59cb\uff0c\u6bcf\u6b21\u51cf1\uff0c\u9012\u51cf\u52300\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4ee5 i \u4e3a\u53c2\u6570\u8c03\u7528\u51fd\u6570 printf()\uff0c\u603b\u5171\u6253\u5370 100 \u6b21\uff0c\u7136\u540e\u9000\u51fa for \u8bed\u53e5\u3002</p> <p>\u4f46\u662f\uff0c\u8ba1\u6570\u5668 i \u662f\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u7f16\u8bd1\u5668\u4f1a\u7528\u76f8\u5e94\u7684\u6307\u4ee4\u53bb\u5224\u65ad i \u662f\u5426\u5927\u4e8e\u6216\u7b49\u4e8e\u96f6\uff0c\u7ed3\u679c\u5f88\u6e05\u695a\uff0c\u4f5c\u4e3a\u65e0\u7b26\u53f7\u6574\u6570\u7684 i \u4e00\u5b9a\u662f\u6c38\u8fdc\u5927\u4e8e\u6216\u7b49\u4e8e\u96f6\u7684\uff0c\u5c31\u662f\u8bf4\uff0c\u4e0a\u9762\u7684 for \u8bed\u53e5\u662f\u4e00\u4e2a\u6b7b\u5faa\u73af\u3002\u5bf9\u4e8e\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u5c3d\u91cf\u907f\u514d\u4f7f\u7528 &lt;\uff0c&gt;\uff0c&lt;=\uff0c&gt;= \u7b49\u8fd0\u7b97\u7b26\u800c\u4f18\u5148\u9009\u7528 != \uff1a</p> unsigned-decrement-inequation.c<pre><code>unsigned i = 100;\nwhile (i != 0) /* OK */\n{\n    --i;\n    printf(\u201c%u\\n\u201d, i);\n}\n</code></pre>","tags":["data_type","standard","integer"]},{"location":"blog/20211001/c-standard-integer-types/#short_long_long_long","title":"short, long, long long","text":"<p>C89 \u5f15\u5165\u4e86\u4e24\u79cd\u65b0\u7684\u6574\u6570\u7c7b\u578b \u2014\u2014 <code>short</code> \u548c <code>long</code>\uff0c\u5f88\u81ea\u7136 short \u548c long \u4e5f\u662f\u65b0\u589e\u52a0\u7684\u5173\u952e\u5b57\u3002C99 \u518d\u589e\u52a0\u4e00\u79cd\u6574\u6570\u7c7b\u578b \u2014\u2014 <code>long long</code>\uff0c\u81f3\u6b64\uff0cC \u8bed\u8a00\u4e00\u5171\u67095\u79cd\u6807\u51c6\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b\u4ee5\u53ca5\u79cd\u6807\u51c6\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b\uff0c\u6807\u51c6\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b\u548c\u6807\u51c6\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b\u5408\u79f0\u4e3a\u6807\u51c6\u6574\u6570\u7c7b\u578b\u3002</p> \u6807\u51c6\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b \u6807\u51c6\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b signed char unsigned char signed short unsigned short signed int unsigned int sigend long unsigned long signed long long unsigend long long <p>C99 \u6807\u51c6\u5e76\u6ca1\u6709\u786c\u6027\u89c4\u5b9a\u5177\u4f53\u5230\u67d0\u79cd\u5e73\u53f0\u4e0a\u7684\u67d0\u79cd\u6574\u6570\u7c7b\u578b\u7a76\u7adf\u5360\u7528\u591a\u5c11\u5b57\u8282\u3001\u80fd\u591f\u8868\u793a\u591a\u5927\u8303\u56f4\u7684\u6570\u503c\u7b49\uff0c\u53ea\u662f\u7ed9\u51fa\u4e00\u6761\u539f\u5219\u548c\u4e00\u4e2a\u53c2\u8003\u6570\u503c\u96c6\u5408\uff0c\u53ea\u8981\u540c\u65f6\u6ee1\u8db3\u8fd9\u4e24\u65b9\u9762\u6761\u4ef6\u5c31\u7b97\u662f\u7b26\u5408 C \u6807\u51c6\u3002\u539f\u5219\u662f\uff1a</p> <ul> <li>long long \u80fd\u591f\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u5fc5\u987b\u5927\u4e8e\u6216\u7b49\u4e8e long \u80fd\u591f\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\uff0c</li> <li>long \u80fd\u591f\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u5fc5\u987b\u5927\u4e8e\u6216\u7b49\u4e8e int \u80fd\u591f\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\uff0c</li> <li>int \u80fd\u591f\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u5fc5\u987b\u5927\u4e8e\u6216\u7b49\u4e8e short \u80fd\u591f\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\uff0c</li> <li>short \u80fd\u591f\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u5fc5\u987b\u5927\u4e8e\u6216\u7b49\u4e8e signed char \u80fd\u591f\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u3002</li> </ul> <p>\u6bcf\u4e00\u79cd\u6807\u51c6\u6574\u6570\u7c7b\u578b\u7684\u6700\u5927\u3001\u6700\u5c0f\u503c\u5728\u8be5\u5e73\u53f0\u5bf9\u5e94\u7684 C \u6807\u51c6\u5934\u6587\u4ef6 &lt;limits.h&gt; \u4e2d\u7ed9\u51fa\uff0c\u5177\u4f53\u5b9e\u73b0\u7684\u6570\u503c\u5e94\u8be5\u5728\u7edd\u5bf9\u503c\u4e0a\u5927\u4e8e\u6216\u7b49\u4e8e C99 \u5217\u51fa\u7684\u53c2\u8003\u503c\u800c\u4e14\u7b26\u53f7\u76f8\u540c\uff0c\u53c2\u8003 cplusplus.com/reference/climits/ \u4e2d\u7684 Macro constants \u8868\u683c\u3002</p> <p>32 \u4f4d\u8ba1\u7b97\u673a\u67b6\u6784\u4e0a\u7684 C \u8bed\u8a00\u5b9e\u73b0\u901a\u5e38\u9009\u7528 <code>ILP32</code> \u6a21\u5f0f\u3002</p> \u6574\u6570\u7c7b\u578b \u957f\u5ea6 char 1 byte ( 8 bit) short 2 byte (16 bit) int 4 byte (32 bit) long 4 byte (32 bit) long long 8 byte (64 bit) <p>\u800c 64 \u4f4d\u8ba1\u7b97\u673a\u67b6\u6784\u4e0a\u7684 C \u8bed\u8a00\u5b9e\u73b0\u901a\u5e38\u9009\u7528 <code>LP64</code> \u6a21\u5f0f\uff1a</p> \u6574\u6570\u7c7b\u578b \u957f\u5ea6 char 1 byte ( 8 bit) short 2 byte (16 bit) int 4 byte (32 bit) long 8 byte (64 bit) long long 8 byte (64 bit) <p>\u5373\u4f7f\u662f\u540c\u4e00\u79cd\u6574\u6570\u7c7b\u578b\uff0c\u5728\u4e0d\u540c\u7684\u5e73\u53f0\u4e0a\u4e5f\u53ef\u80fd\u6709\u4e0d\u540c\u7684\u957f\u5ea6\uff08\u4f8b\u5982 long \u5728 ILP32 \u548c LP64 \u4e2d\u5206\u522b\u662f32\u4f4d\u548c64\u4f4d\uff09\uff0c\u4e3a\u4e86\u65b9\u4fbf\u5927\u5bb6\u8de8\u5e73\u53f0\u4f7f\u7528\u6574\u6570\u7c7b\u578b\u80fd\u591f\u201c\u5fc3\u4e2d\u6709\u6570\u201d\uff0cC99 \u589e\u52a0\u4e86\u6807\u51c6\u5934\u6587\u4ef6 &lt;stdint.h&gt;\uff0c\u91cc\u9762\u5b9a\u4e49\u4e86\u4e00\u7cfb\u5217\u7684\u7c7b\u578b\uff0c\u8fd9\u4e9b\u7c7b\u578b\u5728\u6240\u6709\u7b26\u5408 C99 \u7684\u5b9e\u73b0\u4e0a\u90fd\u5177\u6709\u4e00\u81f4\u7684\u8bed\u4e49\uff0c\u4e0b\u9762\u4ecb\u7ecd\u5176\u4e2d\u6700\u91cd\u8981\u7684\u51e0\u7c7b\u3002</p> <p>\u5177\u6709\u51c6\u786e\u957f\u5ea6\u7684\u6574\u6570\u7c7b\u578b</p> <ul> <li>int8_t uint8_t int16_t uint16_t</li> <li>int32_t uint32_t int64_t uint64_t</li> </ul> <p>\u4e0a\u9762\u7684 intN_t \u8868\u793a\u957f\u5ea6\u4e3a N \u4f4d\uff08\u4e0d\u542b\u586b\u5145\u4f4d\uff09\u3001\u4f7f\u7528\u201c2\u7684\u8865\u7801\u201d\u7684\u5e26\u7b26\u53f7\u6574\u6570\u7c7b \u578b\uff0c\u800c uintN_t \u5219\u8868\u793a\u957f\u5ea6\u4e3a N \u4f4d\uff08\u4e0d\u542b\u586b\u5145\u4f4d\uff09\u7684\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b\uff0c\u8fd9\u4e9b\u6574\u6570\u7c7b\u578b\u5bf9 \u5e94\u7684\u6700\u5927\u3001\u6700\u5c0f\u503c\u5206\u522b\u4e3a\uff08N = 8\uff0c16\uff0c32\uff0c64\uff09\uff1a</p> \u5b8f \u53c2\u8003\u503c\uff08\u7cbe\u786e\uff09 INTN_MIN -(2<sup>N-1</sup>) INTN_MAX 2<sup>N-1</sup>-1 UINTN_MAX 2^N-1 <p>\u9002\u5408\u5b58\u653e void \u6307\u9488\u7684\u6574\u6570\u7c7b\u578b\uff1aintptr_t / uintptr_t\u3002\u8fd9\u4e24\u79cd\u7c7b\u578b\u90fd\u662f\u53ef\u9009\u7684\uff0c\u5b83\u4eec\u5206\u522b\u8868\u793a\u8db3\u591f\u7528\u6765\u5b58\u653e void \u6307\u9488\u7684\u6700\u5c0f\u5e26\u7b26\u53f7\u3001\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b\u3002</p> <p>Fixed width integer types (since C99)</p> <ul> <li><code>intptr_t</code>: integer type capable of holding a pointer</li> <li><code>uintptr_t</code>: unsigned integer type capable of holding a pointer</li> </ul> <p>\u4e86\u89e3 C \u8bed\u8a00\u7684\u6240\u6709\u8fd9\u4e9b\u6700\u91cd\u8981\u7684\u6574\u6570\u7c7b\u578b\u4e4b\u540e\uff0c\u4e0b\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\u641e\u6e05\u695a\u7f16\u8bd1\u5668\u5728\u600e\u6837\u7684\u60c5\u51b5\u4e0b\u4f1a\u628a\u4e00\u4e2a\u53d8\u91cf\u6216\u8005\u5e38\u6570\u770b\u4f5c\u4ec0\u4e48\u6837\u7684\u6574\u6570\u7c7b\u578b\u3002</p>","tags":["data_type","standard","integer"]},{"location":"blog/20211001/c-standard-integer-types/#single_char_constant","title":"single char constant","text":"<p>\u5728 C \u8bed\u8a00\u521a\u521a\u88ab\u8bbe\u8ba1\u51fa\u6765\u7684\u65f6\u5019\uff0c\u4e00\u5171\u53ea\u6709\u4e24\u79cd\u6574\u6570\u7c7b\u578b\u2014\u2014 <code>char</code> \u548c <code>int</code>\uff0c\u5728\u5b9e\u9645\u7684\u8fd0\u7b97\u5f53\u4e2d\uff0cchar \u603b\u662f\u5148\u88ab\u63d0\u5347\u4e3a int\u3002</p> <p>\u53e6\u5916\uff0c\u5728 C \u8bed\u8a00\u4e2d\uff0c\u5355\u5b57\u8282\u5b57\u7b26\u5e38\u6570\u7684\u7c7b\u578b\u4ece\u4e00\u5f00\u59cb\u5230\u73b0\u5728\u90fd\u662f int\uff08\u5355\u5b57\u8282\u5b57\u7b26\u5e38\u6570\u6307 'A'\u3001'\\n'\u3001'\\045'\u3001'\\x33' \u7b49\u5e38\u91cf\uff09\u3002\u672c\u6765\u5927\u5bb6\u5f88\u81ea\u7136\u5730\u4ee5\u4e3a 'A' \u5e94\u8be5\u662f char \u7c7b\u578b\u7684\uff0c\u4e0d\u662f\u5417\uff1f\u4f8b\u5982\uff1a</p> <pre><code>char c = 'A';\n</code></pre> <p>\u4e0a\u9762\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7684\u786e\u5f15\u8d77\u4e86\u6211\u4eec\u7684\u9519\u89c9\u3002'A' \u660e\u663e\u4ee3\u8868\u4e00\u4e2a\u5355\u5b57\u8282\u5b57\u7b26\u503c\uff0c\u628a\u8fd9\u4e2a\u4ee3\u8868\u5b57\u7b26\u7684\u503c\u8d4b\u7ed9 char \u53d8\u91cf\uff0c\u53ef\u8c13\u201c\u95e8\u5f53\u6237\u5bf9\u201d\u7684\u4e8b\u554a\u2026\u2026\u7136\u800c\uff0c'A'\u867d\u7136\u4ee3\u8868\u4e00\u4e2a\u5355\u5b57\u8282\u5b57\u7b26\u503c\uff0c\u4f46\u540c\u65f6\u5b83\u7684\u503c\u5fc5\u987b\u8981\u7528\u4e0e int \u7b49\u957f\u7684\u7a7a\u95f4\u6765\u5b58\u50a8\uff0c\u56e0\u6b64\u5b83\u7684\u8eab\u4efd\u662f\u4e0d\u6298\u4e0d\u6263\u7684 int\u3002\u8fd9\u4e5f\u662f char \u53d8\u91cf\u5fc5\u987b\u63d0\u5347\u4e3a int \u518d\u53c2\u4e0e\u8fd0\u7b97\u7684\u89c4\u5219\u7684\u53e6\u4e00\u4e2a\u53cd\u6620\u2014\u2014\u53cd\u6b63\u5230\u5934\u6765\u8fd8\u662f\u5f97\u63d0\u5347\u4e3a int\uff0c\u7d22\u6027\u4e00\u5f00\u59cb\u5c31\u7ed9\u5b83 int \u7684\u8eab\u4efd\uff01\u81f3\u4e8e\u4e0a\u9762\u90a3\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5b83\u7684\u4f5c\u7528\u76f8\u5f53\u4e8e\u628a\u4e00\u4e2a\u66fe\u7ecf\u63d0\u5347\u4e3a int \u7c7b\u578b\u7684 char \u6570\u503c\u8fd8\u539f\u56de char \u800c\u5df2\uff0c\u5b8c\u5168\u6ca1\u6709\u95ee\u9898\u3002\u867d\u7136 C89 \u5f00\u59cb\u786e\u7acb\u4e86\u4e00\u7cfb\u5217\u7684\u65b0\u89c4\u5219\uff0c\u4f46 <code>\u5355\u5b57\u8282\u5b57\u7b26\u5e38\u91cf\u7684\u7c7b\u578b\u662f int</code> \u8fd9\u4e2a\u60ef\u4f8b\u4ecd\u7136\u88ab\u4fdd\u7559\u4e0b\u6765\uff0c\u5373\u4f7f\u5230\u4e86 C99\u4e5f\u540c\u6837\u5982\u6b64\uff1a</p> sizeof-char-literal.c<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char* argv[]) {\n    printf(\"sizeof('A') = %zu\\n\",sizeof('A'));\n\n    return 0;\n}\n</code></pre> <p>\u7531\u4e8e sizeof \u662f\u7f16\u8bd1\u671f\u5c31\u786e\u5b9a\u7684\u6570\u503c\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u4ece\u6c47\u7f16\u4ee3\u7801\u4e2d\u770b\u51fa\u5b83\u7684\u5177\u4f53 \u503c\uff0c\u4e0d\u8fc7\u8fd9\u91cc\u8fd8\u662f\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\u518d\u8fd0\u884c\uff1a</p> <pre><code>$ cc single-char.c -o single-char &amp;&amp; ./single-char\nsizeof('A') = 4\n</code></pre> <p>\u663e\u7136\uff0c'A' \u8981\u5360\u75284\u4e2a\u5b57\u8282\uff0c\u572832\u4f4d\u5e73\u53f0\u4e0a\u8fd9\u6070\u597d\u5c31\u662f\u4e00\u4e2a int \u7684\u957f\u5ea6\u3002\u7efc\u5408\u4e0a\u9762\u6240\u8bf4\uff0c\u5728 C \u8bed\u8a00\u7684\u65e9\u671f\uff0c\u8981\u786e\u5b9a\u4e00\u4e2a\u8868\u8fbe\u5f0f\u91cc\u7684\u6574\u578b\u53d8\u91cf\u6216\u8005\u5e38\u6570\u7684\u5177\u4f53\u7c7b\u578b\u5e76\u4e0d\u590d\u6742\uff0c\u539f\u672c\u5c31\u53ea\u6709\u4e24\u79cd\u6574\u6570\u7c7b\u578b\uff0c\u5728\u8fd0\u7b97\u548c\u4f20\u9012\u53c2\u6570\u65f6 char \u53c8\u603b\u662f\u5148\u88ab\u63d0\u5347\u4e3a int\uff0c\u52a0\u4e0a\u6574\u578b\u5e38\u6570\u5c5e\u4e8e int \u7c7b\u578b\u3001\u5355\u5b57\u8282\u5b57\u7b26\u5e38\u91cf\u4e5f\u5c5e\u4e8e int \u7c7b\u578b\u2014\u2014\u4e00\u5207\u90fd\u975e\u5e38\u6e05\u695a\u3002</p>","tags":["data_type","standard","integer"]},{"location":"blog/20211001/c-standard-integer-types/#char_signed_or_unsigned","title":"char: signed or unsigned?","text":"<p>\u540e\u6765\uff0c\u968f\u7740 C \u8bed\u8a00\u7684\u8fdb\u4e00\u6b65\u53d1\u5c55\uff0cK&amp;R C \u5f15\u5165\u4e86\u65e0\u7b26\u53f7\u6574\u6570\u7684\u6982\u5ff5\u4ee5\u53ca <code>unsigned</code> \u5173\u952e\u5b57\uff0c\u5e76\u589e\u52a0\u4e86 short\u3001long \u4e24\u79cd\u6574\u6570\u7c7b\u578b\u3002\u8fd9\u65f6\uff0cC \u8bed\u8a00\u5df2\u7ecf\u62e5\u6709\u4ee5\u4e0b\u6574\u6570\u7c7b\u578b\uff1a</p> <ul> <li>char / unsigned char</li> <li>short / unsigned short</li> <li>int / unsigned int</li> <li>long / unsigned long</li> </ul> <p>\u81f3\u6b64\uff0c\u60c5\u51b5\u5f00\u59cb\u53d8\u5f97\u590d\u6742\u3002\u5728\u8fdb\u4e00\u6b65\u5206\u6790 unsigned \u5f15\u5165\u7684\u95ee\u9898\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6e05\u7b97\u4e00\u4e0b \u5173\u4e8e char \u7684\u65e7\u8d26\u3002\u5728 D.M.Ritchie \u8bbe\u8ba1 C \u8bed\u8a00\u7684\u65e9\u671f\uff0cchar \u53d8\u91cf\u53ea\u662f\u7528\u6765\u5b58\u653e ASCII \u5b57\u7b26\uff0c\u7531\u4e8e ASCII \u662f7\u4f4d\u7f16\u7801\u4f53\u7cfb10\uff0c\u7528\u6700\u5c0f\u7684\u5b58\u50a8\u5355\u4f4d\u2014\u2014\u5b57\u8282\u6765\u5b58\u653e char \u53d8\u91cf\u5b8c\u5168\u8db3\u591f\u3002\u867d\u7136 ASCII \u5b57\u7b26\u503c\u53ea\u5360\u7528\u4e00\u4e2a\u5b57\u8282\u7684\u4f4e7\u4f4d\u4ece\u800c\u4f7f\u5230\u4e00\u4e2a char \u53d8\u91cf\u4e0d\u5e94\u8be5\u51fa\u73b0\u8d1f\u503c\uff0cD.M.Ritchie \u672c\u4eba\u8fd8\u662f\u628a char \u5b9e\u73b0\u4e3a\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b\uff0c\u5141\u8bb8 char \u53d8\u91cf\u51fa\u73b0\u8d1f\u503c\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cchar \u53ea\u4e0d\u8fc7\u662f\u6bd4 int \u77ed\u4e00\u4e9b\u7684\u6574\u6570\u7c7b\u578b\u7f62\u4e86\u3002</p> <p>\u4e0d\u8fc7\uff0c\u5176\u5b83\u4e00\u4e9b C \u5b9e\u73b0\u5e73\u53f0\u7684\u505a\u6cd5\u6709\u6240\u4e0d\u540c\u3002\u4f8b\u5982\uff0c\u67d0\u4e9b\u5e73\u53f0\u4f7f\u75288\u4f4d\u7684\u6269\u5c55\u7f16\u7801\u4f53\u7cfb\uff0c\u4e3a\u4e86\u80fd\u591f\u8868\u8fbe\u5b57\u7b26\u96c6\u91cc\u6240\u6709\u7684\u5b57\u7b26\uff0c\u8fd9\u4e9b\u5e73\u53f0\u4e0a\u7684 char \u53d8\u91cf\u8fde\u6700\u9ad8\u4f4d\u4e5f\u6d3e\u4e0a\u7528\u573a\u4e86\u3002 \u5728\u8fd9\u79cd\u60c5\u5f62\u4e0b\uff0c\u5f88\u96be\u8bf4\u670d\u4eba\u4eec\u628a\u6700\u9ad8\u4f4d\u662f\u201c1\u201d\u7684 char \u503c\u770b\u4f5c\u8d1f\u6570\uff0c\u4e8e\u662f\uff0c\u5728\u8fd9\u90e8\u5206\u7684 C \u5b9e\u73b0\u4e2d\uff0cchar \u7684\u5b58\u5728\u65b9\u5f0f\u6070\u597d\u548c\u5f53\u521d\u7684\u8bbe\u8ba1\u76ee\u7684\u4e0d\u8c0b\u800c\u5408 \u2014\u2014 char \u503c\u6c38\u4e0d\u4e3a\u8d1f\u30020xFF \u4e0d\u662f\u201c-1\u201d\u800c\u662f255\u3002</p> <p>\u5230\u4e86 K&amp;R C \u5f15\u5165 unsigned \u5173\u952e\u5b57\u4ee5\u540e\uff0c\u57fa\u4e8e char \u7684\u5206\u6b67\u5df2\u7ecf\u6839\u6df1\u8482\u56fa\uff0cunsigned char\u3001unsigned short\u3001unsigned int\u3001unsigned long \u90fd\u5c5e\u4e8e\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b\uff0c\u800c short\u3001int\u3001long \u5c5e\u4e8e\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b\uff0c\u8fd9\u4e9b\u90fd\u6beb\u65e0\u7591\u95ee\uff0c\u504f\u504f char \u4f8b\u5916\u3002char \u5c5e\u4e8e\u4ec0\u4e48\u7c7b\u578b\uff1f\u5728\u90a3\u4e9b\u4e00\u76f4\u628a char \u5b9e\u73b0\u4e3a\u5e26\u7b26\u53f7\u6574\u6570\u7684\u5e73\u53f0\u4e0a\uff0cchar \u5c5e\u4e8e\u5e26\u7b26\u53f7\u7c7b\u578b\uff1b\u800c\u5728\u53e6\u5916\u90a3\u4e9b\u4f7f\u75288\u4f4d\u5b57\u7b26\u7f16\u7801\u7684\u5b9e\u73b0\u91cc\uff0cchar \u540d\u526f\u5176\u5b9e\u5730\u62d2\u7edd\u8d1f\u6570\u7684\u6982\u5ff5\uff0c\u5f88\u660e\u663e\u8fd9\u4e9b\u5e73\u53f0\u4e0a\u7684 char \u76f8\u5f53\u4e8e unsigned char\u3002</p> <p>\u5927\u5bb6\u53ef\u80fd\u4f1a\u95ee\uff0c\u5728\u90a3\u4e9b\u575a\u6301 char \u6c38\u4e0d\u4e3a\u8d1f\u7684\u5b9e\u73b0\u91cc\u5c82\u4e0d\u662f\u5c11\u4e86\u4e00\u79cd8\u4f4d\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b\uff1f\u56e0\u4e3a\u5728 char \u88ab\u5b9e\u73b0\u4e3a\u5e26\u7b26\u53f7\u6574\u6570\u7684\u5e73\u53f0\u4e0a\u53ef\u4ee5\u901a\u8fc7\u52a0\u4e0a unsigned \u5173\u952e\u5b57\u6765\u6784\u9020\u975e\u8d1f\u7684 char \u53d8\u91cf\uff0c\u4f46\u5374\u6ca1\u6709\u529e\u6cd5\u8ba9\u53e6\u5916\u90a3\u4e9b\u5e73\u53f0\u4f7f\u7528\u6c38\u8fdc\u975e\u8d1f\u7684 char \u6765\u5b58\u653e\u8d1f\u6570\u554a\u3002</p> <p>\u5bf9\uff0c\u6b63\u56e0\u4e3a\u5982\u6b64\uff0cC89 \u624d\u4f1a\u5f15\u5165 <code>signed</code> \u5173\u952e\u5b57\u3002\u5982\u679c\u4e0d\u4e86\u89e3\u8fd9\u6bb5\u5386\u53f2\uff0c\u5927\u5bb6\u80af\u5b9a\u4f1a\u8ba4\u4e3a signed \u5173\u952e\u5b57\u7b80\u76f4\u5c31\u662f\u5e9f\u7269\u2014\u2014\u5df2\u7ecf\u4e13\u95e8\u6709\u4e00\u4e2a unsigned \u88ab\u53d1\u660e\u51fa\u6765\u8868\u793a\u65e0\u7b26\u53f7\u6574\u6570\u7684\u6982\u5ff5\uff0c\u90a3\u53ea\u8981\u4e0d\u4f7f\u7528 unsigned \u6765\u4fee\u9970\u4e0d\u5c31\u610f\u5473\u7740\u5e26\u7b26\u53f7\u6574\u6570\u5417\uff0c\u4f55\u5fc5\u518d\u6765\u4e00\u4e2a signed \u5462\uff1f\u5bf9\u4e8e short\u3001int\u3001long \u8fd9\u4e9b\u7c7b\u578b\u6765\u8bf4\uff0csigned \u771f\u7684\u662f\u591a\u4f59\uff0c\u4f46\u5bf9\u4e8e char\uff0c\u5173\u952e\u5b57 signed \u662f\u5fc5\u8981\u7684\u3002\u5426\u5219\u5927\u5bb6\u5c31\u4e0d\u77e5\u9053\u81ea\u5df1\u7684 char \u53d8\u91cf\u5728\u4e0d\u540c\u7684\u5e73\u53f0\u4f1a\u6709\u4ec0\u4e48\u8868\u73b0\uff0c\u5728\u4e00\u4e2a\u5e73\u53f0\u4e0a\u662f\u8d1f\u6570\uff0c\u5728\u53e6\u4e00\u4e2a\u5e73\u53f0\u4e0a\u53c8\u88ab\u89e3\u91ca\u4e3a\u6c38\u8fdc\u975e\u8d1f\uff0c\u8fd9\u4e0e C \u7684\u6807\u51c6\u5316\u5b8c\u5168\u76f8\u62b5\u3002\u6709\u4e86 signed\uff0c\u6211\u4eec\u5c31\u80fd\u907f\u5f00\u8fd9\u4e2a\u9677\u9631\uff0c\u660e\u786e\u8868\u8fbe\u81ea\u5df1\u7a76\u7adf\u60f3\u600e\u6837\u3002</p> <pre><code>signed char x;      /* \u65e0\u8bba\u5728\u54ea\u91cc\uff0cx \u90fd\u662f\u5e26\u7b26\u53f7\u6574\u578b\u53d8\u91cf */\nunsigned char y;    /* \u65e0\u8bba\u5728\u54ea\u91cc\uff0cy \u90fd\u662f\u65e0\u7b26\u53f7\u6574\u578b\u53d8\u91cf */\n</code></pre> <p>\u6240\u4ee5\uff0c\u524d\u9762\u5728\u8bb2\u8ff0\u6807\u51c6\u6574\u6570\u7c7b\u578b\u65f6\uff0c\u7b14\u8005\u5df2\u7ecf\u5728\u6ce8\u91ca\u91cc\u7740\u91cd\u5f3a\u8c03\uff1a\u5c5e\u4e8e\u6807\u51c6\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b\u7684\u662f signed char\uff08\u800c\u4e0d\u662f char\uff09\uff01char \u65e2\u4e0d\u5c5e\u4e8e\u6807\u51c6\u5e26\u7b26\u53f7\u6574\u6570\u7c7b\u578b\u4e5f\u4e0d\u5c5e\u4e8e\u6807\u51c6\u65e0\u7b26\u53f7\u6574\u6570\u7c7b\u578b\uff0c\u5b83\u5c5e\u4e8e\u5386\u53f2\u9057\u7269\u3002</p>","tags":["data_type","standard","integer"]},{"location":"blog/20211001/c-standard-integer-types/#signedness_of_char","title":"signedness of char","text":"","tags":["data_type","standard","integer"]},{"location":"blog/20211001/c-standard-integer-types/#gcc_c_dialect_options","title":"GCC C Dialect Options","text":"<p>GCC C Dialect Options \u4e2d\u63d0\u4f9b\u4e86 <code>-fsigned-char</code> \u548c <code>-funsigned-char</code> \u9009\u9879\uff0c\u652f\u6301\u660e\u786e\u6307\u5b9a <code>char</code> \u7684\u7b26\u53f7\u7c7b\u578b\u3002</p> <p>-fsigned-char &amp; -funsigned-char</p> <p><code>-fsigned-char</code></p> <p>Let the type char be signed, like signed char.</p> <p>Note that this is equivalent to -fno-unsigned-char, which is the negative form of -funsigned-char. Likewise, the option -fno-signed-char is equivalent to -funsigned-char.</p> <p><code>-funsigned-char</code></p> <p>Let the type char be unsigned, like unsigned char.</p> <p>Each kind of machine has a default for what char should be. It is either like unsigned char by default or like signed char by default.</p> <p>Ideally, a portable program should always use signed char or unsigned char when it depends on the signedness of an object. But many programs have been written to use plain char and expect it to be signed, or expect it to be unsigned, depending on the machines they were written for. This option, and its inverse, let you make such a program work with the opposite default.</p> <p>The type char is always a distinct type from each of signed char or unsigned char, even though its behavior is always just like one of those two.</p>","tags":["data_type","standard","integer"]},{"location":"blog/20211001/c-standard-integer-types/#c_standard_specs","title":"C++ standard specs","text":"<p>20230510 - ISO/IEC-N4950 - 6.8.2 Fundamental types</p> <p>Clause 7: Type <code>char</code> is a distinct type that has an implementation-defined choice of <code>signed char</code> or <code>unsigned char</code> as its underlying type. The three types <code>char</code>, <code>signed char</code>, and <code>unsigned char</code> are collectively called ordinary character types. The ordinary character types and <code>char8_t</code> are collectively called narrow character types.</p> <p>C++ Fundamental types</p> <p>Character types are integer types used for a character representation.</p> <p><code>signed char</code> \u2014 type for signed character representation. <code>unsigned char</code> \u2014 type for unsigned character representation. Also used to inspect object representations (raw memory). <code>char</code> \u2014 type for character representation which can be most efficiently processed on the target system (has the same representation and alignment as either <code>signed char</code> or <code>unsigned char</code>, but is always a distinct type). The signedness of char depends on the compiler and the target platform: the defaults for ARM and PowerPC are typically unsigned, the defaults for x86 and x64 are typically signed.</p> <p>\u6839\u636e &lt;climits&gt; \u4e2d\u5b9a\u4e49\u7684\u5b8f CHAR_MIN \u548c CHAR_MAX\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\u7b80\u5355\u5224\u65ad char \u9ed8\u8ba4\u7684\u7b26\u53f7\uff1a</p> <ol> <li>\u5224\u65ad CHAR_MAX == UCHAR_MAX\uff08\u6216 CHAR_MAX == SCHAR_MAX\uff09\uff0c\u76f4\u89c2\u8bc4\u5224\u3002</li> <li>\u5224\u65ad CHAR_MAX \u6700\u9ad8\u4f4d MSB\uff08most-signi\ufb01cant bit set\uff09\uff0c\u4e3a 0 \u8868\u793a\u6700\u9ad8\u4f4d\u4e3a\u7b26\u53f7\u4f4d\uff0c\u4e3a signed\uff1b\u5426\u5219\uff0c\u6700\u9ad8\u4f4d\u4e3a\u6570\u503c\u4f4d\uff0c\u4e3a unsigned\u3002</li> </ol> <p>\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> char-range.cchar-range.cpp <pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\nint main(int argc, char* argv[]) {\n    int chmin = CHAR_MIN;\n    int chmax = CHAR_MAX;\n\n    printf(\"CHAR_MIN = %d, CHAR_MAX = %d\\n\", chmin, chmax);\n    printf(\"(CHAR_MAX == UCHAR_MAX) = %d\\n\", CHAR_MAX == UCHAR_MAX);\n    printf(\"CHAR_MAX &gt;&gt; 7 = %d\\n\", CHAR_MAX &gt;&gt; 7);\n\n    return 0;\n}\n</code></pre> <pre><code>#include &lt;iostream&gt;\n#include &lt;climits&gt;\n\nint main(int argc, char* argv[]) {\n    std::cout &lt;&lt; \"CHAR_MIN = \" &lt;&lt; CHAR_MIN &lt;&lt; \", CHAR_MAX = \" &lt;&lt; CHAR_MAX &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"(CHAR_MAX == UCHAR_MAX) = \" &lt;&lt; (CHAR_MAX == UCHAR_MAX) &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"CHAR_MAX &gt;&gt; 7 = \" &lt;&lt; (CHAR_MAX &gt;&gt; 7) &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> macOS(arm64, x86_64)rpi4b-ubuntu/aarch64 <pre><code># mbpa2991/arm64, mbpa1398/x86_64\n# cc char-range.c -o char-range &amp;&amp; ./char-range\n$ c++ char-range.cpp -o char-range &amp;&amp; ./char-range\nCHAR_MIN = -128, CHAR_MAX = 127\n(CHAR_MAX == UCHAR_MAX) = 0\nCHAR_MAX &gt;&gt; 7 = 0\n</code></pre> <pre><code># cc char-range.c -o char-range &amp;&amp; ./char-range\n$ c++ char-range.cpp -o char-range &amp;&amp; ./char-range\nCHAR_MIN = 0, CHAR_MAX = 255\n(CHAR_MAX == UCHAR_MAX) = 1\nCHAR_MAX &gt;&gt; 7 = 1\n</code></pre>","tags":["data_type","standard","integer"]},{"location":"blog/20211001/c-standard-integer-types/#why_getchar_return_int","title":"why getchar() return int?","text":"<p>\u6700\u540e\uff0c\u6765\u770b\u4e00\u4e0b File input/output - &lt;stdio.h&gt; \u4e2d\u8bfb\u5199\u5b57\u7b26\u76f8\u5173\u63a5\u53e3\u7684\u53c2\u6570\u7c7b\u578b\uff1a</p> <pre><code>int fgetc( FILE *stream );\nint getc( FILE *stream );\nint getchar( void );\nint putchar( int ch );\nint ungetc( int ch, FILE *stream );\n</code></pre> <p>\u9065\u60f3\u5f53\u5e74\u521d\u5b66 C \u8bed\u8a00\uff0c\u76f8\u4fe1\u4e0d\u5c11\u4eba\u5bf9\u4e8e <code>getchar()</code> \u51fd\u6570\u5bb6\u65cf\u7684\u8fd4\u56de\u7c7b\u578b\u90fd\u4f1a\u6709\u6240\u56f0\u60d1\u3002</p> <p>\u5148\u6765\u770b\u4e00\u9053\u300aC \u8bed\u8a00\u6df1\u5ea6\u89e3\u5256\u300b\u9644\u5f55 1 \u4e2d\u7684 C \u8bed\u8a00\u57fa\u7840\u6d4b\u8bd5\u9898\uff1a</p> <ol> <li>\u4e0b\u9762\u7684\u4ee3\u7801\u6709\u4ec0\u4e48\u95ee\u9898\uff1f\u4e3a\u4ec0\u4e48\uff1f</li> </ol> getchar.c<pre><code>#include &lt;stdio.h&gt;\n\nchar c;\nc = getchar();\nif (EOF == c)\n{\n    do_something();\n}\n</code></pre> <p>\u6b64\u4e3a\u672c\u8282\u6807\u9898\u95ee\u9898\u7684\u884d\u751f\u95ee\u9898\uff0c\u5f04\u6e05\u695a\u4e86\u6807\u9898\u95ee\u9898\uff0c\u8be5\u6d4b\u8bd5\u9898\u7684\u7b54\u6848\u81ea\u7136\u660e\u4e86\u3002</p> <p>Why is getchar() function in C an Integer?</p> <p><code>getchar()</code> and family return an integer so that the <code>EOF</code> -1 is distinguishable from <code>(char)-1</code> or <code>(unsigned char)255</code>.</p> <p>Difference between int and char in getchar/fgetc and putchar/fputc?</p> <p>JohnLM</p> <p>JohnLM:</p> <p>Always use <code>int</code> to save character from <code>getchar()</code> as <code>EOF</code> constant is of int type. If you use <code>char</code> then the comparison against <code>EOF</code> is not correct.</p> <p>You can safely pass <code>char</code> to <code>putchar()</code> though as it will be promoted to <code>int</code> automatically.</p> <p>Antti Haapala</p> <p>Antti Haapala -- \u0421\u043b\u0430\u0432\u0430 \u0423\u043a\u0440\u0430\u0457\u043d\u0456:</p> <p>The reason why you must use <code>int</code> to store the return value of both <code>getchar</code> and <code>putchar</code> is that when the end-of-file condition is reached (or an I/O error occurs), both of them return the value of the macro <code>EOF</code> which is a negative integer constant, (usually -1).</p> <p>For <code>getchar</code>, if the return value is not <code>EOF</code>, it is the read unsigned char zero-extended to an <code>int</code>. That is, assuming 8-bit characters, the values returned can be <code>0...255</code> or the value of the macro <code>EOF</code>; again assuming 8-bit char, there is no way to squeeze these 257 distinct values into 256 so that each of them could be identified uniquely.</p> <p>4.1.3 Character I/O Using getchar() and putchar()</p> <p>to accommodate EOF</p> <p>The function <code>getchar()</code> reads a single character from the standard input and returns the character value as the value of the function, but to accommodate a possible negative value for <code>EOF</code>, the type of the value returned is <code>int</code>. (Recall, EOF may be either 0 or -1 depending on implementation). So we could use <code>getchar()</code> to read a character and assign the returned value to an integer variable:</p> <pre><code>    int c;\n    c = getchar();\n</code></pre> <p>If, after executing this statement, c equals EOF, we have reached the end of the input file; otherwise, c is the ASCII value of the next character in the input stream.</p> <p>While int type can be used to store the ASCII value of a character, programs can become confusing to read - we expect that the int data type is used for numeric integer data and that char data type is used for character data. The problem is that char type, depending on implementation, may or may not allow negative values. To resolve this, C allows us to explicitly declare a signed char data type for a variable, which can store negative values as well as positive ASCII values:</p> <pre><code>    signed char c;\n    c = getchar();\n</code></pre> <p>An explicit signed char variable ensures that a character is stored in a character type object while allowing a possible negative value for EOF. The keyword signed is called a type qualifier.</p> <p>A similar routine for character output is <code>putchar()</code>, which outputs its argument as a character to the standard output. Thus,</p> <pre><code>putchar(c);\n</code></pre> <p>outputs the ASCII character whose value is in c to the standard output. The argument of putchar() is expected to be an integer; however, the variable c may be either char type or int type (ASCII value) since the value of a char type is really an integer ASCII value.</p> <p>\u672c\u6587\u8282\u9009\u81ea \u300aC\u8bed\u8a00\u6807\u51c6\u4e0e\u5b9e\u73b0(\u59da\u65b0\u989c)-2004\u300b #2 \u6570\u503c\u8fd0\u7b97 | 12 \u6574\u6570\u7c7b\u578b\u3002</p>","tags":["data_type","standard","integer"]},{"location":"blog/20091001/c-standard/","title":"C Programming Language Standard","text":"<p>C Programming Language Standard from ANSI C to ISO C and standard library.</p>","tags":["standard","library"]},{"location":"blog/20091001/c-standard/#wiki","title":"wiki","text":"<p>C (programming language)</p> <p>C is a general-purpose computer programming language.</p> <p>C is an imperative procedural language, supporting structured programming, lexical variable scope, and recursion, with a static type system.</p> <p>C is an imperative, procedural language in the ALGOL tradition. It has a static type system. In C, all executable code is contained within subroutines (also called \"functions\", though not in the sense of functional programming).</p> <p>It was created in the 1970s by Dennis Ritchie, and remains very widely used and influential. By design, C's features cleanly reflect the capabilities of the targeted CPUs. It has found lasting use in operating systems, device drivers, and protocol stacks, but its use in application software has been decreasing. C is commonly used on computer architectures that range from the largest supercomputers to the smallest microcontrollers and embedded systems.</p> <p>C has been standardized since 1989 by the American National Standards Institute (ANSI) and the International Organization for Standardization (ISO).</p>","tags":["standard","library"]},{"location":"blog/20091001/c-standard/#ansi_c","title":"ANSI C","text":"<p>ANSI C</p> <ul> <li>The Origin of ANSI C and ISO C - ANSI Blog</li> <li>C Programming ANSI Keywords - Developer Help</li> </ul> <p>The_C_Programming_Language(2e)-1988 Preface:</p> <p>The computing world has undergone a revolution since the publication of The C Programming Language in 1978. Big computers are much bigger, and personal computers have capabilities that rival mainframes of a decade ago. During this time, C has changed too, although only modestly, and it has spread far beyond its origins as the language of the UNIX operating system.</p> <p>The growing popularity of C, the changes in the language over the years, and the creation of compilers by groups not involved in its design, combined to demonstrate a need for a more precise and more contemporary definition of the language than the first edition of this book provided. In 1983, the American National Standards Institute (ANSI) established a committee whose goal was to produce an unambiguous and machine-independent definition of the language C, while still retaining its spirit. The result is the <code>ANSI standard for C</code>.</p> <p>The standard formalizes constructions that were hinted but not described in the first edition, particularly structure assignment and enumerations. It provides a new form of function declaration that permits cross-checking of definition with use. It specifies a standard library, with an extensive set of functions for performing input and output, memory management, string manipulation, and similar tasks. It makes precise the behavior of features that were not spelled out in the original definition, and at the same time states explicitly which aspects of the language remain machine-dependent.</p> <p>This Second Edition of The C Programming Language describes C as defined by the ANSI standard. Although we have noted the places where the language has evolved, we have chosen to write exclusively in the new form. For the most part, this makes no significant difference; the most visible change is the new form of function declaration and definition. Modern compilers already support most features of the standard.</p>","tags":["standard","library"]},{"location":"blog/20091001/c-standard/#iso_c","title":"ISO C","text":"<p>C99 - ISO/IEC 9899:1999 C11 - ISO/IEC 9899:2011 C17 - ISO/IEC 9899:2018</p> <p>Jens Gustedt - Modern C v1/2019  - C versions</p> <p>As the title of this book suggests, today\u2019s C is not the same language as the one originally designed by its creators, Kernighan and Ritchie (usually referred to as K&amp;R C). In particular, it has undergone an important standardization and extension process, now driven by ISO, the International Standards Organization. This led to the publication of a series of C standards in 1989, 1999, 2011, and 2018, commonly referred to as C89, C99, C11, and C17.</p> <p>The C standards committee puts a lot of effort into guaranteeing backward compatibility such that code written for earlier versions of the language, say C89, should compile to a semantically equivalent executable with a compiler that implements a newer version. Unfortunately, this backward compatibility has had the unwanted side effect of not motivating projects that could bene\ufb01t greatly from the new features to update their code base.</p> <p>C Programming Language Standard - GeeksforGeeks</p>","tags":["standard","library"]},{"location":"blog/20091001/c-standard/#ansi_c_vs_iso_c","title":"ANSI C vs. ISO C","text":"<p>C (programming language) - 2.3 ANSI C and ISO C</p> <p>During the late 1970s and 1980s, versions of C were implemented for a wide variety of mainframe computers, minicomputers, and microcomputers, including the IBM PC, as its popularity began to increase significantly.</p> <p>In 1983, the American National Standards Institute (ANSI) formed a committee, X3J11, to establish a standard specification of C. X3J11 based the C standard on the Unix implementation; however, the non-portable portion of the Unix C library was handed off to the IEEE working group 1003 to become the basis for the 1988 POSIX standard. In 1989, the C standard was ratified as ANSI X3.159-1989 \"Programming Language C\". This version of the language is often referred to as ANSI C, Standard C, or sometimes C89.</p> <p>In 1990, the ANSI C standard (with formatting changes) was adopted by the International Organization for Standardization (ISO) as ISO/IEC 9899:1990, which is sometimes called C90. Therefore, the terms \"C89\" and \"C90\" refer to the same programming language.</p> <p>ANSI, like other national standards bodies, no longer develops the C standard independently, but defers to the international C standard, maintained by the working group ISO/IEC JTC1/SC22/WG14. National adoption of an update to the international standard typically occurs within a year of ISO publication.</p> <p>Difference between C and Ansi C</p> <p>What is difference between ANSI C and C Programming Language?</p> <p>Microsoft Learn: C++, C, and Assembler | ANSI C Conformance</p>","tags":["standard","library"]},{"location":"blog/20091001/c-standard/#standard_library","title":"Standard Library","text":"<p>C standard library</p> <ul> <li>C Standard Library header files - cppreference.com</li> <li>cplusplus.com/reference/clibrary/</li> </ul>","tags":["standard","library"]},{"location":"blog/20091001/c-standard/#gnu_c","title":"GNU C","text":"<p>The Open Group Unix Headers Index</p> <p>The GNU C Library The GNU C Reference Manual</p>","tags":["standard","library"]},{"location":"blog/20091001/c-standard/#other","title":"Other","text":"<p>uClibc - C library for developing embedded Linux systems diet libc - a libc optimized for small size musl libc - an implementation of the C standard library</p> <p>newlib-cygwin: wiki, @git, @github</p>","tags":["standard","library"]},{"location":"blog/20091001/c-standard/#ref_books","title":"ref books","text":"<p>C Programming Language, 2nd Edition - 1988</p> <ul> <li>Author: Brian W. Kernighan, Dennis M. Ritchie</li> <li>@princeton, PDF@nju</li> </ul> <p>Jens Gustedt - Modern C</p> <ul> <li>Modern C, Third Edition</li> </ul> <p>Modern C for Absolute Beginners: A Friendly Introduction to the C Programming Language, 2e-2024</p> <p>Programming from the Ground Up: Bartlett, Jonathan</p> <ul> <li>2004 - @gnu.org </li> <li>2009 </li> </ul> <p>Low-Level Programming: C, Assembly, and Program Execution on Intel\u00ae 64 Architecture, 1e-2017</p> <ul> <li>hservers PDF - Low Level Programming.pdf</li> <li>hservers webview - Low Level Programming.pdf</li> </ul> <p>\u300aC\u8bed\u8a00\u6df1\u5ea6\u89e3\u5256\uff08\u7b2c3\u7248\uff09\u300b(\u9648\u6b63\u51b2) - 2008,2012,2019 C\u8bed\u8a00\u6807\u51c6\u4e0e\u5b9e\u73b0(\u59da\u65b0\u989c)-2004 \u8001\u7801\u8bc6\u9014-\u4ece\u673a\u5668\u7801\u5230\u6846\u67b6\u7684\u7cfb\u7edf\u89c2\u9006\u5411\u4fee\u70bc\u4e4b\u8def-2012</p>","tags":["standard","library"]},{"location":"blog/20091003/cpp-data-types/","title":"C++ Data Types","text":"<p>Every name and every expression has a type that determines the operations that may be performed on it.</p> <p>Types built out of the built-in types using C++\u2019s abstraction mechanisms are called user-de\ufb01ned types. They are referred to as structures, classes and enumerations.</p>","tags":["data_type"]},{"location":"blog/20091003/cpp-data-types/#c_type","title":"C++ Type","text":"<p>C++ language Basic Concepts - Type</p> <p>Objects, references, functions including function template specializations, and expressions have a property called type, which both restricts the operations that are permitted for those entities and provides semantic meaning to the otherwise generic sequences of bits.</p> <ul> <li>Type classification</li> <li>Program-defined type</li> <li>Type naming</li> <li>Elaborated type specifier</li> <li>Static type</li> <li>Dynamic type</li> <li>Incomplete type</li> </ul> <p>There are fundamental types and compound types.</p> <ul> <li>Fundamental types are the arithmetic types, void, and std::nullptr_t.  </li> <li>Compound types are arrays, functions, pointers, references, classes, unions, enumerations, and pointers to non-static members.  </li> </ul> <p>C++ language Basic Concepts - Fundamental types</p> <ul> <li>Void type</li> <li>std::nullptr_t (since C++11)</li> <li>Data models</li> <li>Integral types</li> <li>Floating-point types</li> <li>Range of values</li> </ul> <p>C++ Utilities library - Type support (basic types, RTTI)</p> <ul> <li>Additional basic types and macros</li> <li>Fixed width integer types (since C++11)</li> <li>Fixed width floating-point types (since C++23)</li> <li>Numeric limits</li> <li>Runtime type identification</li> </ul> <p>Numerics library</p> <ul> <li>Mathematical functions and types</li> <li>Numeric algorithms</li> <li>Miscellanous</li> </ul> <p>C++98 : Variables. Data Types. C++ Language: Variables and types</p>","tags":["data_type"]},{"location":"blog/20091003/cpp-data-types/#integral_types","title":"Integral types","text":"<p>Modifies the basic integer type. Can be mixed in any order. Only one of each group can be present in type name.</p> <p>Signedness:</p> <ul> <li><code>signed</code> \u2014 target type will have signed representation (this is the default if omitted)</li> <li><code>unsigned</code> \u2014 target type will have unsigned representation</li> </ul> <p>Size:</p> <ul> <li><code>short</code> \u2014 target type will be optimized for space and will have width of at least 16 bits.</li> <li><code>long</code> \u2014 target type will have width of at least 32 bits.</li> <li><code>long long</code> \u2014 target type will have width of at least 64 bits. (since C++11)</li> </ul> <p>Modifiers Order Indiference</p> <p>as with all type specifiers, any order is permitted: unsigned long long int and long int unsigned long name the same type.</p> <p>Properties:</p> <p>The following table summarizes all available standard integer types and their properties in various common data models:</p>","tags":["data_type"]},{"location":"blog/20091003/cpp-data-types/#type_straits_and_constraints","title":"Type straits and Constraints","text":"<p>Type traits and metaprogramming library</p> <p>Type traits define compile-time template-based interfaces to query the properties of types.</p> <p>&lt;type_traits&gt;: This header defines a series of classes to obtain type information on compile-time.</p> <ul> <li>Helper classes: Standard classes to assist in creating compile-time constants.</li> <li>Type traits: Classes to obtain characteristics of types in the form of compile-time constant values.</li> <li>Type transformations: Classes to obtain new types by applying specific transformations to existing types.</li> </ul> <p>A basic trait for types is the categories in which they can be classified. This is a chart on how these categories overlap:</p> <ul> <li><code>*</code> = excluding unions</li> </ul> <p>Constraints and concepts &amp; Concepts library (since C++20)</p> <p>Class templates, function templates, and non-template functions (typically members of class templates) might be associated with a constraint, which specifies the requirements on template arguments, which can be used to select the most appropriate function overloads and template specializations.</p> <p>Named sets of such requirements are called concepts. Each concept is a predicate, evaluated at compile time, and becomes a part of the interface of a template where it is used as a constraint.</p>","tags":["data_type"]},{"location":"blog/20091003/cpp-data-types/#compiler_conformances","title":"Compiler Conformances","text":"<p>GCC libstdc++ Types</p> <p>MSDN - C++ Type System</p> <p>The following illustration shows the relative sizes of the built-in types in the Microsoft C++ implementation:</p> MSVC built-in type sizes <p>MSDN - Built-in types (C++)</p> <ul> <li>Void type</li> <li>std::nullptr_t</li> <li>Boolean type</li> <li>Character types</li> <li>Floating-point types</li> <li>Integer types</li> <li>Sizes of built-in types</li> </ul> <p>LLVM Features: The type system consists of basic types such as <code>integer</code> or <code>floating-point</code> numbers and five derived types: <code>pointers</code>, <code>arrays</code>, <code>vectors</code>, <code>structures</code>, and <code>functions</code>. A type construct in a concrete language can be represented by combining these basic types in LLVM. For example, a class in C++ can be represented by a mix of structures, functions and arrays of function pointers.</p>","tags":["data_type"]},{"location":"blog/20091003/cpp-data-types/#tcpl4","title":"TC++PL4","text":"<p>A Tour of C++(3e)-2022 The_C++_Programming_Language(4e)-2013</p> <ul> <li>2.2 The Basics | 2.2.2 Types, Variables, and Arithmetic</li> <li>2.3 User-De\ufb01ned Types : Structures; Classes; Enumerations</li> </ul> <p>C++ Data Types:</p> <p>TypeHiearchy.pdf:</p>","tags":["data_type"]},{"location":"blog/20091003/cpp-data-types/#22_the_basics","title":"2.2 The Basics","text":"<p>Every name and every expression has a type that determines the operations that may be performed on it. For example, the declaration</p> <p><pre><code>int inch;\n</code></pre> speci\ufb01es that inch is of type int; that is, inch is an integer variable.</p> <p>A declaration is a statement that introduces a name into the program. It speci\ufb01es a type for the named entity:</p> <ul> <li>A <code>type</code> de\ufb01nes a set of possible values and a set of operations (for an object).</li> <li>An <code>object</code> is some memory that holds a value of some type.</li> <li>A <code>value</code> is a set of bits interpreted according to a type.</li> <li>A <code>variable</code> is a named object.</li> </ul> <p>Each fundamental type corresponds directly to hardware facilities and has a \ufb01xed size that determines the range of values that can be stored in it.</p> <ul> <li>bool: 1</li> <li>char: 1</li> <li>int: 4</li> <li>double: 8</li> </ul> <p>A char variable is of the natural size to hold a character on a given machine (typically an 8-bit byte), and the sizes of other types are quoted in multiples of the size of a char. The size of a type is implementation-de\ufb01ned (i.e., it can vary among different machines) and can be obtained by the sizeof operator; for example, sizeof(char) equals 1 and sizeof(int) is often 4.</p>","tags":["data_type"]},{"location":"blog/20091003/cpp-data-types/#23_user-de\ufb01ned_types","title":"2.3 User-De\ufb01ned Types","text":"<p>We call the types that can be built from the fundamental types, the const modi\ufb01er, and the declarator operators built-in types. C++\u2019s set of built-in types and operations is rich, but deliberately low-level. They directly and ef\ufb01ciently re\ufb02ect the capabilities of conventional computer hardware. However, they don\u2019t provide the programmer with high-level facilities to conveniently write advanced applications. Instead, C++ augments the built-in types and operations with a sophisticated set of abstraction mechanisms out of which programmers can build such high-level facilities.</p> <p>The C++ abstraction mechanisms are primarily designed to let programmers design and implement their own types, with suitable representations and operations, and for programmers to simply and elegantly use such types. Types built out of the built-in types using C++\u2019s abstraction mechanisms are called user-de\ufb01ned types. They are referred to as structures, classes and enumerations.</p> <p>User-defined types can be built out of both built-in types and other user-defined types. User-defined types are often preferred over built-in types because they are easier to use, less error-prone, and typically as efficient for what they do as direct use of built-in types, or even more efficient.</p>","tags":["data_type"]},{"location":"blog/20091001/cpp-standard/","title":"C++ Programming Language Standard","text":"<p>C++ Programming Language Standard and standard library.</p>","tags":["standard","library"]},{"location":"blog/20091001/cpp-standard/#wiki","title":"wiki","text":"<p>C++</p> <p>C++ (pronounced \"C plus plus\" and sometimes abbreviated as CPP) is a high-level, general-purpose programming language created by Danish computer scientist Bjarne Stroustrup. First released in 1985 as an extension of the C programming language, it has since expanded significantly over time; as of 1997, C++ has object-oriented, generic, and functional features, in addition to facilities for low-level memory manipulation for making things like microcomputers or to make operating systems like Linux or Windows. It is almost always implemented as a compiled language, and many vendors provide C++ compilers, including the Free Software Foundation, LLVM, Microsoft, Intel, Embarcadero, Oracle, and IBM.</p> <p>C++ was designed with systems programming and embedded, resource-constrained software and large systems in mind, with performance, efficiency, and flexibility of use as its design highlights. C++ has also been found useful in many other contexts, with key strengths being software infrastructure and resource-constrained applications, including desktop applications, video games, servers (e.g., e-commerce, web search, or databases), and performance-critical applications (e.g., telephone switches or space probes).</p>","tags":["standard","library"]},{"location":"blog/20091001/cpp-standard/#isocpp","title":"isocpp","text":"<p>C++ is standardized by the International Organization for Standardization (ISO), with the latest standard version ratified and published by ISO in December 2020 as ISO/IEC 14882:2020 (informally known as C++20). The C++ programming language was initially standardized in 1998 as ISO/IEC 14882:1998, which was then amended by the C++03, C++11, C++14, and C++17 standards. The current C++20 standard supersedes these with new features and an enlarged standard library. Before the initial standardization in 1998, C++ was developed by Stroustrup at Bell Labs since 1979 as an extension of the C language; he wanted an efficient and flexible language similar to C that also provided high-level features for program organization. Since 2012, C++ has been on a three-year release schedule with C++23 as the next planned standard.</p> <p>News, Status &amp; Discussion about Standard C++</p> <p>The Standard : Standard C++</p> <ul> <li>C++ FAQ</li> </ul> <p>The C++ Standards Committee - ISOCPP</p> <ul> <li>cplusplus/draft</li> </ul> <p>C++ Core Guidelines</p> <p>Meeting C++</p>","tags":["standard","library"]},{"location":"blog/20091001/cpp-standard/#history","title":"History","text":"<ul> <li>C++ History</li> <li>History of C++</li> </ul> <p>D&amp;E: The Design and Evolution of C++-1994 TC++PL: The_C++_Programming_Language(4e)-2013</p> <ul> <li>Part I: Introductory Material | 1. Notes to the Reader | 1.4 History</li> </ul> <p>Tour++: A Tour of C++(3e)-2022</p> <ul> <li>19.1 History</li> </ul> <p>Current ISO C++ status: Recent milestones</p> <ul> <li>C++98/03: Traditional C++  </li> <li>C++0x/C++11: Modern C++  </li> </ul>","tags":["standard","library"]},{"location":"blog/20091001/cpp-standard/#specifications","title":"Specifications","text":"<p>C++98 - ISO/IEC 14882:1998 C++03 - ISO/IEC 14882:2003 C++11 - ISO/IEC 14882:2011 C++14 - ISO/IEC 14882:2014 C++17 - ISO/IEC 14882:2017 C++20 - ISO/IEC 14882:2020</p> <p>open-std : C++ - Standards</p>","tags":["standard","library"]},{"location":"blog/20091001/cpp-standard/#features","title":"features","text":"<p>C++0x Concepts \u2014 Historical FAQs</p> <p>C++11 Overview C++11 Language Extensions \u2014 General Features, C++ FAQ</p> <p>C++14 Overview C++14 Language Extensions, C++ FAQ</p> <p>Changes between C++14 and C++17 C++17 Features--Bartlomiej Filipek : Standard C++</p> <p>All C++20 core language features with examples--Oleksandr Koval : Standard C++ 20 Smaller yet Handy C++20 Features--Bartlomiej Filipek : Standard C++</p> <p>refs: C++ compiler support\u3002</p> <ul> <li>A Tour of C++(3e)-2022 by Bjarne Stroustrup, 19.2 C++ Feature Evolution</li> <li>\u73b0\u4ee3C++\u8bed\u8a00\u6838\u5fc3\u7279\u6027\u89e3\u6790-2021 + cpp23\uff0c\u8c22\u4e19\u5803 \u8457</li> <li>Modern C++ Programming Cookbook: up to C++20 - 2e, 2020, Bancila Marius</li> <li>Modern C++ for Absolute Beginners: A Friendly Introduction to the C++ Programming Language and C++11 to C++23 Standards by Slobodan Dmitrovi\u0107</li> </ul>","tags":["standard","library"]},{"location":"blog/20091001/cpp-standard/#standard_library","title":"Standard Library","text":"<p>C++ Standard Library</p> <ul> <li>cppreference.com</li> <li>cplusplus.com : Reference &amp; Tutorials</li> </ul>","tags":["standard","library"]},{"location":"blog/20091001/cpp-standard/#boost","title":"boost","text":"<p>boost.org @github</p> <ul> <li>Boost Library Documentation</li> </ul> <p>Asio C++ Library @github</p>","tags":["standard","library"]},{"location":"blog/20091001/cpp-standard/#gnu_c","title":"GNU C++","text":"<p>The Open Group Unix System Interfaces: Detailed ToC</p> <p>The GNU C++ Library The GNU C++ Library Manual</p>","tags":["standard","library"]},{"location":"blog/20091001/cpp-standard/#ref_books","title":"ref books","text":"<p>D&amp;E: The Design and Evolution of C++-1994 TC++PL: The_C++_Programming_Language(4e)-2013 Tour++: A Tour of C++(3e)-2022</p> <p>Programming_Principles-and-Practice-Using-C++(3e)-2024 C++-how-to-program(10e)-2017 C++-Primer(5e)-3p-2013</p> <p>Effective-C++(3e)-2005 Effective-modern-C++-2015</p> <p>Inside-the-C++-Object-Model(1996)-en</p> <ul> <li>\u300a\u6df1\u5ea6\u63a2\u7d22C++\u5bf9\u8c61\u6a21\u578b\u300b(\u8c46\u74e3) - \u7535\u5b50\u5de5\u4e1a\u51fa\u7248\u793e\uff0c2012\u7248</li> <li>\u300a\u6df1\u5ea6\u63a2\u7d22C++\u5bf9\u8c61\u6a21\u578b\u300b(\u4eac\u4e1c) - \u7535\u5b50\u5de5\u4e1a\u51fa\u7248\u793e\uff0c2020\u7248</li> </ul> <p>Essential-C++-1999 - cn - 2013 (\u8c46\u74e3)</p> <p>Thinking-in-C++(e2)-2000-V1 Thinking-in-C++(e1)-2003-V2 Thinking-in-C++-bound-cn-2011</p>","tags":["standard","library"]},{"location":"blog/20230601/cpp-std-data-types/","title":"C++ Standard - Data Types","text":"<p>ISO/IEC C++ standard basic types specification: Fundamental types, Compound types and CV-qualifiers.</p> <p>ISO/IEC-N4950 - 20230510</p>","tags":["standard","data_type"]},{"location":"blog/20230601/cpp-std-data-types/#682_fundamental_types","title":"6.8.2 Fundamental types","text":"<p>[basic.fundamental]</p> <ol> <li> <p>There are five standard signed integer types: <code>signed char</code>, <code>short int</code>, <code>int</code>, <code>long int</code>, and <code>long long int</code>. In this list, each type provides at least as much storage as those preceding it in the list. There may also be implementation-defined extended signed integer types. The standard and extended signed integer types are collectively called signed integer types. The range of representable values for a signed integer type is \u22122<sup>N\u22121</sup> to 2<sup>N\u22121</sup> \u2212 1 (inclusive), where N is called the width of the type.</p> <p>Plain ints</p> <p>Plain ints are intended to have the natural width suggested by the architecture of the execution environment; the other signed integer types are provided to meet special needs.</p> </li> <li> <p>For each of the standard signed integer types, there exists a corresponding (but different) standard unsigned integer type: <code>unsigned char</code>, <code>unsigned short int</code>, <code>unsigned int</code>, <code>unsigned long int</code>, and <code>unsigned long long int</code>. Likewise, for each of the extended signed integer types, there exists a corresponding extended unsigned integer type. The standard and extended unsigned integer types are collectively called unsigned integer types. An unsigned integer type has the same width N as the corresponding signed integer type. The range of representable values for the unsigned type is 0 to 2<sup>N</sup> \u2212 1 (inclusive); arithmetic for the unsigned type is performed modulo 2<sup>N</sup>.</p> <p>signed arithmetic overflow</p> <p>Unsigned arithmetic does not overflow. Overflow for signed arithmetic yields undefined behavior (7.1).</p> </li> <li> <p>An unsigned integer type has the same object representation, value representation, and alignment requirements (6.7.6) as the corresponding signed integer type. For each value x of a signed integer type, the value of the corresponding unsigned integer type congruent to x modulo 2<sup>N</sup> has the same value of corresponding bits in its value representation.</p> <p>Table 14: Minimum width - [tab:basic.fundamental.width]</p> Type Minimum width N signed char 8 short int 16 int 16 long int 32 long long int 64 <p>signed -1, unsigned max</p> <p>The value <code>\u22121</code> of a signed integer type has the same representation as the largest value of the corresponding unsigned type.</p> </li> <li> <p>The width of each signed integer type shall not be less than the values specified in Table 14. The value representation of a signed or unsigned integer type comprises N bits, where N is the respective width. Each set of values for any padding bits (6.8.1) in the object representation are alternative representations of the value specified by the value representation.</p> <p>padding bits</p> <p>Padding bits have unspecified value, but cannot cause traps. In contrast, see ISO C 6.2.6.2.</p> <p>signed and unsigned constraints</p> <p>The signed and unsigned integer types satisfy the constraints given in ISO C 5.2.4.2.1.</p> </li> </ol> <ul> <li>Except as specified above, the width of a signed or unsigned integer type is implementation-defined.</li> </ul> <ol> <li>Each value x of an unsigned integer type with width <code>N</code> has a unique representation \\(x = x_{0}2^0 + x_{1}2^1 + \\dotsc + x_{N-1}2^{N-1}\\) , where each coefficient x i is either 0 or 1; this is called the base-2 representation of x. The base-2 representation of a value of signed integer type is the base-2 representation of the congruent value of the corresponding unsigned integer type. The standard signed integer types and standard unsigned integer types are collectively called the standard integer types, and the extended signed integer types and extended unsigned integer types are collectively called the extended integer types.</li> </ol> \\[ B2U_n(\\vec{x}) \\dot=\\sum_{i=0}^{N-1}x_i\\ast2^i \\] <ol> <li> <p>A fundamental type specified to have a signed or unsigned integer type as its underlying type has the same object representation, value representation, alignment requirements (6.7.6), and range of representable values as the underlying type. Further, each value has the same representation in both types.</p> </li> <li> <p>Type <code>char</code> is a distinct type that has an implementation-defined choice of <code>signed char</code> or <code>unsigned char</code> as its underlying type. The three types <code>char</code>, <code>signed char</code>, and <code>unsigned char</code> are collectively called ordinary character types. The ordinary character types and <code>char8_t</code> are collectively called narrow character types. For narrow character types, each possible bit pattern of the object representation represents a distinct value.</p> <p>Note 5</p> <p>This requirement does not hold for other types.</p> <p>Note 6</p> <p>A bit-field of narrow character type whose width is larger than the width of that type has padding bits; see 6.8.1.</p> </li> <li> <p>Type <code>wchar_t</code> is a distinct type that has an implementation-defined <code>signed</code> or <code>unsigned</code> integer type as its underlying type.</p> </li> <li> <p>Type <code>char8_t</code> denotes a distinct type whose underlying type is <code>unsigned char</code>. Types <code>char16_t</code> and <code>char32_t</code> denote distinct types whose underlying types are <code>uint_least16_t</code> and <code>uint_least32_t</code>, respectively, in &lt;cstdint&gt; (17.4.1).</p> </li> <li> <p>Type <code>bool</code> is a distinct type that has the same object representation, value representation, and alignment requirements as an implementation-defined unsigned integer type. The values of type bool are true and false.</p> <p>distinction/uniqeness of bool</p> <p>There are no signed, unsigned, short, or long bool types or values.</p> </li> <li> <p>The types <code>char</code>, <code>wchar_t</code>, <code>char8_t</code>, <code>char16_t</code>, and <code>char32_t</code> are collectively called character types. The character types, bool, the signed and unsigned integer types, and cv-qualified versions (6.8.5) thereof, are collectively termed integral types. A synonym for integral type is integer type.</p> <p>Enumerations</p> <p>Enumerations (9.7.1) are not integral; however, unscoped enumerations can be promoted to integral types as specified in 7.3.7.</p> </li> <li> <p>The three distinct types <code>float</code>, <code>double</code>, and <code>long double</code> can represent floating-point numbers. The type double provides at least as much precision as float, and the type long double provides at least as much precision as double. The set of values of the type float is a subset of the set of values of the type double; the set of values of the type double is a subset of the set of values of the type long double. The types float, double, and long double, and cv-qualified versions (6.8.5) thereof, are collectively termed standard floating-point types. An implementation may also provide additional types that represent floating-point values and define them (and cv-qualified versions thereof) to be extended floating-point types. The standard and extended floating-point types are collectively termed floating-point types.</p> <p>additional implementation-specific</p> <p>Any additional implementation-specific types representing floating-point values that are not defined by the implementation to be extended floating-point types are not considered to be floating-point types, and this document imposes no requirements on them or their interactions with floating-point types.</p> </li> </ol> <ul> <li>Except as specified in 6.8.3, the object and value representations and accuracy of operations of floating-point types are implementation-defined.</li> </ul> <ol> <li> <p>Integral and floating-point types are collectively termed arithmetic types.</p> <p>Properties of the arithmetic types</p> <p>Properties of the arithmetic types, such as their minimum and maximum representable value, can be queried using the facilities in the standard library headers &lt;limits&gt; (17.3.3), &lt;climits&gt; (17.3.6), and &lt;cfloat&gt; (17.3.7).</p> </li> <li> <p>A type cv void is an incomplete type that cannot be completed; such a type has an empty set of values. It is used as the return type for functions that do not return a value. Any expression can be explicitly converted to type cv void (7.6.1.4, 7.6.1.9, 7.6.3). An expression of type cv void shall be used only as an expression statement (8.3), as an operand of a comma expression (7.6.20), as a second or third operand of <code>?:</code> (7.6.16), as the operand of <code>typeid</code>, <code>noexcept</code>, or <code>decltype</code>, as the expression in a <code>return</code> statement (8.7.4) for a function with the return type cv void, or as the operand of an explicit conversion to type cv void.</p> </li> <li> <p>A value of type <code>std::nullptr_t</code> is a null pointer constant (7.3.12). Such values participate in the pointer and the pointer-to-member conversions (7.3.12, 7.3.13). <code>sizeof(std::nullptr_t)</code> shall be equal to <code>sizeof(void*)</code>.</p> </li> <li> <p>The types described in this subclause are called fundamental types.</p> <p>same value, different types</p> <p>Even if the implementation defines two or more fundamental types to have the same value representation, they are nevertheless different types.</p> </li> </ol>","tags":["standard","data_type"]},{"location":"blog/20230601/cpp-std-data-types/#684_compound_types","title":"6.8.4 Compound types","text":"<p>[basic.compound]</p> <ol> <li>Compound types can be constructed in the following ways:</li> </ol> <ul> <li><code>arrays</code> of objects of a given type, 9.3.4.5;</li> <li><code>functions</code>, which have parameters of given types and return void or references or objects of a given type, 9.3.4.6;</li> <li><code>pointers</code> to cv void or objects or functions (including static members of classes) of a given type, 9.3.4.2;</li> <li> <p><code>references</code> to objects or functions of a given type, 9.3.4.3. There are two types of references:</p> <ul> <li>lvalue reference</li> <li>rvalue reference</li> </ul> </li> <li> <p><code>classes</code> containing a sequence of objects of various types (Clause 11), a set of types, enumerations and functions for manipulating these objects (11.4.2), and a set of restrictions on the access to these entities (11.8);</p> </li> <li><code>unions</code>, which are classes capable of containing objects of different types at different times, 11.5;</li> <li><code>enumerations</code>, which comprise a set of named constant values, 9.7.1;</li> <li><code>pointers</code> to non-static class members, which identify members of a given type within objects of a given class, 9.3.4.4. Pointers to data members and pointers to member functions are collectively called pointer-to-member types.</li> </ul> <ol> <li> <p>These methods of constructing types can be applied recursively; restrictions are mentioned in 9.3.4. Constructing a type such that the number of bytes in its object representation exceeds the maximum value representable in the type <code>std::size_t</code> (17.2) is ill-formed.</p> </li> <li> <p>The type of a pointer to cv void or a pointer to an object type is called an object pointer type.</p> <p>void*</p> <p>A pointer to void does not have a pointer-to-object type, however, because void is not an object type.</p> </li> </ol> <ul> <li> <p>The type of a pointer that can designate a function is called a function pointer type. A pointer to an object of type T is referred to as a pointer to T.</p> <p>pointer naming</p> <p>A pointer to an object of type int is referred to as \u201cpointer to int\u201d and a pointer to an object of class X is called a \u201cpointer to X\u201d.</p> </li> <li> <p>Except for pointers to static members, text referring to \u201cpointers\u201d does not apply to pointers to members. Pointers to incomplete types are allowed although there are restrictions on what can be done with them (6.7.6). Every value of pointer type is one of the following:</p> <ul> <li>a pointer to an object or function (the pointer is said to point to the object or function), or</li> <li>a pointer past the end of an object (7.6.6), or</li> <li>the null pointer value for that type, or</li> <li>an invalid pointer value.</li> </ul> </li> <li> <p>A value of a pointer type that is a pointer to or past the end of an object represents the address of the first byte in memory (6.7.1) occupied by the object or the first byte in memory after the end of the storage occupied by the object, respectively.</p> <p>Pointer beyond the end - sentinel</p> <p>A pointer past the end of an object (7.6.6) is not considered to point to an unrelated object of the object\u2019s type, even if the unrelated object is located at that address. A pointer value becomes invalid when the storage it denotes reaches the end of its storage duration; see 6.7.5.</p> </li> <li> <p>For purposes of pointer arithmetic (7.6.6) and comparison (7.6.9, 7.6.10), a pointer past the end of the last element of an array x of n elements is considered to be equivalent to a pointer to a hypothetical array element n of x and an object of type T that is not an array element is considered to belong to an array with one element of type T. The value representation of pointer types is implementation-defined. Pointers to layout-compatible types shall have the same value representation and alignment requirements (6.7.6).</p> <p>Pointers to over-aligned types</p> <p>Pointers to over-aligned types (6.7.6) have no special representation, but their range of valid values is restricted by the extended alignment requirement.</p> </li> </ul> <ol> <li> <p>Two objects a and b are pointer-interconvertible if:</p> <ul> <li>they are the same object, or</li> <li>one is a union object and the other is a non-static data member of that object (11.5), or</li> <li>one is a standard-layout class object and the other is the first non-static data member of that object or any base class subobject of that object (11.4), or</li> <li>there exists an object c such that a and c are pointer-interconvertible, and c and b are pointer-interconvertible.</li> </ul> </li> </ol> <ul> <li> <p>If two objects are pointer-interconvertible, then they have the same address, and it is possible to obtain a pointer to one from a pointer to the other via a <code>reinterpret_cast</code> (7.6.1.10).</p> <p>array != &amp;array[0]</p> <p>An array object and its first element are not pointer-interconvertible, even though they have the same address.</p> </li> </ul> <ol> <li> <p>A byte of storage b is reachable through a pointer value that points to an object x if there is an object y, pointer-interconvertible with x, such that b is within the storage occupied by y, or the immediately-enclosing array object if y is an array element.</p> </li> <li> <p>A pointer to cv void can be used to point to objects of unknown type. Such a pointer shall be able to hold any object pointer. An object of type \u201cpointer to cv void\u201d shall have the same representation and alignment requirements as an object of type \u201cpointer to cv char\u201d.</p> </li> </ol>","tags":["standard","data_type"]},{"location":"blog/20230601/cpp-std-data-types/#685_cv-qualifiers","title":"6.8.5 CV-qualifiers","text":"<p>[basic.type.qualifier]</p> <ol> <li>Each type other than a function or reference type is part of a group of four distinct, but related, types: a <code>cv-unqualified</code> version, a <code>const-qualified</code> version, a <code>volatile-qualified</code> version, and a <code>const-volatile-qualified</code> version. The types in each such group shall have the same representation and alignment requirements (6.7.6). A function or reference type is always cv-unqualified.</li> </ol> <ul> <li>A <code>const</code> object is an object of type const T or a non-mutable subobject of a const object.</li> <li>A <code>volatile</code> object is an object of type volatile T or a subobject of a volatile object.</li> <li> <p>A <code>const volatile</code> object is an object of type const volatile T, a non-mutable subobject of a const volatile object, a const subobject of a volatile object, or a non-mutable volatile subobject of a const object.</p> <p>type invovles cv-qualifiers</p> <p>The type of an object (6.7.2) includes the cv-qualifiers specified in the decl-specifier-seq (9.2), declarator (9.3), type-id (9.3.2), or new-type-id (7.6.2.8) when the object is created.</p> </li> </ul> <ol> <li> <p>Except for array types, a compound type (6.8.4) is not cv-qualified by the cv-qualifiers (if any) of the types from which it is compounded.</p> </li> <li> <p>An array type whose elements are cv-qualified is also considered to have the same cv-qualifications as its elements.</p> <p>Cv-qualifiers</p> <p>Cv-qualifiers applied to an array type attach to the underlying element type, so the notation \u201ccv T\u201d, where T is an array type, refers to an array whose elements are so-qualified (9.3.4.5).</p> <p>Cv-qualifiers</p> <p>typedef char CA[5]; typedef const char CC; CC arr1[5] = { 0 }; const CA arr2 = { 0 };</p> <p>The type of both arr1 and arr2 is \u201carray of 5 const char\u201d, and the array type is considered to be const-qualified.</p> </li> <li> <p>See 9.3.4.6 and 12.2.2 regarding function types that have cv-qualifiers.</p> </li> <li> <p>There is a partial ordering on cv-qualifiers, so that a type can be said to be more cv-qualified than another. Table 16 shows the relations that constitute this ordering.</p> <p>Table 16: Relations on const and volatile - [tab:basic.type.qualifier.rel]</p> <ul> <li>no cv-qualifier &lt; const</li> <li>no cv-qualifier &lt; volatile</li> <li>no cv-qualifier &lt; const volatile</li> <li>const &lt; const volatile</li> <li>volatile &lt; const volatile</li> </ul> </li> <li> <p>In this document, the notation cv (or cv1, cv2, etc.), used in the description of types, represents an arbitrary set of cv-qualifiers, i.e., one of {<code>const</code>}, {<code>volatile</code>}, {<code>const</code>, <code>volatile</code>}, or the empty set. For a type cv T, the top-level cv-qualifiers of that type are those denoted by cv.</p> <p>top-level cv-qualifiers</p> <p>The type corresponding to the type-id <code>const int&amp;</code> has no top-level cv-qualifiers. The type corresponding to the type-id <code>volatile int * const</code> has the top-level cv-qualifier const. For a class type C, the type corresponding to the type-id <code>void (C::* volatile)(int) const</code> has the top-level cv-qualifier volatile.</p> </li> </ol>","tags":["standard","data_type"]},{"location":"blog/20211012/address-alignment/","title":"Memory Address Alignment","text":"<p>One of the low-level features of C/C++ is the ability to specify the precise alignment of objects in memory to take maximum advantage of a specific hardware architecture. By default, the compiler aligns class and struct members on their size value.</p> <p>Alignment and memory addresses</p> <p>Alignment is a property of a memory address, expressed as the numeric address modulo a power of 2. For example, the address <code>0x0001103F</code> modulo 4 is 3. That address is said to be aligned to \\(4n+3\\), where 4 indicates the chosen power of 2. The alignment of an address depends on the chosen power of 2. The same address modulo 8 is 7. An address is said to be aligned to X if its alignment is \\(Xn+0\\).</p> <p>CPUs execute instructions that operate on data stored in memory. The data are identified by their addresses in memory. A single datum also has a size. We call a datum naturally aligned if its address is aligned to its size. It's called misaligned otherwise. For example, an 8-byte floating-point datum is naturally aligned if the address used to identify it has an 8-byte alignment.</p> <p>Data structure alignment is the way data is arranged and accessed in computer memory. It consists of three separate but related issues: <code>data alignment</code>, <code>data structure padding</code>, and <code>packing</code>.</p> <p>The CPU in modern computer hardware performs reads and writes to memory most efficiently when the data is naturally aligned, which generally means that the data's memory address is a multiple of the data size. For instance, in a 32-bit architecture, the data may be aligned if the data is stored in four consecutive bytes and the first byte lies on a 4-byte boundary.</p> <p>Data alignment is the aligning of elements according to their natural alignment. To ensure natural alignment, it may be necessary to insert some padding between structure elements or after the last element of a structure. For example, on a 32-bit machine, a data structure containing a 16-bit value followed by a 32-bit value could have 16 bits of padding between the 16-bit value and the 32-bit value to align the 32-bit value on a 32-bit boundary. Alternatively, one can pack the structure, omitting the padding, which may lead to slower access, but uses three quarters as much memory.</p>","tags":["alignment","word_boundary","misalignment"]},{"location":"blog/20211012/address-alignment/#reasons","title":"reasons","text":"<p>Data structure alignment - Problems:</p> <p>The CPU accesses memory by a single memory word at a time. As long as the memory word size is at least as large as the largest primitive data type supported by the computer, aligned accesses will always access a single memory word. This may not be true for misaligned data accesses.</p> <p>If the highest and lowest bytes in a datum are not within the same memory word the computer must split the datum access into multiple memory accesses. This requires a lot of complex circuitry to generate the memory accesses and coordinate them. To handle the case where the memory words are in different memory pages the processor must either verify that both pages are present before executing the instruction or be able to handle a TLB miss or a page fault on any memory access during the instruction execution.</p> <p>\u300aC\u8bed\u8a00\u6807\u51c6\u4e0e\u5b9e\u73b0(\u59da\u65b0\u989c)-2004\u300b #1\u57fa\u7840\u77e5\u8bc6 | 11 \u5185\u5b58\u5730\u5740\u5bf9\u9f50\uff1a</p> <p>\u4ee5P6\u5904\u7406\u5668\u4e3a\u4f8b\uff0c\u4f7f\u6570\u636e\u7684\u5730\u5740\u6309\u4e00\u5b9a\u7684\u8fb9\u754c\u5bf9\u9f50\u4e3b\u8981\u6709\u4e09\u65b9\u9762\u7684\u8003\u8651\uff1a</p> <ol> <li> <p>\u63d0\u9ad8\u6548\u7387\uff1aP6\u5904\u7406\u5668\u8bfb/\u5199\u5185\u5b58\u4e2d\u7684\u6570\u636e\u9700\u8981\u4e00\u4e2a\u6216\u6570\u4e2a\u5185\u5b58\u603b\u7ebf\u5468\u671f\uff0c\u5bf9\u4e8e8\u4f4d\u6570\u636e\uff0c\u5904\u7406\u5668\u4e00\u4e2a\u5468\u671f\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5b8c\u6bd5\uff1b\u5bf9\u4e8e16\u4f4d\u6570\u636e\uff0c\u5982\u679c\u6570\u636e\u7684\u5730\u5740\u662f2\u5b57\u8282\u5bf9\u9f50\uff08\u88ab2\u6574\u9664\uff09\uff0cP6 \u5904\u7406\u5668\u8017\u8d39\u4e00\u4e2a\u603b\u7ebf\u5468\u671f\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5b8c\u6bd5\uff1b\u5982\u679c\u4e0d\u662f\u53cc\u5b57\u8282\u5bf9\u9f50\uff0c\u4f46\u53ea\u8981\u5b83\u7684\u5730\u5740\u6ca1\u6709\u6a2a\u8de8\u5728\u76f8\u90bb\u4e24\u4e2a\u5bf9\u9f50\u768432\u4f4d\u6570\u636e\u5730\u5740\u4e0a\uff0c\u5219\u5904\u7406\u5668\u4ecd\u7136\u53ea\u9700\u4e00\u4e2a\u5185\u5b58\u603b\u7ebf\u5468\u671f\u5c31\u53ef\u5b8c\u6210\u64cd\u4f5c\uff0c\u5426\u5219\u5904\u7406\u5668\u9700\u8981\u4e24\u4e2a\u5468\u671f\u624d\u80fd\u5b8c\u6210\u64cd\u4f5c\uff1b\u5bf9\u4e8e32\u4f4d\u6570\u636e\uff0c\u5982\u679c\u6570\u636e\u7684\u5730\u5740\u662f4\u5b57\u8282\u5bf9\u9f50\uff08\u88ab4\u6574\u9664\uff09\u7684\u8bdd\uff0cP6\u5904\u7406\u5668\u8017\u8d39\u4e00\u4e2a\u603b\u7ebf\u5468\u671f\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5b8c\u6bd5\uff0c\u5426\u5219\u9700\u8981\u4e24\u4e2a\u5468\u671f\u8fdb\u884c\u64cd\u4f5c\uff1b\u5bf9\u4e8e64\u4f4d\u6570\u636e\uff0c\u5982\u679c\u6570\u636e\u7684\u5730\u5740\u662f8\u5b57\u8282\u5bf9\u9f50\uff08\u88ab8\u6574\u9664\uff09\u7684\u8bdd\uff0cP6\u5904\u7406\u5668\u8017\u8d39\u4e00\u4e2a\u603b\u7ebf\u5468\u671f\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5b8c\u6bd5\uff0c\u5426\u5219\u9700\u8981\u4e24\u4e2a\u5468\u671f\u8fdb\u884c\u64cd\u4f5c\u3002\u53ef\u89c1\uff0c\u5bf9\u4e8e\u6700\u5e38\u7528\u768432/64\u4f4d\u6570\u636e\uff0c\u8bbf\u95ee\u5730\u5740\u5bf9\u9f50\u7684\u6570\u636e\u6bd4\u8bbf\u95ee\u5730\u5740\u6ca1\u6709\u5bf9\u9f50\u7684\u6570\u636e\u5728\u7406\u8bba\u4e0a\u8282\u770150%\u7684\u65f6\u95f4\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230 gcc \u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u751f\u6210\u7684\u6c47\u7f16\u4ee3\u7801\u603b\u662f\u628a\u6570\u636e\u6309\u7167\u5bf9\u5e94\u7684\u5bf9\u9f50\u89c4\u5219\u6307\u793a\u94fe\u63a5\u7a0b\u5e8f\u5b89\u6392\u9002\u5f53\u7684\u5730\u5740\u3002</p> </li> <li> <p>\u6307\u4ee4\u8981\u6c42\uff1a\u67d0\u4e9b SSE\u3001SSE2 \u6307\u4ee4\u8981\u6c42\u5185\u5b58\u64cd\u4f5c\u6570\u7684\u5730\u5740\u5fc5\u987b\u662f16\u5b57\u8282\u5bf9\u9f50\u7684\uff0c\u5426\u5219\u5c31\u5f15\u53d1\u5f02\u5e38\u3002Pentium III \u5904\u7406\u5668\u5f00\u59cb\u652f\u6301 SSE \u6307\u4ee4\uff0cPentium 4\u5904\u7406\u5668\u5f00\u59cb\u652f\u6301 SSE2 \u6307\u4ee4\uff0c \u800c\u8fd9\u4e9b\u6307\u4ee4\u7684\u5176\u4e2d\u4e00\u90e8\u5206\u9700\u8981\u5730\u5740\u662f16\u5b57\u8282\u5bf9\u9f50\u7684\u5185\u5b58\u64cd\u4f5c\u6570\uff0c\u4f8b\u5982\uff1a<code>movdqa</code>\uff08SSE \u6307\u4ee4\uff09\u3001<code>movapd</code>\uff08SSE2\u6307\u4ee4\uff09\u3002\u5f53\u4f7f\u7528\u8fd9\u4e9b\u6307\u4ee4\u5e76\u4e14\u5176\u4e2d\u4e00\u4e2a\u64cd\u4f5c\u6570\u662f\u5185\u5b58\u64cd\u4f5c\u6570\u65f6\uff0c\u5185\u5b58\u64cd\u4f5c\u6570\u7684\u5730\u5740\u5fc5\u987b\u6ee1\u8db316\u5b57\u8282\u5bf9\u9f50\uff0c\u5426\u5219\u5904\u7406\u5668\u5f15\u53d113\u53f7\u5f02\u5e38\u3002</p> </li> <li> <p>\u4fdd\u8bc1\u5bf9\u5185\u5b58\u7684\u8bbf\u95ee\u662f\u539f\u5b50\u64cd\u4f5c\uff08atomic operation\uff09\u3002\u5728\u591a\u5904\u7406\u5668\u73af\u5883\u4e0b\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u5404\u4e2a\u5904\u7406\u5668\u5bf9\u5185\u5b58\u64cd\u4f5c\u7684\u6b63\u786e\u6027\uff0c\u7cfb\u7edf\u5fc5\u987b\u786e\u4fdd\u67d0\u4e9b\u8bfb/\u5199\u64cd\u4f5c\u5728\u4e00\u4e2a\u5185\u5b58\u603b\u7ebf\u5468\u671f\u5185\u5b8c\u6210\u3002\u4ece\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\uff0c\u5bf9\u4e8e\u5730\u5740\u6ee1\u8db3\u9002\u5f53\u5bf9\u9f50\u6761\u4ef6\u768416/32/64\u4f4d\u6570\u636e\uff0cP6\u5904\u7406\u5668\u5747\u53ef\u4ee5\u5728\u4e00\u4e2a\u5185\u5b58\u603b\u7ebf\u5468\u671f\u5185\u5b8c\u6210\u8bbf\u95ee\uff0c\u8fd9\u5f88\u81ea\u7136\u5730\u6ee1\u8db3\u539f\u5b50\u64cd\u4f5c\u7684\u8981\u6c42\u3002\u5982\u679c\u6570\u636e\u5730\u5740\u4e0d\u6ee1\u8db3\u5bf9\u5e94\u7684\u5bf9\u9f50\u6761\u4ef6\uff0c\u90a3\u4e48\u5904\u7406\u5668\u5fc5\u987b\u75282\u4e2a\u5185\u5b58\u603b\u7ebf\u5468\u671f\u624d\u80fd\u5b8c\u6210\u8bfb/\u5199\u64cd\u4f5c\uff0c\u4e07\u4e00\u5728\u8fd9\u4e24\u4e2a\u5468\u671f\u4e4b\u95f4\u5176\u5b83\u5904\u7406\u5668\u521a\u597d\u83b7\u5f97\u603b\u7ebf\u7684\u4f7f\u7528\u6743\u5e76\u4e14\u5728\u968f\u540e\u7684\u8fde\u7eed\u4e24\u4e2a\u5468\u671f\u5185\u8bbf\u95ee\u5230\u8be5\u6570\u636e\uff0c\u5219\u8be5\u8bbf\u95ee\u7684\u7ed3\u679c\u5c06\u662f\u4e0d\u6b63\u786e\u7684\u3002\u867d\u7136P6\u5904\u7406\u5668\u53ef\u4ee5\u4f7f\u7528 LOCK \u547d\u4ee4\u524d\u7f00\u5728\u4e00\u6761\u6307\u4ee4\u6267\u884c\u5b8c\u6bd5\u4e4b\u524d\u9501\u4f4f\u603b\u7ebf\u7684\u4f7f\u7528\u6743\uff0c\u4f46 LOCK \u524d\u7f00\u7684\u4f7f\u7528\u8303\u56f4\u6709\u9650\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u6307\u4ee4\u90fd\u53ef\u4ee5\u52a0\u4e0a LOCK \u524d\u7f00\uff0c\u4f8b\u5982\u6700\u5e38\u89c1\u7684 <code>MOV</code> \u6307\u4ee4\u5c31\u4e0d\u80fd\u4f7f\u7528 LOCK \u524d\u7f00\u3002\u56e0\u6b64\uff0c\u8981\u4fdd\u8bc1\u6570\u636e\u7684\u5b8c\u6574\u6027\uff0c\u6700\u597d\u8ba9\u6570\u636e\u7684\u5730\u5740\u6309\u7167\u9002\u5f53\u7684\u89c4\u5219\u5bf9\u9f50\u4ece\u800c\u4fdd\u8bc1\u5904\u7406\u5668\u8bbf\u95ee\u5185\u5b58\u662f\u539f\u5b50\u64cd\u4f5c\u3002</p> </li> </ol> <p>\u300a\u73b0\u4ee3C++\u8bed\u8a00\u6838\u5fc3\u7279\u6027\u89e3\u6790-2021\u300b - \u7b2c30\u7ae0 alignas \u548c alignof\uff1a</p> <p>\u4e00\u4e2a\u7c7b\u578b\u7684\u5c5e\u6027\u9664\u4e86\u5176\u6570\u636e\u957f\u5ea6\uff0c\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u5c5e\u6027\u2014\u2014\u6570\u636e\u5bf9\u9f50\u7684\u5b57\u8282\u957f\u5ea6\u3002</p> <p>\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u6570\u636e\u5bf9\u9f50\u5462\uff1f\u539f\u56e0\u8bf4\u8d77\u6765\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u786c\u4ef6\u9700\u8981\u3002</p> <p>\u9996\u5f53\u5176\u51b2\u7684\u5c31\u662fCPU\u4e86\uff0cCPU\u5bf9\u6570\u636e\u5bf9\u9f50\u6709\u7740\u8feb\u5207\u7684\u9700\u6c42\uff0c\u4e00\u4e2a\u597d\u7684\u5bf9\u9f50\u5b57\u8282\u957f\u5ea6\u53ef\u4ee5\u8ba9CPU\u8fd0\u884c\u8d77\u6765\u66f4\u52a0\u8f7b\u677e\u5feb\u901f\u3002\u53cd\u8fc7\u6765\u8bf4\uff0c\u4e0d\u597d\u7684\u5bf9\u9f50\u5b57\u8282\u957f\u5ea6\u5219\u4f1a\u8ba9CPU\u8fd0\u884c\u901f\u5ea6\u51cf\u6162\uff0c\u751a\u81f3\u629b\u51fa\u9519\u8bef\u3002\u901a\u5e38\u6765\u8bf4\u6240\u8c13\u597d\u7684\u5bf9\u9f50\u957f\u5ea6\u548cCPU\u8bbf\u95ee\u6570\u636e\u603b\u7ebf\u7684\u5bbd\u5ea6\u6709\u5173\u7cfb\uff0c\u6bd4\u5982CPU\u8bbf\u95ee32\u4f4d\u5bbd\u5ea6\u7684\u6570\u636e\u603b\u7ebf\uff0c\u5c31\u4f1a\u671f\u5f85\u6570\u636e\u662f\u6309\u716732\u4f4d\u5bf9\u9f50\uff0c\u4e5f\u5c31\u662f4\u5b57\u8282\u3002\u8fd9\u6837CPU\u8bfb\u53d64\u5b57\u8282\u7684\u6570\u636e\u53ea\u9700\u8981\u5bf9\u603b\u7ebf\u8bbf\u95ee\u4e00\u6b21\uff0c\u4f46\u662f\u5982\u679c\u8981\u8bbf\u95ee\u7684\u6570\u636e\u5e76\u6ca1\u6709\u6309\u71674\u5b57\u8282\u5bf9\u9f50\uff0c\u90a3\u4e48CPU\u9700\u8981\u8bbf\u95ee\u6570\u636e\u603b\u7ebf\u4e24\u6b21\uff0c\u8fd0\u7b97\u901f\u5ea6\u81ea\u7136\u4e5f\u5c31\u51cf\u6162\u4e86\u3002\u53e6\u5916\uff0c\u5bf9\u4e8e\u6570\u636e\u5bf9\u9f50\u95ee\u9898\u5f15\u53d1\u9519\u8bef\u7684\u60c5\u51b5\uff08Alignment Fault\uff09\uff0c\u901a\u5e38\u4f1a\u53d1\u751f\u5728ARM\u67b6\u6784\u7684\u8ba1\u7b97\u673a\u4e0a\u3002\u5f53\u7136\u9664\u4e86CPU\u4e4b\u5916\uff0c\u8fd8\u6709\u5176\u4ed6\u786c\u4ef6\u4e5f\u9700\u8981\u6570\u636e\u5bf9\u9f50\uff0c\u6bd4\u5982\u901a\u8fc7DMA\u8bbf\u95ee\u786c\u76d8\uff0c\u5c31\u4f1a\u8981\u6c42\u5185\u5b58\u5fc5\u987b\u662f4K\u5bf9\u9f50\u7684\u3002</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u914d\u5408\u73b0\u4ee3\u7f16\u8bd1\u5668\u548cCPU\u67b6\u6784\uff0c\u53ef\u4ee5\u8ba9\u7a0b\u5e8f\u83b7\u5f97\u4ee4\u4eba\u96be\u4ee5\u7f6e\u4fe1\u7684\u6027\u80fd\uff0c\u4f46\u8fd9\u79cd\u826f\u597d\u7684\u6027\u80fd\u53d6\u51b3\u4e8e\u67d0\u4e9b\u7f16\u7a0b\u5b9e\u8df5\uff0c\u5176\u4e2d\u4e00\u79cd\u7f16\u7a0b\u5b9e\u8df5\u662f\u6b63\u786e\u7684\u6570\u636e\u5bf9\u9f50\u3002</p> <p>Computer Systems - A Programmer\u2019s Perspective - 3.9.3: Data Alignment:</p> <p>Many computer systems place restrictions on the allowable addresses for the primitive data types, requiring that the address for some objects must be a multiple of some value \\(K\\) (typically 2, 4, or 8). Such alignment restrictions simplify the design of the hardware forming the interface between the processor and the memory system.</p> <p>For example, suppose a processor always fetches 8 bytes from memory with an address that must be a multiple of 8. If we can guarantee that any <code>double</code> will be aligned to have its address be a multiple of 8, then the value can be read or written with a single memory operation. Otherwise, we may need to perform two memory accesses, since the object might be split across two 8-byte memory blocks.</p>","tags":["alignment","word_boundary","misalignment"]},{"location":"blog/20211012/address-alignment/#natural_alignment","title":"natural alignment","text":"<p>Computer Systems - A Programmer\u2019s Perspective - 3.9.3: Data Alignment:</p> <p>The x86-64 hardware will work correctly regardless of the alignment of data. However, Intel recommends that data be aligned to improve memory system performance. Their alignment rule is based on the principle that any primitive object of \\(K\\) bytes must have an address that is a multiple of \\(K\\). We can see that this rule leads to the following alignments:</p> K Types 1 char 2 short 4 int, float 8 long, double, char * <p>Alignment is enforced by making sure that every data type is organized and allocated in such a way that every object within the type satis\ufb01es its alignment restrictions.</p> <p>x64 ABI conventions - x64 type and storage layout - Scalar types</p> <ul> <li>Byte - 8 bits / 1 bytes</li> <li>Word - 16 bits / 2 bytes</li> <li>Doubleword - 32 bits / 4 bytes</li> <li>Quadword - 64 bits / 8 bytes</li> <li>Octaword - 128 bits / 16 bytes</li> </ul> Scalar type C data type Storage size (in bytes) Recommended alignment INT8 <code>char</code> 1 Byte UINT8 <code>unsigned char</code> 1 Byte INT16 <code>short</code> 2 Word UINT16 <code>unsigned short</code> 2 Word INT32 <code>int</code>, <code>long</code> 4 Doubleword UINT32 <code>unsigned int</code>, <code>unsigned long</code> 4 Doubleword INT64 <code>__int64</code> 8 Quadword UINT64 <code>unsigned __int64</code> 8 Quadword FP32 (single precision) <code>float</code> 4 Doubleword FP64 (double precision) <code>double</code> 8 Quadword POINTER <code>*</code> 8 Quadword __m64 <code>struct __m64</code> 8 Quadword __m128 <code>struct __m128</code> 16 Octaword <p>\u53c2\u8003 Apple Developer Document \u76f8\u5173\u5185\u5bb9:</p> <ul> <li>32-bit / 64-bit PowerPC Function Calling Conventions - Data Types and Data Alignment</li> </ul> <p>Apple PowerPC alignment modes</p> <ol> <li>Natural alignment. The alignment of a data type when allocated in memory or assigned a memory address. The natural alignment of a data type is its size.</li> <li>Embedding alignment. The alignment of a data type within a composite data structure.</li> </ol> <p>For example, the alignment of an <code>unsigned short</code> variable on the stack may differ from that of an <code>unsigned short</code> data item embedded in a data structure.</p> <ul> <li>IA-32 Function Calling Conventions - Data Types and Data Alignment</li> <li>Writing 64-bit Intel code for Apple Platforms - Handle data types and data alignment properly</li> </ul> <p>Apple IA-32 alignment rules</p> <ol> <li>Scalar data types use their natural alignment.</li> <li>Composite data types (arrays, structures, and unions) take on the alignment of the member with the highest alignment. An array assumes the same alignment as its elements. The size of a composite data type is a multiple of its alignment (padding may be required).</li> </ol> <p>ARM Compiler v5.06 for uVision armcc User Guide \uff5c Basic data types in ARM C and C++ - Size and alignment of basic data types</p> <ul> <li>The following table gives the size and natural alignment of the basic data types under ILP32 data model.</li> </ul> <p>aapcs64 - 5.1 Fundamental Data Types, 5.9\u00a0\u00a0\u00a0Composite Types:</p> <ol> <li>The member alignment of an element of a composite type is the alignment of that member after the application of any language alignment modifiers to that member.</li> <li>The natural alignment of a composite type is the maximum of each of the member alignments of the 'top-level' members of the composite type i.e. before any alignment adjustment of the entire composite is applied.</li> </ol> <p>Overview of ARM64 ABI conventions - Alignment</p> <p>Default layout alignment for <code>locals</code>:</p> Size in bytes Alignment in bytes 1 1 2 2 3, 4 4 &gt; 4 8 <p>Default layout alignment for <code>globals</code> and <code>statics</code>:</p> Size in bytes Alignment in bytes 1 1 2 - 7 4 8 - 63 8 &gt;= 64 16 <p>Writing ARM64 code for Apple platforms - Handle data types and data alignment properly:</p> Data type Size (in bytes) Natural alignment (in bytes) <code>BOOL</code>, <code>bool</code> 1 1 <code>char</code> 1 1 <code>short</code> 2 2 <code>int</code> 4 4 <code>long</code> 8 8 <code>long long</code> 8 8 pointer 8 8 <code>size_t</code> 8 8 <code>NSInteger</code> 8 8 <code>CFIndex</code> 8 8 <code>fpos_t</code> 8 8 <code>off_t</code> 8 8 <p>ILP32 and LP64 data models.PDF - HP-UX 64-bit data model list ILP32 and LP64 data alignment:</p> <p></p>","tags":["alignment","word_boundary","misalignment"]},{"location":"blog/20211012/address-alignment/#x86_misalignment","title":"x86 misalignment","text":"<p>The x86-64 hardware will work correctly regardless of the alignment of data.</p> <p>Are machine code instructions fetched in little endian 4-byte words on an Intel x86-64 architecture?</p> <p>x86 machine code is a byte-stream; there's nothing word-oriented about it, except for 32-bit displacements and immediates which are little-endian. e.g. in <code>add qword [rdi + 0x1234], 0xaabbccdd</code>. It's physically fetched in 16-byte or 32-byte chunks on modern CPUs, and split on instruction boundaries in parallel to feed to decoders in parallel.</p> <p>x86-64 is not a word-oriented architecture; there is no single natural word-size, and things don't have to be aligned. That concept is not very useful when thinking about x86-64. The integer register width happens to be 8 bytes, but that's not even the default operand-size in machine code, and you can use any operand-size from byte to qword with most instructions, and for SIMD from 8 or 16 byte up to 32 or 64 byte. And most importantly, alignment of wider integers isn't required in machine code, or even for data.</p> <p>assembly - What's the size of a QWORD on a 64-bit machine? - Stack Overflow</p> <p>The whole concept of \"machine word\" doesn't really apply to x86, with its machine-code format being a byte stream, and equal support for multiple operand-sizes, and unaligned loads/stores that mostly don't care about naturally aligned stuff, only cache line boundaries for normal cacheable memory.</p> <p>Modern C, 1st Edition, 2019 - 12 The C memory model | 12.7 Alignment:</p> <p>Some architectures are more tolerant of misalignment than others, and we might have to force the system to error out on such a condition. We use the following function at the beginning to force crashing:</p> <p>enable alignment check for i386 processors</p> <p>Intel\u2019s i386 processor family is quite tolerant in accepting misalignment of data. This can lead to irritating bugs when ported to other architectures that are not as tolerant.</p> <p>This function enables a check for this problem also for this family or processors, such that you can be sure to detect this problem early.</p> <p>I found that code on Ygdrasil\u2019s blog: <code>void enable_alignment_check(void);</code>.</p>","tags":["alignment","word_boundary","misalignment"]},{"location":"blog/20211012/address-alignment/#c_alignment","title":"C alignment","text":"<p>Excerpt from Modern C, 1st Edition, 2019.</p> <p>12 The C memory model | 12.7 Alignment</p> <p>The inverse direction of pointer conversions (from \u201cpointer to character type\u201d to \u201cpointer to object\u201d) is not harmless at all, and not only because of possible aliasing. This has to do with another property of C\u2019s memory model: alignment. Objects of most non-character types can\u2019t start at any arbitrary byte position; they usually start at a word boundary. The alignment of a type then describes the possible byte positions at which an object of that type can start.</p> <p>If we force some data to a false alignment, really bad things can happen.</p> <p>The program crashes with an error indicated as a bus error, which is a shortcut for something like \u201cdata bus alignment error.\u201d</p> <p>As you can see in the output, above, it seems that <code>complex double</code> still works well for alignments of half of its size, but then with an alignment of one fourth, the program crashes.</p> <p>In the previous code example, we also see a new operator, <code>alignof</code> (or <code>_Alignof</code>, if you don\u2019t include &lt;stdalign.h&gt;), that provides us with the alignment of a speci\ufb01c type. You will rarely \ufb01nd the occasion to use it in real live code.</p> <p>Another keyword can be used to force allocation at a speci\ufb01ed alignment: <code>alignas</code> (respectively, <code>_Alignas</code>). Its argument can be either a type or expression. It can be useful where you know that your platform can perform certain operations more ef\ufb01ciently if the data is aligned in a certain way.</p>","tags":["alignment","word_boundary","misalignment"]},{"location":"blog/20211012/address-alignment/#c_alignment_1","title":"C++ alignment","text":"","tags":["alignment","word_boundary","misalignment"]},{"location":"blog/20211012/address-alignment/#isoiec-n4950","title":"ISO/IEC-N4950","text":"<p>20230510 - ISO/IEC-N4950</p> <p>6 Basics | 6.7 Memory and objects | 6.7.6 Alignment</p> <ol> <li> <p>Object types have alignment requirements (6.8.2, 6.8.4) which place restrictions on the addresses at which an object of that type may be allocated. An alignment is an implementation-defined integer value representing the number of bytes between successive addresses at which a given object can be allocated. An object type imposes an alignment requirement on every object of that type; stricter alignment can be requested using the alignment specifier (9.12.2).</p> </li> <li> <p>A fundamental alignment is represented by an alignment less than or equal to the greatest alignment supported by the implementation in all contexts, which is equal to <code>alignof(std::max_align_t)</code> (17.2). The alignment required for a type may be different when it is used as the type of a complete object and when it is used as the type of a subobject.</p> <ul> <li>The result of the <code>alignof</code> operator reflects the alignment requirement of the type in the complete-object case.</li> </ul> </li> <li> <p>The alignment requirement of a complete type can be queried using an <code>alignof</code> expression (7.6.2.6). Furthermore, the narrow character types (6.8.2) shall have the weakest alignment requirement.</p> <ul> <li>This enables the ordinary character types to be used as the underlying type for an aligned memory area (9.12.2).</li> </ul> </li> </ol> <p>related sections:</p> <ul> <li>7 Expressions | 7.6 Compound expressions | 7.6.2 Unary expressions | 7.6.2.6 Alignof</li> <li>9 Declarations | 9.12 Attributes | 9.12.2 Alignment specifier</li> <li>17 Language support library | 17.2 Common definitions | 17.2.4 Sizes, alignments, and offsets</li> </ul>","tags":["alignment","word_boundary","misalignment"]},{"location":"blog/20211012/address-alignment/#language_support","title":"language support","text":"<p>\u300a\u73b0\u4ee3C++\u8bed\u8a00\u6838\u5fc3\u7279\u6027\u89e3\u6790-2021\u300b - \u7b2c30\u7ae0 alignas \u548c alignof</p> <p>C++11\u4e2d\u65b0\u589e\u4e86 <code>alignof</code> \u548c <code>alignas</code> \u4e24\u4e2a\u5173\u952e\u5b57\uff0c\u5176\u4e2d <code>alignof</code> \u8fd0\u7b97\u7b26\u53ef\u4ee5\u7528\u4e8e\u83b7\u53d6\u7c7b\u578b\u7684\u5bf9\u9f50\u5b57\u8282\u957f\u5ea6\uff0c<code>alignas</code> \u8bf4\u660e\u7b26\u53ef\u4ee5\u7528\u6765\u6539\u53d8\u7c7b\u578b\u7684\u9ed8\u8ba4\u5bf9\u9f50\u5b57\u8282\u957f\u5ea6\u3002\u8fd9\u4e24\u4e2a\u5173\u952e\u5b57\u7684\u51fa\u73b0\u89e3\u51b3\u4e86\u957f\u671f\u4ee5\u6765C++\u6807\u51c6\u4e2d\u65e0\u6cd5\u5bf9\u6570\u636e\u5bf9\u9f50\u8fdb\u884c\u5904\u7406\u7684\u95ee\u9898\u3002</p> <p><code>alignof</code> \u8fd0\u7b97\u7b26\u548c\u524d\u9762\u63d0\u5230\u7684\u7f16\u8bd1\u5668\u6269\u5c55\u5173\u952e\u5b57 <code>__alignof</code>\u3001<code>__alignof__</code> \u7528\u6cd5\u76f8\u540c\uff0c\u90fd\u662f\u83b7\u5f97\u7c7b\u578b\u7684\u5bf9\u9f50\u5b57\u8282\u957f\u5ea6\u3002</p> <p>C++\u6807\u51c6\u89c4\u5b9a <code>alignof</code> \u5fc5\u987b\u662f\u9488\u5bf9\u7c7b\u578b\u7684\u3002\u4e0d\u8fc7 GCC \u6269\u5c55\u4e86\u8fd9\u6761\u89c4\u5219\uff0c<code>alignof</code> \u9664\u4e86\u80fd\u63a5\u53d7\u4e00\u4e2a\u7c7b\u578b\u5916\u8fd8\u80fd\u63a5\u53d7\u4e00\u4e2a\u53d8\u91cf\u3002\u4f7f\u7528MSVC\u7684\u8bfb\u8005\u5982\u679c\u60f3\u83b7\u5f97\u53d8\u91cf\u7684\u5bf9\u9f50\uff0c\u4e0d\u59a8\u4f7f\u7528\u7f16\u8bd1\u5668\u7684\u6269\u5c55\u5173\u952e\u5b57 <code>__alignof</code>\u3002</p> <p>\u53e6\u5916\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7 <code>alignof</code> \u83b7\u5f97\u7c7b\u578b <code>std::max_align_t</code> \u7684\u5bf9\u9f50\u5b57\u8282\u957f\u5ea6\uff0c\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u503c\u3002</p> <p>C++11 &lt;stddef.h&gt; \u5b9a\u4e49\u4e86 <code>std::max_align_t</code>\uff0c\u5b83\u662f\u4e00\u4e2a\u5e73\u51e1\u7684\u6807\u51c6\u5e03\u5c40\u7c7b\u578b\uff0c\u5176\u5bf9\u9f50\u5b57\u8282\u957f\u5ea6\u8981\u6c42\u81f3\u5c11\u4e0e\u6bcf\u4e2a\u6807\u91cf\u7c7b\u578b\u4e00\u6837\u4e25\u683c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6240\u6709\u7684\u6807\u91cf\u7c7b\u578b\u90fd\u9002\u5e94 <code>std::max_align_t</code> \u7684\u5bf9\u9f50\u5b57\u8282\u957f\u5ea6\u3002</p> <p>C++ \u6807\u51c6\u8fd8\u89c4\u5b9a\uff0c\u8bf8\u5982 <code>new</code> \u548c <code>malloc</code> \u4e4b\u7c7b\u7684\u5206\u914d\u51fd\u6570\u8fd4\u56de\u7684\u6307\u9488\u9700\u8981\u9002\u5408\u4e8e\u4efb\u4f55\u5bf9\u8c61\uff0c\u4e5f\u5c31\u662f\u8bf4\u5185\u5b58\u5730\u5740\u81f3\u5c11\u4e0e <code>std::max_align_t</code> \u4e25\u683c\u5bf9\u9f50\u3002</p> <p>\u7531\u4e8e C++ \u6807\u51c6\u5e76\u6ca1\u6709\u5b9a\u4e49 <code>std::max_ align_t</code> \u5bf9\u9f50\u5b57\u8282\u957f\u5ea6\u5177\u4f53\u662f\u4ec0\u4e48\u6837\u7684\uff0c\u56e0\u6b64\u4e0d\u540c\u7684\u5e73\u53f0\u4f1a\u6709\u4e0d\u540c\u7684\u503c\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u662f8\u5b57\u8282\u548c16\u5b57\u8282\u3002</p>","tags":["alignment","word_boundary","misalignment"]},{"location":"blog/20230313/arm-arch/","title":"ARM Architecture","text":"<p><code>ARM</code> \u6700\u521d\u7684\u7b80\u79f0\u662f Acorn RISC Machine\u3002ARM \u4f7f\u7528\u7684\u5185\u6838\u4e0e\u6307\u4ee4\u96c6\u5e76\u4e0d\u4e00\u4e00\u5bf9\u5e94\u3002</p> <p>1990\u5e7411\u6708\uff0cAcorn\u3001Apple \u548c VLSI \u5171\u540c\u51fa\u8d44\u521b\u5efa\u4e86 ARM\u3002Acorn RISC Machine \u4e5f\u6b63\u5f0f\u66f4\u540d\u4e3a Advanced RISC Machine\u3002</p> <p>ARM11 \u4e4b\u540e\uff0cARM \u5904\u7406\u5668\u5185\u6838\u4e0d\u518d\u4ee5 ARM \u4f5c\u4e3a\u524d\u7f00\u3002\u4f46 <code>ARM</code> \u8fd9\u4e2a\u5355\u8bcd\u5e76\u6ca1\u6709\u5728 Cortex \u7cfb\u5217\u4e2d\u6d88\u5931\uff0cCortex\u7684\u4e09\u5927\u7cfb\u5217 M-R-A\uff0c\u5408\u8d77\u6765\u5c31\u662f ARM\u3002</p>","tags":["arm","profile"]},{"location":"blog/20230313/arm-arch/#profiles","title":"profiles","text":"<p>About the Arm architecture</p> <p>The Arm architecture is one of the most popular processor architectures in the world. Billions of Arm-based devices are shipped every year.</p> <p>The following table describes the three architecture profiles: A, R, and M:</p> A-Profile (Applications) R-Profile (Real-Time) M-Profile (Microcontroller) High performance Targeted at systems with real-time requirements Small, highly power- efficient devices Designed to run a complex operating system, such as Linux or Windows Commonly found in networking equipment, and embedded control systems Found at the heart of many IoT devices <p>These three profiles allow the Arm architecture to be tailored to the needs of different use cases, while still sharing several base features.</p> <p>Arm brands</p> <p>Arm <code>Cortex</code> and Arm <code>Neoverse</code> are the brand names that are used for the Arm processor IP offerings. Our partners offer other processor brands using the Arm architecture.</p> <p>This example smartphone contains the following processor types:</p> <ul> <li>An A-profile processor as the main CPU running a rich OS like Android.</li> <li>A cellular modem, based on an R-profile processor, provides connectivity.</li> <li>Several M-profile processors handle operations like system power management.</li> <li>The SIM card uses SecurCore, an M-profile processor with additional security features. SecurCore processors are commonly used in smart cards.</li> </ul> <p>Introduction to the Armv8-M Architecture and its Programmers Model User Guide:</p> <p>The <code>Armv8</code> architecture has several different profiles. These profiles are variants of the architecture that target different markets and use cases. The Armv8-M architecture is one of these architecture profiles.</p> <p>Arm defines three architecture profiles: Application (A), Real-time (R), and Microcontroller (M).</p>","tags":["arm","profile"]},{"location":"blog/20230313/arm-arch/#aarch64","title":"aarch64","text":"<p>AArch64: <code>AArch64</code> or <code>ARM64</code> is the 64-bit extension of the ARM architecture family. It was first introduced with the Armv8-A architecture, and had many extension updates.</p> <pre><code># mbpa2991-macOS\n$ arch\narm64\n\n# rpi4b-ubuntu\n$ arch\naarch64\n</code></pre> <p>Announced in October 2011, ARMv8-A represents a fundamental change to the ARM architecture. It adds an optional 64-bit architecture, named \"<code>AArch64</code>\", and the associated new \"<code>A64</code>\" instruction set.</p> <p>AArch64 provides user-space compatibility with the existing 32-bit architecture (\"<code>AArch32</code>\" / ARMv7-A), and instruction set (\"<code>A32</code>\"). The 16-32bit Thumb instruction set is referred to as \"<code>T32</code>\" and has no 64-bit counterpart.</p> <p>ARMv8-A allows 32-bit applications to be executed in a 64-bit OS, and a 32-bit OS to be under the control of a 64-bit hypervisor.</p> <p>aapcs64 - Terms</p> <p>aapcs64 - 2.2 Terms and abbreviations:</p> <p><code>AArch32</code>: The 32-bit general-purpose register width state of the Armv8 architecture, broadly compatible with the Armv7-A architecture. <code>AArch64</code>: The 64-bit general-purpose register width state of the Armv8 architecture.</p> <p>ARMv8-A includes the VFPv3/v4 and advanced SIMD (Neon) as standard features in both AArch32 and AArch64. It also adds cryptography instructions supporting AES, SHA-1/SHA-256 and finite field arithmetic.</p>","tags":["arm","profile"]},{"location":"blog/20230313/arm-arch/#naming_conventions","title":"Naming conventions","text":"model Arch Spec ISA Suffixes 64 + 32 bit AArch64 ARMv8-A A64 + A32 v8-A 32 + 16 (Thumb) bit AArch32 ARMv8-R / ARMv7-A A32 + T32 -A32 / -R / v7-A.","tags":["arm","profile"]},{"location":"blog/20230313/arm-arch/#aarch64_features","title":"AArch64 features","text":"<p>New instruction set, A64:</p> <ul> <li>Has <code>31</code> general-purpose 64-bit registers.</li> <li>Has dedicated zero or stack pointer (<code>SP</code>) register (depending on instruction).</li> <li>The program counter (<code>PC</code>) is no longer directly accessible as a register.</li> <li> <p>Instructions are still <code>32</code> bits long and mostly the same as A32 (with LDM/STM instructions and most conditional execution dropped).</p> <ul> <li>Has paired loads/stores (in place of LDM/STM).</li> <li>No predication for most instructions (except branches).</li> </ul> </li> <li> <p>Most instructions can take 32-bit or 64-bit arguments.</p> </li> <li>Addresses assumed to be 64-bit.</li> </ul> <p>Advanced SIMD (Neon) enhanced:</p> <ul> <li>Has 32 \u00d7 128-bit registers (up from 16), also accessible via VFPv4.</li> <li>Supports double-precision floating-point format.</li> <li>Fully IEEE 754 compliant.</li> <li>AES encrypt/decrypt and SHA-1/SHA-2 hashing instructions also use these registers.</li> </ul> <p>A new exception system: Fewer banked registers and modes.</p> <p>Memory translation from 48-bit virtual addresses based on the existing Large Physical Address Extension (LPAE), which was designed to be easily extended to 64-bit.</p> <p>Extension: Data gathering hint (ARMv8.0-DGH).</p>","tags":["arm","profile"]},{"location":"blog/20230313/arm-arch/#r__m","title":"R &amp; M","text":"<p>AArch64 was introduced in <code>ARMv8-A</code> and is included in subsequent versions of ARMv8-A. It was also introduced in <code>ARMv8-R</code> as an option, after its introduction in ARMv8-A; it is not included in <code>ARMv8-M</code>.</p> <p>ARM-R (real-time architecture)</p> <p>Optional AArch64 support was added to the Armv8-R profile, with the first Arm core implementing it being the Cortex-R82. It adds the <code>A64</code> instruction set, with some changes to the memory barrier instructions.</p>","tags":["arm","profile"]},{"location":"blog/20230313/arm-arch/#apple","title":"Apple","text":"<p>Apple silicon</p> <p>List of iPhone models</p> <p>List of Apple's mobile device codes types</p> <p>iPhone chip list: Here's what A-series chip is in each model - 9to5Mac</p> <p>List of Apple processors | Apple Wiki | Fandom</p> <ul> <li>Apple A7 \u2014 (2013) introduced in the iPhone 5S, the company's first 64-bit mobile processor. Also used in the 2nd and 3rd generation iPad minis and 1st generation iPad Air.</li> </ul>","tags":["arm","profile"]},{"location":"blog/20230313/arm-arch/#raspberry_pi","title":"Raspberry Pi","text":"<p>Raspberry Pi Specifications</p> model Release date Soc ISA CPU RPi 3 Model B Feb 2016 BCM2837 ARMv8-A (64/32-bit) 4\u00d7 Cortex-A53 1.2 GHz RPi 4 Model B Jun 2019\u200b/May 2020 BCM2711 ARMv8-A (64/32-bit) 4\u00d7 Cortex-A72 1.5 GHz or 1.8 GHz RPi 5 Oct 2023 BCM2712 ARMv8.2-A (64/32-bit) 4\u00d7 Cortex-A76 2.4 GHz <p>RPi3 in ARMv8 Mode \u00bb Raspberry Pi Geek</p>","tags":["arm","profile"]},{"location":"blog/20230313/arm-arch/#references","title":"references","text":"<p>ARM vs. Harvard vs. von Neumann GENERAL: Harvard vs von Neumann Architectures How to explain the harvard architecture of ARM processor at instruction level?</p>","tags":["arm","profile"]},{"location":"blog/20211005/binary-bitset-bytes/","title":"Binary \u2014\u2014 Bitset & Bytes","text":"<p>\u6240\u8c13\u6570\u5236\u662f\u6307\u8ba1\u6570\u7684\u65b9\u6cd5\u3002\u5bf9\u4e8e\u670910\u6839\u624b\u6307\u7684\u4eba\u6765\u6765\u8bf4\uff0c\u4f7f\u7528\u5341\u8fdb\u5236\u8868\u793a\u6cd5\u662f\u5f88\u81ea\u7136\u7684\u4e8b\u60c5\uff0c\u73b0\u4ee3\u8ba1\u7b97\u673a\u5219\u91c7\u7528\u7684\u662f\u4e8c\u8fdb\u5236\u7cfb\u7edf\uff0c\u5b58\u50a8\u548c\u5904\u7406\u7684\u4fe1\u606f\u4ee5\u4e8c\u503c\u4fe1\u53f7\u8868\u793a\u3002</p> <p>\u4e00\u4e32\u4e8c\u8fdb\u5236\u6570\u7801\u6309\u7167\u56fa\u5b9a\u957f\u5ea6\uff088\uff09\u7ec4\u5408\u51fa\u6709\u610f\u4e49\u7684\u57fa\u672c\u5b58\u50a8\u5355\u4f4d\u2014\u2014\u5b57\u8282\uff0c\u591a\u4e2a\u5b57\u8282\uff081,2,4,8\uff09\u53ef\u4ee5\u7ec4\u5408\u51fa\u57fa\u672c\u7b97\u672f\u5355\u5143 char,short,int/float,long/double\uff0c\u6216\u590d\u5408\u7c7b\u578b\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b\u3002</p> <p>\u5728\u8ba1\u7b97\u673a\u5185\u5b58\u6216\u78c1\u76d8\u4e0a\uff0c\u6307\u4ee4\u548c\u6570\u636e\u6ca1\u6709\u4efb\u4f55\u533a\u522b\uff0c\u90fd\u662f\u4e8c\u8fdb\u5236\u4fe1\u606f\u3002CPU \u5728\u5de5\u4f5c\u7684\u65f6\u5019\u628a\u6709\u7684\u4fe1\u606f\u89e3\u6790\u4e3a\u6307\u4ee4\uff0c\u6709\u7684\u4fe1\u606f\u89e3\u8bfb\u4e3a\u6570\u636e\uff0c\u4e3a\u540c\u6837\u7684\u4fe1\u606f\u8d4b\u4e88\u4e86\u4e0d\u540c\u7684\u610f\u4e49\u3002</p> <p>\u8fd9\u6d89\u53ca\u5230 Abstract State Machine\uff1a</p> <ul> <li>a <code>value</code> : what state are we in</li> <li>the <code>type</code> : what this state represents</li> <li>the <code>representation</code> : how state is distinguished</li> </ul>","tags":["binary","bitset","bytes"]},{"location":"blog/20211005/binary-bitset-bytes/#decimal","title":"decimal","text":"<p>\u4eba\u4e24\u624b\u52a0\u8d77\u6765\u517110\u6839\u624b\u6307\uff0c\u6545\u65e5\u5e38\u8ba1\u6570\u548c\u505a\u7b97\u672f\u90fd\u4f7f\u7528\u5341\u8fdb\u5236\u3002\u5927\u5bb6\u719f\u6089\u5e76\u4f7f\u7528\u4e86\u4e00\u5343\u591a\u5e74\u7684\u5341\u8fdb\u5236\u8d77\u6e90\u4e8e\u5370\u5ea6\uff0c\u572812\u4e16\u7eaa\u88ab\u963f\u62c9\u4f2f\u6570\u5b66\u5bb6\u6539\u8fdb\uff0c\u5e76\u572813\u4e16\u7eaa\u88ab\u610f\u5927\u5229\u6570\u5b66\u5bb6Leonardo Pisano\uff08Fibonacci\uff09\u5e26\u5230\u897f\u65b9\u30021\u30012\u30013\u7684\u7f57\u9a6c\u8ba1\u6570\u6cd5\u662f\u2160\u3001\u2161\u3001\u2162\uff0c\u2160+\u2161=\u2162 \u76f4\u89c2\u5c55\u793a\u4e86\u52a0\u6cd5\u8fd0\u7b97\u7684\u542b\u4e49\u3002</p> <p>\u6570\u636e\u65e0\u8bba\u4f7f\u7528\u54ea\u79cd\u8fdb\u4f4d\u5236\uff0c\u90fd\u6d89\u53ca\u4e24\u4e2a\u57fa\u672c\u8981\u7d20\uff1a\u57fa\u6570\uff08radix\uff09\u4e0e\u5404\u6570\u4f4d\u7684 \u4f4d\u6743\uff08weight\uff09\u3002 \u5341\u8fdb\u5236\u6570\u6709\u4e24\u4e2a\u7279\u70b9\uff1a</p> <ol> <li>\u75280\u30011\u30012\u30013\u3001...\u30019\u8fd910\u4e2a\u57fa\u672c\u7b26\u53f7\u8868\u793a\uff1b\u57fa\u672c\u6570\u5b57\u7b26\u53f7\uff08\u6570\u7801\uff09\u7684\u4e2a\u6570\u53eb\u57fa\u6570\u3002</li> <li>\u9075\u5faa\u201c\u9022\u5341\u8fdb\u4e00\u201d\u539f\u5219\uff0c\u6bcf\u4f4d\u8ba1\u6ee1\u5341\u65f6\u5411\u9ad8\u4f4d\u8fdb\u4e00\u3002</li> </ol> <p>\u4e00\u822c\u5730\uff0c\u4efb\u610f\u4e00\u4e2a\u5341\u8fdb\u5236\u6570 N \u90fd\u53ef\u4ee5\u8868\u793a\u4e3a \\(\\sum_{i=-m}^{n-1}K_i\\ast10^i\\)\uff1a</p> \\[ N = K_{n-1}\\ast10^{n-1} + K_{n-2}\\ast10^{n-2} + \\cdots + K_1\\ast10^1 + K_0\\ast10^0 + K_{-1}\\ast10^{-1} + K_{-2}\\ast10^{-2} + \\cdots + K_{-m}\\ast10^{-m} \\] <p>\u629b\u5f00\u5c0f\u6570\u90e8\u5206\uff0c\u6574\u6570\u6309\u6743\u7684\u5c55\u5f00\u5f0f\u4e3a\uff1a</p> \\[ N = \\sum_{i=0}^{n-1}K_i\\ast10^i = K_{n-1}\\ast10^{n-1} + K_{n-2}\\ast10^{n-2} + \\cdots + K_1\\ast10^1 + K_0\\ast10^0 \\] <p>\u4e00\u4e2a\u6570\u5b57\u7b26\u53f7\u5728\u4e0d\u540c\u4f4d\u65f6\uff0c\u4ee3\u8868\u7684\u6570\u503c\u4e0d\u540c\u3002\u5728\u4e0a\u8ff0\u8868\u8fbe\u5f0f\u4e2d\uff0c\u6570\u4f4d \\(K_i\\) \u7684\u6743\u4e3a \\(10^i\\)\uff08\u4ee5\u57fa\u6570\\(10\\)\u4e3a\u5e95\uff0c\u5e8f\u53f7\\(i\\)\u4e3a\u6307\u6570\uff09\uff0c\u6570\u5b57\u7b26\u53f7\u4e58\u4ee5\u5176\u4f4d\u6743\u4e3a\u8fd9\u4e2a\u6570\u5b57\u7b26\u53f7\u6240\u8868\u793a\u7684\u771f\u5b9e\u6570\u503c\uff08\\(K_i\\ast10^i\\)\uff09\u3002</p>","tags":["binary","bitset","bytes"]},{"location":"blog/20211005/binary-bitset-bytes/#binary","title":"binary","text":"<p>\u73b0\u4ee3\u8ba1\u7b97\u673a\u5b58\u50a8\u548c\u5904\u7406\u7684\u4fe1\u606f\u4ee5\u4e8c\u503c\u4fe1\u53f7\u8868\u793a\u3002\u4e8c\u503c\u4fe1\u53f7\u53ef\u4ee5\u8868\u793a\u4e3a\u5bfc\u7ebf\u4e0a\u7684\u9ad8\u7535\u538b\u6216\u4f4e\u7535\u538b\u3001\u6676\u4f53\u7ba1\u7684\u5bfc\u901a\u6216\u622a\u6b62\u3001\u7535\u5b50\u81ea\u65cb\u7684\u4e24\u4e2a\u65b9\u5411\uff0c\u6216\u8005\u987a\u65f6\u9488\u6216\u9006\u65f6\u9488\u7684\u78c1\u573a\u3002</p> <p>\u5f53\u4eca\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u4f7f\u7528\u7684\u57fa\u672c\u4e0a\u90fd\u662f\u753118\u4e16\u7eaa\u5fb7\u56fd\u6570\u7406\u54f2\u5b66\u5927\u5e08\u83b1\u5e03\u5c3c\u5179\u53d1\u73b0\u7684\u4e8c\u8fdb\u5236\u7cfb\u7edf\u3002\u4e8c\u8fdb\u5236\u6570\u5b57\u7cfb\u7edf\u4e2d\u53ea\u6709\u4e24\u79cd\u4e8c\u8fdb\u5236\u6570\u7801\u2014\u20140\u548c1\u3002\u8fd9\u4e9b\u5fae\u4e0d\u8db3\u9053\u7684\u4e8c\u8fdb\u5236\u6570\u5b57\uff0c\u6216\u8005\u79f0\u4e3a\u4f4d\uff08bit - binary digit\uff09\uff0c\u5f62\u6210\u4e86\u6570\u5b57\u9769\u547d\u7684\u57fa\u7840\u3002</p> <p>\u5bf9\u4e8e\u670910\u6839\u624b\u6307\u7684\u4eba\u6765\u6765\u8bf4\uff0c\u4f7f\u7528\u5341\u8fdb\u5236\u8868\u793a\u6cd5\u662f\u5f88\u81ea\u7136\u7684\u4e8b\u60c5\uff0c\u4f46\u662f\u5f53\u6784\u9020\u5b58\u50a8\u548c\u5904\u7406\u4fe1\u606f\u7684\u673a\u5668\u65f6\uff0c\u4e8c\u8fdb\u5236\u5de5\u4f5c\u5f97\u66f4\u597d\u3002\u5728\u8ba1\u7b97\u673a\u5185\u90e8\uff0c\u4e8c\u8fdb\u5236\u603b\u662f\u5b58\u653e\u5728\u7531\u5177\u6709\u4e24\u79cd\u76f8\u53cd\u72b6\u6001\u7684\u5b58\u50a8\u5143\u4ef6\u6784\u6210\u7684\u5bc4\u5b58\u5668\u6216\u5b58\u50a8\u5355\u5143\u4e2d\uff0c\u5373\u4e8c\u8fdb\u5236\u6570\u78010\u548c1\u662f\u7531\u5b58\u50a8\u5143\u4ef6\u7684\u4e24\u79cd\u76f8\u53cd\u72b6\u6001\u6765\u8868\u793a\u7684\u3002\u8fd9\u4f7f\u5f97\u4e8c\u503c\u4fe1\u53f7\u5f88\u5bb9\u6613\u5730\u88ab\u8868\u793a\u3001\u5b58\u50a8\u548c\u4f20\u8f93\u3002</p> <p>\u5728 \u6307\u4ee4\u96c6\u53ca\u6d41\u6c34\u7ebf \u4e2d\u63d0\u5230\uff0c\u5728\u4e0a\u4e2a\u4e16\u7eaa\u7684\u6253\u5b54\u7f16\u7a0b\u65f6\u4ee3\uff0c\u7eb8\u5e26\u4e0a\u7684\u6bcf\u4e2a\u5b54\u4ee3\u8868\u4e00\u4f4d(bit)\uff0c\u7a7f\u5b54\uff08presence\uff09\u8868\u793a1\uff0c\u672a\u7a7f\u5b54\uff08absence\uff09\u8868\u793a0\uff0c\u8fd9\u4e9b\u5b54\u5e8f\u5217\u88ab\u626b\u63cf\u8bc6\u522b\u4e3a\u673a\u5668\u6307\u4ee4\u7684\u4e8c\u8fdb\u5236\u4f4d\u4e32\u3002</p> <p>\u5341\u8fdb\u5236\u6570\u6309\u6743\u7684\u5c55\u5f00\u5f0f\u53ef\u4ee5\u63a8\u5e7f\u5230\u4efb\u610f\u8fdb\u4f4d\u8ba1\u6570\u5236\u3002\u4e8c\u8fdb\u5236\u4e2d\u53ea\u67090\u548c1\u4e24\u4e2a\u5b57\u7b26\uff0c\u57fa\u6570\u4e3a2\uff0c\u6ee1\u8db3\u201c\u9022\u4e8c\u8fdb\u4e00\u201d\u3002\u6743\u7528 \\(2^i\\) \u8868\u793a\uff0c\u4e8c\u8fdb\u5236\u7684\u6309\u6743\u5c55\u5f00\u5f0f\u4e3a \\(N =  \\sum_{i=0}^{n-1}b_i\\ast2^i\\)\u3002</p> <p>\u4e8c\u8fdb\u5236\u4e0e\u5176\u4ed6\u6570\u5236\u76f8\u6bd4\uff0c\u6709\u4ee5\u4e0b\u663e\u8457\u7279\u70b9\uff1a</p> <ol> <li>\u6570\u5236\u7b80\u5355\uff0c\u5bb9\u6613\u57fa\u4e8e\u5143\u5668\u4ef6\u7684\u7535\u5b50\u7279\u6027\u5b9e\u73b0\u6570\u5b57\u903b\u8f91\u7535\u8def\u3002</li> <li>\u7531\u4e8e\u4e8c\u8fdb\u5236\u53ea\u6709\u4e24\u79cd\u72b6\u6001\uff0c\u56e0\u6b64\u6297\u5e72\u6270\u6027\u5f3a\uff0c\u53ef\u9760\u6027\u3001\u7a33\u5b9a\u6027\u9ad8\u3002</li> <li>\u53ef\u4ee5\u57fa\u4e8e\u5e03\u5c14\u903b\u8f91\u4ee3\u6570\u8fdb\u884c\u5206\u6790\u548c\u7efc\u5408\uff0c\u8fd0\u7b97\u89c4\u5219\u76f8\u5bf9\u7b80\u5355\u6613\u5b9e\u73b0\u3002</li> </ol> <p>\u57fa\u6570\u4e3a2\u7684\u597d\u5904\u5728\u4e8e\u57fa\u672c\u7b97\u672f\u8fd0\u7b97\u8868\u5f88\u77ed\uff0c\u5bf9\u6bd4\u4e00\u4e0b\u5341\u8fdb\u5236\u548c\u4e8c\u8fdb\u5236\u7684\u52a0\u6cd5\u548c\u4e58\u6cd5\u8868\uff0c\u957f\u77ed\u76f8\u5f62\u4e00\u76ee\u4e86\u7136\u3002</p>","tags":["binary","bitset","bytes"]},{"location":"blog/20211005/binary-bitset-bytes/#bit_pattern","title":"bit pattern","text":"<p>2\u4e2a\u6bd4\u7279\u53ef\u4ee5\u7ec4\u5408\u51fa4\uff08\\(2^2\\)\uff09\u79cd\u72b6\u6001\uff0c\u53ef\u8868\u793a\u65e0\u7b26\u53f7\u6570\u503c\u8303\u56f4[0,3]\uff1b32\u4e2a\u6bd4\u7279\u53ef\u4ee5\u7ec4\u5408\u51fa4294967296\uff08\\(2^{32}\\)\uff09\u79cd\u72b6\u6001\uff0c\u53ef\u8868\u793a\u65e0\u7b26\u53f7\u6570\u503c\u8303\u56f4[0,4294967295]\uff1b\u2026\u2026\u3002</p> <p>\u7531\u4e8e\u4e00\u4e2a\u4f4d\u53ea\u80fd\u8868\u793a\u4e8c\u5143\u6570\u503c\uff0c\u6240\u4ee5\u5355\u72ec\u4e00\u4f4d\u7684\u7528\u5904\u4e0d\u5927\u3002\u5f53\u628a\u4f4d\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u518d\u52a0\u4e0a\u67d0\u79cd\u89e3\u91ca\uff08interpretation\uff09\uff0c\u5373\u8d4b\u4e88\u4e0d\u540c\u7684\u53ef\u80fd\u4f4d\u6a21\u5f0f\u4ee5\u542b\u610f\u3002\u901a\u5e38\u5c06\u56fa\u5b9a\u4f4d\u6570\u7684\u4f4d\u4e32\u4f5c\u4e3a\u4e00\u4e2a\u57fa\u672c\u5b58\u50a8\u5355\u4f4d\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b58\u50a8\u8303\u56f4\u8f83\u5927\u7684\u503c\u3002\u5728\u6709\u9650\u8303\u56f4\u5185\u7684\u53ef\u8ba1\u91cf\u6570\u503c\u51e0\u4e4e\u90fd\u53ef\u4ee5\u7528\u4e8c\u8fdb\u5236\u6570\u7801\u4f4d\u4e32\u7ec4\u5408\u8868\u793a\uff0c\u8ba1\u7b97\u673a\u7684\u5185\u5b58\u7531\u6570\u4ee5\u4ebf\u4e07\u8ba1\u7684\u6bd4\u7279\u4f4d\u5b58\u50a8\u5355\u5143\uff08\u6676\u4f53\u7ba1\uff09\u7ec4\u6210\u3002</p> <p>\u5927\u591a\u6570\u8ba1\u7b97\u673a\u4f7f\u75288\u4f4d\u7684\u5757\uff0c\u6216\u8005\u5b57\u8282\uff08byte\uff09\uff0c\u4f5c\u4e3a\u6700\u5c0f\u7684\u53ef\u5bfb\u5740\u7684\u5185\u5b58\u5355\u4f4d\uff0c\u800c\u4e0d\u662f\u8bbf\u95ee\u5185\u5b58\u4e2d\u5355\u72ec\u7684\u4f4d\uff08bit\uff09\u3002\u673a\u5668\u7ea7\u7a0b\u5e8f\u5c06\u5185\u5b58\u89c6\u4f5c\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u5b57\u8282\u6570\u7ec4\uff0c\u5185\u5b58\u7684\u6bcf\u4e2a\u5b57\u8282\u90fd\u7531\u4e00\u4e2a\u552f\u4e00\u7684\u6570\u5b57\u6765\u6807\u8bc6\uff0c\u79f0\u4e3a\u5b83\u7684\u5730\u5740\u3002</p> <p>The number of bits in a char(byte) is reported by the macro <code>CHAR_BIT</code> in the C header &lt;limits.h&gt; / &lt;climits&gt;.</p> <p>A C program, whatever its size, consists of functions and variables. \u5728 C \u7a0b\u5e8f\u91cc\uff0c\u53d8\u91cf\uff08variable\uff09\u5c31\u662f\u6570\u636e\uff0c\u51fd\u6570\uff08function\uff09\u5c31\u662f\u6307\u4ee4\u3002</p> <p>\u5728\u5185\u5b58\u6216\u78c1\u76d8\u4e0a\uff0c\u6307\u4ee4\u548c\u6570\u636e\u6ca1\u6709\u4efb\u4f55\u533a\u522b\uff0c\u90fd\u662f\u4e8c\u8fdb\u5236\u4fe1\u606f\u3002 \u6bcf\u4e2a\u7a0b\u5e8f\u5bf9\u8c61\u53ef\u4ee5\u7b80\u5355\u5730\u89c6\u4e3a\u4e00\u4e2a\u5b57\u8282\u5757\uff0c\u7a0b\u5e8f\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u5b57\u8282\u5e8f\u5217\u3002 CPU \u5728\u5de5\u4f5c\u7684\u65f6\u5019\u628a\u6709\u7684\u4fe1\u606f\u770b\u4f5c\u6307\u4ee4\uff0c\u6709\u7684\u4fe1\u606f\u770b\u4f5c\u6570\u636e\uff0c\u4e3a\u540c\u6837\u7684\u4fe1\u606f\u8d4b\u4e88\u4e86\u4e0d\u540c\u7684\u610f\u4e49\u3002</p>","tags":["binary","bitset","bytes"]},{"location":"blog/20211005/binary-bitset-bytes/#dump_bitset","title":"dump bitset","text":"<p>1byte=8bit\uff0c\u5e95\u5c42\u90fd\u662f\u4e8c\u8fdb\u5236\u4f4d\u4e32\u8fdb\u884c\u79fb\u4f4d\u5b9e\u73b0\u76f8\u5173\u64cd\u4f5c\u3002</p> <p>\u4ee5\u4e0b\u4e3a\u6253\u5370\u5355\u5b57\u8282\u548c\u53cc\u5b57\u8282\uff08short\uff09\u3001\u56db\u5b57\u8282\uff08int\uff09\u4e8c\u8fdb\u5236\u4f4d\u4e32\u7684\u7a0b\u5e8f\uff0c\u5305\u62ec\u4e09\u4e2a\u5b50\u51fd\u6570\uff0c\u529f\u80fd\u5982\u4e0b\uff1a</p> <ol> <li><code>hexdump</code>\uff1a\u8f93\u51fa\u6307\u5b9a\u5185\u5b58\u8d77\u59cb\u5730\u5740 start \u5f00\u59cb\u7684 size \u4e2a\u5b57\u8282\uff0cC \u7a0b\u5e8f\u662f\u6309\u7167 BYTE_ORDER dump memory bytearry\u3002</li> <li><code>print_bytes</code>\uff1a\u8f93\u51fa\u6307\u5b9a\u5185\u5b58\u5730\u5740 start \u5f00\u59cb\u7684 size \u4e2a\u5b57\u8282\u7684\u4e8c\u8fdb\u5236\u4f4d\u4e32\uff0cforeach \u6bcf\u4e2a\u5b57\u8282\u8c03\u7528 print_byte \u5b50\u51fd\u6570\u3002</li> <li><code>count_bits</code>\uff1a\u7edf\u8ba1\u6574\u6570 x \u7684\u4e8c\u8fdb\u5236\u4f4d\u4e32\u4e2d 1 \u7684\u4e2a\u6570\u3002</li> </ol> print-bitset.c<pre><code>#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\ntypedef unsigned char byte;\ntypedef unsigned char *byte_pointer;\n\n// Dump memory bytearray as BYTE_ORDER\nvoid hexdump(const byte_pointer start, const size_t size)\n{\n    size_t i = 0;\n    putchar('{');\n    for (i = 0; i &lt; size; i++)\n        printf(\"%#.2x%s\", start[i], i &lt; size - 1 ? \", \" : \"\");\n    puts(\"}\");\n}\n\n// Count bits set\nint count_bits(int x)\n{\n    int countx = 0;\n    while (x)\n    {\n        countx++;\n        x = x &amp; (x - 1);\n    }\n\n    return countx;\n}\n\n// Dump bitset from MSB to LSB\nvoid print_byte(const byte uc)\n{\n    for (int i = 0; i &lt; CHAR_BIT; ++i)\n    {\n        if ((uc &lt;&lt; i) &amp; 0x80)\n            putchar('1');\n        else\n            putchar('0');\n    }\n}\n\nvoid print_bytes(const byte_pointer start, const size_t size)\n{\n    int i = 0;\n\n#ifdef _BIG_ENDIAN\n    for (i = 0; i &lt; size; i++)\n    {\n        print_byte(start[i]);\n        if (i &lt; size - 1)\n            putchar('_');\n    }\n#else\n    for (i = size - 1; i &gt; -1; i--)\n    {\n        print_byte(start[i]);\n        if (i &gt; 0)\n            putchar('_');\n    }\n#endif\n    printf(\"\\n\");\n}\n\nint main(int argc, char *argv[])\n{\n    byte_pointer bp = NULL;\n    int bc = 0;\n    size_t size = 0;\n\n    short year = 2010;\n    bp = (byte_pointer)&amp;year;\n    size = sizeof year;\n    printf(\"hex(%hd) = %#x\\n\", year, year);\n    printf(\"hexdump(%hd) = \", year);\n    hexdump(bp, size);\n    printf(\"bitset = \");\n    print_bytes(bp, size);\n    bc = count_bits((int)(year));\n    printf(\"bits set count = %d\\n\", bc);\n\n    puts(\"\");\n\n    int hours = 86400;\n    bp = (byte_pointer)&amp;hours;\n    size = sizeof hours;\n    printf(\"hex(%d) = %#x\\n\", hours, hours);\n    printf(\"hexdump(%d) = \", hours);\n    hexdump(bp, size);\n    printf(\"bitset = \");\n    print_bytes(bp, size);\n    bc = count_bits(hours);\n    printf(\"bits set count = %d\\n\", bc);\n\n    return 0;\n}\n</code></pre> <p>\u4ee5\u4e0b\u662f\u5728 rpi4b-ubuntu/aarch64 \u4e0b\u6d4b\u8bd5\u7684\u7ed3\u679c\uff1a</p> <pre><code>$ cc print-bitset.c -o print-bitset -g &amp;&amp; ./print-bitset\nhex(2010) = 0x7da\nhexdump(2010) = {0xda, 0x07}\nbitset = 00000111_11011010\nbits set count = 8\n\nhex(86400) = 0x15180\nhexdump(86400) = {0x80, 0x51, 0x01, 00}\nbitset = 00000000_00000001_01010001_10000000\nbits set count = 5\n</code></pre> <p>\u6807\u51c6C++\u4e2d\u7684 &lt;bitset&gt; \u63d0\u4f9b\u4e86\u4e8c\u8fdb\u5236\u4f4d\u4e32\u64cd\u4f5c\u63a5\u53e3\uff0c\u53c2\u8003 TC++PL 34.2.2 bitset \u4e2d\u7684\u76f8\u5173\u8bf4\u660e\u3002</p> <ul> <li>std::bitset: The class template bitset represents a fixed-size sequence of N bits.</li> <li>Numerics library - Bit manipulation: &lt;bit&gt;(C++20) provides several function templates to access, manipulate, and process individual bits and bit sequences.</li> </ul> <p>\u5728 C++ \u4e2d\uff0c\u53ef\u57fa\u4e8e\u53cc\u5b57\u8282\uff08short\uff09\u3001\u56db\u5b57\u8282\uff08int\uff09\u6784\u9020 bitset\uff0c\u8c03\u7528 <code>std::cout &lt;&lt;</code> \u6253\u5370\u4f4d\u4e32\uff0c\u8c03\u7528\u6210\u5458\u51fd\u6570 <code>count()</code> \u8f93\u51fa\u503c\u4e3a 1 \u7684\u4f4d\u6570\u3002</p> <p>cout unsigned char as byte?</p> <p>c++ - cout not printing unsigned char</p> <p>\u6267\u884c <code>std::cout &lt;&lt; start[i]</code> \u6253\u5370 unsigned char\uff0c\u9ed8\u8ba4\u4f1a\u8f93\u51fa ASCII \u7801\u3002\u5982\u679c\u78b0\u4e0a\u4e0d\u53ef\u6253\u5370\u5b57\u7b26\uff08non-printable character\uff09\uff0c\u5219\u53ef\u80fd\u663e\u793a\u4e71\u7801\u3002 \u5982\u679c\u60f3\u8f93\u51fa\u5341\u516d\u8fdb\u5236 byte\uff0c\u5219\u9700\u8981\u5148\u5c06\u5176\u63d0\u5347\u4e3a\u6574\u5f62\uff08unsigned [int] \u6216 signed [int]\uff09\uff0c\u518d\u8c03\u7528 <code>std::cout &lt;&lt; hex</code>\u3002</p> print-bitset.cpp<pre><code>#include &lt;climits&gt;\n#include &lt;iostream&gt;\n#include &lt;iomanip&gt;\n#include &lt;bitset&gt;\n\nusing namespace std;\nusing byte_pointer = unsigned char*;\n\n// Dump memory bytearray as BYTE_ORDER\nvoid hexdump(const byte_pointer start, const size_t size)\n{\n    cout &lt;&lt; '{';\n    cout &lt;&lt; hex &lt;&lt; setw(2) &lt;&lt; setfill('0');\n    for (size_t i = 0; i &lt; size; i++)\n        // unary plus triggers implicit (arithmetic) conversions\n        // integral promotion: promote smaller integer to int\n        cout &lt;&lt; +start[i] &lt;&lt; (i&lt;size-1 ? \", \" : \"\");\n        // or explicit integral promotion\n        // cout &lt;&lt; static_cast&lt;unsigned&gt;(start[i]) &lt;&lt; (i&lt;size-1 ? \", \" : \"\");\n    cout &lt;&lt; '}' &lt;&lt; endl;\n}\n\nint main(int argc, char *argv[])\n{\n    byte_pointer bp = nullptr;\n\n    short year = 2010;\n    cout &lt;&lt; \"hex(\" &lt;&lt; year &lt;&lt; \") = \" &lt;&lt; showbase &lt;&lt; hex &lt;&lt; year &lt;&lt; dec &lt;&lt; endl;\n    bp = reinterpret_cast&lt;byte_pointer&gt;(&amp;year);\n    cout &lt;&lt; \"hexdump(\" &lt;&lt; year &lt;&lt; \") = \" ;\n    hexdump(bp, sizeof year);\n    bitset&lt;sizeof(year) * CHAR_BIT&gt; bs1 (year);\n    cout &lt;&lt; \"bitset(\" &lt;&lt; year &lt;&lt; \") = \" &lt;&lt; bs1 &lt;&lt; endl;\n    cout &lt;&lt; \"bits set count = \" &lt;&lt; dec &lt;&lt; bs1.count() &lt;&lt; endl;\n\n    cout &lt;&lt; endl;\n\n    int hours = 86400;\n    cout &lt;&lt; \"hex(\" &lt;&lt; hours &lt;&lt; \") = \" &lt;&lt; showbase &lt;&lt; hex &lt;&lt; hours &lt;&lt; dec &lt;&lt; endl;\n    bp = reinterpret_cast&lt;byte_pointer&gt;(&amp;hours);\n    cout &lt;&lt; \"hexdump(\" &lt;&lt; hours &lt;&lt; \") = \" ;\n    hexdump(bp, sizeof hours);\n    bitset&lt;sizeof(hours) * CHAR_BIT&gt; bs2 (hours);\n    cout &lt;&lt; \"bitset(\" &lt;&lt; hours &lt;&lt; \") = \" &lt;&lt; bs2 &lt;&lt; endl;\n    cout &lt;&lt; \"bits set count = \" &lt;&lt; dec &lt;&lt; bs2.count() &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre> <p>\u4ee5\u4e0b\u662f\u5728 rpi4b-ubuntu/aarch64 \u4e0b\u6d4b\u8bd5\u7684\u7ed3\u679c\uff1a</p> <pre><code>$ c++ print-bitset.cpp -o print-bitset -g &amp;&amp; ./print-bitset\nhex(2010) = 0x7da\nhexdump(2010) = {0xda, 0x7}\nbitset(0x7da) = 0000011111011010\nbits set count = 8\n\nhex(86400) = 0x15180\nhexdump(86400) = {0x80, 0x51, 0x1, 00}\nbitset(0x15180) = 00000000000000010101000110000000\nbits set count = 5\n</code></pre> <p>hex vs. hexdump byte order mismatch</p> <p>hex(2010) \u8f93\u51fa\u5341\u516d\u8fdb\u5236\u662f 0x7da\uff0chexdump(2010) \u8f93\u51fa\u5185\u5b58\u4e2d\u7684\u5b57\u8282\u6570\u7ec4\u662f {0xda, 0x7}\uff0c\u5b57\u8282\u987a\u5e8f\u4e3a\u4ec0\u4e48\u4e0d\u540c\uff1f</p>","tags":["binary","bitset","bytes"]},{"location":"blog/20211005/binary-bitset-bytes/#reinterpretation","title":"reinterpretation","text":"<p>\u5173\u4e8e Width in bits by data model\uff0c\u53c2\u8003 C Data Types \u548c C++ Data Types\u3002</p> <ul> <li>C99 \u589e\u52a0\u4e86\u4e00\u79cd64\u4f4d\u6574\u6570\u7c7b\u578b \u2014\u2014 long long\uff0c&lt;limits.h&gt; \u4e2d\u89c4\u5b9a\u4e86\u5176 minimal precision \u4e3a 64\u3002</li> <li>\u5728 C++ Fundamental types \u4e2d\u89c4\u5b9a\uff1along long \u2014 target type will have width of at least 64 bits. (since C++11)</li> </ul> <p>\u4e0b\u56fe\u4e3a Microsoft LLP64 Data Model \u4e2d\u00a0C++ Type System\u00a0\u7684 Fundamental (built-in) types \u6309\u5b57\u8282\u5bbd\u5ea6\u7684\u5c42\u780c\u56fe\uff08Layout of Source Language Data Types\uff09\uff1a</p> MSVC built-in type sizes <p>\u5728 MS LLP64 \u6570\u636e\u6a21\u578b\u4e2d\uff0c\u7ef4\u6301 ILP32 \u6a21\u5f0f\u4e0b\u7684 <code>__SIZEOF_LONG__</code>=<code>__SIZEOF_INT__</code>=4\uff0c \u6ee1\u8db3\uff1a</p> <ul> <li><code>__SIZEOF_LONG_LONG__</code> == <code>__SIZEOF_POINTER__</code> = 8\u3002</li> </ul> <p>\u5178\u578b Unix-like systems\uff08\u5982 Linux\uff0cmacOS\uff09\u7684 Data Model \u4e00\u822c\u4e3a LP64\uff1a</p> <ul> <li><code>LONG_BIT</code> = <code>__WORDSIZE</code> = 64</li> <li><code>__SIZEOF_LONG__</code> = <code>__SIZEOF_POINTER__</code> = 8</li> </ul> <p>\u65e0\u8bba\u662f\u5728 LLP64 \u8fd8\u662f\u5728 LP64 \u6a21\u5f0f\u4e0b\uff0c\u4e00\u4e2a8byte\u5bbd\u7684\u5b58\u50a8\u5355\u5143\uff0c\u53ef\u4ee5\u5b58\u50a81\u4e2a long long/double\u30012\u4e2a\u8fde\u7eed\u7684 int/float\u30014\u4e2a\u8fde\u7eed\u7684 wchart_t\uff08short\uff09\u30018\u4e2a\u8fde\u7eed\u7684byte\uff08char\uff09\u3002</p> <p>\u5bf9\u4e8e\u7ed9\u5b9a\u7684 memory byte array\uff0c\u53ef\u6309\u9700\u5bf9\u5b57\u8282\u4e32\u8fdb\u884c\u7ec4\u5408\u6790\u53d6\u6216\u7c7b\u578b\u8f6c\u6362\u3002\u901a\u7528\u6307\u9488 void* \u7684\u5999\u5904\u5c31\u5728\u4e8e\u53ef\u4ee5\u6309\u7167\u9700\u8981\u64cd\u4f5c\u4e00\u5757\u5185\u5b58\uff0c\u4ee5\u53d6\u6240\u9700\u503c\u7c7b\u578b\u3002</p> <p>\u4e0a\u9762\u6d4b\u8bd5\u7a0b\u5e8f print-bitset \u4e2d\u7684 hexdump \u51fd\u6570\u7684\u4f5c\u7528\u662f Dump memory bytearray as BYTE_ORDER\u3002</p> <p>\u4ee5\u4e0b\u6d4b\u8bd5 C \u7a0b\u5e8f\u5219\u6f14\u793a\u4e86\u5c06 byte array \u6309\u7167 1\u30012\u30014 \u4e09\u79cd\u5b57\u8282\u7ec4\u5408\u6790\u503c\u60c5\u51b5\u3002</p> bytes-reinterpret.c<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main(int argc, const char *argv[])\n{\n    int i;\n    const int size = 9;\n    int8_t byte[] = {48, 49, 50, 51, 52, 53, 54, 55, 0};\n    printf(\"byte array = {\");\n    for (i = 0; i &lt; size; i++)\n        printf(\"0x%x%s\", byte[i], i&lt;size-1 ? \", \" : \"\");\n    puts(\"}\");\n\n    int8_t *pByte = byte;\n    puts(\"----------------------------------\");\n    printf(\"c string = \\\"%s\\\"\\n\", pByte);\n\n    puts(\"----------------------------------\");\n    puts(\"\u6bcf2\u4e2abyte\u7ec4\u5408\u800c\u6210\u768416\u8fdb\u5236\u503c:\");\n    int16_t *pi16 = (int16_t *)pByte;\n    for (i = 0; i &lt; size/2; i++)\n    {\n        int16_t i16 = *(pi16 + i);\n        printf(\"short array [%d] = 0x%4x\\n\", i, *(pi16 + i));\n    }\n\n    puts(\"----------------------------------\");\n\n    puts(\"\u6bcf4\u4e2abyte\u7ec4\u5408\u800c\u6210\u768416\u8fdb\u5236\u503c:\");\n    int32_t *pi32 = (int32_t *)pByte;\n    for (i = 0; i &lt; size/4; i++)\n    {\n        int32_t i32 = *(pi32 + i);\n        printf(\"int array [%d] = %#x\\n\", i, *(pi32 + i));\n    }\n\n    puts(\"----------------------------------\");\n\n    return 0;\n}\n</code></pre> <p>\u5728 rpi4b-ubuntu/aarch64 \u4e0b\u7684\u6d4b\u8bd5\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>$ cc bytes-reinterpret.c -o bytes-reinterpret &amp;&amp; ./bytes-reinterpret\nbyte array = {0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x0}\n----------------------------------\nc string = \"01234567\"\n----------------------------------\n\u6bcf2\u4e2abyte\u7ec4\u5408\u800c\u6210\u7684\u77ed\u6574\u578b:\nshort array [0] = 0x3130\nshort array [1] = 0x3332\nshort array [2] = 0x3534\nshort array [3] = 0x3736\n----------------------------------\n\u6bcf4\u4e2abyte\u7ec4\u5408\u800c\u6210\u7684\u6574\u5f62:\nint array [0] = 0x33323130\nint array [1] = 0x37363534\n----------------------------------\n</code></pre> <p>why 0x3130 , not 0x3031?</p> <p>\u6bcf2\u4e2abyte\u7ec4\u5408\u800c\u6210\u7684\u77ed\u6574\u578b short array [0] \u4e3a\u4ec0\u4e48\u662f <code>0x3130</code>\uff0c\u800c\u975e <code>0x3031</code>\uff1f</p>","tags":["binary","bitset","bytes"]},{"location":"blog/20211005/binary-bitset-bytes/#type_conversion","title":"type conversion","text":"<p>\u5bf9\u4e8e\u5b57\u7b26\u578b char \u53d8\u91cf\uff0c\u77ed\u6574\u578b short \u53d8\u91cf\uff0c\u53ef\u4ee5\u63d0\u5347\uff08promote\uff09\u4e3a\u66f4\u5bbd\u7684 int \u7c7b\u578b\u3002 int accommodate short \u5c5e\u4e8e\u201c\u5927\u80a0\u5305\u5c0f\u80a0\u201d\u3001\u201c\u5927\u7bb1\u88c5\u5c0f\u5305\u201d\uff0c\u4e0d\u4f1a\u6709\u7cbe\u5ea6\u635f\u5931\u3002</p> <p>\u5728 binary representation \u5c42\u9762\uff0c\u4e00\u822c\u4f1a expanding sign bit \u5b9e\u73b0\u7b49\u503c integral promotion\uff0c\u53c2\u8003 \u8ba1\u7b97\u673a\u4e2d\u6709\u7b26\u53f7\u6570\u7684\u8868\u793a\u3002</p> test-conversion-promotion.c<pre><code>    unsigned char uc = 128;\n    int i = (int)uc;\n    printf(\"uc = %hhu, i = %d\\n\", uc, i);\n    printf(\"uc = %#x, i = %#.8x\\n\", uc, i);\n\n    short s = 0x5678;\n    i = (int)s;\n    printf(\"s = %hd, i = %d\\n\", s, i);\n    printf(\"s = %#hx, i = %#.8x\\n\", s, i);\n</code></pre> <p>\u53cd\u8fc7\u6765\uff0c\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u6574\u5f62 int \u53d8\u91cf\uff0c\u4e5f\u53ef\u4ee5\u5f3a\u5236\u8f6c\u6362\uff08force conversion\uff09\u6790\u53d6\u90e8\u5206 byte \u503c\u3002 \u8fd9\u79cd narrow down \u4f1a\u5f15\u8d77 precision truncate\uff0c\u6b64\u4e4b\u8c13\u201c\u65ad\u7ae0\u53d6\u4e49\u201d\uff0c\u53ea\u80fd\u83b7\u5f97\u201c\u4ee5\u504f\u6982\u5168\u201d\u7684\u201c\u4e00\u5b54\u4e4b\u89c1\u201d\u3002</p> test-conversion-narrow-down.c<pre><code>    int i = 0x12345678;\n    short s = (short)i;\n    char c = (char)i;\n    printf(\"i = %#x, s = %#x, c = %#x\\n\", i, s, c);\n</code></pre> <p>\u5143\u82b3\uff0c\u4f60\u600e\u4e48\u770b\uff1f</p> <p>\u5206\u6790\u4e00\u4e0b\u7a0b\u5e8f test-conversion-narrow-down.c \u7684\u8f93\u51fa\u7ed3\u679c\u3002</p>","tags":["binary","bitset","bytes"]},{"location":"blog/20211007/byte-order-endianess/","title":"Byte Order(Endianess)","text":"<p>\u5728 Binary \u2014\u2014 Bitset &amp; Bytes \u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u6253\u5370 bitset \u548c byte array\uff0c\u76f4\u89c2\u611f\u53d7\u4e86\u4e8c\u8fdb\u5236\u7684\u4f4d\u6a21\u5f0f\uff08bit pattern &amp; binary representation\uff09\u3002\u7136\u540e\uff0c\u9057\u7559\u4e0b\u4e86\u4e09\u4e2a\u95ee\u9898\uff1a</p> <ol> <li>hex(2010) \u8f93\u51fa\u5341\u516d\u8fdb\u5236\u662f 0x7da\uff0chexdump(2010) \u8f93\u51fa\u5185\u5b58\u4e2d\u7684\u5b57\u8282\u6570\u7ec4\u662f {0xda, 0x7}\uff0c\u5b57\u8282\u987a\u5e8f\u4e3a\u4ec0\u4e48\u4e0d\u540c\uff1f</li> <li>\u6bcf2\u4e2abyte\u7ec4\u5408\u800c\u6210\u7684\u77ed\u6574\u578b short array [0] \u4e3a\u4ec0\u4e48\u662f <code>0x3130</code>\uff0c\u800c\u975e <code>0x3031</code>\uff1f</li> <li>\u7a0b\u5e8f test-conversion-narrow-down.c \u8f93\u51fa\u7ed3\u679c\u662f\u600e\u6837\u7684\uff1f</li> </ol> <p>\u8fd9\u4e09\u4e2a\u95ee\u9898\u7684\u7b54\u6848\u90fd\u6d89\u53ca\u5230\u5b57\u8282\u5e8f\uff08Byte Order\uff09\u95ee\u9898\u3002</p>","tags":["byte_order","endianess"]},{"location":"blog/20211007/byte-order-endianess/#storage_order","title":"storage order","text":"<p>\u5148\u6765\u56de\u987e\u4e00\u4e0b C Basic Types - Binary Representions \u4e2d\u63d0\u5230\u7684 <code>LSB</code>/<code>MSB</code> \u6982\u5ff5: </p> <p>LSB vs. MSB</p> <p>The binary representation for non-negative integer values is always exactly what the term indicates: such a number is represented by binary digits \\(b_0, b_1, \\ldots, b_{p-1}\\) called bits. Each of the bits has a value of 0 or 1. The value of such a number is computed as \\(\\sum_{i=0}^{p-1}b_i\\ast2^i\\).</p> <p>The value p in that binary representation is called the precision of the underlying type. Bit \\(b_0\\) is called the least-signi\ufb01cant bit, and LSB, \\(b_{p\u22121}\\) is the most-signi\ufb01cant bit(MSB).</p> <p>Of the bits \\(b_i\\) that are 1, the one with minimal index i is called the least-signi\ufb01cant bit set, and the one with the highest index is the most-signi\ufb01cant bit set.</p> <p>\u5728 The C Memory Model \u4e2d\u501f union \u4e00\u503c\u4e24\u6790\uff0c\u7531 storage order \u8fdb\u4e00\u6b65\u5f15\u51fa\u4e86 <code>endianess</code> \u7684\u6982\u5ff5\uff1a</p> <p>endianess: big-endian &amp; little-endian</p> <p>That is, a platform provider might decide to provide a storage order that has the highest-order digits \ufb01rst, and then print lower-order digits one by one. The storage order, the endianness, as given for my machine, is called little-endian. A system that has high-order representation digits \ufb01rst is called big-endian. Both orders are commonly used by modern processor types. Some processors are even able to switch between the two orders on the \ufb02y.</p> <p>aapcs64 - 5.8 Byte order (\"Endianness\"):</p> <p>From a software perspective, memory is an array of bytes, each of which is addressable. This ABI supports two views of memory implemented by the underlying hardware.</p> <ul> <li>In a <code>little-endian</code> view of memory the least significant byte of a data object is at the lowest byte address the data object occupies in memory.</li> <li>In a <code>big-endian</code> view of memory the least significant byte of a data object is at the highest byte address the data object occupies in memory.</li> </ul> <p>The least significant bit in an object is always designated as bit 0.</p> <p>The mapping of a word-sized data object to memory is shown in the following figures. All objects are pure-endian, so the mappings may be scaled accordingly for larger or smaller objects.</p> Memory layout of big-endian data object Memory layout of little-endian data object <p>\u7ecf\u7531\u4e0a\u8ff0\u94fa\u9648\uff0c\u5b57\u8282\u5e8f\uff08Byte Order, Endianess\uff09\u7684\u6982\u5ff5\u5df2\u7136\u660e\u6670\uff0c\u6982\u62ec\u6765\u8bb2\u5c31\u662f\u4e8b\u5173 storage order \u2014\u2014 LSB/MSB who store first\uff1f</p> <p>\u5bf9\u4e8e\u5c0f\u5c3e\u7aef\uff08little endian\uff09\u7cfb\u7edf\uff0c\u5728\u5185\u5b58\u8d77\u59cb\u5730\u5740\u5904\u5b58\u653e\u6574\u6570\u7684\u4f4e\u5e8f\u53f7\u5b57\u8282\uff08LSB first\uff09\uff1b\u53cd\u4e4b\uff0c\u5bf9\u4e8e\u5927\u5c3e\u7aef\uff08big endian\uff09\u7cfb\u7edf\uff0c\u5728\u5185\u5b58\u8d77\u59cb\u5730\u5740\u5904\u5b58\u653e\u6574\u6570\u7684\u9ad8\u5e8f\u53f7\u5b57\u8282\uff08MSB first\uff09\u3002</p> <p>\u5728 big endian \u7cfb\u7edf\u4e0b\uff0c\u66f4\u7b26\u5408\u4eba\u7684\u76f4\u89c2\u89c6\u89c9\u3002\u4f8b\u5982 int \u503c 0x33323130\uff0c\u5728\u5185\u5b58\u4e2d\u7684\u5b58\u50a8\u987a\u5e8f\u540c\u4eba\u773c\u775b\u4ece\u5de6\u5230\u53f3\uff08\u9ad8\u4f4d\u5230\u4f4e\u4f4d\uff09\u7684\u626b\u63cf\u987a\u5e8f\u4e00\u81f4\uff0cMSB store first\uff0cmemory byte array \u4e3a {0x33, 0x32, 0x31, 0x30}\uff1b\u5728 little endian \u7cfb\u7edf\u4e0b\uff0cLSB store first\uff0c\u5148\u5b58\u50a8\u4f4e\u4f4d\u5b57\u8282\uff0cint \u503c 0x33323130 \u5728 memory \u4e2d\u7684 byte array \u4e3a {0x30, 0x31, 0x32, 0x33}\u3002</p> <p>\u5728\u79fb\u52a8\u5d4c\u5165\u5f0f\u9886\u57df\uff0c\u7edf\u6cbb\u5e02\u573a\u7684 MIPS \u548c ARM \u5904\u7406\u5668\u53ef\u901a\u8fc7\u914d\u7f6e\u5bc4\u5b58\u5668\u91c7\u7528\u4e0d\u540c\u7684\u5b57\u8282\u5e8f\uff0c\u9ed8\u8ba4\u91c7\u7528 Little-Endian\u3002\u4f46 ARM\u00a0\u59cb\u7ec8\u91c7\u7528 Big-Endian \u5b58\u50a8\u6d6e\u70b9\u6570\u3002\u65e9\u671f\u4f7f\u7528 PowerPC \u5904\u7406\u5668\u7684\u00a0Mac \u91c7\u7528\u5927\u5b57\u8282\u5e8f\uff0c\u540e\u6765\u7684 Mac\u00a0\u540c Windows PC \u4e00\u6837\u90fd\u91c7\u7528 Intel x86 \u82af\u7247\uff0c\u56e0\u6b64\u4e5f\u90fd\u662f\u5c0f\u5b57\u8282\u5e8f\u5b58\u50a8\u7684\u3002</p> <p>64-bit PowerPC Function Calling Conventions: This environment uses the big-endian byte ordering scheme to store numeric and pointer data types. That is, the most significant bytes go first, followed by the least significant bytes.</p> <p>\u300a\u6df1\u5165\u7406\u89e3\u8ba1\u7b97\u673a\u7cfb\u7edf\u300b\uff08Computer Systems - A Programmer\u2019s Perspective\uff09\u4e2d 2.1: Information Storage | 2.1.3: Addressing and Byte Ordering \u4e5f\u6709\u5173\u4e8e endianess \u7684\u8be6\u7ec6\u8bba\u8ff0\u3002</p> <p>assembly - QWORD Storing / implementing using 32-bit REGs.? - Stack Overflow</p> <p>Overview of ARM64 ABI conventions - Endianness</p>","tags":["byte_order","endianess"]},{"location":"blog/20211007/byte-order-endianess/#network_byte_order","title":"network byte order","text":"<p>\u4ece\u7ef4\u57fa\u767e\u79d1\u4e2d\u5173\u4e8e Endianness \u7684\u4ecb\u7ecd\uff0c\u5176\u6700\u65e9\u6e90\u8d77\u4e8e \u7f51\u7edc\u7f16\u7a0b\uff0c\u6838\u5fc3\u5c31\u662f\u201cbyte significance compared to earliness\u201d\u7684\u6536\u53d1\u6b21\u5e8f\u95ee\u9898\u3002</p> <p>Endianness</p> <p>In computing, endianness is the order in which bytes within a word of digital data are transmitted over a data communication medium or addressed (by rising addresses) in computer memory, counting only byte significance compared to earliness.</p> <p>Endianness is primarily expressed as big-endian (BE) or little-endian (LE), terms introduced by Danny Cohen into computer science for data ordering in an Internet Experiment Note published in 1980.</p> <p>TCP/IP \u534f\u8bae\u7edf\u4e00\u89c4\u5b9a\u91c7\u7528\u5927\u7aef\u65b9\u5f0f\u5c01\u88c5\u89e3\u6790\u4f20\u8f93\u6570\u636e\uff0c\u4e5f\u79f0\u4e3a\u7f51\u7edc\u5b57\u8282\u987a\u5e8f\uff08network byte order\uff0cTCP/IP-endian\uff09\u3002</p> <p>RFC 1700 - Assigned Numbers - Data Notations</p> <p>https://datatracker.ietf.org/doc/rfc1700/</p> <p>The convention in the documentation of Internet Protocols is to express numbers in decimal and to picture data in \"big-endian\" order [COHEN].  That is, fields are described left to right, with the most significant octet on the left and the least significant octet on the right.</p> <p>The order of transmission of the header and data described in this document is resolved to the octet level.  Whenever a diagram shows a group of octets, the order of transmission of those octets is the normal order in which they are read in English.  For example, in the following diagram the octets are transmitted in the order they are numbered.</p> <pre><code>    0                   1                   2                   3\n    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|       1       |       2       |       3       |       4       |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|       5       |       6       |       7       |       8       |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n|       9       |      10       |      11       |      12       |\n+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n                    Transmission Order of Bytes\n</code></pre> <p>Whenever an octet represents a numeric quantity the left most bit in the diagram is the high order or most significant bit.  That is, the bit labeled 0 is the most significant bit.  For example, the following diagram represents the value 170 (decimal).</p> <pre><code>                    0 1 2 3 4 5 6 7\n                    +-+-+-+-+-+-+-+-+\n                    |1 0 1 0 1 0 1 0|\n                    +-+-+-+-+-+-+-+-+\n\n                    Significance of Bits\n</code></pre> <p>Similarly, whenever a multi-octet field represents a numeric quantity the left most bit of the whole field is the most significant bit.  When a multi-octet quantity is transmitted the most significant octet is transmitted first.</p> <p>\u4ee5\u4e0b\u4e3a MSDN \u4e2d\u5173\u4e8e\u00a0Packet byte/bit order \u7684\u9610\u8ff0\uff1a</p> <p>For packets, the bit numbering convention followed is the same as that used in RFCs, namely: the high (most significant) bit of the first byte to hit the wire is in packet bit 0, and the low bit of the last byte to hit the wire is in packet bit 31 (so that the bits are shown from left-to-right in the order they naturally appear over the network).</p> <p>Networking and Internet | Windows Sockets 2 | Byte Ordering:</p> <p>Care must always be taken to account for any differences between the byte ordering used for storing integers by the host architecture and the byte ordering used on the wire by individual transport protocols. Any reference to an address or port number passed to or from a Windows Sockets routine must be in the network order (big-endian) for the protocol being utilized.</p> <p>\u5728\u7f51\u7edc\u901a\u4fe1\u534f\u8bae\u7a0b\u5e8f\u4e2d\uff0c\u5728\u8fdb\u884c\u7f51\u7edc\u6570\u636e\u7684\u6536\u53d1\u65f6\uff0c\u9700\u8981\u53d1\u6536\u53cc\u65b9\u6267\u884c\u5b57\u8282\u5e8f\u8f6c\u6362\uff08convert values between host and network byte order\uff09\u3002</p> <p>\u5728 Linux \u4e0a\u6267\u884c <code>man BYTEORDER</code> \u53ef\u4ee5\u67e5\u770b\u76f8\u5173\u7f16\u7a0b\u63a5\u53e3\uff0c\u4e5f\u53ef\u53c2\u8003 The GNU C Library \u6587\u6863\uff1aSockets | The Internet Namespace | Byte Order Conversion\u3002</p> man BYTEORDER <pre><code>$ man BYTEORDER # man htonl\n\nBYTEORDER(3)                       Linux Programmer's Manual                      BYTEORDER(3)\n\nNAME\n      htonl, htons, ntohl, ntohs - convert values between host and network byte order\n\nSYNOPSIS\n      #include &lt;arpa/inet.h&gt;\n\n      uint32_t htonl(uint32_t hostlong);\n\n      uint16_t htons(uint16_t hostshort);\n\n      uint32_t ntohl(uint32_t netlong);\n\n      uint16_t ntohs(uint16_t netshort);\n\nDESCRIPTION\n      The  htonl()  function  converts  the unsigned integer hostlong from host byte order to\n      network byte order.\n\n      The htons() function converts the unsigned short integer hostshort from host byte order\n      to network byte order.\n\n      The  ntohl()  function converts the unsigned integer netlong from network byte order to\n      host byte order.\n\n      The ntohs() function converts the unsigned short integer netshort from network byte or\u2010\n      der to host byte order.\n\n      On  the  i386  the host byte order is Least Significant Byte first, whereas the network\n      byte order, as used on the Internet, is Most Significant Byte first.\n</code></pre> <p>\u5728 macOS/ubuntu \u4e0b\u6267\u884c <code>grep -RH \"htonl\\|ntohl\"</code> \u53ef\u4ee5\u67e5\u627e\u5230\uff1a</p> <ol> <li>macOS: usr/include/sys/_endian.h \u4e2d\u6839\u636e <code>__DARWIN_BYTE_ORDER</code> \u7684\u503c\u5b9a\u4e49\u4e86\u5b57\u8282\u5e8f\u8f6c\u6362\u5b8f <code>htonl</code>/<code>ntohl</code>\uff0c\u5728 usr/include/arpa/inet.h \u548c usr/include/netinet/in.h \u4e2d\u5305\u542b\u4e86 &lt;sys/_endian.h&gt;\u3002</li> <li>ubuntu: /usr/include/netinet/in.h \u4e2d\u6839\u636e <code>__BYTE_ORDER</code> \u7684\u503c\u5b9a\u4e49\u4e86\u5b57\u8282\u5e8f\u8f6c\u6362\u5b8f <code>htonl</code>/<code>ntohl</code>\u3002</li> <li>\u5728 macOS/ubuntu \u4e0b\uff0carpa/inet.h \u4e2d\u90fd\u5305\u542b\u4e86 &lt;netinet/in.h&gt;\u3002</li> </ol> <p>\u5728C/S\u901a\u4fe1\u7a0b\u5e8f\u4e2d\uff0c\u53d1\u9001\u65b9\u5c06\u672c\u5730\u6570\u636e\u8c03\u7528 <code>htons</code>/<code>htonl</code>/<code>htonll</code>\uff0c\u5e8f\u5217\u5316\u6253\u5305\u5230 buffer\uff0c\u518d\u8c03\u7528 socket API \u7684 send() \u63a5\u53e3\u5c06\u6570\u636e\u53d1\u9001\u5230\u7f51\u7edc\u3002\u63a5\u6536\u65b9\u7b49\u5f85 I/O \u901a\u77e5\uff0c\u5b9e\u65f6\u8c03\u7528 socket API \u7684 recv() \u63a5\u53e3\u5c06\u6570\u636e\u4ece\u7f51\u5361\u63a5\u6536\u5230\u7528\u6237\u5c42\uff0c\u7528\u6237\u5c42\u9700\u6309\u7167 TLV \u89e3\u5305\uff0c\u5bf9\u7b49\u8c03\u7528 <code>ntohs</code>/<code>ntohl</code>/<code>ntohll</code> \u89e3\u6790\u590d\u539f\u51fa\u539f\u59cb\u6570\u503c\u3002</p> <p>\u5047\u8bbe A \u548c B \u90fd\u662f Little-Endian\uff0cA \u8981\u7ed9 B \u53d1\u9001\u4e00\u4e2a\u77ed\u6574\u6570 s=0x7da\uff0c\u5176\u5728\u5185\u5b58\u4e2d\u7684\u5b57\u8282\u6570\u7ec4\u662f {0xda, 0x7}\u3002\u4ee5\u4e0b\u7a0b\u5e8f\u7247\u6bb5\u7b80\u5355\u793a\u610f\u4e86\u53d1\u6536\u53cc\u65b9\u7684\u5199/\u8bfb\u5b57\u8282\u8f6c\u6362\uff1a</p> sender htonsrecver ntohs <pre><code>short s = 0x7da; // EL: {0xda, 0x7}\nshort ns = htons(s); // EB: {0x7, 0xda}\nmemcpy(buf, &amp;ns, sizeof ns);\nsend(sock, buf, sizeof ns, 0);\n</code></pre> <pre><code>short ns;\nrecv(sock, buf, sizeof ns, 0); // EB: {0x7, 0xda}\nmemcpy(&amp;ns, buf, sizeof ns);\nshort s = ntohs(ns); // EL: {0xda, 0x7}\n</code></pre>","tags":["byte_order","endianess"]},{"location":"blog/20211007/byte-order-endianess/#__byte_order__","title":"__BYTE_ORDER__","text":"<p>\u5728 Dump Compiler Options \u4e2d\u6709\u4ecb\u7ecd\u5982\u4f55 dump compiler predefined macros\u3002</p> <p>clang/gcc \u6267\u884c <code>echo | cpp -dM</code> \u9884\u5904\u7406\uff0c\u6253\u5370\u51fa\u6765\u7684\u9884\u5b9a\u4e49\u5b8f\u4e2d\u5b57\u8282\u5e8f\u76f8\u5173\u7684\u5b8f\u5982\u4e0b\uff1a</p> mbpa2991/arm64rpi4b-ubuntu/aarch64 <pre><code>#define __BYTE_ORDER__ __ORDER_LITTLE_ENDIAN__\n#define __LITTLE_ENDIAN__ 1\n#define __ORDER_BIG_ENDIAN__ 4321\n#define __ORDER_LITTLE_ENDIAN__ 1234\n#define __ORDER_PDP_ENDIAN__ 3412\n</code></pre> <pre><code>#define __FLOAT_WORD_ORDER__ __ORDER_LITTLE_ENDIAN__\n#define __ORDER_PDP_ENDIAN__ 3412\n#define __ORDER_BIG_ENDIAN__ 4321\n#define __BYTE_ORDER__ __ORDER_LITTLE_ENDIAN__\n#define __ORDER_LITTLE_ENDIAN__ 1234\n</code></pre> <p>\u4ece <code>__BYTE_ORDER__</code> \u5b8f\u5b9a\u4e49\u6765\u770b\uff0c\u4e24\u79cd\u5e73\u53f0\u5747\u4e3a\u5c0f\u5c3e\u7aef\u5b57\u8282\u5e8f\uff08<code>__ORDER_LITTLE_ENDIAN__</code>\uff09\uff0cmacOS \u8fd8\u5b9a\u4e49\u4e86\u5b8f <code>__LITTLE_ENDIAN__</code> \u7684\u503c\u4e3a 1\u3002</p> <p>\u5728 macOS/ubuntu \u4e0b\uff0c\u53ef\u4ee5\u6267\u884c grep \u547d\u4ee4\uff0c\u5728 usr/include \u4e2d\u67e5\u627e\u54ea\u4e9b\u5934\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86\u8fd9\u4e9b\u5b8f\u3002</p> <pre><code># mbpa2991/arm64\n$ cd `xcrun --show-sdk-path`\n$ grep -REl \"#.*define.*(BYTE_ORDER|BIG_ENDIAN|LITTLE_ENDIAN|PDP_ENDIAN)\" usr/include 2&gt;/dev/null\n\n# rpi4b-ubuntu/aarch64\n$ grep -REl \"#.*define.*(BYTE_ORDER|BIG_ENDIAN|LITTLE_ENDIAN|PDP_ENDIAN)\" /usr/include 2&gt;/dev/null\n</code></pre> <p>\u5c06 grep \u547d\u4ee4\u7684\u9009\u9879 <code>l</code> \u6539\u4e3a <code>H</code> \u53ef\u5217\u51fa\u5177\u4f53\u5339\u914d\u7684\u884c\u548c\u5185\u5bb9\u3002</p>","tags":["byte_order","endianess"]},{"location":"blog/20211007/byte-order-endianess/#mbpa2991-macos","title":"mbpa2991-macOS","text":"<p>\u5728 mbpa2991-macOS/arm64 \u4e2d\uff0ci386 \u548c arm \u5747\u5b9a\u4e49\u4e86 BYTE_ORDER \u4e3a <code>__DARWIN_BYTE_ORDER</code>=<code>__DARWIN_LITTLE_ENDIAN</code>\u3002</p> grep -REH usr/include under macOS <pre><code>$ cd `xcrun --show-sdk-path`\n$ grep -REH \"#.*define.*(BYTE_ORDER|BIG_ENDIAN|LITTLE_ENDIAN|PDP_ENDIAN)\" usr/include 2&gt;/dev/null\n\nusr/include/i386/endian.h:#define __DARWIN_LITTLE_ENDIAN  1234    /* LSB first: i386, vax */\nusr/include/i386/endian.h:#define __DARWIN_BIG_ENDIAN     4321    /* MSB first: 68000, ibm, net */\nusr/include/i386/endian.h:#define __DARWIN_PDP_ENDIAN     3412    /* LSB first in word, MSW first in long */\nusr/include/i386/endian.h:#define __DARWIN_BYTE_ORDER     __DARWIN_LITTLE_ENDIAN\nusr/include/i386/endian.h:#define LITTLE_ENDIAN   __DARWIN_LITTLE_ENDIAN\nusr/include/i386/endian.h:#define BIG_ENDIAN      __DARWIN_BIG_ENDIAN\nusr/include/i386/endian.h:#define PDP_ENDIAN      __DARWIN_PDP_ENDIAN\nusr/include/i386/endian.h:#define BYTE_ORDER      __DARWIN_BYTE_ORDER\n\nusr/include/arm/endian.h:#define __DARWIN_LITTLE_ENDIAN  1234    /* LSB first: i386, vax */\nusr/include/arm/endian.h:#define __DARWIN_BIG_ENDIAN     4321    /* MSB first: 68000, ibm, net */\nusr/include/arm/endian.h:#define __DARWIN_PDP_ENDIAN     3412    /* LSB first in word, MSW first in long */\nusr/include/arm/endian.h:#define __DARWIN_BYTE_ORDER     __DARWIN_LITTLE_ENDIAN\nusr/include/arm/endian.h:#define LITTLE_ENDIAN   __DARWIN_LITTLE_ENDIAN\nusr/include/arm/endian.h:#define BIG_ENDIAN      __DARWIN_BIG_ENDIAN\nusr/include/arm/endian.h:#define PDP_ENDIAN      __DARWIN_PDP_ENDIAN\nusr/include/arm/endian.h:#define BYTE_ORDER      __DARWIN_BYTE_ORDER\n\nusr/include/libkern/OSByteOrder.h:#if defined(__LITTLE_ENDIAN__)\nusr/include/libkern/OSByteOrder.h:#elif defined(__BIG_ENDIAN__)\nusr/include/libkern/OSByteOrder.h:#if             defined(__BIG_ENDIAN__)\nusr/include/libkern/OSByteOrder.h:#elif           defined(__LITTLE_ENDIAN__)\n</code></pre> <ol> <li>usr/include/mach/ndr.h \u4e2d\u5b9a\u4e49\u4e86 <code>NDR_INT_BIG_ENDIAN</code>=<code>0\uff0cNDR_INT_LITTLE_ENDIAN</code>=1\u3002</li> <li>\u5728 usr/include/TargetConditionals.h \u4e2d\uff0cgcc based compiler used on Mac OS X \u57fa\u4e8e <code>__BYTE_ORDER__</code> \u7684\u503c\u5b9a\u4e49\u4e92\u65a5\u503c <code>TARGET_RT_LITTLE_ENDIAN</code> / <code>TARGET_RT_BIG_ENDIAN\u3002</code></li> <li>\u5728 usr/include/c++/v1/__config \u4e2d\uff0c<code>__BYTE_ORDER__</code> \u548c <code>__LITTLE_ENDIAN__</code>/<code>__BIG_ENDIAN__</code> \u5b8f\u5b9a\u4e49\u4e0e\u5426\u53ca\u5176\u503c\u6765\u5b9a\u4e49\u5b8f <code>_LIBCPP_LITTLE_ENDIAN</code>/<code>_LIBCPP_BIG_ENDIAN</code>\u3002</li> <li>\u5728 usr/include/c++/v1/__bit/endian.h \u4e2d\uff0c\u5bf9\u4e8e _LIBCPP_STD_VER &gt;= 20\uff08since c++20\uff09\uff0c\u5224\u65ad <code>_LIBCPP_LITTLE_ENDIAN</code>/<code>_LIBCPP_BIG_ENDIAN</code> \u5b9a\u4e49 <code>enum class endian</code>\u3002</li> </ol> <p>\u5728\u65e9\u671f\uff08before C99, c++11\uff09\u6ca1\u6709\u5b9a\u4e49 64bit long long\uff0c\u9700\u8981\u7528\u4e24\u4e2a int32 \u590d\u5408\u6210\u7ed3\u6784\u4f53\u6765\u6a21\u62df\u4e00\u4e2a int64 \u6574\u5f62\u6570\u636e\u3002\u4e24\u4e2a 32bit \u7684 WORD \u5728 struct \u4e2d\u7684\u987a\u5e8f\u9700\u8981\u8003\u8651\u5b57\u8282\u5e8f\uff08\u5224\u65ad\u5b8f TARGET_RT_BIG_ENDIAN\uff09\u3002</p> usr/include/MacTypes.h<pre><code>/* avoid redeclaration if libkern/OSTypes.h */\n#ifndef _OS_OSTYPES_H\n#if TARGET_RT_BIG_ENDIAN\nstruct wide {\n  SInt32              hi;\n  UInt32              lo;\n};\ntypedef struct wide                     wide;\nstruct UnsignedWide {\n  UInt32              hi;\n  UInt32              lo;\n};\ntypedef struct UnsignedWide             UnsignedWide;\n#else\nstruct wide {\n  UInt32              lo;\n  SInt32              hi;\n};\ntypedef struct wide                     wide;\nstruct UnsignedWide {\n  UInt32              lo;\n  UInt32              hi;\n};\ntypedef struct UnsignedWide             UnsignedWide;\n#endif  /* TARGET_RT_BIG_ENDIAN */\n\n#endif\n</code></pre>","tags":["byte_order","endianess"]},{"location":"blog/20211007/byte-order-endianess/#rpi4b-ubuntu","title":"rpi4b-ubuntu","text":"<p>\u5728 rpi4b-ubuntu/arm64 \u4e2d\uff0clittle_endian.h \u548c big_endian.h \u5404\u81ea\u5b9a\u4e49\u4e86\u5927\u5c0f\u7aef\u76f8\u5173\u7684\u5b8f\u53ca\u5bf9\u5e94 <code>BITFIELD</code>\u3002</p> grep -REH /usr/include under ubuntu <pre><code>$ grep -REH \"#.*define.*(BYTE_ORDER|BIG_ENDIAN|LITTLE_ENDIAN|PDP_ENDIAN)\" /usr/include 2&gt;/dev/null\n\n/usr/include/linux/byteorder/little_endian.h:#define __LITTLE_ENDIAN 1234\n/usr/include/linux/byteorder/little_endian.h:#define __LITTLE_ENDIAN_BITFIELD\n\n/usr/include/linux/byteorder/big_endian.h:#define __BIG_ENDIAN 4321\n/usr/include/linux/byteorder/big_endian.h:#define __BIG_ENDIAN_BITFIELD\n\n/usr/include/aarch64-linux-gnu/bits/endianness.h:# define __BYTE_ORDER __BIG_ENDIAN\n/usr/include/aarch64-linux-gnu/bits/endianness.h:# define __BYTE_ORDER __LITTLE_ENDIAN\n\n/usr/include/aarch64-linux-gnu/bits/endian.h:#define    __LITTLE_ENDIAN 1234\n/usr/include/aarch64-linux-gnu/bits/endian.h:#define    __BIG_ENDIAN    4321\n/usr/include/aarch64-linux-gnu/bits/endian.h:#define    __PDP_ENDIAN    3412\n/usr/include/aarch64-linux-gnu/bits/endian.h:# define __FLOAT_WORD_ORDER __BYTE_ORDER\n\n/usr/include/endian.h:# define LITTLE_ENDIAN    __LITTLE_ENDIAN\n/usr/include/endian.h:# define BIG_ENDIAN   __BIG_ENDIAN\n/usr/include/endian.h:# define PDP_ENDIAN   __PDP_ENDIAN\n/usr/include/endian.h:# define BYTE_ORDER   __BYTE_ORDER\n</code></pre> <p>\u6700\u5e95\u5c42 bits/endianness.h \u4e2d\u6839\u636e\u662f\u5426\u5b9a\u4e49\u4e86 <code>__AARCH64EB__</code> \u5b8f\uff0c\u6765\u8fdb\u4e00\u6b65\u5b9a\u4e49 <code>__BYTE_ORDER</code>\uff1a</p> /usr/include/aarch64-linux-gnu/bits/endianness.h<pre><code>#ifndef _BITS_ENDIAN_H\n# error \"Never use &lt;bits/endianness.h&gt; directly; include &lt;endian.h&gt; instead.\"\n#endif\n\n/* AArch64 has selectable endianness.  */\n#ifdef __AARCH64EB__\n# define __BYTE_ORDER __BIG_ENDIAN\n#else\n# define __BYTE_ORDER __LITTLE_ENDIAN\n#endif\n</code></pre> <p>bits/endian.h \u5305\u542b\u4e86 &lt;bits/endianness.h&gt;\uff0c\u5b9a\u4e49\u4e86 <code>__LITTLE_ENDIAN</code>\u3001<code>__BIG_ENDIAN</code>\u3001<code>__PDP_ENDIAN</code> \u548c <code>__FLOAT_WORD_ORDER</code>\uff1a</p> /usr/include/aarch64-linux-gnu/bits/endian.h<pre><code>#ifndef _BITS_ENDIAN_H\n#define _BITS_ENDIAN_H 1\n\n/* Definitions for byte order, according to significance of bytes,\n   from low addresses to high addresses.  The value is what you get by\n   putting '4' in the most significant byte, '3' in the second most\n   significant byte, '2' in the second least significant byte, and '1'\n   in the least significant byte, and then writing down one digit for\n   each byte, starting with the byte at the lowest address at the left,\n   and proceeding to the byte with the highest address at the right.  */\n\n#define __LITTLE_ENDIAN 1234\n#define __BIG_ENDIAN    4321\n#define __PDP_ENDIAN    3412\n\n/* This file defines `__BYTE_ORDER' for the particular machine.  */\n#include &lt;bits/endianness.h&gt;\n\n/* Some machines may need to use a different endianness for floating point\n   values.  */\n#ifndef __FLOAT_WORD_ORDER\n# define __FLOAT_WORD_ORDER __BYTE_ORDER\n#endif\n</code></pre> <p>/usr/include/endian.h \u5305\u542b\u4e86 &lt;bits/endian.h&gt;\uff0c\u5411\u4e0a\u5c42\u7528\u6237\u63d0\u4f9b\u5934\u6587\u4ef6\uff1a</p> /usr/include/endian.h<pre><code>/* Get the definitions of __*_ENDIAN, __BYTE_ORDER, and __FLOAT_WORD_ORDER.  */\n#include &lt;bits/endian.h&gt;\n\n#ifdef __USE_MISC\n# define LITTLE_ENDIAN  __LITTLE_ENDIAN\n# define BIG_ENDIAN __BIG_ENDIAN\n# define PDP_ENDIAN __PDP_ENDIAN\n# define BYTE_ORDER __BYTE_ORDER\n#endif\n</code></pre> <p>/usr/include/linux \u4e0b\u7684\u7f51\u7edc\u534f\u8bae\u5b9e\u73b0\u76f8\u5173\u5934\u6587\u4ef6 if_packet.h,tcp.h,ip.h,icmp.h,igmp.h,cdrom.h \u4e2d\u5224\u65ad\u662f\u5426\u5b9a\u4e49\u4e86 <code>__LITTLE_ENDIAN_BITFIELD</code> / <code>__BIG_ENDIAN_BITFIELD</code>\u3002\u5176\u4ed6\u5934\u6587\u4ef6\u4e2d\u4e3b\u8981\u5224\u65ad <code>__BYTE_ORDER</code> \u7684\u503c\u3002</p>","tags":["byte_order","endianess"]},{"location":"blog/20211007/byte-order-endianess/#test_endianess","title":"test endianess","text":"<p>\u6211\u4eec\u5728\u524d\u9762\u5229\u7528\u7f16\u8bd1\u5668\u9884\u5904\u7406\u8f93\u51fa\u4e86\u5b57\u8282\u5e8f\u76f8\u5173\u7684 predefined macros\uff0c\u7136\u540e\u901a\u8fc7 grep \u67e5\u627e usr/include \u4e0b\u76f8\u5173\u5b8f\u5b9a\u4e49\u6240\u5728\u7684\u5934\u6587\u4ef6\u3002</p> <ol> <li>macOS \u4e0a\u7684 i386/endian.h \u548c arm/endian.h \u4e0d\u540c\u67b6\u6784\u4e0b\u6e05\u6670\u5b9a\u4e49\u4e86 <code>BYTE_ORDER</code> \u4e3a\u5c0f\u5c3e\u7aef\uff0c\u6ca1\u627e\u5230 <code>__LITTLE_ENDIAN__</code> \u5b9a\u4e49\u5904\u3002</li> <li> <p>ubuntu \u6700\u5e95\u5c42 bits/endianness.h \u4e2d\u6839\u636e\u662f\u5426\u5b9a\u4e49\u4e86 <code>__AARCH64EB__</code> \u5b8f\uff0c\u6765\u8fdb\u4e00\u6b65\u5b9a\u4e49\u4e86 <code>__BYTE_ORDER</code>\u3002</p> <ul> <li>\u4ece dump \u51fa\u7684 predefined macros \u627e\u5230\u4e86 <code>#define __AARCH64EL__ 1</code>\uff0c\u6ca1\u6709\u5b9a\u4e49 <code>__AARCH64EB__</code>\uff0c\u5373\u5c0f\u5c3e\u7aef\u3002</li> </ul> </li> </ol> <p>Numerics library - Bit manipulation c++20 \u5f15\u5165\u4e86 std::endian \u2014\u2014 indicates the endianness of scalar types.</p> <p>c++20 std::endian</p> <p>\u53c2\u8003 20230510 ISO/IEC-N4950 \u4e2d 22.15.8 Endian\uff1a</p> <p>Two common methods of byte ordering in multibyte scalar types are big-endian and little-endian in the execution environment. Big-endian is a format for storage of binary data in which the most significant byte is placed first, with the rest in descending order. Little-endian is a format for storage of binary data in which the least significant byte is placed first, with the rest in ascending order. This subclause describes the endianness of the scalar types of the execution environment.</p> <pre><code>enum class endian {\n  little = see below,\n  big = see below,\n  native = see below\n};\n</code></pre> <p>If all scalar types have size 1 byte, then all of <code>endian::little</code>, <code>endian::big</code>, and <code>endian::native</code> have the same value. Otherwise, <code>endian::little</code> is not equal to <code>endian::big</code>. If all scalar types are big-endian, <code>endian::native</code> is equal to <code>endian::big</code>. If all scalar types are little-endian, <code>endian::native</code> is equal to <code>endian::little</code>. Otherwise, <code>endian::native</code> is not equal to either <code>endian::big</code> or <code>endian::little</code>.</p> <p>\u6700\u540e\uff0c\u6211\u4eec\u57fa\u4e8e union \u540c\u4e00\u5757\u5185\u5b58\u7684\u4e0d\u540c\u89e3\u6790\u6765\u6d4b\u8bd5\u7cfb\u7edf\u7684\u5b57\u8282\u5e8f\u3002</p> <ul> <li>isBigEndian: \u65e0\u7b26\u53f7\u77ed\u6574\u578b us \u5360\u7528 2 \u4e2a\u5b57\u8282\uff0c\u5b57\u8282\u6307\u9488 (unsigned char *)&amp;us \u6307\u5411\u7b2c1\u4e2a\u5b57\u8282\u3002\u5982\u679c\u662f\u5927\u7aef\u987a\u5e8f\u5b58\u653e\uff0c\u7b2c1\u4e2a\u5b57\u8282\u5b58\u653e\u9ad8\u4f4d 0x34\u3002</li> <li>isLittleEndian: \u8054\u5408\u7c7b\u578b c\uff0c\u6700\u957f\u5355\u5143\u4e3a\u77ed\u6574\u578b a\uff0c\u5360\u7528 2 \u4e2a\u5b57\u8282\u3002c.a\u3001c.b \u90fd\u6307\u5411\u6570\u636e\u7ed3\u6784\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u5373\u5185\u5b58\u4e2d\u7684\u7b2c 1 \u4e2a\u5b57\u8282\u3002c.a=0x0001\uff0c\u5f53\u5c0f\u7aef\u5b58\u653e\u65f6\uff0c\u7b2c 1 \u4e2a\u5b57\u8282\u5b58\u653e\u4f4e\u4f4d 0x01\uff0c\u5373 c.b=0x1\u3002</li> </ul> test-endianess.c<pre><code>#include &lt;stdio.h&gt;\n\ntypedef enum\n{\n    PDP_ENDIAN = 0x3412,    // __ORDER_PDP_ENDIAN__\n    BIG_ENDIAN = 0x4321,    // __ORDER_BIG_ENDIAN__\n    LITTLE_ENDIAN = 0x1234, // __ORDER_LITTLE_ENDIAN__\n} ByteOrder; // __BYTE_ORDER__\n\n// \u987a\u5e8f\u5b58\u50a8(MSB first)\nint isBigEndian()\n{\n    unsigned short us = PDP_ENDIAN;\n    return (*((unsigned char *)&amp;us) == 0x34);\n}\n\n// \u9ad8\u4f4d\u5b58\u50a8\u4f4e\u6743\u5b57\u8282\uff0c\u5219\u4e3a\u5c0f\u7aef(LSB first)\nByteOrder getByteOrder()\n{\n    static ByteOrder bo = PDP_ENDIAN;\n\n    if (bo == PDP_ENDIAN)\n    {\n        union u\n        {\n            short a; // 2 byte\n            char b;  // 1 byte\n        } c;\n        c.a = 1; // 0x0001\n        bo = (c.b ? LITTLE_ENDIAN : BIG_ENDIAN);\n    }\n\n    return bo;\n}\n\nint main(int argc, char **argv)\n{\n    // const char* endianess = isBigEndian() ? \"BIG_ENDIAN\" : \"LITTLE_ENDIAN\";\n    const char* endianess = getByteOrder() == BIG_ENDIAN ? \"BIG_ENDIAN\" : \"LITTLE_ENDIAN\";\n    printf(\"endianess = %s\\n\", endianess);\n\n    return 0;\n}\n</code></pre> <p>mbpa2991-macOS/arm64 \u548c rpi4b-ubuntu/aarch64 \u4e0b\u7f16\u8bd1\u8fd0\u884c\uff0c\u5747\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>cc test-endianess.c -o test-endianess -g &amp;&amp; ./test-endianess\nendianess = LITTLE_ENDIAN\n</code></pre>","tags":["byte_order","endianess"]},{"location":"blog/20211007/byte-order-endianess/#refs","title":"refs","text":"<p>\u5b57\u8282\u90a3\u4e9b\u4e8b\u513f ARM Endian\uff08\u5b57\u8282\u5e8f\uff09\u521d\u63a2</p> <p>\u8f7b\u677e\u8bb0\u4f4f\u5927\u5c0f\u7aef\u7684\u542b\u4e49 \u5927\u7aef\u6a21\u5f0f\u548c\u5c0f\u7aef\u6a21\u5f0f</p> <p>\u5927\u7aef\u4e0e\u5c0f\u7aef\u8be6\u89e3 \u8be6\u89e3\u5927\u7aef\u6a21\u5f0f\u548c\u5c0f\u7aef\u6a21\u5f0f</p> <p>IBM z/OS - Network byte order IBM z/VM - Network byte order and host byte order What Is The Endianness of Captured Packet Headers? - Ask Wireshark</p>","tags":["byte_order","endianess"]},{"location":"blog/20230314/calling-convention/","title":"Calling conventions","text":"<p>ABI - Calling convention</p> <p>In computer science, a calling convention is an implementation-level (low-level) scheme for how subroutines or functions receive parameters from their caller and how they return a result.</p> <p>When some code calls a function, design choices have been taken for where and how parameters are passed to that function, and where and how results are returned from that function, with these transfers typically done via certain registers or within a stack frame on the call stack.</p> <p>There are design choices for how the tasks of preparing for a function call and restoring the environment after the function has completed are divided between the <code>caller</code> and the <code>callee</code>. Some calling convention specifies the way every function should get called. The correct calling convention should be used for every function call, to allow the correct and reliable execution of the whole program using these functions.</p>","tags":["ABI","x86","arm"]},{"location":"blog/20230314/calling-convention/#x86","title":"x86","text":"<p>x86 calling conventions x86 Disassembly/Calling Conventions</p>","tags":["ABI","x86","arm"]},{"location":"blog/20230314/calling-convention/#docs","title":"docs","text":"<p>Application binary interfaces:</p> <ul> <li>Writing 64-bit Intel code for Apple Platforms</li> </ul> <p>OS X ABI Function Call Guide:</p> <ul> <li>IA-32 Function Calling Conventions</li> <li>x86-64 Function Calling Conventions</li> </ul> <p>Microsoft Learn:</p> <ul> <li>Calling Conventions</li> <li>Argument passing and naming conventions</li> </ul> <p>Configure C++ projects for 64-bit, x64 targets</p> <ul> <li>x64 ABI conventions</li> <li>x64 calling convention</li> </ul>","tags":["ABI","x86","arm"]},{"location":"blog/20230314/calling-convention/#refs","title":"refs","text":"<p>CS 61 - Assembly 2: Calling convention \u2013 2018 Guide to x86 Assembly - Calling Convention</p> <p>What are the calling conventions for UNIX &amp; Linux system calls on x86-64?</p> <p>System V Application Binary Interface Intel386 Architecture Processor Supplement - 4th Edition System V Application Binary Interface AMD64 Architecture Processor Supplement(With LP64 and ILP32 Programming Models) System V psABI for AMD64 - official repository</p> <p>Function calling conventions Guide: Function Calling Conventions C Function Call Conventions, UMBC CMSC 313, Spring 2002</p> <p>CS 4120/ENGRD 4120 Spring 2022 - Calling Conventions SYSC 3006 - Computer Organization - Subroutines</p>","tags":["ABI","x86","arm"]},{"location":"blog/20230314/calling-convention/#arm","title":"arm","text":"<p><code>ATPCS</code>: ARM-Thumb Procedure Call Standard <code>AAPCS</code>: Arm Architecture Procedure Call Standard</p>","tags":["ABI","x86","arm"]},{"location":"blog/20230314/calling-convention/#docs_1","title":"docs","text":"<p>ABI - Application Binary Interface</p> <ol> <li> <p>Software Standards</p> </li> <li> <p>Specifications @github</p> <ul> <li>ABI for the Arm 32-bit Architecture</li> <li>ABI for the Arm 64-bit Architecture</li> </ul> </li> <li> <p>About the ARM-Thumb Procedure Call Standard</p> <ul> <li>Register roles and names</li> <li>The stack</li> <li>Parameter passing</li> </ul> </li> </ol> <p>Application binary interfaces | Apple Developer Documentation:</p> <ul> <li>Writing ARMv7 code for iOS</li> <li>Writing ARM64 code for Apple platforms</li> </ul> <p>Configure C++ projects for ARM processors | Microsoft Learn:</p> <ul> <li>Overview of ARM ABI Conventions</li> <li>Overview of ARM64 ABI conventions</li> <li>Overview of ARM64EC ABI conventions</li> </ul>","tags":["ABI","x86","arm"]},{"location":"blog/20230314/calling-convention/#refs_1","title":"refs","text":"<p>Stacks on ARM processors.doc Armv8-M Exception Model User Guide - Stack frames</p> <p>System V ABI for the Arm\u00ae 64-bit Architecture (AArch64)</p> <p>Subroutines and Parameter passing.ppt iOS Assembly Tutorial: Understanding ARM</p> <p>ARM \u8fc7\u7a0b\u8c03\u7528\u6807\u51c6 AAPCS \u4ee5\u53ca\u5806\u6808\u4f7f\u7528 arm64\u7a0b\u5e8f\u8c03\u7528\u89c4\u5219</p> <p>Understanding Procedure Call Standard for Arm Architecture \u2014 Part 1 \u5806\u548c\u6808\u8c03\u7528\u60ef\u4f8b - \u4ee5ARMv8\u4e3a\u4f8b</p> <p>ARM\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684\u51fd\u6570\u8c03\u7528\u8fc7\u7a0b\u6808\u7684\u53d8\u5316\u8be6\u89e3 \u5b89\u5353\u9006\u5411: \u8fd9\u662f\u4e00\u7bc7\u9006\u5411\u57fa\u7840\u51fd\u6570\u5728ARM32\u4e2d\u7684\u5228\u6839\u95ee\u5e95</p>","tags":["ABI","x86","arm"]},{"location":"blog/20230314/calling-convention/#refs_2","title":"refs","text":"<p>\u5e38\u89c1\u51fd\u6570\u8c03\u7528\u7ea6\u5b9a(x86\u3001x64\u3001arm\u3001arm64)</p>","tags":["ABI","x86","arm"]},{"location":"blog/20230312/cpu-arch/","title":"CPU Architectures","text":"<p>Architecture = Microarchitecture + ISA(Instruction set architecture).</p> <p>\u67095\u79cd\u6307\u4ee4\u96c6\u6700\u4e3a\u5e38\u89c1\uff0c\u5b83\u4eec\u6784\u6210\u4e86\u5904\u7406\u5668\u9886\u57df\u76845\u6735\u91d1\u82b1\u3002</p> <ol> <li>x86\u2014\u2014\u7855\u5927\u7684\u5927\u8c61</li> <li>ARM\u2014\u2014\u7a33\u624e\u7a33\u6253\u7684\u8681\u7fa4</li> <li>MIPS\u2014\u2014\u4f18\u96c5\u7684\u5b54\u96c0</li> <li>Power\u2014\u2014\u6614\u65e5\u7684\u8d35\u65cf</li> <li>C6000\u2014\u2014\u504f\u5b89\u4e00\u9685\u7684\u72ec\u7acb\u738b\u56fd</li> </ol> <p>This article is about the collection of datasheet/textbooks/references on the three major mainstream CPUs.</p>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#intel","title":"Intel","text":"<p>Intel Architecture</p> <p>IA-32 / x86 IA-64 / x86-64 </p>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#datasheet","title":"datasheet","text":"<p>Intel\u00ae 64 and IA-32 Architectures Software Developer Manuals</p> <p>Intel\u00ae 64 and IA-32 Architectures Software Developer\u2019s Manual Combined Volumes: 1, 2A, 2B, 2C, 2D, 3A, 3B, 3C, 3D, and 4</p> <p>IA-64 Application Developer\u2019s Architecture Guide</p>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#textbooks","title":"textbooks","text":"<ol> <li>\u300aC\u8bed\u8a00\u6807\u51c6\u4e0e\u5b9e\u73b0\u300b\uff0c\u59da\u65b0\u989c\uff0c2004 - #1 \u57fa\u7840\u77e5\u8bc6</li> <li>\u300a\u6df1\u5165\u7406\u89e3\u8ba1\u7b97\u673a\u7cfb\u7edf\u300b\uff0cRandal E. Bryant &amp; David R. O'Hallaron, 2015, 3e - \u7b2c3\u7ae0 \u7a0b\u5e8f\u7684\u673a\u5668\u7ea7\u8868\u793a</li> <li>\u300a\u8001\u7801\u8bc6\u9014-\u4ece\u673a\u5668\u7801\u5230\u6846\u67b6\u7684\u7cfb\u7edf\u89c2\u9006\u5411\u4fee\u70bc\u4e4b\u8def\u300b\uff0c\u97e9\u5b8f\uff0c2012 - \u7b2c1\u7ae0 \u6b32\u5411\u7801\u9014\u95ee\u5927\u9053\uff0c\u9535\u9535bit\u662f\u543e\u5200</li> </ol> <p>x86 \u6c47\u7f16\u8bed\u8a00\uff1a</p> <ol> <li>\u300a\u6c47\u7f16\u8bed\u8a00\u300b\uff0c\u738b\u723d\uff0c2019\uff0c4e</li> <li>Professional Assembly Language(IA32), Richard Blum, 2005</li> <li>Assembly Language For X86 Processors, KIP R. IRVINE, 2014, 7e</li> <li>Introduction to 64 Bit Assembly Programming for Linux and OS X, Ray Seyfarth, 2014, 3e</li> <li>Low-Level Programming: C, Assembly, and Program Execution on Intel\u00ae 64 Architecture, Igor Zhirkov, 2017</li> <li>Windows 64-bit Assembly Language Programming Quick Start: Intel X86-64, SSE, AVX, Robert Dunne, 2018</li> <li>Modern X86 Assembly Language Programming: Covers X86 64-bit, AVX, AVX2, and AVX-512, Daniel Kusswurm, 2023, 3e</li> </ol>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#references","title":"references","text":"<p>Guide to x86 Assembly</p>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#arm","title":"ARM","text":"<p>Acorn RISC Machine(1978) -&gt; Advanced RISC Machine(1990). Arm defines three architecture profiles: Application (A), Real-time (R), and Microcontroller (M).</p> <p>ARM architecture family- Cores</p> <ul> <li>List of ARM processors</li> </ul>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#docs","title":"docs","text":"<p>Documentation \u2013 Arm Developer</p> <p>Arm CPU Architecture \u2013 Arm\u00ae</p> <ul> <li>A-Profile Architecture</li> <li>R-Profile Architecture</li> <li>M-Profile Architecture</li> </ul> <p>Learn the architecture</p> <ul> <li>Arm A-profile Architecture Registers</li> <li> <p>Arm A-profile A64 Instruction Set Architecture - Base Instructions</p> </li> <li> <p>ARMv7-M Architecture Reference Manual.pdf</p> </li> <li>M-Profile/Armv8-M</li> </ul> <p>Getting Started with Arm Assembly Language</p>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#textbooks_1","title":"textbooks","text":"<ol> <li>Modern Assembly Language Programming with the ARM Processor, Larry D Pyeatt, 2016</li> <li>ARM 64-Bit Assembly Language, Larry D Pyeatt &amp; William Ughetta, 2019</li> <li>Raspberry Pi Assembly Language Programming: ARM Processor Coding, Stephen Smith, 2019</li> <li>Programming with 64-Bit ARM Assembly Language: Single Board Computer Development for Raspberry Pi and Mobile Devices, Stephen Smith, 2020</li> <li>Modern Arm Assembly Language Programming: Covers Armv8-A 32-bit, 64-bit, and SIMD, Daniel Kusswurm, 2020</li> <li>Computer Organization and Design ARM Edition: The Hardware Software Interface, David A. Patterson, John L. Hennessy, 2016 @ustc</li> </ol>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#references_1","title":"references","text":"<p>RISC-V vs ARM: A Comprehensive Comparison of Processor Architectures A Comparative Study on the Performance of 64-bit ARM Processors</p> <p>The Old New Thing:</p> <ul> <li>The ARM processor (Thumb-2), part 1: Introduction</li> <li>The AArch64 processor (aka arm64), part 1: Introduction</li> </ul> <p>EECS 373: Design of Microprocessor-Based Systems - ARM_Architecture_Overview.ppt</p> <p>ARM Assembly By Example ARM Assembly | Azeria Labs</p> <p>GNU-ARM-Assy-Quick-Ref.doc ARM\u00ae Instruction Set Quick Reference Card</p> <p>GNU-Syntax Arm Assembly Language Reference Guide \u2014 TI Arm Clang Compiler Tools User's Guide</p>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#mips","title":"MIPS","text":"<p>Microprocessor without Interlocked Pipeline Stages</p> <p>MIPS MIPS architecture processors</p> <p>\u5b98\u7f51\uff1aMIPS Processor, RISC-V, Innovate Compute</p>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#datasheet_1","title":"datasheet","text":"<p>amazonaws.com:</p> <ul> <li>MIPS\u00ae Architecture For Programmers Volume I-A: Introduction to the MIPS32\u00ae Architecture - 2016</li> <li> <p>MIPS\u00ae Architecture for Programmers Volume II-A: The MIPS32\u00ae Instruction Set Manual - 2016</p> </li> <li> <p>MIPS\u00ae Architecture For Programmers Volume I-A: Introduction to the MIPS64\u00ae Architecture - 2014</p> </li> <li>MIPS\u00ae Architecture For Programmers Volume II-A: The MIPS32\u00ae Instruction Set - 2013</li> </ul> <p>ustc.edu:</p> <ul> <li>MIPS64\u00ae Architecture For Programmers Volume I: Introduction to the MIPS64\u00ae Architecture - 2005</li> <li>MIPS64\u00ae Architecture For Programmers Volume II: The MIPS64\u00ae Instruction Set - 2005</li> <li>MIPS64\u00ae Architecture For Programmers Volume III: The MIPS64\u00ae Privileged Resource Architecture - 2005</li> </ul>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#textbooks_2","title":"textbooks","text":"<ol> <li>See MIPS Run, Dominic Sweetman, 2006, 2e</li> <li>Computer Organization and Design RISC-V Edition: The Hardware Software Interface, David A. Patterson &amp; John L. Hennessy, 2017 @ustc</li> </ol>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#references_2","title":"references","text":"<p>assembly - where can I find a description of all MIPS instructions</p> <p>stanford - MIPS MIPS architecture overview Introduction to the MIPS Processor Introduction to the MIPS Architecture and Assembly, 2021</p> <p>MIPS Assembly Language Programming, 2002 Programmed Introduction to MIPS Assembly Language, 2015 COE 301 Lab - Computer Organization - Introduction_MIPS_Assembly MIPS Assembly Language (CS 241 Dialect), 2022</p> <p>Harvard CS 161:</p> <ul> <li>Overview of the MIPS Architecture: Part I</li> <li>Overview of the MIPS Architecture: Part II</li> </ul> <p>nju-swang: Lecture 24: Instruction Pipeline(\u6307\u4ee4\u6d41\u6c34\u7ebf)</p> <p>The Old New Thing: The MIPS R4000, part 1: Introduction</p> <p>SYSTEM V APPLICATION BINARY INTERFACE MIPS RISC Processor Supplement - 3rd Edition</p>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20230312/cpu-arch/#refs","title":"refs","text":"<p>Computer Architecture Lecture 3: ISA Tradeoffs</p> <p>RISC-V Architecture: A Comprehensive Guide to the Open-Source ISA</p> <p>\u300aARM \u4e0e x86\u300b - \u4f5c\u8005\uff1a\u738b\u9f50 \u300a\u5927\u8bdd\u5904\u7406\u5668\u300b - \u4e07\u6728\u6768 \u8457</p> <p>CPU\u4f53\u7cfb\u67b6\u6784-ARM/MIPS/X86</p>","tags":["x86","arm","mips","datasheet"]},{"location":"blog/20211008/data-model/","title":"Data Models","text":"<p>In 32-bit programs, pointers and data types such as integers generally have the same length. This is not necessarily true on 64-bit machines. Mixing data types in programming languages such as C and its descendants such as C++ and Objective-C may thus work on 32-bit implementations but not on 64-bit implementations.</p>","tags":["ILP32","LLP64","LP64"]},{"location":"blog/20211008/data-model/#preamble","title":"Preamble","text":"<p>\u5bf9\u4e8e GCC/Clang \u9884\u5904\u7406\u5668\u5b9a\u4e49\u7684\u4e00\u4e9b\u5b8f\uff0c\u53ef\u6267\u884c <code>cpp -dM</code> /<code>gcc -E -dM</code> \u9884\u5904\u7406\u547d\u4ee4 dump Macros\uff1a</p> <ul> <li>GCC Internals - Layout of Source Language Data Types</li> <li>GNU C Preprocessor - Common Predefined Macros</li> <li>Clang Preprocessor options - Dumping preprocessor state</li> </ul> dump prededined macros<pre><code>$ echo | cpp -dM\n$ echo | gcc -x c -E -dM -\n$ echo | g++ -x c++ -E -dM -\n\n# IA32/IA64\n$ llvm-gcc -x c -E -dM -arch i386 /dev/null\n$ llvm-gcc -x c -E -dM -arch x86_64 /dev/null\n\n# ARM32/ARM64\n$ llvm-gcc -x c -E -dM -arch armv7s /dev/null\n$ llvm-gcc -x c -E -dM -arch arm64 /dev/null\n</code></pre> <p>\u5728 IA32/ARM32 \u4f4d\u5e73\u53f0\u4e0a\uff0c\u901a\u5e38\u4f1a\u5b9a\u4e49\u5b8f <code>_ILP32</code> \u6216 <code>__ILP32__</code> \u503c\u4e3a 1\uff1b \u5728 IA64/ARM64 \u4f4d\u5e73\u53f0\u4e0a\uff0c\u901a\u5e38\u4f1a\u5b9a\u4e49\u5b8f <code>_LP64</code> \u6216 <code>__LP64__</code> \u503c\u4e3a 1\u3002</p> <p><code>ILP32</code> \u548c <code>LP64</code> \u662f\u4e24\u7ec4\u4e0d\u540c\u7684\u6570\u636e\u6a21\u578b\uff08Data Model\uff09\uff0c\u51b3\u5b9a\u4e86\u5e73\u53f0\u662f 32 \u4f4d\u8fd8\u662f 64 \u4f4d\uff0c\u8fdb\u800c\u5f71\u54cd long\u3001long long \u548c pointer \u7684\u5bbd\u5ea6\uff1a</p> <ul> <li><code>__SIZEOF_LONG__</code> @intel</li> <li><code>__SIZEOF_POINTER__</code> / <code>__POINTER_WIDTH__</code></li> </ul> <p>GCC Internals | Effective-Target Keywords | Data type sizes</p> <ul> <li><code>ilp32</code>: Target has 32-bit int, long, and pointers.</li> <li><code>lp64</code>: Target has 32-bit int, 64-bit long and pointers.</li> <li><code>llp64</code>: Target has 32-bit int and long, 64-bit long long and pointers.</li> </ul> <p>aapcs64 - 2.2 Terms and abbreviations:</p> <ul> <li><code>ILP32</code>: SysV-like data model where int, long int and pointer are 32-bit.</li> <li><code>LP64</code>: SysV-like data model where int is 32-bit, but long int and pointer are 64-bit.</li> <li><code>LLP64</code>: Windows-like data model where int and long int are 32-bit, but long long int and pointer are 64-bit.</li> </ul>","tags":["ILP32","LLP64","LP64"]},{"location":"blog/20211008/data-model/#concept","title":"Concept","text":"<p>64-bit data models</p> <p>In many programming environments for C and C-derived languages on 64-bit machines, <code>int</code> variables are still 32 bits wide, but <code>long</code> integers and <code>pointers</code> are 64 bits wide. These are described as having an LP64 data model, which is an abbreviation of \"Long, Pointer, 64\". Other models are the ILP64 data model in which all three data types are 64 bits wide, and even the SILP64 model where short integers are also 64 bits wide. However, in most cases the modifications required are relatively minor and straightforward, and many well-written programs can simply be recompiled for the new environment with no changes. Another alternative is the LLP64 model, which maintains compatibility with 32-bit code by leaving both <code>int</code> and <code>long</code> as 32-bit. <code>LL</code> refers to the <code>long long</code> integer type, which is at least 64 bits on all platforms, including 32-bit environments.</p> <p>There are also systems with 64-bit processors using an ILP32 data model, with the addition of 64-bit <code>long long</code> integers; this is also used on many platforms with 32-bit processors. This model reduces code size and the size of data structures containing pointers, at the cost of a much smaller address space, a good choice for some embedded systems.</p> <p>Fundamental types - Data Models:</p> <p>The choices made by each implementation about the sizes of the fundamental types are collectively known as data model. Four data models found wide acceptance:</p> <p>data model of 32 bit systems</p> <p><code>LP32</code> or 2/4/4 (int is 16-bit, long and pointer are 32-bit)</p> <ul> <li>Win16 API</li> </ul> <p><code>ILP32</code> or 4/4/4 (int, long, and pointer are 32-bit);</p> <ul> <li>Win32 API</li> <li>Unix and Unix-like systems (Linux, macOS)</li> </ul> <p>data model of 64 bit systems</p> <p><code>LLP64</code> or 4/4/8 (int and long are 32-bit, pointer is 64-bit)</p> <ul> <li>Win32 API (also called the Windows API) with compilation target 64-bit ARM (AArch64) or x86-64 (a.k.a. x64)</li> </ul> <p><code>LP64</code> or 4/8/8 (int is 32-bit, long and pointer are 64-bit)</p> <ul> <li>Unix and Unix-like systems (Linux, macOS)</li> </ul> <p>refer to the table corresponding to the width in bits by data model.</p>","tags":["ILP32","LLP64","LP64"]},{"location":"blog/20211008/data-model/#convention","title":"Convention","text":"<p>ARM/Keil : Basic data types in ARM C and C++</p> <ul> <li>Size and alignment of basic data types</li> </ul> <p>AIX - Data models for 32-bit and 64-bit processes z/OS - LP64 | ILP32, ILP32 and LP64 data models and data type sizes</p> <ul> <li><code>ILP32</code>, acronym for integer, long, and pointer 32</li> <li><code>LP64</code>, acronym for long, and pointer 64</li> </ul> <p>ILP32 and LP64 data models.PDF - HP-UX 64-bit data model</p> <ul> <li>hp C/HP-UX 32-bit and 64-bit base data types</li> <li>ILP32 and LP64 data alignment</li> </ul> <p>Writing 64-bit Intel code for Apple Platforms</p> <p>Apple platforms typically follow the data representation and procedure call rules in the standard System V psABI for AMD64, using the LP64 programming model.</p> <p>Programming Guide for 64-bit Windows Getting Ready for 64-bit Windows</p> <ul> <li>Abstract Data Models</li> <li>The New Data Types</li> </ul> <p>In the 32-bit programming model (known as the ILP32 model), integer, long, and pointer data types are 32 bits in length. In the LLP64 data model, only pointers expand to 64 bits; all other basic data types (integer and long) remain 32 bits in length.</p> <p>GCC IA-64 Options</p> <pre><code>-milp32 / -mlp64\nGenerate code for a 32-bit or 64-bit environment. The 32-bit environment sets int, long and pointer to 32 bits. The 64-bit environment sets int to 32 bits and long and pointer to 64 bits. These are HP-UX specific flags.\n</code></pre> <p>\u6570\u636e\u6a21\u578b\uff0c\u8cc7\u6599\u6a21\u578b\uff0c64-bit data models</p> TYPE LP32 ILP32 LP64 ILP64 LLP64 CHAR 8 8 8 8 8 SHORT 16 16 16 16 16 INT 16 32 32 64 32 LONG 32 32 64 64 32 LONG LONG 64 64 64 64 64 POINTER 32 32 64 64 64 <ul> <li><code>LP32</code>: sizeof(long)=sizeof(pointer)=32</li> <li> <p><code>ILP32</code>: sizeof(int)=sizeof(long)=sizeof(pointer)=32</p> </li> <li> <p><code>LP64</code>: sizeof(long)=sizeof(pointer)=64</p> </li> <li><code>LLP64</code>: sizeof(long long)=sizeof(pointer)=64</li> <li> <p><code>ILP64</code>: sizeof(int)=sizeof(long)=sizeof(pointer)=64</p> <ul> <li><code>ILP64</code> model is very rare, only appeared in some early 64-bit Unix systems (e.g. UNICOS on Cray).</li> </ul> </li> </ul> <p>aapcs64 - 7 The standard variants:</p> <p>10.1.2 Types varying by data model:</p> C/C++ Type ILP32 (Beta) LP64 LLP64 [signed] long signed word signed double-word signed word unsigned long unsigned word unsigned double-word unsigned word wchar_t unsigned word unsigned word unsigned halfword T * 32-bit data pointer 64-bit data pointer 64-bit data pointer <p>10.1.4 Additional types:</p> Typedef ILP32 (Beta) LP64 LLP64 size_t unsigned long unsigned long unsigned long long ptrdiff_t signed long signed long signed long long <p>\u5728 LP \u6570\u636e\u6a21\u578b\u4e0b\uff1a</p> <ul> <li><code>__SIZEOF_POINTER__</code> = <code>__SIZEOF_LONG__</code></li> <li><code>__POINTER_WIDTH__</code> = <code>LONG_BIT</code> = <code>__WORDSIZE</code></li> </ul> <p>\u5173\u4e8e\u673a\u5668\u5b57\u957f\u76f8\u5173\u7684\u5b8f <code>LONG_BIT</code> \u548c <code>__WORDSIZE</code>\uff0c\u53c2\u8003 \u300aMachine Word\u300b\u3002</p>","tags":["ILP32","LLP64","LP64"]},{"location":"blog/20211008/data-model/#evolution","title":"Evolution","text":"<p>The Evolution of Computing: From 8-bit to 64-bit The Evolution of CPUs: Exploring the Dominance of 32-bit and 64-bit Architectures The 64-bit Evolution \u2013 Computerworld</p> <p>The Long Road to 64 Bits - PDF - TABLE 1 Common C Data Types</p> <p>Data Models and Word Size</p> <p>64-bit and Data Size Neutrality</p> <p>opengroup - 64-Bit Programming Models: Why LP64?.PDF - 1997</p> <p>Major 64-Bit Changes - Apple Developer - 20121213</p> <p>Why did the Win64 team choose the LLP64 model? What is the bit size of long on 64-bit Windows?</p> <p>All modern 64-bit Unix systems use LP64. MacOS X and Linux are both modern 64-bit systems. Microsoft uses a different scheme for transitioning to 64-bit: LLP64 ('long long, pointers are 64-bit').  This has the merit of meaning that 32-bit software can be recompiled without change.  </p> <p>The Tools - 64-bit Compiler Switches and Warnings</p> <p>Wireshark Development/Win64 </p> <p>32-bit UNX platforms, and 32-bit Windows, use the ILP32 data model. 64-bit UNX platform use the LP64 data model; however, 64-bit Windows uses the LLP64 data model.  </p>","tags":["ILP32","LLP64","LP64"]},{"location":"blog/20091002/data-type/","title":"Data Type","text":"<p>The type defines the operations(access or manipulate) that can be done on the data, the meaning of the data, and the way values of that type can be stored.</p> <p>In\u00a0computer science\u00a0and\u00a0computer programming, a\u00a0data type\u00a0(or simply\u00a0type) is a collection or grouping of data values, usually specified by a set of possible values, a set of allowed operations on these values, and/or a representation of these values as machine types.</p> <p>A data type specification in a program constrains the possible values that an\u00a0expression, such as a variable or a function call, might take. On literal data, it tells the\u00a0compiler\u00a0or\u00a0interpreter\u00a0how the programmer intends to use the data. Most programming languages support basic data types of\u00a0integer\u00a0numbers (of varying sizes),\u00a0floating-point\u00a0numbers (which approximate\u00a0real numbers),\u00a0characters\u00a0and\u00a0Booleans.</p>","tags":["data_type"]},{"location":"blog/20091002/data-type/#concept","title":"concept","text":"<p>A data type may be specified for many reasons: similarity, convenience, or to focus the attention. It is frequently a matter of good organization that aids the understanding of complex definitions. Almost all programming languages explicitly include the notion of data type, though the possible data types are often restricted by considerations of simplicity, computability, or regularity. An explicit data type declaration typically allows the compiler to choose an efficient machine representation, but the conceptual organization offered by data types should not be discounted.</p> <p>Data types are used within\u00a0type systems, which offer various ways of defining, implementing, and using them. In a type system, a data type represents a constraint placed upon the interpretation of data, describing representation, interpretation and structure of\u00a0values\u00a0or\u00a0objects\u00a0stored in computer memory. The type system uses data type information to check\u00a0correctness of computer programs\u00a0that access or manipulate the data. A\u00a0compiler\u00a0may use the static type of a value to optimize the storage it needs and the choice of algorithms for operations on the value.\u00a0</p> <p>Most programming languages also allow the programmer to define additional data types, usually by combining multiple elements of other types and defining the valid operations of the new data type. For example, a programmer might create a new data type named \"complex number\" that would include real and imaginary parts, or a color data type represented by three bytes denoting the amounts each of red, green, and blue, and a string representing the color's name.</p>","tags":["data_type"]},{"location":"blog/20091002/data-type/#machine_data_types","title":"Machine data types","text":"<p>All data in computers based on digital electronics is represented as <code>bits</code> (alternatives 0 and 1) on the lowest level. The smallest addressable unit of data is usually a group of bits called a byte (usually an octet, which is 8 bits). The unit processed by machine code instructions is called a <code>word</code> (as of 2011, typically 32 or 64 bits).</p> <p>Machine data types expose or make available fine-grained control over hardware, but this can also expose implementation details that make code less portable. Hence machine types are mainly used in systems programming or low-level programming languages. In higher-level languages most data types are abstracted in that they do not have a language-defined machine representation. The C programming language, for instance, supplies types such as Booleans, integers, floating-point numbers, etc., but the precise bit representations of these types are implementation-defined. The only C type with a precise machine representation is the <code>char</code> type that represents a byte.</p>","tags":["data_type"]},{"location":"blog/20091002/data-type/#classification","title":"Classification","text":"<p>Data types may be categorized according to several factors:</p> <ul> <li>Primitive data types or built-in data types are types that are built-in to a language implementation. User-defined data types are non-primitive types. For example, Java's numeric types are primitive, while classes are user-defined.</li> <li>A value of an atomic type is a single data item that cannot be broken into component parts. A value of a composite type or aggregate type is a collection of data items that can be accessed individually. For example, an integer is generally considered atomic, although it consists of a sequence of bits, while an array of integers is certainly composite.</li> <li>Basic data types or fundamental data types are defined axiomatically from fundamental notions or by enumeration of their elements. Generated data types or derived data types are specified, and partly defined, in terms of other data types. All basic types are atomic. For example, integers are a basic type defined in mathematics, while an array of integers is the result of applying an array type generator to the integer type.</li> </ul>","tags":["data_type"]},{"location":"blog/20091002/data-type/#primitive_data_type","title":"Primitive data type","text":"<p>Primitive data types</p> <p>In computer science, <code>primitive data types</code> are a set of basic data types from which all other data types are constructed. Specifically it often refers to the limited set of data representations in use by a particular processor, which all compiled programs must use. Most processors support a similar set of primitive data types, although the specific representations vary. More generally, \"primitive data types\" may refer to the standard data types built into a programming language (<code>built-in types</code>). Data types which are not primitive are referred to as derived or composite.</p> <p>Primitive types are almost always value types, but composite types may also be value types.</p>","tags":["data_type"]},{"location":"blog/20091002/data-type/#composite_data_type","title":"Composite data type","text":"<p>composite type</p> <p>In computer science, a <code>composite</code> data type or <code>compound</code> data type is any data type which can be constructed in a program using the programming language's primitive data types and other composite types. It is sometimes called a <code>structure</code> or <code>aggregate</code> type, although the latter term may also refer to arrays, lists, etc. The act of constructing a composite type is known as composition. Composite data types are often contrasted with scalar variables.</p>","tags":["data_type"]},{"location":"blog/20211010/machine-word/","title":"Machine Word","text":"<p>In computing, a word is the natural unit of data used by a particular processor design. The term <code>word</code> refers to the standard number of bits that are manipulated as a unit by any particular CPU.</p> <p>The <code>word size</code> is the computer's preferred size for moving units of information around; technically it's the width of your processor's registers. It reflects the amount of data that can be transmitted between memory and the processor in one chunk. Likewise, it may reflect the size of data that can be manipulated by the CPU's ALU in one cycle.</p>","tags":["LONG_BIT","WORDSIZE"]},{"location":"blog/20211010/machine-word/#machine_word","title":"machine word","text":"<p>Word (computer architecture)</p> <p>In computing, a <code>word</code> is the natural unit of data used by a particular processor design. A word is a fixed-sized datum handled as a unit by the instruction set or the hardware of the processor. The number of bits or digits in a word (the word size, word width, or word length) is an important characteristic of any specific processor design or computer architecture.</p> <p>The size of a word is reflected in many aspects of a computer's structure and operation; the majority of the registers in a processor are usually word-sized and the largest datum that can be transferred to and from the working memory in a single operation is a word in many (not all) architectures. The largest possible address size, used to designate a location in memory, is typically a hardware word (here, \"hardware word\" means the full-sized natural word of the processor, as opposed to any other definition used).</p> <p>How does my computer store things in memory?</p> <p>The <code>word size</code> is the computer's preferred size for moving units of information around; technically it's the width of your processor's registers, which are the holding areas your processor uses to do arithmetic and logical calculations. When people write about computers having bit sizes (calling them, say, \"32-bit\" or \"64-bit\" computers), this is what they mean.</p> <p>The computer views your memory as a sequence of words numbered from zero up to some large value dependent on your memory size. That value is limited by your word size, which is why programs on older machines like 286s had to go through painful contortions to address large amounts of memory.</p> <p>Bits, Bytes, and Words</p> <p>The term <code>word</code> refers to the standard number of bits that are manipulated as a unit by any particular CPU. For decades most CPUs had a word size of 32 bits (or 4 contiguous bytes), but word sizes of 64 bits are becoming more and more commonplace. The signifcance of the word size of a particular computer system is that it reflects the amount of data that can be transmitted between memory and the processor in one chunk. Likewise, it may reflect the size of data that can be manipulated by the CPU's ALU in one cycle. Computers can process data of larger sizes, but the word size reflects the size of the data values the computer has been designed to readily process directly. All other things being equal, (and they never are), larger word size implies faster and more capable processing.</p>","tags":["LONG_BIT","WORDSIZE"]},{"location":"blog/20211010/machine-word/#predefined_macros","title":"predefined macros","text":"<p>GCC Internals - Layout of Source Language Data Types GNU C Preprocessor - Common Predefined Macros</p> <p>Clang Preprocessor options - Dumping preprocessor state</p> <p>\u5bf9\u4e8e GCC/Clang \u9884\u5904\u7406\u5668\u5b9a\u4e49\u7684\u4e00\u4e9b\u5b8f\uff0c\u53ef\u6267\u884c <code>cpp -dM</code> /<code>gcc -E -dM</code> \u9884\u5904\u7406\u547d\u4ee4 dump Macros\uff1a</p> dump prededined macros<pre><code>$ echo | cpp -dM\n$ echo | gcc -x c -E -dM -\n$ echo | g++ -x c++ -E -dM -\n\n# IA32/IA64\n$ clang -x c -E -dM -arch i386 /dev/null\n$ clang -x c -E -dM -arch x86_64 /dev/null\n\n# ARM32/ARM64\n$ clang -x c -E -dM -arch armv7s /dev/null\n$ clang -x c -E -dM -arch arm64 /dev/null\n</code></pre>","tags":["LONG_BIT","WORDSIZE"]},{"location":"blog/20211010/machine-word/#__sizeof_pointer__","title":"__SIZEOF_POINTER__","text":"<p>\u5728 IA32/ARM32 \u4f4d\u5e73\u53f0\u4e0a\uff0c\u901a\u5e38\u4f1a\u5b9a\u4e49\u5b8f <code>_ILP32</code> \u6216 <code>__ILP32__</code> \u503c\u4e3a 1\uff1b \u5728 IA64/ARM64 \u4f4d\u5e73\u53f0\u4e0a\uff0c\u901a\u5e38\u4f1a\u5b9a\u4e49\u5b8f <code>_LP64</code> \u6216 <code>__LP64__</code> \u503c\u4e3a 1\u3002</p> <p>ILP32 \u548c LP64 \u662f\u4e24\u7ec4\u4e0d\u540c\u7684\u6570\u636e\u6a21\u578b\uff08Data Model\uff09\uff0c\u51b3\u5b9a\u4e86\u5e73\u53f0\u662f 32 \u4f4d\u8fd8\u662f 64 \u4f4d\uff0c\u8fdb\u800c\u5f71\u54cd long\u3001long long \u548c pointer \u7684\u5bbd\u5ea6\uff1a</p> <ul> <li><code>__SIZEOF_LONG__</code> @intel</li> <li><code>__SIZEOF_LONG_LONG__</code></li> <li><code>__SIZEOF_POINTER__</code> / <code>__POINTER_WIDTH__</code></li> </ul> <p>LP32 \u548c LP64\uff0c\u5176\u4e2d\u7684 <code>L</code> \u8868\u793a long\uff0c<code>P</code> \u8868\u793a pointer\uff0c<code>__SIZEOF_POINTER__</code> \u4e00\u822c\u7b49\u4e8e\u673a\u5668\u5b57\u957f\u3002</p>","tags":["LONG_BIT","WORDSIZE"]},{"location":"blog/20211010/machine-word/#word_bitlong_bit","title":"WORD_BIT/LONG_BIT","text":"<p>linux kernel - WORD_BIT vs LONG_BIT</p> <p>POSIX &lt;limits.h&gt; defines <code>WORD_BIT</code> and <code>LONG_BIT</code> as the number of bits in objects of types <code>int</code> and <code>long</code> respectively.</p> <p>cd \u8fdb\u5165 <code>xcrun --show-sdk-path</code>\uff0c\u6267\u884c grep \u547d\u4ee4\u5728 usr/include \u5934\u6587\u4ef6\u4e2d\u67e5\u770b <code>WORD_BIT</code> \u548c <code>LONG_BIT</code> \u7684\u5b8f\u5b9a\u4e49\uff1a</p> <pre><code>cd `xcrun --show-sdk-path`\n# grep -RFl \"#define WORD_BIT\" usr/include 2&gt;/dev/null\n# grep -RFl \"#define LONG_BIT\" usr/include 2&gt;/dev/null\n\n# --dereference-recursive, --extended-regexp, --files-with-matches\n$ grep -REl \"#define (WORD_BIT|LONG_BIT)\" usr/include 2&gt;/dev/null\nusr/include/i386/limits.h\nusr/include/arm/limits.h\n</code></pre> <p>i386 \u548c arm \u4e0b\u7684\u5934\u6587\u4ef6 limits.h \u4e2d\u5b9a\u4e49\u4e86 <code>WORD_BIT</code> \u548c <code>LONG_BIT</code>\uff1a</p> limits.h<pre><code>$ cd `xcrun --show-sdk-path`\n\n#if !defined(_ANSI_SOURCE)\n#ifdef __LP64__\n#define LONG_BIT    64\n#else /* !__LP64__ */\n#define LONG_BIT    32\n#endif /* __LP64__ */\n#define SSIZE_MAX   LONG_MAX    /* max value for a ssize_t */\n#define WORD_BIT    32\n</code></pre> <p>WORD_BIT \u7684\u503c\u4e3a 32\uff0c\u5bf9\u5e94 int \u7c7b\u578b\u7684\u4f4d\u5bbd\uff08<code>__SIZEOF_INT__</code> * CHAR_BIT\uff09\uff0cLONG_BIT \u7684\u503c\u5219\u8ddf\u968f Data Model\u3002</p> <p>\u5728 rpi4b-ubuntu \u4e0b\uff0cgrep \u641c\u7d22 /usr/include \u76ee\u5f55\uff0c\u6ca1\u627e\u5230 <code>WORD_BIT</code>/<code>LONG_BIT</code> \u7684\u5b9a\u4e49\u3002</p> <ul> <li>Why is there no WORD_BIT in limits.h on Linux?</li> </ul> <p>\u5728 macOS\u3001Linux \u4e0a\u53ef\u4ee5\u6267\u884c <code>getconf WORD_BIT</code> / <code>getconf LONG_BIT</code> \u67e5\u8be2\u83b7\u53d6\u7cfb\u7edf\u914d\u7f6e\u7684\u53d8\u91cf\u3002</p> <ul> <li><code>getconf</code> : to tell what architecture your CPU is presenting to the OS.</li> <li><code>getconf LONG_BIT</code> : check if the OS (kernel) is 32 bit or 64 bit.</li> </ul>","tags":["LONG_BIT","WORDSIZE"]},{"location":"blog/20211010/machine-word/#__wordsize","title":"__WORDSIZE","text":"<p>\u673a\u5668\u5b57\u957f\u8868\u793a\u5904\u7406\u5668\u4e00\u6b21\u5904\u7406\u6570\u636e\u7684\u957f\u5ea6\uff0c\u4e3b\u8981\u7531\u8fd0\u7b97\u5668\u3001\u5bc4\u5b58\u5668\u51b3\u5b9a\uff0c\u598232\u4f4d\u5904\u7406\u5668\uff0c\u6bcf\u4e2a\u5bc4\u5b58\u5668\u80fd\u5b58\u50a832bit\u6570\u636e\uff0c\u52a0\u6cd5\u5668\u652f\u6301\u4e24\u4e2a32bit\u6570\u8fdb\u884c\u76f8\u52a0\u3002</p> <p>\u5728 macOS \u4e0a\u6267\u884c <code>sysctl hw</code>\uff0c\u5728 rpi4b-ubuntu \u4e0a\u6267\u884c <code>lscpu</code> \u67e5\u770b\u786c\u4ef6\uff08CPU\uff09\u4fe1\u606f\uff1a</p> mbpa1398-x86_64mbpa2991-arm64rpi4b-ubuntu - aarch64 <pre><code>$ arch\ni386\n\n# --kernel-name, --kernel-release, --processor, --machine\n$ uname -srpm\nDarwin 20.6.0 x86_64 i386\n\n$ getconf LONG_BIT\n64\n\n# sysctl -a | grep cpu\n$ sysctl hw\n\nhw.optional.x86_64: 1\n\nhw.cpu64bit_capable: 1\n\nhw.cpusubtype: 8\nhw.cputype: 7\n</code></pre> <pre><code>$ arch\narm64\n\n# --operating-system, --kernel-name, --kernel-release, --machine, --processor\n$ uname -osrmp\nDarwin 23.5.0 arm64 arm\n\n$ getconf LONG_BIT\n64\n\n# sysctl -a | grep cpu\n$ sysctl hw\n\nhw.optional.arm64: 1\n\nhw.cpu64bit_capable: 1\n\nhw.cputype: 16777228\nhw.cpusubtype: 2\n</code></pre> <pre><code>$ arch\naarch64\n\n# --operating-system, --kernel-release, --machine, --processor, --kernel-name\n$ uname -srmpo\nLinux 5.15.0-1053-raspi aarch64 aarch64 GNU/Linux\n\n$ getconf LONG_BIT\n64\n\n# The width argument tells whether the Linux is 32- or 64-bit.\n$ lshw | head -n 10\nWARNING: you should run this program as super-user.\nrpi4b-ubuntu\n    description: Computer\n    product: Raspberry Pi 4 Model B Rev 1.4\n    serial: 10000000a744c93f\n    width: 64 bits\n    capabilities: smp cp15_barrier setend swp tagged_addr_disabled\n  *-core\n       description: Motherboard\n       physical id: 0\n     *-cpu:0\n\n$ lscpu | head -n 8\nArchitecture:                       aarch64\nCPU op-mode(s):                     32-bit, 64-bit\nByte Order:                         Little Endian\nCPU(s):                             4\nOn-line CPU(s) list:                0-3\nVendor ID:                          ARM\nModel name:                         Cortex-A72\nModel:                              3\n</code></pre> <p>lscpu CPU op-mode(s)</p> <p>32-bit, 64-bit CPU op-mode on Linux</p> <p>If your kernel is a 32 bit linux kernel, you won't be able to run 64 bit programs, even if your processor supports it. Install a 64 bit kernel (and whole OS of course) to run 64 bit.</p> <p>How to determine whether a given Linux is 32 bit or 64 bit?</p> <p>The <code>CPU op-mode(s)</code> option in the command output tells whether the given Linux is 32 or 64 bits.</p> <p>If it shows 32-bit or 64-bit then Linux is 64 bits as it supports both 32- and 64-bit memory. If it shows only 32-bit then, then Linux is 32-bit.</p> <p>The above Linux system is clearly 64 bits.</p> <p>default wordsize in UNIX/Linux</p> <p>In general wordsize is decided upon target architecture when compiling. Your compiler will normally compile using wordsize for current system. Using gcc (among others), on a 64-bit host you can compile for 32-bit machine, or force 32-bit words.</p> <p>Xcode \u7684 MacOSX.sdk \u548c iPhoneOS.sdk \u7684 usr/include/stdint.h \u6839\u636e Data Model \u662f\u5426\u4e3a <code>__LP64__==1</code> \u533a\u5206\u5b9a\u4e49\u4e86 <code>__WORDSIZE</code>\uff1a</p> stdint.h<pre><code>$ cd `xcrun --show-sdk-path`\n$ grep -Rl \"#*define __WORDSIZE\" usr/include 2&gt;/dev/null\nusr/include/stdint.h\n\n$ vim usr/include/stdint.h\n#if __LP64__\n#define __WORDSIZE 64\n#else\n#define __WORDSIZE 32\n#endif\n</code></pre> <p>\u5728 rpi4b-ubuntu \u4e0b\u7684 /usr/include \u4e2d\u67e5\u627e\u5b8f <code>__WORDSIZE</code> \u5b9a\u4e49\u6240\u5728\u7684\u5934\u6587\u4ef6\uff1a</p> <pre><code>$ grep -Rl \"#*define __WORDSIZE\" /usr/include 2&gt;/dev/null\n/usr/include/aarch64-linux-gnu/bits/wordsize.h\n</code></pre> <p>wordsize.h \u4e2d\u6839\u636e Data Model\uff08<code>__LP64__</code> \u5b9a\u4e49\u4e0e\u5426\uff09\u6765\u533a\u5206\u5b9a\u4e49 <code>__WORDSIZE</code>\u3002</p> wordsize.h<pre><code>// Determine the wordsize from the preprocessor defines.\n#ifdef __LP64__\n# define __WORDSIZE         64\n#else\n# define __WORDSIZE         32\n# define __WORDSIZE32_SIZE_ULONG    1\n# define __WORDSIZE32_PTRDIFF_LONG  1\n#endif\n</code></pre> <p>ARM Compiler v5.06 for uVision armcc User Guide \uff5c Basic data types in ARM C and C++  - Size and alignment of basic data types \u7684 ILP32 \u6570\u636e\u6a21\u578b\u4e0b All pointers\u3001int\u3001long \u90fd\u662f 4 (word-aligned)\uff0c\u8fd9\u91cc\u7684 4 \u5373\u4e3a __WORDSIZE/CHAR_BIT\u3002</p> <p>\u53c2\u8003\u9605\u8bfb\uff1a</p> <ul> <li>\u300a\u6c47\u7f16\u8bed\u8a00(4e)\u300b\u738b\u723d, 2019: \u7b2c\u4e00\u7ae0 \u57fa\u7840\u77e5\u8bc6 - \u5730\u5740\u603b\u7ebf\u3001\u6570\u636e\u603b\u7ebf\u3001\u63a7\u5236\u603b\u7ebf</li> <li>\u300a\u5927\u8bdd\u5904\u7406\u5668\u300b\u4e07\u6728\u6768, 2011: 3.5\u3000\u6c47\u7f16\u8bed\u8a00\u683c\u5f0f\u2014\u2014\u6ca1\u6709\u89c4\u77e9\u4e0d\u6210\u65b9\u5706 | 3.5.1 \u673a\u5668\u5b57\u957f</li> <li>Machine word &amp; x86's WORD</li> </ul>","tags":["LONG_BIT","WORDSIZE"]},{"location":"blog/20230217/signedness-representation/","title":"\u8ba1\u7b97\u673a\u4e2d\u6709\u7b26\u53f7\u6570\u7684\u8868\u793a","text":"<p>\u5bf9\u4e8e\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u6240\u6709\u7684\u6570\u4f4d\u90fd\u88ab\u7528\u6765\u8868\u793a\u6570\u503c\u3002 \u5bf9\u4e8e\u5e26\u7b26\u53f7\u6574\u6570\uff0c\u6570\u4f4d\u88ab\u5212\u5206\u4e3a\u7b26\u53f7\u4f4d\uff08\u53ea\u80fd\u5360\u4e00\u4f4d\uff09\u4e0e\u6570\u503c\u4f4d\uff08\u5269\u4f59\u7684\u5176\u5b83\u4f4d\uff09\u3002</p> <p>\u7b26\u53f7\u4f4d\u7684\u6743\u503c\u6709\u4e0d\u540c\u7684\u89e3\u91ca\uff1a</p> <ol> <li>\u6743\u503c\u662f\u96f6\uff08\u7b26\u53f7\u4f4d\u662f\u201c1\u201d\u5219\u8868\u793a\u6570\u503c\u4e3a\u8d1f\uff09\uff0c\u79f0\u4e3a\u201c\u7b26\u53f7-\u7edd\u5bf9\u503c\u201d\u6a21\u5f0f\uff08Sign and magnitude\uff09\u3002</li> <li>\u6743\u503c\u662f \u2013(2<sup>N-1</sup>-1)\uff0c\u201c1\u7684\u8865\u7801\u201d\u65b9\u5f0f\uff08Ones\u2019 complement\uff09\u3002</li> <li>\u6743\u503c\u662f \u20132<sup>N-1</sup>\uff0c\u201c2\u7684\u8865\u7801\u201d\u65b9\u5f0f\uff08Two\u2019s complement\uff09\u3002</li> </ol>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u65e0\u7b26\u53f7\u6570\u7684\u7f16\u7801","title":"\u65e0\u7b26\u53f7\u6570\u7684\u7f16\u7801","text":"<p>\u7c97\u7565\u5730\u6982\u62ec\uff0c\u6574\u6570\u7c7b\u578b\u5206\u4e3a\u4e24\u5927\u7c7b\uff1a\u65e0\u7b26\u53f7\u6574\u6570\uff08<code>unsigned</code> integer\uff09\u548c\u5e26\u7b26\u53f7\u6574\u6570\uff08<code>signed</code> integer\uff09\u3002</p> <ol> <li>\u957f\u77ed\u4fee\u9970\u7b26 <code>short</code> \u548c <code>long</code> \u7528\u4e8e\u4fee\u9970\u6574\u5f62\uff1a\u9ed8\u8ba4\u4e3a long \u957f\u6574\u5f62\uff0c\u77ed\u6574\u5f62\u9700\u663e\u5f0f\u6307\u5b9a short\u3002</li> <li>\u7b26\u53f7\u4fee\u9970\u7b26 <code>signed</code> \u548c <code>unsigned</code> \u7528\u4e8e\u4fee\u9970\u5b57\u7b26\u578b\u548c\u6574\u5f62\uff1a\u7f3a\u7701\u4e3a <code>signed</code> \u6709\u7b26\u53f7\u7c7b\u578b\uff0c\u65e0\u7b26\u53f7\u9700\u663e\u5f0f\u6307\u5b9a <code>unsigned</code> \u4fee\u9970\u3002</li> <li>\u5f53\u7528 <code>signed</code> / <code>unsigned</code>\u3001<code>short</code> / <code>long</code> \u6765\u4fee\u9970 int \u6574\u5f62\u65f6\uff0cint \u53ef\u7701\u7565\u3002</li> </ol> <p>\u4ee5\u4e0b\u662f\u5b57\u7b26\u578b\u3001\u77ed\u6574\u578b\u3001\u6574\u578b\u6709\u65e0\u7b26\u53f7\u7684\u533a\u5206\u8868\u793a\uff1a</p> <ul> <li>\u6709\u7b26\u53f7\u5b57\u7b26\u578b\uff1achar/signed char\uff1b\u65e0\u7b26\u53f7\u5b57\u7b26\u578b\uff1aunsigned char</li> <li>\u6709\u7b26\u53f7\u77ed\u6574\u578b\uff1ashort [int] /signed short [int]\uff1b\u65e0\u7b26\u53f7\u77ed\u6574\u578b\uff1aunsigned short [int]</li> <li>\u6709\u7b26\u53f7\u6574\u578b\uff1aint /signed [int]\uff1b\u65e0\u7b26\u53f7\u6574\u578b\uff1aunsigned [int]</li> </ul> <p>\u76f8\u5173\u8bdd\u9898\u524d\u7f6e\u53c2\u8003\uff1a</p> <ul> <li>C Data Types</li> <li>C Basic Types - Binary Representions</li> <li>C\u8bed\u8a00\u6807\u51c6\u4e0e\u5b9e\u73b0\u4e4b\u6574\u6570\u7c7b\u578b</li> </ul> <p>\u65e0\u7b26\u53f7\u6574\u6570\u7f16\u7801\u57fa\u4e8e\u4f20\u7edf\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u6cd5\uff0c\u4e00\u822c\u6240\u6709\u7684\u6570\u4f4d\u90fd\u88ab\u7528\u6765\u8868\u793a\u6570\u503c\u3002</p> <p>\u5047\u8bbe\u6709\u4e00\u4e2a\u6574\u6570\u6570\u636e\u7c7b\u578b\u6709 \\(n\\) \u4f4d\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u4f4d\u5411\u91cf\u5199\u6210 \\(\\vec{x}\\) \u8868\u793a\u6574\u4e2a\u5411\u91cf\uff0c\u6216\u8005\u5199\u6210 \\([x_{n-1}, x_{n-2}, \\cdots, x_0]\\)\uff0c\u8868\u793a\u5411\u91cf\u4e2d\u7684\u6bcf\u4e00\u4f4d\u3002\u628a \\(\\vec{x}\\) \u770b\u6210\u4e00\u4e2a\u4e8c\u8fdb\u5236\u8868\u793a\u7684\u6570\uff0c\u5c31\u83b7\u5f97\u4e86  \\(\\vec{x}\\) \u7684\u65e0\u7b26\u53f7\u8868\u793a\u3002\u5728\u8fd9\u4e2a\u4e8c\u8fdb\u5236\u7f16\u7801\u4e2d\uff0c\u6bcf\u4e2a\u4f4d \\(x_i\\) \u90fd\u53d6\u503c0\u62161\uff0c\u540e\u4e00\u79cd\u53d6\u503c\u610f\u5473\u7740\u6570\u503c   \\(2^i\\) \u5e94\u4e3a\u6570\u5b57\u503c\u7684\u4e00\u90e8\u5206\u3002\u6211\u4eec\u7528\u4e00\u4e2a\u51fd\u6570 \\(B2U_n\\)\uff08Binary to Unsigned\u7684\u7f29\u5199\uff0c\u957f\u5ea6\u4e3a\\(n\\)\uff09\u6765\u8868\u793a\u3002</p> <p>\u5bf9\u4f4d\u5411\u91cf \\(\\vec{x} = [x_{n-1}, x_{n-2}, \\dotsc, x_0]\\)\uff1a</p> \\[ B2U_n(\\vec{x}) \\dot=\\sum_{i=0}^{n-1}x_i\\ast2^i \\] <p>\u5728\u8fd9\u4e2a\u7b49\u5f0f\u4e2d\uff0c\u7b49\u53f7\u201c\\(\\dot=\\)\u201d\u8868\u793a\u5de6\u8fb9\u88ab\u5b9a\u4e49\u4e3a\u7b49\u4e8e\u53f3\u8fb9\u3002\u51fd\u6570 \\(B2U_n\\) \u5c06\u4e00\u4e2a\u957f\u5ea6\u4e3a \\(n\\) \u76840\u30011\u4e32\u6620\u5c04\u5230\u975e\u8d1f\u6574\u6570\u3002</p> <p>\\(n\\) \u4f4d\u6240\u80fd\u8868\u793a\u7684\u6700\u5c0f\u503c\u7528\u4f4d\u5411\u91cf\\([00\\cdots0]\\)\uff08\u5168\u96f6\uff09\u8868\u793a\uff0c\u4e5f\u5c31\u662f\u6574\u6570\u503c0\uff0c\u800c\u6700\u5927\u503c\u662f\u7528\u4f4d\u5411\u91cf\\([11\\cdots1]\\)\uff08\u51681\uff09\uff0c\u4e5f\u5c31\u662f\u6574\u6570\u503c \\(UMax_n\\dot=\\sum_{i=0}^{n-1}x_i\\ast2^i=2^n-1\\)\u3002\u5373\\(n\\)\u4f4d\u4e8c\u8fdb\u5236\u4f4d\u4e32\u6240\u80fd\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u662f \\([0, 2^n-1]\\)\u3002</p> <p>\u5728\u4e3b\u6d4164\u4f4dLP64\u67b6\u6784\u5b9e\u73b0\u4e2d\uff0cunsigned char\u3001unsigned short [int]\u3001unsigned [int]\u3001unsigned long [int]\uff08\u6216 long unsigned [int]\uff09\u5206\u522b\u53601\u30012\u30014\u30018\u4e2a\u5b57\u8282\uff088\u300116\u300132\u300164\u4f4d\uff09\u3002\u65e0\u7b26\u53f7\u5b57\u7b26\uff08unsigned char\uff09\u5360\u75281\u4e2a\u5b57\u8282\uff088\u4f4d\uff09\uff0c\u6240\u80fd\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u662f \\([0, 2^8-1] = [0, 255]\\)\uff0c\u5171\\(2^8\\)=256 \u4e2a\u6570\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u6709\u7b26\u53f7\u6570\u7684\u7f16\u7801","title":"\u6709\u7b26\u53f7\u6570\u7684\u7f16\u7801","text":"<p>\u5bf9\u4e8e\u5f88\u591a\u5e94\u7528\uff0c\u6211\u4eec\u8fd8\u5e0c\u671b\u8868\u793a\u8d1f\u6570\u503c\u3002\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u5982\u4f55\u8868\u793a\u7b26\u53f7\u5462\uff1f</p> <p>\u5bf9\u4e8e\u5e26\u7b26\u53f7\u6574\u6570\uff0c\u6570\u4f4d\u88ab\u5212\u5206\u4e3a\u7b26\u53f7\u4f4d\uff08\u53ea\u80fd\u5360\u4e00\u4f4d\uff09\u4e0e\u6570\u503c\u4f4d\uff08\u5269\u4f59\u7684\u5176\u5b83\u4f4d\uff09\u3002</p> <p>\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u5bf9\u4e8e\u6570\u7684\u7b26\u53f7\uff08\u6b63\u53f7<code>+</code>\u548c\u8d1f\u53f7<code>-</code>\uff09\u4e5f\u53ea\u80fd\u75280\u548c1\u8fd9\u4e24\u4f4d\u6570\u5b57\u8868\u793a\u3002\u901a\u5e38\u7528\u4e00\u4e2a\u6570\u7684\u6700\u9ad8\u4f4d\u4f5c\u4e3a\u7b26\u53f7\u4f4d\uff0c\u6700\u9ad8\u4f4d\u4e3a0\u8868\u793a\u7b26\u53f7\u4f4d\u4e3a\u6b63\uff1b\u6700\u9ad8\u4f4d\u4e3a1\u8868\u793a\u7b26\u53f7\u4f4d\u4e3a\u8d1f\u3002\u8fd9\u6837\uff0c\u6570\u7684\u7b26\u53f7\u6807\u8bc6\u4e5f\u201c\u6570\u7801\u5316\u201d\u4e86\u3002\u5373\u5e26\u7b26\u53f7\u6570\u7684\u6570\u503c\u548c\u7b26\u53f7\u7edf\u4e00\u7528\u4e8c\u8fdb\u5236\u6570\u7801\u5f62\u5f0f\u6765\u8868\u793a\u3002</p> <p>\u5728\u5c06\u6570\u7684\u7b26\u53f7\u7528\u6570\u7801\uff080\u62161\uff09\u8868\u793a\u540e\uff0c\u6570\u503c\u90e8\u5206\u7a76\u7adf\u662f\u4fdd\u7559\u539f\u6765\u7684\u5f62\u5f0f\uff0c\u8fd8\u662f\u6309\u4e00\u5b9a\u7684\u89c4\u5219\u505a\u67d0\u4e9b\u53d8\u5316\uff0c\u8fd9\u8981\u53d6\u51b3\u4e8e\u8fd0\u7b97\u65b9\u6cd5\u7684\u9700\u8981\uff0c\u4ece\u800c\u6709\u56db\u79cd\u5e38\u89c1\u7684\u673a\u5668\u6570\u5f62\u5f0f\uff1a\u539f\u7801\u3001\u53cd\u7801\u3001\u8865\u7801 \u548c \u79fb\u7801\u3002</p> <p>\u4e3a\u4e86\u533a\u522b\u539f\u6765\u7684\u6570\u4e0e\u5b83\u5728\u673a\u5668\u4e2d\u7684\u8868\u793a\u5f62\u5f0f\uff0c\u5c06\u4e00\u4e2a\u6570\uff08\u8fde\u540c\u7b26\u53f7\uff09\u5728\u673a\u5668\u4e2d\u52a0\u4ee5\u6570\u7801\u5316\u540e\u7684\u5f62\u5f0f\uff0c\u79f0\u4e3a\u673a\u5668\u6570\u6216\u673a\u5668\u7801\uff0c\u800c\u628a\u673a\u5668\u6570\u6240\u4ee3\u8868\u7684\u5b9e\u9645\u6570\u503c\u79f0\u4e3a\u771f\u503c\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u539f\u7801sign-magnitude","title":"\u539f\u7801\uff08Sign-Magnitude\uff09","text":"<p>\u539f\u7801\u8868\u793a\u6cd5\u6bd4\u8f83\u76f4\u89c2\uff0c\u5176\u6570\u503c\u90e8\u5206\u4fdd\u7559\u5176\u771f\u503c\uff08\u7684\u7edd\u5bf9\u503c\uff09\u3002</p> <p></p> <p>\u4f8b\u5982\uff0c\u6b63\u657089\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a \\(+1011001\\)\uff0c\u6b63\u53f7 <code>+</code> \u76f4\u63a5\u75280\u4ee3\u66ff\uff0c\u5176\u673a\u5668\u539f\u7801\u8868\u793a\u4e3a\uff1a</p> <p>\u8d1f\u6570-89\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a\\(-1011001\\)\uff08\u6570\u503c\u4f4d\u5bbd\u4e3a7\uff09\uff0c\u8d1f\u53f7 <code>-</code> \u76f4\u63a5\u75281\u4ee3\u66ff\uff0c\u5176\u673a\u5668\u539f\u7801\u8868\u793a\u4e3a\uff1a</p> <p>\u82e5\u7b26\u53f7\u771f\u503c\u4e3aX\uff0c\u6700\u7ec8\u673a\u5668\u539f\u7801\u7684\u4f4d\u5411\u91cf \\(\\vec{x} = [x_{n-1}, x_{n-2} ,\\dotsc, x_0]\\) \u5bbd\u5ea6\u4e3a \\(n\\)\uff0c\u9664\u6700\u9ad8\u7b26\u53f7\u4f4d \\(x_{n-1}\\) \u5916\u7684\u6570\u503c\u4f4d\u5bbd\u4e3a \\(n-1\\)\uff0c\u5219\u53ef\u5c06\u539f\u7801\u8868\u793a\u89c4\u5219\u7528\u8868\u8fbe\u5f0f\u5f62\u5f0f\u5b9a\u4e49\u5982\u4e0b\uff1a</p> \\[ % \u539f\u7801 [X]_\u539f= \\begin{cases}         X\uff0c&amp;  X=+0 \\quad || \\quad 0 \\lt X \\lt 2^{n-1} \\\\         2^{n-1}-X = 2^{n-1}+\\lvert X \\rvert\uff0c&amp; X=-0 \\quad || -2^{n-1} \\lt X \\lt 0 \\\\ \\end{cases} \\] <ul> <li>8\u4f4d\u4e8c\u8fdb\u5236\u539f\u7801\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u4e3a 11111111-10000000,00000000-01111111\uff0c\u5373 -127 - -0,+0 - +127\u3002\u5176\u4e2d\uff0c\u201c0\u201d\u6709-0\u548c+0\u4e4b\u5206\uff0c\\([-0]_\u539f=1 0000000\\)\uff0c\\([+0]_\u539f=0 0000000\\)\u3002</li> <li>\\([-89]_\u539f=2^{8-1}-(-89) = 2^7+89 = 0b10000000+0b1011001 = 0b11011001\\)\u3002</li> </ul> <p>\u539f\u7801\u8868\u793a\u6cd5\u7684\u4f18\u70b9\u662f\u6bd4\u8f83\u76f4\u89c2\u3001\u7b80\u5355\u6613\u61c2\uff0c\u540e\u9762\u5728\u6d6e\u70b9\u6570\u4e2d\u6709\u4f7f\u7528\u5230\u539f\u7801\u7f16\u7801\u3002 \u539f\u7801\u7684\u7b26\u53f7\u4f4d\u4e0d\u662f\u6570\u503c\u7684\u4e00\u90e8\u5206\uff0c\u4e0d\u80fd\u76f4\u63a5\u53c2\u4e0e\u8fd0\u7b97\uff0c\u5bfc\u81f4\u52a0\u6cd5\u8fd0\u7b97\u590d\u6742\u3002 \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u77db\u76fe\uff0c\u4eba\u4eec\u5f15\u5165\u4e86\u53cd\u7801\u548c\u8865\u7801\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u53cd\u7801ones_complement","title":"\u53cd\u7801\uff08Ones' Complement\uff09","text":"<p>\u5bf9\u4e8e\u6b63\u6570\u800c\u8a00\uff0c\u5176\u53cd\u7801\u5f62\u5f0f\u4e0e\u5176\u539f\u7801\u76f8\u540c\uff1a\u6700\u9ad8\u4f4d\u4e3a\u7b26\u53f7\u4f4d\uff0c\u75280\u8868\u793a\u6b63\u6570\uff0c\u5176\u4f59\u4f4d\u4e3a\u6570\u503c\u4f4d\u4e0d\u53d8\u3002\u5bf9\u4e8e\u8d1f\u6570\u800c\u8a00\uff0c\u5176\u53cd\u7801\u8868\u793a\u4e3a\uff1a\u6700\u9ad8\u4f4d\u7b26\u53f7\u4f4d\u4e3a1\uff0c\u5176\u4f59\u6570\u503c\u4f4d\u5728\u539f\u7801\u7684\u57fa\u7840\u4e0a\u6309\u4f4d\u53d6\u53cd\u3002\u53cd\u7801\u5728\u673a\u5668\u4e2d\u7684\u8868\u793a\u5f62\u5f0f\u5982\u4e0b\uff1a</p> <p></p> <p>-89\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a \\(-1011001\\)\uff0c\u5176\u539f\u7801\u8868\u793a\u4e3a \\(1 1011001\\)\uff0c\u5219\u5176\u53cd\u7801\u8868\u793a\u4e3a \\(1 0100110\\)\u3002</p> <p>\u82e5\u7b26\u53f7\u771f\u503c\u4e3aX\uff0c\u6700\u7ec8\u673a\u5668\u53cd\u7801\u7684\u4f4d\u5411\u91cf \\(\\vec{x} = [x_{n-1}, x_{n-2} ,\\dotsc, x_0]\\) \u5bbd\u5ea6\u4e3a \\(n\\)\uff0c\u9664\u6700\u9ad8\u7b26\u53f7\u4f4d \\(x_{n-1}\\) \u5916\u7684\u6570\u503c\u4f4d\u5bbd\u4e3a \\(n-1\\)\uff0c\u5219\u53ef\u5c06\u53cd\u7801\u8868\u793a\u89c4\u5219\u7528\u8868\u8fbe\u5f0f\u5f62\u5f0f\u5b9a\u4e49\u5982\u4e0b\uff1a</p> \\[ % \u53cd\u7801 [X]_\u53cd= \\begin{cases}         X\uff0c&amp;  X=+0 \\quad || \\quad 0 \\lt X \\lt 2^{n-1} \\\\         (2^n-1) + X = (2^n-1)- \\lvert X \\rvert\uff0c&amp; X=-0 \\quad || -2^{n-1} \\lt X \\lt 0 \\end{cases} \\] <ul> <li>\u5f53 X&lt;0 \u6216 X=-0 \u65f6\uff0c\u6309\u7167\u65e0\u7b26\u53f7\u6570\u89e3\u6790\u4f4d\u5411\u91cf\uff0c\\(\\lvert X \\rvert + \\overrightarrow{[X]_\u53cd}=2^n-1\\)\uff08n\u4f4d\u51681\uff09\u3002\u4f8b\u5982\u5f53n=8\u65f6\uff0c\\(\\lvert X \\rvert + \\overrightarrow{[X]_\u53cd}=0b11111111=255\\)\u3002\\(\\overrightarrow{[X]_\u53cd}\\) \u76f8\u5f53\u4e8e \\(\\lvert X \\rvert\\) \u7684\u6309\u4f4d\u53d6\u53cd\uff08bitwise inversion\uff09= ~\\(\\lvert X \\rvert\\)\u3002</li> <li>8\u4f4d\u4e8c\u8fdb\u5236\u53cd\u7801\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u4e3a 10000000-11111111,00000000-01111111\uff08\u8d1f\u6570\u6570\u503c\u90e8\u5206\u6c42\u53cd\u590d\u539f\uff1a11111111-10000000,00000000-01111111\uff09\uff0c\u5373 -127 - -0,+0 - +127\u3002\u5176\u4e2d\uff0c\u201c0\u201d\u6709-0\u548c+0\u4e4b\u5206\uff0c\\([-0]_\u53cd=1 1111111\\)\uff0c\\([+0]_\u53cd=0 0000000\\)\u3002</li> </ul> <p>\u6c42-89\u76848\u4f4d\u53cd\u7801\u65f6\uff0c\u65e0\u9700\u6309\u7167\u201c\u539f\u7801\u2192\u53cd\u7801\u201d\u8fd9\u4e2a\u6b65\u9aa4\uff0c\u57fa\u4e8e\u4ee5\u4e0a\u8868\u8fbe\u5f0f\u5373\u53ef\u8ba1\u7b97\u51fa\u5176\u53cd\u7801\u7684\u65e0\u7b26\u53f7\u771f\u503c\uff0c\u5176\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u4f4d\u5411\u91cf\u5373\u4e3a-89\u7684\u53cd\u7801\u3002</p> <ul> <li>\\([-89]_\u53cd=(2^8-1)+(-89) = (2^8-1)-(89) = 166 = 0b10100110\\)\u3002</li> <li>\\([-89]_\u53cd\\)=~(-89)=166=\\(0b10100110\\)\u3002</li> </ul> <p>\u867d\u7136\u8fc7\u53bb\u751f\u4ea7\u8fc7\u57fa\u4e8e\u53cd\u7801\u8868\u793a\u7684\u673a\u5668\uff0c\u4f46\u662f\u51e0\u4e4e\u6240\u6709\u7684\u73b0\u4ee3\u673a\u5668\u90fd\u4f7f\u7528\u8865\u7801\u5f62\u5f0f\u8868\u793a\u6709\u7b26\u53f7\u6574\u6570\u3002 \u73b0\u5728\u901a\u5e38\u5df2\u4e0d\u518d\u5355\u72ec\u4f7f\u7528\u53cd\u7801\uff0c\u800c\u4e3b\u8981\u662f\u4f5c\u4e3a\u6c42\u8865\u7801\u7684\u4e00\u4e2a\u4e2d\u95f4\u6b65\u9aa4\u6765\u4f7f\u7528\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u8865\u7801twos_complement","title":"\u8865\u7801\uff08Two's Complement\uff09","text":"<p>\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u6700\u5e38\u89c1\u7684\u6709\u7b26\u53f7\uff08\u6574\uff09\u6570\u7684\u8868\u793a\u65b9\u5f0f\u662f\u8865\u7801\u3002\u91c7\u7528\u8865\u7801\u8fd0\u7b97\u53ef\u4ee5\u5c06\u51cf\u6cd5\u53d8\u6210\u8865\u7801\u52a0\u6cd5\u8fd0\u7b97\uff0c\u5728\u5fae\u5904\u7406\u5668\u4e2d\u53ea\u9700\u52a0\u6cd5\u7684\u7535\u8def\u5c31\u53ef\u4ee5\u5b9e\u73b0\u52a0\u6cd5\u3001\u51cf\u6cd5\u8fd0\u7b97\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u6982\u5ff5\u5bfc\u8bfb","title":"\u6982\u5ff5\u5bfc\u8bfb","text":"<p>\u4e3a\u4e86\u7406\u89e3\u8865\u7801\u7684\u6982\u5ff5\uff0c\u6211\u4eec\u5148\u6765\u770b\u770b\u5706\u5468\u8fd0\u52a8\u7684\u4f8b\u5b50\u3002</p> <p>\u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\uff0c\u4e00\u4e2a\u5706\u5468\u7684\u53ef\u89c6\u89d2\u5ea6\u5ea6\u91cf\u4e3a0-2\u03c0\uff08\u62160\u00b0-360\u00b0\uff09\uff0c\u4ee5\u539f\u70b9\u4e3a\u8d77\u70b9\u7684\u5c04\u7ebfOA\u9006\u65f6\u9488\u65cb\u8f6c\u4e00\u5708\u7684\u5f27\u5ea6\u4e3a2\u03c0\u3002</p> <p>\u5706\u5468\u8fd0\u52a8\u5177\u6709\u5468\u671f\u6027\uff0c\u5373\u5177\u6709\u201c\u5468\u800c\u590d\u59cb\u201d\u7684\u53d8\u5316\u89c4\u5f8b\u3002\u5047\u8bbeOA\u7684\u521d\u59cb\u5f27\u5ea6\u4e3a\u03b1\uff0c\u7ec8\u8fb9OA\u6bcf\u7ed5\u539f\u70b9\u65cb\u8f6c\u4e00\u5468\uff0c\u03b1\u589e\u52a02\u03c0\u5f27\u5ea6\uff08\u65cb\u8f6ck\u5468\u540e\uff0c\u5f27\u5ea6\u53d8\u6210\u03b1+k\u00b72\u03c0\uff09\uff0c\u4f46OA\u4f4d\u7f6e\u4e0d\u53d8\u3002\u7531\u4e09\u89d2\u51fd\u6570\u7684\u5b9a\u4e49\u53ef\u77e5\uff0c\u7ec8\u8fb9\u76f8\u540c\u7684\u89d2\u7684\u540c\u4e00\u4e09\u89d2\u51fd\u6570\u7684\u503c\u76f8\u7b49\u3002</p> \\[ \\begin{gather*}     \\sin(\\alpha+k\u00b72\\pi) = \\sin\\alpha \\\\     \\cos(\\alpha+k\u00b72\\pi) = \\cos\\alpha \\\\     \\tan(\\alpha+k\u00b72\\pi) = \\tan\\alpha \\end{gather*} \\] <p>\u7531\u4e0a\u9762\u7684\u516c\u5f0f\u53ef\u77e5\uff0c\u53ef\u4ee5\u628a\u6c42\u4efb\u610f\u89d2\u7684\u4e09\u89d2\u51fd\u6570\u503c\uff0c\u8f6c\u5316\u4e3a\u6c420-2\u03c0\uff08\u62160\u00b0-360\u00b0\uff09\u89d2\u7684\u4e09\u89d2\u51fd\u6570\u503c\u3002\u5c04\u7ebfOA\u9006\u65f6\u9488\u65cb\u8f6c\u03c0\u548c\u987a\u65f6\u9488\u65cb\u8f6c\u03c0\uff08-\u03c0\uff09\u7684\u7ec8\u8fb9\u662f\u76f8\u540c\u7684\uff0c\u9006\u65f6\u9488\u65cb\u8f6c5\u03c0/3\u548c\u987a\u65f6\u9488\u65cb\u8f6c\u03c0/3\uff08-\u03c0/3\uff09\u7684\u7ec8\u8fb9\u662f\u76f8\u540c\u7684\u3002\u4ee5\u4e0b\u5c06\u8d1f\u5f27\u5ea6\u7684\u6b63\u5f26\u8ba1\u7b97\u8f6c\u5316\u52300-2\u03c0\u533a\u95f4\u6362\u7b97\uff1a</p> \\[  \\begin{gather*}     \\sin(-\\pi+2\\pi) = \\sin\\pi \\\\     \\sin(-\\frac{\\pi}{3}+2\\pi) = \\sin\\frac{5\\pi}{3} \\end{gather*} \\] <p>\u6211\u4eec\u518d\u6765\u8fdb\u4e00\u6b65\u770b\u770b\u65e5\u5e38\u751f\u6d3b\u4e2d\u6821\u6b63\u65f6\u949f\u7684\u4f8b\u5b50\u3002</p> <p>\u5047\u5b9a\u65f6\u949f\u505c\u57287\u70b9\uff0c\u800c\u6b63\u786e\u65f6\u95f4\u662f5\u70b9\uff0c\u8981\u62e8\u51c6\u65f6\u949f\u53ef\u4ee5\u6709\u4e24\u79cd\u4e0d\u540c\u7684\u62e8\u6cd5\uff1a\u5012\u62e82\u4e2a\u683c\u6216\u987a\u62e810\u4e2a\u683c\u3002</p> <p>\u60f3\u8c61\u4e00\u4e0b\uff0c\u9f9f\u5154\u57287\u70b9\u949f\u523b\u5ea6\u80cc\u5411\u800c\u884c\uff0c\u5047\u8bbe\u5154\u5b50\u7684\u901f\u5ea6\u662f\u4e4c\u9f9f\u76845\u500d\uff0c\u5154\u5b50\u987a\u65f6\u9488\u8dd110\u683c\uff0c\u4e4c\u9f9f\u9006\u65f6\u9488\u8dd12\u683c\uff0c\u5b83\u4eec\u5c06\u57285\u70b9\u523b\u5ea6\u5904\u8fce\u9762\u76f8\u9047\u3002</p> <p>\u7531\u4e8e\u949f\u9762\u7684\u5bb9\u91cf\u6709\u9650\uff0c\u5176\u8868\u76d8\u523b\u5ea6\u5b9e\u9645\u4e0a\u662f\u5341\u4e8c\u8fdb\u5236\uff0c12h\u4ee5\u540e\u53c8\u4ece0\u5f00\u59cb\u8ba1\u6570\u3002\u5012\u62e82\u4e2a\u683c\uff0c\u53737-2=5\uff08\u505a\u51cf\u6cd5\uff09\uff1b\u987a\u62e810\u4e2a\u683c\uff0c\u53737+10=12+5\uff08\u505a\u52a0\u6cd5\uff09\u3002\u800c\u949f\u9762\u4e0a12=0\uff0c\u654512+5\u56de\u5f52\u5230\u523b\u5ea65\u3002\u8fd9\u5c31\u8868\u660e\uff0c\u5728\u820d\u6389\u8fdb\u4f4d\u7684\u60c5\u51b5\u4e0b\uff0c\u201c\u4ece7\u51cf\u53bb2\u201d\u548c\u201c\u5f807\u52a0\u4e0a10\u201d\u6240\u5f97\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\u3002\u5728\u5341\u4e8c\u8fdb\u5236\u4e0b\uff0c12+5\u4e22\u5931\u8fdb\u4f4d12\uff0c\u6b64\u590412\u662f\u6ea2\u51fa\u91cf\uff0c\u53c8\u79f0\u4e3a\u6a21\uff08mod\uff09\u3002\u800c-2\u548c10\u7684\u7edd\u5bf9\u503c\u4e4b\u548c\u6070\u597d\u7b49\u4e8e\u6a21\u657012\uff0c\u6211\u4eec\u628a10\u79f0\u4e3a-2\u5bf9\u4e8e\u6a21\u657012\u7684\u8865\u6570\u3002\u5728\u5706\u5468\u8fd0\u52a8\u4e2d\uff0c\u6bcf\u8f6c\u52a8\u4e00\u5468\u7684 \\(2\\pi\\) \u5f27\u5ea6\u53ef\u89c6\u4e3a\u6ea2\u51fa\u91cf\uff08\u6a21\uff09\uff0c\\(\\frac{5\\pi}{3}\\) \u4e3a \\(-\\frac{\\pi}{3}\\) \u5bf9\u4e8e\u6a21\u6570 \\(2\\pi\\) \u7684\u8865\u6570\u3002</p> \\[ \\begin{align*} 10 &amp; \\equiv -2 &amp; \\mod 12 \\\\ \\frac{5\\pi}{3} &amp; \\equiv -\\frac{\\pi}{3} &amp; \\mod 2\\pi \\end{align*} \\] <p>\u5728\u7535\u8111\u548c\u624b\u673a\u7684\u65e5\u671f\u548c\u65f6\u95f4\u504f\u597d\u8bbe\u7f6e\u4e2d\uff0c\u901a\u5e38\u53ef\u4ee5\u8bbe\u7f6e\u663e\u793a24\u5c0f\u65f6\uff0c\u56e0\u4e3a\u5730\u7403\u81ea\u8f6c\u4e00\u5708\u662f\u4e00\u5929\uff08\u63a5\u8fd124h\uff09\u300224h\u5236\u768401\u70b9\u548c13\u70b9\uff08\u4e0b\u53481\u70b9\uff09\u90fd\u5bf9\u5e9412h\u5236\u949f\u8868\u76d8\u4e0a\u76841\u70b9\u4f4d\uff1a\\(1 \\equiv 13 \\mod 12\\)\u3002\u201c\u5929\u5929\u5411\u4e0a\u201d\u3001\u201c\u65e5\u590d\u4e00\u65e5\u201d\u4e2d\u7684\u201c\u5929\u201d\u548c\u201c\u65e5\u201d\u5373\u4e3a\u6ea2\u51fa\u91cf\uff0c\u6bcf\u8fc724h\uff08\u6a21\uff09\u53c8\u5c06\u5f00\u542f\u5d2d\u65b0\u7684\u4e00\u5929\u3002\u5047\u8bbe\u73b0\u5728\u662f\u4eca\u59290\u70b9\uff0c\u521932h\u540e\u5c31\u662f\u660e\u5929\u4e0a\u53488\u70b9\uff1a\\(8 \\equiv 32 \\mod 24\\)\u3002</p> <p>\u8ba1\u7b97\u673a\u4e2d\u7684\u8fd0\u7b97\u53d7\u4e00\u5b9a\u5b57\u957f\u7684\u9650\u5236\uff0c\u5b83\u7684\u8fd0\u7b97\u90e8\u4ef6\u3001\u5bc4\u5b58\u5668\u548c\u5b58\u50a8\u5355\u5143\u90fd\u6709\u4e00\u5b9a\u7684\u4f4d\u6570\uff0c\u56e0\u800c\u5728\u8fd0\u7b97\u8fc7\u7a0b\u4e2d\u4e5f\u4f1a\u4ea7\u751f\u6ea2\u51fa\u91cf\uff0c\u6240\u4ea7\u751f\u7684\u6ea2\u51fa\u91cf\u5b9e\u9645\u4e0a\u5c31\u662f\u6a21\u3002\u53ef\u89c1\uff0c\u8ba1\u7b97\u673a\u7684\u8fd0\u7b97\u4e5f\u662f\u4e00\u79cd\u6709\u6a21\u8fd0\u7b97\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u7f16\u7801\u683c\u5f0f","title":"\u7f16\u7801\u683c\u5f0f","text":"<p>\u5bf9\u4e8e\u6b63\u6570\u800c\u8a00\uff0c\u5176\u8865\u7801\u5f62\u5f0f\u4e0e\u5176\u539f\u7801\u3001\u53cd\u7801\u76f8\u540c\uff1a\u6700\u9ad8\u4f4d\u4e3a\u7b26\u53f7\u4f4d\uff0c\u75280\u8868\u793a\u6b63\u6570\uff0c\u5176\u4f59\u4f4d\u4e3a\u6570\u503c\u4f4d\u4e0d\u53d8\u3002\u5bf9\u4e8e\u8d1f\u6570\u800c\u8a00\uff0c\u5176\u8865\u7801\u8868\u793a\u4e3a\uff1a\u6700\u9ad8\u4f4d\u7b26\u53f7\u4f4d\u4e3a1\uff0c\u5176\u4f59\u6570\u503c\u4f4d\u5728\u539f\u7801\u7684\u57fa\u7840\u4e0a\u6309\u4f4d\u53d6\u53cd\u5e76\u52a01\uff08\u53cd\u7801+1\uff09\u3002\u8865\u7801\u5728\u673a\u5668\u4e2d\u7684\u8868\u793a\u5f62\u5f0f\u5982\u4e0b\uff1a</p> <p></p> <p>-89\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a \\(-1011001\\)\uff0c\u5176\u539f\u7801\u8868\u793a\u4e3a \\(1 1011001\\)\uff0c\u5176\u53cd\u7801\u8868\u793a\u4e3a \\(1 0100110\\)\uff0c\u5219\u5176\u8865\u7801\u8868\u793a\u4e3a \\(1 0100111\\)\u3002</p> <p>\u82e5\u7b26\u53f7\u771f\u503c\u4e3aX\uff0c\u6700\u7ec8\u673a\u5668\u8865\u7801\u7684\u4f4d\u5411\u91cf \\(\\vec{x} = [x_{n-1}, x_{n-2} ,\\dotsc, x_0]\\) \u5bbd\u5ea6\u4e3a \\(n\\)\uff0c\u9664\u6700\u9ad8\u7b26\u53f7\u4f4d \\(x_{n-1}\\) \u5916\u7684\u6570\u503c\u4f4d\u5bbd\u4e3a \\(n-1\\)\uff0c\u5219\u53ef\u5c06\u53cd\u7801\u8868\u793a\u89c4\u5219\u7528\u8868\u8fbe\u5f0f\u5f62\u5f0f\u5b9a\u4e49\u5982\u4e0b\uff1a</p> \\[ % \u8865\u7801 [X]_\u8865= \\begin{cases}         X, &amp; 0 \\le X \\lt 2^{n-1} \\\\         2^n+X = 2^n- \\lvert X \\rvert, &amp; -2^{n-1} \\le X \\lt 0 \\quad (\\mod 2^n) \\end{cases} \\] <ul> <li>\u5f53 X&lt;0 \u65f6\uff0c\u6309\u7167\u65e0\u7b26\u53f7\u6570\u89e3\u6790\u4f4d\u5411\u91cf\uff0c\\(\\lvert X \\rvert+\\overrightarrow{[X]_\u8865}=2^n\\)\uff08\u76f8\u5bf9\u53cd\u7801\u52a01\uff09\u3002\u4f8b\u5982\u5f53n=8\u65f6\uff0c\\(\\lvert X \\rvert+\\overrightarrow{[X]_\u8865}=2^8=256\\)\u30028\u4f4d\u51681\uff080b11111111\uff09\u65f6\uff0c\u80fd\u8868\u793a\u6700\u5927\u65e0\u7b26\u53f7\u6570 \\(2^8-1\\) \u6216\u6700\u5927\u6709\u7b26\u53f7\u6570(\\(-1\\))\uff0c\u518d\u52a01\u5219\u4f1a\u8d85\u51fa8\u4f4d\u6240\u80fd\u8868\u793a\u7684\u6700\u5927\u503c\uff0c\u53d8\u62109\u4f4d\u4e8c\u8fdb\u52360b100000000\uff0c\u9ad8\u4f4d\u622a\u65ad\u6ea2\u51fa\u4e3a0b00000000\uff0c\u5373\u8d85\u8fc7256\u4ece\u96f6\u5f00\u59cb\u8ba1\u6570\uff08\\(0 \\equiv 256 \\mod 256\\)\uff09\u3002</li> <li>8\u4f4d\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u4e3a 10000000-11111111,00000000-01111111\uff0c\u5373 -128 - -1,+0 - +127\u3002\u5176\u4e2d\uff0c\u65e0-0\u548c+0\u4e4b\u5206\uff0c\u4fdd\u8bc1\u4e860\u7684\u552f\u4e00\u6027\u3002\u53e6\u5916\uff0c\u53d6\u503c\u8303\u56f4\u4e3a\u8fde\u8d2f\u533a\u95f4 [-128, 127]\uff0c\u5305\u542b128\u4e2a\u8d1f\u6570\u3001128\u4e2a\u975e\u8d1f\u6570\u3002\u8d1f\u6570\u3001\u975e\u8d1f\u6570\u5404\u5360\u4e00\u534a\uff0c\u8d1f\u6570\u6bd4\u6b63\u6570\u591a\u4e00\u4e2a\u3002</li> </ul> <p>\u8bbe\u60f3\u4e00\u4e2a\u6709256\u4e2a\u523b\u5ea6\u7684\u5927\u7b28\u949f\uff0c\u5f53\u91c7\u7528\u8865\u7801\u91cd\u65b0\u7f16\u7801\u523b\u5ea6\u540e\uff0c\u8868\u76d8\u7684256\u4e2a\u523b\u5ea6\u88ab\u91cd\u65b0\u7f16\u7801\uff0c\u5212\u5206\u6210\u53f3\u8fb9\u987a\u65f6\u9488\u534a\u76d8[0,127]\u548c\u5de6\u8fb9\u9006\u65f6\u9488\u534a\u76d8[-128,-1]\u3002</p> <p>-89\u7684\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\u4e3a \\(1 0100111\\)\uff0c\u6309\u7167\u65e0\u7b26\u53f7\u6570\u89e3\u6790\u4f4d\u5411\u91cf\u7684\u503c\u4e3a167\uff0c\u6ee1\u8db3\uff1a</p> \\[ \\lvert -89 \\rvert + 167 = 256 \\implies 167 \\equiv -89 \\mod 256 \\] <p>\u6c42-89\u76848\u4f4d\u8865\u7801\u65f6\uff0c\u65e0\u9700\u6309\u7167\u201c\u539f\u7801\u2192\u53cd\u7801\u2192+1\u201d\u8fd9\u4e2a\u6b65\u9aa4\uff0c\u53ef\u57fa\u4e8e\u4ee5\u4e0a\u8868\u8fbe\u5f0f\u8ba1\u7b97\u5176\u8865\u6570\uff1a</p> <ul> <li>\\([-89]_\u8865=2^8+(-89) = 2^8-89 = 167 \\implies -89 \\mod 256 = 256+(-89) \\equiv 167\\)</li> </ul> <p>\u8d1f\u6570-89\u5bf9\u5e94\u7684\u65e0\u7b26\u53f7\u8865\u6570167\u7684\u4e8c\u8fdb\u5236\u4f4d\u5411\u91cf 0b10100111\uff0c\u5373\u4e3a\u5176\u8865\u7801\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u6309\u6743\u5c55\u5f00","title":"\u6309\u6743\u5c55\u5f00","text":"<p>-89\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a \\(-1011001\\)\uff0c\u5176\u539f\u7801\u8868\u793a\u4e3a \\(1 1011001\\)\uff0c\u5176\u53cd\u7801\u8868\u793a\u4e3a \\(1 0100110\\)\uff0c\u5176\u8865\u7801\u8868\u793a\u4e3a \\(1 0100111\\)\u3002</p> <p>\\(\\lvert -89 \\rvert\\) \u7684\u4e8c\u8fdb\u5236\u4f4d\u5411\u91cf\u4e3a \\(01011001\\)\uff1a</p> <ul> <li>\u4e0d\u8003\u8651\u6700\u9ad8\u7b26\u53f7\u4f4d\uff0c\u6839\u636e\u53cd\u7801\u7684\u5b9a\u4e49\uff0c\u53cd\u7801\u6570\u503c\u90e8\u5206\u4f4d\u5411\u91cf=</li> </ul> \\[ (2^{n-1}-1)-\\lvert X \\rvert \\overset{\\text{n=8}}{=\\!=\\!=} 127-\\lvert -89 \\rvert=0b01111111-0b01011001=0b00100110 \\] <ul> <li>\u4e0d\u8003\u8651\u6700\u9ad8\u7b26\u53f7\u4f4d\uff0c\u8865\u7801\u6570\u503c\u90e8\u5206\u4f4d\u5411\u91cf=</li> </ul> \\[ (2^{n-1}-1)-\\lvert X \\rvert+1 = 2^{n-1}-\\lvert X \\rvert \\overset{\\text{n=8}}{=\\!=\\!=} 127-\\lvert -89 \\rvert+1=0b01111111-0b01011001+1=0b00100111 \\] <p>\u8865\u7801\u9ad8\u4f4d\u7b26\u53f7\u4f4d\u53601\u4f4d\uff0c\u5176\u4f59\u6570\u503c\u90e8\u5206\u5360 n-1 \u4f4d\u3002\u5f53\u5c06\u6700\u9ad8\u7b26\u53f7\u4f4d\u89e3\u91ca\u4e3a\u8d1f\u6743\uff08\\(-2^{n-1}\\)\uff09\u65f6\uff0c\u6574\u4f53\u4f4d\u5411\u91cf\u7684\u771f\u503c\u5373\u4e3a\u539f\u59cb\u8d1f\u503c\uff1a</p> \\[ \\underbrace{-2^{n-1}}_{1} + \\underbrace{2^{n-1}-\\lvert X \\rvert}_{n-1} = -\\lvert X \\rvert \\] <p>\u6211\u4eec\u7528\u4e00\u4e2a\u51fd\u6570 \\(B2T_n\\)\uff08Binary to Two's Complement \u7684\u7f29\u5199\uff0c\u957f\u5ea6\u4e3a\\(n\\)\uff09\u6765\u8868\u793a\u4f4d\u5411\u91cf \\(\\vec{x} = [x_{n-1}, x_{n-2} , \\dotsc, x_0]\\) \u5230\u8865\u7801\u7684\u7f16\u7801\u6620\u5c04\uff1a</p> \\[ B2T_n(\\vec{x}) \\dot=-x_{n-1}\\ast2^{n-1} + \\sum_{i=0}^{n-2}x_i\\ast2^i \\] <p>\u6700\u9ad8\u6709\u6548\u4f4d \\(x_{n-1}\\) \u79f0\u4e3a\u7b26\u53f7\u4f4d\uff0c\u5b83\u7684\u201c\u6743\u91cd\u201d\u4e3a \\(-2^{n-1}\\)\uff0c\u662f\u65e0\u7b26\u53f7\u8868\u793a\u4e2d\u6743\u91cd\u7684\u8d1f\u6570\u3002\u7b26\u53f7\u4f4d\u88ab\u8bbe\u7f6e\u4e3a1\u65f6\uff0c\u8868\u793a\u503c\u4e3a\u8d1f\uff0c\u800c\u5f53\u8bbe\u7f6e\u4e3a0\u65f6\uff0c\u503c\u4e3a\u975e\u8d1f\u3002</p> <p>\\(\\lvert -89 \\rvert\\) \u7684\u4e8c\u8fdb\u5236\u4f4d\u5411\u91cf\u4e3a \\(01011001\\)\uff0c-89\u7684\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\u4e3a \\(1 0100111\\)\uff0c\u53ef\u57fa\u4e8e \\(B2T_n\\) \u51fd\u6570\u6309\u6743\u5c55\u5f00\u590d\u539f\u8865\u7801\u7684\u771f\u503c\uff1a</p> \\[ \\begin{aligned}     &amp; B2T_8([0 1011001]) = -0\\ast2^7+1\\ast2^6+1\\ast2^4+1\\ast2^3+1\\ast2^0=-0+64+16+8+1=89 \\\\     &amp; B2T_8([1 0100111]) = -1\\ast2^7+1\\ast2^5+1\\ast2^2+1\\ast2^1+1\\ast2^0=-128+32+4+2+1=-89 \\end{aligned} \\] <p>\u8ba9\u6211\u4eec\u57fa\u4e8e \\(B2T_n\\) \u5c55\u5f00\u5f0f\uff0c\u91cd\u65b0\u63a8\u5bfc\u4e00\u4e0b \\(n\\) \u4f4d\u8865\u7801\u6240\u80fd\u8868\u793a\u7684\u53d6\u503c\u8303\u56f4\u3002</p> <ul> <li>\u6700\u5c0f\u503c\u662f\u4f4d\u5411\u91cf \\([10\\cdots0]\\)\uff0c\u53ea\u8bbe\u7f6e\u8d1f\u6743\uff0c\u5176\u4ed6\u6b63\u6743\u4f4d\u6e05\u96f6\uff0c\u6b64\u79cd\u60c5\u5f62\u8d1f\u5f97\u6700\u591a\uff0c\u5176\u6574\u6570\u503c\u4e3a \\(TMin_{n}\\dot=-2^{n-1}\\)\u3002</li> <li>\u5f53\u8bbe\u7f6e\u4e86\u8d1f\u6743\u65f6\uff0c\u8bbe\u7f6e\u5176\u4ed6\u6240\u6709\u6b63\u6743\u4f4d\uff0c\u4f4d\u5411\u91cf\u4e3a  \\([11\\cdots1]\\)\u3002\u6b64\u79cd\u60c5\u5f62\u6b63\u6743\u6253\u6ee1\uff08\u8d1f\u5f97\u6700\u5c11\uff09\uff0c\u5176\u6574\u6570\u503c\u4e3a \\(-2^{n-1}+\\sum_{i=0}^{n-2}x_i\\ast2^i=-2^{n-1}+(2^{n-1}-1)=-1\\)\uff0c\u5373\u6700\u5927\u8d1f\u6574\u6570\u3002</li> <li>\u6700\u5927\u503c\u662f\u4f4d\u5411\u91cf \\([01\\cdots1]\\)\uff0c\u6e05\u9664\u8d1f\u6743\uff08\u5373\u4e3a\u975e\u8d1f\u6570\uff09\uff0c\u6e05\u9664\u5176\u4ed6\u6240\u6709\u6b63\u6743\u4f4d\uff0c\u5176\u503c\u4e3a0\uff1b\u82e5\u8bbe\u7f6e\u5176\u4ed6\u6240\u6709\u6b63\u6743\u4f4d\uff0c\u5176\u6574\u6570\u503c\u4e3a \\(TMax_{n}\\dot=\\sum_{i=0}^{n-2}x_i\\ast2^i=2^{n-1}-1\\)\u3002</li> </ul> <p>\u4ee5\\(n=8\\)\u4e3a\u4f8b\uff0c\u4e00\u4e2a\u5b57\u8282\uff08byte\uff09\u7684\u8865\u7801\u7f16\u7801\u6240\u80fd\u8868\u793a\u6570\u503c\u8303\u56f4\u662f \\([-2^{8-1}, 2^{8-1}-1]\\)\uff0c\u5373 \\([-128, 127]\\)\uff0c\u5305\u542b128\u4e2a\u8d1f\u6570\uff08-128 - -1\uff09\u3001128\u4e2a\u975e\u8d1f\u6570\uff080 - 127\uff09\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u8865\u7801\u52a0\u6cd5","title":"\u8865\u7801\u52a0\u6cd5","text":"<p>\u6211\u4eec\u5728\u521d\u4e2d\u65f6\u4ee3\u5b66\u4e60\u521d\u7b49\u4ee3\u6570\u65f6\uff0c\u5c31\u5f15\u5165\u8d1f\u6570\u8fd9\u4e00\u91cd\u8981\u7684\u6982\u5ff5\u7528\u6765\u8868\u793a\u201c\u76f8\u53cd\u610f\u4e49\u7684\u91cf\u201d\u3002\u6709\u4e86\u8d1f\u6570\u7684\u6982\u5ff5\u540e\uff0c\u51cf\u6cd5\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u52a0\u6cd5\uff1a\u51cf\u53bb\u4e00\u4e2a\u6b63\u6570\u7684\u7b49\u6548\u8868\u8ff0\u662f\u52a0\u4e86\u4e00\u4e2a\u8d1f\u6570\u3002</p> <p>\u56de\u60f3\u8c03\u62e8\u949f\u8868\u7684\u4f8b\u5b50\uff0c\u5b9a\u4e49\u987a\u65f6\u9488\u4e3a\u6b63\uff08\u52a0\u6cd5\uff09\uff0c\u9006\u65f6\u9488\u4e3a\u8d1f\uff08\u51cf\u6cd5\uff09\u3002\u5047\u8bbe\u521d\u59cb\u523b\u5ea6\u4e3ax\uff0c\u51cf\u91cf\u4e3an\uff08n&gt;0\uff09\uff0c\u52a0\u91cf\u4e3a\u5176\u8865\u6570 (12-n)\uff0c\u663e\u7136\u6709 \\(x-n \\equiv x+(12-n) \\mod 12\\)\u3002\u4ee4 n=2\uff0c\u5728 mod12 \u7684\u949f\u8868\u76d8\u4e0a\uff0c\u9006\u65f6\u9488\u56de\u62e82\u683c\u7b49\u6548\u4e8e\u987a\u65f6\u9488\u62e8\u52a810\u683c\uff0c\u6b8a\u9014\u540c\u5f52\u3002</p> <p>\u8ba1\u7b97\u673a\u7684\u8868\u793a\u6cd5\u4f7f\u7528\u6709\u9650\u6570\u91cf\u7684\u4f4d\u5bf9\u4e00\u4e2a\u6570\u5b57\u7f16\u7801\uff0c\u5f53\u7ed3\u679c\u592a\u5927\u4ee5\u81f3\u4e0d\u80fd\u8868\u793a\u65f6\uff0c\u67d0\u4e9b\u8fd0\u7b97\u5c31 \u4f1a\u6ea2\u51fa\uff08overflow\uff09\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u8bf4\u8ba1\u7b97\u673a\u8fd0\u7b97\u4e5f\u662f\u4e00\u79cd\u6709\u6a21\u8fd0\u7b97\u3002\u5f53\u7136\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u4e0d\u662f\u50cf\u4e0a\u8ff0\u65f6\u949f\u4f8b\u5b50\u90a3\u6837\u4ee512\u4e3a\u6a21\uff0c\u5728\u5b9a\u70b9\u5c0f\u6570\u7684\u8865\u7801\u8868\u793a\u4e2d\u662f\u4ee5 \\(2\\) \u4e3a\u6a21\uff0c\u5728\u5b9a\u70b9\u6574\u6570\u4e2d\u5219\u4ee5 \\(2^n\\) \u4e3a\u6a21\uff08n=8,16,32,64,...\uff09\u3002</p> <p>\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u5728\u5b57\u5bbd\u5bb9\u91cf\uff08\u6a21\u6570\uff09\u8303\u56f4\u5185\uff0c\u8d1f\u6570\u7684\u8865\u7801\u8868\u793a\u662f\u5bf9\u6570\u503c\u4f4d\uff08\u6216\u7edd\u5bf9\u503c\uff09\u53d6\u53cd+1\uff0c\u201c\u53d6\u53cd\u201d\u5b9e\u9645\u4e0a\u5df2\u7ecf\u6697\u542b\u4e86\u51cf\u6cd5\uff0c\u201c+1\u201d \u5219\u5c06\u8865\u7801\u8fdb\u4e00\u6b65\u6362\u7b97\u6210\u4e86\u8865\u6570\u3002\u5047\u8bbe X&lt;0\uff0c\u5176\u8865\u7801\u4f4d\u5411\u91cf\u7684\u65e0\u7b26\u53f7\u503c  \\(\\overrightarrow{[X]_\u8865} = 2^n- \\lvert X \\rvert\\)\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\\(\\mod 2^n\\)\u3002\u5f53 n=8 \u65f6, \u5c31\u662f\\(\\mod 256\\)\u3002</p> <p>\u7c7b\u6bd4\u949f\u8868\u8c03\u62e8\uff0c\u51cf\u53bb\u6b63\u6570\u53ef\u89c6\u4f5c\u52a0\u4e0a\u8d1f\u6570\u7684\u8865\u7801\u3002\u8fd9\u6837\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u5c31\u4e0d\u7528\u5355\u72ec\u8bbe\u7f6e\u51cf\u6cd5\u5668\uff0c\u800c\u662f\u57fa\u4e8e\u8865\u7801\u4e00\u5f8b\u6309\u52a0\u6cd5\u8fd0\u7b97\u89c4\u5219\u5b9e\u73b0\u51cf\u6cd5\u7684\u7b49\u6548\u8ba1\u7b97\u3002\u5728\u8fd9\u4e00\u8fc7\u7a0b\u4e2d\uff0c\u64cd\u4f5c\u6570\u548c\u8fd0\u7b97\u7ed3\u679c\u90fd\u7edf\u4e00\u7528\u8865\u7801\u8868\u793a\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u8865\u7801\u7684\u6700\u9ad8\u7b26\u53f7\u4f4d\u7edf\u4e00\u6309\u7167\u8d1f\u6743\u89e3\u91ca\uff0c\u5373\u8865\u7801\u7684\u7b26\u53f7\u4f4d\u53ef\u89c6\u4f5c\u6574\u4f53\u6570\u503c\u7684\u4e00\u90e8\u5206\u3002\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u6765\u8bb2\uff0c\u7b26\u53f7\u4f4d\u76f4\u63a5\u53c2\u4e0e\u8fd0\u7b97\u8c8c\u4f3c\u4e5f\u662f\u89e3\u91ca\u5f97\u901a\u3002</p> \\[ [X]_\u8865+[Y]_\u8865= \\begin{cases}     X+(2^n+Y) &amp; \\equiv X+Y &amp; \\mod 2^n, \\set{X,Y|X\\gt0, Y\\lt0} \\\\     (2^n+X)+(2^n+Y) &amp; \\equiv X+Y &amp; \\mod 2^n, \\set{X,Y|X\\lt0, Y\\lt0}  \\end{cases} \\] <p>\u3010\u4f8b1\u3011\u5df2\u77e5X=+0000111\uff087\uff09\uff0cY=-0010011\uff08-19\uff09\uff0c\u6c42\u4e24\u6570\u7684\u8865\u7801\u4e4b\u548c\u3002</p> <ul> <li>\\([X]_\u8865=0 0000111\uff0c[Y]_\u8865=1 1101101\\)\uff0c\u4eba\u5de5\u8ba1\u7b97 Z=X+Y=7+(-19)=-12\uff08\u8865\u7801\u4e3a11110100\uff09\u3002</li> </ul> <p>\u82e5\u5c06 \\(\\overrightarrow{[Y]_\u8865}\\) \u4e5f\u89c6\u4f5c\u65e0\u7b26\u53f7\u6570=237\uff0c\u5c06\u8ba1\u7b97\u7ed3\u679cZ\u4e5f\u89c6\u4e3a\u65e0\u7b26\u53f7\u6570\\(\\overrightarrow{[Z]_\u8865}\\)=244\uff0c\u6ee1\u8db3 7+237=244\uff0c\u800c \\(244 \\equiv -12 \\mod 256\\)\u3002</p> <p>\u8fd8\u662f\u501f\u7528256\u5927\u7b28\u949f\u6765\u9610\u8ff0\uff0c\u521d\u59cb\u5728\u523b\u5ea67\u70b9\u5904\uff0c\u9006\u65f6\u9488\u56de\u62e819\u683c\u548c\u987a\u65f6\u9488\u62e8\u52a8237\u683c\uff0c\u6548\u679c\u90fd\u662f\u62e8\u5230\u523b\u5ea6244\u5904\u3002\u5f53\u91c7\u7528\u8865\u7801\u91cd\u65b0\u7f16\u7801\u523b\u5ea6\u540e\uff0c\u539f\u5148\u7684244\u70b9\u6620\u5c04\u4e3a\u5de6\u534a\u76d8\u7684-12\u70b9\u4f4d\u3002\u6362\u4e2a\u89d2\u5ea6\u6765\u8bf4\uff0c\u7531\u4e8e \\(\\lvert -19 \\rvert \\gt \\lvert 7 \\rvert\\)\uff0c\u8fd9\u91cc\u5f02\u53f7\u76f8\u52a0\uff0c\u8d1f\u6570\u5360\u4e3b\u5bfc\uff0c\u4e5f\u53ef\u4ee5\u60f3\u8c61\u4e3a\u521d\u59cb\u523b\u5ea6\u5728\u5de6\u534a\u76d8-19\u70b9\uff0c+7\u8868\u793a\u987a\u65f6\u9488\u62e8\u52a87\u683c\uff0c\u5c06\u62e8\u5230-12\u70b9\uff0c\u4ecd\u7136\u5728\u5de6\u534a\u76d8\uff08\u6ca1\u6709\u6ea2\u51fa\uff09\u3002</p> <p>\u8865\u7801\u53ef\u4ee5\u89c6\u4f5c\u65e0\u7b26\u53f7\u6570\u76f4\u63a5\u53c2\u4e0e\u7ad6\u5f0f\u6309\u4f4d\u52a0\u8ba1\u7b97\uff0c\u63a5\u4e0b\u6765\u91cd\u70b9\u770b\u770b\u8865\u7801\u52a0\u6cd5\u7684\u6ea2\u51fa\u95ee\u9898\u3001\u5224\u65ad\u53ca\u5904\u7406\u3002</p> <p>\u3010\u4f8b2\u3011\u5df2\u77e5X=+1000000\uff0864\uff09\uff0cY=+1000001\uff0865\uff09\uff0c\u6c42\u4e24\u6570\u7684\u8865\u7801\u4e4b\u548c\u3002</p> <ul> <li>\u76f4\u63a5\u5bf9\u8865\u7801\u5217\u7ad6\u5f0f\u8ba1\u7b97\u5982\u4e0b\uff1a</li> </ul> \\[ \\begin{array}{c|lcr} \\:\\:\\:\\:\\: &amp; \\: \\quad 0\\ 1 \\qquad\\qquad\\qquad  (C_fC_0)\\\\ \\:\\:\\:\\:\\: [X]_\u8865 &amp; \\qquad 0\\ 1000000 \\qquad (+64\u7684\u8865\u7801) \\\\ +) [Y]_\u8865 &amp; \\qquad 0\\ 1000001 \\qquad (+65\u7684\u8865\u7801)  \\\\ \\hline \\ &amp; \\qquad 1\\ 0000001  \\qquad 129 \\end{array} \\] <ul> <li>\u4e24\u4e2a\u6b63\u6570\u76f8\u52a0\uff0c\u7ed3\u679c\u4e3a\u8d1f\u6570\uff01\uff1f\u8865\u7801\u4e4b\u548c\u662f129\uff0c\u8d85\u51fa\u4e86 [0, 127]\uff0c\u5373\u4ea7\u751f\u4e86\u6ea2\u51fa\u73b0\u8c61\u3002\u6b64\u65f6\uff0c\u6570\u503c\u90e8\u5206\u5411\u7b26\u53f7\u4f4d\u4ea7\u751f\u8fdb\u4f4d\\(C_0=1\\)\uff0c\u7b26\u53f7\u4f4d\u672a\u5411\u9ad8\u4f4d\u4ea7\u751f\u8fdb\u4f4d \\(C_f=0\\)\u3002</li> </ul> <p>\u8fd9\u91cc\u4e24\u4e2a\u6b63\u6570\u76f8\u52a0\uff0c\u7ed3\u679c\u8d85\u51fa\u4e868\u4f4d\u8865\u7801\u7684\u975e\u8d1f\u6570\u8868\u793a\u8303\u56f4\u3002\u7ad6\u5f0f\u8ba1\u7b97\u7684\u7ed3\u679c\u4e3a\u4e8c\u8fdb\u5236\u4f4d\u5411\u91cf 10000001\uff0c\u65e0\u7b26\u53f7\u6570\u503c\u662f 129\uff0c\u8865\u7801\u8868\u793a\u7684\u771f\u503c\u4e3a-127\u3002</p> <p>\\(C_0=1\\) \u8868\u793a\u6709\u6ea2\u51fa\uff0c\u7b26\u53f7\u4f4d\u4ece\u6b63\u53d8\u6210\u8d1f\u3002</p> <p>\u8fd8\u662f\u501f\u7528256\u5927\u7b28\u949f\u6765\u9610\u8ff0\uff0c\u521d\u59cb\u5728\u523b\u5ea665\u70b9\u5904\uff0c\u987a\u65f6\u9488\u62e8\u52a864\u683c\u540e\u5c06\u5230129\u70b9\u3002\u4f46\u662f\uff0c\u5f53\u91c7\u7528\u8865\u7801\u8868\u793a\u65f6\uff0c129\u70b9\u8d8a\u8fc7\u53f3\u534a\u76d8\uff08\u53d6\u503c\u8303\u56f4\u4e3a[0,127]\uff09\u7684\u5206\u754c\u7ebf127\u70b9\u4e24\u683c\uff0c\u5bf9\u5e94\u5de6\u534a\u76d8\uff08\u53d6\u503c\u8303\u56f4\u4e3a[-128,-1]\uff09\u7684-127\u70b9\u4f4d\uff1a+127\u5de6\u6ea2\u4e00\u683c\u662f-128\uff0c\u518d\u5de6\u6ea2\u4e00\u683c\u662f-127\u3002</p> <p>\u7528\u4ee5\u4e0bC\u8bed\u8a00\u4ee3\u7801\u6d4b\u8bd5\u9a8c\u8bc1\uff0c\u8ba1\u7b97\u7ed3\u679cZ\u7684\u4f4d\u5411\u91cf\u4e3a0x81\uff08\u5373\u65e0\u7b26\u53f7\u6570129\uff09\uff0c\u8865\u7801\u5bf9\u5e94\u7684\u771f\u503c=\\(-127 \\equiv 129 \\mod 256\\)\u3002</p> signed+overflow.c<pre><code>    signed char X = 64;\n    signed char Y = 65;\n    signed char Z = X+Y;\n    printf(\"Z=0x%hhx, %hhd\\n\", Z, Z);\n</code></pre> <p>\u3010\u4f8b3\u3011\u5df2\u77e5X=-1111111\uff08-127\uff09\uff0cY=-0000010\uff08-2\uff09\uff0c\u8981\u6c42\u8fdb\u884c\u8865\u7801\u7684\u52a0\u6cd5\u8fd0\u7b97\u3002</p> <ul> <li>\u76f4\u63a5\u5bf9\u8865\u7801\u5217\u7ad6\u5f0f\u8ba1\u7b97\u5982\u4e0b\uff1a</li> </ul> \\[ \\begin{array}{c|lcr} \\:\\:\\:\\:\\: &amp; \\: \\quad 1\\ 0 \\qquad\\qquad\\qquad  (C_fC_0)\\\\ \\:\\:\\:\\:\\: [X]_\u8865 &amp; \\qquad 1\\ 0000001 \\qquad (-127\u7684\u8865\u7801\uff1a129) \\\\ +) [Y]_\u8865 &amp; \\qquad 1\\ 1111110 \\qquad (-2\u7684\u8865\u7801\uff1a254)  \\\\ \\hline \\ &amp; \\qquad 0\\ 1111111  \\qquad 127 \\end{array} \\] <ul> <li>\u4e24\u4e2a\u8d1f\u6570\u76f8\u52a0\uff0c\u7ed3\u679c\u4e3a\u6b63\u6570\uff01\uff1f\u9884\u671f\u7684\u7ed3\u679c-129\u8d85\u51fa\u4e868\u4f4d\u8865\u7801\u6240\u80fd\u8868\u793a\u7684\u8d1f\u6570\u8303\u56f4 [-128, -1]\uff0c\u5373\u4ea7\u751f\u4e86\u6ea2\u51fa\u73b0\u8c61\u3002\u6b64\u65f6\uff0c\u6570\u503c\u90e8\u5206\u5411\u7b26\u53f7\u4f4d\u672a\u4ea7\u751f\u8fdb\u4f4d \\(C_0=0\\)\uff0c\u7b26\u53f7\u4f4d\u5411\u9ad8\u4f4d\u4ea7\u751f\u8fdb\u4f4d \\(C_f=1\\)\u3002</li> </ul> <p>\u8fd9\u91cc\u4e24\u4e2a\u8d1f\u6570\u76f8\u52a0\uff0c\u7ed3\u679c\u8d85\u51fa\u4e868\u4f4d\u8865\u7801\u7684\u8d1f\u6570\u8868\u793a\u8303\u56f4\uff0c\u6ea2\u51fa\u5230\u4e86\u6b63\u6570\u533a\u3002\u7ad6\u5f0f\u8ba1\u7b97\u7684\u7ed3\u679c\u4e3a\u4e8c\u8fdb\u5236\u4f4d\u5411\u91cf 01111111\uff0c\u65e0\u7b26\u53f7\u6570\u503c\u5373\u5176\u8865\u7801\u771f\u503c\u4e3a127\u3002</p> <p>\\(C_f=1\\) \u8868\u793a\u6709\u6ea2\u51fa\uff0c\u7b26\u53f7\u4f4d\u4ece\u8d1f\u53d8\u6210\u6b63\u3002</p> <p>\u7531\u4e8e \\(\\lvert -127 \\rvert \\gt \\lvert -2 \\rvert\\)\uff0c\u8fd9\u91cc\u7684\u8d1f\u8d1f\u76f8\u52a0\uff0c-127\u5360\u4e3b\u5bfc\u3002\u8fd8\u662f\u501f\u7528256\u5927\u7b28\u949f\u6765\u9610\u8ff0\uff0c\u5f53\u91c7\u7528\u8865\u7801\u91cd\u65b0\u7f16\u7801\u523b\u5ea6\u540e\uff0c\u60f3\u8c61\u521d\u59cb\u523b\u5ea6\u5de6\u534a\u76d8-127\u70b9\u5904\uff0c-2\u8868\u793a\u9006\u65f6\u9488\u62e8\u52a82\u683c\uff0c\u8d8a\u8fc7\u5de6\u534a\u76d8\u5206\u754c\u7ebf-128\u70b9\u4e00\u683c\uff0c\u5bf9\u5e94\u53f3\u534a\u76d8\uff08\u53d6\u503c\u8303\u56f4\u4e3a[0,127]\uff09\u7684127\u70b9\u4f4d\uff1a-127\u53f3\u6ea2\u4e00\u683c\u662f-128\uff0c\u518d\u53f3\u6ea2\u4e00\u683c\u662f+127\u3002</p> \\[ [X]_\u8865+[Y]_\u8865=(2^n+X)+(2^n+Y)  \\equiv X+Y \\mod 2^n \\\\ [-127]_{\u88658}+[-2]_{\u88658}=(256+(-127)) + (256+(-2)) = \\\\ 129+254 = 383 \\mod 256 \\equiv 127 \\] <p>\u7528\u4ee5\u4e0bC\u8bed\u8a00\u4ee3\u7801\u6d4b\u8bd5\u9a8c\u8bc1\uff0c\u8ba1\u7b97\u7ed3\u679cZ\u7684\u4f4d\u5411\u91cf\u4e3a0x7f\uff0c\u8865\u7801\u5bf9\u5e94\u7684\u771f\u503c\u662f127\uff08383\u6ea2\u9664\u6a21256\uff09\u3002</p> signed-overflow.c<pre><code>    signed char X = -127;\n    signed char Y = -2;\n    signed char Z = X+Y;\n    printf(\"Z=0x%hhx, %hhd\\n\", Z, Z);\n</code></pre> <p>\u3010\u4f8b4\u3011\u5df2\u77e5X=-0000011\uff08-3\uff09\uff0cY=-0000010\uff08-2\uff09\uff0c\u8981\u6c42\u8fdb\u884c\u8865\u7801\u7684\u52a0\u6cd5\u8fd0\u7b97\u3002</p> <ul> <li>\u76f4\u63a5\u5bf9\u8865\u7801\u5217\u7ad6\u5f0f\u8ba1\u7b97\u5982\u4e0b\uff1a</li> </ul> \\[ \\begin{array}{c|lcr} \\:\\:\\:\\:\\: &amp; \\: \\quad 1\\ 1 \\qquad\\qquad\\qquad  (C_fC_0)\\\\ \\:\\:\\:\\:\\: [X]_\u8865 &amp; \\qquad 1\\ 1111101 \\qquad (-3\u7684\u8865\u7801\uff1a253) \\\\ +) [Y]_\u8865 &amp; \\qquad 1\\ 1111110 \\qquad (-2\u7684\u8865\u7801\uff1a254)  \\\\ \\hline \\ &amp; \\qquad 1\\ 1111011  \\qquad (-5\u7684\u8865\u7801\uff1a251) \\end{array} \\] <ul> <li>\u76f4\u63a5\u8865\u7801\u8fd0\u7b97\u4ea7\u751f\u7684\u7ed3\u679c\u7684\u65e0\u7b26\u53f7\u6570\u503c\u662f251\uff0c\u6b63\u662f\u9884\u671f\u7ed3\u679c-5\u7684\u8865\u7801\uff01\u6b64\u65f6\uff0c\u6570\u503c\u90e8\u5206\u5411\u7b26\u53f7\u4f4d\u4ea7\u751f\u8fdb\u4f4d \\(C_0=1\\)\uff0c\u7b26\u53f7\u4f4d\u5411\u9ad8\u4f4d\u4ea7\u751f\u8fdb\u4f4d \\(C_f=1\\)\u3002</li> </ul> <p>\u76f4\u89c2\u5224\u65ad\uff0c\u4e24\u4e2a\u5c0f\u8d1f\u6570\u76f8\u52a0\u4e0d\u4f1a\u6ea2\u51fa\u3002\u4ece\u5355\u4e2a\u6ea2\u51fa\u4f4d\u5224\u65ad\uff1a</p> <ol> <li>\u4e24\u4e2a\u8d1f\u6570\u76f8\u52a0\uff0c\u603b\u4f1a\u5bfc\u81f4 \\(C_f=1\\)\uff0c\u7b26\u53f7\u4f4d\u4ece\u8d1f\u53d8\u6210\u6b63\u3002</li> <li>\u7136\u540e \\(C_0=1\\)\uff0c\u7b26\u53f7\u4f4d\u53c8\u4ece\u6b63\u53d8\u6210\u8d1f\u3002</li> </ol> <p>\u6240\u4ee5\uff0c\u6574\u4f53\u4e0a\uff0c\u7b26\u53f7\u4f4d\u8fd8\u662f\u4fdd\u6301\u4e3a\u8d1f\uff0c\u5373\u6ca1\u6709\u6ea2\u51fa\u3002 \u4e0b\u9762\u6765\u4ece\u6570\u7406\u89d2\u5ea6\u6765\u5177\u4f53\u63a8\u5bfc\u4e00\u4e0b\u6ea2\u51fa\u5224\u65ad\u903b\u8f91\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u6ea2\u51fa\u5224\u65ad","title":"\u6ea2\u51fa\u5224\u65ad","text":"<p>\u4e0b\u9762\u57fa\u4e8e8\u4f4d\u8865\u7801\uff0c\u6839\u636e\u7b26\u53f7\u7684\u5f02\u540c\u6027\uff0c\u8be6\u7ec6\u8ba8\u8bba\u4e0a\u9762\u56db\u4e2a\u4f8b\u5b50\u5bf9\u5e94\u7684\u7b26\u53f7\u7ec4\u5408\uff08<code>+\u3001-</code>\u3001<code>+\u3001+</code>\u3001<code>-\u3001-</code>\uff09\u65f6\u8865\u7801\u52a0\u6cd5\u7684\u6ea2\u51fa\u6761\u4ef6\u53ca\u5224\u65ad\u903b\u8f91\u3002</p> <p>s1\u3001s2 \u4e3a\u8865\u7801\u6700\u9ad8\u7b26\u53f7\u4f4d\uff0c\u53d6\u503c0\u62161\u3002 x\u3001y \u5206\u522b\u4e3a X\u3001Y \u9664\u7b26\u53f7\u4f4d\u7684\u5176\u4ed6\u6570\u503c\u4f4d\u7684\u771f\u503c\u3002</p> <p>\u200b\u3010\u4f8b1\u3011\u4e00\u6b63\u4e00\u8d1f\uff1a\u5047\u8bbe s1=1,s2=0, \u6309\u6743\u5c55\u5f00\u76f8\u52a0 \\(B2T_8(X)+B2T_8(Y) = (-2^7+x)+y = -2^7+(x+y)\\)</p> \\[ 0 \\le x,y \\le 2^7-1 \\to 0 \\le x+y \\le 2^8-2 \\implies \\\\ -2^7 \\le B2T_8(X)+B2T_8(Y) \\le 2^7-2 \\\\  \\] <ul> <li>\u7ed3\u679c Z \u7684\u5bf9\u5e94\u533a\u95f4\u4e3a [-128, 126]\uff0c\u4e0d\u4f1a\u4ea7\u751f\u6ea2\u51fa\u3002</li> <li>\u53e6\u5916\uff0cs1+s2=1\uff0c\u5f53 \\(C_0=0\\) \u65f6\uff0c\\(C_f=0\\)\uff1b\u5f53 \\(C_0=1\\) \u65f6\uff0c\\(C_f=1\\)\u3002</li> </ul> <p>\u3010\u4f8b2\u3011\u4e24\u4e2a\u6b63\u6570\uff1as1=s2=0\uff0c\u6309\u6743\u5c55\u5f00\u76f8\u52a0 B2T_8(X)+B2T_8(Y) = x+y</p> \\[ 0 \\le x,y \\le 2^7-1 \\to 0 \\le x+y \\le 2^8-2 \\implies \\\\ 0 \\le B2T_8(X)+B2T_8(Y) \\le 2^8-2\uff0c \\] <ul> <li>\u7ed3\u679c Z \u7684\u5bf9\u5e94\u533a\u95f4\u4e3a [0, 254] = [0,127]+[128,254]\uff0c\u5f53\u7ed3\u679c\u843d\u5165 [128,254] \u65f6\uff0c\u6709\u7b26\u53f7\u8865\u7801\u771f\u503c\u6ea2\u51fa\u4e3a\u8d1f\u503c\uff1a\\(Z \\mod 256 \\equiv Z-256\\) \u5bf9\u5e94\u533a\u95f4 [-128, -2]\u3002</li> <li> <p>\u53e6\u5916\uff0cs1+s2=0\uff0c\u6211\u4eec\u6765\u770b\u770b\u8fdb\u4f4d\u60c5\u51b5\uff1a</p> <ul> <li>\u5f53 x+y \u5c0f\u4e8e\u6216\u7b49\u4e8e\u6700\u5927\u6b63\u6570127\uff080b11111111\uff09\u65f6\uff0c\u65e0\u6ea2\u51fa\uff0c\u6b64\u65f6 \\(C_0=0\\)\uff0c\\(C_f=0\\)\u3002</li> <li>\u5f53 x+y \u5927\u4e8e\u6700\u5927\u6b63\u6570127\uff080b11111111\uff09\u65f6\uff0c\u6ea2\u51fa\u4e3a\u8d1f\uff0c\u6b64\u65f6 \\(C_0=1\\)\uff0c\\(C_f=0\\)\u3002</li> </ul> </li> </ul> <p>\u3010\u4f8b3\u3011\u4e24\u4e2a\u8d1f\u6570\uff0cs1=s2=1\uff0c\u6309\u6743\u5c55\u5f00\u76f8\u52a0 \\(B2T_8(X)+B2T_8(Y) = (-2^7+x)+(-2^7+y) = -2^8+(x+y)\\)</p> \\[ 0 \\le x,y \\le 2^7-1 \\to 0 \\le x+y \\le 2^8-2 \\implies \\\\ -2^8 \\le B2T_8(X)+B2T_8(Y) \\le -2 \\] <ul> <li>\u7ed3\u679c Z \u7684\u5bf9\u5e94\u533a\u95f4\u4e3a [-256, -2] = [-256,-129]+[-128,-2]\uff0c\u5f53\u7ed3\u679c\u843d\u5165 [-256,-129] \u65f6\uff0c\u6709\u7b26\u53f7\u8865\u7801\u771f\u503c\u6ea2\u51fa\u4e3a\u6b63\u503c\uff1a\\(Z \\mod 256 \\equiv Z+256\\) \u5bf9\u5e94\u533a\u95f4 [0, 127]\u3002</li> <li> <p>\u53e6\u5916\uff0cs1+s2=0\uff08\\(C_f=1\\)\uff09\uff0c\u6211\u4eec\u6765\u770b\u770b\u8fdb\u4f4d\u60c5\u51b5\uff1a</p> <ul> <li>\u5f53\u6570\u503c\u90e8\u5206\u548c\uff08x+y\uff09\u5c0f\u4e8e\u7b49\u4e8e127\uff08\u5c0f\u4e8e128\uff09\u65f6\uff0c\\(Z \\le -128\\)\uff0c\u6ea2\u51fa\u4e3a\u6b63\uff0c\u6b64\u65f6 \\(C_0=0\\)\u3002</li> <li>\u5f53\u6570\u503c\u90e8\u5206\u548c\uff08x+y\uff09\u5927\u4e8e127\uff08\u5927\u4e8e\u7b49\u4e8e128\uff09\u65f6\uff0c\\(Z \\gt -128\\)\uff0c\u65e0\u6ea2\u51fa\uff0c\u6b64\u65f6 \\(C_0=1\\)\u3002</li> </ul> </li> </ul> <p>\u4ee5\u4e0a\u4f8b1\u548c\u4f8b4\u4e2d\uff0c8\u4f4d\u6b63\u6570\u4e4b\u548c\u30018\u4f4d\u8d1f\u6570\u4e4b\u548c\u672a\u8d85\u51fa8\u4f4d\u8865\u7801\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u65f6\uff0c\u6ca1\u6709\u4ea7\u751f\u6ea2\u51fa\uff0c\u7ed3\u679c\u6b63\u786e\u3002\u6b64\u65f6\uff0c\u6ee1\u8db3 \\(C_0=C_f\\)\uff0c\u540c\u65f6\u4e3a0\u6216\u540c\u65f6\u4e3a1\u3002 \u4ee5\u4e0a\u4f8b2\u548c\u4f8b3\u4e2d\uff0c8\u4f4d\u6b63\u6570\u4e4b\u548c\u30018\u4f4d\u8d1f\u6570\u4e4b\u548c\u8d85\u51fa8\u4f4d\u8865\u7801\u8868\u793a\u7684\u6570\u503c\u8303\u56f4\u65f6\uff0c\u4ea7\u751f\u4e86\u6ea2\u51fa\uff0c\u7ed3\u679c\u9519\u8bef\u3002\u6b64\u65f6\uff0c\u6ee1\u8db3 \\(C_0 \\ne C_f\\)\uff0c\u4e00\u4e2a\u4e3a0\u4e14\u4e00\u4e2a\u4e3a1\u3002</p> <p>\u7efc\u5408\u4ee5\u4e0a\uff0c\u53ef\u7528\u903b\u8f91\u5f02\u6216\u8868\u8fbe\u5f0f \\(\\boxed{OF = C_f \\oplus C_0}\\) \u6765\u68c0\u9a8c\u8865\u7801\u52a0\u6cd5\u7684\u6ea2\u51fa\u60c5\u51b5\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u6269\u5c55\u4e00\u4e2a\u6570\u5b57\u7684\u4f4d\u8868\u793a","title":"\u6269\u5c55\u4e00\u4e2a\u6570\u5b57\u7684\u4f4d\u8868\u793a","text":"<p>\u4e00\u4e2a\u5e38\u89c1\u7684\u8fd0\u7b97\u662f\u5728\u4e0d\u540c\u5b57\u957f\u7684\u6574\u6570\u4e4b\u95f4\u8f6c\u6362\uff0c\u540c\u65f6\u53c8\u4fdd\u6301\u6570\u503c\u4e0d\u53d8\u3002\u8003\u8651\u4ece\u4e00\u4e2a\u8f83\u5c0f\u7684\u6570\u636e\u7c7b\u578b\u8f6c\u6362\u5230\u4e00\u4e2a\u8f83\u5927\u7684\u7c7b\u578b\uff0c\u5373\u6269\u5927\u4f4d\u5bbd\u3002</p> <p>\u8981\u5c06\u4e00\u4e2a\u65e0\u7b26\u53f7\u6570\u8f6c\u6362\u6210\u4e00\u4e2a\u66f4\u5927\u7684\u6570\u636e\u7c7b\u578b\u65f6\uff0c\u53ea\u8981\u7b80\u5355\u5730\u5728\u5f00\u5934\u6dfb\u52a00\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u539f\u6570\u503c\u7684\u5b57\u8282\u4fdd\u6301\u5728\u4f4e\uff08\u6743\uff09\u4f4d\u4e0d\u53d8\uff0c\u5728\u65b0\u589e\u7684\u9ad8\uff08\u6743\uff09\u4f4d\u88650\u3002</p> <p>\u8981\u5c06\u4e00\u4e2a\u8865\u7801\u6570\u5b57\u8f6c\u6362\u4e3a\u4e00\u4e2a\u66f4\u5927\u7684\u6570\u636e\u7c7b\u578b\uff0c\u53ef\u4ee5\u6267\u884c\u4e00\u4e2a\u7b26\u53f7\u6269\u5c55\uff08sign extension\uff09\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u539f\u6570\u503c\u7684\u5b57\u8282\u4fdd\u6301\u5728\u4f4e\uff08\u6743\uff09\u4f4d\u4e0d\u53d8\uff0c\u5728\u65b0\u589e\u7684\u9ad8\uff08\u6743\uff09\u4f4d\u590d\u5236\u7b26\u53f7\u4f4d\u3002</p> <ol> <li>\u5bf9\u4e8e\u6b63\u6570\uff0c\u9ad8\u4f4d\u590d\u5236\u7b26\u53f7\u4f4d0\uff0c\u4e0d\u5f71\u54cd\u5176\u771f\u503c\u3002</li> <li>\u5bf9\u4e8e\u8d1f\u6570\uff0c\u9ad8\u4f4d\u590d\u5236\u7b26\u53f7\u4f4d1\uff0c\u4e5f\u4e0d\u5f71\u54cd\u771f\u503c\u3002</li> </ol> <p>\u8003\u8651\u8d1f\u6570\u7684\u8865\u7801\u4f4d\u5411\u91cf \\(\\vec{x} = [x_{n-1}, x_{n-2} ,\\dotsc, x_0]\\)\uff0c\u5176\u7f16\u7801\u6620\u5c04\u5982\u4e0b\uff1a</p> \\[ B2T_n(\\vec{x}) \\dot=-x_{n-1}\\ast2^{n-1} + \\sum_{i=0}^{n-2}x_i\\ast2^i \\] <p>\u5f53\u590d\u5236\u9ad8\u7b26\u53f7\u4f4d \\(x_{n-1}\\) \u65f6\uff0c\u4f4d\u5411\u91cf \\(\\vec{x'} = [{ \\underline{x_{n-1} ,\\dotsc, x_{n-1}} }, x_{n-1}, x_{n-2} ,\\dotsc, x_0]\\)\uff0c\u5219\u6709 \\(B2T_n(\\vec{x}) = B2T_{n'}(\\vec{x'})\\)\u3002</p> <p>\u4ee5-89\u4e3a\u4f8b\uff0c\u51768\u4f4d\u8865\u7801\u4f4d\u5411\u91cf\u4e3a\\([1 0100111]\\)\uff0c\u5c06\u5176\u7b26\u53f7\u6269\u5c55\u4e3a16\u4f4d\u7684\u4f4d\u5411\u91cf\u4f4d\\([{ 11111111 } 10100111]\\)\uff1a</p> \\[ \\begin{aligned} &amp; B2T_8([1 0100111]) = -1\\ast2^7+1\\ast2^5+1\\ast2^2+1\\ast2^1+1\\ast2^0 \\\\ &amp; B2T_{16}([{ 11111111 } 10100111]) =-1\\ast2^{15}+1\\ast2^{14}+\\cdots+1\\ast2^8+1\\ast2^7+1\\ast2^5+1\\ast2^2+1\\ast2^1+1\\ast2^0 \\end{aligned} \\] <p>\u8bbe\u8865\u7801\u9664\u7b26\u53f7\u4f4d\u540e\u7684\u4f4d\u6570\u503c\u4e3av\uff0c\u5219</p> \\[ \\begin{aligned} &amp; B2T_8([1 0100111]) =-1\\ast2^7+v \\\\ &amp; B2T_{16}([{ 11111111 } 10100111]) =-1\\ast2^{15}+1\\ast2^{14}+\\cdots+1\\ast2^8+1\\ast2^7+v \\end{aligned} \\] <p>\u66f4\u8fdb\u4e00\u6b65\u6709\uff1a</p> \\[ \\begin{aligned} B2T_{16}([{ 11111111 } 10100111]) &amp; = 2^8(-2^7+2^6+\\cdots+2^0)+2^7+v \\\\                                                     &amp; = 2^8(-2^7+(2^7-1))+2^7+v \\\\                                                    &amp; = -2^8+2^7+v \\\\                                                    &amp; = -2^7+v \\end{aligned} \\] <p>\u5bf9\u6bd4\u53ef\u77e5\uff0c\u7b26\u53f7\u6269\u5c55\u524d\u540e\u7684\u8865\u7801\u6240\u8868\u793a\u7684\u771f\u503c\u4e0d\u53d8\u3002</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u6709\u7b26\u53f7\u6570\u548c\u65e0\u7b26\u53f7\u6570\u4e4b\u95f4\u7684\u8f6c\u6362","title":"\u6709\u7b26\u53f7\u6570\u548c\u65e0\u7b26\u53f7\u6570\u4e4b\u95f4\u7684\u8f6c\u6362","text":"<p>C\u8bed\u8a00\u5141\u8bb8\u5728\u5404\u79cd\u4e0d\u540c\u7684\u6570\u636e\u7c7b\u578b\u4e4b\u95f4\u505a\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u53d8\u91cfx\u58f0\u660e\u4e3aint\uff0cu\u58f0\u660e\u4e3aunsigned\u3002\u8868\u8fbe\u5f0f <code>(unsigned)x</code> \u4f1a\u5c06x\u7684\u503c\u8f6c\u6362\u4e3a\u4e00\u4e2a\u65e0\u7b26\u53f7\u6570\u503c\uff0c\u800c <code>(int)u</code> \u5c06u\u7684\u503c\u8f6c\u6362\u4e3a\u4e00\u4e2a\u6709\u7b26\u53f7\u6574\u6570\u3002</p> <p>\u8003\u8651\u4ee5\u4e0b\u4ee3\u7801\uff1a</p> signed-convertion.c<pre><code>    short int v = -12345;\n    unsigned short uv = (unsigned short)v;\n    printf(\"v=%hd, uv=%hu\\n\", v, uv);\n    printf(\"v=0x%hx, uv=0x%hx\\n\", v, uv);\n</code></pre> <p>\u5728\u4e00\u53f0\u91c7\u7528\u8865\u7801\u7684\u673a\u5668\u4e0a\uff0c\u4e0a\u8ff0\u4ee3\u7801\u8fd0\u884c\u8f93\u51fa\uff1a</p> <pre><code>v=-12345, uv=53191\nv=0xcfc7, uv=0xcfc7\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u7684\u7ed3\u679c\u4fdd\u6301\u4f4d\u5411\u91cf\uff08\u4f4d\u6a21\u7ec4\uff09\u4e0d\u53d8\uff0c\u53ea\u662f\u6539\u53d8\u4e86\u89e3\u91ca\u8fd9\u4e9b\u4f4d\u7684\u65b9\u5f0f\u3002 v=-12345 \u7684\u8865\u7801\u8868\u793a\u548c uv=53191 \u7684\u65e0\u7b26\u53f7\u8868\u793a\u662f\u5b8c\u5168\u4e00\u6837\u7684\u3002</p> <p>\u4ee5\u4e0a\u4ee3\u7801\u7247\u6bb5\u793a\u4f8b\u6f14\u793a\u4e86\u8d1f\u6570\u8865\u7801\u8f6c\u6362\u6210\u65e0\u7b26\u53f7\u6570\u3002\u5bf9\u4e8e\u8d1f\u6570\uff0c\u8865\u7801\u4e2d\u6700\u9ad8\u4f4d\u4f5c\u4e3a\u7b26\u53f7\u4f4d\uff0c\u672c\u6765\u89e3\u91ca\u4e3a\u8d1f\u6743 \\(-2^{n-1}\\)\uff0c\u6309\u7167\u65e0\u7b26\u53f7\u89e3\u91ca\u4e3a\u6b63\u6743\u6570\u503c\u4f4d  \\(2^{n-1}\\)\u3002\u7531\u4e8e\u540e\u9762\u4f4d\u7684\u6570\u503c \\(v\\) \u4fdd\u6301\u4e0d\u53d8\uff0c\u76f8\u5f53\u4e8e\u5728\u8865\u7801\u8868\u793a\u7684\u771f\u503c\u57fa\u7840\u4e0a\u52a0\u4e0a \\(2^n\\)\u3002</p> <p>\u5bf9\u6ee1\u8db3 \\(TMin_n \\le x \\le TMax_n\\) \u7684 \\(x\\) \u6709\uff1a</p> \\[ T2U_n(x)= \\begin{cases}         x, &amp; x\\ge0 \\\\         2^n+x\uff082^n- \\lvert x \\rvert\uff09, &amp; x&lt;0 \\end{cases} \\] <p>\u7b80\u5355\u63a8\u5bfc\u5982\u4e0b\uff1a</p> \\[ \\begin{aligned} B2U_n(x) - B2T_n(x) &amp; = (2^{n-1}+v)-(-2^{n-1}+v) = 2\\ast2^{n-1}=2^n \\\\ &amp; \\implies B2U_n(x) = B2T_n(x) + 2^n \\end{aligned} \\] <p>\u4f8b\u5982\uff1a\\(T2U_{16}(-12345) = -12345+2^{16}=53191\\)\u3002</p> <p>\u540c\u7406\uff0c\u65e0\u7b26\u53f7\u6570\u7684\u6700\u9ad8\u4f4d\u89e3\u91ca\u4e3a\u6b63\u6743\u6570\u503c\u4f4d  \\(2^{n-1}\\)\uff0c\u5f53\u5c06\u5176\u4f4d\u5411\u91cf\u89e3\u91ca\u6210\u8865\u7801\u65f6\uff0c\u6700\u9ad8\u4f4d\u5c06\u4f5c\u4e3a\u7b26\u53f7\u4f4d\uff0c\u89e3\u91ca\u4e3a\u8d1f\u6743 \\(-2^{n-1}\\)\u3002\u7531\u4e8e\u540e\u9762\u4f4d\u7684\u6570\u503c \\(v\\) \u4fdd\u6301\u4e0d\u53d8\uff0c\u76f8\u5f53\u4e8e\u5728\u65e0\u7b26\u53f7\u771f\u503c\u57fa\u7840\u4e0a\u51cf\u53bb \\(2^n\\)\u3002</p> <p>\u5bf9\u6ee1\u8db3 \\(0 \\le u \\le UMax_n\\) \u7684 \\(u\\) \u6709\uff1a</p> \\[ U2T_n(u)= \\begin{cases}         u, &amp; u \\le TMax_n \\\\         u - 2^n, &amp; u&gt;TMax_n \\end{cases} \\] <p>\u5bf9\u4e8e \\(n=8\\)\uff0c\u5f53 \\(u \\le TMax_n = 127\\) \u65f6\uff0c\u5373 \\(0 \\le u \\le 127\\)\uff0c\u521a\u597d\u843d\u51658\u4f4d\u8865\u7801\u6240\u80fd\u8868\u793a\u7684\u975e\u8d1f\u6570\u533a\u95f4 \uff1b\u5f53 \\(u \\gt TMax_n = 127\\) \u65f6\uff0c\u4f8b\u5982 \\(128 \\le u \\le 255\\)\uff0c\u5219\u539f\u59cb\u9ad8\u4f4d1\u53d8\u6210\u8d1f\u53f7\uff0c\u8865\u7801\u91ca\u4e49\u4e3a\u8d1f\u6570\u3002\u539f\u6765\u4f4d\u5411\u91cf\u6309\u65e0\u7b26\u53f7\u89e3\u91ca\u51fa\u7684\u771f\u503c\u9700\u51cf\u53bb \\(2^8=256\\)\uff0c\u6362\u7b97\u51fa\u6309\u8865\u7801\u89e3\u91ca\u7684\u6b63\u786e\u771f\u503c\uff0c\u5bf9\u5e94\u8d1f\u6570\u533a\u95f4 \\([-1, -128]\\)\u3002</p> <p>\u5728\u6570\u8f74\u4e0a\u628a\u6709\u7b26\u53f7\u6570\u548c\u65e0\u7b26\u53f7\u6570\u753b\u51fa\u6765\u7684\u8bdd\uff0c\u5c31\u80fd\u5f88\u6e05\u6670\u7684\u770b\u51fa\u76f8\u5bf9\u7684\u5173\u7cfb\uff1a</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#signed_arithmetic_overflow","title":"signed arithmetic overflow","text":"<p>C Basic Types - Binary Representions:</p> <p>TAKEAWAY 5.49 The same value may have different binary representations.</p> <p>The following two functions are basically all that is needed to interpret unsigned values as signed values:</p> is_signed_less.c<pre><code># inclue &lt;limits.h&gt;\n\nbool is_negative(unsigned a) {\n    unsigned const int_max = UINT_MAX/2;\n    return a &gt; int_max;\n}\n\nbool is_signed_less(unsigned a, unsigned b) {\n    if (is_negative(b) &amp;&amp; !is_negative(a)) return false;\n    else return a &lt; b;\n}\n</code></pre> <p>C\u8bed\u8a00\u6807\u51c6\u4e0e\u5b9e\u73b0\u4e4b\u6574\u6570\u7c7b\u578b:</p> <p>\u4e0b\u9762\u7684\u4ee3\u7801\u8bd5\u56fe\u4ece\u5927\u5230\u5c0f\u6253\u5370 [0\uff0c99] \u533a\u95f4\u5185\u7684\u6240\u6709\u6574\u6570\uff0c\u8bf7\u601d\u8003\u53ef\u80fd\u5b58\u5728\u7684\u95ee\u9898\u3002</p> unsigned-decrement-gteq.c<pre><code>unsigned i;\nfor (i = 99; i &gt;= 0; --i)\n    printf(\"%u\\n\", i);\n</code></pre> <p>\u4ee5\u4e0b\u662f\u300aC\u8bed\u8a00\u6df1\u5ea6\u89e3\u5256\uff08\u7b2c2\u7248\uff09\u300b\u9644\u5f55\u4e2d\u7684 C \u8bed\u8a00\u57fa\u7840\u6d4b\u8bd5\u98985\uff0c\u8bf7\u601d\u8003\u8f93\u51fa\u7ed3\u679c\u3002</p> signed-char-array.c<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char* arg[]) {\n    signed char a[1000];\n    int i;\n    for (i = 0; i&lt;1000; i++)\n        a[i] = -1-i;\n    printf(\"%lu\", strlen((const char*)a));\n\n    return 0;\n}\n</code></pre> <p>C Basic Types - Binary Representions:</p> <p>TAKEAWAY 5.50 Unsigned arithmetic wraps nicely.</p> <pre><code>/*incremented up to UINT_MAX and then wraps around to 0*/\nfor (unsigned i = 1; i; ++i) do_something();\n</code></pre> <p>TAKEAWAY 5.57 Signed arithmetic may trap badly.</p> <p>Where unsigned values are forced to wrap around, the behavior of a signed over\ufb02ow is unde\ufb01ned.</p> <pre><code>for (signed i = 1; i; ++i) do_something();\n</code></pre> <p>The as-if Rule (takeaway 5.8) allows it to optimize the second loop to an <code>while(true)</code> in\ufb01nite loop.</p> <p>TAKEAWAY 5.56 It is your responsibility to avoid unde\ufb01ned behavior of all operations.</p> <p>C++ Standard - Data Types</p> <p>ISO/IEC-N4950 - 6.8.2 Fundamental types</p> <p>signed arithmetic overflow</p> <p>Unsigned arithmetic does not overflow. Overflow for signed arithmetic yields undefined behavior (7.1).</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20230217/signedness-representation/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>\u300a\u6df1\u5165\u7406\u89e3\u8ba1\u7b97\u673a\u7cfb\u7edf\u300b\uff08\u7b2c3\u7248\uff09 \u300a\u8ba1\u7b97\u673a\u7ec4\u6210\u539f\u7406\u300b\uff08\u7b2c3\u7248\uff09\uff0c\u5510\u6714\u98de \u300a\u5fae\u673a\u539f\u7406\u4e0e\u63a5\u53e3\u6280\u672f\u300b\uff08\u7b2c2\u7248\uff09\uff0c\u738b\u514b\u4e49 \u300a\u6c47\u7f16\u8bed\u8a00\u7a0b\u5e8f\u8bbe\u8ba1\u300b\uff08\u7b2c4\u7248\uff09\uff0c\u6587\u5168\u521a</p> <p>\u6df1\u5165\u8c08\u8c08\u4e8c\u8fdb\u5236 \u8865\u7801\u8868\u793a\u6cd5\u7684\u672c\u8d28\u539f\u7406 \u3010\u8bfb\u8584 CSAPP\u3011\u58f9 \u6570\u636e\u8868\u793a \u4ece\u6676\u4f53\u7ba1\u5f00\u59cb\u804a\u804a\u8ba1\u7b97\u673a\u4e3a\u4ec0\u4e48\u91c7\u7528\u4e8c\u8fdb\u5236</p>","tags":["signedness","binary_representation","complement"]},{"location":"blog/20211013/struct-alignment-specify/","title":"Struct Alignment Specify","text":"<p>\u5728\u4e0a\u4e00\u7bc7\u300aStruct Alignment Rule\u300b\u4e2d\uff0c\u6211\u4eec\u68b3\u7406\u4e86\u7ed3\u6784\u4f53\u5b58\u50a8\u5e03\u5c40\u7684\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\u89c4\u5219\u3002 \u672c\u7bc7\u4ecb\u7ecd\u901a\u8fc7\u7f16\u8bd1\u5668 gcc/msvc \u63d0\u4f9b\u7684\u6269\u5c55\u7279\u6027\u53ca C/C++ \u63d0\u4f9b\u7684\u4e00\u4e9b\u8bed\u8a00\u7279\u6027\u6765\u4fee\u6539\u9ed8\u8ba4\u7684\u5bf9\u9f50\u53c2\u6570\uff0c\u5e76\u6d4b\u8bd5\u5206\u6790\u5176\u4f5c\u7528\u6548\u679c\u3002</p> <ol> <li>The <code>packed</code> attribute specifies that a structure member should have the smallest possible alignment.</li> <li>The <code>aligned</code> attribute specifies a minimum alignment for the variable or structure field, measured in bytes.</li> <li><code>-fpack-struct[=n]</code>/<code>#pragma pack(n)</code> specifies the maximum alignment, structure members can potentially be unaligned.</li> </ol>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment-specify/#gccmsvc_align_spec","title":"gcc/msvc align spec","text":"<p>GCC\u00a0specific Common Variable Attributes\u00a0\u63d0\u4f9b\u4e86\u5c5e\u6027\u4fee\u9970\u58f0\u660e <code>__attribute__</code>\uff0c\u652f\u6301\u5b9a\u4e49\u53d8\u91cf\u7684\u5b58\u50a8\u5e03\u5c40\u4e3a <code>packed</code>\uff0c\u6216\u901a\u8fc7 <code>aligned [(n)]</code> \u6539\u53d8\u9ed8\u8ba4\u5bf9\u9f50\u5b57\u8282\u6570\u3002</p> <ol> <li> <p>The <code>packed</code> attribute specifies that a structure member should have the smallest possible alignment\u2014one bit for a bit-field and one byte otherwise, unless a larger value is specified with the <code>aligned</code> attribute. The attribute does not apply to non-member objects.</p> <ul> <li><code>struct __attribute__((__packed__))</code> \u76f8\u5f53\u4e8e <code>-fpack-struct</code>\uff0c\u5f00\u542f Packed alignment mode\uff0c\u6309 1 \u5b57\u8282\u5bf9\u9f50\uff08without holes\uff09\uff0csatisfies weakest alignment requirement\u3002</li> </ul> </li> <li> <p>The <code>aligned</code> attribute specifies a minimum alignment for the variable or structure field, measured in bytes. When specified, alignment must be an integer constant power of 2. Specifying no alignment argument implies the maximum alignment for the target, which is often, but by no means always, 8 or 16 bytes.</p> <ul> <li>\u5f53 <code>__attribute__((aligned))</code> \u4e0d\u6307\u5b9a\u53c2\u6570\u65f6\uff0c\u76f8\u5f53\u4e8e Natural alignment mode\uff0c\u91c7\u7528\u9ed8\u8ba4\u7684 default maximum alignment \u5bf9\u9f50\u7b56\u7565\u3002</li> </ul> </li> </ol> <p>align (C++) - Microsoft Specific</p> <p>Use <code>__declspec(align(n))</code> to precisely control the alignment of user-defined data (for example, static allocations or automatic data in a function).</p> <ul> <li>\u53c2\u8003 x64 structure alignment examples\u3002</li> </ul> <pre><code>#define CACHE_LINE  32\n#define CACHE_ALIGN __declspec(align(CACHE_LINE))\n\nstruct CACHE_ALIGN S1 { // cache align all instances of S1\n   int a, b, c, d;\n};\nstruct S1 s1;   // s1 is 32-byte cache aligned\n\n// sizeof(struct S2) = 16\n__declspec(align(8)) struct S2 {\n   int a, b, c, d;\n};\n\n// sizeof(struct S3) = 64.\nstruct S3 {\n   struct S1 s1;   // S3 inherits cache alignment requirement\n                  // from S1 declaration\n   int a;         // a is now cache aligned because of s1\n                  // 28 bytes of trailing padding\n};\n\n// sizeof(struct S4) = 64.\nstruct S4 {\n   int a;\n   // 28 bytes padding\n   struct S1 s1;      // S4 inherits cache alignment requirement of S1\n};\n</code></pre> <p>related topics:</p> <ul> <li>c - The advantage of using __attribute__((aligned( )))</li> <li>visual c++ - Cross-platform ALIGN(x) macro?</li> </ul>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment-specify/#gcc_-fpack-struct","title":"gcc -fpack-struct","text":"<p>GCC specific Options for Code Generation Conventions\u00a0\u652f\u6301\u7f16\u8bd1\u9009\u9879\u00a0<code>-fpack-struct[=n]</code> \u6307\u5b9a\u7ed3\u6784\u4f53\u4e2d\u6210\u5458\u53d8\u91cf\u7684\u5bf9\u9f50\u5b57\u8282\u6570\u3002</p> <p>Without a value specified, pack all structure members together without holes. When a value is specified (which must be a small power of two), pack structure members according to this value, representing the maximum alignment (that is, objects with default alignment requirements larger than this are output potentially unaligned at the next fitting location).</p> <p>\u5f53\u4e0d\u6307\u5b9a\u53c2\u6570\u65f6\uff0c<code>-fpack-struct</code> \u76f8\u5f53\u4e8e <code>struct __attribute__((__packed__))</code>\uff0c\u6ee1\u8db3 weakest alignment requirement\uff0c\u6309 1 \u5b57\u8282\u5bf9\u9f50\u3002</p> <p>Data structure alignment: Alternatively, one can pack the structure, omitting the padding, which may lead to slower access, but uses three quarters as much memory.</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment-specify/#pragma_pack","title":"#pragma pack","text":"<p>GCC - Structure-Layout Pragmas pack pragma | Microsoft Learn</p> <ul> <li><code>#pragma pack(show)</code>: Displays the current byte value for packing alignment. The value is displayed by a warning message.</li> </ul> <p><code>#pragma pack(show)</code> \u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>#pragma pack(show)\n\nint main(int argc, char *argv[])\n{\n    return 0;\n}\n</code></pre> <p>macOS\uff08Intel x86_64\u3001Apple Silicon arm64\uff09\u4e0b clang/llvm-gcc \u7f16\u8bd1\u8f93\u51fa\u8b66\u544a\uff1a</p> <pre><code>$ cc -S pack-show.c\npack-show.c:1:9: warning: value of #pragma pack(show) == 8\n#pragma pack(show)\n        ^\n1 warning generated.\n</code></pre> <p>rpi4b-ubuntu/arm64 \u4e0b GCC \u4e0d\u652f\u6301\u9884\u7f16\u8bd1\u6307\u4ee4\u9009\u9879 <code>show</code>\u3002</p> <p>MSVC \u548c GCC \u7b49\u7f16\u8bd1\u5668\u4e2d\u90fd\u652f\u6301\u901a\u8fc7\u9884\u7f16\u8bd1\u5904\u7406\u6307\u4ee4\u00a0<code>#pragma pack(n)</code>\u00a0\u6765\u6539\u53d8\u7f16\u8bd1\u5668\u7684\u9ed8\u8ba4\u5bf9\u9f50\u65b9\u5f0f\u3002</p> <p>pack pragma | Microsoft Learn</p> <p>To pack a class is to place its members directly after each other in memory. It can mean that some or all members can be aligned on a boundary smaller than the default alignment of the target architecture. <code>pack</code> gives control at the data-declaration level. \u5728 GCC \u4e2d\uff0c\u5bf9\u4e8e <code>#pragma pack(n)</code> \u4e2d\u7684\u7ed3\u6784\u4f53\u800c\u8a00\uff0c\u76f8\u5f53\u4e8e <code>-fpack-struct[=n]</code>\uff0c\u6307\u5b9a maximum alignment \u5bf9\u9f50\u7b56\u7565\uff0c\u53ef\u80fd\u5c0f\u4e8e\u9ed8\u8ba4\u7684\u5bf9\u9f50\u53c2\u6570\u3002</p> <pre><code>#pragma pack(n)\n\n// to be packed\n\n#pragma pack()\n</code></pre> <p>\u5728 <code>#pragma pack(n)</code>\u00a0\u548c <code>#pragma pack()</code>\u00a0\u4e4b\u95f4\u7684\u4ee3\u7801\u5c06\u6309 <code>n</code> \u5b57\u8282\u5bf9\u9f50\u3002</p> <p>\u6210\u5458\u5bf9\u9f50\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u6761\u4ef6\uff0c\u5373\u6bcf\u4e2a\u6210\u5458\u6309\u81ea\u5df1\u7684\u65b9\u5f0f\u5bf9\u9f50\uff0c\u4e5f\u5c31\u662f\u8bf4\u867d\u7136\u6307\u5b9a\u4e86\u6309 n \u5b57\u8282\u5bf9\u9f50\uff0c\u4f46\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6210\u5458\u90fd\u662f\u4ee5 n \u5b57\u8282\u5bf9\u9f50\u3002\u5176\u5bf9\u9f50\u7684\u89c4\u5219\u662f\uff1a\u6bcf\u4e2a\u6210\u5458\u6309\u5176\u7c7b\u578b\u7684\u5bf9\u9f50\u53c2\u6570\uff08\u901a\u5e38\u662f\u8fd9\u4e2a\u7c7b\u578b\u7684\u5927\u5c0f\uff09\u548c\u6307\u5b9a\u5bf9\u9f50\u53c2\u6570\uff08\u8fd9\u91cc\u662fn\u5b57\u8282\uff09\u4e2d\u8f83\u5c0f\u7684\u4e00\u4e2a\u5bf9\u9f50\uff0c\u5373 <code>min(n, sizeof(item))</code>\uff0c\u5e76\u4e14\u7ed3\u6784\u7684\u957f\u5ea6\u5fc5\u987b\u4e3a\u6240\u7528\u8fc7\u7684\u6240\u6709\u5bf9\u9f50\u53c2\u6570\u7684\u6574\u6570\u500d\uff0c\u4e0d\u591f\u5c31\u586b\u5145\u5b57\u8282\u3002</p> <ol> <li>\u5982\u679c n &gt;= sizeof(item)\uff0c\u6210\u5458\u53d8\u91cf\u6309\u9ed8\u8ba4\u7684\u5bf9\u9f50\u65b9\u5f0f\uff0c\u5373\u6309\u7167\u5176 size \u5bf9\u9f50\uff0c\u7ed3\u6784\u5bf9\u9f50\u540e\u7684\u603b\u5927\u5c0f\u5fc5\u987b\u662f\u6210\u5458\u4e2d\u6700\u5927\u7684\u5bf9\u9f50\u53c2\u6570\u7684\u6574\u6570\u500d\uff0c\u8fd9\u6837\u5728\u5904\u7406\u6570\u7ec4\u65f6\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e00\u9879\u90fd\u8fb9\u754c\u5bf9\u9f50\u3002</li> <li>\u5982\u679c n &lt; sizeof(item)\uff0c\u6210\u5458\u53d8\u91cf\u7684\u504f\u79fb\u91cf\u53d6 n \u7684\u500d\u6570\uff0c\u4e0d\u7528\u6ee1\u8db3\u9ed8\u8ba4\u7684\u5bf9\u9f50\u65b9\u5f0f\uff0c\u7ed3\u6784\u7684\u603b\u5927\u5c0f\u5fc5\u987b\u4e3a n \u7684\u500d\u6570\u3002</li> </ol> <p>\u9ed8\u8ba4 n=8\uff0c\u6ee1\u8db3\u7b2c\u4e00\u79cd\u60c5\u51b5\u7684\u81ea\u7136\u5bf9\u9f50\uff1b\u5f53 n&gt;8\uff0c\u4e0d\u518d\u6709\u5b9e\u9645\u5f71\u54cd\u3002</p> <p>\u4e0b\u9762\u4e3e\u4f8b\u8bf4\u660e\u901a\u8fc7 <code>#pragma pack(n)</code> \u6307\u5b9a n&lt;8 \u65f6\uff0c\u5bf9\u7ed3\u6784\u5b58\u50a8\u5e03\u5c40\u7684\u5f71\u54cd\u3002</p> <pre><code>#pragma pack(push)\n#pragma pack(4)\n\nstruct st_cdi\n{\n    char c;\n    double d;\n    int i;\n};\n\n#pragma pack(pop)\n</code></pre> <ol> <li>\u9996\u5148\uff0c\u4e3ac\u5206\u914d\u7a7a\u95f4\uff0c\u5176\u504f\u79fb\u91cf\u4e3a0\uff0c\u6ee1\u8db3n=4\u5b57\u8282\u5bf9\u9f50\u65b9\u5f0f\uff0cc\u53601\u4e2a\u5b57\u8282\u3002</li> <li>\u5176\u6b21\uff0c\u4e3ad\u5206\u914d\u7a7a\u95f4\uff0c\u8fd9\u65f6\u5176\u504f\u79fb\u91cf\u4e3a1\uff0c\u9700\u586b\u88653\u4e2a\u5b57\u8282\uff0c\u5bf9\u9f50n=4\uff08\u4e0d\u5fc5\u6309sizeof(double)=8 \u5bf9\u9f50\uff09\uff0cd\u53608\u4e2a\u5b57\u8282\u3002</li> <li>\u6700\u540e\uff0c\u4e3ai\u5206\u914d\u7a7a\u95f4\uff0c\u8fd9\u65f6\u5176\u504f\u79fb\u91cf\u4e3a12\uff0c\u6ee1\u8db3\u4e3an=4\u7684\u500d\u6570\uff0ci\u53604\u4e2a\u5b57\u8282\u3002</li> <li>\u4e09\u4e2a\u6210\u5458\u5171\u5206\u914d\u4e8616\u4e2a\u5b57\u8282\uff0c\u6ee1\u8db3\u4e3an=4\u7684\u500d\u6570\uff0c\u6545 sizeof(st_cdi) = 16\u3002</li> </ol> <p>\u5982\u679c\u628a\u00a0<code>#pragma\u00a0pack(4)</code>\u00a0\u6539\u4e3a\u00a0<code>#pragma\u00a0pack(16)</code>\uff0c\u90a3\u4e48\u7ed3\u6784\u7684\u5927\u5c0f\u5c31\u662f n&gt;8 \u81ea\u7136\u5bf9\u9f50\u4e0b\u768424\uff0c\u76f8\u5f53\u4e8e\u4e0d\u53d7\u5f71\u54cd\u3002</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment-specify/#test_alignment","title":"test alignment","text":"<p>\u4ee5\u4e0b\u6d4b\u8bd5\u4ee3\u7801 struct-packed-aligned.c\uff0c\u7efc\u5408\u6d4b\u8bd5\u901a\u8fc7\u6307\u5b9a <code>__attribute__</code> \u548c <code>#pragma pack</code> \u6539\u53d8\u7ed3\u6784\u4f53\u9ed8\u8ba4\u5bf9\u9f50\u65b9\u5f0f\u7684\u4f5c\u7528\u6548\u679c\u3002</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment-specify/#program","title":"Program","text":"<ol> <li> <p>\u53ef\u6267\u884c <code>cpp struct-packed-aligned.c</code>\uff08\u6216 <code>gcc -E</code>\uff09\u67e5\u770b\u5b8f <code>DEFINE_STRUCT_PAIR</code> / <code>DEFINE_STRUCT_ALIGNED</code> \u7684\u5c55\u5f00\u7ed3\u679c\u3002</p> </li> <li> <p>DEFINE_STRUCT_PAIR \u7ed9\u7ed3\u6784\u4f53\u5b9a\u4e49\u52a0\u4e0a\u5c5e\u6027\u9650\u5b9a <code>__attribute__((__packed__))</code> \u5b9a\u4e49 <code>StructName##_packed</code>\uff08MyStruct1_packed\uff0cMyStruct2_packed\uff09\uff0c\u4e0d\u8003\u8651\u6210\u5458\u53d8\u91cf\u7684\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\uff0c\u5404\u6210\u5458\u53d8\u91cf\u4f9d\u5e8f\u81ea\u7136\u7d27\u51d1\u6392\u5217\uff0c\u5176\u5927\u5c0f\u662f\u5404\u4e2a\u6210\u5458 sizeof \u4e4b\u548c\u3002</p> </li> <li> <p>DEFINE_STRUCT_ALIGNED \u6307\u5b9a <code>__attribute__((aligned(16)))</code> \u5b9a\u4e49 <code>struct MyStruct4_aligned</code>\uff0c\u540e\u8005\u5fc5\u987b\u6ee1\u8db3\u6574\u4f53\u5927\u5c0f\u4e3a n=16 \u7684\u500d\u6570\uff0csizeof \u6d4b\u7b97\u7ed3\u679c\u4e3a 32\u3002</p> </li> </ol> struct-packed-aligned.c <pre><code>#include &lt;stddef.h&gt;     // size_t, max_align_t, offsetof\n#include &lt;stdalign.h&gt;   // alignof, alignas\n#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\nstruct Readout\n{\n    char hour;  // [0:23]\n    int value;\n    char seq;   // sequence mark ['a':'z']\n};\n\n// __attribute__ ((__packed__))\n// struct's members are packed closely together,\n// but the internal layout of its s member is not packed\n#define DEFINE_STRUCT_PAIR(StructName, StructBody) \\\n    struct StructName StructBody \\\n    struct __attribute__((__packed__)) StructName##_packed StructBody\n#define GET_PACKED_SIZE(StructName) sizeof(struct StructName##_packed)\n#define GET_SIZE(StructName) sizeof(struct StructName)\n\n// aligned (alignment): specifies a minimum alignment\n#define DEFINE_STRUCT_ALIGNED(n, StructName, StructBody) \\\n    struct __attribute__((aligned(n))) StructName##_aligned StructBody\n#define GET_ALIGNED_SIZE(StructName) sizeof(struct StructName##_aligned)\n\nDEFINE_STRUCT_PAIR(MyStruct1, {\n    double d;\n    char c;\n    int i;\n};)\n\nDEFINE_STRUCT_PAIR(MyStruct2, {\n    char c;\n    double d;\n    int i;\n};)\n\n#pragma pack(push, 4)\nstruct MyStruct3\n{\n    char c;\n    double d;\n    int i;\n};\n#pragma pack(pop)\n\nDEFINE_STRUCT_ALIGNED(4, MyStruct3, {\n    char c;\n    double d;\n    int i;\n};)\n\n#pragma pack(push, 16)\nstruct MyStruct4\n{\n    char c;\n    double d;\n    int i;\n};\n#pragma pack(pop)\n\n// on a 16-byte boundary.\nDEFINE_STRUCT_ALIGNED(16, MyStruct4, {\n    char c;\n    double d;\n    int i;\n};)\n\nint main(int argc, char *argv[])\n{\n    printf(\"sizeof pointer=%zu\\n\", sizeof(void *));\n\n    printf(\"alignof(char)=%zu\\n\", alignof(char));\n    printf(\"alignof(short)=%zu\\n\", alignof(short));\n    printf(\"alignof(int)=%zu\\n\", alignof(int));\n    printf(\"alignof(long)=%zu\\n\", alignof(long));\n    printf(\"alignof(long long)=%zu\\n\", alignof(long long));\n    printf(\"alignof(double)=%zu\\n\", alignof(double));\n\n    size_t ma = alignof(max_align_t);\n    printf(\"alignof(max_align_t)=%zu\\n\", ma);\n\n    puts(\"----------------------------------------\");\n\n    printf(\"sizeof(Readout)=%zu, alignof(Readout)=%zu\\n\",\n            sizeof(struct Readout), alignof(struct Readout));\n\n    printf(\"sizeof(MyStruct1)=%zu,%zu, alignof(MyStruct1)=%zu\\n\",\n        GET_PACKED_SIZE(MyStruct1), GET_SIZE(MyStruct1),\n        alignof(struct MyStruct1));\n    printf(\"sizeof(MyStruct2)=%zu,%zu, alignof(MyStruct2)=%zu\\n\",\n        GET_PACKED_SIZE(MyStruct2), GET_SIZE(MyStruct2),\n        alignof(struct MyStruct2));\n\n    struct MyStruct2 ms2;\n    printf(\"MyStruct2 offsets: c=%zu, d=%zu, i=%zu\\n\",\n        offsetof(struct MyStruct2, c),\n        offsetof(struct MyStruct2, d),\n        (uintptr_t)&amp;ms2.i - (uintptr_t)&amp;ms2);\n\n    printf(\"sizeof(MyStruct3): pack(4)=%zu, aligned(4)=%zu\\n\",\n        sizeof(struct MyStruct3),\n        GET_ALIGNED_SIZE(MyStruct3));\n    printf(\"alignof(MyStruct3): pack(4)=%zu, aligned(4)=%zu\\n\",\n        alignof(struct MyStruct3),\n        alignof(struct MyStruct3_aligned));\n\n    printf(\"sizeof(MyStruct4): pack(16)=%zu, aligned(16)=%zu\\n\",\n        sizeof(struct MyStruct4),\n        GET_ALIGNED_SIZE(MyStruct4));\n    printf(\"alignof(MyStruct4): pack(16)=%zu, aligned(16)=%zu\\n\",\n        alignof(struct MyStruct4),\n        alignof(struct MyStruct4_aligned));\n\n    return 0;\n}\n</code></pre> <p>mbpa1398-macOS/x86_64\u3001mbpa2991-macOS/arm64 \u548c rpi4b-ubuntu/aarch64 LP64 \u6570\u636e\u6a21\u5f0f\u4e0b\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code># cc struct-packed-aligned.c -o struct-packed-aligned &amp;&amp; ./struct-packed-aligned\n$ cc struct-packed-aligned.c -o struct-packed-aligned -g -fno-eliminate-unused-debug-types &amp;&amp; ./struct-packed-aligned\nsizeof pointer=8\nalignof(char)=1\nalignof(short)=2\nalignof(int)=4\nalignof(long)=8\nalignof(long long)=8\nalignof(double)=8\nalignof(max_align_t)=8 (comment: 16 for x86_64 and aarch64)\n----------------------------------------\nsizeof(Readout)=12, alignof(Readout)=4\nsizeof(MyStruct1)=13,16, alignof(MyStruct1)=8\nsizeof(MyStruct2)=13,24, alignof(MyStruct2)=8\nMyStruct2 offsets: c=0, d=8, i=16\nsizeof(MyStruct3): pack(4)=16, aligned(4)=24\nalignof(MyStruct3): pack(4)=4, aligned(4)=8\nsizeof(MyStruct4): pack(16)=24, aligned(16)=32\nalignof(MyStruct4): pack(16)=8, aligned(16)=16\n</code></pre>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment-specify/#interpretation","title":"Interpretation","text":"<p>\u8fd0\u884c\u8c03\u8bd5\uff1a</p> <ol> <li>\u7f16\u8bd1\u6dfb\u52a0 <code>-g</code> \u9009\u9879\u751f\u6210\u8c03\u8bd5\u4fe1\u606f\uff0c\u6dfb\u52a0 <code>-fno-eliminate-unused-debug-types</code>\uff1b</li> <li><code>gdb struct-packed-aligned</code> \u8fdb\u5165 GDB Console\uff0c\u6267\u884c <code>start</code> \u542f\u52a8\u8fd0\u884c\u3002</li> </ol> <p>\u7ed3\u679c\u5206\u6790\uff1a</p> <ol> <li> <p>struct Readout\u3001MyStruct1\u3001MyStruct2\uff0c\u91c7\u7528 default natural alignment \u5bf9\u9f50\u7b56\u7565\uff0c\u9075\u5faa\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\u3002</p> <p>gdb ptype /o MyStruct3</p> <pre><code>(gdb) ptype /o struct Readout\n/* offset      |    size */  type = struct Readout {\n/*      0      |       1 */    char hour;\n/* XXX  3-byte hole      */\n/*      4      |       4 */    int value;\n/*      8      |       1 */    char seq;\n/* XXX  3-byte padding   */\n\n                            /* total size (bytes):   12 */\n                            }\n(gdb) ptype /o struct MyStruct1\n/* offset      |    size */  type = struct MyStruct1 {\n/*      0      |       8 */    double d;\n/*      8      |       1 */    char c;\n/* XXX  3-byte hole      */\n/*     12      |       4 */    int i;\n\n                            /* total size (bytes):   16 */\n                            }\n(gdb) ptype /o struct MyStruct2\n/* offset      |    size */  type = struct MyStruct2 {\n/*      0      |       1 */    char c;\n/* XXX  7-byte hole      */\n/*      8      |       8 */    double d;\n/*     16      |       4 */    int i;\n/* XXX  4-byte padding   */\n\n                            /* total size (bytes):   24 */\n                            }\n</code></pre> </li> <li> <p>\u5bf9\u4e8e MyStruct3\uff1a<code>#pragma pack(4)</code>\uff0c\u6307\u5b9a maximum alignment=4 &lt; default\uff0calignof=min{n, default}=n=4\uff0cd \u4e0d\u9075\u4ece\u81ea\u7136\u5bf9\u9f50\uff0csizeof=16\u3002</p> <p>gdb ptype /o MyStruct3</p> <pre><code>(gdb) ptype /o struct MyStruct3\n/* offset      |    size */  type = struct MyStruct3 {\n/*      0      |       1 */    char c;\n/* XXX  3-byte hole      */\n/*      4      |       8 */    double d;\n/*     12      |       4 */    int i;\n\n                            /* total size (bytes):   16 */\n                            }\n</code></pre> </li> <li> <p>\u5bf9\u4e8e MyStruct3_aligned (4)\uff1a\u6307\u5b9a minimum alignment=4 &lt; default\uff0calignof=max{n, default}=default=8\uff0c\u7ed3\u6784\u4f53\u6309\u81ea\u7136\u5bf9\u9f50\uff0csizeof=24\u3002</p> <p>gdb ptype /o MyStruct3_aligned</p> <pre><code>(gdb) ptype /o struct MyStruct3_aligned\n/* offset      |    size */  type = struct MyStruct3_aligned {\n/*      0      |       1 */    char c;\n/* XXX  7-byte hole      */\n/*      8      |       8 */    double d;\n/*     16      |       4 */    int i;\n/* XXX  4-byte padding   */\n\n                            /* total size (bytes):   24 */\n                            }\n</code></pre> </li> <li> <p>\u5bf9\u4e8e MyStruct4\uff1a<code>#pragma pack(16)</code>\uff0c\u6307\u5b9a maximum alignment=16 &gt; default\uff0calignof=min{n, default}=default=8\uff0c\u7ed3\u6784\u4f53\u6309\u81ea\u7136\u5bf9\u9f50\uff0csizeof=24\u3002</p> <p>gdb ptype /o MyStruct4</p> <pre><code>(gdb) ptype /o struct MyStruct4\n/* offset      |    size */  type = struct MyStruct4 {\n/*      0      |       1 */    char c;\n/* XXX  7-byte hole      */\n/*      8      |       8 */    double d;\n/*     16      |       4 */    int i;\n/* XXX  4-byte padding   */\n\n                            /* total size (bytes):   24 */\n                            }\n</code></pre> </li> <li> <p>\u5bf9\u4e8e MyStruct4_aligned (16)\uff1a\u6307\u5b9a minimum alignment=16 &gt; default\uff0calignof=max{n, default}=n=16\uff0c\u7ed3\u6784\u4f53\u6309\u81ea\u7136\u5bf9\u9f50\uff0c\u5e76\u4e14\u603b\u5927\u5c0f\u5fc5\u987b\u4e3a 16 \u7684\u500d\u6570\uff0c\u6545 sizeof=32\u3002</p> <p>gdb ptype /o MyStruct4_aligned</p> <pre><code>(gdb) ptype /o struct MyStruct4_aligned\n/* offset      |    size */  type = struct MyStruct4_aligned {\n/*      0      |       1 */    char c;\n/* XXX  7-byte hole      */\n/*      8      |       8 */    double d;\n/*     16      |       4 */    int i;\n/* XXX 12-byte padding   */\n\n                            /* total size (bytes):   32 */\n                            }\n</code></pre> </li> </ol>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/","title":"Struct Alignment Rule","text":"<p>An object doesn't just need enough storage to hold its representation. In addition, on some machine architectures, the bytes used to hold it must have proper alignment for the hardware to access it ef\ufb01ciently.</p> <p>Where alignment most often becomes visible is in object layouts: sometimes structs contain \"<code>holes</code>\" to improve alignment.</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#struct_padding_holes","title":"struct padding holes","text":"","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#tcpl","title":"TCPL","text":"<p>Excerpt from C Programming Language, 2nd Edition - 1988.</p> <p>6.4 Pointers to Structures</p> <p>Don't assume, however, that the size of a structure is the sum of the sizes of its members. Because of alignment requirements for different objects, there may be unnamed \"<code>holes</code>\" in a structure. Thus, for instance, if a char is one byte and an int four bytes, the structure.</p> <pre><code>struct {\n    char c;\n    int i;\n};\n</code></pre> <p>might well require eight bytes, not five. The <code>sizeof</code> operator returns the proper value.</p> <p>6.5 Self-referential Structures</p> <p>objects of certain types must satisfy alignment restrictions</p> <p>Alignment requirements can generally be satisfied easily, at the cost of some wasted space, by ensuring that the allocator always returns a pointer that meets all alignment restrictions.</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#tcpl_1","title":"TC++PL","text":"<p>Excerpt from The C++ Programming Language(4e)-2013.</p> <ol> <li>Types and Declarations | 6.2 Types | 6.2.9 Alignment</li> </ol> <p>An object doesn't just need enough storage to hold its representation. In addition, on some machine architectures, the bytes used to hold it must have proper alignment for the hardware to access it ef\ufb01ciently (or in extreme cases to access it at all). For example, a 4-byte <code>int</code> often has to be aligned on a word (4-byte) boundary, and sometimes an 8-byte <code>double</code> has to be aligned on a word (8-byte) boundary. Of course, this is all very implementation speci\ufb01c, and for most programmers completely implicit. You can write good C++ code for decades without needing to be explicit about alignment. Where alignment most often becomes visible is in object layouts: sometimes structs contain \"<code>holes</code>\" to improve alignment.</p> <p>The <code>alignof</code> operator returns the alignment of its argument expression.</p> <ol> <li>Structures, Unions, and Enumerations | 8.2 Structures | 8.2.1 struct Layout</li> </ol> <p>An object of a struct holds its members in the order they are declared. For example, we might store primitive equipment readout in a structure like this:</p> <pre><code>struct Readout {\n    char hour;  // [0:23]\n    int value;\n    char seq;   // sequence mark ['a':'z']\n};\n</code></pre> <p>You could imagine the members of a <code>Readout</code> object laid out in memory like this:</p> struct Readout packed layout <p>Members are allocated in memory in declaration order, so the address of <code>hour</code> must be less than the address of <code>value</code>. See also \u00a78.2.6.</p> <p>However, the size of an object of a struct is not necessarily the sum of the sizes of its members. This is because many machines require objects of certain types to be allocated on architecture dependent boundaries or handle such objects much more ef\ufb01ciently if they are. For example, integers are often allocated on word boundaries. On such machines, objects are said to have to be properly aligned (\u00a76.2.9). This leads to \"<code>holes</code>\" in the structures. A more realistic layout of a <code>Readout</code> on a machine with 4-byte int would be:</p> struct Readout aligned layout <p>In this case, as on many machines, <code>sizeof(Readout)</code> is 12, and not 6 as one would naively expect from simply adding the sizes of the individual members.</p> <p>You can minimize wasted space by simply ordering members by size (largest member \ufb01rst). For example:</p> <pre><code>struct Readout {\n    int value;\n    char hour;  // [0:23]\n    char seq;   // sequence mark ['a':'z']\n};\n</code></pre> struct Readout optimized layout <p>Note that this still leaves a 2-byte \"<code>hole</code>\" (unused space) in a <code>Readout</code> and <code>sizeof(Readout)==8</code>. The reason is that we need to maintain alignment when we put two objects next to each other, say, in an array of <code>Readout</code>s. The size of an array of 10 <code>Readout</code> objects is <code>10\u2217sizeof(Readout)</code>.</p> <p>It is usually best to order members for readability and sort them by size only if there is a demonstrated need to optimize.</p> <p>Use of multiple access speci\ufb01ers (i.e., <code>public</code>, <code>private</code>, or <code>protected</code>) can affect layout (\u00a720.5).</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#struct_alignment_rule","title":"struct alignment rule","text":"<p>\u5728\u4e0a\u4e00\u8282 Memory Address Alignment \u4e2d\uff0c\u63d0\u5230\u4e86\u57fa\u7840\u7c7b\u578b\uff08basic/fundamental types\uff09\u7684\u81ea\u7136\u5bf9\u9f50\u89c4\u5219\uff08natural alignment rule\uff09\uff1a\u4efb\u4f55 \\(K\\) \u5b57\u8282\u7684\u57fa\u672c\u5bf9\u8c61\u7684\u5b58\u50a8\u5730\u5740\u5fc5\u987b\u662f \\(K\\) \u7684\u500d\u6570\u3002</p> <p>\u7ed3\u6784\u4f53\u6210\u5458\u53d8\u91cf\u7684\u5b58\u653e\u5730\u5740\u4e5f\u6709\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\uff1a\u5728\u9ed8\u8ba4\u7f16\u8bd1\u914d\u7f6e\u4e0b\uff0c\u6210\u5458\u53d8\u91cf\u5b58\u653e\u7684\u5730\u5740\u76f8\u5bf9\u7ed3\u6784\u4f53\u8d77\u59cb\u5730\u5740\u7684\u504f\u79fb\u91cf\u4e5f\u5fc5\u987b\u6ee1\u8db3\u81ea\u7136\u5bf9\u9f50\uff0c\u5373\u504f\u79fb\u91cf\u4e3a\u8be5\u6210\u5458\u53d8\u91cf\u81ea\u8eab\u7c7b\u578b\u5927\u5c0f\u7684\u500d\u6570\u3002</p> <p>\u5404\u6210\u5458\u53d8\u91cf\u5728\u5b58\u653e\u7684\u65f6\u5019\u6839\u636e\u5728\u7ed3\u6784\u4f53\u4e2d\u58f0\u660e\u7684\u987a\u5e8f\u4f9d\u6b21\u7533\u8bf7\u7a7a\u95f4\uff0c\u540c\u65f6\u6309\u7167\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\u539f\u5219\u8c03\u6574\u5b58\u653e\u4f4d\u7f6e\uff08\u5730\u5740\uff09\uff0c\u7a7a\u7f3a\u7684\u5b57\u8282\u4f1a\u81ea\u52a8\u586b\u5145\u3002</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#largest_member_\ufb01rst","title":"largest member \ufb01rst","text":"<p>\u4e0b\u9762\u4ee5 <code>struct st_dci</code> \u4e3a\u4f8b\u6765\u8bf4\u660e\u7ed3\u6784\u4f53\u7684\u5b58\u50a8\u5e03\u5c40\u3002</p> <pre><code>struct st_dci\n{\n    double d;\n    char c;\n    int i;\n};\n</code></pre> <ol> <li>\u5148\u4e3a <code>d</code> \u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff0c\u5176\u8d77\u59cb\u5730\u5740\u548c\u7ed3\u6784\u4f53\u8d77\u59cb\u5730\u5740\u76f8\u540c\uff0c\u504f\u79fb\u91cf0\u4e3asizeof(double)=8\u7684\u500d\u6570\uff0c\u5360\u75288\u5b57\u8282\u3002</li> <li>\u518d\u4e3a <code>c</code> \u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff0c\u5730\u5740\u504f\u79fb\u91cf\u4e3a8\uff0c\u662fsizeof(char)=1\u7684\u500d\u6570\uff0c\u5360\u75281\u4e2a\u5b57\u8282\u3002</li> <li>\u7ee7\u7eed\u4e3a <code>i</code> \u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff0c\u5730\u5740\u504f\u79fb\u91cf\u4e3a9\uff0c\u4e0d\u662fsizeof(int)=4\u7684\u500d\u6570\u3002\u4e3a\u6ee1\u8db3\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\uff0c\u5c06\u81ea\u52a8\u586b\u51453\u4e2a\u5b57\u8282\uff0c\u5728\u504f\u79fb\u91cf\u4e3a12\u7684\u5730\u5740\u5904\u5b58\u653e i\uff0c\u5360\u75284\u4e2a\u5b57\u8282\u3002</li> </ol> <p>\u81f3\u6b64\uff0c\u5404\u6210\u5458\u53d8\u91cf\u90fd\u5df2\u5206\u914d\u4e86\u76f8\u5bf9\u5730\u5740\uff0csizeof(struct st_dci) =\u00a08+1+(3)+4=16\u3002\u5176\u4e2d\uff0c\u62ec\u53f7\u91cc\u7684 3 \u4e3a padding bits \u4f4d\u6570\u3002</p> <p>20230510 - ISO/IEC-N4950 - 6.8.2 Fundamental types: Padding bits have unspecified value, but cannot cause traps.</p> <p>\u53ef\u4ee5\u8c03\u7528 &lt;stddef.h&gt; \u4e2d\u5b9a\u4e49\u7684\u5b8f offsetof \u6765\u8bfb\u53d6\u5404\u4e2a\u6210\u5458\u7684\u5b9e\u9645\u504f\u79fb\u91cf\u3002</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#largest_member_middle","title":"largest member middle","text":"<p>\u4e0a\u9762\u7684 <code>struct st_dci</code> \u662f\u4e00\u79cd\u7c7b\u4f3c TC++PL \u4e2d\u8c03\u6574\u540e\u7684 struct Readout - largest member \ufb01rst \u7684\u5185\u5b58\u5e03\u5c40\u3002</p> <p>\u4ea4\u6362\u4e00\u4e0b\u6210\u5458\u53d8\u91cfd\u548cc\u7684\u4f4d\u7f6e\uff0c\u5c06\u5360\u4f4d\u6700\u957f\u7684 d \u653e\u5728\u4e2d\u95f4\uff0c\u65b0\u7684\u7ed3\u6784\u4f53 <code>struct st_cdi</code> \u7684\u5185\u5b58\u5e03\u5c40\u548c\u5360\u7528\u7a7a\u95f4\u53c8\u662f\u600e\u6837\u7684\u5462\uff1f</p> <pre><code>struct st_cdi\n{\n    char c;\n    double d;\n    int i;\n};\n</code></pre> <p>\u6309\u7167\u7ed3\u6784\u4f53\u6210\u5458\u53d8\u91cf\u7684\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\u539f\u5219\uff0c\u5206\u6790\u4e00\u4e0b <code>struct st_cdi</code> \u7684\u5730\u5740\u5206\u914d\u3002</p> <ol> <li>\u5148\u4e3a <code>c</code> \u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff0c\u5176\u8d77\u59cb\u5730\u5740\u548c\u7ed3\u6784\u4f53\u8d77\u59cb\u5730\u5740\u76f8\u540c\uff0c\u662fsizeof(char)=1\u7684\u500d\u6570\uff0c\u5360\u75281\u4e2a\u5b57\u8282\u3002</li> <li>\u518d\u4e3a <code>d</code> \u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff0c\u5730\u5740\u504f\u79fb\u91cf\u4e3a1\uff0c\u4e0d\u662fsizeof(double)=8\u7684\u500d\u6570\uff0c\u4e3a\u6ee1\u8db3\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\uff0c\u5148\u586b\u51457\u4e2a\u5b57\u8282\uff0c\u518d\u4ece\u5730\u5740\u504f\u79fb\u91cf\u4e3a8\u7684\u5730\u5740\u5904\u5b58\u653ed\uff0c\u5360\u75288\u5b57\u8282\u3002</li> <li>\u7ee7\u7eed\u4e3a <code>i</code> \u5206\u914d\u5b58\u50a8\u7a7a\u95f4\uff0c\u5730\u5740\u504f\u79fb\u91cf\u4e3a16\uff0c\u662fsizeof(int)=4\u7684\u500d\u6570\u3002</li> </ol> <p>\u7ecf\u4ee5\u4e0a\u63a8\u6f14\u76f8\u5bf9\u5b58\u50a8\u5206\u914d\u5e03\u5c40\u540e\uff0csizeof(struct st_cdi) =\u00a01+(7)+8+4=20\u3002\u5176\u4e2d\uff0c\u62ec\u53f7\u91cc\u7684 7 \u4e3a padding bits \u4f4d\u6570\u3002</p> <p>\u6309\u7167\u6210\u5458\u53d8\u91cf\u7684\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\u539f\u5219\uff0c\u4f3c\u4e4e\u5df2\u7ecf\u8ba8\u8bba\u5b8c\u6bd5\uff0c\u4f46\u95ee\u9898\u4e0d\u6b62\u5982\u6b64\u3002</p> <p>\u7ed3\u6784\u4f53 <code>struct st_cdi</code> \u6700\u7ec8\u7684\u5b9e\u9645\u5927\u5c0f\uff0c\u8bf7\u89c1\u4e0b\u8282\u5206\u6790\u3002</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#struct_array","title":"struct array","text":"<p>\u8003\u8651\u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u4f53 <code>struct st_cdi</code> \u7684\u6570\u7ec4\uff1a</p> <pre><code>struct st_cdi st[4];\n</code></pre> <p>\u6309\u7167\u4e0a\u9762\u7684\u8ba8\u8bba\uff0csizeof(struct st_cdi)=20\uff0c\u5047\u8bbe\u6570\u7ec4\uff08\u7b2c\u4e00\u4e2a\u7ed3\u6784\u4f53\uff09\u7684\u8d77\u59cb\u5730\u5740\u4e3a Sa\uff0c\u5219\u7b2c\u4e8c\u3001\u4e09\u3001\u56db\u4e2a\u7ed3\u6784\u4f53\u7684\u5730\u5740\u5206\u522b\u4e3a Sa+20, Sa+40, Sa+60\u3002</p> <p>\u7b2c\u4e00\u4e2a\u7ed3\u6784\u4f53 st[0] \u5185\u90e8\u7684\u6210\u5458 c\u3001d\u3001i \u56fa\u7136\u80fd\u6ee1\u8db3\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\uff0c\u4f46\u662f\u7d27\u968f\u5176\u540e\u7684\u7b2c\u4e8c\u3001\u4e09\u3001\u56db\u4e2a\u7ed3\u6784\u4f53\u4e2d\u7684\u6bcf\u4e2a\u6210\u5458\u53d8\u91cf\u662f\u5426\u80fd\u6ee1\u8db3\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\u5462\uff1f</p> <p>\u4ee5\u7b2c\u4e8c\u4e2a\u7ed3\u6784\u4f53 st[1] \u4e3a\u4f8b\uff0c\u5176\u8d77\u59cb\u5730\u5740\u4e3a Sa+20\uff0c\u6210\u5458 c \u6ee1\u8db3\u5bf9\u9f50\u9650\u5236\uff0c\u5360\u75281\u5b57\u8282+\u586b\u51457\u5b57\u8282\u540e\uff0c\u6210\u5458 d \u7684\u8d77\u59cb\u5730\u5740\u4e3a Sa+28\u3002\u53d6 Sa \u4e3a\u5178\u578b\u7684 8 \u6216 16\uff0c\u5747\u4e0d\u80fd\u6ee1\u8db3 d \u7684\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u7f16\u8bd1\u5668\u5728\u4e3a <code>struct st_cdi</code> \u5206\u914d\u7a7a\u95f4\u65f6\uff0c\u9664\u4e86\u4f7f\u6bcf\u4e2a\u6210\u5458\u53d8\u91cf\u6ee1\u8db3\u201c\u5730\u5740\u8fb9\u754c\u5bf9\u9f50\u9650\u5236\u201d\u5916\uff0c\u8fd8\u5fc5\u987b\u4fdd\u8bc1\u7ed3\u6784\u4f53\u6240\u5360\u7684\u603b\u5b57\u8282\u6570\u662f\u7ed3\u6784\u4e2d\u6700\u957f\u7c7b\u578b\u6240\u5360\u5b57\u8282\u6570\uff08\u8fd9\u91cc\u662fsizeof(double)=8\uff09\u7684\u500d\u6570\uff08satisfy the strictest alignment requirement\uff09\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u5728\u4e3a\u6700\u540e\u4e00\u4e2a\u6210\u5458\u53d8\u91cf i \u5206\u914d\u5730\u5740\u540e\uff0c\u5df2\u5360\u00a020 \u4e2a\u5b57\u8282\uff0c\u8fd8\u5fc5\u987b\u5728\u5c3e\u90e8\u586b\u51454\u4e2a\u5b57\u8282\u3002\u8fd9\u6837\uff0c\u7ed3\u6784\u4f53\u6574\u4f53\u5927\u5c0f sizeof(struct st_cdi) = 1+(7)+8+4+(4)=24\uff0c\u4e3a 8 \u7684\u500d\u6570\u3002</p> <p>\u53ea\u8981\u786e\u4fdd\u7ed3\u6784\u6570\u7ec4\u8d77\u59cb\u5730\u5740 Sa\uff08&amp;st[0]\uff09\u662f 8 \u7684\u500d\u6570\uff0c\u5c31\u80fd\u591f\u4fdd\u8bc1\u5176\u540e\u7684\u6bcf\u4e2a\u5143\u7d20\uff08st[1]\uff0cst[2]\uff0c...\uff09\u4e2d\u7684\u6210\u5458\u53d8\u91cf\u90fd\u6ee1\u8db3\u81ea\u8eab\u7684\u5730\u5740\u5bf9\u9f50\u9650\u5236\u3002</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#compiler_support","title":"compiler support","text":"<p>\u5173\u4e8e\u5b58\u50a8\u5730\u5740\u5bf9\u9f50\u7684\u539f\u56e0\u53ca\u81ea\u7136\u5bf9\u9f50\u89c4\u5219\uff0c\u53c2\u8003\u4e0a\u4e00\u7bc7 \u300aMemory Address Alignment\u300b \u4e2d\u7684 reasons \u548c natural alignment \u90e8\u5206\u3002</p> <p>\u76f8\u5173\u6d4b\u8bd5\u9a8c\u8bc1\uff0c\u53c2\u8003\u4e0b\u4e00\u7bc7\u300aStruct Alignment Specify\u300b\u4e2d\u7684\u6d4b\u8bd5\u7a0b\u5e8f struct-packed-aligned.c \u53ca\u5176\u7ed3\u679c\u5206\u6790\u3002</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#default_alignment","title":"default alignment","text":"<p>MSVC -\u00a0/Zp (Struct Member Alignment)\uff1aControls how the members of a structure are packed into memory and specifies the same packing for all structures in a module.</p> <ul> <li>x64 ABI conventions - x64 type and storage layout - Scalar types alignment</li> </ul> /Zp argument Effect 1 Packs structures on 1-byte boundaries. Same as <code>/Zp</code>. 2 Packs structures on 2-byte boundaries. 4 Packs structures on 4-byte boundaries. 8 Packs structures on 8-byte boundaries (default for x86, ARM, and ARM64). 16 Packs structures on 16-byte boundaries (default for x64 and ARM64EC). <p>Don't use this option unless you have specific alignment requirements.</p> <p>\u5728 MSVC Project Settings-&gt;C/C++-&gt;Struct member alignment \u4e2d\u9ed8\u8ba4\u503c\u4e3a 8\uff0c\u53ef\u5728\u7a0b\u5e8f\u4e2d\u4f7f\u7528 <code>#pragma pack</code> \u9884\u5904\u7406\u6765\u6307\u5b9a\u3002</p> <p>32\u300164 \u4f4d\u4e0b\u7684\u57fa\u672c\u6570\u636e\u7c7b\u578b\u5360\u7528\u6700\u5927\u7a7a\u95f4\u662f\u00a08\u00a0\u5b57\u8282\uff08sizeof(long long)\u3001sizeof(double)\uff09\uff0c\u8fd9\u4e2a\u4e5f\u662f\u81ea\u7136\u5bf9\u9f50\u7684\u6700\u5927\u53c2\u6570\u3002</p> <p>Don't change the default alignment</p> <p>The C/C++ headers in the Windows SDK assume the platform's default alignment is used. Don't change the setting from the default when you include the Windows SDK headers, either by using <code>/Zp</code> on the command line or by using <code>#pragma pack</code>. Otherwise, your application may cause memory corruption at runtime.</p> <p>GCC -\u00a0Common Variable Attributes:</p> <p>As in the preceding examples, you can explicitly specify the alignment (in bytes) that you wish the compiler to use for a given variable or structure field. Alternatively, you can leave out the alignment factor and just ask the compiler to align a variable or field to the default alignment for the target architecture you are compiling for. The default alignment is fixed for a particular target ABI.</p> <ul> <li>pipermail/gcc-help - default alignment</li> </ul> <p>Arm Compiler for Embedded Reference Guide:</p> <ul> <li>For <code>AArch32</code>, the default alignment is 8 bytes.</li> <li>For <code>AArch64</code>, the default alignment is 16 bytes.</li> </ul>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#biggest_alignment","title":"BIGGEST_ALIGNMENT","text":"<p>The default alignment is sufficient for all scalar types, but may not be enough for all vector types on a target that supports vector operations.</p> <p>x86 strictest 16-bytes alignment</p> <p>x86 Assembly/SSE - <code>movapd</code>: move two 64-bit(double precision) floats, vector is 16 byte aligned. Refer to Demystifying SSE Move Instructions.</p> <p>x64 calling convention - Alignment: Most structures are aligned to their natural alignment. The primary exceptions are the stack pointer and <code>malloc</code> or <code>alloca</code> memory, which are 16-byte aligned to aid performance. Alignment above 16 bytes must be done manually. Since 16 bytes is a common alignment size for XMM operations, this value should work for most code. For more information about structure layout and alignment, see x64 type and storage layout. For information about the stack layout, see x64 stack usage.</p> <p>GCC also provides a target specific macro\u00a0<code>__BIGGEST_ALIGNMENT__</code>, which is the largest\u00a0alignment ever used for any data type on the target machine you are compiling for.</p> <p>linker limitations for maximal alignment size</p> <p>Note that the effectiveness of aligned attributes for static variables may be limited by inherent limitations in the system linker and/or object file format. On some systems, the linker is only able to arrange for variables to be aligned up to a certain maximum alignment. (For some linkers, the maximum supported alignment may be very very small.) If your linker is only able to align variables up to a maximum of 8-byte alignment, then specifying aligned(16) in an <code>__attribute__</code> still only provides you with 8-byte alignment. See your linker documentation for further information.</p> <p>Stack variables are not affected by linker restrictions; GCC can properly align them on any target.</p> <p>\u53ef\u4ee5\u501f\u52a9 cpp / gcc -E -dM \u9884\u7f16\u8bd1\uff0c\u8fc7\u6ee4\u6253\u5370\u51fa\u00a0<code>__BIGGEST_ALIGNMENT__</code> \u5b8f\u5b9a\u4e49\uff1a</p> <pre><code>$ gcc -dM -E -arch armv7 -x c /dev/null | grep '__BIGGEST_ALIGNMENT__'\n$ gcc -dM -E -arch arm -x c /dev/null | grep '__BIGGEST_ALIGNMENT__'\n$ gcc -dM -E -arch arm64 -x c /dev/null | grep '__BIGGEST_ALIGNMENT__'\n$ gcc -dM -E -arch x86_64 -x c /dev/null | grep '__BIGGEST_ALIGNMENT__'\n$ gcc -dM -E -x c /dev/null | grep '__BIGGEST_ALIGNMENT__'\n$ echo | cpp -dM | grep '__BIGGEST_ALIGNMENT__'\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <ul> <li>macOS clang/llvm-gcc \uff1a armv7\u3001arm \u4e0b\u5b9a\u4e49\u4e3a 4\uff1barm64 \u4e0b\u5b9a\u4e49\u4e3a 8\uff1bx86_64 \u4e0b\u5b9a\u4e49\u4e3a 16\u3002</li> <li>\u5728 rpi3b-raspbian/armv7l(armhf? aarch32?) \u4e0b\u5b9a\u4e49\u4e3a 8\uff1b\u5728 rpi3b-ubuntu/aarch64 \u4e0b\u5b9a\u4e49\u4e3a 16\u3002</li> <li>\u5728 rpi4b-ubuntu/aarch64 \u4e0b\u5b9a\u4e49\u4e3a 16\u3002</li> </ul> <p>std::max_align_t</p> <p>max_align_t(since C11) is a type whose alignment requirement is at least as strict (as large) as that of every scalar type.</p> <p>Pointers returned by allocation functions such as malloc are suitably aligned for any object, which means they are aligned at least as strictly as <code>max_align_t</code>.</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#alignof","title":"alignof","text":"<p>GCC - Determining the Alignment of Functions, Types or Variables: The keyword <code>__alignof__</code> determines the alignment requirement of a function, object, or a type, or the minimum alignment usually required by a type. Its syntax is just like sizeof and C11 _Alignof(until C23).</p> <p>Microsoft-specific: <code>alignof</code> and <code>__alignof</code> are synonyms in the Microsoft compiler. Before it became part of the standard in C++11, the Microsoft-specific <code>__alignof</code> operator provided this functionality.</p> <p>For maximum portability, you should use the <code>alignof</code> operator instead of the  GCC-specific <code>__alignof__</code> operator or Microsoft-specific <code>__alignof</code> operator.</p> <p>\u53ef\u4ee5\u901a\u8fc7 &lt;stddef.h&gt; \u4e2d\u63d0\u4f9b\u7684\u7684\u76f8\u5173\u5b8f\u8bfb\u53d6\u7ed3\u6784\u4f53\u6210\u5458\u53d8\u91cf\u7684\u504f\u79fb\u91cf\u548c\u5bf9\u9f50\u53c2\u6570\uff1a</p> <ol> <li>\u901a\u8fc7\u5b8f <code>offset</code> \u53ef\u8bfb\u53d6\u7ed3\u6784\u4f53\u4e2d\u7684\u6210\u5458\u53d8\u91cf\u7684\u76f8\u5bf9\u5730\u5740\u504f\u79fb\u91cf\uff1b</li> <li>\u901a\u8fc7\u5b8f <code>alignof</code> \u53ef\u8bfb\u53d6\u53d8\u91cf\u6216\u7ed3\u6784\u4f53\u7684\u5bf9\u9f50\u53c2\u6570\u3002</li> </ol> <p>\u5728\u4e0b\u4e00\u7bc7\u300aStruct Alignment Specify\u300b\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6d4b\u8bd5\u7a0b\u5e8f struct-packed-aligned.c \u6d4b\u5f97\u7684 <code>alignof(max_align_t)</code> \u7ed3\u679c\u4e0e\u5bf9\u5e94\u5e73\u53f0\u4e0a\u7684 <code>__BIGGEST_ALIGNMENT__</code> \u76f8\u7b49\u3002</p>","tags":["struct","alignment"]},{"location":"blog/20211013/struct-alignment/#refs","title":"refs","text":"<p>C Structure Padding Initialization How Struct Memory Alignment Works in C </p> <p>Computer Systems - A Programmer\u2019s Perspective - 3.9.3: Data Alignment</p> <p>\u8001\u7801\u8bc6\u9014-\u4ece\u673a\u5668\u7801\u5230\u6846\u67b6\u7684\u7cfb\u7edf\u89c2\u9006\u5411\u4fee\u70bc\u4e4b\u8def-2012 - 1.5 \u65e0\u6cd5\u6c9f\u901a\u2014\u2014\u5bf9\u9f50\u7684\u9519\u8bef</p>","tags":["struct","alignment"]},{"location":"blog/20211010/x86-word/","title":"x86's ill-timed WORD","text":"<p>The word size is the computer's preferred size for moving units of information around; technically it's the width of your processor's registers. It reflects the amount of data that can be transmitted between memory and the processor in one chunk. Likewise, it may reflect the size of data that can be manipulated by the CPU's ALU in one cycle.</p> <p>Whereas, in the universe of x86, <code>word</code> continues to designate a 16-bit quantity. Microsoft's Windows API maintains the programming language definition of WORD as 16 bits, despite the fact that the API may be used on a 32- or 64-bit x86 processor.</p> <p>Word Size families</p> <p>Another example is the x86 family, of which processors of three different word lengths (16-bit, later 32- and 64-bit) have been released, while <code>word</code> continues to designate a 16-bit quantity. As software is routinely ported from one word-length to the next, some APIs and documentation define or refer to an older (and thus shorter) word-length than the full word length on the CPU that software may be compiled for. Also, similar to how bytes are used for small numbers in many programs, a shorter word (16 or 32 bits) may be used in contexts where the range of a wider word is not needed (especially where this can save considerable stack space or cache memory space). For example, Microsoft's Windows API maintains the programming language definition of WORD as 16 bits, despite the fact that the API may be used on a 32- or 64-bit x86 processor, where the standard word size would be 32 or 64 bits, respectively. Data structures containing such different sized words refer to them as:</p> <ul> <li><code>WORD</code> (16 bits/2 bytes)</li> <li><code>DWORD</code> (32 bits/4 bytes)</li> <li><code>QWORD</code> (64 bits/8 bytes)</li> </ul> <p>A similar phenomenon has developed in Intel's x86 assembly language \u2013 because of the support for various sizes (and backward compatibility) in the instruction set, some instruction mnemonics carry \"<code>d</code>\" or \"<code>q</code>\" identifiers denoting \"double-\", \"quad-\" or \"double-quad-\", which are in terms of the architecture's original 16-bit word size.</p> <p>An example with a different word size is the IBM System/360 family. In the System/360 architecture, System/370 architecture and System/390 architecture, there are 8-bit bytes, 16-bit halfwords, 32-bit words and 64-bit doublewords. The z/Architecture, which is the 64-bit member of that architecture family, continues to refer to 16-bit halfwords, 32-bit words, and 64-bit doublewords, and additionally features 128-bit quadwords.</p> <p>x64 ABI conventions - x64 type and storage layout - Scalar types</p> <ul> <li>Byte - 8 bits / 1 bytes</li> <li>Word - 16 bits / 2 bytes</li> <li>Doubleword - 32 bits / 4 bytes</li> <li>Quadword - 64 bits / 8 bytes</li> <li>Octaword - 128 bits / 16 bytes</li> </ul>","tags":["WORD","DWORD","QWORD"]},{"location":"blog/20211010/x86-word/#the_name_of_16_and_32_bits","title":"The name of 16 and 32 bits","text":"<p>The name of 16 and 32 bits </p> <p>Jonathon Reinhart:</p> <p>A byte is the smallest unit of data that a computer can work with. The C language defines char to be one \"byte\" and has CHAR_BIT bits. On most systems this is 8 bits.</p> <p>A word on the other hand, is usually the size of values typically handled by the CPU. Most of the time, this is the size of the general-purpose registers. The problem with this definition, is it doesn't age well.</p> <p>For example, the MS Windows <code>WORD</code> datatype was defined back in the early days, when 16-bit CPUs were the norm. When 32-bit CPUs came around, the definition stayed, and a 32-bit integer became a <code>DWORD</code>. And now we have 64-bit <code>QWORD</code>s.</p> <p>Far from \"universal\", but here are several different takes on the matter:</p> <p>Far from \"universal\", but here are several different takes on the matter:</p> <p>Windows:</p> <ul> <li>BYTE - 8 bits, unsigned</li> <li>WORD - 16 bits, unsigned</li> <li>DWORD - 32 bits, unsigned</li> <li>QWORD - 64 bits, unsigned</li> </ul> <p>GDB:</p> <ul> <li>Byte</li> <li>Halfword (two bytes).</li> <li>Word (four bytes).</li> <li>Giant words (eight bytes).</li> </ul> <p>&lt;stdint.h&gt;:</p> <ul> <li>uint8_t - 8 bits, unsigned</li> <li>uint16_t - 16 bits, unsigned</li> <li>uint32_t - 32 bits, unsigned</li> <li>uint64_t - 64 bits, unsigned</li> <li>uintptr_t - pointer-sized integer, unsigned</li> </ul> <p>(Signed types exist as well.)</p> <p>If you're trying to write portable code that relies upon the size of a particular data type (e.g. you're implementing a network protocol), always use &lt;stdint.h&gt;.</p> <p>gustaf r: <code>word</code> is not a datatype, it rather denotes the natural register size of the underlying hardware.</p>","tags":["WORD","DWORD","QWORD"]},{"location":"blog/20211010/x86-word/#how_many_bits_is_a_word","title":"How many bits is a WORD","text":"<p>How many bits is a WORD and is that constant over different architectures? </p> <p>Guffa:</p> <p>The machine word size depends on the architecture, but also how the operating system is running the application.</p> <p>In Windows x64 for example an application can be run either as a 64 bit application (having a 64 bit mahine word), or as a 32 bit application (having a 32 bit machine word). So the size of a machine word can differ even on the same machine.</p> <p>The term <code>WORD</code> has different meaning depending on how it's used. It can either mean a machine word, or a type with a specific size. In x86 assembly language <code>WORD</code>, DOUBLEWORD (<code>DWORD</code>) and QUADWORD (<code>QWORD</code>) are used for 2, 4 and 8 byte sizes, regardless of the machine word size.</p> <p>jalf:</p> <p>A word is typically the \"native\" data size of the CPU. That is, on a 16-bit CPU, a word is 16 bits, on a 32-bit CPU, it's 32 and so on.</p> <p>And the exception, of course, is x86, where a word is 16 bit wide (because x86 was originally a 16-bit CPU), a <code>DWORD</code> is 32-bit (because it became a 32-bit CPU), and a <code>QWORD</code> is 64-bit (because it now has 64-bit extensions bolted on).</p> <p>Pete Kirkham:</p> <p><code>WORD</code> is a Windows specific 16-bit integer type, and is hardware independent.</p> <p>If you mean a machine word, then there's no need to shout.</p>","tags":["WORD","DWORD","QWORD"]},{"location":"blog/20211010/x86-word/#whats_the_size_of_a_qword","title":"What's the size of a QWORD","text":"<p>assembly - What's the size of a QWORD on a 64-bit machine? - Stack Overflow</p> <p>Peter Cordes:</p> <p>In x86 terminology/documentation, a \"<code>word</code>\" is 16 bits because x86 evolved out of 16-bit 8086. Changing the meaning of the term as extensions were added would have just been confusing, because Intel still had to document 16-bit mode and everything, and instruction mnemonics like <code>cwd</code> (sign-extend word to dword) bake the terminology into the ISA.</p> <ul> <li>x86 word = 2 bytes</li> <li>x86 dword = 4 bytes (double word)</li> <li>x86 qword = 8 bytes (quad word)</li> <li>x86 double-quad or xmmword = 16 bytes</li> </ul> <p>Most other 64-bit ISAs evolved out of 32-bit ISAs (AArch64, MIPS64, PowerPC64, etc.), or were 64-bit from the start (Alpha), so \"word\" means 32 bits in that context.</p> <ul> <li>32-bit word = 4 bytes</li> <li>dword = 8 bytes (double word), e.g. MIPS <code>daddu</code> is 64-bit integer add</li> <li>qword = 16 bytes (quad word), if supported at all.</li> </ul> <p>\"Machine word\" and putting labels on architectures.</p> <p>The whole concept of \"machine word\" doesn't really apply to x86, with its machine-code format being a byte stream, and equal support for multiple operand-sizes, and unaligned loads/stores that mostly don't care about naturally aligned stuff, only cache line boundaries for normal cacheable memory.</p> <p>Even \"word oriented\" RISCs can have a different natural size for registers and cache accesses than their instruction width, or what their documentation uses as a \"word\".</p> <p>The whole concept of \"<code>word size</code>\" is over-rated in general, not just on x86. Even 64-bit RISC ISAs can load/store aligned 32-bit or 64-bit memory with equal efficiency, so pick whichever is most useful for what you're doing. Don't base your choice on figuring out which one is the machine's \"word size\", unless there's only one maximally efficient size (e.g. 32-bit on some 32-bit RISCs), then you can usefully call that the word size.</p>","tags":["WORD","DWORD","QWORD"]},{"location":"blog/20211010/x86-word/#x86_64_byte-stream_machine_code","title":"x86_64 byte-stream machine code","text":"<p>x86 64 - Are machine code instructions fetched in little endian 4-byte words on an Intel x86-64 architecture? - Stack Overflow</p> <p>No, x86 machine code is a byte-stream; there's nothing word-oriented about it, except for 32-bit displacements and immediates which are little-endian. e.g. in <code>add qword [rdi + 0x1234], 0xaabbccdd</code>. It's physically fetched in 16-byte or 32-byte chunks on modern CPUs, and split on instruction boundaries in parallel to feed to decoders in parallel.</p> <pre><code>48    81   87     34 12 00 00    dd cc bb aa       \nREX.W add ModRM    le32 0x1234    le32 0xaabbccdd le32 (sign-extended to 64-bit)\n\n   add    QWORD PTR [rdi+0x1234],0xffffffffaabbccdd\n</code></pre> <p>x86-64 is not a word-oriented architecture; there is no single natural word-size, and things don't have to be aligned. That concept is not very useful when thinking about x86-64. The integer register width happens to be 8 bytes, but that's not even the default operand-size in machine code, and you can use any operand-size from byte to qword with most instructions, and for SIMD from 8 or 16 byte up to 32 or 64 byte. And most importantly, alignment of wider integers isn't required in machine code, or even for data.</p> <p>An x86 16-bit \"word\" has absolutely zero connection to the concept of a \"machine word\" in CPU architecture.</p>","tags":["WORD","DWORD","QWORD"]},{"location":"blog/20180901/git-flow/","title":"git\u5206\u652f\u6a21\u578b\u53ca\u5de5\u4f5c\u6d41","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 git \u4ed3\u5e93\u6784\u6210\u3001\u5206\u652f\u6a21\u578b\u548c\u5de5\u4f5c\u6d41\u89c4\u8303\u3002</p>","tags":["git"]},{"location":"blog/20180901/git-flow/#git\u672c\u5730\u4ed3\u5e93\u6784\u6210","title":"git\u672c\u5730\u4ed3\u5e93\u6784\u6210","text":"<p>git\u672c\u5730\u4ed3\u5e93\u6784\u6210</p> <p></p>","tags":["git"]},{"location":"blog/20180901/git-flow/#git\u672c\u5730\u4ed3\u5e93\u6587\u4ef6\u72b6\u6001\u6d41\u8f6c","title":"git\u672c\u5730\u4ed3\u5e93\u6587\u4ef6\u72b6\u6001\u6d41\u8f6c","text":"<p>git\u672c\u5730\u4ed3\u5e93\u6587\u4ef6\u72b6\u6001\u6d41\u8f6c</p> <p></p>","tags":["git"]},{"location":"blog/20180901/git-flow/#git\u8fdc\u7a0b\u64cd\u4f5c\u7ba1\u7406","title":"git\u8fdc\u7a0b\u64cd\u4f5c\u7ba1\u7406","text":"<p>git\u8fdc\u7a0b\u64cd\u4f5c\u7ba1\u7406</p> <p></p>","tags":["git"]},{"location":"blog/20180901/git-flow/#git\u4f7f\u7528\u89c4\u8303\u6d41\u7a0b","title":"git\u4f7f\u7528\u89c4\u8303\u6d41\u7a0b","text":"<p>git\u4f7f\u7528\u89c4\u8303\u6d41\u7a0b</p> <p></p>","tags":["git"]},{"location":"blog/20180901/git-flow/#git\u5206\u652f\u6a21\u578b","title":"git\u5206\u652f\u6a21\u578b","text":"<p>git\u5206\u652f\u6a21\u578b</p> <p></p>","tags":["git"]},{"location":"blog/20180901/git-flow/#refs","title":"refs","text":"<p>Git\u5de5\u4f5c\u6d41 Git \u4f7f\u7528\u89c4\u8303\u6d41\u7a0b git-flow \u5907\u5fd8\u6e05\u5355 </p> <p>Git \u5206\u652f\u7ba1\u7406\u7b56\u7565 git\u521b\u5efa\u65b0\u5206\u652f Github \u521b\u5efa\u65b0\u5206\u652f </p>","tags":["git"]},{"location":"blog/20180901/gitk/","title":"git\u56fe\u5f62\u754c\u9762\u5ba2\u6237\u7aef","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 gitk \u7b49\u5e38\u7528 git \u56fe\u5f62\u754c\u9762\u7ba1\u7406\u5ba2\u6237\u7aef\u8f6f\u4ef6\u3002</p> <p>gitk - The Git repository browser A1.1 Appendix A: Git in Other Environments - Graphical Interfaces GUI Clients </p> <p>\u300aGit\u56fe\u5f62\u5316\u754c\u9762\u5ba2\u6237\u7aef\u5927\u6c47\u603b\u300b \u300aThe Best Mac Git Gui\u300b \u300aWhat are the best Git clients for Mac OS X?\u300b \u300aGit GUI Clients for OS X\u300b  </p> <p>Git\u5404\u5927\u5e73\u53f0\uff08win\uff0fLinux\uff0fMac\uff09\u56fe\u5f62\u5316\u754c\u9762\u5ba2\u6237\u7aef\u5927\u6c47\u603b</p>","tags":["git"]},{"location":"blog/20180901/gitk/#gotgithub","title":"GotGitHub","text":"<p>GotGitHub</p> <p>\u5982\u4f55\u9ad8\u6548\u5229\u7528GitHub \u6258\u7ba1\u9879\u76ee\u5230GitHub - \u4e0a\u4f20\u672c\u5730\u9879\u76ee\u5230github Git\u7684\u6df1\u5165\u7406\u89e3\u4e0eGitHub\u6258\u7ba1\u670d\u52a1\u7684\u4f7f\u7528 </p>","tags":["git"]},{"location":"blog/20180901/gitk/#tortoisegit","title":"TortoiseGit","text":"<p>github </p> <p>The Power of Git \u2013 in a Windows Shell Windows Explorer Extension to Operate Git  </p> <p>TortoiseSVN \u5b6a\u751f\u5144\u5f1f\uff0c\u5efa\u8bae Windows \u91c7\u7528\u3002</p> <p>Documentation</p>","tags":["git"]},{"location":"blog/20180901/gitk/#smartgit","title":"SmartGit","text":"<p>Get your commit done. SmartGit runs on Windows, macOS and Linux. SmartGit is a graphical Git client with support for SVN and Pull Requests for GitHub and Bitbucket.   </p> <p>SmartSVN \u5b6a\u751f\u5144\u5f1f\uff0c\u5efa\u8bae Windows/macOS \u91c7\u7528\u3002</p>","tags":["git"]},{"location":"blog/20180901/gitk/#manual","title":"Manual","text":"<p>SmartGit\u521d\u6b65\u4f7f\u7528 SmartGit \u5b89\u88c5\u53ca\u4f7f\u7528\uff08\u4e00\uff09\uff1a\u5b89\u88c5\u53ca\u914d\u7f6e </p>","tags":["git"]},{"location":"blog/20180901/gitk/#non-commercial","title":"non-commercial","text":"<ul> <li>Windows </li> <li>macOS </li> </ul> <p>SmartGit\u4e00\u76f4\u5f3a\u63d0\u793a\u8ba9\u786e\u8ba4\u201c\u4e8e\u975e\u8425\u5229\u76ee\u7684\u201d\u89e3\u51b3\u6b65\u9aa4 - \u6ce8\u518c\u975e\u5546\u4e1a\u8bb8\u53ef\u8bc1  </p>","tags":["git"]},{"location":"blog/20180901/gitk/#tower","title":"Tower","text":"<p>the most powerful Git client for Mac and Windows.</p> <p>Tower is available on macOS (10.11+) and Windows (7 SP2+). </p> <p>\u6ca1\u6cd5\u770b\u6574\u4e2a\u4ed3\u5e93\u7684\u6587\u4ef6\u548c\u5355\u4e2a\u6587\u4ef6\u7684\u5386\u53f2\u3002</p> <p>git-tower\u4f7f\u7528\u6559\u8bad</p>","tags":["git"]},{"location":"blog/20180901/gitk/#sourcetree","title":"Sourcetree","text":"<p>A free Git client for Windows and Mac Simplicity and power in a beautiful Git GUI  </p> <p>\u6ca1\u6cd5\u770b\u6574\u4e2a\u4ed3\u5e93\u7684\u6587\u4ef6\u548c\u5355\u4e2a\u6587\u4ef6\u7684\u5386\u53f2\uff0c\u7528 gitk \u67e5\u770b\uff1f</p>","tags":["git"]},{"location":"blog/20180901/gitk/#giteye","title":"GitEye","text":"<p>GitEye is a graphical client for Git from CollabNet. GitEye is an easy-to-use Git GUI that improves development productivity.  </p> <p>GitEye runs on Windows, macOS and Linux.</p> <p></p> <p>Eclipse \u7684\u539a\u91cd\u5373\u89c6\u611f\uff0c\u4e5f\u6ca1\u6cd5\u770b\u6574\u4e2a\u4ed3\u5e93\u7684\u6587\u4ef6\u548c\u5355\u4e2a\u6587\u4ef6\u7684\u5386\u53f2\u3002</p>","tags":["git"]},{"location":"blog/20180901/gitk/#gitup","title":"GitUp","text":"<p>Work quickly, safely, and without headaches.</p> <p>\u8c8c\u4f3c\u6bd4\u8f83\u7b80\u964b\u3002</p>","tags":["git"]},{"location":"blog/20180906/git-branch-checkout/","title":"git\u68c0\u51fa\u5206\u652f\u4ee3\u7801","text":"<p>\u5982\u4f55\u57fa\u4e8e\u6307\u5b9a\u7248\u672c\u521b\u5efa\u5206\u652f\uff0c\u4e0b\u8f7d\u6307\u5b9a\u7248\u672c\u7684\u6587\u4ef6\uff1f</p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-checkout/#\u57fa\u4e8e\u6307\u5b9a\u7248\u672c\u521b\u5efa\u5206\u652f","title":"\u57fa\u4e8e\u6307\u5b9a\u7248\u672c\u521b\u5efa\u5206\u652f","text":"<p>Branch from a previous commit using Git</p> <pre><code>git checkout -b branchname &lt;sha1-of-commit or HEAD~3&gt;\n</code></pre> <p>git\u4e0b\u8f7d\u6307\u5b9a\u7248\u672c\u7684\u4ee3\u7801</p> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u60f3\u5c06\u622a\u81f3\u67d0\u6b21\u63d0\u4ea4 7bf1f57f \u7684\u65e7\u7248\u672c\u5e93 checkout \u5230\u672c\u5730\u5206\u652f <code>local/FATVVideoPlayer</code> \u4ee5\u4f9b\u7ffb\u9605\uff0c\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a</p> <pre><code># \u5207\u6362\u5230\u6307\u5b9a\u7684\u7248\u672c\u53f7\ngit checkout 7bf1f57f\n# \u518d\u65b0\u5efa\u5206\u652f\ngit checkout -b local/FATVVideoPlayer\n</code></pre> <p>\u4e5f\u53ef\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff1a</p> <pre><code>git branch local/FATVVideoPlayer 7bf1f57f\ngit checkout local/FATVVideoPlayer\n</code></pre> <p>\u5047\u5982\u60f3\u5c06\u67d0\u6b21\u63d0\u4ea4 66932f0c \u4e4b\u524d\u7684\u65e7\u7248\u672c\u5e93 checkout \u5230\u672c\u5730\u5206\u652f <code>local/before_iconv</code> \u4ee5\u4f9b\u7ffb\u9605\uff0c\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a</p> <pre><code>git checkout -b local/before_iconv 66932f0c^\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-checkout/#\u4e0b\u8f7d\u6307\u5b9a\u7248\u672c\u7684\u6587\u4ef6","title":"\u4e0b\u8f7d\u6307\u5b9a\u7248\u672c\u7684\u6587\u4ef6","text":"<p>git-checkout older revision of a file under a new name</p> <p>\u68c0\u6d4b faner \u63d0\u4ea4\u76843\u6b21\u4fee\u6539 .code.yml \u8bb0\u5f55\uff1a</p> <pre><code>$ git log -3 --author=faner --no-merges -- .code.yml\n</code></pre> <p>\u67e5\u770b\u67d0\u6b21\u63d0\u4ea4 <code>0e667edc</code> \u7684\u53d8\u52a8\uff1a</p> <pre><code>$ git diff 0e667edc^ 0e667edc -- .code.yml\n$ git difftool 0e667edc^ 0e667edc -- .code.yml\n</code></pre> <p>checkout \u8fd9\u6b21\u63d0\u4ea4\u524d\u7684\u6587\u4ef6\u5230\u672c\u5730\uff0c\u53ef\u4ee5\u8fd9\u6837\uff1a</p> <pre><code>$ git show 0e667edc^:.code.yml &gt; ~/Downloads/old.code.yml\n</code></pre> <p>\u6216\u8005\u7528\u66f4\u5e95\u5c42\u7684 <code>cat-file</code> \u547d\u4ee4\uff1a</p> <pre><code>$ git cat-file blob 0e667edc^:.code.yml &gt; old.code.yml\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/","title":"git\u521b\u5efa\u5206\u652f\u548c\u7ba1\u7406\u5206\u652f","text":"<p>\u672c\u6587\u68b3\u7406\u4e86\u521b\u5efa\u3001\u5220\u9664\u3001\u91cd\u547d\u540d\u548c\u6e05\u7406\u5206\u652f\u7684\u57fa\u672c\u64cd\u4f5c\u3002</p> <p>Git\u8fdc\u7a0b\u64cd\u4f5c\u8be6\u89e3</p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#git_help_branch","title":"git help branch","text":"<p><code>git help branch</code></p> <pre><code>GIT-BRANCH(1)                               Git Manual                               GIT-BRANCH(1)\n\n\n\nNAME\n       git-branch - List, create, or delete branches\n\nSYNOPSIS\n       git branch [--color[=&lt;when&gt;] | --no-color] [-r | -a]\n               [--list] [-v [--abbrev=&lt;length&gt; | --no-abbrev]]\n               [--column[=&lt;options&gt;] | --no-column] [--sort=&lt;key&gt;]\n               [(--merged | --no-merged) [&lt;commit&gt;]]\n               [--contains [&lt;commit]] [--no-contains [&lt;commit&gt;]]\n               [--points-at &lt;object&gt;] [--format=&lt;format&gt;] [&lt;pattern&gt;...]\n       git branch [--track | --no-track] [-f] &lt;branchname&gt; [&lt;start-point&gt;]\n       git branch (--set-upstream-to=&lt;upstream&gt; | -u &lt;upstream&gt;) [&lt;branchname&gt;]\n       git branch --unset-upstream [&lt;branchname&gt;]\n       git branch (-m | -M) [&lt;oldbranch&gt;] &lt;newbranch&gt;\n       git branch (-c | -C) [&lt;oldbranch&gt;] &lt;newbranch&gt;\n       git branch (-d | -D) [-r] &lt;branchname&gt;...\n       git branch --edit-description [&lt;branchname&gt;]\n\nDESCRIPTION\n       The command's second form creates a new branch head named &lt;branchname&gt; which points to the current\n       HEAD, or &lt;start-point&gt; if given.\n\n       Note that this will create the new branch, but it will not switch the working tree to it; use \"git\n       checkout &lt;newbranch&gt;\" to switch to the new branch.\n</code></pre> <p>\u5982\u679c\u8981\u57fa\u4e8e master\uff08parent_branch\uff09\u521b\u5efa\u5b50\u5206\u652f\uff0c\u9700\u8981\u5148 checkout \u5230 master\uff08parent_branch\uff09\u3002</p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#create","title":"create","text":"<p>How do you create a remote Git branch? Create a new branch with git and manage branches </p> <p>git\u62f7\u8d1d\u6307\u5b9a\u5206\u652f\u5230\u65b0\u5206\u652f </p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#checkout_-b","title":"checkout -b","text":"<pre><code>NOTES\n       If you are creating a branch that you want to checkout immediately, it is easier to use the git\n       checkout command with its -b option to create a branch and check it out with a single command.\n</code></pre> <p><code>git checkout -b new_branch</code>\uff1a\u57fa\u4e8e\u5f53\u524d\u5206\u652f\u65b0\u5efa\u5b50\u6d41\u5e76 checkout\u3002</p> <p>\u7b49\u6548\u4e8e\u4ee5\u4e0b\u4e24\u6b65\uff1a</p> <ol> <li><code>git branch new_branch</code> </li> <li><code>git checkout new_branch</code> </li> </ol> <p>git checkout -b  / <p>remote-name\uff1a\u9ed8\u8ba4\u4e3a origin\uff1b remote-branch-name\uff1a\u9ed8\u8ba4\u7b49\u540c local-branch-name\u3002  </p> <p>\u518d\u6267\u884c <code>git push</code>\uff08<code>git push origin new_branch</code>, <code>git push -u origin new_branch</code>\uff1f\uff09 \u5373\u53ef\u63a8\u9001\u5230\u670d\u52a1\u5668\u3002</p> <p>git push  : <p>remote-branch-name\uff1a\u9ed8\u8ba4\u7b49\u540c local-branch-name\u3002  </p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#demo","title":"demo","text":"<p>Git\u590d\u5236\u5df2\u6709\u5206\u652f\u5230\u65b0\u5206\u652f\u5f00\u53d1 git\u4ece\u5df2\u6709\u5206\u652f\u62c9\u65b0\u5206\u652f\u5f00\u53d1 </p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#branch_-u","title":"branch -u","text":"<p><code>git help branch</code> \u67e5\u770b git branch \u547d\u4ee4\u4e2d\u5173\u4e8e track \u548c upstream \u7684\u76f8\u5173\u9009\u9879\uff1a</p> <pre><code># git help branch\n\nSYNOPSIS\n\n       git branch [--track | --no-track] [-f] &lt;branchname&gt; [&lt;start-point&gt;]\n       git branch (--set-upstream-to=&lt;upstream&gt; | -u &lt;upstream&gt;) [&lt;branchname&gt;]\n       git branch --unset-upstream [&lt;branchname&gt;]\n\nOPTIONS\n\n       --set-upstream\n           As this option had confusing syntax, it is no longer supported. Please use --track or\n           --set-upstream-to instead.\n\n       -u &lt;upstream&gt;, --set-upstream-to=&lt;upstream&gt;\n           Set up &lt;branchname&gt;'s tracking information so &lt;upstream&gt; is considered &lt;branchname&gt;'s\n           upstream branch. If no &lt;branchname&gt; is specified, then it defaults to the current\n           branch.\n\n       --unset-upstream\n           Remove the upstream information for &lt;branchname&gt;. If no branch is specified it defaults\n           to the current branch.\n</code></pre> <p>\u6267\u884c <code>git branch -u &lt;upstream&gt;</code>\uff08\u7b49\u6548\u4e8e <code>git branch --set-upstream-to=&lt;upstream&gt;</code>\uff09\uff1a</p> <pre><code># 1. git checkout -b\n\u279c  docs-mp git:(master) \u2717 git checkout -b bugfix-67434255\nSwitched to a new branch 'bugfix-67434255'\n\n# 2. git push\n\u279c  docs-mp git:(bugfix-67434255) \u2717 git push origin bugfix-67434255\nTotal 0 (delta 0), reused 0 (delta 0)\nremote: Processing changes: done\nremote: Updating references: 100% (1/1)\nTo http://git.code.com/docs-mp\n * [new branch]      bugfix-67434255 -&gt; bugfix-67434255\n\n# git pull\n\u279c  docs-mp git:(bugfix-67434255) \u2717 git pull\nThere is no tracking information for the current branch.\nPlease specify which branch you want to merge with.\nSee git-pull(1) for details.\n\n    git pull &lt;remote&gt; &lt;branch&gt;\n\nIf you wish to set tracking information for this branch you can do so with:\n\n    git branch --set-upstream-to=origin/&lt;branch&gt; bugfix-67434255\n\n# git remote \n\u279c  docs-mp git:(bugfix-67434255) \u2717 git remote -v\norigin  http://git.code.com/docs-mp (fetch)\norigin  http://git.code.com/docs-mp (push)\n\n# 3. git branch --set-upstream-to\n\u279c  docs-mp git:(bugfix-67434255) \u2717 git branch --set-upstream-to=origin/bugfix-67434255 bugfix-67434255\nBranch 'bugfix-67434255' set up to track remote branch 'bugfix-67434255' from 'origin'.\n\u279c  docs-mp git:(bugfix-67434255) \u2717 git pull\nAlready up to date.\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#push_-u","title":"push -u","text":"<p><code>git help push</code> \u67e5\u770b git push \u547d\u4ee4\u4e2d\u5173\u4e8e upstream \u7684\u76f8\u5173\u9009\u9879\uff1a</p> <pre><code># git help push\n\n       -u, --set-upstream\n           For every branch that is up to date or successfully pushed, add upstream (tracking)\n           reference, used by argument-less git-pull(1) and other commands. For more information,\n           see branch.&lt;name&gt;.merge in git-config(1).\n</code></pre> <p>\u6267\u884c <code>git push -u origin new_branch</code>\uff08<code>-u</code> \u7b49\u6548\u4e8e <code>--set-upstream</code>\uff09\uff1a</p> <pre><code># 1. git checkout -b\n [git::master] [ifan@MBPFAN-MC1] [19:16]\n&gt; git checkout -b bugfix-67359785\nSwitched to a new branch 'bugfix-67359785'\n\n# 2. git push --set-upstream\n [git::bugfix-67359785] [ifan@MBPFAN-MC1] [19:17]\n&gt; git push --set-upstream origin bugfix-67359785\nTotal 0 (delta 0), reused 0 (delta 0)\nremote: Processing changes: done\nremote: Updating references: 100% (1/1)\nTo http://git.code.com/coredoc\n * [new branch]        bugfix-67359785 -&gt; bugfix-67359785\nBranch 'bugfix-67359785' set up to track remote branch 'bugfix-67359785' from 'origin'.\n\n [git::bugfix-67359785] [ifan@MBPFAN-MC1] [19:18]\n&gt; git remote -v\norigin  http://git.code.com/coredoc (fetch)\norigin  http://git.code.com/coredoc (push)\n\n [git::bugfix-67359785] [ifan@MBPFAN-MC1] [19:18]\n&gt; git pull\nAlready up to date.\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#delete","title":"delete","text":"","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#delete_local","title":"delete local","text":"<p><code>git help branch</code> \u67e5\u770b git branch \u547d\u4ee4\u4e2d\u5173\u4e8e\u5220\u9664\u7684\u9009\u9879\uff1a</p> <pre><code># git help branch\n\n       With a -d or -D option, &lt;branchname&gt; will be deleted. You may specify more than one branch\n       for deletion. If the branch currently has a reflog then the reflog will also be deleted.\n\n       Use -r together with -d to delete remote-tracking branches. Note, that it only makes sense\n       to delete remote-tracking branches if they no longer exist in the remote repository or if\n       git fetch was configured not to fetch them again.\n\nOPTIONS\n       -f, --force\n           Reset &lt;branchname&gt; to &lt;startpoint&gt;, even if &lt;branchname&gt; exists already. Without -f,\n           git branch refuses to change an existing branch. In combination with -d (or --delete),\n           allow deleting the branch irrespective of its merged status. In combination with -m (or\n           --move), allow renaming the branch even if the new branch name already exists, the same\n           applies for -c (or --copy).\n\n       -d, --delete\n           Delete a branch. The branch must be fully merged in its upstream branch, or in HEAD if\n           no upstream was set with --track or --set-upstream-to.\n\n       -D\n           Shortcut for --delete --force.\n</code></pre> <p>\u4ee5\u4e0b\u4e3a\u64cd\u4f5c\u793a\u4f8b\uff1a</p> <pre><code>MBP-FAN :: Projects/git.code/core-sheet \u2039master\u203a % git branch -a | grep 'dev-login-weblog'\n  dev-login-weblog\n  remotes/origin/dev-login-weblog\n\nMBP-FAN :: Projects/git.code/core-sheet \u2039master\u203a % git branch -dr origin/dev-login-weblog\nDeleted remote-tracking branch origin/dev-login-weblog (was 73e226bc).\n\nMBP-FAN :: Projects/git.code/core-sheet \u2039master\u203a % git branch -a | grep 'dev-login-weblog'\n  dev-login-weblog\n\nMBP-FAN :: Projects/git.code/core-sheet \u2039master\u203a % git branch -d dev-login-weblog\nerror: The branch 'dev-login-weblog' is not fully merged.\nIf you are sure you want to delete it, run 'git branch -D dev-login-weblog'.\n\nMBP-FAN :: Projects/git.code/core-sheet \u2039master\u203a % git branch -D dev-login-weblog\nDeleted branch dev-login-weblog (was 73e226bc).\n\nMBP-FAN :: Projects/git.code/core-sheet \u2039master*\u203a % git branch -a | grep 'dev-login-weblog'\nMBP-FAN :: Projects/git.code/core-sheet \u2039master*\u203a %\n</code></pre> <p><code>git branch -D</code> \u53ea\u662f\u5220\u9664\u672c\u5730\u4ed3\u5e93\u91cc\u7684\uff0c\u91cd\u65b0\u6267\u884c <code>git fetch origin</code> \u8fd8\u80fd\u62c9\u4e0b\u6765\u3002</p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#delete_remote","title":"delete remote","text":"<p><code>git help push</code> \u67e5\u770b git push \u547d\u4ee4\u4e2d\u5173\u4e8e\u5220\u9664\u7684\u9009\u9879\uff1a</p> <pre><code># git help push\n\n       -d, --delete\n           All listed refs are deleted from the remote repository. This is the same as prefixing\n           all refs with a colon.\n\n       git push origin :experimental\n           Find a ref that matches experimental in the origin repository (e.g.\n           refs/heads/experimental), and delete it.\n</code></pre> <p><code>git push origin :[retired_branch]</code>\uff1a \u79fb\u9664\u8fdc\u7a0b\u4ed3\u5e93 origin \u4e0a\u7684 <code>retired_branch</code> \u5206\u652f\u3002</p> <pre><code>MBP-FAN :: Projects/git.code/core-sheet \u2039master\u203a % git push origin :dev-login-weblog\nremote: Processing changes: done\nremote: Updating references: 100% (1/1)\nTo http://git.code.com/core-sheet.git\n - [deleted]           dev-login-weblog\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#rename","title":"rename","text":"<pre><code>       With a -m or -M option, &lt;oldbranch&gt; will be renamed to &lt;newbranch&gt;. If &lt;oldbranch&gt; had a\n       corresponding reflog, it is renamed to match &lt;newbranch&gt;, and a reflog entry is created to\n       remember the branch renaming. If &lt;newbranch&gt; exists, -M must be used to force the rename to\n       happen.\n\n       The -c and -C options have the exact same semantics as -m and -M, except instead of the\n       branch being renamed it along with its config and reflog will be copied to a new name.\n\nOPTIONS\n       -f, --force\n           Reset &lt;branchname&gt; to &lt;startpoint&gt;, even if &lt;branchname&gt; exists already. Without -f,\n           git branch refuses to change an existing branch. In combination with -d (or --delete),\n           allow deleting the branch irrespective of its merged status. In combination with -m (or\n           --move), allow renaming the branch even if the new branch name already exists, the same\n           applies for -c (or --copy).\n\n       -m, --move\n           Move/rename a branch and the corresponding reflog.\n\n       -M\n           Shortcut for --move --force.\n\n       -c, --copy\n           Copy a branch and the corresponding reflog.\n\n       -C\n           Shortcut for --copy --force.\n</code></pre> <p>How do I rename a local Git branch? rename git branch locally and remotely How To Rename a Local and Remote Git Branch How to rename git local and remote branches</p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#rename_your_local_branch","title":"Rename your local branch","text":"<p>If you are on the branch you want to rename:</p> <pre><code>// old-name \u7f3a\u7701\u4e3a\u5f53\u524d branch name: \n#git checkout &lt;old_name&gt;\ngit branch -m new-name\n</code></pre> <p>If you are on a different branch:</p> <pre><code>git branch -m old-name new-name\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#track_a_new_remote_branch","title":"Track a new remote branch","text":"<pre><code># Delete the old-name remote branch and push the new-name local branch\n\ngit push origin :&lt;old_name&gt;\n#git push origin :&lt;old-name&gt; &lt;new-name&gt;\ngit push origin --delete &lt;old_name&gt;\n\n# Reset the upstream branch for the new-name local branch\n\ngit push -u origin &lt;new_name&gt;\n#git push --set-upstream origin &lt;new_name&gt;\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#prune","title":"prune","text":"<pre><code># git help push\n\n       --prune\n           Remove remote branches that don't have a local counterpart. For example a remote branch\n           tmp will be removed if a local branch with the same name doesn't exist any more. This\n           also respects refspecs, e.g.  git push --prune remote refs/heads/*:refs/tmp/* would\n           make sure that remote refs/tmp/foo will be removed if refs/heads/foo doesn't exist.\n</code></pre> <p>reference broken</p> <p>Git error on git pull (unable to update local ref)</p> <ol> <li><code>git gc --prune=now</code> - didn't do anything  </li> <li><code>git remote prune origin</code> - solved  </li> </ol> <p>git pull fails \u201cunable to resolve reference\u201d \u201cunable to update local ref\u201d</p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#fetch_error","title":"fetch error","text":"<p>\u6267\u884c gfo\uff0c\u62a5\u9519\uff1a</p> <pre><code>error: cannot lock ref 'refs/remotes/origin/release/20180726': 'refs/remotes/origin/release' exists; cannot create 'refs/remotes/origin/release/20180726'\nFrom http://github.com/fan2/repo\n ! [new branch]        release/20180726 -&gt; origin/release/20180726  (unable to update local ref)\nerror: cannot lock ref 'refs/remotes/origin/release/20180730': 'refs/remotes/origin/release' exists; cannot create 'refs/remotes/origin/release/20180730'\n\n ! [new branch]        release/20180910 -&gt; origin/release/20180910  (unable to update local ref)\nerror: cannot lock ref 'refs/remotes/origin/release/20180913': 'refs/remotes/origin/release' exists; cannot create 'refs/remotes/origin/release/20180913'\n ! [new branch]        release/20180913 -&gt; origin/release/20180913  (unable to update local ref)\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-create_delete/#remote_prune","title":"remote prune","text":"<pre><code>\u21d2  git remote prune origin\nPruning origin\nURL: http://github.com/fan2/repo\n\n * [pruned] origin/bugfix-64144175\n * [pruned] origin/bugfix-64534787\n * [pruned] origin/bugfix-64665173\n\n * [pruned] origin/dev-account-unbinding\n\n * [pruned] origin/dev-font\n\n * [pruned] origin/dev-preview\n\n * [pruned] origin/dev-sourcemap\n\n * [pruned] origin/feature-redDot\n</code></pre> <p>\u91cd\u65b0 fetch \u6062\u590d\u6b63\u5e38\uff1a</p> <pre><code>\u21d2  gfo\nFrom http://github.com/fan2/repo\n * [new branch]        release/20180726 -&gt; origin/release/20180726\n * [new branch]        release/20180730 -&gt; origin/release/20180730\n * [new branch]        release/20180802 -&gt; origin/release/20180802\n * [new branch]        release/20180806 -&gt; origin/release/20180806\n * [new branch]        release/20180809 -&gt; origin/release/20180809\n * [new branch]        release/20180813 -&gt; origin/release/20180813\n * [new branch]        release/20180816 -&gt; origin/release/20180816\n * [new branch]        release/20180820 -&gt; origin/release/20180820\n * [new branch]        release/20180823 -&gt; origin/release/20180823\n * [new branch]        release/20180827 -&gt; origin/release/20180827\n * [new branch]        release/20180830 -&gt; origin/release/20180830\n * [new branch]        release/20180903 -&gt; origin/release/20180903\n * [new branch]        release/20180906 -&gt; origin/release/20180906\n * [new branch]        release/20180910 -&gt; origin/release/20180910\n * [new branch]        release/20180913 -&gt; origin/release/20180913\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-merge_rebase/","title":"git merge & rebase","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 merge \u5408\u5e76\u5206\u652f\u548c rebase \u57fa\u7ebf\u7684\u57fa\u672c\u64cd\u4f5c\u3002</p> <p>3.2 Git Branching - Basic Branching and Merging</p> <p>git rebase &amp; merge \u5c06\u5176\u4ed6\u5206\u652f\u7684\u4fee\u6539\u5408\u5e76\u5230\u5f53\u524d\u5206\u652f</p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-merge_rebase/#merge","title":"merge","text":"<p>Git \u5206\u652f - \u5206\u652f\u7684\u65b0\u5efa\u4e0e\u5408\u5e76 </p> <p>\u5206\u652f\u7684\u5408\u5e76\u6982\u8ff0 </p> <p>fetch\u5b8c\u4e4b\u540e\uff0c\u53ef\u4ee5\u5c06\u8fdc\u7a0b\u5206\u652fcache master\u5206\u652fmerge\u5408\u5e76\u5230\u5f53\u524d\u5206\u652f\u4e0a  </p> <pre><code>$ git merge origin/master\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-merge_rebase/#rebase","title":"rebase","text":"<p>\u7528 rebase \u5408\u5e76 rebase \u4ee3\u66ff\u5408\u5e76 </p> <p>\u4ee3\u7801\u5408\u5e76\uff1aMerge\u3001Rebase \u7684\u9009\u62e9 </p> <p>fetch \u5b8c\u4e4b\u540e\uff0c\u53ef\u4ee5\u5c06\u8fdc\u7a0b\u5206\u652f cache master  \u5206\u652f rebase \u5408\u5e76\u5230\u5f53\u524d\u5206\u652f\u4e0a  </p> <pre><code>$ git rebase origin/master\n</code></pre> <p>\u4f7f\u7528 git rebase \u907f\u514d\u65e0\u8c13\u7684 merge</p> <ol> <li>\u628a\u672c\u5730 repo. \u5f9e\u4e0a\u6b21 pull \u4e4b\u5f8c\u7684\u8b8a\u66f4\u66ab\u5b58\u8d77\u4f86  </li> <li>\u56de\u5fa9\u5230\u4e0a\u6b21 pull \u6642\u7684\u60c5\u6cc1  </li> <li>\u5957\u7528\u9060\u7aef\u7684\u8b8a\u66f4  </li> <li>\u6700\u5f8c\u518d\u5957\u7528\u525b\u66ab\u5b58\u4e0b\u4f86\u7684\u672c\u5730\u8b8a\u66f4  </li> </ol>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-merge_rebase/#git_pull_-r","title":"git pull -r","text":"<p>\u804a\u4e0b git pull --rebase \u5bf9\u6bd4 git pull \u548c git pull --rebase </p> <p>git fetch, git pull, git pull -rebase\u533a\u522b </p> <p>\u5982\u679c\u8ba4\u4e3a origin \u662f\u4e3b\u8981\u7684\uff0c\u90a3\u4e48\u5c31\u52a0 <code>-r</code> | <code>--rebase</code>\uff0c\u7528\u53d8\u57fa\u4ee3\u66ff\u5408\u5e76\uff0c\u6700\u5927\u7a0b\u5ea6\u7684\u4fdd\u8bc1 origin \u4ee3\u7801\u4e0d\u88ab\u4f60\u9519\u8bef\u4fee\u6539\u3002</p>","tags":["git","branch"]},{"location":"blog/20180906/git-branch-merge_rebase/#\u7efc\u5408\u6848\u4f8b","title":"\u7efc\u5408\u6848\u4f8b","text":"<p>git \u56e2\u961f\u5408\u4f5c\uff0c git \u5206\u652f\u5f00\u53d1 \u3001\u5408\u5e76\u3001\u51b2\u7a81 \u5b9e\u4f8b git\u5206\u652f\u5f00\u53d1\uff0c\u5206\u652f(feature)\u540c\u6b65\u4e3b\u5e72(master)\u4ee3\u7801\uff0c\u4ee5\u53ca\u6700\u7ec8\u5206\u652f\u5408\u5e76\u5230\u4e3b\u5e72\u7684\u64cd\u4f5c\u6d41\u7a0b </p>","tags":["git","branch"]},{"location":"blog/20180906/git-show-branch/","title":"git\u663e\u793a\u548c\u67e5\u627e\u5206\u652f","text":"<p>\u672c\u6587\u68b3\u7406\u4e86\u5982\u4f55\u67e5\u770b\u548c\u67e5\u627e\u672c\u5730\u5206\u652f\u3002</p>","tags":["git","branch"]},{"location":"blog/20180906/git-show-branch/#git_show-branch","title":"git show-branch","text":"<pre><code>GIT-SHOW-BRANCH(1)                          Git Manual                          GIT-SHOW-BRANCH(1)\n\n\n\nNAME\n       git-show-branch - Show branches and their commits\n\nSYNOPSIS\n       git show-branch [-a|--all] [-r|--remotes] [--topo-order | --date-order]\n                       [--current] [--color[=&lt;when&gt;] | --no-color] [--sparse]\n                       [--more=&lt;n&gt; | --list | --independent | --merge-base]\n                       [--no-name | --sha1-name] [--topics]\n                       [(&lt;rev&gt; | &lt;glob&gt;)...]\n       git show-branch (-g|--reflog)[=&lt;n&gt;[,&lt;base&gt;]] [--list] [&lt;ref&gt;]\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-show-branch/#git_branch","title":"git branch","text":"<pre><code>GIT-BRANCH(1)                               Git Manual                               GIT-BRANCH(1)\n\n\n\nNAME\n       git-branch - List, create, or delete branches\n\nSYNOPSIS\n       git branch [--color[=&lt;when&gt;] | --no-color] [-r | -a]\n               [--list] [-v [--abbrev=&lt;length&gt; | --no-abbrev]]\n               [--column[=&lt;options&gt;] | --no-column] [--sort=&lt;key&gt;]\n               [(--merged | --no-merged) [&lt;commit&gt;]]\n               [--contains [&lt;commit]] [--no-contains [&lt;commit&gt;]]\n               [--points-at &lt;object&gt;] [--format=&lt;format&gt;] [&lt;pattern&gt;...]\n\n       git branch --edit-description [&lt;branchname&gt;]\n</code></pre>","tags":["git","branch"]},{"location":"blog/20180906/git-show-branch/#description","title":"description","text":"<p>\u6267\u884c <code>vim .git/description</code> \u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u4ed3\u5e93\u7684\u63cf\u8ff0\uff1a</p> <pre><code> Unnamed repository; edit this file 'description' to name the repository.\n</code></pre> <p>\u53ef\u4ee5\u6267\u884c <code>git branch --edit-description [&lt;branchname&gt;]</code> \u5bf9\u6307\u5b9a\uff08\u5f53\u524d\uff09branch \u7684\u63cf\u8ff0\u4fe1\u606f\u8fdb\u884c\u7f16\u8f91\u3002 \u7b49\u6548\u547d\u4ee4\u4e3a <code>git config branch.&lt;branch name&gt;.description</code>\u3002</p> <p>\u4f8b\u5982\u4e3a testEmptyApplication \u5206\u652f\u6dfb\u52a0\u63cf\u8ff0\uff0c\u7136\u540e\u6267\u884c <code>git config -l</code> \u53ef\u4ee5\u770b\u5230\u914d\u7f6e\u4e2d\u6709\u5982\u4e0b\u884c\uff1a</p> <pre><code>branch.testEmptyApplication.description=test branch description\n</code></pre> <p>The <code>.git/description</code> file is only used in the Git-Web program.</p> <ul> <li>Branch descriptions in Git </li> <li>Changing repository description in git </li> </ul>","tags":["git","branch"]},{"location":"blog/20180906/git-show-branch/#list_branches","title":"list branches","text":"<p>If <code>--list</code> is given, or if there are no non-option arguments, existing branches are listed; the current branch will be highlighted with an asterisk.  </p> <p>Option <code>-r</code> causes the remote-tracking branches to be listed, and option <code>-a</code> shows both local and remote branches.  </p> <p><code>git branch</code> \u7b49\u6548\u4e8e <code>git branch --list</code>\uff0c\u5217\u4e3e\u672c\u5730 checkout \u51fa\u6765\u7684\u4ed3\u5e93\uff0c\u5f53\u524d\u4ed3\u5e93\u4f1a\u4ee5\u661f\u53f7 <code>*</code> \u6807\u8bb0\u3002 <code>git branch -r</code> \u5217\u4e3e\u8fdc\u7aef\u4ed3\u5e93 remotes/origin/ \u4e0b\u7684\u6240\u6709\u5206\u652f\u3002 <code>git branch -a</code> \u5217\u4e3e\u672c\u5730\uff08<code>--list</code>\uff09 + \u8fdc\u7aef\uff08<code>-r</code>\uff09\u7684\u6240\u6709\u5206\u652f\u3002  </p> <p>git \u83b7\u53d6\u5f53\u524d\u5206\u652f\u540d</p> <pre><code>git symbolic-ref --short -q HEAD\n</code></pre> <p>git\u67e5\u770b\u5f53\u524d\u5206\u652f\u6240\u5c5e</p> <ol> <li>git config -l  </li> <li>git branch -v  </li> </ol>","tags":["git","branch"]},{"location":"blog/20180906/git-show-branch/#pattern","title":"pattern","text":"<p><code>git branch --list '*NestFile*'</code>\uff1a\u672c\u5730\u540d\u79f0\u4e2d\u5305\u542b NestFile \u7684\u5206\u652f\uff1b <code>git branch --list '*Send*Album*'</code>\uff1a\u672c\u5730\u540d\u79f0\u4e2d\u5305\u542b Send \u548c Album \u7684\u5206\u652f\uff1b  </p>","tags":["git","branch"]},{"location":"blog/20180906/git-show-branch/#find_parent_branch","title":"Find Parent Branch","text":"<p>findParent.sh who_is_my_mummy.sh </p> <p>find the parent branch Git show parent branch </p> <p>Find the parent branch of a Git branch @stackoverflow </p> <p>How to find the nearest parent of a Git branch?</p> <pre><code>git log --decorate \\\n  | grep 'commit' \\\n  | grep 'origin/' \\\n  | head -n 2 \\\n  | tail -n 1 \\\n  | awk '{ print $2 }' \\\n  | tr -d \"\\n\"\n</code></pre> <p>\u9488\u5bf9\u4ee5\u4e0a commit-sha1 \u518d\u6267\u884c git log -1 \u67e5\u770b\u5176 log\u3002</p> <p>Git First-Parent--Have your messy history and eat it too </p>","tags":["git","branch"]},{"location":"blog/20180905/git-diff/","title":"git diff\u67e5\u770b\u5dee\u5f02","text":"<p>\u672c\u6587\u8bb0\u5f55\u4e86\u4f7f\u7528 git diff \u547d\u4ee4\u8fdb\u884c\u5bf9\u6bd4\u4ee3\u7801\u53d8\u52a8\u5dee\u5f02\u7684\u57fa\u672c\u7528\u6cd5\u3002</p>","tags":["git","diff"]},{"location":"blog/20180905/git-diff/#git_help_diff","title":"git help diff","text":"<pre><code>GIT-DIFF(1)                                 Git Manual                                 GIT-DIFF(1)\n\n\n\nNAME\n       git-diff - Show changes between commits, commit and working tree, etc\n\nSYNOPSIS\n       git diff [&lt;options&gt;] [&lt;commit&gt;] [--] [&lt;path&gt;...]\n       git diff [&lt;options&gt;] --cached [&lt;commit&gt;] [--] [&lt;path&gt;...]\n       git diff [&lt;options&gt;] &lt;commit&gt; &lt;commit&gt; [--] [&lt;path&gt;...]\n       git diff [&lt;options&gt;] &lt;blob&gt; &lt;blob&gt;\n       git diff [&lt;options&gt;] --no-index [--] &lt;path&gt; &lt;path&gt;\n\n\nDESCRIPTION\n       Show changes between the working tree and the index or a tree, changes between the index\n       and a tree, changes between two trees, changes between two blob objects, or changes between\n       two files on disk.\n</code></pre> <p>Git\u7b14\u8bb0\uff1agit diff \u7684\u7528\u6cd5 Git diff \u5e38\u89c1\u7528\u6cd5 Git\u67e5\u770b\u7248\u672c\u6539\u52a8 \u2014\u2014 git diff </p>","tags":["git","diff"]},{"location":"blog/20180905/git-diff/#git_diff","title":"git diff","text":"<p>\u53c2\u8003 git\u4e0d\u540c\u9636\u6bb5\u64a4\u56de</p> <p><code>git diff</code>: \u67e5\u770b\u5df2\u4fee\u6539\uff0c\u672a\u6682\u5b58\u7684\u5185\u5bb9 <code>git diff --cached</code>: \u67e5\u770b\u5df2\u6682\u5b58\uff0c\u672a\u63d0\u4ea4\u7684\u5185\u5bb9 <code>git diff origin/master master</code>: \u67e5\u770b\u5df2\u63d0\u4ea4\uff0c\u672a\u63a8\u9001\u7684\u5dee\u5f02  </p> <pre><code>\u5de5\u4f5c\u533a             \u6682\u5b58\u533a                        \u672c\u5730\u4ed3\u5e93                               \u8fdc\u7a0b\u4ed3\u5e93\n    \\            /      \\                    /        \\                             /\n     \\         /          \\                 /           \\                          /\n     git diff             git diff --cached             git diff origin/master master\n</code></pre>","tags":["git","diff"]},{"location":"blog/20180905/git-diff/#git_diff_between_commit","title":"git diff between commit","text":"<p>\u5bf9\u6bd4 HEAD \u76f8\u5bf9\u4e4b\u524d\u67d0\u6b21\u63d0\u4ea4\u70b9\u7684\u5dee\u5f02\uff1a</p> <pre><code>$ git diff commit_id HEAD\n</code></pre> <p>\u67e5\u770b\u672c\u5730\u4ed3\u5e93\u6700\u8fd1\u4e00\u6b21\u63d0\u4ea4\u7684\u53d8\u66f4\uff1a</p> <pre><code>$ git diff HEAD^ HEAD\n</code></pre> <p>HEAD \u76f8\u5bf9\u524d\u4e00\u6b21 HEAD^ \u7684\u5dee\u5f02\uff0c\u5373\u4e3a HEAD \u8fd9\u6b21\u63d0\u4ea4\u7684\u4fee\u6539\u3002</p> <p>As of Git 1.8.5, <code>@</code> is an alias for <code>HEAD</code>, so you can use:</p> <pre><code>$ git diff @~..@\n</code></pre> <p>\u7531\u4e8e\u9ed8\u8ba4\u7684\u5bf9\u6bd4\u76ee\u6807\u4e3a HEAD \u53ef\u7701\u7565\uff0c\u6545 <code>git diff commit_id</code> \u7b49\u6548\u4e8e <code>git diff commit_id HEAD</code>\u3002</p> <p>\u4ee5\u4e0b\u56db\u79cd\u5199\u6cd5\u90fd\u7b49\u6548\u4e8e <code>git diff HEAD^ HEAD</code>\uff1a</p> <pre><code>git diff HEAD^\ngit diff HEAD~\ngit diff HEAD~1\ngit diff @^\ngit diff @~\ngit diff @~1\n</code></pre> <p>\u53ef\u4ee5\u67e5\u770b HEAD \u8fd9\u6b21\u63d0\u4ea4\u4e86\u54ea\u4e9b\u6587\u4ef6\uff1a</p> <pre><code>$ git diff --name-status HEAD~1..HEAD\n</code></pre> <p>\u5982\u679c HEAD \u8fd9\u6b21\u63d0\u4ea4\u4fee\u6539\u4e86 <code>include/liteif.h</code> \u6587\u4ef6\uff0c\u5219\u53ef\u4ee5\u6307\u5b9a\u53ea\u67e5\u770b\u8fd9\u6b21\u63d0\u4ea4\u8be5\u6587\u4ef6\u7684\u4fee\u6539\uff1a</p> <pre><code>$ git diff HEAD^ HEAD include/liteif.h\n$ git diff HEAD^ HEAD -- include/liteif.h\n</code></pre> <p>\u5982\u679c\u6307\u5b9a\u4e86\u4e00\u4e2a\u4e0d\u5728\u672c\u6b21\u63d0\u4ea4\u4e2d\u7684\u6587\u4ef6\uff0c\u5219\u4ee5\u4e0a\u5bf9\u6bd4\u8f93\u51fa\u4e3a\u7a7a\u3002</p> <p>Diff between first and third commit:</p> <pre><code>$ git diff HEAD~2 HEAD\n</code></pre> <p>Diff between second and third commit:</p> <pre><code>$ git diff HEAD~2 HEAD~1\n</code></pre>","tags":["git","diff"]},{"location":"blog/20180905/git-diff/#git_diff_between_branches","title":"git diff between branches","text":"<p>git \u5bf9\u6bd4\u4e24\u4e2a\u5206\u652f\u5dee\u5f02 git diff \u67e5\u770b\u4e24\u4e2a\u5206\u652f\u7684\u533a\u522b\u5e76\u5c06\u7ed3\u679c\u8f93\u51fa\u5230\u6307\u5b9a\u6587\u4ef6 </p> <p>git-diff - Show changes between commits, commit and working tree, etc How to compare files from two different branches?</p> <pre><code>ifan@FAN-MC1:~/Projects/git.code.com/scenario|dev-checkpskey\u26a1\n\u21d2  git diff remote-upstream-branch dev-substream-branch -- src/static/js/util.js\n</code></pre> <p>\u5bf9\u6bd4\u5b50\u6d41\uff08\u53f3\uff09\u9488\u5bf9\u7236\u6d41\uff08\u5de6\uff09\u7684\u67d0\u4e2a\u6587\u4ef6\u4fee\u6539\u3002</p> <p>How do I get araxis merge to work as a git difftool</p> <p>Git Tree Compare </p> <p>Compare branches (GitHub-style diff)  How to compare different branches on Visual studio code </p> <pre><code>git diff origin/bugfix-pskeyerror origin/master &gt;&gt; ~/desktop-m_bugfix-pskeyerror.diff\n\ngit diff origin/bugfix-pskeyerror-m origin/master &gt;&gt; ~/core-doc_bugfix-pskeyerror-m.diff\n</code></pre>","tags":["git","diff"]},{"location":"blog/20180905/git-diff/#git_external_diff","title":"GIT_EXTERNAL_DIFF","text":"<p>How can I get a side-by-side diff when I do \u201cgit diff\u201d?</p> <p>There are two different ways to specify an external diff tool:</p> <ol> <li>setting the <code>GIT_EXTERNAL_DIFF</code> and the <code>GIT_DIFF_OPTS</code> environment variables.  </li> <li>configuring the external diff tool via <code>git config</code> </li> </ol> <p>\u4ee5\u4e0b\u4e3a macOS \u4e0b\u914d\u7f6e araxis merge \u4f5c\u4e3a git \u5916\u90e8 difftool\u3002</p> <p>\u547d\u4ee4\u884c\u6267\u884c <code>vim ~/.gitconfig</code> \u6253\u5f00\u7f16\u8f91 git \u914d\u7f6e</p> <pre><code>[difftool]\n    prompt = false\n[diff]\n    tool = araxis\n[difftool \"araxis\"]\n    path = /Applications/Araxis Merge.app/Contents/Utilities/compare\n\n[mergetool]\n    prompt = false\n    keepTemporaries = false\n    trustExitCode = false\n    keepBackup = false\n[merge]\n    tool = araxis\n[mergetool \"araxis\"]\n    path = /Applications/Araxis Merge.app/Contents/Utilities/compare\n</code></pre> <p>\u914d\u7f6e\u597d git difftool \u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c <code>git difftool</code>\uff08\u66ff\u6362 <code>git diff</code>\uff09\uff0c\u6253\u5f00\u7b2c\u4e09\u65b9\u5bf9\u6bd4\u5de5\u5177\u5bf9\u6bd4\u4ee3\u7801\u5dee\u5f02\u3002</p> <p>\u5bf9\u6bd4 FATransferMgrUp \u5934\u6587\u4ef6\u53ca\u5176\u5b9e\u73b0\u6587\u4ef6\u5f53\u524d\u7684\u4fee\u6539\uff08\u5c1a\u672a staged\uff09\uff1a</p> <pre><code>$ git difftool -- Classes/module/FileService/FATransferMgrUp.*\n</code></pre> <p>\u5bf9\u6bd4 <code>Classes</code> \u76ee\u5f55\u672c\u5730\u5c1a\u672a staged \u548c\u5df2\u7ecf staged \u7684\u4ee3\u7801\u5dee\u5f02\uff1a</p> <pre><code># Working Tree vs. index\n$ git difftool -- Classes/\n\n# index vs. HEAD(repo)\n$ git difftool --staged Classes/\n</code></pre> <p>\u8c03\u8d77 difftool\uff08Araxis Merge\uff09\u6253\u5f00\u67e5\u770b\u6700\u8fd1\u4e00\u6b21\u63d0\u4ea4\u7684\u4ee3\u7801\u5dee\u5f02\uff1a</p> <pre><code>$ git difftool HEAD^ HEAD\n</code></pre> <p>\u67e5\u770b 5c54bc3a \u8fd9\u6b21\u63d0\u4ea4\u7684\u4fee\u6539\uff1a</p> <pre><code>$ git difftool 5c54bc3a^ 5c54bc3a\n\n# \u67e5\u770b\u8fd9\u6b21\u4fee\u6539\u4e2d\u5177\u4f53\u67d0\u4e2a\u8def\u5f84\uff08\u6587\u4ef6\uff09\u7684\u53d8\u66f4\ngit difftool 5c54bc3a^ 5c54bc3a -- Classes/module/FileService/AIOFileEventHandler.m\n</code></pre>","tags":["git","diff"]},{"location":"blog/20180905/git-diff/#exit","title":"exit","text":"<p>\u5982\u679c\u8981\u5bf9\u6bd4\u7684\u63d0\u4ea4\u4e2d\u5305\u542b\u591a\u4e2a\u6587\u4ef6\uff0c<code>git difftool</code> \u4f1a\u9010\u4e2a\u6253\u5f00\u6587\u4ef6\u5bf9\u6bd4\uff0c\u5047\u5982\u4e2d\u9014\u60f3\u9000\u51fa\uff0c\u53ef\u4ee5\u6309\u4e0b <code>Ctrl-C</code> \u4e2d\u65ad\u9000\u51fa\u3002</p>","tags":["git","diff"]},{"location":"blog/20180905/git-format-patch/","title":"git\u751f\u6210\u8865\u4e01\u548c\u5e94\u7528\u8865\u4e01","text":"<p>\u672c\u6587\u8bb0\u5f55\u4e86\u4f7f\u7528 git diff \u547d\u4ee4\u751f\u6210 patch \u548c git appy \u5e94\u7528 patch \u7684\u57fa\u672c\u64cd\u4f5c\u65b9\u6cd5\u3002</p>","tags":["git","diff","patch"]},{"location":"blog/20180905/git-format-patch/#git_diff_\u751f\u6210_patch","title":"git diff \u751f\u6210 patch","text":"<p>git \u751f\u6210patch\u548c\u4f7f\u7528patch </p> <pre><code>git diff &gt; patch\ngit diff --staged &gt; patch\n</code></pre> <pre><code>git diff -- Classes &gt; ~/bugfix/Classes.patch\ngit diff --staged -- Classes &gt; ~/bugfix/Classes.patch\n\ngit stash show stash@{1} --patch &gt; patch\n</code></pre>","tags":["git","diff","patch"]},{"location":"blog/20180905/git-format-patch/#git_appy_\u5e94\u7528_patch","title":"git appy \u5e94\u7528 patch","text":"<p>\u68c0\u67e5patch\u6587\u4ef6\uff1a</p> <pre><code>$ git apply --stat ~/bugfix/FAViewController.patch\n</code></pre> <p>\u67e5\u770b\u662f\u5426\u80fd\u5e94\u7528\u6210\u529f\uff1a</p> <pre><code>$ git apply --check ~/bugfix/FAViewController.patch\n</code></pre> <p>\u5e94\u7528 patch\uff1a</p> <pre><code>$ git am -s &lt; ~/bugfix/FAViewController.patch\n</code></pre> <p>\u4e2d\u9014\u653e\u5f03\uff1a<code>git am --abort</code></p>","tags":["git","diff","patch"]},{"location":"blog/20180905/git-format-patch/#refs","title":"refs","text":"<p>git format-patch \u751f\u6210\u6307\u5b9acommit\u7684\u8865\u4e01 \u4f7f\u7528 git format-patch \u751f\u6210patch\u548c\u5e94\u7528patch </p> <p>\u5982\u4f55\u4f7f\u7528 git \u751f\u6210patch \u548c\u6253\u5165patch Git \u6253\u8865\u4e01-- patch \u548c diff \u7684\u4f7f\u7528 </p>","tags":["git","diff","patch"]},{"location":"blog/20180905/git-log/","title":"git log\u67e5\u770b\u65e5\u5fd7","text":"<p>\u672c\u6587\u8bb0\u5f55\u4e86\u4f7f\u7528 git log \u547d\u4ee4\u67e5\u770b\u4ee3\u7801\u63d0\u4ea4\u65e5\u5fd7\u7684\u57fa\u672c\u64cd\u4f5c\u65b9\u6cd5\u3002</p>","tags":["git","log"]},{"location":"blog/20180905/git-log/#git_help_log","title":"git help log","text":"<p>\u6267\u884c <code>git log -h</code> \u67e5\u770b\u6982\u8981 usage\uff1a</p> <pre><code>$ git log -h\nusage: git log [&lt;options&gt;] [&lt;revision-range&gt;] [[--] &lt;path&gt;...]\n   or: git show [&lt;options&gt;] &lt;object&gt;...\n\n    -q, --quiet           suppress diff output\n    --source              show source\n    --use-mailmap         Use mail map file\n    --decorate-refs &lt;pattern&gt;\n                          only decorate refs that match &lt;pattern&gt;\n    --decorate-refs-exclude &lt;pattern&gt;\n                          do not decorate refs that match &lt;pattern&gt;\n    --decorate[=...]      decorate options\n    -L &lt;n,m:file&gt;         Process line range n,m in file, counting from 1\n</code></pre> <p>\u6267\u884c <code>git help log</code> \u67e5\u770b\u8be6\u7ec6 man-page\uff1a</p> <pre><code>GIT-LOG(1)                                  Git Manual                                  GIT-LOG(1)\n\n\n\nNAME\n       git-log - Show commit logs\n\nSYNOPSIS\n       git log [&lt;options&gt;] [&lt;revision range&gt;] [[--] &lt;path&gt;...]\n\n\nDESCRIPTION\n       Shows the commit logs.\n\n       The command takes options applicable to the git rev-list command to control what is shown\n       and how, and options applicable to the git diff-* commands to control how the changes each\n       commit introduces are shown.\n</code></pre> <p>git log cheatsheet</p> <p>What are commit-ish and tree-ish in Git?</p> <p><code>&lt;sha1&gt;</code>\uff1a <code>&lt;refname&gt;</code>\uff1a <code>&lt;refname&gt;@{&lt;date&gt;}</code>\uff1amaster@{yesterday}, HEAD@{5 minutes ago} <code>&lt;refname&gt;@{upstream}</code> / <code>master@{u}</code>\uff1a  </p>","tags":["git","log"]},{"location":"blog/20180905/git-log/#git_log_\u8be6\u7ec6\u4f7f\u7528\u53c2\u6570","title":"git log \u8be6\u7ec6\u4f7f\u7528\u53c2\u6570","text":"\u9009\u9879 \u8bf4\u660e <code>--graph</code> \u4ee5 ASCII \u5b57\u7b26\u56fe\u5f62\u663e\u793a\u5206\u652f\u63d0\u4ea4\u5408\u5e76\u5386\u53f2\u3002 <code>--abbrev-commit</code> \u4ec5\u663e\u793a SHA-1 \u7684\u524d\u51e0\u4e2a\u5b57\u7b26\uff0c\u800c\u975e\u6240\u6709\u7684 40 \u4e2a\u5b57\u7b26 <code>--relative-date</code> \u4f7f\u7528\u8f83\u77ed\u7684\u76f8\u5bf9\u65f6\u95f4\u663e\u793a\uff0c\u4f8b\u5982 \u201c2 weeks ago\u201d","tags":["git","log"]},{"location":"blog/20180905/git-log/#gitrevisions","title":"gitrevisions","text":"<p>\u6267\u884c <code>git help revisions</code> \u6216 <code>man gitrevisions</code> \u67e5\u770b gitrevisions \u8bae\u9898\u76f8\u5173\u624b\u518c\u3002</p> <pre><code>GITREVISIONS(7)                                                           Git Manual                                                          GITREVISIONS(7)\n\n\n\nNAME\n       gitrevisions - Specifying revisions and ranges for Git\n\nSYNOPSIS\n       gitrevisions\n</code></pre> <pre><code>       &lt;revision range&gt;\n           Show only commits in the specified revision range. When no &lt;revision\n           range&gt; is specified, it defaults to HEAD (i.e. the whole history\n           leading to the current commit).  origin..HEAD specifies all the\n           commits reachable from the current commit (i.e.  HEAD), but not from\n           origin. For a complete list of ways to spell &lt;revision range&gt;, see the\n           Specifying Ranges section of gitrevisions(7).\n</code></pre> <p><code>git log &lt;&gt;</code></p> <p>ORIG_HEAD, FETCH_HEAD, MERGE_HEAD etc </p>","tags":["git","log"]},{"location":"blog/20180905/git-log/#limit","title":"limit","text":"\u9009\u9879 \u8bf4\u660e <code>-(n)</code> \u4ec5\u663e\u793a\u6700\u8fd1\u7684 n \u6761\u63d0\u4ea4: git log -n 2 \u6216 git log -2 <code>--skip</code> \u6307\u5b9a\u8df3\u8fc7\u524d\u51e0\u6761\u65e5\u5fd7","tags":["git","log"]},{"location":"blog/20180905/git-log/#date","title":"date","text":"\u9009\u9879 \u8bf4\u660e <code>--since</code>, <code>--after</code> \u4ec5\u663e\u793a\u6307\u5b9a\u65f6\u95f4\u4e4b\u540e\u7684\u63d0\u4ea4 <code>--until</code>, <code>--before</code> \u4ec5\u663e\u793a\u6307\u5b9a\u65f6\u95f4\u4e4b\u524d\u7684\u63d0\u4ea4 <pre><code>       --since=&lt;date&gt;, --after=&lt;date&gt;\n           Show commits more recent than a specific date.\n\n       --until=&lt;date&gt;, --before=&lt;date&gt;\n           Show commits older than a specific date.\n</code></pre> <p>\u7efc\u5408\u793a\u4f8b\uff1a</p> <p>\u67e5\u770b fan2 \u5728 2019\u5e7411\u67084\u65e5\u4e4b\u540e\u7684\u63d0\u4ea4\uff1a</p> <pre><code>git log --author=\"fan2\" --after=\"2019-11-04\"\n</code></pre> <p>\u67e5\u770b fan2 \u81ea 2017\u5e741\u67081\u65e5 \u4e4b\u540e\u7684\u63d0\u4ea4\uff1a</p> <pre><code>git log --author=fan2 --since=\"2017-01-01\"\n\ncommit 9156d24ec9008d2a13a47a8409746f13100450df (HEAD -&gt; master)\nMerge: cdc58a8a 1b5559ad\nAuthor: fan2 &lt;929683282@qq.com&gt;\nDate:   Mon Nov 4 18:45:07 2019 +0800\n\n    Merge remote-tracking branch 'upstream/master'\n\ncommit cdc58a8a241e972f969bdfdd55a4b867a9bb4687 (origin/master, origin/HEAD)\nAuthor: fan2 &lt;929683282@qq.com&gt;\nDate:   Sat Feb 23 15:06:27 2019 +0800\n\n    \u8865\u5145 mars \u53c2\u8003\u3002\n</code></pre> <p>\u67e5\u770b fan2 \u5728 2019\u5e7411\u67084\u65e5\u4e4b\u540e\u30012019\u5e7411\u67088\u65e5\u4e4b\u524d \u7684\u63d0\u4ea4\uff1a</p> <pre><code>git log --author=\"fan2\" --since=\"2019-11-04\" --until=\"2019-11-08\"\n</code></pre> <p>git log with date range or before after How to checkout in Git by date? How does git log --since count? How to change Git log date formats </p>","tags":["git","log"]},{"location":"blog/20180905/git-log/#message","title":"message","text":"\u9009\u9879 \u8bf4\u660e <code>--name-only</code> \u4ec5\u663e\u793a\u4fee\u6539\u7684\u6587\u4ef6\u6e05\u5355\uff08\u4e0d\u5305\u542b\u76f8\u5bf9\u8def\u5f84\uff09 <code>--name-status</code> \u663e\u793a\u4fee\u6539\u6587\u4ef6\u6e05\u5355\uff0c\u884c\u9996\u4ee5 M\u3001D \u7b49\u6807\u8bb0\u53d8\u66f4\u72b6\u6001 <code>--shortstat</code> \u4ec5\u663e\u793a --stat \u6700\u540e\u7684\u589e\u5220\u6539\u6982\u8981\u4fe1\u606f <code>--stat</code> \u663e\u793a\u4fee\u6539\u7684\u6587\u4ef6\u5217\u8868\uff08\u76f8\u5bf9\u8def\u5f84\uff09\u53ca\u589e\u5220\u6539\u7edf\u8ba1\u4fe1\u606f <code>-p</code> \u6309\u8865\u4e01\u683c\u5f0f\u663e\u793a\u6bcf\u4e2a\u6587\u4ef6\u4e4b\u95f4\u7684\u5dee\u5f02\uff08diff\uff09 <p><code>git log -p</code> \u76f8\u5f53\u4e8e\u591a\u6b21\u8c03\u7528 <code>git show [commit_hashid]</code>\u3002</p>","tags":["git","log"]},{"location":"blog/20180905/git-log/#pretty","title":"pretty","text":"<p><code>git log --pretty</code>\uff1a\u4f7f\u7528\u5176\u4ed6\u683c\u5f0f\u663e\u793a\u5386\u53f2\u63d0\u4ea4\u4fe1\u606f\u3002\u53ef\u7528\u7684\u9009\u9879\u5305\u62ec oneline\uff0cshort\uff0cfull\uff0cfuller \u548c format\uff08\u540e\u8ddf\u6307\u5b9a\u683c\u5f0f\uff09\u3002</p>","tags":["git","log"]},{"location":"blog/20180905/git-log/#decorate_graph","title":"decorate graph","text":"<p>git\u67e5\u770b\u5404\u4e2abranch\u4e4b\u95f4\u7684\u5173\u7cfb\u56fe</p> <pre><code>$ git log --graph --decorate --oneline --simplify-by-decoration --all\n</code></pre> <p>\u8bf4\u660e\uff1a</p> <p><code>--decorate</code>\uff1a\u6807\u8bb0\u4f1a\u8ba9 git log \u663e\u793a\u6bcf\u4e2a commit \u7684\u5f15\u7528(\u5982 \u5206\u652f\u3001tag \u7b49)\u00a0 <code>--oneline</code>\uff1a\u4e00\u884c\u663e\u793a <code>--simplify-by-decoration</code>\uff1a\u53ea\u663e\u793a\u88abbranch\u6216tag\u5f15\u7528\u7684commit <code>--all</code>\uff1a\u8868\u793a\u663e\u793a\u6240\u6709\u7684branch\u3002\u8fd9\u91cc\u4e5f\u53ef\u4ee5\u9009\u62e9\uff0c\u6bd4\u5982\u6307\u5411\u663e\u793a\u5206\u652f ABC \u7684\u5173\u7cfb\uff0c\u5219\u5c06 --all \u66ff\u6362\u4e3a branchA branchB branchC \u5373\u53ef\u3002</p>","tags":["git","log"]},{"location":"blog/20180905/git-log/#search","title":"search","text":"\u9009\u9879 \u8bf4\u660e <code>--author</code> \u4ec5\u663e\u793a\u6307\u5b9a\u4f5c\u8005\u76f8\u5173\u7684\u63d0\u4ea4 <code>--committer</code> \u4ec5\u663e\u793a\u6307\u5b9a\u63d0\u4ea4\u8005\u76f8\u5173\u7684\u63d0\u4ea4 <code>--grep</code> \u4ec5\u663e\u793a\u542b\u6307\u5b9a\u5173\u952e\u5b57\u7684\u63d0\u4ea4 <code>-S</code> \u4ec5\u663e\u793a\u6dfb\u52a0\u6216\u79fb\u9664\u4e86\u67d0\u4e2a\u5173\u952e\u5b57\u7684\u63d0\u4ea4","tags":["git","log"]},{"location":"blog/20180905/git-log/#mutil-author","title":"mutil-author","text":"<p>\u540c\u65f6\u8fc7\u6ee4\u591a\u4e2a\u4f5c\u8005\u7684\u63d0\u4ea4\u65e5\u5fd7\uff1a</p> <pre><code>$ git log --author='zhangsan' --author='lisi' --merges\n</code></pre> <p>\"git log\" does not work for multiple author filtering</p> <pre><code>$ git config --global grep.extendedRegexp true\n</code></pre> <p>GIT: filter log by group of authors</p> <pre><code>$ git log --perl-regexp --author='zhangsan|lisi' --merges\n</code></pre>","tags":["git","log"]},{"location":"blog/20180905/git-log/#\u67e5\u770b\u67d0\u4e2a\u6587\u4ef6\u7684\u65e5\u5fd7","title":"\u67e5\u770b\u67d0\u4e2a\u6587\u4ef6\u7684\u65e5\u5fd7","text":"<pre><code>       [--] &lt;path&gt;...\n           Show only commits that are enough to explain how the files that match\n           the specified paths came to be. See History Simplification below for\n           details and other simplification modes.\n\n           Paths may need to be prefixed with -- to separate them from options or\n           the revision range, when confusion arises.\n</code></pre> <p>\u67e5\u770b\u6587\u4ef6 <code>include/liteif.h</code> \u6700\u8fd13\u6b21\u7684\u63d0\u4ea4\u65e5\u5fd7\uff1a</p> <pre><code>$ #git log -3 --stat include/liteif.h | cat\n$ git log -3 --stat -- include/liteif.h | cat\n</code></pre>","tags":["git","log"]},{"location":"blog/20180905/git-log/#-p","title":"-p","text":"<p><code>git log [[--] &lt;path&gt;...]</code>\uff0c\u5176\u4e2d path \u4e3a\u5f53\u524d\u76ee\u5f55\u76f8\u5bf9\u8def\u5f84</p> <pre><code>~/Projects/github/libNET/mars\n0 master % git log mars/comm/messagequeue/message_queue.cc\n</code></pre> <p><code>git log -p &lt;path&gt;</code>\uff1a\u67e5\u770b\u6307\u5b9a\u6587\u4ef6\u65e5\u5fd7\uff0c\u5e76\u6253\u5370\u8be6\u7ec6\u7684 <code>--full-diff</code>\u3002</p> <p>\u67e5\u770b\u67d0\u6b21 commit-sha1 \u7684\u5177\u4f53\u4fee\u6539\uff08\u663e\u793a diff-patch \u8be6\u60c5\uff09</p> <pre><code>git log -p -1 ff26476c7d42bf80f268ccf8b0b7ed1fcf39962c\n</code></pre>","tags":["git","log"]},{"location":"blog/20180905/git-log/#\u67e5\u770b\u67d0\u6b21\u63d0\u4ea4\u7684\u65e5\u5fd7","title":"\u67e5\u770b\u67d0\u6b21\u63d0\u4ea4\u7684\u65e5\u5fd7","text":"<p>git log \u6307\u5b9a\u67d0\u6b21 commit \u7684 HASH \u503c\uff0c\u5373\u53ef\u67e5\u770b\u67d0\u6b21\u63d0\u4ea4\u53ca\u4e4b\u524d\u7684\u65e5\u5fd7\uff1a</p> <pre><code>~/Projects/github/libNET/mars\n0 master % git log c6938ef4c3b308c6aa423938678599b200100451\n</code></pre> <p>\u9ed8\u8ba4\u663e\u793a\u81ea\u67d0\u6b21\u63d0\u4ea4\u4e4b\u524d\u7684\u65e5\u5fd7\uff0c\u6dfb\u52a0 <code>-n 1</code> \u9009\u9879\u9650\u5b9a\u53ea\u67e5\u770b\u67d0\u4e00\u6b21\u7684\u63d0\u4ea4\u3002</p> <p>\u67e5\u770b <code>66932f0c</code> \u8fd9\u4e00\u6b21\u63d0\u4ea4\u53ca\u4e4b\u524d\u90a3\u4e00\u6b21\u7684\u65e5\u5fd7\uff1a</p> <pre><code>$ git log 66932f0c -2 | cat\n</code></pre> <p>\u67e5\u770b <code>66932f0c</code> \u8fd9\u4e00\u6b21\u63d0\u4ea4\u7684\u65e5\u5fd7\uff1a</p> <pre><code>$ git log 66932f0c -1 | cat\n</code></pre> <p>\u67e5\u770b <code>66932f0c</code> \u8fd9\u4e00\u6b21\u63d0\u4ea4\u4e4b\u524d\u7684\u90a3\u4e00\u6b21\u7684\u65e5\u5fd7\uff1a</p> <pre><code>$ git log 66932f0c^ -1 | cat\n</code></pre>","tags":["git","log"]},{"location":"blog/20180905/git-log/#\u67e5\u770b\u5408\u5e76\u7684\u63d0\u4ea4\u8bb0\u5f55","title":"\u67e5\u770b\u5408\u5e76\u7684\u63d0\u4ea4\u8bb0\u5f55","text":"<ul> <li><code>--merges</code> \u8fc7\u6ee4\u51fa Merge Request \u63d0\u4ea4\uff1b  </li> <li><code>--no-merges</code> \u8fc7\u6ee4\u51fa\u975e Merge Request \u7684\u539f\u59cb\u63d0\u4ea4\uff1b  </li> </ul> <pre><code>git log --author=\"fan2\" --merges\n</code></pre> <p>\u7efc\u5408\u793a\u4f8b\uff1a\u67e5\u770b fan2 \u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u7684 merge \u548c \u975emerge \u63d0\u4ea4\uff1a</p> <pre><code>$ git log --author=\"fan2\" --merges --since=\"2019-11-01\" --until=\"2019-11-10\"\n$ git log --author=\"fan2\" --no-merges --since=\"2019-11-01\" --until=\"2019-11-10\"\n</code></pre>","tags":["git","log"]},{"location":"blog/20180905/git-log/#\u67e5\u770b\u6307\u5b9a\u4ed3\u5e93\u7684\u63d0\u4ea4\u8bb0\u5f55","title":"\u67e5\u770b\u6307\u5b9a\u4ed3\u5e93\u7684\u63d0\u4ea4\u8bb0\u5f55","text":"<p><code>git log</code> \u9ed8\u8ba4\u67e5\u770b\u7684\u662f\u672c\u5730\u5f53\u524d\u4ed3\u5e93\u7684\u65e5\u5fd7\u3002</p>","tags":["git","log"]},{"location":"blog/20180905/git-log/#\u67e5\u770b\u672c\u5730\u4ed3\u5e93\u7684\u63d0\u4ea4\u8bb0\u5f55","title":"\u67e5\u770b\u672c\u5730\u4ed3\u5e93\u7684\u63d0\u4ea4\u8bb0\u5f55","text":"<p>\u67e5\u770b <code>git branch</code>(--list) \u672c\u5730\u4ed3\u5e93\u4e2d\u6307\u5b9a\u4ed3\u5e93\u7684\u65e5\u5fd7\u3002</p> <pre><code>git log feature/8.0.8_PCSendMobileAlbum --author=\"fan2\" --stat\n</code></pre>","tags":["git","log"]},{"location":"blog/20180905/git-log/#\u67e5\u770b\u8fdc\u7aef\u4ed3\u5e93\u7684\u63d0\u4ea4\u8bb0\u5f55","title":"\u67e5\u770b\u8fdc\u7aef\u4ed3\u5e93\u7684\u63d0\u4ea4\u8bb0\u5f55","text":"<p>\u67e5\u770b <code>git branch -r</code> \u8fdc\u7aef\u4ed3\u5e93\uff08origin\uff09\u4e2d\u5f53\u524d\u4ed3\u5e93\u7684\u65e5\u5fd7\uff0c\u4ee5\u4fbf\u5bf9\u6bd4\u672c\u5730\u5c1a\u672a\u540c\u6b65\u7684\u5dee\u5f02\u3002</p> <pre><code>iq git/feature/8.0.8_PCSendMobileAlbum2\n\u276f git log origin/feature/8.0.8_PCSendMobileAlbum --author=\"fan2\" --stat\n</code></pre> <p>\u6307\u5b9a\u5176\u4ed6\u4ed3\u5e93\uff0c\u67e5\u8be2\u76f8\u5e94 commit hash\uff0c\u4ee5\u4fbf\u6267\u884c <code>git cherry-pick</code> \u5c06\u67d0\u4e9b\u63d0\u4ea4\u5408\u5165\u5f53\u524d\u5206\u652f\u3002</p> <p>Log of remote history</p> <pre><code>git fetch\ngit log FETCH_HEAD\n</code></pre>","tags":["git","log"]},{"location":"blog/20180905/git-log/#\u67e5\u770b\u6307\u5b9a\u5206\u652f\u7684\u63d0\u4ea4\u8bb0\u5f55","title":"\u67e5\u770b\u6307\u5b9a\u5206\u652f\u7684\u63d0\u4ea4\u8bb0\u5f55","text":"<p>How do I run git log to see changes only for a specific branch?</p> <p>Git log to get commits only for a specific branch</p> <p>\u6307\u5b9a\u53c2\u6570 <code>--first-parent</code> \u67e5\u770b <code>feature/8.1.0_NewUI</code> \u5206\u652f\u7684\u65e5\u5fd7\uff1a</p> <pre><code>git log --author=\"fan2\" --graph --abbrev-commit --decorate --first-parent feature/8.1.0_NewUI\n</code></pre>","tags":["git","log"]},{"location":"blog/20180906/git-merge-conflicts/","title":"git\u89e3\u51b3\u4ee3\u7801\u51b2\u7a81","text":"<p>\u672c\u6587\u68b3\u7406\u4e86\u89e3\u51b3 git \u51b2\u7a81\u7684\u57fa\u672c\u64cd\u4f5c\u65b9\u6cd5\u3002</p>","tags":["git","checkout"]},{"location":"blog/20180906/git-merge-conflicts/#manual_resolve","title":"manual resolve","text":"<p>Resolving a merge conflict using the command line</p> <p>conflict marker <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code></p> <p>Delete the conflict markers <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>, <code>=======</code>, <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code> and make the changes you want in the final merge. </p> <p>Add or stage your changes and commit.</p> <pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\n///\u5c0f\u7a0b\u5e8f\n#define    TGSHARE_BIZ_ID_BIZ_SRC_MINIAPP    @\"miniapp\"\n=======\n///\u5c0f\u7a0b\u5e8f\u4e1a\u52a1ID\n#define    TGSHARE_BIZ_ID_BIZ_SRC_MINIAPP    @\"applet\"\n&gt;&gt;&gt;&gt;&gt;&gt;&gt; origin/master\n</code></pre>","tags":["git","checkout"]},{"location":"blog/20180906/git-merge-conflicts/#git_handling_merge_conflicts_using_ours_and_theirs","title":"Git: Handling Merge Conflicts Using \"Ours\" and \"Theirs\"","text":"<p>Using <code>--ours</code>/<code>--theirs</code> during a merge</p> <pre><code>(feature) $ git merge master\nAuto-merging myscript.py\nCONFLICT (content): Merge conflict in myscript.py\nAutomatic merge failed; fix conflicts and then commit the result.\n</code></pre> <p>Use <code>--ours</code> keep the version in the current branch</p> <pre><code>$ git checkout --ours myscript.py\n</code></pre> <p>Use <code>--theirs</code> to keep the version from the branch being merged in</p> <pre><code>$ git checkout --theirs myscript.py\n</code></pre>","tags":["git","checkout"]},{"location":"blog/20180906/git-merge-conflicts/#git__resolve_merge_conflicts","title":"Git \u2013 Resolve Merge Conflicts","text":"<p>Change working directory to project folder. Search for all conflicting files.</p> <pre><code>$ cd project-folder\n$ grep -lr '&lt;&lt;&lt;&lt;&lt;&lt;&lt;' .\n</code></pre> <p>Above will list all files which has marker special marker <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code> in them.</p> <p>Resolve easy/obvious conflicts</p> <p>At this point you may review each files. If solution is to accept local/our version, run:</p> <pre><code>$ git checkout --ours PATH/FILE\n</code></pre> <p>If solution is to accept remote/other-branch version, run:</p> <pre><code>$ git checkout --theirs PATH/FILE\n</code></pre> <p>If you have multiple files and you want to accept local/our version, run:</p> <pre><code>$ grep -lr '&lt;&lt;&lt;&lt;&lt;&lt;&lt;' . | xargs git checkout --ours\n</code></pre> <p>If you have multiple files and you want to accept remote/other-branch version, run:</p> <pre><code>$ grep -lr '&lt;&lt;&lt;&lt;&lt;&lt;&lt;' . | xargs git checkout --theirs\n</code></pre> <p>For complex conflicts</p> <p>For files that needs manual review/edit, use vim or any text editor to resolve differences.</p>","tags":["git","checkout"]},{"location":"blog/20180906/git-merge-conflicts/#resolve_git_merge_conflicts_in_favor_of_their_changes_during_a_pull","title":"Resolve Git merge conflicts in favor of their changes during a pull","text":"<pre><code>$ git help merge\n\n       -X &lt;option&gt;, --strategy-option=&lt;option&gt;\n           Pass merge strategy specific option through to the merge strategy.\n</code></pre> <pre><code>$ git pull -s recursive -X theirs &lt;remoterepo or other repo&gt;\n</code></pre> <p>Note that <code>-s</code> recursive here is redundant, since that's the default merge strategy.</p> <p>Or, simply, for the default repository:</p> <pre><code>$ git pull -X theirs\n</code></pre> <p>The <code>git pull -X theirs</code> answers may create an ugly merge commit,</p> <p>If you're already in conflicted state...</p> <pre><code>$ git checkout --theirs path/to/file\n</code></pre> <p><code>git checkout --theirs path/to/file</code> </p> <pre><code>$ git merge -X theirs\n</code></pre> <p>This doesn't work if you are already in the conflict resolution state. In that case I believe the best way to resolve is to <code>git checkout &lt;ref to theirs&gt; -- the/conflicted.file</code> and then git add their changes. </p> <p>Please not that sometimes this will not work:</p> <pre><code>$ git checkout --ours path/to/file\n# or\n$ git checkout --theirs path/to/file\n</code></pre> <p>I did this instead, assuming <code>HEAD</code> is ours and <code>MERGE_HEAD</code> is theirs</p> <pre><code># \u4e3b\u5e72\u5408\u5165\u5206\u652f\u65f6\uff0c\u4f18\u5148\u91c7\u7528\u5f53\u524d\u4e3b\u5e72 HEAD\uff0c\u518d\u624b\u52a8\u5408\u5165\n$ git checkout HEAD -- path/to/file\n# \u5206\u652f rebase \u4e3b\u5e72\u65f6\uff0c\u4ee5\u4e3b\u5e72 MERGE_HEAD \u4e3a\u51c6\uff0c\u518d\u624b\u52a8\u5408\u5165\n$ git checkout MERGE_HEAD -- path/to/file\n</code></pre> <p>After we do this and we are good:</p> <pre><code>$ git add .\n</code></pre> <p>\u91c7\u7528\u672c\u7aef\u7684 HEAD \u6216\u8fdc\u7aef\u7684 MERGE_HEAD\uff0c\u4ee5\u4e00\u65b9\u4f5c\u4e3a\u53c2\u8003\u57fa\u51c6\u4e4b\u540e\uff0c\u518d\u624b\u52a8\u5c06\u76f8\u5bf9\u4fee\u6539\u5408\u5165\u57fa\u51c6\uff0c\u518d\u63d0\u4ea4\u3002</p> <p>\u6267\u884c <code>git merge origin/master</code> \u6709\u51b2\u7a81\u65f6\uff0c\u53ef\u4ee5 \u6267\u884c <code>git rev-parse HEAD</code> \u548c <code>git log -1 | cat</code> \u67e5\u770b\u786e\u8ba4\u5f53\u524d index \u7684\u7248\u672c\u53f7\uff1b \u6267\u884c <code>git rev-parse MERGE_HEAD</code> \u548c <code>git log -1 origin/master | cat</code> \u67e5\u770b\u786e\u8ba4 origin/master \u7684\u7248\u672c\u53f7\u3002  </p>","tags":["git","checkout"]},{"location":"blog/20180906/git-merge-conflicts/#refs","title":"refs","text":"<p>Git MERGE_HEAD \u51b2\u7a81</p> <pre><code>git merge --abort\ngit reset --merge\ngit pull\n</code></pre> <p>Resolve conflict using \"MERGE_HEAD (origin/HEAD)\"</p> <p>vscode \u5feb\u6377\u89e3\u51b3\u51b2\u7a81\uff1a</p> <p></p> <ul> <li>Accept Current Change: ours  </li> <li>Accept Incoming Change: theirs  </li> <li>Accept Both Changes: first ours, then theirs  </li> <li>Compare Changes: compare side-by-side  </li> </ul>","tags":["git","checkout"]},{"location":"blog/20180905/git-reset/","title":"git reset\u64a4\u9500\u63d0\u4ea4","text":"<p>\u672c\u6587\u68b3\u7406\u4e86\u89e3\u51b3 git \u51b2\u7a81\u7684\u57fa\u672c\u64cd\u4f5c\u65b9\u6cd5\u3002</p> <pre><code># man git\n       git-reset(1)\n           Reset current HEAD to the specified state.\n</code></pre> <p>git\u64a4\u9500\u4fee\u6539\u5404\u79cd\u60c5\u51b5 </p> <p><code>HEAD</code> \u8868\u793a\u5f53\u524d\u7248\u672c\uff0c\u4e5f\u5c31\u662f\u6700\u65b0\u7684\u63d0\u4ea4\u3002 <code>HEAD^</code> \u8868\u793a\u4e0a\u4e00\u4e2a\u7248\u672c\uff0c<code>HEAD^^</code> \u8868\u793a\u4e0a\u4e0a\u4e00\u4e2a\u7248\u672c\u3002  </p> <p>\u5f80\u4e0a100\u4e2a\u7248\u672c\u5199\u6210 100 \u4e2a <code>^</code> \u6bd4\u8f83\u9ebb\u70e6\uff0c\u4e00\u822c\u7b80\u5199\u6210 <code>HEAD~100</code>\u3002 <code>HEAD~1</code> \u76f8\u5f53\u4e8e <code>HEAD^</code>\uff0c<code>HEAD~2</code> \u76f8\u5f53\u4e8e <code>HEAD^^</code>\u3002  </p>","tags":["git","reset"]},{"location":"blog/20180905/git-reset/#git\u4e0d\u540c\u9636\u6bb5\u64a4\u56de","title":"git\u4e0d\u540c\u9636\u6bb5\u64a4\u56de","text":"<p>Git\u76844\u4e2a\u9636\u6bb5\u7684\u64a4\u9500\u66f4\u6539</p>","tags":["git","reset"]},{"location":"blog/20180905/git-reset/#\u64a4\u9500\u5de5\u4f5c\u533a\u4fee\u6539","title":"\u64a4\u9500\u5de5\u4f5c\u533a\u4fee\u6539","text":"<p>\u672c\u5730\u5de5\u4f5c\u533a\u4e2d\u4fee\u6539\u4e86\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u5c1a\u672a\u4f7f\u7528 <code>git add</code> \u5c06\u4fee\u6539\u63d0\u4ea4\u5230\u6682\u5b58\u533a\uff1a</p> <ul> <li><code>git checkout -- &lt;file&gt;</code> \u64a4\u9500\u67d0\u6587\u4ef6\u7684\u4fee\u6539\uff1b  </li> <li> <p><code>git checkout .</code>\uff1a\u64a4\u9500\u6240\u6709\u672c\u5730\u7684\u4fee\u6539\uff1b  </p> <p><code>git add .</code> \u5bf9\u5e94 <code>git checkout .</code></p> </li> </ul>","tags":["git","reset"]},{"location":"blog/20180905/git-reset/#\u64a4\u9500\u6682\u5b58\u533a\u4fee\u6539","title":"\u64a4\u9500\u6682\u5b58\u533a\u4fee\u6539","text":"<p>\u5982\u679c\u5df2\u7ecf\u6267\u884c\u4e86 <code>git add</code>\uff0c\u610f\u5473\u7740\u6682\u5b58\u533a\u4e2d\u5df2\u7ecf\u6709\u4e86\u4fee\u6539\uff0c\u4f46\u662f\u9700\u8981\u4e22\u5f03\u6682\u5b58\u533a\u7684\u4fee\u6539\uff0c\u90a3\u4e48\u53ef\u4ee5\u6267\u884c <code>git reset</code>\u3002</p> <ul> <li> <p>\u5bf9\u4e8e\u5df2\u7ecf\u88ab Git \u8ffd\u8e2a\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>git reset &lt;file&gt;</code> \u6765\u5355\u72ec\u5c06\u6587\u4ef6\u4ece\u6682\u5b58\u533a\u4e2d\u4e22\u5f03\uff0c\u5c06\u4fee\u6539\u653e\u56de\u5230\u5de5\u4f5c\u533a\u3002  </p> <p><code>git reset &lt;file&gt;</code> \u9ed8\u8ba4\u643a\u5e26 <code>--soft</code> \u9009\u9879\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u4ece\u6765\u6ca1\u6709\u88ab Git \u8ffd\u8e2a\u8fc7\uff0c\u662f\u65b0\u589e\u6587\u4ef6\uff08new file\uff09\uff0c\u5219\u9700\u8981\u4f7f\u7528 <code>git reset HEAD &lt;file&gt;</code> \u6765\u5c06\u65b0\u6587\u4ef6\u4ece\u6682\u5b58\u533a\u4e2d\u53d6\u51fa\u653e\u56de\u5230\u5de5\u4f5c\u533a\u3002  </p> </li> </ul> <p>\u5982\u679c\u786e\u5b9a\u6682\u5b58\u533a\u4e2d\u7684\u4fee\u6539\u5b8c\u5168\u4e0d\u9700\u8981\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 <code>git reset --hard</code>\uff0c\u4e0d\u4f1a\u5c06\u6682\u5b58\u5185\u5bb9\u56de\u653e\u5230\u5de5\u4f5c\u533a\uff0c\u76f4\u63a5\u4e22\u5f03\u3002</p> <p>\u7531\u4e8e\u6682\u5b58\u533a\u4e2d\u6240\u6709\u4fee\u6539\u90fd\u4f1a\u88ab\u4e22\u5f03\uff0c\u4fee\u6539\u7684\u5185\u5bb9\u4e5f\u4e0d\u4f1a\u88ab\u91cd\u65b0\u653e\u56de\u5de5\u4f5c\u533a\uff0c\u56e0\u6b64\u8bf7\u8c28\u614e\u4f7f\u7528 <code>\u2013-hard</code> \u547d\u4ee4\u9009\u9879\uff01</p>","tags":["git","reset"]},{"location":"blog/20180905/git-reset/#\u64a4\u9500\u672c\u5730\u63d0\u4ea4","title":"\u64a4\u9500\u672c\u5730\u63d0\u4ea4","text":"<p>\u82e5\u5df2\u7ecf\u6267\u884c git add \u548c git commit\uff0c\u4fee\u6539\u5df2\u7ecf\u63d0\u4ea4\u8fdb\u5165\u4e86\u672c\u5730\u4ed3\u5e93\u3002\u5982\u4f55\u64a4\u9500\u6700\u8fd1\u4e00\u6b21\u6216\u591a\u6b21\u7684\u672c\u5730\u63d0\u4ea4\uff1f</p> <pre><code>git reset --hard origin/master\n</code></pre> <p>\u540c\u6837\u8fd8\u662f <code>git reset</code> \u547d\u4ee4\uff0c\u4f46\u662f\u591a\u4e86 <code>origin/master</code>\uff1aorigin \u4e3a\u8fdc\u7aef\u4ed3\u5e93\u7684\u9ed8\u8ba4\u540d\u5b57\uff0c\u53ef\u80fd\u4e5f\u6709\u5176\u4ed6\u7684\u540d\u5b57\uff08\u5982 <code>upstream</code>\uff09\uff0c<code>origin/master</code> \u8868\u793a\u8fdc\u7a0b\u4ed3\u5e93\u3002</p> <p>\u65e2\u7136\u672c\u5730\u7684\u4fee\u6539\u5df2\u7ecf\u4e0d\u518d\u9700\u8981\uff0c\u90a3\u4e48\u4ece\u8fdc\u7aef\u5c06\u4ee3\u7801 \u62c9\u56de\u8986\u76d6\u8fd8\u539f \u5373\u53ef\u3002</p> <p>\u4e0d\u8fc7\u4e0d\u5efa\u8bae\u76f4\u63a5\u4f7f\u7528 <code>git reset --hard origin/master</code> \u8fd9\u6837\u5f3a\u5927\u7684\u547d\u4ee4\u3002\u5982\u679c\u60f3\u8981\u64a4\u9500\u672c\u5730\u6700\u8fd1\u7684\u4e00\u6b21\u63d0\u4ea4\uff0c\u5efa\u8bae\u4f7f\u7528</p> <pre><code>git reset --soft HEAD~1\n</code></pre> <p>\u8fd9\u884c\u547d\u4ee4\u8868\u793a\u5c06\u6700\u8fd1\u4e00\u6b21\u63d0\u4ea4 <code>HEAD~1</code> \u4ece\u672c\u5730\u4ed3\u5e93 \u56de\u9000 \u5230\u6682\u5b58\u533a\u3002</p> <p><code>--soft</code> \u4e0d\u4f1a\u4e22\u5f03\u4fee\u6539\uff0c\u800c\u662f\u5c06\u4fee\u6539\u653e\u56de\u6682\u5b58\u533a\uff0c\u540e\u7eed\u53ef\u7ee7\u7eed\u4fee\u6539\u6216\u8005\u4e22\u5f03\u3002</p> <p>\u5982\u679c\u8981\u64a4\u9500\u672c\u5730\u6700\u8fd1\u7684\u4e24\u6b21\u4fee\u6539\uff0c\u5219\u6539\u6210 <code>HEAD~2</code> \u5373\u53ef\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p>\u6ce8\u610f\uff1a\u5df2\u7ecf\u63d0\u4ea4\u5230\u8fdc\u7aef\u7684\u63d0\u4ea4\uff0c\u4e0d\u8981\u4f7f\u7528 <code>git reset</code> \u6765\u4fee\u6539\uff0c\u5bf9\u4e8e\u591a\u4eba\u534f\u4f5c\u9879\u76ee\u4f1a\u7ed9\u5176\u4ed6\u4eba\u5e26\u6765\u5f88\u591a\u4e0d\u5fc5\u8981\u7684\u9ebb\u70e6\u3002</p>","tags":["git","reset"]},{"location":"blog/20180905/git-reset/#\u64a4\u9500\u8fdc\u7aef\u4ed3\u5e93\u4fee\u6539","title":"\u64a4\u9500\u8fdc\u7aef\u4ed3\u5e93\u4fee\u6539","text":"<p>\u5bf9\u4e8e\u5df2\u7ecf\u6267\u884c push \u63a8\u9001\u5230\u670d\u52a1\u5668\u7684\u4fee\u6539\uff0c\u539f\u5219\u4e0a\u662f\u4e0d\u5efa\u8bae\u64a4\u9500\u7684\u3002\u4e0d\u8fc7 Git \u7ed9\u4e86\u4f7f\u7528\u8005\u5145\u5206\u7684\u81ea\u7531\uff0c\u5728\u660e\u786e\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u6267\u884c <code>git push -f</code> \u4f7f\u7528 <code>-f</code>(<code>--force</code>) \u9009\u9879\u6765\u5c06\u672c\u5730\u4ed3\u5e93\u5f3a\u5236 push \u8986\u76d6\u8fdc\u7aef\u4ed3\u5e93\u3002</p> <pre><code>// \u5148\u6062\u590d\u672c\u5730\u4ed3\u5e93\ngit reset --hard HEAD^\n// \u518d\u5f3a\u5236push\u5230\u8fdc\u7a0b\u4ed3\u5e93\ngit push -f\n</code></pre> <p>\u5bf9\u4e8e\u4e2a\u4eba\u9879\u76ee\u4f7f\u7528\u8fd9\u6837\u7684\u65b9\u5f0f\uff0c\u5e76\u6ca1\u6709\u592a\u5927\u95ee\u9898\u3002\u4f46\u662f\u5bf9\u4e8e\u591a\u4eba\u534f\u4f5c\u9879\u76ee\uff0c\u5982\u679c\u4f60\u5f3a\u884c\u6539\u53d8\u4e86\u8fdc\u7aef\u4ed3\u5e93\uff0c\u522b\u4eba\u518d\u4f7f\u7528\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0\u5f88\u591a\u95ee\u9898\uff0c\u6240\u4ee5\u4f7f\u7528 <code>git push -f</code> \u65f6\u4e00\u5b9a\u8981\u60f3\u6e05\u695a\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\u4e8b\u60c5\u3002</p>","tags":["git","reset"]},{"location":"blog/20180905/git-reset/#references","title":"references","text":"<p>Git\u5404\u79cd\u9519\u8bef\u64cd\u4f5c\u64a4\u9500\u7684\u65b9\u6cd5 </p> <p>5.2 \u4ee3\u7801\u56de\u6eda\uff1aReset\u3001Checkout\u3001Revert \u7684\u9009\u62e9</p>","tags":["git","reset"]},{"location":"blog/20180905/git-stash/","title":"git stash\u6682\u5b58\u4ee3\u7801","text":"<p>\u672c\u6587\u8bb0\u5f55\u4e86\u4f7f\u7528 git stash \u547d\u4ee4\u6682\u5b58\u4ee3\u7801\u53d8\u66f4\u7684\u57fa\u672c\u64cd\u4f5c\u65b9\u6cd5\u3002</p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#git_help_stash","title":"git help stash","text":"<p>7.3 Git Tools - Stashing and Cleaning</p> <pre><code># man git\n       git-stash(1)\n           Stash the changes in a dirty working directory away.\n\n# git stash -h\n\nusage: git stash list [&lt;options&gt;]\n   or: git stash show [&lt;stash&gt;]\n   or: git stash drop [-q|--quiet] [&lt;stash&gt;]\n   or: git stash ( pop | apply ) [--index] [-q|--quiet] [&lt;stash&gt;]\n   or: git stash branch &lt;branchname&gt; [&lt;stash&gt;]\n   or: git stash save [--patch] [-k|--[no-]keep-index] [-q|--quiet]\n              [-u|--include-untracked] [-a|--all] [&lt;message&gt;]\n   or: git stash [push [--patch] [-k|--[no-]keep-index] [-q|--quiet]\n               [-u|--include-untracked] [-a|--all] [-m &lt;message&gt;]\n               [-- &lt;pathspec&gt;...]]\n   or: git stash clear\n</code></pre> <p>\u6267\u884c <code>git help stash</code> \u6216 <code>man git-stash</code> \u53ef\u67e5\u770b GIT-STASH \u7684 man-page\u3002</p> <p>git-stash - Stash the changes in a dirty working directory away</p> <ul> <li><code>Save</code> your local modifications to a new stash entry;  </li> <li><code>roll</code> them back to HEAD (in the working tree and in the index).  </li> </ul>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#git-stash_commands","title":"git-stash commands","text":"<ol> <li><code>git stash (push)</code>: Save your local modifications to a new stash entry and roll them back to HEAD  </li> <li><code>git stash list</code>: List the stash entries that you currently have.  </li> <li> <p><code>git stash show</code>: Show the changes recorded in the stash entry as a diff between the stashed contents and the commit back when the stash entry was first created.  </p> <p>\u9ed8\u8ba4\u76f8\u5f53\u4e8e <code>--stat</code> \u53ea\u663e\u793a diff \u6982\u8981\uff0c\u53ef\u4ee5\u6307\u5b9a <code>-p</code> \u8f93\u51fa\u8be6\u7ec6\u5dee\u5f02\u5185\u5bb9\u3002</p> </li> <li> <p><code>git stash drop</code>: Remove a single stash entry from the list of stash entries.  </p> </li> <li><code>git stash apply</code>: Like pop, but do not remove the state from the stash list.  </li> <li><code>git stash pop</code>: apply+drop, Remove a single stashed state from the stash list and apply it on top of the current working tree state.  </li> <li><code>git stash clear</code>: Remove all the stash entries.  </li> </ol> <p>\u8bf4\u660e\uff1a</p> <p><code>git stash</code> \u9ed8\u8ba4\u662f push \u64cd\u4f5c\uff0c\u53ef\u4ee5\u6307\u5b9a <code>-u | --include-untracked</code>\u3002 <code>git stash save</code> \u5df2\u7ecf deprecated\uff0c\u4f7f\u7528 <code>git stash push -m</code> \u66ff\u4ee3\u3002  </p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#pushsave","title":"push(save)","text":"<p>\u6267\u884c <code>git stash [push [-m &lt;message&gt;]]</code> \u5c06\u5f53\u524d\u5206\u652f\u7684\u6539\u52a8\u8d2e\u85cf\u5230 stash \u5806\u6808\u3002</p> <p>\u6682\u5b58\u7684\u6539\u52a8\u8303\u7574\u5305\u62ec\uff1a</p> <ol> <li>\u5305\u62ec not staged \u7684\u5f85 add \u6682\u5b58 or checkout -- \u8fd8\u539f\u7684\u6587\u4ef6\uff1b  </li> <li>\u5305\u62ec staged \u7684\u5f85 commit \u63d0\u4ea4 or reset HEAD \u8fdb\u884c unstage \u7684\u6587\u4ef6\uff1b  </li> <li>\u4e0d\u5305\u62ec untracked \u672a\u8ddf\u8e2a\u7684\u6587\u4ef6\uff1b  </li> <li>\u4e0d\u5305\u62ec ignored \u5ffd\u7565\u7684\u6587\u4ef6\uff1b  </li> </ol> <p><code>[-m &lt;message&gt;]</code> \u9009\u9879\u6307\u5b9a\u672c\u6b21 stash \u7684\u4fe1\u606f\uff0c\u4ee5\u4fbf\u540e\u9762\u5728 list/show \u67e5\u770b\u5806\u6808\u65f6\u8bc6\u522b\u3002  </p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#include","title":"include","text":"<ul> <li><code>[-u|--include-untracked]</code>\uff1a\u5305\u542b untracked \u7684\u6587\u4ef6\u3002  </li> <li><code>[-a|--all]</code>\uff1a\u5305\u542b untracked \u548c ignored \u7684\u6587\u4ef6\u3002  </li> </ul>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#patch","title":"patch","text":"<p>\u5982\u679c\u589e\u52a0 <code>[-p|--patch]</code> \u9009\u9879\uff0c\u5c06\u4ee5\u4ea4\u4e92\u6a21\u5f0f\u8be2\u95ee\u9010\u6587\u4ef6\u9010\u4e2a\u6539\u52a8\u533a\u5757\uff08each hunk\uff09\u7684 stash \u7b56\u7565\u3002</p> <pre><code>Stash this hunk [y,n,q,a,d,j,J,g,/,e,?]?\n</code></pre> <p>\u5b57\u6bcd\u9009\u9879\u7684\u610f\u4e49\u5177\u4f53\u53c2\u8003 <code>git help add</code> \u7684 <code>INTERACTIVE MODE</code> patch \u90e8\u5206\u3002</p> <pre><code>y - stage this hunk\nn - do not stage this hunk\nq - quit; do not stage this hunk or any of the remaining ones\na - stage this hunk and all later hunks in the file\nd - do not stage this hunk or any of the later hunks in the file\ng - select a hunk to go to\n/ - search for a hunk matching the given regex\nj - leave this hunk undecided, see next undecided hunk\nJ - leave this hunk undecided, see next hunk\nk - leave this hunk undecided, see previous undecided hunk\nK - leave this hunk undecided, see previous hunk\ns - split the current hunk into smaller hunks\ne - manually edit the current hunk\n? - print help\n</code></pre> <ul> <li><code>y/n</code>\uff1a\u4e3a yes/no\uff1b  </li> <li><code>q</code>\uff1aquit\uff08include any of remaining ones\uff09\uff1b  </li> <li><code>a</code>\uff1astage all\uff08include all later hunks\uff09\uff1b  </li> <li><code>d</code>\uff1ado not stage\uff08include any of later hunks\uff09\uff1b  </li> <li><code>g</code>\uff1a\u5217\u4e3e\u5f53\u524d\u6587\u4ef6\u6240\u6709\u7684 hunks\uff0c\u5e76\u63d0\u793a\u9009\u62e9\u4e00\u4e2a\u8981\u8df3\u8f6c\u7684 hunk \u7d22\u5f15\u7f16\u53f7\uff1b  </li> <li><code>/</code>\uff1a\u6b63\u5219\u5339\u914d\u4e00\u4e2a hunk\u3002\u2014\u2014\u57fa\u4e8e\u4ec0\u4e48\u5339\u914d\uff1f  </li> <li><code>j/k</code>\uff1a\u5728\u672a\u51b3 hunk \u4e4b\u95f4\u8df3\u8f6c\uff08next/previous\uff09\uff1b  </li> <li><code>e</code>\uff1a\u624b\u52a8\u7f16\u8f91\u5f53\u524d hunk\uff1b  </li> </ul> <p>\u6ce8\u610f\uff1aq(uit) \u4e3a\u653e\u5f03\u6240\u6709\uff1ba/d \u4e2d\u662f stage/unstage \u5f53\u524d\u53ca\u4e4b\u540e\u6240\u6709\u3002  </p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#path","title":"path","text":"<p><code>[-- &lt;pathspec&gt;...]]</code>\uff1adouble hyphen -- \u7b26\u53f7\u4e4b\u540e\u53ef\u4ee5\u7eed\u63a5\u8981 stash \u7684\u6307\u5b9a\u6587\u4ef6\uff08\u7684\u76f8\u5bf9\u8def\u5f84\uff09\u3002</p> <p>When pathspec is given to git stash push, the new stash entry records the modified states only for the files that match the pathspec.</p> <p>\u5982\u679c\u5305\u542b untracked \u7684\u6587\u4ef6\uff0c\u8bb0\u5f97\u5148\u6dfb\u52a0 <code>-u</code> \u9009\u9879\u3002</p> <p>\u5173\u4e8e pathspec \u6307\u5b9a\u8bed\u6cd5\uff08syntax\uff09\u53ca\u5339\u914d\u89c4\u5219\uff08Fileglobs\uff09\uff0c\u53ef\u53c2\u8003 <code>git-add</code> \u548c <code>gitglossary</code> \u76f8\u5173\u8bae\u9898\u3002</p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#show","title":"show","text":"","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#list","title":"list","text":"<p>\u6267\u884c <code>git stash list</code> \u547d\u4ee4\uff0c\u53ef\u4ee5\u5217\u4e3e\u5f53\u524d stash \u5806\u6808\u8bb0\u5f55\u3002 \u4e5f\u53ef\u6267\u884c <code>git stash list | cat</code> \u5c06\u7ed3\u679c\u91cd\u5b9a\u5411\u8c03\u7528 cat \u5168\u90e8\u6253\u5370\u51fa\u6765\u3002  </p> <p>git stash list \u5217\u8868\u4e2d\u6bcf\u4e00\u6b21 stash \u8bb0\u5f55\u7684\u6837\u5f0f\u4e3a\uff1a</p> <pre><code>stash@{n}: On &lt;branchname&gt;: &lt;message&gt;\n</code></pre> <p>n \u4e3a\u4ece\u8fd1\u5230\u8fdc\u7684 stash \u8bb0\u5f55\u6808\u7d22\u5f15\uff0c\u6700\u65b0 push \u538b\u5165\u6808\u9876\u7684\u7d22\u5f15\u4e3a 0\uff08<code>stash@{0}</code>\uff09\u3002</p> <p>\u5f15\u7528 stash \u7248\u672c\u53f7\u683c\u5f0f\uff1a<code>stash@{&lt;revision&gt;}</code></p> <ul> <li><code>stash@{0}</code> is the most recently created stash,  </li> <li><code>stash@{1}</code> is the one before it,  </li> <li><code>stash@{2.hours.ago}</code> is also possible.  </li> </ul> <p>Stashes may also be referenced by specifying just the stash index (e.g. the integer <code>n</code> is equivalent to <code>stash@{n}</code>).</p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#specific","title":"specific","text":"<p><code>git stash show [&lt;stash&gt;]</code></p> <p><code>[&lt;stash&gt;]</code> \u4e3a\u53ef\u9009\u53c2\u6570\uff0c\u5f53\u4e0d\u6307\u5b9a\u65f6 <code>git stash show</code> \u9ed8\u8ba4\u663e\u793a\u6808\u9876\u8bb0\u5f55\u4fe1\u606f\u3002</p> <p>\u67e5\u770b\u6808\u9876\u6700\u8fd1\u4e00\u6b21 push-save \u7684 stash \u8bb0\u5f55\uff1a<code>git stash show stash@{0}</code>\uff0c\u4e5f\u53ef\u7b80\u5199\u4e3a <code>git stash show 0</code>\u3002</p> <p><code>git stash show 1</code> \u663e\u793a\u7d22\u5f15\u4e3a1\u7684 stash \u6539\u52a8\u6982\u8981\u4fe1\u606f\u3002  </p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#applypop","title":"apply/pop","text":"<p><code>git stash ( pop | apply ) [--index] [-q|--quiet] [&lt;stash&gt;]</code></p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#branch_with_stash","title":"branch with stash","text":"<p><code>git stash branch &lt;branchname&gt; [&lt;stash&gt;]</code> </p> <p>Creates and checks out a new branch named <code>&lt;branchname&gt;</code> starting from the commit at which the <code>&lt;stash&gt;</code> was originally created, applies the changes recorded in <code>&lt;stash&gt;</code> to the new working tree and index.</p> <p>\u5177\u4f53\u5e94\u7528\u573a\u666f\u5206\u6790\uff0c\u53c2\u8003\u300agit stash \u8be6\u89e3\u300b\u548c\u300agit-stash \u7528\u6cd5\u5c0f\u7ed3\u300b\u3002</p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#git_stash_\u7528\u6cd5\u8be6\u89e3","title":"git stash \u7528\u6cd5\u8be6\u89e3","text":"<p>git stash \u7528\u6cd5 git stash \u4f5c\u7528\u53ca\u7406\u89e3 git stash \u8be6\u89e3 git-stash \u7528\u6cd5\u5c0f\u7ed3 </p>","tags":["git","stash"]},{"location":"blog/20180905/git-stash/#\u4f7f\u7528_git_stash_\u89e3\u51b3_git_pull_\u65f6\u7684\u51b2\u7a81","title":"\u4f7f\u7528 git stash \u89e3\u51b3 git pull \u65f6\u7684\u51b2\u7a81","text":"<p>git stash \u53ef\u7528\u6765\u6682\u5b58\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u7684\u5de5\u4f5c\uff0c\u6bd4\u5982\u60f3 pull \u6700\u65b0\u4ee3\u7801\uff0c\u53c8\u4e0d\u60f3\u52a0\u65b0 commit\uff1b \u6216\u8005\u53e6\u5916\u4e00\u79cd\u60c5\u51b5\uff0c\u4e3a\u4e86 fix \u4e00\u4e2a\u7d27\u6025\u7684 bug\uff0c\u5148 <code>stash</code> \u4f7f\u8fd4\u56de\u5230\u81ea\u5df1\u4e0a\u4e00\u4e2a commit\uff0c\u6539\u5b8c bug \u4e4b\u540e\u518d <code>stash pop</code>\uff0c\u7ee7\u7eed\u539f\u6765\u7684\u5de5\u4f5c\u3002</p> <p>\u4f7f\u7528 git stash \u8ba9\u7a81\u5982\u5176\u6765\u7684\u5206\u652f\u5207\u6362\u66f4\u52a0\u7f8e\u597d </p> <p>\u57fa\u7840\u6d41\u7a0b\uff1a</p> <pre><code>$git stash\n$do some work\n$git stash pop\n</code></pre> <p>\u5728\u4f7f\u7528 <code>git pull</code> \u4ee3\u7801\u65f6\uff0c\u7ecf\u5e38\u4f1a\u78b0\u5230\u6709\u51b2\u7a81\u7684\u60c5\u51b5\uff0c\u63d0\u793a\u5982\u4e0b\u4fe1\u606f\uff1a</p> <pre><code>error: Your local changes to 'c/environ.c' would be overwritten by merge.\nAborting.Please, commit your changes or stash them before you can merge.\n</code></pre> <p>\u610f\u601d\u662f\u8bf4\u66f4\u65b0\u4e0b\u6765\u7684\u5185\u5bb9\u548c\u672c\u5730\u4fee\u6539\u7684\u5185\u5bb9\u6709\u51b2\u7a81\uff0c\u5148\u63d0\u4ea4\u4f60\u7684\u6539\u53d8\u6216\u8005\u5148\u5c06\u672c\u5730\u4fee\u6539\u6682\u65f6\u5b58\u50a8\u8d77\u6765\u3002 \u5904\u7406\u7684\u65b9\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u4f7f\u7528 <code>git stash</code> \u547d\u4ee4\u8fdb\u884c\u5904\u7406\uff0c\u5206\u6210\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\u8fdb\u884c\u5904\u7406\u3002</p> <ol> <li>\u6267\u884c <code>git stash</code> \u5c06\u672c\u5730\u4fee\u6539\u6682\u65f6\u5b58\u50a8\u8d77\u6765\uff1b\u6267\u884c <code>git stash list</code> \u53ef\u4ee5\u770b\u5230\u4fdd\u5b58\u7684\u4fe1\u606f\uff0c\u5176\u4e2d <code>stash@{0}</code> \u5c31\u662f\u521a\u624d\u4fdd\u5b58\u7684\u6807\u8bb0\u3002  </li> <li>\u6682\u5b58\u4e86\u672c\u5730\u4fee\u6539\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u6267\u884c <code>git pull</code> \u4e86\u3002   </li> <li>\u8fd8\u539f\u6682\u5b58\u7684\u5185\u5bb9 <code>git stash pop stash@{0}</code> </li> </ol>","tags":["git","stash"]},{"location":"blog/20180905/git-language/","title":"git\u914d\u7f6e\u8bed\u8a00\u7b49\u9009\u9879","text":"<p>\u672c\u6587\u8bb0\u5f55\u4e86 git status \u663e\u793a\u4e71\u7801\u3001\u4fee\u6539\u8bed\u8a00\u548c\u533a\u5206\u5927\u5c0f\u5199\u7b49 git \u914d\u7f6e\u89e3\u51b3\u65b9\u6848\u3002</p> <p>Git Status \u4e2d\u6587\u4e71\u7801\u89e3\u51b3 </p>","tags":["git","config"]},{"location":"blog/20180905/git-language/#\u4e2d\u6587\u4e71\u7801","title":"\u4e2d\u6587\u4e71\u7801","text":"<p>git \u6b63\u5e38\u663e\u793a\u4e2d\u6587\u6587\u4ef6\u540d git status \u663e\u793a\u4e2d\u6587\u548c\u89e3\u51b3\u4e2d\u6587\u4e71\u7801 </p> <p>\u4e0d\u5bf90x80\u4ee5\u4e0a\u7684\u5b57\u7b26\u8fdb\u884cquote\uff0c\u89e3\u51b3git status/commit\u65f6\u4e2d\u6587\u6587\u4ef6\u540d\u4e71\u7801</p> <pre><code>$ git config --global core.quotepath false\n</code></pre>","tags":["git","config"]},{"location":"blog/20180905/git-language/#\u65e5\u5fd7_esc","title":"\u65e5\u5fd7 ESC","text":"<p>How to fix ESC[ in your terminal</p> <p>How to get rid of ESC[ characters when using git diff on Mac OS X Mavericks?</p> <p>\u5982\u679c\u4e4b\u524d\u6709\u914d\u7f6e\u5bfc\u51fa LESS\uff0c\u53ef\u5c06 <code>~/.zshrc</code> \u4e2d\u7684\u76f8\u5173\u914d\u7f6e\u9879\u5c4f\u853d\u6389\u5373\u53ef\uff1a</p> <pre><code>LESS='-Pslines %lt-%lb bytes %bt-%bb %Pb\\% of file %f';\nexport LESS\n</code></pre> <p>\u6216\u8005\u5355\u72ec\u8bbe\u7f6e git \u5206\u9875\u5668\uff08core.pager\uff09\u4e3a <code>less -R</code>\uff1a</p> <pre><code># read\n$ git config --global core.pager\n\n# write\n$ git config --global core.pager \"less -R\"\n\n# read\n$ git config --global core.pager\nless -R\n</code></pre>","tags":["git","config"]},{"location":"blog/20180905/git-language/#\u4fee\u6539\u8bed\u8a00","title":"\u4fee\u6539\u8bed\u8a00","text":"<p>How does one change the language of the command line interface of Git? Change git's language to English without changing the locale </p> <p>Git 2.19 \u5bf9Diff\u3001Branch\u548cGrep\u7b49\u505a\u4e86\u6539\u8fdb \u5982\u4f55\u66f4\u6539Git\u7684\u547d\u4ee4\u884c\u754c\u9762\u7684\u8bed\u8a00\uff1f \u8ba9 git \u663e\u793a\u82f1\u6587 </p> <p>\u5728\u5f53\u524d\u547d\u4ee4\u884c\u4e2d\u6267\u884c <code>LAGN=en_GB</code> \u4e34\u65f6\u8bbe\u7f6e\u8bed\u8a00\uff0c\u5173\u95ed\u7ec8\u7aef\u5931\u6548\u3002</p> <p>\u6216\u5728 bash \u6216 zsh \u4e2d\u542f\u52a8 git \u4e4b\u524d\u4fee\u6539\u8bed\u8a00\u53d8\u91cf LANG\uff1a</p> <pre><code>$ echo \"alias git='LANG=en_GB git'\" &gt;&gt; ~/.bashrc\n</code></pre> <p>\u6062\u590d\u4e2d\u6587\uff1a\u5728 <code>~/.bashrc</code>\uff08\u6216 <code>~/.zshrc</code>\uff09 \u4e2d\u6ce8\u91ca\u6389\u4ee5\u4e0a\u5373\u53ef\u3002</p>","tags":["git","config"]},{"location":"blog/20180905/git-language/#\u533a\u5206\u5927\u5c0f\u5199","title":"\u533a\u5206\u5927\u5c0f\u5199","text":"<p>\u5173\u4e8egit\u4e0d\u533a\u5206\u6587\u4ef6\u540d\u5927\u5c0f\u5199\u7684\u5904\u7406</p> <p>\u5982\u4f55\u914d\u7f6eGit\u652f\u6301\u5927\u5c0f\u5199\u654f\u611f\u548c\u4fee\u6539\u6587\u4ef6\u540d\u4e2d\u5927\u5c0f\u5199\u5b57\u6bcd\u5462\uff1f</p> <p>\u5982\u4f55\u89e3\u51b3Git\u7684\u5927\u5c0f\u4e0d\u654f\u611f\u95ee\u9898\u5462\uff1f</p> <ul> <li>\u65b9\u6848\u4e00\uff1a\u914d\u7f6egit\u5927\u5c0f\u5199\u654f\u611f\uff1a</li> </ul> <pre><code>$ git config core.ignorecase false\n</code></pre> <ul> <li>\u65b9\u6848\u4e8c\u662f\u5148\u5220\u9664\u6587\u4ef6\uff0c\u518d\u6dfb\u52a0\u8fdb\u53bb\uff1a</li> </ul> <pre><code>$ git rm ; git add ;  git commit -m \"rename file\"\n</code></pre>","tags":["git","config"]},{"location":"blog/20180905/gitignore/","title":"gitignore\u914d\u7f6e\u5ffd\u7565\u6587\u4ef6","text":"<p>\u672c\u6587\u7b80\u5355\u8bb0\u5f55\u4e86 <code>.gitignore</code> \u5ffd\u7565\u6587\u4ef6\u914d\u7f6e\u548c\u4e00\u4e9b\u5de5\u7a0b\u914d\u7f6e\u6848\u4f8b\u3002</p> <p>.gitignore \u8be6\u89e3 git \u5ffd\u7565\u89c4\u5219 .gitignore \u68b3\u7406 </p> <p>\u4e00\u5b9a\u8981\u517b\u6210\u5728\u9879\u76ee\u5f00\u59cb\u5c31\u521b\u5efa\u914d\u7f6e <code>.gitignore</code> \u6587\u4ef6\u7684\u4e60\u60ef\uff0c\u5426\u5219\u4e00\u65e6push\uff0c\u5904\u7406\u8d77\u6765\u4f1a\u975e\u5e38\u9ebb\u70e6\u3002 \u5982\u679c\u4e0d\u614e\u5728\u521b\u5efa <code>.gitignore</code> \u6587\u4ef6\u4e4b\u524d\u5c31push\u4e86\u9879\u76ee\uff0c\u90a3\u4e48\u5373\u4f7f\u540e\u7eed\u5728 <code>.gitignore</code> \u6587\u4ef6\u4e2d\u5199\u5165\u65b0\u7684\u8fc7\u6ee4\u89c4\u5219\uff0c\u8fd9\u4e9b\u89c4\u5219\u4e5f\u4e0d\u4f1a\u8d77\u4f5c\u7528\uff0cGit\u4ecd\u7136\u4f1a\u5bf9\u6240\u6709\u6587\u4ef6\u8fdb\u884c\u7248\u672c\u7ba1\u7406\u3002\u51fa\u73b0\u8fd9\u79cd\u95ee\u9898\u7684\u539f\u56e0\u5c31\u662f git \u5df2\u7ecf\u5f00\u59cb\u7ba1\u7406\u8fd9\u4e9b\u6587\u4ef6\u4e86\uff0c\u6240\u4ee5\u65e0\u6cd5\u518d\u901a\u8fc7\u8fc7\u6ee4\u89c4\u5219\u8fc7\u6ee4\u5b83\u4eec\u3002</p>","tags":["git","config"]},{"location":"blog/20180905/gitignore/#git_help_ignore","title":"git help ignore","text":"<pre><code>GITIGNORE(5)                                Git Manual                                GITIGNORE(5)\n\n\n\nNAME\n       gitignore - Specifies intentionally untracked files to ignore\n\nSYNOPSIS\n       $XDG_CONFIG_HOME/git/ignore, $GIT_DIR/info/exclude, .gitignore\n\nDESCRIPTION\n       A gitignore file specifies intentionally untracked files that Git should ignore. Files\n       already tracked by Git are not affected; see the NOTES below for details.\n\n       Each line in a gitignore file specifies a pattern. When deciding whether to ignore a path,\n       Git normally checks gitignore patterns from multiple sources, with the following order of\n       precedence, from highest to lowest (within one level of precedence, the last matching\n       pattern decides the outcome):\n</code></pre> <ul> <li>\u5ffd\u7565\u5177\u4f53\u6587\u4ef6\uff1a<code>.DS_Store</code>\u3001<code>build.log</code>\u3001<code>**/*.xcuserdatad/**</code>\uff1b  </li> <li>\u5ffd\u7565\u7c7b\u578b\u6587\u4ef6\uff1a<code>*.ipa</code>\u3001<code>*.dSYM</code>\u3001<code>*.log</code>\u3001<code>*.obj</code>\u3001<code>*.idb</code>\u3001<code>*.pdb</code>\uff1b  </li> <li>\u5ffd\u7565\u6587\u4ef6\u5939\uff1a<code>build/</code>\u3001<code>DerivedData/</code>\u3001<code>**/xcshareddata/</code>\u3001<code>**/xcuserdata/**</code>\uff1b  </li> </ul>","tags":["git","config"]},{"location":"blog/20180905/gitignore/#glob_pattern","title":"glob pattern","text":"<ol> <li>\u4e00\u4e2a\u661f\u53f7 <code>*</code> \u901a\u914d\u591a\u4e2a\u5b57\u7b26\uff0c\u5373\u5339\u914d\u591a\u4e2a\u4efb\u610f\u5b57\u7b26\u3002</li> <li> <p>\u65b9\u62ec\u53f7 <code>[]</code> \u5305\u542b\u5355\u4e2a\u5b57\u7b26\u7684\u5339\u914d\u5217\u8868\uff0c\u5373\u5339\u914d\u4efb\u4f55\u4e00\u4e2a\u5217\u5728\u65b9\u62ec\u53f7\u4e2d\u7684\u5b57\u7b26\u3002</p> <p><code>*.[oa]</code> \u8868\u793a\u5ffd\u7565\u540e\u7f00\u540d\u4e3a <code>.o</code> \u548c <code>.a</code> \u7684\u6587\u4ef6\u3002</p> </li> <li> <p>\u4e24\u4e2a\u661f\u53f7 <code>**</code> \u8868\u793a\u5339\u914d\u4efb\u610f\u4e2d\u95f4\u76ee\u5f55\u3002  </p> </li> <li>\u53f9\u53f7 <code>!</code> \u8868\u793a\u4e0d\u5ffd\u7565(\u8ddf\u8e2a)\u5339\u914d\u5230\u7684\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u5373\u8981\u5ffd\u7565\u6307\u5b9a\u6a21\u5f0f\u4ee5\u5916\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u3002</li> </ol>","tags":["git","config"]},{"location":"blog/20180905/gitignore/#xcode","title":"Xcode","text":"<p>\u4ee5\u4e0b\u4e3a\u5178\u578b\u7684 Xcode \u9879\u76ee\u9700\u8981\u5ffd\u7565\u6587\u4ef6\u7684 <code>.gitignore</code> \u914d\u7f6e\uff1a</p> <pre><code>## macOS folder attributes\n.DS_Store\n\n## Xcode Build generated\nbuild/\nDerivedData/\nbuild.log\n\n## Obj-C/Swift specific\n*.hmap\n*.ipa\n*.dSYM\n*.dSYM.zip\n\n## Various settings\n*.pbxuser\n!default.pbxuser\n**/xcuserdata/**\n**/*.xcuserdatad/**\n**/xcshareddata/\n\n*.moved-aside\n*.xcuserstate\n\n## Playgrounds\ntimeline.xctimeline\nplayground.xcworkspace\n\n## Pods\nPodfile.lock\nPods\n</code></pre>","tags":["git","config"]},{"location":"blog/20180905/gitignore/#mars","title":"Mars","text":"<p>\u4ee5\u4e0b\u6458\u81ea Mars \u5f00\u6e90\u9879\u76ee\u7684 <code>.gitignore</code> \u914d\u7f6e\uff1a</p> <pre><code>*.iml\n.gradle/\n/mars/local.properties\n.idea/\n.DS_Store\nbuild/\n/mars/captures\nobj/\n\n*.swp\n*.pyc\nxcuserdata\nxcshareddata\n\n/mars/comm/verinfo.h\n/mars/libraries/*/\n/mars/*/libs/\n!/mars/boost/libs/\n\n/mars/comm/win32proj/Debug/*.obj\n/mars/comm/win32proj/Debug/*.idb\n/mars/comm/win32proj/Debug/*.log\n/mars/comm/win32proj/Debug/*.pdb\n</code></pre>","tags":["git","config"]},{"location":"blog/20180904/clone-bare-push-mirror/","title":"github\u590d\u5236\u8fc1\u79fb\u4ed3\u5e93","text":"<p>\u5982\u4f55\u514b\u9686\u5bfc\u5165github\u5916\u90e8\u4ed3\u5e93\u4e0a\u7684\u9879\u76ee\u5230\u5185\u90e8\u4ed3\u5e93\uff0c\u5e76\u4e14\u4fdd\u7559\u6e90\u4ed3\u5e93\u7684\u5206\u652f\u548c\u63d0\u4ea4\u4fe1\u606f\uff1f</p> <p>\u5177\u4f53\u53c2\u8003 GitHub-\u590d\u5236\u4ed3\u5e93 \u548c \u4f7f\u7528 git push \u2013mirror \u8fc1\u79fb Git \u9879\u76ee\u3002</p> <p>\u8981\u7ef4\u62a4\u5b58\u50a8\u5e93\u7684\u955c\u50cf\u800c\u4e0d\u5bf9\u5176\u8fdb\u884c\u590d\u523b\uff0c\u53ef\u4ee5\u8fd0\u884c\u7279\u6b8a\u7684\u514b\u9686\u547d\u4ee4\uff0c\u7136\u540e\u955c\u50cf\u63a8\u9001\u5230\u65b0\u5b58\u50a8\u5e93\u3002</p> <p>\u5177\u4f53\u793a\u4f8b\u5982\u4e0b\uff0c\u5c06 YYKit \u4ece github \u514b\u9686\u4e00\u4efd\u5230 gitee \u4e0a\uff1a</p> <pre><code># 1. \u521b\u5efa\u4ed3\u5e93\u7684\u88f8\u514b\u9686\n$ git clone --bare https://github.com/ibireme/YYKit.git\n# 2. \u955c\u50cf\u63a8\u9001\u81f3\u65b0\u4ed3\u5e93\n$ git push --mirror https://gitee.com/fan2/YYKit.git\n</code></pre> <p>\u7136\u540e\uff08\u79fb\u9664\u672c\u5730\u7684 github YYKit\uff09\uff0c\u91cd\u65b0clone\u62c9\u4e0b gitee \u4ed3\u5e93\u955c\u50cf fan2/YYKit\uff1a</p> <pre><code>$ rm -rf YYKit\n$ git pull https://gitee.com/fan2/YYKit.git\n</code></pre>","tags":["github","mirror"]},{"location":"blog/20180903/syncing-fork-upstream/","title":"github\u540c\u6b65fork\u4e0a\u6e38","text":"<ol> <li>Configuring a remote for a fork </li> <li>Syncing a fork </li> </ol>","tags":["github","fork","sync"]},{"location":"blog/20180903/syncing-fork-upstream/#add_upstream","title":"add upstream","text":"<pre><code>~/Projects/git/framework/mars|master\u26a1\n\u21d2  git remote -v\norigin  git@github.com:fan2/mars.git (fetch)\norigin  git@github.com:fan2/mars.git (push)\n\n~/Projects/git/framework/mars|master\u26a1\n\u21d2  git remote add upstream https://github.com/Tencent/mars\n\n~/Projects/git/framework/mars|master\u26a1\n\u21d2  git remote -v\norigin  git@github.com:fan2/mars.git (fetch)\norigin  git@github.com:fan2/mars.git (push)\nupstream    https://github.com/Tencent/mars (fetch)\nupstream    https://github.com/Tencent/mars (push)\n</code></pre> <p>\u6267\u884c <code>git remote rm upstream</code> \u53ef\u89e3\u9664 upstream\u3002</p>","tags":["github","fork","sync"]},{"location":"blog/20180903/syncing-fork-upstream/#fetch_upstream","title":"fetch upstream","text":"<pre><code>~/Projects/git/framework/mars|master\u26a1\n\u21d2  git fetch upstream\nremote: Counting objects: 149, done.\nremote: Compressing objects: 100% (19/19), done.\nremote: Total 149 (delta 103), reused 124 (delta 103), pack-reused 17\n</code></pre>","tags":["github","fork","sync"]},{"location":"blog/20180903/syncing-fork-upstream/#merge_upstreambranch","title":"merge upstream/branch","text":"<pre><code>~/Projects/git/framework/mars|master\u26a1\n\u21d2  git merge upstream/master\nMerge made by the 'recursive' strategy.\n README.md                                                | 29 +++++++++++++++++++++++------\n mars/comm/dns/dns.cc                                     | 39 +++++++++++++++++++++------------------\n mars/comm/dns/dns.h                                      |  5 +++++\n mars/comm/network/getgateway.c                           |  2 +-\n mars/comm/socket/local_ipstack.cc                        |  4 ++--\n mars/comm/socket/socket_address.cc                       |  6 +++---\n mars/comm/socket/socket_address.h                        |  2 +-\n mars/comm/verinfo.h                                      |  8 ++++----\n mars/libraries/build_android.py                          | 10 ++++++++--\n mars/libraries/mars_android_sdk/gradle.properties        |  2 +-\n mars/libraries/mars_xlog_sdk/gradle.properties           |  2 +-\n mars/log/jni/Java2C_Xlog.cc                              |  3 ++-\n mars/sdt/src/checkimpl/dnsquery.cc                       |  2 +-\n samples/android/marsSampleChat/build.gradle              |  4 ++--\n samples/android/marsSampleChat/wrapper/gradle.properties |  2 +-\n samples/android/xlogSample/build.gradle                  |  2 +-\n 16 files changed, 77 insertions(+), 45 deletions(-)\n mode change 100755 =&gt; 100644 mars/libraries/build_android.py\n</code></pre>","tags":["github","fork","sync"]},{"location":"blog/20180903/syncing-fork-upstream/#merge_upstream_of_libetpan","title":"merge upstream of libetpan","text":"","tags":["github","fork","sync"]},{"location":"blog/20240420/e-resources/","title":"\u5e38\u7528\u8d44\u6e90\u4e0b\u8f7d\u7f51\u7ad9\u5206\u4eab","text":"<p>\u5206\u4eab\u65e5\u5e38\u641c\u7d22\u4e0b\u8f7d\u7535\u5b50\u4e66\u7684\u8d44\u6e90\u7f51\u7ad9\uff0cLibGen \u548c Liber3 \u7528\u7684\u6bd4\u8f83\u591a\uff0cz-lib \u6b21\u4e4b\u3002</p>"},{"location":"blog/20240420/e-resources/#libgen","title":"LibGen","text":"<p>Library Genesis Library Genesis+</p> <p>Liber3</p>"},{"location":"blog/20240420/e-resources/#z-library","title":"Z-Library","text":"<p>Z-Library - eBooks library</p> <p>Part of Z-Library project. The world's largest ebook library</p> <p>ZLIBRARY.CC - Download</p> <p>Z-Library \u2013 Unlock the Power of Knowledge with Zlibrary</p> <p>ZLIBRARY.TO - Premium</p>"},{"location":"blog/20240420/e-resources/#sci-hub","title":"Sci-Hub","text":"<p>Sci-Hub Portal</p> <ul> <li>Chrome Extension: PaperPanda</li> </ul>"},{"location":"blog/20240420/e-resources/#oamg","title":"OA.mg","text":"<p>sci-hub.do - OA.mg</p> <p>The only truly modern academic research engine</p> <ul> <li>Chrome Extension: OA.mg</li> </ul>"},{"location":"blog/20240420/e-resources/#library","title":"Library","text":"<p>World Digital Library</p> <p>The Online Books Page | upenn.edu(\u5bbe\u5915\u6cd5\u5c3c\u4e9a\u5927\u5b66)</p>"},{"location":"blog/20240420/e-resources/#archive","title":"Archive","text":"<p>Anna\u2019s Archive</p> <ul> <li>mirror Sci-Hub and LibGen</li> <li>scrape and open-source Z-Lib</li> </ul> <p>Internet Archive: Digital Library of Free &amp; Borrowable Books, Movies, Music &amp; Wayback Machine</p> <p>Internet Archive is a non-profit library of millions of free books, movies, software, music, websites, and more.</p>"},{"location":"blog/20240420/e-resources/#pdf","title":"PDF","text":""},{"location":"blog/20240420/e-resources/#pdf_drive","title":"PDF Drive","text":"<p>PDF Drive - Search and download PDF files for free.</p> <p>PDF Drive is your search engine for PDF files.</p>"},{"location":"blog/20240420/e-resources/#kupdf","title":"KUPDF","text":"<p>KUPDF - Free document sharing platform - Upload and share</p> <p>FreeComputerBooks | Free Computer, Programming, Mathematics, Technical Books, Lecture Notes and Tutorials</p>"},{"location":"blog/20240420/e-resources/#ietf_rfc","title":"IETF RFC","text":"<p>IETF | Internet Engineering Task Force</p> <ul> <li>IETF Datatracker</li> <li>RFC Editor</li> </ul> <p>RFC Reader - An online reader for IETF RFCs</p> <p>Internet RFC/FYI/STD/BCP Archives</p>"},{"location":"blog/20240420/e-resources/#macos_app","title":"macOS App","text":"<p>TNT - XMac.App - Download crack app for mac</p> <p>HCiSO | AppNee Freeware Group.</p>"},{"location":"blog/20240430/mac-softwar-list/","title":"macOS Software List","text":"<p>macOS \u8f6f\u4ef6\u6e05\u5355\u5907\u5fd8\uff08macOS Software Inventory\uff09\u3002</p>"},{"location":"blog/20240430/mac-softwar-list/#system","title":"System","text":"<p>Tencent Lemon @github</p> <ul> <li>\u7545\u5feb\u6e05\u7406 \u00b7 \u5168\u65b0\u4f53\u9a8c</li> <li>\u5320\u5fc3\u6253\u78e8\u6e05\u7406\u4f53\u9a8c\uff0c\u4e00\u952e\u91ca\u653e\u78c1\u76d8\u7a7a\u95f4</li> </ul> <p>iTerm2 - macOS Terminal Replacement Warp: Your terminal, reimagined</p> <ul> <li>Warp is a modern, Rust-based terminal with AI built in so you and your team can build great software, faster.</li> </ul>"},{"location":"blog/20240430/mac-softwar-list/#tools","title":"Tools","text":"<p>Macroplant iExplorer</p> <ul> <li>The Ultimate iPhone, iPad, and iPod File Transfer Utility for Mac and Windows.</li> </ul> <p>softorino WALTR PRO</p> <ul> <li>Any Format to Any Destination</li> <li>Convert, Transfer ANY File into iPhone, iPad\u2026 Like a PRO</li> </ul>"},{"location":"blog/20240430/mac-softwar-list/#utilities","title":"Utilities","text":"<p>iBar: \u5f3a\u5927\u7684Mac\u7535\u8111\u83dc\u5355\u680f\u56fe\u6807\u7ba1\u7406\u5de5\u5177</p> <p>iCopy: \u526a\u5207\u677f\u3001\u5feb\u6377\u56de\u590d\u5f3a\u5f3a\u7ec4\u5408\uff0c\u65e0\u4e0e\u4f26\u6bd4\u7684\u6548\u7387\u500d\u589e\u795e\u5668\uff01</p> <p>Karabiner-Elements: A powerful and stable keyboard customizer for macOS.</p>"},{"location":"blog/20240430/mac-softwar-list/#network","title":"Network","text":"<p>Clash Verge Rev : Clash Verge \u7684\u5ef6\u7eed\uff0c\u57fa\u4e8e Tauri \u7684 Clash Meta GUI\u3002</p> <ul> <li>@github - Releases</li> </ul> <p>Google Chrome Web Browser Arc from The Browser Company</p> <ul> <li>Arc is the Chrome replacement I\u2019ve been waiting for.</li> </ul> <p>Cyberduck</p> <ul> <li>Cyberduck is a libre server and cloud storage browser for Mac and Windows with support for FTP, SFTP, WebDAV, Amazon S3, OpenStack Swift, Backblaze B2, Microsoft Azure &amp; OneDrive, Google Drive and Dropbox.</li> </ul> <p>Rclone - works like a charm!</p> <ul> <li>a command-line program to manage files on cloud storage.</li> <li>a feature-rich alternative to cloud vendors' web storage interfaces.</li> </ul>"},{"location":"blog/20240430/mac-softwar-list/#messager","title":"Messager","text":"<p>\u5fae\u4fe1\uff0c\u662f\u4e00\u4e2a\u751f\u6d3b\u65b9\u5f0f - WeChat</p> <ul> <li>Free messaging and calling app</li> </ul> <p>Telegram Messenger</p> <ul> <li>a new era of messaging</li> </ul>"},{"location":"blog/20240430/mac-softwar-list/#image__diagram","title":"Image &amp; Diagram","text":"<p>macOS \u622a\u56fe\u9884\u89c8\u5185\u7f6e OCR \u8bc6\u522b\u3002</p> <p>Snagit | TechSmith</p> <ul> <li>The best software for screen capture and recording</li> <li>Easily grab screenshots or record your screen, then add annotations to communicate your message clearly.</li> </ul> <p>Sketch</p> <ul> <li>Sketch is where great design happens.</li> <li>A Mac app for designers to create, team up, prototype, and more.</li> </ul> <p>Xmind - Mind Mapping App: IDEAS GROW ON TREES</p> <ul> <li>The full-featured mind mapping and brainstorming app.</li> <li>Like a Swiss Army Knife, Xmind\u2009\u00ae offers a complete toolset for thinking and creativity.</li> </ul> <p>StarUML</p> <ul> <li>A sophisticated software modeler for agile and concise modeling</li> </ul>"},{"location":"blog/20240430/mac-softwar-list/#audio__video","title":"Audio &amp; Video","text":"<p>VLC: Free multimedia solutions for all OS! - VideoLAN</p> <ul> <li>VLC is a free and open source cross-platform multimedia player and framework that plays most multimedia files as well as DVDs, Audio CDs, VCDs, and various streaming protocols.</li> </ul> <p>Rogue Amoeba | Fission: Fast &amp; Lossless Audio Editing</p> <ul> <li>With Fission, audio editing is no longer a chore. You can join files, crop and trim audio, and rapidly split up long files. Fission is streamlined for fast editing, and it works without the quality loss other audio editors cause.</li> </ul> <p>Rogue Amoeba | Audio Hijack: Record Any Audio on MacOS</p> <ul> <li>PROFESSIONAL-GRADE RECORDING AND MORE</li> <li>If you can hear it on your Mac, Audio Hijack can record it, and more.</li> <li>Grab Web and App Audio, Pro Podcast Creation, So Much More.</li> </ul> <p>ArcTime Pro\u8de8\u5e73\u53f0\u5b57\u5e55\u8f6f\u4ef6 | Arctime\u5b57\u5e55\u8f6f\u4ef6</p> <ul> <li>\u6613\u7528\u3001\u5f3a\u5927\u3001\u9ad8\u6548\u7684\u5b57\u5e55\u5236\u4f5c\u8f6f\u4ef6</li> <li>\u8ba9\u505a\u5b57\u5e55\u53d8\u6210\u4e00\u79cd\u4eab\u53d7</li> </ul>"},{"location":"blog/20240430/mac-softwar-list/#stickies__notes","title":"Stickies &amp; Notes","text":"<p>Notes.app: Start a Quick Note on Mac</p> <ul> <li>Use the keyboard shortcut</li> <li>Use hot corners</li> </ul> <p>Octarine - Take back control of your writing</p> <ul> <li>Empower your productivity with a minimalistic design: WYSIWYG editing, markdown output, and full file ownership.</li> </ul> <p>Stickies.app: Stickies User Guide for Mac</p> <ul> <li>Make the note semi-transparent</li> <li>Keep the note in front of other windows</li> </ul> <p>Stickies</p> <ul> <li>Visual project management and collaboration platform</li> <li>A dynamic sticky notes app for brainstorming, content curation, taking notes, and capturing ideas.</li> </ul>"},{"location":"blog/20240430/mac-softwar-list/#text_editor","title":"Text Editor","text":"<p>FoldingText - waiting for 3.0</p> <ul> <li>For Mac users who love plain text.</li> <li>FoldingText is the markdown text editor with productivity features.</li> <li>Unlike other editors, FoldingText does outlining, todo lists, and more.</li> </ul> <p>Marked 2 - Smarter tools for smarter writers</p> <ul> <li>Marked is a previewer for Markdown and other plain text markups.</li> </ul> <p>Sublime Text - Text Editing, Done Right Visual Studio Code - Code Editing. Redefined</p> <ul> <li>Markdown Preview Enhanced</li> <li>Markdown Shortcuts</li> <li>File Utils</li> <li>GitLens</li> </ul>"},{"location":"blog/20240430/mac-softwar-list/#doc_reader","title":"Doc Reader","text":"<p>PDF Expert\uff0c\u642d\u914d\u5185\u7f6e Preview \u67e5\u770b\u626b\u63cf\u4ef6\u3002</p> <p>PDF Expert - PDF Editor and Reader for Mac</p> <ul> <li>The go-to PDF editor for iPhone, iPad and Mac</li> <li>We make it easy to edit, annotate, sign and organize PDFs.</li> </ul> <p>Kindle Classic\uff1amobi \u6587\u6863\u9605\u8bfb\u5668\u3002 CHM Reader\uff1achm \u6587\u6863\u9605\u8bfb\u5668\u3002 DjView4 / Cisdem Document Reader\uff1aDjVu \u683c\u5f0f\u6587\u6863\u9605\u8bfb\u5668\u3002</p>"},{"location":"blog/20240430/mac-softwar-list/#development","title":"development","text":"<p>SmartGit \u2013 Git Client for Windows, macOS, Linux</p> <ul> <li>Get your commit done.</li> <li>SmartGit is the most popular Git GUI client at slant.co.</li> </ul> <p>Araxis Merge</p> <ul> <li>Advanced 2 &amp; 3-way file comparison (diff), merging and folder synchronization</li> </ul> <p>Anaconda | The Operating System for AI</p> <ul> <li>Anaconda is a distribution of the Python and R programming languages for scientific computing, that aims to simplify package management and deployment.</li> </ul> <p>Wireshark \u00b7 Go Deep</p> <ul> <li>The world's most popular network protocol analyzer.</li> </ul> <p>PerfDog - \u6027\u80fd\u72d7</p> <ul> <li>\u5168\u5e73\u53f0\u6027\u80fd\u6d4b\u8bd5\u5206\u6790\u4e13\u5bb6</li> <li>\u81f4\u529b\u63d0\u5347\u5168\u5e73\u53f0\u5e94\u7528\u548c\u6e38\u620f\u7684\u6027\u80fd\u548c\u54c1\u8d28</li> </ul>"},{"location":"blog/20240430/mac-softwar-list/#chrome_extensions","title":"Chrome Extensions","text":"<p>\u5e2e\u5c0f\u5fd9\uff0c\u817e\u8bafQQ\u6d4f\u89c8\u5668\u5728\u7ebf\u5de5\u5177\u7bb1\u5e73\u53f0</p> <p>Tampermonkey Vimium</p> <p>Prevent Duplicate Tabs Smart TOC</p> <p>Simple Allow Copy Copy as Markdown MarkDownload</p> <p>Google Mail Checker Talking Clock ImageAssistant \u5185\u7f6e QR Code Generator\u3002 Voice Control for ChatGPT x Mia AI\uff1a\u4e0d\u652f\u6301 Arc Browser\u3002</p> <p>bypass-paywalls PaywallHub - archive.today / archive.is</p> <p>ChatGPT \u00bb Summarize &amp; Chat Video Downloader Professional PrintFriendly - Print and PDF Web Pages</p> <p>\u5212\u8bcd\u7ffb\u8bd1</p> <ul> <li>Immersive Translate - Translate Website &amp; PDF</li> </ul> <p>Web Highlights - PDF &amp; Web Highlighter</p> <ul> <li>Glasp Web Highlighter - PDF &amp; Web Highlights</li> </ul>"},{"location":"blog/20240410/spinning-top-aimless/","title":"\u82f6\u7136\u75b2\u5f79\u800c\u4e0d\u77e5\u5176\u6240\u5f52","text":"<p>\u73b0\u4ee3\u793e\u4f1a\uff0c\u5927\u591a\u6570\u4eba\u5fd9\u5f97\u50cf\u4e2a\u9640\u87ba\uff0c\u987e\u4e0d\u4e0a\u601d\u8003\u4eba\u751f\u7684\u65b9\u5411\u548c\u600e\u4e48\u5b9e\u73b0\u76ee\u6807\u3002</p> <p>\u4ee5\u4e0b\u8282\u9009\u81ea\u300a\u73b0\u4ee3C++\u8bed\u8a00\u6838\u5fc3\u7279\u6027\u89e3\u6790\u300b\u5f20\u94f6\u594e \u63a8\u8350\u5e8f</p> <p>\u83b7\u5f97\u5251\u6865\u5927\u5b66\u7684\u5b66\u4e60\u673a\u4f1a\uff0c\u5b9e\u73b0\u4e86\u5973\u670b\u53cb\u7684\u613f\u671b\uff0c\u8ba9\u672c\u8d3e\u5c3c<sup>1</sup>\u4e5f\u5f88\u9ad8\u5174\u3002\u66f4\u91cd\u8981\u7684\u662f\uff0c\u6307\u5bfc\u672c\u8d3e\u5c3c\u535a\u58eb\u5b66\u4e1a\u7684\u5bfc\u5e08\u4fbf\u662fEDSAC\u7684\u8bbe\u8ba1\u8005\u4e4b\u4e00\u6234\u7ef4\u5fb7\u00b7\u60e0\u52d2\u3002</p> <p>\u591a\u5e74\u4e4b\u540e\u5728\u672c\u8d3e\u5c3c\u83b7\u5f97\u8ba1\u7b97\u673a\u5386\u53f2\u535a\u7269\u9986\u7684\u9662\u58eb\u8363\u8a89\u540e\u63a5\u53d7\u91c7\u8bbf\u65f6\uff0c\u4ed6\u4ecd\u6e05\u695a\u5730\u8bb0\u5f97\u7b2c\u4e00\u6b21\u5230\u60e0\u52d2\u529e\u516c\u5ba4\u65f6\u7684\u60c5\u666f\u3002\u672c\u8d3e\u5c3c\u5750\u4e0b\u6765\u540e\uff0c\u60f3\u542c\u542c\u5bfc\u5e08\u5b89\u6392\u81ea\u5df1\u505a\u4ec0\u4e48\u3002\u6ca1\u60f3\u5230\uff0c\u60e0\u52d2\u63d0\u51fa\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u201c\u4f60\u77e5\u9053\u8bfb\u535a\u58eb\u548c\u8bfb\u7855\u58eb\u7684\u5dee\u522b\u5417\uff1f\u201d</p> <p>\u672c\u8d3e\u5c3c\u56de\u7b54\u9053\uff1a\u201c\u4e0d\u77e5\u9053\u3002\u201d</p> <p>\u60e0\u52d2\u8bf4\uff1a\u201c\u5982\u679c\u4e00\u5b9a\u9700\u8981\u6211\u544a\u8bc9\u4f60\u5e94\u8be5\u505a\u4ec0\u4e48\uff0c\u90a3\u4e48\u4f60\u5c31\u662f\u6765\u8bfb\u7855\u58eb\u3002\u201d</p> <p>\u672c\u8d3e\u5c3c\u660e\u767d\u4e86\uff0c\u5bfc\u5e08\u662f\u8ba9\u4ed6\u81ea\u5df1\u5bfb\u627e\u7814\u7a76\u65b9\u5411\u3002\u4e8e\u662f\u672c\u8d3e\u5c3c\u82b1\u4e86\u4e00\u5e74\u65f6\u95f4\u6765\u5bfb\u627e\u7814\u7a76\u65b9\u5411\uff0c\u7ecf\u8fc7\u5927\u91cf\u7684\u8c03\u67e5\u548c\u5206\u6790\uff0c\u6700\u540e\u9009\u62e9\u4e86\u5206\u5e03\u5f0f\u7cfb\u7edf\u3002</p> <p>1979\u5e74\uff0c\u672c\u8d3e\u5c3c\u5728\u5251\u6865\u5927\u5b66\u62ff\u5230\u4e86\u535a\u58eb\u5b66\u4f4d\u3002\u7ecf\u8fc7\u4e00\u756a\u52aa\u529b\uff0c\u4ed6\u6700\u7ec8\u83b7\u5f97\u4e86\u5230\u5927\u6d0b\u5f7c\u5cb8\u7684\u8d1d\u5c14\u5b9e\u9a8c\u5ba4\u5de5\u4f5c\u7684\u673a\u4f1a\u3002</p> <p>\u4e8e\u662f\u672c\u8d3e\u5c3c\u5148\u751f\u5e26\u7740\u59bb\u5b50\u548c\u5973\u513f\u4ece\u82f1\u56fd\u5230\u4e86\u7f8e\u56fd\u3002\u8d1d\u5c14\u5b9e\u9a8c\u5ba4\u4f4d\u4e8e\u7f8e\u56fd\u65b0\u6cfd\u897f\u5dde\u7684\u9ed8\u91cc\u5c71\u3002\u5728\u672c\u8d3e\u5c3c\u5230\u8fbe\u524d\uff0c\u90a3\u91cc\u5df2\u7ecf\u56e0\u4e3a\u53d1\u660e\u4e86 UNIX \u548c C \u8bed\u8a00\u800c\u540d\u626c\u5929\u4e0b\u3002</p> <p>\u5230\u8d1d\u5c14\u5b9e\u9a8c\u5ba4\u62a5\u5230\u540e\uff0c\u672c\u8d3e\u5c3c\u627e\u5230\u81ea\u5df1\u7684\u4e3b\u7ba1\uff0c\u5750\u4e0b\u6765\uff0c\u60f3\u542c\u542c\u9886\u5bfc\u5b89\u6392\u81ea\u5df1\u505a\u4ec0\u4e48\u3002\u9886\u5bfc\u7684\u6307\u793a\u975e\u5e38\u7b80\u5355\uff1a\u201c\u505a\u70b9\u6709\u8da3\u7684\u4e1c\u897f\u3002\u201d</p> <p>\u56de\u60f3\u8d77\u5f53\u5e74\u5728\u5251\u6865\u7b2c\u4e00\u6b21\u63a5\u53d7\u60e0\u52d2\u5bfc\u5e08\u6307\u5bfc\u7684\u7ecf\u5386\uff0c\u672c\u8d3e\u5c3c\u5bf9\u8fd9\u4e2a\u56de\u7b54\u5df2\u7ecf\u4e0d\u60ca\u5f02\u4e86\u3002\u800c\u4e14\u611f\u5230\u975e\u5e38\u9ad8\u5174\uff0c\u56e0\u4e3a\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u7684\u60f3\u6cd5\u5927\u5e72\u4e00\u573a\u3002</p> <p>...</p> <p>\u73b0\u4ee3\u793e\u4f1a\u4e2d\uff0c\u6bcf\u4e2a\u4eba\u90fd\u5fd9\u5fd9\u788c\u788c\uff0c\u7279\u522b\u662f\u7a0b\u5e8f\u5458\u7fa4\u4f53\uff0c\u5927\u591a\u5fd9\u5f97\u50cf\u4e2a\u9640\u87ba\u3002\u4eba\u751f\u5c31\u5728\u8fd9\u6837\u7684\u5fd9\u788c\u4e2d\u4e00\u5929\u5929\u8fc7\u53bb\u3002\u5076\u5c14\u7684\u95f2\u6687\u4e5f\u5f80\u5f80\u88ab\u5404\u79cd\u6e38\u620f\u548c\u5237\u5c4f\u5360\u636e\uff0c\u987e\u4e0d\u4e0a\u601d\u8003\u4eba\u751f\u7684\u65b9\u5411\u548c\u600e\u4e48\u5b9e\u73b0\u76ee\u6807\u3002</p> <p>\u5e84\u5b50\u00b7\u5185\u7bc7\u00b7\u9f50\u7269\u8bba</p> <p>\u4e0e\u7269\u76f8\u5203\u76f8\u9761\uff0c\u5176\u884c\u5c3d\u5982\u9a70\uff0c\u800c\u83ab\u4e4b\u80fd\u6b62\uff0c\u4e0d\u4ea6\u60b2\u4e4e\uff01\u7ec8\u8eab\u5f79\u5f79\u800c\u4e0d\u89c1\u5176\u6210\u529f\uff0c\u82f6\uff08ni\u00e9\uff09\u7136\u75b2\u5f79\u800c\u4e0d\u77e5\u5176\u6240\u5f52\uff0c\u53ef\u4e0d\u54c0\u90aa\uff01\u4eba\u8c13\u4e4b\u4e0d\u6b7b\uff0c\u595a\u76ca\uff1f\u5176\u5f62\u5316\uff0c\u5176\u5fc3\u4e0e\u4e4b\u7136\uff0c\u53ef\u4e0d\u8c13\u5927\u54c0\u4e4e\uff1f</p> <p></p> <ol> <li> <p>\u672c\u8d3e\u5c3c\u00b7\u65af\u7279\u52b3\u65af\u7279\u5362\u666e\uff08Bjarne Stroustrup\uff09\uff0cC++ \u4e4b\u7236\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"blog/20191021/linux-distro/","title":"Linux\u53d1\u884c\u7248\u6982\u89c8","text":"<p>Linux kernel ubiquity and Linux Distributions Timeline till 2023</p> <p>Linux distribution</p> <p>Linux\u00a0is a family of\u00a0open-source Unix-like operating systems\u00a0based on the\u00a0Linux kernel, an\u00a0operating system kernel\u00a0first released on September 17, 1991, by\u00a0Linus Torvalds. Linux is typically\u00a0packaged\u00a0as a\u00a0Linux distribution\u00a0(distro), which includes the kernel and supporting\u00a0system software\u00a0and\u00a0libraries, many of which are provided by the\u00a0GNU Project. Many Linux distributions use the word \"Linux\" in their name, but the\u00a0Free Software Foundation\u00a0uses and recommends the name \"GNU/Linux\" to emphasize the use and importance of\u00a0GNU\u00a0software in many distributions,\u00a0causing some controversy.</p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#history","title":"History","text":"<p>The two oldest and still active distribution projects started in 1993. The SLS distribution was not well maintained, so in July 1993 a new distribution, called <code>Slackware</code> and based on SLS, was released by Patrick Volkerding. Also dissatisfied with SLS, Ian Murdock set to create a free distribution by founding <code>Debian</code>, which had its first release in December 1993.</p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#kernel","title":"Kernel","text":"","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#distribution_timeline","title":"Distribution Timeline","text":"<p>Timeline of the development of main Linux distributions</p> <p></p> <p>Popular Linux distributions\u00a0include\u00a0Debian,\u00a0Fedora Linux,\u00a0Arch Linux, and\u00a0Ubuntu. Commercial distributions include\u00a0Red Hat Enterprise Linux\u00a0and\u00a0SUSE Linux Enterprise. Desktop Linux distributions include a\u00a0windowing system\u00a0such as\u00a0X11\u00a0or\u00a0Wayland\u00a0and a\u00a0desktop environment\u00a0such as\u00a0GNOME\u00a0or\u00a0KDE Plasma. Distributions intended for\u00a0servers\u00a0may not have a\u00a0graphical user interface\u00a0at all, or include a\u00a0solution stack\u00a0such as\u00a0LAMP. Because Linux is freely redistributable, anyone may create a distribution for any purpose.</p> <p>Almost one thousand\u00a0Linux distributions\u00a0exist. Because of the huge availability of software, distributions have taken a wide variety of forms, including those suitable for use on\u00a0desktops, servers, laptops,\u00a0netbooks, mobile phones and tablets, as well as in minimal environments typically for use in embedded systems. There are commercially backed distributions, such as\u00a0Fedora Linux\u00a0(Red Hat),\u00a0openSUSE\u00a0(SUSE) and\u00a0Ubuntu\u00a0(Canonical Ltd.); and entirely community-driven distributions, such as\u00a0Debian,\u00a0Slackware,\u00a0Gentoo\u00a0and\u00a0Arch Linux. Most distributions come ready-to-use and precompiled for a specific\u00a0instruction set, while some (such as\u00a0Gentoo) are distributed mostly in\u00a0source code\u00a0form and must be compiled locally for installation.</p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#commonwidely","title":"common\uff08Widely\uff09","text":"<p>Linux \u7684\u53d1\u884c\u7248\u672c\u53ef\u4ee5\u5927\u4f53\u5206\u4e3a\u4e24\u7c7b\uff1a</p> <ul> <li>\u5546\u4e1a\u516c\u53f8\u7ef4\u62a4\u7684\u53d1\u884c\u7248\u672c\uff0c\u4ee5\u8457\u540d\u7684 Red Hat \u4e3a\u4ee3\u8868\uff1b  </li> <li>\u793e\u533a\u7ec4\u7ec7\u7ef4\u62a4\u7684\u53d1\u884c\u7248\u672c\uff0c\u4ee5 Debian \u4e3a\u4ee3\u8868\u3002  </li> </ul> <p>Linux\u5404\u53d1\u884c\u7248\u6765\u6e90\u4e0e\u533a\u522b \u5e38\u89c1Linux\u7684\u53d1\u884c\u7248\u6709\u54ea\u4e9b\uff1f \u5e38\u89c1Linux\u53d1\u884c\u7248\u672c\u6709\u54ea\u4e9b\uff1f \u5e38\u7528Linux\u53d1\u884c\u7248\u64cd\u4f5c\u7cfb\u7edf\u5927\u76d8\u70b9 \u200blinux\u5404\u53d1\u884c\u7248\u672c\u4e4b\u95f4\u7684\u5173\u7cfb\u4e0e\u533a\u522b </p> <p>The website DistroWatch lists many Linux distributions and displays some of the ones that have the most web traffic on the site.</p> <p>Widely used GNU-based or GNU-compatible distributions</p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#slackware_-_suse","title":"Slackware - suse","text":"<p>Slackware</p> <p>opensuse - based on slackware  </p> <p>SuSE Linux \u4ee5 Slackware Linux \u4e3a\u57fa\u7840\uff0c\u539f\u6765\u662f\u5fb7\u56fd\u7684 SuSE Linux AG \u516c\u53f8\u53d1\u5e03\u7684 Linux \u7248\u672c\uff0c1994 \u5e74\u53d1\u884c\u4e86\u7b2c\u4e00\u7248\uff0c\u65e9\u671f\u53ea\u6709\u5546\u4e1a\u7248\u672c\uff0c2004 \u5e74\u88ab Novell \u516c\u53f8\u6536\u8d2d\u540e\uff0c\u6210\u7acb\u4e86 OpenSUSE \u793e\u533a\uff0c\u63a8\u51fa\u4e86\u81ea\u5df1\u7684\u793e\u533a\u7248\u672c OpenSUSE\u3002</p> <p>SuSE Linux \u5728\u6b27\u6d32\u8f83\u4e3a\u6d41\u884c\uff0c\u5728\u6211\u56fd\u56fd\u5185\u4e5f\u6709\u8f83\u591a\u5e94\u7528\u3002\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u5b83\u5438\u53d6\u4e86 Red Hat Linux \u7684\u5f88\u591a\u7279\u8d28\u3002</p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#fedora_-_rhel_-_centos","title":"fedora - RHEL - centos","text":"<p>Fedora and Red Hat Enterprise Linux :: Fedora Docs What's the difference between Fedora and Red Hat Enterprise Linux</p> <p>fedora - - upstream of RHEL centos - upstream=RHEL mageia -  forked from the Mandriva Linux distribution, based on Red Hat - Mandrake scientificlinux - based on RHEL  </p> <p>Red Hat \u516c\u53f8\u7684\u4ea7\u54c1\u4e3b\u8981\u5305\u62ec RHEL\uff08Red Hat Enterprise Linux\uff0c\u6536\u8d39\u7248\u672c\uff09\u548c CentOS\uff08RHEL \u7684\u793e\u533a\u514b\u9686\u7248\u672c\uff0c\u514d\u8d39\u7248\u672c\uff09\u3001Fedora Core\uff08\u7531 Red Hat \u684c\u9762\u7248\u53d1\u5c55\u800c\u6765\uff0c\u514d\u8d39\u7248\u672c\uff09\u3002</p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#debian_-_ubuntu","title":"debian - ubuntu","text":"<p>debian</p> <p>ubuntu - based on Debian deepin - derived from debian-knoppix linuxmint - Based on Debian and Ubuntu, \u4ecewindows\u5230Linuxmint trisquel - derived from ubuntu steamos - draws from Debian 8(Debian Jessie)  </p> <p>Ubuntu \u57fa\u4e8e\u77e5\u540d\u7684 Debian Linux \u53d1\u5c55\u800c\u6765\uff0c\u754c\u9762\u53cb\u597d\uff0c\u5bb9\u6613\u4e0a\u624b\uff0c\u5bf9\u786c\u4ef6\u7684\u652f\u6301\u975e\u5e38\u5168\u9762\uff0c\u662f\u76ee\u524d\u6700\u9002\u5408\u505a\u684c\u9762\u7cfb\u7edf\u7684 Linux \u53d1\u884c\u7248\u672c\uff0c\u800c\u4e14 Ubuntu \u7684\u6240\u6709\u53d1\u884c\u7248\u672c\u90fd\u514d\u8d39\u63d0\u4f9b\u3002</p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#archlinux","title":"archlinux","text":"<p>archlinux </p> <p>Pacman, a package manager written specifically for Arch Linux, is used to install, remove and update software packages.</p> <p>Derivatives:</p> <p>Various distributions are focused around providing an Arch base with an easier install process, such as EndeavourOS and Manjaro. SteamOS 3.0, the upcoming version of SteamOS used in Steam Deck is based on Arch Linux.  </p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#android__chromeos","title":"Android &amp; ChromeOS","text":"<p>Linux kernel based operating systems</p> <ul> <li>Android, Google's commercial operating system based on\u00a0Android OSP\u00a0that runs on many devices such as smartphones, smart TVs, set-top boxes.</li> <li>ChromeOS, Google's commercial operating system based on\u00a0ChromiumOS\u00a0that only runs on\u00a0Chromebooks,\u00a0Chromeboxes\u00a0and\u00a0tablet computers. Like\u00a0Android, it has the\u00a0Google Play Store\u00a0and other\u00a0Google apps. Support for applications that require GNU compatibility is available through a virtual machine called Crostini and referred to by Google as Linux support, see\u00a0Chromebook \u00a7\u00a0Compatibility with Linux applications (GNU compatibility).</li> </ul> <p>Whether the above operating systems count as a \"Linux distribution\" is a controversial topic. They use the Linux kernel, so the\u00a0Linux Foundation\u00a0and\u00a0Chris DiBona,\u00a0Google's open-source chief, agree that Android is a Linux distribution; others, such as Google engineer Patrick Brady, disagree by noting the lack of support for many GNU tools in Android, including\u00a0glibc.</p> <p>Other Linux kernel based operating systems include\u00a0Cyanogenmod, its fork\u00a0LineageOS,\u00a0Android-x86\u00a0and recently\u00a0Tizen,\u00a0Mer/Sailfish OS\u00a0and\u00a0KaiOS.</p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#nicheminority","title":"Niche\uff08Minority\uff09","text":"<p>Other distributions target specific niches, such as:</p> <ul> <li>Routers\u00a0\u2013 for example\u00a0OpenWrt</li> <li>Microcontrollers\u00a0without a\u00a0memory management unit\u00a0(MMU)\u00a0\u2013 for example\u00a0\u03bcClinux</li> <li>Internet of things\u00a0\u2013 for example, targeted by Ubuntu Core\u00a0and Microsoft's\u00a0Azure Sphere</li> <li>Home theater PCs\u00a0\u2013 for example, targeted by\u00a0KnoppMyth,\u00a0Kodi\u00a0(former XBMC) and\u00a0Mythbuntu</li> <li>Specific platforms\u00a0\u2013 for example,\u00a0Raspberry Pi OS\u00a0targets the\u00a0Raspberry Pi\u00a0platform</li> <li>Education\u00a0\u2013 examples are\u00a0Edubuntu\u00a0and\u00a0Karoshi, server systems based on\u00a0PCLinuxOS</li> <li>Scientific computer servers and workstations\u00a0\u2013 for example, targeted by\u00a0Scientific Linux</li> <li>Digital audio workstations for music production\u00a0\u2013 for example, targeted by\u00a0Ubuntu Studio</li> <li>Computer security,\u00a0digital forensics\u00a0and\u00a0penetration testing\u00a0\u2013 examples are\u00a0Kali Linux\u00a0and\u00a0Parrot Security OS</li> <li>Privacy and anonymity\u00a0\u2013 for example, targeted by\u00a0Tails,\u00a0Whonix,\u00a0Qubes, and\u00a0FreedomBox</li> <li>Offline use\u00a0\u2013 for example,\u00a0Endless OS</li> <li>Gaming\u00a0\u2013 for example,\u00a0SteamOS</li> </ul> <p>\u6811\u8393\u6d3e\u64cd\u4f5c\u7cfb\u7edf\uff08Raspberry Pi OS\uff09(formerly Raspbian) is a Unix-like operating system based on the Debian GNU/Linux distribution for the Raspberry Pi family of compact single-board computers.</p>","tags":["linux","distro"]},{"location":"blog/20191021/linux-distro/#freebsd","title":"freebsd","text":"<p>freebsd \u548c linux \u90fd\u662f\u57fa\u4e8e UNIX \u7684 Unix-Like \u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p>FreeBSD is a free and open-source Unix-like operating system descended from the Berkeley Software Distribution (BSD). The first version of FreeBSD was released in 1993 developed from 386BSD and the current version runs on x86, ARM, PowerPC and RISC-V processors. The project is supported and promoted by the FreeBSD Foundation.</p> <ul> <li>freebsd - integral part of Apple's Darwin\uff0cand the system software for Sony's PlayStation 3 and PlayStation 4</li> </ul> <p>As of 2005, FreeBSD was the most popular\u00a0open-source\u00a0BSD operating system, accounting for more than three-quarters of all installed and\u00a0permissively licensed\u00a0BSD systems. Much of FreeBSD's\u00a0codebase\u00a0has become an integral part of other operating systems such as\u00a0Darwin\u00a0(the basis for\u00a0macOS,\u00a0iOS,\u00a0iPadOS,\u00a0watchOS, and\u00a0tvOS),\u00a0TrueNAS\u00a0(an open-source\u00a0NAS/SAN\u00a0operating system), and the system software for the\u00a0PlayStation 3 and\u00a0PlayStation 4 game consoles. The other BSD systems (OpenBSD,\u00a0NetBSD, and\u00a0DragonFly BSD) also contain a large amount of FreeBSD code, and vice-versa.</p> <p>gentoo - based on freebsd, father of Chrome OS  </p> <p>Gentoo \u6700\u521d\u7531 Daniel Robbins\uff08FreeBSD \u7684\u5f00\u53d1\u8005\u4e4b\u4e00\uff09\u521b\u5efa\uff0c\u9996\u4e2a\u7a33\u5b9a\u7248\u672c\u53d1\u5e03\u4e8e 2002 \u5e74\u3002Gentoo \u662f\u6240\u6709 Linux \u53d1\u884c\u7248\u672c\u91cc\u5b89\u88c5\u6700\u590d\u6742\u7684\uff0c\u5230\u76ee\u524d\u4e3a\u6b62\u4ecd\u91c7\u7528\u6e90\u7801\u5305\u7f16\u8bd1\u5b89\u88c5\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p>\u4e0d\u8fc7\uff0c\u5b83\u662f\u5b89\u88c5\u5b8c\u6210\u540e\u6700\u4fbf\u4e8e\u7ba1\u7406\u7684\u7248\u672c\uff0c\u4e5f\u662f\u5728\u76f8\u540c\u786c\u4ef6\u73af\u5883\u4e0b\u8fd0\u884c\u6700\u5feb\u7684\u7248\u672c\u3002\u81ea\u4ece Gentoo 1.0 \u9762\u4e16\u540e\uff0c\u5b83\u5c31\u50cf\u4e00\u573a\u98ce\u66b4\uff0c\u7ed9 Linux \u4e16\u754c\u5e26\u6765\u4e86\u5de8\u5927\u7684\u60ca\u559c\uff0c\u540c\u65f6\u4e5f\u5438\u5f15\u4e86\u5927\u91cf\u7684\u7528\u6237\u548c\u5f00\u53d1\u8005\u6295\u5165 Gentoo Linux \u7684\u6000\u62b1\u3002</p>","tags":["linux","distro"]},{"location":"blog/20191022/linux-man/","title":"Linux\u5e2e\u52a9\u624b\u518c\u6982\u89c8","text":"<p>There's a man hiding in Linux who's going to help you when you need to help yourself.</p>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#manpath","title":"manpath","text":"<p>macOS \u4e0b\u7684 manpath\uff1a</p> <pre><code># \u7b49\u6548 man -w\nfaner@MBP-FAN:~|\u21d2  manpath\n/usr/local/share/man:/usr/share/man:/opt/X11/share/man:/Applications/Xcode-beta.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/share/man:/Applications/Xcode-beta.app/Contents/Developer/usr/share/man:/Applications/Xcode-beta.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/share/man\n</code></pre> <p>raspbian \u4e0b\u7684 manpath\uff1a</p> <pre><code># \u7b49\u6548 man -w\npi@raspberrypi:~$ manpath\n/usr/local/man:/usr/local/share/man:/usr/share/man:/usr/man\n</code></pre> <p>Ubuntu \u4e0b\u7684 manpath\uff1a</p> <pre><code># \u7b49\u6548 man -w\npifan@rpi4b-ubuntu $ manpath\n/usr/local/man:/usr/local/share/man:/usr/share/man\n</code></pre> <p>CentOS \u4e0b\u7684 manpath\uff1a</p> <pre><code># \u7b49\u6548 man -w\n[root@vcentos ~]# manpath\n/usr/local/share/man:/usr/share/man\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#usrshareman","title":"/usr/share/man/","text":"<p>\u4ee5\u4e0b\u4e3a <code>/usr/share/man/</code> \u4e0b\u7684\u8be6\u7ec6\u5217\u8868\uff1a</p> <pre><code># macOS\nfaner@MBP-FAN:~|\u21d2  cd /usr/share/man/\nfaner@MBP-FAN:/usr/share/man|\u21d2 ls -F\nman1/ man4/ man5/ man6/ man7/ man8/ man9/ mann/\n\n# raspbian\npi@raspberrypi:/usr/share/man$ ls\ncs  es  fr.ISO8859-1  hu  ja    man2  man5  man8  pt     sl  zh_CN\nda  fi  fr.UTF-8      id  ko    man3  man6  nl    pt_BR  sv  zh_TW\nde  fr  gl            it  man1  man4  man7  pl    ru     tr\n\npi@raspberrypi:/usr/share/man$ ls zh_CN\nman1  man5  man8\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#bash1","title":"bash.1","text":"<p>man\u5b50\u76ee\u5f55\u540e\u9762\u7684\u6570\u5b57\u4e3a man \u624b\u518c\u7ae0\u8282\u5e8f\u53f7\u3002</p> <pre><code># macOS\nfaner@MBP-FAN:/usr/share/man|\u21d2  ls man1 | grep bash\nbash.1\nbashbug.1\n\n# raspbian\npi@raspberrypi:/usr/share/man$ ls man1 | grep bash\nbash.1.gz\nbashbug.1.gz\ndh_bash-completion.1.gz\nrbash.1.gz\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#man_-w","title":"man -w","text":"<p><code>man -w</code> \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b man \u624b\u518c\u7684 nroff \u6e90\u6587\u4ef6\uff1b\u52a0\u4e0a <code>-a</code>(--all) \u9009\u9879\uff0c\u5219\u663e\u793a\u6240\u6709 section \u5339\u914d\u5230\u7684\u547d\u4ee4\u8bf4\u660e\u6587\u6863\u8def\u5f84\u3002</p> <pre><code># macOS\nfaner@MBP-FAN:~|\u21d2  man -w bash\n/usr/share/man/man1/bash.1\n\nfaner@MBP-FAN:~|\u21d2  man -aw shutdown\n/usr/share/man/man8/shutdown.8\n/Applications/Xcode-beta.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/share/man/man8/shutdown.8\n/Applications/Xcode-beta.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.13.sdk/usr/share/man/man2/shutdown.2\n\n# raspbian\npi@raspberrypi:~$ man -w bash\n/usr/share/man/man1/bash.1.gz\n\npi@raspberrypi:/usr/share/man$ man -aw shutdown\n/usr/share/man/man8/shutdown.8.gz\n/usr/share/man/man2/shutdown.2.gz\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#man_-l","title":"man -L","text":"<p>-L \u9009\u9879\u53ef\u6307\u5b9a\u5e2e\u52a9\u6587\u6863\u7684\u8bed\u7cfb\u3002</p> <p>-L locale, --locale=locale</p> <p>\u6267\u884c <code>ls /usr/share/man/zh_CN</code> \u53ef\u77e5 man 1\u30015\u30018 \u4e09\u7ae0\u8282\u4e2d\u542b\u6709\u90e8\u5206\u4e2d\u6587\u7ffb\u8bd1\u6587\u6863\u3002\u5177\u4f53\u53ef\u8fdb\u4e00\u6b65\u6df1\u5165\u67e5\u770b <code>/zh_CN/man1/</code> \u5b50\u76ee\u5f55\u3002</p> <pre><code>pi@raspberrypi:~$ man -L zh_CN man\nMAN(1)                         \u624b\u518c\u5206\u9875\u663e\u793a\u5de5\u5177                         MAN(1)\n\n\u540d\u79f0\n       man - \u5728\u7ebf\u53c2\u8003\u624b\u518c\u7684\u63a5\u53e3\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#options","title":"options","text":"<p><code>\u2212f</code>: Equivalent to <code>whatis</code>. <code>\u2212k</code>: Equivalent to <code>apropos</code>.  </p>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#man_pager","title":"man pager","text":"<p>man \u9ed8\u8ba4\u4f7f\u7528\u53ef\u7ffb\u9875\u67e5\u770b\u7684 less \u4f5c\u4e3a\u5206\u9875\u5668\uff0c\u53ef\u6307\u5b9a <code>-P pager</code>\uff08<code>--pager=pager</code>\uff09 \u9009\u9879\u6765\u4fee\u6539\u8f93\u51fa\u5206\u9875\u5668\u7a0b\u5e8f\u3002</p> <p>This option overrides the <code>$MANPAGER</code> environment variable, which in turn overrides the <code>$PAGER</code> environment variable.</p> <ul> <li>linux: By default, man uses <code>less</code>.  </li> <li>raspbian: By default, man uses <code>pager</code>.  </li> <li>macOS: By default, man uses <code>/usr/bin/less -is</code>.  </li> </ul> <pre><code>pi@raspberrypi:~ $ whatis pager\npager (1)            - opposite of more\n\npi@raspberrypi:~ $ echo $PAGER\nless\n\n# man less\npi@raspberrypi:~ $ whatis less\nless (1)             - opposite of more\n</code></pre> <p>man pager \u6253\u5f00\u7684\u4e5f\u662f LESS(1) \u7684\u5e2e\u52a9\u624b\u518c\u3002</p> <pre><code>faner@MBP-FAN:~|\u21d2  echo $PAGER\nless\n\n# man less\nfaner@MBP-FAN:~ $ whatis less\nless(1)                  - opposite of more\n</code></pre> <p>\u53ef\u89c1 man pager \u9ed8\u8ba4\u662f\u57fa\u4e8e less \u7684\uff0c\u800c less \u57fa\u4e8e more\uff0cmore \u5219\u662f\u57fa\u4e8e vi \u7684\u3002  </p> <ul> <li>Interactive commands for more are based on vi(1).  </li> <li>Commands of less are based on both more and vi.  </li> </ul> <p>\u4e5f\u5373 man \u662f\u57fa\u4e8e vi-style \u7684\u3002  </p>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#help","title":"help","text":"<p>\u5728\u67e5\u770b man page \u65f6\uff0c\u8f93\u5165 <code>:h</code> \u53ef\u6253\u5f00\u67e5\u770b man-page viewer \u7684\u64cd\u4f5c\u5e2e\u52a9\u8bf4\u660e\uff08SUMMARY OF LESS COMMANDS\uff09\u3002</p> <ul> <li>MOVING </li> <li>SEARCHING </li> <li>JUMPING </li> <li>CHANGING FILES  </li> <li>MISCELLANEOUS COMMANDS  </li> <li>OPTIONS  </li> <li>LINE EDITING  </li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#status_line","title":"status line","text":"<p><code>man/less/vi</code> \u4e2d\u8f93\u5165 <code>=</code> \u53ef\u4ee5\u8c03\u51fa bottom status / prompt line \u67e5\u770b\u9605\u8bfb\u8fdb\u5ea6\uff1a</p> <pre><code># raspbian\nDownloads/NSURLSession.h lines 3-63/1002 byte 1933/47129 4%  (press RETURN)\n</code></pre> <p>\u5173\u4e8e less \u5e95\u680f\u72b6\u6001\u884c\u7684\u914d\u7f6e\uff0c\u53ef\u53c2\u8003 constantly display status line in less\uff1a</p> <p>\u53ef\u5728 <code>~/.zshrc</code> \u6216 <code>~/.bash_profile</code>(<code>~/bashrc</code>) \u4e2d\u914d\u7f6e LESS\uff0csource \u91cd\u542f\u751f\u6548\uff1a</p> <pre><code># less to prompt even more verbosely than more\nLESS='-Pslines %lt-%lb (%Pt-%Pb \\%) bytes %bt-%bb file %f'; export LESS\n</code></pre> <p>\u8bf4\u660e\uff1a<code>%l</code>, <code>%P</code>, <code>%b</code> for lines, percentage and bytes, trailing <code>t</code> and <code>b</code> for \"top\" and \"bottom\" of screen.  </p> <p><code>less $ZSH_CUSTOM/scripts/vimman/vimman.zsh</code> \u5e95\u680f\u72b6\u6001\uff1a</p> <pre><code>lines 39-95 (20-49 %) bytes 959-2253 file /Users/faner/.oh-my-zsh/custom/scripts/vimman/vimman.zsh\n</code></pre> <p>\u53ef\u4ee5\u6539\u826f\u4e3a <code>LESS='-Pslines %lt-%lb bytes %bt-%bb %Pb\\% of file %f';</code></p> <p>\u6ce8\u610f\uff1aman \u67e5\u770b\u624b\u518c\uff0c\u5e95\u90e8 <code>%f</code> \u4e3a\u7a7a\u3002</p> <p>Make the less Command More Powerful</p>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#man_pages","title":"man pages","text":"","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#unixcom","title":"unix.com","text":"<p>unix.com</p> <ul> <li>Unix Commands - Man Pages - FREEBSD Man Pages </li> <li>Linux Commands - Man Pages - LINUX Man Pages </li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#kernelorg","title":"kernel.org","text":"<p>Linux Man Pages </p> <p>The Linux man-pages project documents the Linux kernel and C library interfaces that are employed by user-space programs. With respect to the C library, the primary focus is the GNU C library (glibc), although, where known, documentation of variations on other C libraries available for Linux is also included.</p> <ul> <li>CGit </li> <li>Online man pages @man7.org  </li> <li>Changelog </li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#online_man","title":"online man","text":"<p>man7.org - Online manual pages linuxcommand.org - Command Documentation - Manual Pages ubuntu manuals - man man </p> <p>\u4ee5\u4e0b\u4e3a\u4e3a\u5404\u5927\u5e73\u53f0 ls \u547d\u4ee4\u5728\u7ebf\u624b\u518c\uff1a</p> <ul> <li>unix/POSIX - ls - list directory contents </li> <li>FreeBSD/Darwin - ls -- list directory contents </li> <li>linux - ls - list directory contents </li> <li>debian - ls - list directory contents </li> <li>ubuntu - ls - list contents of directory </li> <li>windows - dir - Displays a list of a directory's files and subdirectories </li> </ul> <p>\u4ee5\u4e0b\u4e3a\u4e3a\u5404\u5927\u5e73\u53f0 select \u51fd\u6570\u5728\u7ebf\u624b\u518c\uff1a</p> <ul> <li>unix/POSIX - select </li> <li>FreeBSD/Darwin - SELECT(2) </li> <li>linux - SELECT(2) </li> <li>debian - SELECT(2) </li> <li>ubuntu - select.2 </li> <li>Windows - select() </li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#manual_page_types","title":"manual page types","text":"<p>\u5584\u7528 man \u6307\u4ee4\u67e5\u8a62 Linux \u7dda\u4e0a\u624b\u518a\uff08Man Page\uff09 </p> <pre><code>$ man man\nMAN(1)                                                 Manual pager utils                                                 MAN(1)\n\nNAME\n       man - an interface to the on-line reference manuals\n\nDESCRIPTION\n\n       The table below shows the section numbers of the manual followed by the\n       types of pages they contain.\n\n       1   Executable programs or shell commands\n       2   System calls (functions provided by the kernel)\n       3   Library calls (functions within program libraries)\n       4   Special files (usually found in /dev)\n       5   File formats and conventions eg /etc/passwd\n       6   Games\n       7   Miscellaneous  (including  macro  packages  and  conventions), e.g.\n           man(7), groff(7)\n       8   System administration commands (usually only for root)\n       9   Kernel routines [Non standard]\n</code></pre> <p>Online man pages: by section  |  alphabetically  |  by project</p> <ul> <li>1: User commands; man-pages includes a very few Section 1 pages that document programs supplied by the GNU C library.  </li> <li>2: System calls documents the system calls provided by the Linux kernel.  </li> <li>3: Library functions documents the functions provided by the standard C library.  </li> <li>4: Devices documents details of various devices, most of which reside in <code>/dev</code>.  </li> <li>5: Files describes various file formats, and includes proc(5), which documents the <code>/proc</code> file system.  </li> <li>7: Overviews, conventions, and miscellaneous.  </li> <li>8: Superuser and system administration commands; man-pages includes a very few Section 8 pages, mainly documenting programs supplied by the GNU C library.  </li> </ul> <p>\u5982\u679c\u4e00\u4e2a\u5173\u952e\u5b57\uff08item keyword\uff09\u51fa\u73b0\u5728\u591a\u4e2a man \u624b\u518c\u4e2d\uff0c\u5219\u6309\u7167\u624b\u518c\u4e2d\u7684\u7ae0\u8282\u53f7\u987a\u5e8f\u8fdb\u884c\u641c\u7d22\u3002man \u9884\u5b9a\u4e49\u7684\u641c\u7d22\u7ae0\u8282\u53f7\u987a\u5e8f\uff08search available sections following a pre-defined order by default\uff09\u4e3a <code>1 n l 8 3 2 5 4 9 6 7</code>\u3002  </p> <p>\u5982\u679c\u60f3\u67e5\u770b\u67d0\u4e2a\u6bb5\u53f7\u4e0b\u7684\u6240\u6709\u547d\u4ee4\uff0c\u53ef\u4ee5\u8f93\u5165 <code>man 8</code> \u518d\u8f93\u5165 tab\uff0c\u904d\u5386 possibilities\uff1a</p> <pre><code>~ \u2192 man 8 \nzsh: do you wish to see all 714 possibilities (357 lines)?\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#1general_commands","title":"1.General Commands","text":"<ul> <li>man bash\uff1aMAN(1), BASH(1)\uff1b  </li> <li>\u811a\u672c\u7c7b\u578b\u53ca\u547d\u4ee4\u6587\u4ef6\uff1aWHICH(1) \uff08\u76f8\u5f53\u4e8e <code>type -p</code>\uff09\uff1b  </li> <li>\u7cfb\u7edf\u4fe1\u606f\uff1aUNAME(1), ARCH(1), HOSTNAME(1)\uff1b  </li> <li>\u7528\u6237\u6743\u9650\u7ba1\u7406\uff1aSU(1), CHGRP(1), CHOWN(1), CHMOD(1), ID(1), WHO(1)\uff1b  </li> <li>\u73af\u5883\u53d8\u91cf\uff1aENV(1), DATE(1),  CAL(1)\uff1b  </li> <li>\u5217\u4e3e\u3001\u6253\u5370\u3001\u8f93\u51fa\uff1aECHO(1), PRINTF(1), LS(1), TREE(1)\uff1b  </li> <li>\u76ee\u5f55\u7ba1\u7406\uff1aPWD(1), MKDIR(1), RMDIR(1)\uff1b  </li> <li>\u6587\u4ef6\u7ba1\u7406\uff1aCP(1), RM(1), MV(1)\uff1b  </li> <li>\u78c1\u76d8\u7ba1\u7406\uff1aDF(1), DU(1)\uff1b  </li> <li>\u6a21\u5f0f\u5339\u914d\u53ca\u683c\u5f0f\u5316\u63d0\u53d6\uff1aGREP(1), SED(1), MAWK(1), XARGS(1)\uff1b  </li> <li>\u6587\u672c\u7f16\u8f91\u5668\uff1aNANO(1), VIM(1)\uff1b  </li> <li>\u6587\u4ef6\u4fe1\u606f\uff1aTOUCH(1), FILE(1)\uff1b  </li> <li>\u6587\u4ef6\u5185\u5bb9\u67e5\u9605\uff1aCAT(1), TAC(1), NL(1), MORE(1), LESS(1), HEAD(1), TAIL;  </li> <li>SCM \u7248\u672c\u63a7\u5236\u7ba1\u7406\u5de5\u5177\uff1aGIT(1), svn(1)\uff1b  </li> <li>\u6bd4\u8f83\u8865\u4e01\u5de5\u5177\uff1aDIFF(1), CMP(1), PATCH(1)\uff1b  </li> <li>\u7f51\u7edc\u8bca\u65ad\u547d\u4ee4\uff1aTRACEROUTE(1)\uff1b  </li> <li>\u7f51\u7edc\u4f20\u8f93\u76f8\u5173\uff1acurl(1), WGET(1), SSH(1), SCP(1) , SFTP(1), rsync(1)\uff1b  </li> <li>\u7f16\u7a0b\u5de5\u5177\u94fe\uff1aMAKE(1), STRACE(1)\uff1bgcc \u548c gdb \u6ca1\u6709 manual entry\uff1b  </li> <li>\u8f6f\u4ef6\u5305\u7ba1\u7406\u5de5\u5177\uff1adpkg(1)\uff1b  </li> <li>\u67e5\u627e\u6587\u4ef6\uff1aWHEREIS(1), FIND(1)\uff1b  </li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#1m_system_admin","title":"1m. System Admin","text":"<p>raspbian \u4e0b\u9ed8\u8ba4\u53ea\u5b89\u88c5\u4e86 git\uff0cmacOS \u4e0b\u5b89\u88c5\u7684 svn(subversion) \u6709 man page\u3002</p>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#2system_calls","title":"2.System Calls","text":"<ul> <li>\u7cfb\u7edf\u8c03\u7528\uff1aSYSCALL(2), _EXIT(2), IOCTL(2);  </li> <li>\u6743\u9650\u64cd\u4f5c\u63a5\u53e3\uff1aCHMOD(2), CHOWN(2), CHDIR(2);  </li> <li>\u6587\u4ef6\u64cd\u4f5c\u63a5\u53e3\uff1aFCNTL(2), DUP(2), READ(2), WRITE(2), CLOSE(2);  </li> <li>C\u5e93\u51fd\u6570\uff1aSIGNAL(2);  </li> <li>socket \u7f16\u7a0b\u63a5\u53e3\uff1aBIND(2), LISTEN(2), CONNECT(2), ACCEPT(2), SEND(2), RECV(2), SHUTDOWN(2);  </li> <li>epoll \u7f16\u7a0b\u63a5\u53e3\uff1aEVENTFD(2), EPOLL_CREATE(2), EPOLL_CTL(2), EPOLL_WAIT(2);  </li> </ul> <ol> <li><code>man write</code> \u9ed8\u8ba4\u67e5\u770b\u7684\u662f WRITE(1) - send a message to another user\uff1b<code>man 2 write</code> \u624d\u80fd\u660e\u786e\u67e5\u770b socket \u7f16\u7a0b\u63a5\u53e3 WRITE(2)\u3002  </li> <li><code>man accept</code> \u9ed8\u8ba4\u67e5\u770b\u7684\u662f cupsaccept(8)\uff1b<code>man 2 accept</code> \u624d\u80fd\u660e\u786e\u67e5\u770b socket \u7f16\u7a0b\u63a5\u53e3 ACCEPT(2)\u3002  </li> <li><code>man shutdown</code> \u9ed8\u8ba4\u67e5\u770b\u7684\u662f\u5173\u673a\u547d\u4ee4 SHUTDOWN(8)\uff1b<code>man 2 shutdown</code> \u624d\u80fd\u660e\u786e\u67e5\u770b socket \u7f16\u7a0b\u63a5\u53e3 SHUTDOWN(2)\u3002  </li> <li>macOS(BSD) \u4e0b\u6709 KQUEUE(2) \u7684 man page\uff0craspbian(Debian) \u4e0b\u6ca1\u6709\u8be5\u63a5\u53e3\u3002  </li> </ol>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#3subroutines","title":"3.Subroutines","text":"<ul> <li>READLINE(3), HISTORY(3);  </li> <li>stdio \u63a5\u53e3\uff1aPRINTF(3);  </li> <li>Pthreads \u76f8\u5173\u63a5\u53e3\uff1aPTHREAD_ATTR_INIT(3), PTHREAD_SELF(3), PTHREAD_EQUAL(3), PTHREAD_JOIN(3), PTHREAD_CANCEL(3), PTHREAD_DETACH(3), PTHREAD_EXIT(3);  </li> <li>EXIT(3);  </li> </ul> <ol> <li><code>PRINTF(1)</code> \u4e3a Linux \u5185\u6838\u5411 bash shell \u63d0\u4f9b\u7684\u683c\u5f0f\u5316\u8f93\u51fa\u652f\u6301\uff1b\u800c\u8fd9\u91cc\u7684 <code>PRINTF(3)</code> \u4e3a Linux Programmer's Manual\uff0c\u4e3a\u6807\u51c6C\u5e93\uff08libstdcxx\uff09\u5934\u6587\u4ef6  \u63d0\u4f9b\u7684\u63a7\u5236\u53f0\u683c\u5f0f\u5316\u6253\u5370\u63a5\u53e3\u51fd\u6570\u3002   <li>macOS(BSD) \u4e0b\u6709 <code>PTHREAD(3)</code> \u7684 man page\uff0craspbian(Debian) \u4e0b\u6ca1\u6709\uff0c\u53ea\u6709 PTHREADS(7) \u4ee5\u53ca \u3002  </li>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#4special_files","title":"4.Special Files","text":"","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#5file_formats","title":"5.File Formats","text":"<p>\u7f51\u7edc\u63a5\u53e3\u63a7\u5236\u7ba1\u7406\uff1aINTERFACES(5), DHCPCD.CONF(5)</p> <ul> <li>INTERFACES(5) \u5bf9\u5e94 <code>/etc/network/interfaces</code>\uff1b  </li> <li>DHCPCD.CONF(5) \u5bf9\u5e94 <code>/etc/dhcpcd.conf</code>;  </li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#6games","title":"6.Games","text":"","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#7macros_and_conventions","title":"7.Macros and Conventions","text":"<ul> <li>MAN(7);  </li> <li>HIER(7);  </li> <li>PTHREADS(7);  </li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#8maintenance_commands","title":"8.Maintenance Commands","text":"<ul> <li>\u7cfb\u7edf\u7ba1\u7406\uff1aSUDO(8), SHUTDOWN(8), HALT(8)\uff1b  </li> <li>\u7f51\u7edc\u63a5\u53e3\u7ba1\u7406\uff1aIFCONFIG(8), IFUP(8), \uff1b  </li> <li>\u7f51\u7edc\u8bca\u65ad\u5de5\u5177\uff1aARP(8),  RARP(8), PING(8), ROUTE(8), NETSTAT(8),   IPTABLES(8)\u3002  </li> <li>\u8f6f\u4ef6\u5305\u7ba1\u7406\u5de5\u5177\uff1aAPT(8)  </li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#9kernel_interface","title":"9.Kernel Interface","text":"","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#n_new_commands","title":"N. New Commands","text":"","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#man_in_specified_section","title":"man in specified section","text":"<p>\u6709\u7684\u547d\u4ee4\u53ef\u80fd\u4f1a\u51fa\u73b0\u5728\u4e0d\u540c\u7684 man \u624b\u518c\u4e2d\uff0c\u901a\u8fc7 <code>man -f</code> \u547d\u4ee4\u53ef\u67e5\u770b\u547d\u4ee4\u7b80\u4ecb\uff0c\u9ed8\u8ba4\u663e\u793a\u7b2c\u4e00\u4e2a\u641c\u7d22\u5230\u7684\uff1b\u52a0\u4e0a <code>-a</code>(--all) \u9009\u9879\uff0c\u5219\u663e\u793a\u6240\u6709 section \u5339\u914d\u5230\u7684\u547d\u4ee4\u3002</p> <pre><code># macOS\nfaner@MBP-FAN:~|\u21d2  man -af shutdown\nshutdown(8)              - close down the system at a given time\nupsshutdown(8)           - UPS emergency low power shutdown script\nshutdown(2)              - shut down part of a full-duplex connection\nshutdown(8)              - close down the system at a given time\nupsshutdown(8)           - UPS emergency low power shutdown script\n\n# raspbian\npi@rpi3b-raspbian $ man -af kill\nkill (2)             - send signal to a process\nkill (1)             - send a signal to a process\n\n# ubuntu\npifan@rpi4b-ubuntu $ man -af printf\nprintf (1)           - format and print data\nprintf (3)           - formatted output conversion\n</code></pre> <p>\u53ef\u4ee5\u5728\u6307\u5b9a\u624b\u518c\u53f7\u4e2d\u67e5\u627e\u67d0\u4e2a\u547d\u4ee4\u7684\u5e2e\u52a9\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u53ef\u5728 man \u540e\u9762\u63a5\u624b\u518c\u7684 section \u7f16\u53f7\uff0c\u4ece\u6307\u5b9a man \u624b\u518c\u4e2d\u641c\u7d22\u5e2e\u52a9\u3002</p> <ol> <li><code>man 1 kill</code>\uff08User commands\uff09,<code>man 2 kill</code>\uff08System calls\uff09\uff1b</li> <li><code>man 2 shutdown</code>\uff08System calls\uff09,<code>man shutdown 8</code>\uff08Admin commands\uff09\u3002</li> </ol> <p>\u5b66\u4e60 UNX\uff08Unix/Linux\uff09C \u8bed\u8a00\u7f16\u7a0b\uff0c\u7ecf\u5e38\u8981\u67e5\u9605\u6807\u51c6\u5e93\u4e2d\u7684 API \u53c2\u8003\uff0c\u4e3b\u8981\u96c6\u4e2d\u5728 section 3\u2014\u2014Subroutines \u4e2d\u3002</p> <ul> <li>macOS: Library Functions Manual</li> <li>Linux: Linux Programmer's Manual</li> </ul> <p>\u4f8b\u5982 <code>PRINTF(1)</code> \u4e3a macOS/Linux \u5185\u6838\u5411 bash shell \u63d0\u4f9b\u7684\u683c\u5f0f\u5316\u8f93\u51fa\u652f\u6301\uff1b\u800c <code>PRINTF(3)</code> \u4e3a C \u8bed\u8a00\u6807\u51c6\u5e93\uff08libstdcxx\uff09\u5934\u6587\u4ef6  \u4e2d\u63d0\u4f9b\u7684\u63a7\u5236\u53f0\u683c\u5f0f\u5316\u6253\u5370\u63a5\u53e3\u51fd\u6570\u3002 <ol> <li>\u6267\u884c <code>man stdio</code> \u67e5\u770b stdio - standard input/output library functions\u3002</li> <li>\u6267\u884c <code>man 3 printf</code> \u67e5\u770b\u5e93\u51fd\u6570\u624b\u518c\u4e2d\u7684\u8fd9\u4e2a API \u53c2\u8003\u6587\u6863\u3002</li> </ol> <p>\u4f8b\u5982\uff0csocket\u3001\u4fe1\u53f7\u91cf\u548c\u591a\u7ebf\u7a0b\u76f8\u5173\u7684 API\uff1a</p> <ul> <li>socket - create an endpoint for communication: 2- <code>socket</code></li> <li>System V semaphore: 2 - <code>semget</code>, <code>semctl</code>, <code>semop</code></li> <li>POSIX semaphore: 2(macOS)/3(Linux) - <code>sem_open</code>, <code>sem_wait</code>, <code>sem_post</code>, <code>sem_close</code></li> <li>Standard/ANSI C software signal handling facilities: 3/2 - <code>signal</code>, <code>sigaction</code></li> <li>macOS: 3 pthread: Thread Routines, Mutex, Condition Variable, Read/Write Lock, Per-Thread Context</li> <li>ubuntu: 7 pthreads</li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#conventional_section","title":"Conventional section","text":"<pre><code>       A manual page consists of several sections.\n\n       Conventional  section  names  include  NAME,  SYNOPSIS,  CONFIGURATION,\n       DESCRIPTION,  OPTIONS,  EXIT STATUS, RETURN VALUE, ERRORS, ENVIRONMENT,\n       FILES, VERSIONS, CONFORMING TO,  NOTES,  BUGS,  EXAMPLE,  AUTHORS,  and\n       SEE ALSO.\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#man_man","title":"man man","text":"<p>Linux 2.6 - man page for man (linux section 1)</p> <pre><code>MAN(1)                  Manual pager utils                 MAN(1)\nNAME\n       man - an interface to the on-line reference manuals\n\nSYNOPSIS\n\nDESCRIPTION\n\nEXAMPLES\n\nOVERVIEW\n\nDEFAULTS\n\nOPTIONS\n\nEXIT STATUS\n\nENVIRONMENT\n\nFILES\n\nSEE ALSO\n\nHISTORY\n\n2.6.0.2                     2011-04-13                     MAN(1)\n</code></pre> <p>Raspbian GNU/Linux 9.1 (stretch) \u4e0b\u7684 man(1) \u7248\u672c\u4e3a\u6700\u65b0\u7684\uff1a</p> <pre><code>2.7.6.1                           2016-12-12                            MAN(1)\n</code></pre> <p>macOS \u4e0b\u7684 man(1) \u7248\u672c\u4e3a\u6bd4\u8f83\u9648\u65e7\u7684\uff1a</p> <pre><code>                                  September 19, 2005                            man(1)\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#start_section","title":"start section","text":"<p>\u5982\u4f55\u5728 man \u6253\u5f00\u65f6\uff0c\u76f4\u63a5\u5b9a\u4f4d\u5230\u6307\u5b9a\u7ae0\u8282\u5462\uff1f</p> <p>How to get specific section inside a MAN page? How to jump to a specific heading in a man page? </p> <p><code>man</code> \u7684 <code>-P</code> \u9009\u9879\u53ef\u4ee5\u5728\u6253\u5f00\u65f6\uff0c\u66ff\u4ee3\u9ed8\u8ba4\u7684 PAGER\u3002</p> <p><code>\u2212P</code> pager: Specify which pager to use. This option overrides the MANPAGER environment variable, which in turn overrides the PAGER variable. By default, man uses <code>/usr/bin/less -is</code>.</p> <p>\u5c01\u88c5\u4e00\u4e2ashell\u51fd\u6570 man2\uff0c\u5728\u539f\u6709 man \u547d\u4ee4\u6700\u540e\u8ffd\u52a0\u4e00\u4e2a <code>--CS</code> \u9009\u9879\uff0c\u6307\u5b9a\u53c2\u6570\u503c\u4e3a Conventional Section Name\uff0c\u8fd9\u6837\u6253\u5f00 manpage \u65f6\u5c06\u8df3\u8f6c\u5230\u5bf9\u5e94\u7ae0\u8282\u6807\u9898\u5904\u3002</p> <pre><code>#!/usr/bin/env bash\n\nman2() {\n    # set -x\n    if [ $# -ge 3 ]; then\n        local lastOptArgIndex=$#\n        local lastOptKeyIndex=$((lastOptArgIndex - 1))\n        local optKey=${!lastOptKeyIndex}\n        local optArg=${!lastOptArgIndex}\n        if [ $optKey = '--CS' ] &amp;&amp; [ -n \"$optArg\" ]; then\n            # for GNU: man --pager=\n            man -P \"less -p ^\\\\${optArg}\" \"${@:1:$((lastOptArgIndex - 2))}\"\n        elif [ $optArg = '--CS' ]; then\n            echo \"PLS assign Conventional Section!\"\n        else\n            man \"$@\"\n        fi\n    else\n        man \"$@\"\n    fi\n    # set +x\n}\n\nman2 \"$@\"\n</code></pre> <p>\u5c06\u4ee5\u4e0ash\u811a\u672c\u4fdd\u5b58\uff0c\u5e76\u5728 <code>~/.zshrc</code> \u4e2d\u521b\u5efa\u66ff\u8eab\u547d\u4ee4\uff1a</p> <pre><code>$ chmod +x /usr/local/etc/man2.sh\n$ echo \"alias man2=/usr/local/etc/man2.sh\" &gt;&gt; ~/.zshrc\n</code></pre> <p>\u7136\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528 man2 \u4ee3\u66ff man\uff0c\u901a\u8fc7 <code>--CS</code> \u6307\u5b9a\u6253\u5f00\u6307\u5b9a\u7ae0\u8282\u3002</p> <p>\u4f8b\u5982\uff1a</p> <ul> <li>man2 1 bash --CS ENVIRONMENT</li> <li>man2 bash --CS \"SHELL GRAMMAR\"</li> <li>man2 bash --CS QUOTING</li> <li>man2 bash --CS PARAMETERS</li> <li>man2 bash --CS EXPANSION</li> <li>man2 bash --CS REDIRECTION</li> </ul>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#manvim","title":"man.vim","text":"<p>vim-man\uff1aView man pages in vim</p>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#on_viewing_man_pages","title":"On Viewing <code>man</code> Pages","text":"<p>Open man Page in Preview and Save as PDF View Terminal \u2018man\u2019 Pages In Preview / PDF Use Preview to view formatted man pages  Can man pages be converted to html and/or pdf format? </p>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#x-man","title":"X-man","text":"<pre><code>faner@MBP-FAN:~|\u21d2  open x-man-page://sed\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#man_-t","title":"man -t","text":"<pre><code># man man\n       -t     Use  /usr/bin/groff  -Tps  -mandoc -c to format the manual page, passing\n              the output to stdout.  The default output format of /usr/bin/groff  -Tps\n              -mandoc  -c  is  Postscript,  refer to the manual page of /usr/bin/groff\n              -Tps -mandoc -c for ways to pick an alternate format.\n</code></pre> <p><code>man -t</code> \u9009\u9879\u5229\u7528 groff \u5de5\u5177\u5c06 man page \u8f6c\u6362\u4e3a PostScript \u683c\u5f0f\u3002</p>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#preview","title":"Preview","text":"<p><code>man -t</code> \u7ed3\u679c\u91cd\u5b9a\u5411\u5230 open \u4f7f\u7528 Preview.app \u6253\u5f00\u3002</p> <pre><code>faner@MBP-FAN:~|\u21d2  man -t sed | open -fa \"Preview\"\nfaner@MBP-FAN:~|\u21d2  man -t sed | open -f -a /Applications/Preview.app\n</code></pre> <p>open \u7684 <code>-fa</code> \u9009\u9879\u8868\u793a piping output to open(<code>-f</code>) and specifies the application(<code>-a</code>)\uff0c\u53ef\u53c2\u8003 man open\u3002</p> <p>\u6700\u65b0\u7684 macOS <code>man -t</code> \u5df2\u7ecf\u6539\u7528 troff\uff0c\u673a\u5236\u548c\u547d\u4ee4\u4e0d\u540c\u4e8e\u4e4b\u524d\u7684 groff\uff0c\u65e0\u6cd5\u518d\u76f4\u63a5\u4f7f\u7528\u4e86\uff0c\u5efa\u8bae\u6539\u7528 omz \u81ea\u5e26\u7684 macos \u63d2\u4ef6\u4e2d\u7684 <code>man-preview</code> \u63d2\u4ef6\u547d\u4ee4\u3002</p> <p>\u5728 ~/.zshrc \u4e2d\u542f\u7528 <code>macos</code> \u63d2\u4ef6\uff0c\u652f\u6301 <code>man-preview</code> \u547d\u4ee4\u8c03\u7528\u9884\u89c8\u6253\u5f00 man page\uff08Open a specified man page in Preview app\uff09\u3002\u4f8b\u5982 <code>man-preivew sed</code>\u3002</p> <p>\u5176\u539f\u7406\u662f\u5148\u7528 <code>man -w $cmd</code> \u627e\u5230 cmd \u7684 manpage \u6587\u4ef6\u8def\u5f84\uff0c\u7136\u540e\u7528 <code>mandoc -T</code> \u4ee5 pdf \u5f62\u5f0f\u8f93\u51fa\uff0c\u7136\u540e\u91cd\u5b9a\u5411\u5230 <code>open -fa Preview</code> \u6253\u5f00\u3002</p> <pre><code>function man-preview() {\n  [[ $# -eq 0 ]] &amp;&amp; &gt;&amp;2 echo \"Usage: $0 command1 [command2 ...]\" &amp;&amp; return 1\n\n  local page\n  for page in \"${(@f)\"$(man -w $@)\"}\"; do\n    command mandoc -Tpdf $page | open -f -a Preview\n  done\n}\ncompdef _man man-preview\n</code></pre> <p>\u76f8\u5f53\u4e8e\u4f9d\u6b21\u6267\u884c\u4ee5\u4e0b\u811a\u672c\uff1a</p> <pre><code>$ manpage=$(man -w clang)\n$ mandoc -T pdf $manpage | open -f -a Preview\n</code></pre> <p>\u7528 Preview \u5e94\u7528\u6253\u5f00\u540e\uff0c\u53ef\u4ee5 Export \u5bfc\u51fa\u4fdd\u5b58\u4e3a\u672c\u5730 PDF \u6587\u4ef6\u3002</p> <p>\u4e5f\u53ef\u6267\u884c mandoc \u65f6\u76f4\u63a5\u91cd\u5b9a\u5411\u8f93\u51fa\u5230 pdf \u6587\u4ef6\uff1a</p> <pre><code>$ mandoc -T pdf $manpage &gt; man_clang.pdf\n</code></pre> <p>\u4e00\u884c\u4fbf\u6377\u811a\u672c\uff1a</p> <ul> <li><code>mandoc -T pdf $(man -w clang) | open -fa Preview</code></li> <li><code>mandoc -T pdf $(man -w clang) &gt; man_clang.pdf</code></li> </ul> <p>\u4e5f\u53ef\u81ea\u884c\u5c01\u88c5\u5c0f\u51fd\u6570\uff0c\u7136\u540e\u8c03\u7528 <code>pman $cmd</code> \u7528\u9884\u89c8\u5e94\u7528\u6253\u5f00 cmd \u547d\u4ee4\u7684 manual page\uff1a</p> <pre><code>pman() { manpage=$(man -w $@); mandoc -T pdf $manpage | open -fa Preview; }\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#pstopdf","title":"pstopdf","text":"<p>pstopdf -- convert PostScript input into a PDF document.</p> <pre><code># \u8c03\u7528 pstopdf \u5c06 man -t \u7684 PostScript \u8f6c\u6362\u4e3a PDF \nfaner@MBP-FAN:~|\u21d2  man -t sed | pstopdf -i -o man_sed.pdf\n</code></pre>","tags":["linux","man"]},{"location":"blog/20191022/linux-man/#bwana","title":"Bwana","text":"<p>A man page reader for your browser</p> <p>The following are the three main commands you need to know to work with Bwana:</p> <ul> <li><code>man:command</code> -- used as URL in the browser to call man page.  </li> <li><code>man:</code> -- bring up index  </li> <li><code>man:index_refresh</code> -- reload index from source pages  </li> </ul>","tags":["linux","man"]},{"location":"blog/20191023/linux-perf-tools/","title":"Linux\u6027\u80fd\u8bca\u65ad\u5de5\u5177","text":"<p>Linux Performance Observability, Benchmark, Tuning Tools</p>","tags":["linux","perf"]},{"location":"blog/20191023/linux-perf-tools/#linux-observability-tools","title":"linux-observability-tools","text":"","tags":["linux","perf"]},{"location":"blog/20191023/linux-perf-tools/#linux-benchmarking-tools","title":"linux-benchmarking-tools","text":"","tags":["linux","perf"]},{"location":"blog/20191023/linux-perf-tools/#linux-tuning-tools","title":"linux-tuning-tools","text":"","tags":["linux","perf"]},{"location":"blog/20191023/linux-perf-tools/#linux_file_hier","title":"linux file hier","text":"<p>\u6267\u884c\u547d\u4ee4 <code>man hier</code> \u6253\u5370Linux\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u3002</p> <p>\u4ee5\u4e0b\u4e3a macOS \u4e0b\u67e5\u770b hier - layout of filesystems :</p> <pre><code>HIER(7)              BSD Miscellaneous Information Manual              HIER(7)\n\nNAME\n     hier -- layout of filesystems\n\nDESCRIPTION\n     A historical sketch of the filesystem hierarchy.  The modern OS X filesystem is documented in the ``File System Programming Guide'' available on\n     Apple Developer.\n\n     /             root directory of the filesystem\n</code></pre> <p>\u4ee5\u4e0b\u4e3a raspberry-pi \u4e0a\u67e5\u770b Raspberry/Debian \u7684 hier - filesystem hierarchy :</p> <pre><code>HIER(7)                                                                Linux Programmer's Manual                                                               HIER(7)\n\nNAME\n       hier - description of the filesystem hierarchy\n\nDESCRIPTION\n       A typical Linux system has, among others, the following directories:\n\n       /      This is the root directory.  This is where the whole tree starts.\n</code></pre>","tags":["linux","perf"]},{"location":"blog/20191022/linux-shell/","title":"Linux Shell \u7b80\u4ecb","text":"<p>Linux Shell \u521d\u6b65\u8ba4\u77e5\u3002</p> <p>\u7ec8\u7aef\u6267\u884c <code>cat /etc/shells</code> \u67e5\u770b\u652f\u6301\u7684 shell\uff1a</p> <pre><code># macOS\nfaner@FAN-MB0:~|\u21d2  cat /etc/shells\n# List of acceptable shells for chpass(1).\n# Ftpd will not allow users to connect who are not using\n# one of these shells.\n\n/bin/bash\n/bin/csh\n/bin/ksh\n/bin/sh\n/bin/tcsh\n/bin/zsh\n\n# raspbian\npi@raspberrypi:~$ cat /etc/shells\ncat /etc/shells\n# /etc/shells: valid login shells\n/bin/sh\n/bin/dash\n/bin/bash\n/bin/rbash\n/usr/bin/screen\n</code></pre> <p>\u7ec8\u7aef\u6267\u884c <code>env | grep 'SHELL'</code> \u6216 <code>echo $SHELL</code> \u53ef\u67e5\u770b\u5f53\u524d\u8d26\u6237\u6b63\u5728\u4f7f\u7528\u7684 shell\uff1a</p> <pre><code>pi@raspberrypi:~$ env | grep 'SHELL'\nSHELL=/bin/bash\n\nfaner@FAN-MB0:~|\u21d2  echo $SHELL\n/bin/bash\n</code></pre>","tags":["shell"]},{"location":"blog/20191022/linux-shell/#bash","title":"bash","text":"<p>macOS\uff08BSD\uff09\u3001raspbian\uff08Debian\uff09 \u7cfb\u7edf\u9ed8\u8ba4 Shell \u5747\u4e3a <code>/bin/bash</code>\u3002</p> <p>Bash Keyboard Shortcuts @ss64 20 Terminal shortcuts developers need to know Using the Terminal keybindings with bash on macOS Shortcuts to move faster in Bash command line The Best Keyboard Shortcuts for Bash (aka the Linux and macOS Terminal) List of default Mac OS X command-line editing bash keyboard shortcuts </p> <p>\u8f93\u5165 <code>bash --version</code> \u67e5\u770b bash \u7248\u672c\u4fe1\u606f\uff1a</p> <pre><code># macOS\nfaner@FAN-MB0:~|\u21d2  bash --version\nbash --version\nGNU bash, version 3.2.57(1)-release (x86_64-apple-darwin16)\nCopyright (C) 2007 Free Software Foundation, Inc.\n\n# raspbian\npi@raspberrypi:~$ bash --version\nbash --version\nGNU bash, version 4.4.12(1)-release (arm-unknown-linux-gnueabihf)\nCopyright (C) 2016 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\n\nThis is free software; you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n</code></pre> <p>\u8f93\u5165\u6267\u884c <code>man bash</code> \u6216 <code>man 1 bash</code> \u53ef\u4ee5\u67e5\u770b bash \u7684\u8bf4\u660e\u6587\u6863\u2014\u2014GNU Bash manual | Bash Reference Manual\u3002</p>","tags":["shell"]},{"location":"blog/20191022/linux-shell/#prompting","title":"PROMPTING","text":"<p>When executing interactively, bash displays the primary prompt PS1 when it is ready to read a command,  </p> <p>PS1 stands for \"Prompt String One\" or \"Prompt Statement One\", the first prompt string (that you see at a command line). The default value is <code>'\\s-\\v\\$'</code>, such as <code>bash-3.2$</code>.  </p> <p>and the secondary prompt PS2 when it needs more input to complete a command.  </p> <p>PS2 The secondary prompt string. ie for continued commands (those taking more than one line). The default value is <code>'&gt;'</code>.  </p> <p>Bash displays PS0 after it reads a command but before executing it.  </p> <p>Why is bash's prompt variable called PS1? Bash Shell: Take Control of PS1, PS2, PS3, PS4 and PROMPT_COMMAND Echo expanded PS1 Bash prompt basics Linux\u7528\u6237\u547d\u4ee4\u884c\u5b57\u7b26\u73af\u5883\u53d8\u91cf shell PS1 PS2 PS3 PS4\u754c\u9762\u63d0\u793a\u7b26 Linux\u4e0bPS1\u3001PS2\u3001PS3\u3001PS4\u4f7f\u7528\u8be6\u89e3 </p>","tags":["shell"]},{"location":"blog/20191022/linux-shell/#ps2","title":"PS2","text":"<p>\u5f53\u8f93\u5165\u547d\u4ee4\u672a\u7ed3\u675f\u5373\u6362\u884c\u65f6\uff08continued commands more than one line\uff09\uff0c\u5c06\u6362\u884c\u4ee5 PS2\uff08<code>&gt;</code>\uff09\u63d0\u793a\u7eed\u884c\u8f93\u5165\uff1a</p> <p>\u4f8b\u5982 <code>telnet</code>\uff0c\u5c06\u4f1a\u901a\u8fc7\u6b21\u63d0\u793a\u7b26\u63d0\u793a\u8f93\u5165\u66f4\u591a\u53c2\u6570\uff1a</p> <pre><code>faner@MBP-FAN % telnet\ntelnet&gt;\n\n# \u8f93\u5165 quit \u9000\u51fa\n</code></pre> <p>\u4f8b\u5982 <code>echo</code> \u8f93\u5165\u4e00\u4e2a\u5f15\u53f7\uff0c\u5c06\u4f1a\u901a\u8fc7\u6b21\u63d0\u793a\u7b26\u63d0\u793a\u8f93\u5165\u6570\u636e\uff0c\u76f4\u5230\u9047\u5230\u53e6\u4e00\u4e2a\u5f15\u53f7\u7ed3\u675f\uff1a</p> <pre><code>{18-09-16 16:46}[]MBP-FAN:~ faner% echo 'hello\nquote&gt; world\nquote&gt; '\nhello\nworld\n\n{18-09-16 17:14}[]MBP-FAN:~ faner%\n</code></pre>","tags":["shell"]},{"location":"blog/20191022/linux-shell/#command_type","title":"command type","text":"<p>bash \u5185\u7f6e\u7684 type \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u67d0\u4e2a\u547d\u4ee4\u662f\u5426\u4e3a bash \u7684\u5185\u7f6e\u547d\u4ee4\u3002</p> <p>\u4f8b\u5982 cd\u3001ECHO(1) \u547d\u4ee4\u4e3a bash \u5185\u7f6e\uff1a</p> <pre><code>pi@raspberrypi:~$ type -t cd\nbuiltin\n\npi@raspberrypi:~$ type -a cd\ncd is a shell builtin\n\n# macOS \u4e0b\u5bf9\u5e94 -w \u9009\u9879\npi@raspberrypi:~$ type -t echo\nbuiltin\n\npi@raspberrypi:~$ type -a echo\necho is a shell builtin\necho is /bin/echo\n</code></pre> <p>type\uff08\u548c cd\uff09\u547d\u4ee4\u7684\u8bf4\u660e\u5185\u542b\u5728 bash \u7684 man page \u4e2d\uff08<code>type [-aftpP] name [name ...]</code>\uff09\uff0c\u6ca1\u6709\u5bf9\u5e94\u7684 manual page entry\uff0c\u4e14\u4e0d\u652f\u6301 <code>-h(--help)</code> \u9009\u9879\u67e5\u770b\u5e2e\u52a9\u3002</p> <pre><code># \u4ee5\u4e0b\u4e3a raspbian \u4e0b\u7684\u6d4b\u8bd5\n\npi@raspberrypi:~$ man type\nNo manual entry for type\n\npi@raspberrypi:~$ man cd\nNo manual entry for cd\n\n# \u4ee5\u4e0b\u4e3a macOS \u4e0b\u7684\u6d4b\u8bd5\n\nfaner@MBP-FAN:~|\u21d2  type -h\ntype: bad option: -h\nfaner@MBP-FAN:~|\u21d2  type --help\ntype: bad option: -h\n\nfaner@MBP-FAN:~|\u21d2  cd -h\ncd: no such file or directory: -h\nfaner@MBP-FAN:~|\u21d2  cd --help\ncd: no such file or directory: --help\n</code></pre> <p>\u5229\u7528 tab \u952e\u7684\u81ea\u52a8\u8865\u9f50\u529f\u80fd\uff0c\u5728 macOS \u7ec8\u7aef\u8f93\u5165 <code>type -</code> \u518d\u6309\u4e0b tab \u952e\uff0c\u5373\u53ef\u5217\u4e3e\u51fa\u6240\u6709\u53ef\u80fd\u7684\u5907\u9009\u8f93\u5165\u9879\u53ca\u5176\u6982\u8981\u8bf4\u660e\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  type -\n-S  -- show steps in the resolution of symlinks\n-a  -- print all occurrences in path\n-f  -- output contents of functions\n-m  -- treat the arguments as patterns\n-p  -- always do a path search\n-s  -- print symlink free path as well\n-w  -- print command type\n-\n</code></pre> <p>ECHO(1) \u547d\u4ee4\u6709 manual page\uff0c\u53ef\u6267\u884c <code>man echo</code> \u6216  <code>man 1 echo</code> \u67e5\u770b\u3002</p> <p>SU(1)\u3001SUDO(8)\u3001NANO(1)\u3001VIM(1)\u3001SSH(1)\u3001rsync(1)\u3001SFTP(1)\u3001IFCONFIG(8) \u4e3a\u5916\u90e8\u547d\u4ee4\uff1a</p> <pre><code>pi@raspberrypi:~$ type -t sudo\nfile\npi@raspberrypi:~$ type -p sudo\n/usr/bin/sudo\npi@raspberrypi:~$ type -a sudo\nsudo is /usr/bin/sudo\n\npi@raspberrypi:~$ type -t vim\nfile\npi@raspberrypi:~$ type -p vim\n/usr/bin/vim\npi@raspberrypi:~$ type -a vim\nvim is /usr/bin/vim\n\npi@raspberrypi:~$ type -t ifconfig\nfile\npi@raspberrypi:~$ type -p ifconfig\n/sbin/ifconfig\npi@raspberrypi:~$ type -a ifconfig\nifconfig is /sbin/ifconfig\n</code></pre>","tags":["shell"]},{"location":"blog/20191022/linux-shell/#special_keys","title":"Special keys","text":"<ul> <li><code>C-i</code> = Tab  </li> <li><code>C-g</code> = Abort\uff0c\u653e\u5f03\u5f53\u524d\u884c\uff0c\u65b0\u8d77\u4e00\u884c  </li> <li><code>C-j</code> = Newline\uff0c\u8fd0\u884c\u5f53\u524d\u884c\uff0c\u65b0\u8d77\u4e00\u884c  </li> <li><code>C-[</code> = Escape  </li> <li><code>C-m</code> = Enter  </li> <li><code>C-_</code> / <code>&lt;C-x&gt;u</code> = Undo  </li> </ul>","tags":["shell"]},{"location":"blog/20191022/linux-shell/#zsh","title":"zsh","text":"<p>\u7ec8\u7aef\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u53ef\u901a\u8fc7 curl \u4ece github \u4e0b\u8f7d\u5b89\u88c5\u6d41\u884c\u7684 Zsh\uff08\u517c\u5bb9 bash\uff09 \u914d\u7f6e oh-my-zsh\uff1a</p> <pre><code>sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"\n</code></pre> <p>\u8f93\u5165 <code>zsh --version</code> \u67e5\u770b zsh \u7248\u672c\u4fe1\u606f\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  zsh --version\nzsh --version\nzsh 5.2 (x86_64-apple-darwin16.0)\n</code></pre> <p>\u6267\u884c <code>chsh -s /bin/zsh</code> \u547d\u4ee4\uff08\u91cd\u542f\u751f\u6548\uff09\u53ef\u5207\u6362\u4e3a\u66f4\u6ce8\u91cd\u7528\u6237\u4f53\u9a8c\u548c\u4ea4\u4e92\u7684 zsh\u3002</p> <p>\u4f7f\u7528 Zsh \u7684\u4e5d\u4e2a\u7406\u7531 Linux\u7ec8\u6781shell-Z Shell \u4e3a\u4ec0\u4e48\u8bf4 zsh \u662f shell \u4e2d\u7684\u6781\u54c1\uff1f Mac\u4e0b\u91c7\u7528zsh\u4ee3\u66ffbash oh my zsh \u76f8\u6bd4 bash \u7684\u4f18\u52bf </p>","tags":["shell"]},{"location":"blog/20191022/linux-shell/#zsh_\u4e0b\u5207\u56de_bash","title":"zsh \u4e0b\u5207\u56de bash","text":"<p>\u5982\u679c\u5728 zsh \u4e0b\u6267\u884c sh \u811a\u672c\uff08\u4f8b\u5982 <code>./startup.sh</code>\uff09\u62a5\u9519\uff0c\u53ef\u4ee5\u6309\u7167\u4ee5\u4e0b\u4efb\u4f55\u4e00\u79cd\u65b9\u5f0f\u89e3\u51b3\uff1a</p> <ol> <li>\u6307\u5b9a\u5728 bash \u4e0b\u6267\u884c\u811a\u672c\uff1a<code>bash ./startup.sh</code>\u3002  </li> <li>\u8f93\u5165 bash \u8fdb\u5165 bash \u547d\u4ee4\u73af\u5883\uff0c\u7136\u540e\u518d\u6267\u884c\u547d\u4ee4\u6216\u811a\u672c\uff1a<code>bash-3.2$ ./startup.sh</code>\uff1b\u901a\u8fc7\u5feb\u6377\u952e  \u6216\u8f93\u5165 exit \u9000\u56de\u9ed8\u8ba4 Shell\uff08zsh\uff09\u3002   <li>Shell | New Command\uff08\u21e7\u2318N\uff09\u8f93\u5165 <code>/bin/bash</code>\uff0c\u65b0\u5efa bash shell \u4e34\u65f6\u7a97\u53e3\u3002  </li> <li>\u5728\u7ec8\u7aef\u6267\u884c <code>chsh -s /bin/bash</code> \u547d\u4ee4\uff08\u91cd\u542f\u751f\u6548\uff09\u5c06 Shell \u5207\u56de\u9ed8\u8ba4\u7684 bash\u3002  </li>","tags":["shell"]},{"location":"blog/20191107/man-pages/","title":"Unix/Linux\u5e2e\u52a9\u624b\u518c(Man Pages)","text":"<p>Unix/Linux Commands Man Pages Collections. Records to facilitate future enquiries/reference.</p>"},{"location":"blog/20191107/man-pages/#cmd_refs","title":"Cmd Refs","text":"<p>The UNIX and Linux Forums</p> <p>Unix Commands - Man Pages</p> <p>SS64 | Command line reference</p>"},{"location":"blog/20191107/man-pages/#linux_man","title":"Linux Man","text":"<p>Linux Commands - Man Pages</p> <p>LINUX Man Pages and LINUX Commands</p> <p>The Linux man-pages project</p> <ul> <li>man7: Linux man pages online</li> <li>Hurricane Electric: LINUX MAN PAGES ONLINE</li> </ul>"},{"location":"blog/20191107/man-pages/#debianubuntu","title":"Debian/Ubuntu","text":"<p>Debian Manpages</p> <p>Ubuntu Manpage</p>"},{"location":"blog/20191107/man-pages/#freebsd","title":"FreeBSD","text":"<p>FreeBSD Manual Pages</p> <p>FREEBSD Man Pages and FREEBSD Commands at the UNIX and Linux Forums</p>"},{"location":"blog/20191107/man-pages/#windows","title":"Windows","text":"<p>Windows commands | Microsoft Learn</p> <p>PowerShell Documentation - PowerShell</p>"},{"location":"blog/20191107/man-pages/#linux_shell","title":"Linux Shell","text":"<p>In-site ref links: Linux Man</p> <p>Open Group | Shell &amp; Utilities: Detailed Toc</p> <p>Linux Command Documentation</p> <p>The Shell Scripting Tutorial</p> <p>explainshell.com</p> <p>Bash-lib by aks</p> <p>Shell-Tips!</p>"},{"location":"blog/20191024/bash-FILES/","title":"bash\u914d\u7f6e\u6587\u4ef6","text":"<p>macOS\u3001CentOS\u3001raspbian/ubuntu \u4e0b\u7684 bash \u914d\u7f6e\u6587\u4ef6\uff08bash FILES\uff09\u4e00\u89c8\u3002</p>","tags":["bash"]},{"location":"blog/20191024/bash-FILES/#macos","title":"macOS","text":"<pre><code># man bash on macOS\n\nFILES\n       /bin/bash\n              The bash executable\n       /etc/profile\n              The systemwide initialization file, executed for login shells\n       ~/.bash_profile\n              The personal initialization file, executed for login shells\n       ~/.bashrc\n              The individual per-interactive-shell startup file\n       ~/.bash_logout\n              The  individual  login  shell  cleanup file, executed when a login shell\n              exits\n       ~/.inputrc\n              Individual readline initialization file\n</code></pre> <p>\u76f8\u6bd4 CentOS \u5c11\u4e86 <code>/etc/bash.bash_logout</code>\u3002</p>","tags":["bash"]},{"location":"blog/20191024/bash-FILES/#centos","title":"CentOS","text":"<pre><code># man bash on CentOS\n\nFILES\n       /bin/bash\n              The bash executable\n       /etc/profile\n              The systemwide initialization file, executed for login shells\n       /etc/bash.bash_logout\n              The systemwide login shell cleanup file, executed when a login shell exits\n       ~/.bash_profile\n              The personal initialization file, executed for login shells\n       ~/.bashrc\n              The individual per-interactive-shell startup file\n       ~/.bash_logout\n              The individual login shell cleanup file, executed when a login shell exits\n       ~/.inputrc\n              Individual readline initialization file\n</code></pre> <p>\u76f8\u6bd4 raspbian \u5c11\u4e86 <code>/etc/bash.bashrc</code>\u3002</p>","tags":["bash"]},{"location":"blog/20191024/bash-FILES/#raspbianubuntu","title":"raspbian/ubuntu","text":"<pre><code>#man bash on ubuntu and raspbian\n\nFILES\n       /bin/bash\n              The bash executable\n       /etc/profile\n              The systemwide initialization file, executed for login shells\n       /etc/bash.bashrc\n              The systemwide per-interactive-shell startup file\n       /etc/bash.bash.logout\n              The systemwide login shell cleanup file, executed when a login shell exits\n       ~/.bash_profile\n              The personal initialization file, executed for login shells\n       ~/.bashrc\n              The individual per-interactive-shell startup file\n       ~/.bash_logout\n              The individual login shell cleanup file, executed when a login shell exits\n       ~/.inputrc\n              Individual readline initialization file\n</code></pre> <p>\u6bd4\u8f83\u5b8c\u5907\uff0cprofile\u3001bashrc\u3001logout \u5747\u6709 systemwide \u548c individual \u4e24\u7ea7\u914d\u7f6e\u3002</p> <ul> <li><code>~/.bash_profile</code>: The personal initialization file, executed for login shells  </li> <li><code>~/.bashrc</code>: The individual per-interactive-shell startup file  </li> </ul> <p><code>~/.bash_profile</code> file (Mac OS X) or <code>~/.bashrc</code> file (Linux). </p>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/","title":"export\u5bfc\u51fa\u73af\u5883\u53d8\u91cf","text":"<p>\u81ea\u5b9a\u4e49\u73af\u5883\u53d8\u91cf\u5e76\u5bfc\u51fa\u914d\u7f6e\u5230\u4e0d\u540c\u7684\u4f5c\u7528\u5c42\u7ea7\u3002</p> <p>how to view, edit, unset and delete an environment variable in linux</p> <p>\u901a\u8fc7\u7b49\u53f7\uff08<code>=</code>\uff09\u53ef\u8d4b\u503c\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf PATH\uff0c\u589e\u52a0\u53ef\u6267\u884c\u8def\u5f84\uff1a</p> <pre><code># \u5934\u90e8\u63d2\u5165\npi@raspberrypi:~ $ PATH=/usr/local/bin:$PATH\npi@raspberrypi:~ $ PATH=/usr/local/bin:${PATH}\n\n# \u5c3e\u90e8\u8ffd\u52a0\npi@raspberrypi:~ $ PATH=$PATH:/usr/local/sbin\npi@raspberrypi:~ $ PATH=${PATH}:/usr/local/sbin\n</code></pre> <p>\u5173\u4e8e PATH \u53d8\u91cf\uff0c\u53c2\u8003 <code>PARAMETERS | Shell Variables</code>\uff1a</p> <p>PATH: The search path for commands.  </p> <p>It is a colon-separated list of directories in which the shell looks for commands (see COMMAND EXECUTION below).</p>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#\u81ea\u5b9a\u4e49\u53d8\u91cflocal_variable","title":"\u81ea\u5b9a\u4e49\u53d8\u91cf\uff08local variable\uff09","text":"<p>\u901a\u8fc7\u7b49\u53f7\uff08<code>=</code>\uff09\u53ef\u81ea\u5b9a\u4e49\u53d8\u91cf\uff0c\u4f46\u662f\u53d8\u91cf\u7684\u4f5c\u7528\u57df\u53ea\u5c40\u9650\u4e8e\u5f53\u524d shell \u8fdb\u7a0b\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  http_proxy=socks5://127.0.0.1:1080\nfaner@FAN-MB0:~|\u21d2  echo $http_proxy\nsocks5://127.0.0.1:1080\n</code></pre> <p>\u5728\u5f53\u524d shell \u8fdb\u7a0b\u6267\u884c <code>bash</code> \u547d\u4ee4 fork \u5b50\u8fdb\u7a0b\uff0c\u4ec5\u4f1a\u7ee7\u627f\u7236\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\uff0c\u4f46\u662f\u4e0d\u4f1a\u7ee7\u627f\u7236\u8fdb\u7a0b\u81ea\u5b9a\u4e49\u7684\u53d8\u91cf\uff08<code>http_proxy</code>\uff09\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  bash\nbash-3.2$ echo $http_proxy\n\nbash-3.2$ \n</code></pre>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#exportglobal_variable","title":"export\uff08global variable\uff09","text":"<p>\u4f7f\u7528 export \u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5bf9\u5f53\u524d\u7ec8\u7aef Shell \u53ca\u5176\u5b50\u8fdb\u7a0b\u6709\u6548\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  export HTTP_PROXY=socks5://127.0.0.1:1080\nfaner@FAN-MB0:~|\u21d2  echo $HTTP_PROXY \nsocks5://127.0.0.1:1080\n</code></pre> <p>\u5728\u5f53\u524d shell \u8fdb\u7a0b\u6267\u884c <code>bash</code> \u547d\u4ee4 fork \u5b50\u8fdb\u7a0b\uff0c\u5c06\u4f1a\u7ee7\u627f\u7236\u8fdb\u7a0b\u901a\u8fc7 export \u5bfc\u51fa\u7684\u73af\u5883\u53d8\u91cf\uff08<code>HTTP_PROXY</code>\uff09\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  bash\nbash-3.2$ echo $HTTP_PROXY \nsocks5://127.0.0.1:1080\nbash-3.2$ \n</code></pre> <p>\u5178\u578b\u7684\u6267\u884c <code>export PATH=somepath:$PATH</code> \u53ef\u5c06 somepath \u6dfb\u52a0\u5230\u5f53\u524d\u53ef\u6267\u884c\u8def\u5f84 PATH \u4e2d\u3002 \u4f46\u662f\u65b0\u5efa\u7ec8\u7aef\uff08New Command: <code>/bin/bash</code>\uff09\u5c06\u65e0\u6cd5\u5f15\u7528\u53d8\u91cf\u3002\u6240\u4ee5\uff0cexport \u9002\u5408\u8bbe\u7f6e\u4e00\u4e9b\u5f53\u6b21 shell \u4ea4\u4e92\u7528\u5230\u7684\u4e34\u65f6\u53d8\u91cf\u3002  </p> <p>Mac OS Yosemite and java classpaths Where is JAVA_HOME on macOS Mac\u4e0b\u914d\u7f6eJAVA_HOME </p>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#\u793a\u4f8b1\u66ff\u6362homebrew_bottles\u6e90","title":"\u793a\u4f8b1\uff1a\u66ff\u6362Homebrew Bottles\u6e90","text":"<p>\u4e34\u65f6\u66ff\u6362\uff1a</p> <pre><code>export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles\n</code></pre>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#\u793a\u4f8b2\u8bbe\u7f6e_homebrew_\u4ee3\u7406","title":"\u793a\u4f8b2\uff1a\u8bbe\u7f6e homebrew \u4ee3\u7406","text":"<p>man brew \u91cc\u6709\u63d0\u5230\u8bbe\u7f6e http proxy \u7684\u65b9\u6cd5\uff1a</p> <pre><code>USING HOMEBREW BEHIND A PROXY\n       Homebrew uses several commands for downloading files (e.g. curl, git,  svn).  Many\n       of these tools can download via a proxy. It's common for these tools to read proxy\n       parameters from environment variables.\n\n       For the majority of cases setting http_proxy is enough. You can set this  in  your\n       shell profile, or you can use it before a brew command:\n\n           http_proxy=http://&lt;host&gt;:&lt;port&gt; brew install foo\n\n       If your proxy requires authentication:\n\n           http_proxy=http://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt; brew install foo\n</code></pre> <p>\u53ef\u4ee5\u6267\u884c <code>export http_proxy</code> \u548c <code>export https_proxy</code> \u8bbe\u7f6e HTTP \u548c HTTPS \u4ee3\u7406\uff1a</p> <pre><code>export http_proxy=socks5://127.0.0.1:1080\nexport https_proxy=socks5://127.0.0.1:1080\n</code></pre> <p>\u6216</p> <pre><code>export ALL_PROXY=socks5://127.0.0.1:1080\n</code></pre> <p>\u6267\u884c <code>unset http_proxy unset https_proxy</code> \u6216 <code>unset ALL_PROXY</code> \u53ef\u53d6\u6d88\u4ee3\u7406\u3002</p>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#profileprocesssystem_variable","title":"profile\uff08process/system variable\uff09","text":"<p>\u4ee5\u4e0b\u8282\u9009\u81ea bash(1) - Linux manual page \u7684 INVOCATION \u7ae0\u8282\uff1a</p> <pre><code>When bash is invoked as an interactive login shell, or as a non-interactive shell with the --login option, it first reads and executes commands from the file /etc/profile, if that file exists. After reading that file, it looks for ~/.bash_profile, ~/.bash_login, and ~/.profile, in that order, and reads and executes commands from the first one that exists and is readable.\n\nWhen an interactive login shell exits, or a non-interactive login shell executes the exit builtin command, bash reads and executes commands from the file ~/.bash_logout, if it exists.\n\nWhen an interactive shell that is not a login shell is started, bash reads and executes commands from ~/.bashrc, if that file exists.\n\nThis may be inhibited by using the --norc option. The --rcfile file option will force bash to read and execute commands from file instead of ~/.bashrc.\n</code></pre> <ul> <li><code>.bash_history</code> \uff1a\u8bb0\u5f55\u4e86\u4ee5\u524d\u8f93\u5165\u7684\u547d\u4ee4  </li> <li><code>.bash_logout</code> \uff1a\u9000\u51fa shell \u65f6\u8981\u6267\u884c\u7684\u547d\u4ee4  </li> </ul> <p>\u4ea6\u53ef\u53c2\u8003\u300a\u9e1f\u54e5\u7684linux\u79c1\u623f\u83dc\u300b&lt;11.2 shell \u7684\u53d8\u91cf\u529f\u80fd&gt; \u548c &lt;11.4 Bash Shell \u7684\u64cd\u4f5c\u73af\u5883&gt; \u3002</p>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#\u5168\u5c40\u73af\u5883\u53d8\u91cf","title":"\u5168\u5c40\u73af\u5883\u53d8\u91cf","text":"<p>\u9996\u5148\u662f\u8bbe\u7f6e\u5168\u5c40\u73af\u5883\u53d8\u91cf\uff0c\u5bf9\u6240\u6709\u7528\u6237\u90fd\u4f1a\u751f\u6548\uff1a</p> <ul> <li> <p><code>etc/profile</code>: \u6b64\u6587\u4ef6\u4e3a\u7cfb\u7edf\u7ea7\u914d\u7f6e\u4fe1\u606f\uff08Systemwide configuration file\uff09\u3002\u5f53\u7528\u6237\u767b\u5f55\u65f6\uff0c\u8be5\u6587\u4ef6\u88ab\u6267\u884c\u4e00\u6b21\uff0c\u5e76\u4ece <code>/etc/profile.d</code> \u76ee\u5f55\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u641c\u96c6shell \u7684\u8bbe\u7f6e\u3002\u4e00\u822c\u7528\u4e8e\u8bbe\u7f6e\u6240\u6709\u7528\u6237\u4f7f\u7528\u7684\u5168\u5c40\u53d8\u91cf\u3002</p> </li> <li> <p><code>/etc/bashrc</code>: \u5f53 bash shell \u88ab\u6253\u5f00\u65f6\uff0c\u8be5\u6587\u4ef6\u88ab\u8bfb\u53d6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6bcf\u6b21\u65b0\u6253\u5f00\u4e00\u4e2a\u7ec8\u7aef shell\uff0c\u8be5\u6587\u4ef6\u5c31\u4f1a\u88ab\u8bfb\u53d6\u3002</p> </li> </ul> <p>UNIX\u7cfb\u7edf\u7ea7\u522b\u73af\u5883\u6587\u4ef6profile </p>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#\u7528\u6237\u73af\u5883\u53d8\u91cf","title":"\u7528\u6237\u73af\u5883\u53d8\u91cf","text":"<p>bash \u5728\u8bfb\u5b8c\u4e86\u7cfb\u7edf\u6574\u4f53\u73af\u5883\u914d\u7f6e\u7684 <code>/etc/profile</code> \u5e76\u501f\u6b64\u8c03\u7528\u5176\u4ed6\u914d\u7f6e\u6587\u4ef6\u540e\uff0c\u63a5\u4e0b\u6765\u5219\u4f1a\u8bfb\u53d6\u7528\u6237\u7684\u4e2a\u4eba\u914d\u7f6e\u6587\u4ef6\uff08per-user configuration file\uff09\u3002</p> <p>\u5728 login shell \u7684 bash \u73af\u5883\u4e2d\uff0c\u4f9d\u6b21\u4f1a\u8bfb\u53d6\u4ee5\u4e0b\u4e09\u4e2a\u4e2a\u4eba\u504f\u597d\u914d\u7f6e\u6587\u4ef6\uff1a</p> <ul> <li><code>~/.bash_profile</code> </li> <li><code>~/.bash_login</code> </li> <li><code>~/.profile</code> </li> </ul> <p>\u4ee5\u4e0a3\u4e2a\u6587\u4ef6\u53ea\u5bf9\u5355\u4e2a\u7528\u6237\u751f\u6548\uff0c\u5f53\u7528\u6237\u767b\u5f55\u65f6\u8be5\u6587\u4ef6\u4ec5\u6267\u884c\u4e00\u6b21\u3002  </p> <p>\u5982\u679c <code>~/.bash_profile</code> \u5b58\u5728\uff0c\u5219\u4e0d\u4f1a\u518d\u8bfb\u53d6\u5176\u4ed6\u4e24\u4e2a\u6587\u4ef6\uff1b \u5982\u679c<code>~/.bash_profile</code> \u4e0d\u5b58\u5728\uff0c\u624d\u4f1a\u53bb\u8bfb\u53d6 <code>~/.bash_login</code>\u3002</p> <p>\u53ea\u5bf9\u5355\u4e2a\u7528\u6237\u751f\u6548\uff0c\u5f53\u5728 bash \u4e2d\u518d\u6267\u884c bash \u6253\u5f00\u65b0\u7684 shell \u65f6\uff0c\u90fd\u4f1a\u8bfb\u53d6 <code>~/.bashrc</code> \u6587\u4ef6\uff1a</p> <ul> <li><code>~/.bashrc</code> </li> </ul> <p>\u5f53\u53d6\u5f97 non-login shell \u65f6\uff0c\u8be5 bash \u7684\u914d\u7f6e\u6587\u4ef6\u4ec5\u4f1a\u8bfb\u53d6 <code>~/.bashrc</code>\u3002  </p> <p><code>~/.bashrc</code> </p>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","title":"\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","text":"<p>\u53ef\u4fee\u6539 system-wide \u7ea7\u522b\u7684\u914d\u7f6e<code>/etc/profile</code>\uff0c\u4f46 <code>/etc/profile</code> \u4f1a\u88ab <code>~/.bash_profile</code> \u4fee\u6539\u8986\u76d6\uff0c <code>~/.bash_profile</code> \u4f1a\u88ab <code>~/.bashrc</code> \u4fee\u6539\u8986\u76d6\u3002</p> <p>\u82e5\u60f3\u5b9a\u4e49\u6240\u6709\u65b0\u5efa bash shell \u8fdb\u7a0b\u4e2d\u90fd\u53ef\u89c1\u7684\u8de8\u8fdb\u7a0b\u7cfb\u7edf\u7ea7\u53d8\u91cf\uff0c\u5219\u53ef\u5c06 export \u8bed\u53e5\u6dfb\u52a0\u5230 bash shell \u7684\u73af\u5883\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5728\u542f\u52a8 shell \u8fdb\u7a0b\u65f6\u4f1a\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u4ee5\u89c4\u5212\u597d bash \u7684\u64cd\u4f5c\u73af\u5883\u3002</p> <pre><code>echo 'export PATH=somepath:$PATH' &gt;&gt; ~/.bash_profile\n</code></pre> <p>\u4ee5\u4e0b\u4e3a brew install openssl/sqlite \u7684 Caveats\uff1a</p> <pre><code>If you need to have this software first in your PATH run:\n  echo 'export PATH=\"/usr/local/opt/openssl/bin:$PATH\"' &gt;&gt; ~/.zshrc\n\nIf you need to have this software first in your PATH run:\n   echo 'export PATH=\"/usr/local/opt/sqlite/bin:$PATH\"' &gt;&gt; ~/.zshrc\n</code></pre> <p>\u4ee5\u4e0b\u8282\u9009\u81ea\u672c\u4eba macOS \u7684 zsh \u914d\u7f6e\u6587\u4ef6 <code>~/.zshrc</code>\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  cat .zshrc\n# Path to your oh-my-zsh installation.\nexport ZSH=/Users/faner/.oh-my-zsh\n\n\n\n# User configuration\n\nexport PATH=\"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin\"\n# export MANPATH=\"/usr/local/man:$MANPATH\"\n</code></pre>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#export_homebrew_bottle_domain_to_profile","title":"export HOMEBREW_BOTTLE_DOMAIN to profile","text":"<p>\u5982\u679c\u662f bash shell\uff0c\u53ef\u5c06 <code>export HOMEBREW_BOTTLE_DOMAIN</code> \u52a0\u5230 <code>~/.bash_profile</code> \u6216 <code>~/.bashrc</code>\uff1a</p> <pre><code>echo 'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles' &gt;&gt; ~/.bash_profile\nsource ~/.bash_profile\n</code></pre> <p>\u5982\u679c\u662f zsh shell\uff0c\u53ef\u5c06 <code>export HOMEBREW_BOTTLE_DOMAIN</code> \u52a0\u5230 <code>~/.zshrc</code>\uff1a</p> <pre><code>echo 'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles' &gt;&gt; ~/.zshrc\nsource ~/.zshrc\n</code></pre>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#export_all_proxy_to_profile","title":"export ALL_PROXY to profile","text":"<p>\u7528\u5982\u4e0b\u8bed\u53e5\u6765\u5c06\u547d\u4ee4\u76f4\u63a5\u5bfc\u5165\u5230\u914d\u7f6e\u6587\u4ef6\u91cc\uff1a</p> <pre><code># for bash\necho export ALL_PROXY=socks5://127.0.0.1:1080 &gt;&gt; ~/.bash_profile\n\n# for zsh\necho export ALL_PROXY=socks5://127.0.0.1:1080 &gt;&gt; ~/.zshrc\n</code></pre>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#system-wide","title":"system-wide","text":"<p><code>~/</code> \u4e0b\u7684\u914d\u7f6e\u6587\u4ef6 <code>.bash_profile</code> \u53ea\u5bf9\u5f53\u524d\u767b\u5f55\u7528\u6237\u751f\u6548\u3002 \u82e5\u8981\u8bbe\u7f6e\u9762\u5411\u6240\u6709\u767b\u5f55\u7528\u6237\u90fd\u751f\u6548\u7684\u73af\u5883\u53d8\u91cf\uff0c\u53ef\u5c06 export \u5bfc\u51fa\u8bed\u53e5\u6dfb\u52a0\u5230 <code>/etc/profile</code> \u914d\u7f6e\u6587\u4ef6\u4e2d\u3002  </p> <p>\u4ee5\u4e0b\u4e3a raspbian \u7684 <code>/etc/profile</code> \u4e2d\u5bfc\u51fa\u7684\u7cfb\u7edf\u7ea7 PATH \u53d8\u91cf\uff1a</p> <pre><code>pi@raspberrypi:~ $ cat /etc/profile\n# /etc/profile: system-wide .profile file for the Bourne shell (sh(1))\n# and Bourne compatible shells (bash(1), ksh(1), ash(1), ...).\n\nif [ \"`id -u`\" -eq 0 ]; then\n  PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\nelse\n  PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games\"\nfi\nexport PATH\n</code></pre>","tags":["bash"]},{"location":"blog/20191025/export-to-profile/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>Linux\u4e0b\u67e5\u770b\u548c\u6dfb\u52a0PATH\u73af\u5883\u53d8\u91cf \u8bbe\u7f6eLinux\u73af\u5883\u53d8\u91cf\u7684\u65b9\u6cd5\u548c\u533a\u522b Linux\u7cfb\u7edf\u4fee\u6539\u73af\u5883\u53d8\u91cfPATH\u8def\u5f84 Linux\u91cc\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u65b9\u6cd5\uff08export PATH\uff09 UNIX\u4e0b\u7684\u73af\u5883\u53d8\u91cf UNIX\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u603b\u7ed3 </p>","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/","title":"macOS\u73af\u5883\u53d8\u91cf","text":"<p>macOS\u4e0b\u7684 bash \u73af\u5883\u53d8\u91cf\u5b58\u653e\u8def\u5f84\u53ca\u8986\u76d6\u751f\u6548\u5c42\u7ea7\u3002</p> <p><code>export</code>\uff1a\u663e\u793a\u6240\u6709\u73af\u5883\u53d8\u91cf <code>set</code>\uff1a\u663e\u793a\u5168\u90e8\u73af\u5883\u53d8\u91cf <code>echo</code>\uff1a\u663e\u793a\u5355\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u4f8b\u5982 echo $PATH\uff0cecho $HOME\uff0cecho $SHELL</p> <p>\u7531\u4e8eexport\u53d8\u91cf\u7684\u7236\u5b50\u4f20\u9012\u7279\u6027\uff0c\u5982\u679c\u60f3\u4e00\u76f4\u4fdd\u6301\u4e00\u4e2aUNIX\u73af\u5883\u53d8\u91cf\uff0c\u5fc5\u987b\u5230 <code>/etc/profile</code> \u6216 <code>/etc/bashrc</code> \u6216  <code>~/.bash_profile</code>  \u6216 <code>~/.bashrc</code> \u6216 <code>~/.profile</code> \u4e2d\u914d\u7f6e\uff0c\u5728\u5176\u4ed6\u5730\u65b9\u5b9a\u4e49\u548c export \u90fd\u4e0d\u4f1a\u751f\u6548\u3002</p> <p>Mac\u7cfb\u7edf\u7684\u73af\u5883\u53d8\u91cf\u52a0\u8f7d\u987a\u5e8f\u4e3a\uff1a</p> <ol> <li><code>/etc/profile</code> </li> <li><code>/etc/paths</code> </li> <li><code>~/.bash_profile</code> </li> <li><code>~/.bash_login</code> </li> <li><code>~/.profile</code> </li> <li><code>~/.bashrc</code> </li> </ol> <p>\u8bf4\u660e\uff1a</p> <ul> <li><code>/etc/profile</code> \u548c <code>/etc/paths</code> \u662f\u7cfb\u7edf\u7ea7\u522b\u7684\uff0c\u7cfb\u7edf\u542f\u52a8\u5c31\u4f1a\u52a0\u8f7d\uff1b\u540e\u97624\u4e2a\u662f\u5f53\u524d\u7528\u6237\u7ea7\u7684\u73af\u5883\u53d8\u91cf\u3002  </li> <li>3-5\u6309\u7167\u4ece\u524d\u5f80\u540e\u7684\u987a\u5e8f\u8bfb\u53d6\uff1a  <ul> <li>\u5982\u679c <code>~/.bash_profile</code> \u6587\u4ef6\u5b58\u5728\uff0c\u5219\u540e\u97622\u4e2a\u6587\u4ef6\u5c31\u88ab\u5ffd\u7565\u4e0d\u8bfb\u4e86\uff1b  </li> <li>\u5982\u679c <code>~/.bash_profile</code> \u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u624d\u4f1a\u4f9d\u6b64\u7c7b\u63a8\u8bfb\u53d6\u540e\u9762\u7684\u6587\u4ef6\u3002  </li> </ul> </li> <li><code>~/.bashrc</code> \u6ca1\u6709\u4e0a\u8ff0\u89c4\u5219\uff0c\u5b83\u662f bash shell \u6253\u5f00\u7684\u65f6\u5019\u8f7d\u5165\u7684\u3002  </li> </ul> <p>\u5173\u4e8e\u914d\u7f6e\u6587\u4ef6\u7684\u52a0\u8f7d\u987a\u5e8f\uff1a\u8bf7\u91cd\u70b9\u9605\u8bfb <code>man bash</code> \u624b\u518c\u4e2d\u7684 INVOCATION\u3001RESTRICTED SHELL \u548c FILES \u7b49\u7ae0\u8282\u3002</p>","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/#etcprofile","title":"/etc/profile","text":"<p>\u5168\u5c40\uff08\u516c\u6709\uff09\u914d\u7f6e\uff0c\u4e0d\u7ba1\u662f\u54ea\u4e2a\u7528\u6237\uff0c\u767b\u5f55\u65f6\u90fd\u4f1a\u8bfb\u53d6\u8be5\u6587\u4ef6\u3002</p> <pre><code>$ cat /etc/profile\n# System-wide .profile for sh(1)\n\nif [ -x /usr/libexec/path_helper ]; then\n    eval `/usr/libexec/path_helper -s`\nfi\n\nif [ \"${BASH-no}\" != \"no\" ]; then\n    [ -r /etc/bashrc ] &amp;&amp; . /etc/bashrc\nfi\n</code></pre> <p>\u53ef\u6267\u884c <code>man path_helper</code> \u67e5\u770b\u76f8\u5173\u8bf4\u660e\u3002</p> <p>\u5efa\u8bae\u4e0d\u4fee\u6539\u8fd9\u4e2a\u6587\u4ef6</p>","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/#etcbashrc","title":"/etc/bashrc","text":"<p>\u5168\u5c40\uff08\u516c\u6709\uff09\u914d\u7f6e\uff0cbash shell\u6267\u884c\u65f6\uff0c\u4e0d\u7ba1\u662f\u4f55\u79cd\u65b9\u5f0f\uff0c\u90fd\u4f1a\u8bfb\u53d6\u6b64\u6587\u4ef6\u3002</p> <pre><code>$ cat /etc/bashrc\n# System-wide .bashrc file for interactive bash(1) shells.\nif [ -z \"$PS1\" ]; then\n   return\nfi\n\nPS1='\\h:\\W \\u\\$ '\n# Make bash check its window size after a process completes\nshopt -s checkwinsize\n\n[ -r \"/etc/bashrc_$TERM_PROGRAM\" ] &amp;&amp; . \"/etc/bashrc_$TERM_PROGRAM\"\n</code></pre> <p>\u6ce8\u610f\uff1a </p> <p>\u4e00\u822c\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u6dfb\u52a0\u7cfb\u7edf\u7ea7\u73af\u5883\u53d8\u91cf\u3002 \u8bf7\u4e0d\u8981\u5728 <code>~/.bashrc</code> \u4e2d\u8bbe\u7f6e PATH \uff0c\u5426\u5219\u4f1a\u5bfc\u81f4 PATH \u4e2d\u76ee\u5f55\u7684\u610f\u5916\u589e\u957f\u3002\u56e0\u4e3a\u6bcf\u6b21\u6253\u5f00\u4e00\u4e2a\u65b0\u7684 shell\u7ec8\u7aef\u7a97\u53e3\uff0c\u90fd\u4f1a\u8bfb\u53d6 <code>~/.bashrc</code>\u3002  </p>","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/#etcpaths","title":"/etc/paths","text":"<p>\u7f16\u8f91 paths\uff0c\u5c06\u73af\u5883\u53d8\u91cf\u6dfb\u52a0\u5230 paths\u6587\u4ef6\u4e2d \uff0c\u4e00\u884c\u4e00\u4e2a\u8def\u5f84\u3002</p> <pre><code>$ cat /etc/paths\n/usr/local/bin\n/usr/bin\n/bin\n/usr/sbin\n/sbin\n</code></pre> <p>\u5168\u5c40\u5efa\u8bae\u4fee\u6539\u8fd9\u4e2a\u6587\u4ef6</p>","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/#etcpathsd","title":"/etc/paths.d","text":"<p>/etc/paths vs /etc/paths.d</p> <p>\u4ee5\u4e0b\u6458\u5f55\u81ea <code>man path_helper</code>\uff1a</p> <pre><code>DESCRIPTION\n     The path_helper utility reads the contents of the files in the directories /etc/paths.d and /etc/manpaths.d\n     and appends their contents to the PATH and MANPATH environment variables respectively.  (The MANPATH envi-\n     ronment variable will not be modified unless it is already set in the environment.)\n\n     Files in these directories should contain one path element per line.\n\n     Prior to reading these directories, default PATH and MANPATH values are obtained from the files /etc/paths\n     and /etc/manpaths respectively.\n</code></pre> <p>How to use /etc/paths.d to add executable files to my path?</p> <p>The paths in <code>/etc/paths.d/</code> are added to the path by <code>/usr/libexec/path_helper</code>, which is run from <code>/etc/profile</code>, <code>/etc/zprofile</code>, and <code>/etc/csh.login</code>.</p> <p>Use /etc/paths or /etc/paths.d to add items to the PATH in macOS Sierra?</p> <p>Use <code>/etc/paths.d</code>. The primary reason is that <code>/etc/paths</code> will be modified and/or replaced by system upgrades. <code>/etc/paths.d/</code> items will not. Files are generally named with the pattern index-source. E.g., <code>99-mypaths</code>. Paths are appended in order*. It's a lot easier to simply add/remove a file than programmatically editing one idempotently without bugs.</p> <p>The default <code>/etc/profile</code>, <code>/etc/zprofile</code> and <code>/etc/csh.login</code> on macOS all load path_helper.</p> <p>How can one use /etc/paths.d to add a path with spaces in it to $PATH? </p>","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/#demo","title":"demo","text":"<p>\u4ee5\u4e0b\u4e3a macOS ZSH \u4e0b\u7684 PATH \u53d8\u91cf\uff1a</p> <pre><code># print\u4e3a\u9ed8\u8ba4\u52a8\u4f5c\uff0c\u53ef\u7701\u7565\n$ echo $PATH | awk 'BEGIN{RS=\":\"} {print}'\n# \u7701\u7565\u5728 ~/.zshrc \u4e2d\u8ffd\u52a0\u5728 PATH \u524d\u9762\u7684\u914d\u7f6e\n/usr/local/bin\n/usr/bin\n/bin\n/usr/sbin\n/sbin\n/opt/X11/bin\n/Library/Apple/usr/bin\n/Applications/Wireshark.app/Contents/MacOS\n# \u7701\u7565\u5728 ~/.zshrc \u4e2d\u8ffd\u52a0\u5728 PATH \u540e\u9762\u7684\u914d\u7f6e\n</code></pre> <p>\u524d\u97625\u4e2a\u4e3a <code>/etc/paths</code> \u4e2d\u9884\u5b9a\u4e49\u7684\u8def\u5f84\uff1b\u540e\u97623\u4e2a\u4e3a <code>/etc/paths.d</code> \u4e2d\u914d\u7f6e\u7684\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>$ ls -1 /etc/paths.d/\n100-rvictl\n40-XQuartz\nWireshark\n</code></pre> <p>\u6bcf\u4e2a\u6587\u4ef6\u91cc\u9762\u5305\u542b\u4e00\u884c\u53ef\u6267\u884c\u8def\u5f84\uff0c\u88ab <code>/etc/profile</code> \u6216 <code>/etc/zprofile</code> \u6267\u884c path_helper \u52a0\u8f7d\u5230 PATH \u73af\u5883\u53d8\u91cf\u4e2d\uff1a</p> <pre><code>$ cat /etc/paths.d/40-XQuartz\n/opt/X11/bin\n$ cat /etc/paths.d/100-rvictl\n/Library/Apple/usr/bin\n$ cat /etc/paths.d/Wireshark\n/Applications/Wireshark.app/Contents/MacOS\n</code></pre>","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/#bash_profile","title":"~/.bash_profile","text":"<p>\u5f53 bash shell \u662f\u4ee5 login \u65b9\u5f0f\u6267\u884c\u65f6\uff0c\u624d\u4f1a\u8bfb\u53d6\u6b64\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u4ec5\u4ec5\u6267\u884c\u4e00\u6b21\u3002</p> <p>\u4e00\u822c\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u6dfb\u52a0\u7528\u6237\u7ea7\u73af\u5883\u53d8\u91cf</p>","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/#refs","title":"refs","text":"","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/#linux","title":"Linux","text":"<p>Linux\u4e0b\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e Linux\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u4e09\u79cd\u65b9\u6cd5 Linux\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4e09\u79cd\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u65b9\u6cd5 \u8bbe\u7f6eLinux\u73af\u5883\u53d8\u91cf\u7684\u65b9\u6cd5\u548c\u533a\u522b_Ubuntu </p>","tags":["bash"]},{"location":"blog/20191026/macOS-Env-PATH/#macos","title":"macOS","text":"<p>Where is the default terminal $PATH located on Mac? How To Edit Your PATH Environment Variables On Mac OS X </p> <p>MY MAC OSX BASH PROFILE MAC OS X\u4e0a\u627e\u4e0d\u5230.bash_profile\uff1f Creating a .bash_profile on your mac </p> <p>macOS \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u65b9\u6cd5 macOS \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf PATH macOS \u6dfb\u52a0\u73af\u5883\u53d8\u91cf\u7684\u4e09\u79cd\u65b9\u6cd5 </p> <p>How To Add /usr/local/bin In $PATH On Mac Setting PATH environment variable in OSX permanently How do I set the global PATH environment variable on OS X? </p>","tags":["bash"]},{"location":"blog/20240318/ubuntu-config-samba/","title":"rpi4b-ubuntu\u5916\u6302\u786c\u76d8\u914d\u7f6esamba\u5171\u4eab\u670d\u52a1","text":"<p>\u672c\u6587\u68b3\u7406\u4e86\u4e3a\u6811\u8393\u6d3e RPI4B/Ubuntu \u5916\u6302\u786c\u76d8\u914d\u7f6e samba \u5c40\u57df\u7f51\u5171\u4eab\u670d\u52a1\uff0c\u5e76\u5c06\u5176\u4e2d\u4e00\u4e2a\u5206\u533a\u4f5c\u4e3a macOS TM \u5907\u4efd\u5206\u533a\uff0c\u5b9e\u73b0\u5c40\u57df\u7f51\u65e0\u7ebf\u5907\u4efd\u3002</p>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#disk_info","title":"disk info","text":"<p>2T \u7684 WD \u786c\u76d8\u4e4b\u524d\u683c\u5f0f\u5316\u4e3a macExt \u683c\u5f0f\uff0c\u5176\u4e2d 1.5T \u7684 sda2 \u4e3a macOS \u5907\u4efd\u5206\u533a\uff0c0.5T \u7684 sda3 \u4e3a\u666e\u901a\u5206\u533a\u3002</p> <p>\u53ef\u4f7f\u7528 hdparm \u547d\u4ee4\u83b7\u53d6\u6216\u8bbe\u7f6e\u786c\u76d8\u4fe1\u606f\uff08get/set SATA/IDE device parameters\uff09\uff0c\u53c2\u8003 Master the Linux 'hdparm' Command: A Comprehensive Guide\u3002</p> <p>\u4e5f\u53ef\u4f7f\u7528 udev/udevadm \u547d\u4ee4\u7ba1\u7406\u914d\u7f6e\u548c\u67e5\u770b\u8bbe\u5907\u76f8\u5173\u4fe1\u606f\uff1a</p> <ul> <li>udev - Dynamic device management</li> <li>udevadm - udev management tool</li> </ul>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#lsblk","title":"lsblk","text":"<p>lsblk - list block devices</p> <pre><code>$ lsblk\nNAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS\nloop0         7:0    0  59.7M  1 loop /snap/core20/2186\nloop1         7:1    0    59M  1 loop /snap/core20/1638\nloop2         7:2    0  69.2M  1 loop /snap/core22/1125\nloop3         7:3    0 131.9M  1 loop /snap/lxd/23893\nloop4         7:4    0 134.1M  1 loop /snap/lxd/27054\nloop5         7:5    0    34M  1 loop /snap/snapd/21185\nloop6         7:6    0  35.2M  1 loop /snap/snapd/20674\nsda           8:0    0   1.8T  0 disk\n\u251c\u2500sda1        8:1    0   200M  0 part\n\u251c\u2500sda2        8:2    0   1.4T  0 part\n\u2514\u2500sda3        8:3    0 465.6G  0 part\nmmcblk0     179:0    0  59.5G  0 disk\n\u251c\u2500mmcblk0p1 179:1    0   256M  0 part /boot/firmware\n\u2514\u2500mmcblk0p2 179:2    0  59.2G  0 part /\n</code></pre> <p>blkid</p> <p>blkid - locate/print block device attributes</p> <p>\u6267\u884c <code>sudo blkid</code> \u53ef\u4ee5\u67e5\u770b\u786c\u76d8\u5757\u8bbe\u5907 id \u4fe1\u606f\uff0c\u5305\u62ec LABEL\u3001UUID \u548c TYPE\uff08\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\uff09\u3002</p>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#fdisk","title":"fdisk","text":"<p>fdisk - manipulate disk partition table</p> <ul> <li><code>-l</code> / <code>--list</code>: List the partition tables for the specified devices and then exit.</li> </ul> <pre><code>$ sudo fdisk -l\n\n...\n\nDevice          Start        End    Sectors   Size Type\n/dev/sda1          40     409639     409600   200M EFI System\n/dev/sda2      409640 2930008111 2929598472   1.4T Apple HFS/HFS+\n/dev/sda3  2930270256 3906701271  976431016 465.6G Apple HFS/HFS+\n</code></pre>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#mount_disk","title":"mount disk","text":"<p>\u5173\u4e8e mount \u547d\u4ee4\u7528\u6cd5\uff0c\u53c2\u8003 mount - mount a filesystem\u3002</p> <p>\u521b\u5efa\u6302\u8f7d\u70b9\u76ee\u5f55\uff1a</p> <pre><code>$ sudo mkdir /media/WDHD\n\n$ ls -l /media/\ntotal 4\ndrwxr-xr-x 2 root root 4096 Apr  7 03:22 WDHD\n</code></pre> <p>\u4fee\u6539\u6302\u8f7d\u70b9\u76ee\u5f55\u7684\u6240\u6709\u4eba\u4e3a\u5f53\u524d\u7528\u6237\uff08\u7ec4\uff09\uff1a</p> <pre><code>$ sudo chown pifan:ubuntu /media/WDHD\n\n$ ls -l /media/\ntotal 4\ndrwxr-xr-x 2 pifan ubuntu 4096 Apr  7 03:22 WDHD\n</code></pre> <p>\u6302\u8f7d\u5916\u63a5\u786c\u76d8\u7684 sda3 \u5206\u533a\uff1a</p> <pre><code># sudo mount /dev/sda3 /media/WDHD\n$ sudo mount -o uid=pifan,gid=ubuntu /dev/sda3 /media/WDHD\n</code></pre> <p>uid/gid</p> <p>\u6267\u884c <code>id</code> \u547d\u4ee4\u53ef\u67e5\u770b\u5f53\u524d\u7528\u6237\u7684 uid/gid\u3002 mount \u9700\u6307\u5b9a\u548c mkdir \u521b\u5efa\u7684\u6302\u8f7d\u70b9\u76ee\u5f55\u4e00\u81f4\u7684 uid/gid\u3002 \u5982\u4e0d\u6307\u5b9a\uff0c\u9ed8\u8ba4\u52a0\u8f7d uid/gid=99\uff0c\u65e0\u5199\u6743\u9650\uff0c\u9700\u8981 chmod \u6216 chown\u3002</p> <p>\u6267\u884c df\uff08report file system space usage\uff09\u547d\u4ee4\u67e5\u770b\u6302\u8f7d\u7684\u6587\u4ef6\u8bbe\u5907\u4f7f\u7528\u60c5\u51b5\uff1a</p> <pre><code>$ df -hT\nFilesystem     Type     Size  Used Avail Use% Mounted on\ntmpfs          tmpfs    781M  5.7M  776M   1% /run\n/dev/mmcblk0p2 ext4      59G   14G   43G  25% /\ntmpfs          tmpfs    3.9G     0  3.9G   0% /dev/shm\ntmpfs          tmpfs    5.0M     0  5.0M   0% /run/lock\n/dev/mmcblk0p1 vfat     253M  138M  115M  55% /boot/firmware\ntmpfs          tmpfs    781M  4.0K  781M   1% /run/user/1000\n/dev/sda3      hfsplus  466G  201G  265G  44% /media/WDHD\n</code></pre>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#test_writability","title":"test writability","text":"<p>\u6700\u53e4\u6734\u7684\u6d4b\u9a8c\u65b9\u5f0f\u662f\u5c1d\u8bd5\u5728\u5916\u6302\u786c\u76d8\u4e0a\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u5982\u679c\u63d0\u793a\u201cRead-only file system\u201d\u8bf4\u660e\u53ea\u8bfb\uff1a</p> <pre><code>$ mkdir /media/WDHD/test\n$ mkdir: cannot create directory \u2018/media/WDHD/test\u2019: Read-only file system\n</code></pre> <p>\u53c2\u8003 Server Fault \u4e0a\u7684\u9648\u5e74\u8001\u94c1 linux - Determine if filesystem or partition is mounted RO or RW via Bash Script?\uff0c\u5176\u4e2d\u63d0\u4f9b\u4e86\u66f4\u73b0\u4ee3\u5316\u548c\u4f18\u96c5\u7684\u6d4b\u8bd5\u65b9\u5f0f\u3002</p> <pre><code>$ grep 'sda[2,3]' /proc/mounts\n/dev/sda3 /media/WDHD hfsplus ro,nosuid,nodev,relatime,umask=22,uid=1000,gid=1000,nls=utf8 0 0\n\n$ [ -w /media/WDHD ] &amp;&amp; echo \"rw\" || echo \"ro\"\nro\n</code></pre>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#install_hfsprogs","title":"install hfsprogs","text":"<p>\u53c2\u8003 mount - How to read and write HFS+ journaled external HDD in Ubuntu without access to OS X? - Ask Ubuntu \u548c How to mount a HFS partition in Ubuntu as Read/Write?\u3002</p> <p>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5 hfsprogs\uff08mkfs and fsck for HFS and HFS+ file systems\uff09\uff1a</p> <pre><code>$ sudo apt-get install hfsprogs -y\n</code></pre> <p>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u91cd\u65b0\u52a0\u8f7d\u786c\u76d8\uff1a</p> <pre><code>$ sudo mount -t hfsplus -o remount,force,rw /media/WDHD\n</code></pre> <p>\u6216\u8005\u5378\u8f7d\u540e\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u52a0\u8f7d\u786c\u76d8\uff1a</p> <pre><code>$ sudo umount /media/WDHD/\n$ sudo mount -t hfsplus -o force,rw,uid=pifan,gid=ubuntu /dev/sda3 /media/WDHD\n</code></pre> <p>\u91cd\u65b0\u6267\u884c <code>mkdir /media/WDHD/test</code> \u521b\u5efa\u6587\u4ef6\u5939\u6210\u529f\u3002</p> <p>\u5982\u679c\u4e4b\u524d\u6709\u975e\u6b63\u5e38\u64cd\u4f5c\uff0c\u5982\u66b4\u529b\u63d2\u62d4\u6216\u65ad\u7535\u91cd\u542f\uff0c\u7cfb\u7edf\u68c0\u6d4b\u5230\u4e0a\u4e00\u6b21\u78c1\u76d8\u6ca1\u6709\u6b63\u5e38\u5378\u8f7d\uff0c\u4e5f\u4f1a\u6302\u8f7d\u4e3a\u53ea\u8bfb\u3002</p> /var/log/syslog<pre><code>5934 Apr  7 04:13:48 rpi4b-ubuntu kernel: [   50.657465] hfsplus: Filesystem was not cleanly unmounted, running fsck.hfsplus is recommended.  mounting read-only.\n\n7258 Apr  7 04:22:20 rpi4b-ubuntu kernel: [  457.863826] hfsplus: filesystem was not cleanly unmounted, running fsck.hfsplus is recommended.  leaving read-only.\n7259 Apr  7 04:22:52 rpi4b-ubuntu systemd[1]: media-WDHD.mount: Deactivated successfully.\n</code></pre> <p>\u5206\u533a\u635f\u574f\u751a\u81f3\u5bfc\u81f4 \u65e0\u6cd5\u6302\u8f7d\uff0c\u6b64\u65f6\u53ef\u6267\u884c <code>sudo fsck.hfsplus /dev/sda3</code> \u547d\u4ee4\u68c0\u67e5\u78c1\u76d8\u72b6\u6001\uff0c\u5c1d\u8bd5\u4fee\u590d\u3002</p> <p>man fsck</p> macOSubuntu <p><code>fsck</code> \u2013 filesystem consistency check and interactive repair It should be noted that fsck is now essentially a wrapper that invokes other <code>fsck_XXX</code> utilities as needed.</p> <p><code>fsck</code> - check and repair a Linux filesystem In actuality, fsck is simply a front-end for the various filesystem checkers (fsck.fstype) available under Linux.</p> <p>fsck.hfsplus \u68c0\u67e5\u7684\u7ed3\u679c\u4e00\u822c\u6709\u4ee5\u4e0b\u4e09\u79cd\uff1a</p> OKrepaired successfullyrepaired unsuccessfully <p>** The volume WDHD appears to be OK.</p> <p>** The volume WDHD was repaired successfully.</p> <pre><code>** Checking extended attributes file.\n   Keys out of order\n(8, 5)\n** Rebuilding extended attributes B-tree.\n** The volume WDHD could not be repaired.\n</code></pre> <p>\u5982\u679c\u68c0\u67e5\u7ed3\u679c\u662f\u524d\u4e24\u79cd\uff0c\u53ef\u5c1d\u8bd5 remount \u6216 umount/mount \u91cd\u65b0\u6302\u8f7d\uff0c\u6b63\u5e38\u7684\u53ef\u5199\u6027\u68c0\u6d4b\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>$ grep 'sda[2,3]' /proc/mounts\n/dev/sda3 /media/WDHD hfsplus rw,relatime,umask=22,uid=1000,gid=1000,nls=utf8 0 0\n\n$ [ -w /media/WDHD ] &amp;&amp; echo \"rw\" || echo \"ro\"\nrw\n</code></pre> <p>\u5982\u679c\u662f\u7b2c\u4e09\u79cd\u4fee\u590d\u5931\u8d25\uff08repair failure\uff09\u7684\u60c5\u51b5\uff0c\u5c1d\u8bd5\u6309\u7167 Force repair of external hfsplus HD\uff0c\u62a2\u6551\u5931\u8d25\uff01</p> <p>\u8bf7\u5c3d\u5feb\u62f7\u8d1d\u6570\u636e\u5907\u4efd\uff0c\u8003\u8651\u4f7f\u7528 macOS \u81ea\u5e26\u7684 diskutil/Disk Utility.app \u6216\u5176\u4ed6\u78c1\u76d8\u4fee\u590d\u5de5\u5177\u5bf9\u5206\u533a\u91cd\u65b0\u683c\u5f0f\u5316\u3002</p>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#config_mount_in_fstab","title":"config mount in fstab","text":"<p>\u5173\u4e8e fstab \u547d\u4ee4\uff0c\u53c2\u8003 Ubuntu Manpage: fstab - static information about the filesystems\u3001Fstab - Community Help Wiki \u548c An introduction to the Linux /etc/fstab file\u3002</p> <p>what is fstab?</p> <p>The filesystem table, aka fstab, contains descriptive information about the filesystems the system can mount.</p> <p>\u7f16\u8f91\u6587\u4ef6 <code>sudo vim /etc/fstab</code>\uff0c\u5176\u6761\u76ee\u683c\u5f0f\uff08syntax of a fstab entry\uff09\u5982\u4e0b\uff1a</p> <pre><code>[Device] [Mount Point] [File System Type] [Options] [Dump] [Pass]\n</code></pre> <p>\u7b2c 1 \u5217\u53ef\u4ee5\u4e3a UUID\uff08PARTUUID\uff1f\uff09\u3001LABEL\u3001Network ID\uff08samba: //server/share\uff09\u548c Device\uff08/dev/sda3\uff0cnot recommended\uff09\u3002 \u7531\u4e8e UUID \u53ef\u80fd\u4f1a\u53d8\uff0c\u6545\u4e0b\u9762\u91c7\u7528 LABEL\u3002</p> <p>\u53c2\u8003 linux mint - HFS+ file system being mounted as read-only \u548c ubuntu - How to Mount HFS+ drive as read-write on startup\uff0c\u5728 fstab \u4e2d\u52a0\u5165\u542f\u52a8\u52a0\u8f7d\u9879\uff1a</p> /etc/fstab<pre><code>LABEL=WDHD /media/WDHD auto uid=1000,gid=1000,nosuid,nodev,nofail,x-gvfs-show,force,rw 0 0\n</code></pre> <p><code>sudo reboot</code> \u91cd\u542f\uff0c\u6210\u529f\u6302\u8f7d\u4e3a rw\u3002</p> <p>must disableJournal for HFS+ Volume?</p> <p>Fstab - Community Help Wiki \u4e2d\u7684 File System Specific Examples \u90e8\u5206\u6709\u63d0\u5230 HFS:  if you want to write data on this partition, you must disable the journalization of this partition with <code>diskutil</code> under Mac OS.</p> <p>\u5173\u4e8e Hard Drive Journaling \u53c2\u8003\u4ee5\u4e0b\u7f51\u5e16\uff1a</p> <ul> <li>What is Mac Hard Drive Journaling and why it is important to have?</li> <li>Disabling Journalling for external drive</li> <li>Can not disable external drive Journaling</li> </ul> <p>\u6211\u8fd9\u91cc\u5e76\u672a\u6267\u884c <code>diskutil disableJournal /Volumes/WDHD</code>\uff0c\u5177\u4f53\u4e0d\u8be6\u3002</p>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#config_samba_for_wdhd","title":"config samba for WDHD","text":"","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#install_samba","title":"install samba","text":"<p>samba - Server to provide AD and SMB/CIFS services to clients</p> <p>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5 samba\uff1a</p> <pre><code>$ sudo apt install samba -y\n$ sudo apt install samba-vfs-modules -y\n</code></pre> <ol> <li><code>samba -V</code>: \u67e5\u770b\u8f6f\u4ef6\u7248\u672c\uff1b</li> <li><code>samba --help</code>\uff1a\u67e5\u770b\u5e2e\u52a9\uff08usage\uff09\uff1b</li> <li><code>man samba</code>\uff1a\u67e5\u770b\u5e2e\u52a9\u624b\u518c\uff08manual\uff09\uff1b</li> </ol> <pre><code>$ samba -V\nVersion 4.15.13-Ubuntu\n</code></pre>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#config_samba","title":"config samba","text":"<p>Samba\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u5728 /etc/samba/ \u8def\u5f84\u4e0b\uff1a</p> <pre><code>$ ls -l /etc/samba/\ntotal 20\n-rw-r--r-- 1 root root    8 Jan  5 21:23 gdbcommands\n-rw-r--r-- 1 root root 8950 Apr  7 05:00 smb.conf\ndrwxr-xr-x 2 root root 4096 Jan  5 21:23 tls\n</code></pre> <p>\u7f16\u8f91 Samba \u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>$ sudo vim /etc/samba/smb.conf\n</code></pre> <p>\u5728\u914d\u7f6e\u6587\u4ef6\u5e95\u90e8\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff08\u6ce8\u610f\u8bf7\u79fb\u9664\u884c\u5c3e\u6ce8\u91ca\uff09\uff1a</p> <pre><code>[WDHD]\n    # \u5171\u4eab\u63cf\u8ff0\n    comment = WD - Hard Disk\n    # \u5171\u4eab\u76ee\u5f55\uff08mount point\uff09\n    path = /media/WDHD\n    # sudo smbpasswd -a pifan \u521b\u5efa\u5171\u4eab\u7528\u6237\u5bc6\u7801\n    valid users = pifan\n    # \u53ef\u8bfb\u5199\n    browseable = yes\n    read only = no\n    writeable = yes\n    # \u4e0d\u5141\u8bb8 guest \u8d26\u6237\u8bbf\u95ee\n    public = no\n    guest ok = no\n    # \u5ba2\u6237\u7aef\u4e0a\u4f20\u6587\u4ef6\u7684\u9ed8\u8ba4\u6743\u9650\n    create mask = 0777\n    # \u5ba2\u6237\u7aef\u521b\u5efa\u76ee\u5f55\u7684\u9ed8\u8ba4\u6743\u9650\n    directory mask = 0777\n</code></pre>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#smbpasswd","title":"smbpasswd","text":"<p>\u914d\u7f6e\u5b8c\u6bd5\u540e\u6267\u884c <code>sudo smbpasswd -a pifan</code> \u6765\u8bbe\u7f6e\u7528\u6237\u540d\u5bc6\u7801\u3002</p> <p>\u5173\u4e8e Samba \u8d26\u6237</p> <p>Samba \u9700\u8981 Linux \u8d26\u6237\u624d\u80fd\u4f7f\u7528\uff0c\u53ef\u4ee5\u4f7f\u7528 \u5df2\u6709\u8d26\u6237 \u6216 \u521b\u5efa\u65b0\u7528\u6237\u3002\u867d\u7136\u7528\u6237\u540d\u53ef\u4ee5\u548c Linux \u7cfb\u7edf\u5171\u4eab\uff0c\u4f46 Samba \u4f7f\u7528\u7684\u662f\u5355\u72ec\u7684\u5bc6\u7801\u7ba1\u7406\u3002</p> <p>\u8bbe\u7f6e\u5b8c\u6bd5\u540e\u91cd\u542f Samba \u670d\u52a1\uff1a<code>sudo samba restart</code> \u6216 <code>sudo systemctl restart smbd</code>\u3002</p> <p>\u6267\u884c <code>systemctl status smbd</code>\uff08\u6216 smbd.service\uff09\u53ef\u67e5\u770b samba \u670d\u52a1\u72b6\u6001\u3002</p>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#test_samba","title":"test samba","text":"<p>\u5c40\u57df\u7f51 macOS \u4e2d\u6253\u5f00 Finder\uff0c\u9009\u62e9 \u83dc\u5355\u680f\u2013\u524d\u5f80\u2013\u8fde\u63a5\u670d\u52a1\u5668\uff08\u6216\u8005\u76f4\u63a5 Command + K\uff09\uff0c\u5728\u5f39\u51fa\u7684\u7a97\u53e3\u4e2d\u8f93\u5165 <code>smb://\u6811\u8393\u6d3e\u7684IP\u5730\u5740</code> \u540e\u9009\u62e9 \u300c\u8fde\u63a5\u2013\u8f93\u5165\u8bbe\u7f6e\u300d \u7684\u8d26\u6237\u548c\u5bc6\u7801\u540e\u5c31\u80fd\u8bbf\u95ee\u4e86\u3002</p> <pre><code>smb://192.168.0.202/\nsmb://rpi4b-ubuntu.local/\nsmb://rpi4b-ubuntu.local/WDHD\n</code></pre> <p>How to Mount SMB Share from Command Line on Mac</p> <pre><code># \u521b\u5efa\u6302\u8f7d\u70b9\n$ mkdir $HOME/WDHD\n\n# \u6302\u8f7dsamba\n# mount_smbfs is alias of mount -t smbfs\n$ mount -t smbfs //pifan@rpi4b-ubuntu.local/WDHD $HOME/WDHD\nPassword for rpi4b-ubuntu.local:\n\n# \u5378\u8f7dsamba\n$ umount $HOME/WDHD\n</code></pre>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#config_samba_for_wdtm","title":"config samba for WDTM","text":"<p>WD \u786c\u76d8\u7684 sda3 \u5206\u533a\u662f\u666e\u901a\u5206\u533a\uff0c\u6302\u8f7d\u540e\u5c40\u57df\u7f51\u901a\u8fc7 smb \u534f\u8bae\u8bbf\u95ee\u53ef\u76f4\u63a5\u8bfb\u5199\u3002</p> <p>sda2 \u5206\u533a\u4e4b\u524d\u4e3a macOS \u5907\u4efd\u5206\u533a\uff0c\u6bcf\u6b21\u60f3\u8981\u5907\u4efd\uff0c\u90fd\u8981\u63d2\u62d4\u78c1\u76d8\u3002</p> <p>\u8fd9\u91cc\u5c06\u5176\u6302\u8f7d\u5230\u6811\u8393\u6d3e\uff0c\u914d\u7f6e samba \u5171\u4eab\u4e3a\u5c40\u57df\u7f51\u65e0\u7ebf\u5907\u4efd\u3002</p> <p>\u76f4\u63d2\u5907\u4efd\u76d8\u8fc1\u79fb\u4e3asamba\u65e0\u7ebf\u5907\u4efd\u7684\u98ce\u9669\u9884\u8b66</p> <p>\u76f4\u63d2\u5907\u4efd\u76d8\u6539\u4e3a\u5c40\u57df\u7f51\u5916\u6302\u78c1\u76d8\u914d\u7f6esamba\u5171\u4eab\u65e0\u7ebf\u5907\u4efd\uff0c\u53ef\u80fd\u4f1a\u7834\u574f\u4e4b\u524d\u5907\u4efd\u76d8\u7684\u5143\u6570\u636e\uff0c\u5bfc\u81f4\u65e0\u6cd5\u8bc6\u522b\u65e7\u7684\u5907\u4efd\u6570\u636e\uff08Backups.backupdb\uff09\u3002 \u53c2\u8003 Time Machine Notes \u4e2d\u63d0\u4f9b\u7684 Migration from External HDD to Samba \u65b9\u6848\uff0c\u505a\u597d\u6570\u636e\u8fc1\u79fb\u7684\u524d\u7f6e\u5de5\u4f5c\u3002 \u751f\u547d\u4e0d\u6b62\uff0c\u6298\u817e\u4e0d\u606f\u3002\u786c\u76d8\u6709\u4ef7\uff0c\u6570\u636e\u65e0\u4ef7\u3002\u201c\u5b63\u6587\u5b50\u4e09\u601d\u800c\u540e\u884c\u201d\uff0c\u8001\u5b50\u66f0\u201c\u77e5\u6b62\u4e0d\u6b86\uff0c\u53ef\u4ee5\u957f\u4e45\u201d\u3002</p> <p>\u6b64\u6846\u5927\u7ea6\u6d53\u7f29\u4e86\u535a\u4e3b\u6570\u5e74\u7d2f\u79ef 1T \u7684\u8840\u4e0e\u6cea \ud83d\ude31</p> <p>\u5148\u521b\u5efa\u6302\u8f7d\u70b9\uff0c\u5c06\u8be5\u5206\u533a\u6302\u8f7d\u4e3a <code>/media/WDTM</code>\uff1a</p> <pre><code># 1. \u521b\u5efa\u6302\u8f7d\u70b9\u76ee\u5f55\n$ sudo mkdir /media/WDTM\n\n$ ls -l /media/\ntotal 0\ndrwxrwxr-x 1 pifan ubuntu 24 Apr  7 04:23 WDHD\ndrwxrwxr-x 1 root root 21 Apr  7 10:46 WDTM\n\n# 2. \u4fee\u6539\u6302\u8f7d\u70b9\u76ee\u5f55\u7684\u6240\u6709\u4eba\u4e3a\u5f53\u524d\u7528\u6237\uff08\u7ec4\uff09\uff1a\n$ sudo chown pifan:ubuntu /media/WDTM\n\n$ ls -l /media/\ntotal 0\ndrwxrwxr-x 1 pifan ubuntu 24 Apr  7 04:23 WDHD\ndrwxrwxr-x 1 pifan ubuntu 21 Apr  7 10:46 WDTM\n\n# 3. \u6302\u8f7d\u5916\u63a5\u786c\u76d8\u7684 sda2 \u5206\u533a\n$ sudo mount -t hfsplus -o force,rw,uid=pifan,gid=ubuntu /dev/sda2 /media/WDTM\n</code></pre> <p>\u6302\u8f7d\u6210\u529f\u540e\uff0c\u67e5\u770b\u6302\u8f7d\u70b9\u53ca\u5176\u76ee\u5f55\u5185\u5bb9\uff1a</p> <pre><code>$ df -h\nFilesystem      Size  Used Avail Use% Mounted on\ntmpfs           781M  5.2M  776M   1% /run\n/dev/mmcblk0p2   59G   14G   42G  26% /\ntmpfs           3.9G     0  3.9G   0% /dev/shm\ntmpfs           5.0M     0  5.0M   0% /run/lock\n/dev/mmcblk0p1  253M  138M  115M  55% /boot/firmware\ntmpfs           781M  4.0K  781M   1% /run/user/1000\n/dev/sda3       466G  204G  263G  44% /media/WDHD\n/dev/sda2       1.4T  1.3T  135G  91% /media/WDTM\n\n$ ls -l /media/WDTM\ntotal 288\ndrwxr-xr-x  1 faner  staff   16384 Mar 16 10:38 Backups.backupdb\ndr-xr-xr-x  1 faner  staff   16384 Sep  9  2017 _HF2VN~W\n-rwxr-xr-x  1 faner  staff  111620 Feb 21  2017 tmbootpicker.efi\n</code></pre> <p>\u518d\u4e3a sda2 \u5206\u533a\u6302\u8f7d\u70b9 /media/WDTM \u914d\u7f6e samba \u5171\u4eab\u670d\u52a1\uff0c\u4f9b\u5c40\u57df\u7f51\u5185\u7684 macOS \u65e0\u7ebf\u5907\u4efd\u3002</p> <p>\u5728\u914d\u7f6e\u6587\u4ef6 /etc/samba/smb.conf \u7684\u5168\u5c40\u914d\u7f6e\u6bb5\uff08[global]\uff09\u4e0b\u589e\u52a0\u5982\u4e0b\u8bbe\u7f6e\uff0c\u4ee5\u7981\u7528 SMB1 \u534f\u8bae\u548c\u652f\u6301 macOS \u7cfb\u7edf\u7684\u62d3\u5c55\u5c5e\u6027\uff1a</p> <p>Apple extensions (\"AAPL\") run under SMB2/3 protocol, make that the minimum (probably shouldn't be running SMB1 anyway...)</p> <pre><code>[global]\n    # \u6700\u5c0f\u652f\u6301\u4e3a SMB2\n    min protocol = SMB2\n    # Apple \u6269\u5c55\u9700\u8981\u652f\u6301\u6269\u5c55\u5c5e\u6027(xattr)\n    ea support = yes\n    # smb encrypt = required\n</code></pre> <p>\u5728\u914d\u7f6e\u6587\u4ef6\u672b\u5c3e\u6dfb\u52a0 WDTM \u914d\u7f6e\uff1a</p> <pre><code>[WDTM]\n    # \u5171\u4eab\u63cf\u8ff0\n    comment = WD - Time Machine\n    # \u5171\u4eab\u76ee\u5f55\uff08mount point\uff09\n    path = /media/WDTM\n    # \u53ef\u8bfb\u5199\n    browseable = yes\n    read only = no\n    writeable = yes\n    # \u4e0d\u5141\u8bb8 guest \u8d26\u6237\u8bbf\u95ee\n    public = no\n    guest ok = no\n    # valid users = pifan\n    # create mask = 0700\n    # vfs objects = fruit streams_xattr\n    vfs objects = catia fruit streams_xattr\n    fruit:aapl = yes\n    fruit:time machine = yes\n    fruit:metadata = stream\n    fruit:model = MacSamba\n    # \u6587\u4ef6\u6e05\u7406\u7684\u4e00\u4e9b\u914d\u7f6e\n    fruit:veto_appledouble = no\n    fruit:nfs_aces = no\n    fruit:posix_rename = yes\n    fruit:zero_file_id = yes\n    fruit:wipe_intentionally_left_blank_rfork = yes\n    fruit:delete_empty_adfiles = yes\n</code></pre> <p>\u8bbe\u7f6e\u5b8c\u6bd5\u540e\u91cd\u542f Samba \u670d\u52a1\uff1a<code>sudo systemctl restart smbd</code>\u3002 \u6267\u884c <code>systemctl status smbd</code> \u53ef\u67e5\u770b samba \u670d\u52a1\u72b6\u6001\u3002</p> <p>\u5c40\u57df\u7f51 macOS \u4e2d\u6253\u5f00 Finder\uff0cCommand + K \u8f93\u5165 <code>smb://rpi4b-ubuntu.local/WDTM</code>\uff0c\u6309\u7167\u63d0\u793a\u8f93\u5165\u8d26\u6237\u548c\u5bc6\u7801\u5c31\u80fd\u8bbf\u95ee\u4e86\u3002</p> <p>\u7f16\u8f91\u6587\u4ef6 <code>sudo vim /etc/fstab</code>\uff0c\u589e\u52a0\u5f00\u673a\u81ea\u542f\u52a8\u6761\u76ee\uff1a</p> /etc/fstab<pre><code>LABEL=WDTM /media/WDTM auto uid=1000,gid=1000,nosuid,nodev,nofail,x-gvfs-show,force,rw 0 0\n</code></pre>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#set_as_macos_backup_disk","title":"set as macOS Backup Disk","text":"<p>\u7cfb\u7edf\u8bbe\u7f6e\u4e2d\u6253\u5f00\u65f6\u95f4\u673a\u5668\uff08Settings - General - Time Machine\uff09\uff0c\u70b9\u51fb <code>Add Backup Disk...</code> \u6309\u94ae\uff1a</p> <p>\u70b9\u51fb\u5f39\u51fa\u7684 <code>WDTM on RPI4B-UBUNTU.local</code>\uff1a</p> <p>\u8bbe\u7f6e Encrypt Backup \u52a0\u5bc6\u5bc6\u7801\uff0cDisk Usage Limit \u9ed8\u8ba4\u6700\u5927\uff1a</p> <p>\u786e\u8ba4\u70b9\u51fb Done \u540e\uff0cTime Machine \u9762\u677f\u51fa\u73b0\u65b0\u6dfb\u52a0\u7684\u5907\u4efd\u7f51\u76d8 WDTM - RPI4B-UBUNTU.local\uff1a</p> <p>\u8fd9\u6837\uff0c\u968f\u65f6\u968f\u5730\u8fdb\u884c\u5c40\u57df\u7f51\u65e0\u7ebf\u5907\u4efd\uff0c\u518d\u4e5f\u4e0d\u7528\u4e13\u95e8\u4e3a\u4e86\u5907\u4efd\u800c\u63d2\u62d4\u786c\u76d8\u3002</p>","tags":["samba"]},{"location":"blog/20240318/ubuntu-config-samba/#refs","title":"refs","text":"<p>Configure Samba to Work Better with Mac OS X How to Mount Windows Share on Linux using CIFS</p> <p>\u6811\u8393\u6d3e\u6302\u8f7d\u79fb\u52a8\u786c\u76d8 | Notes \u6811\u8393\u6d3e\u642d\u5efa\u4f4e\u914d\u7248\u6587\u4ef6\u5b58\u50a8\u53ca\u5bb6\u5ead\u5f71\u97f3\u5e93 - \u5c11\u6570\u6d3e \u6559\u5973\u670b\u53cb\u4e00\u6837\u6559\u4f60\u7528\u6811\u8393\u6d3e\u548c\u79fb\u52a8\u786c\u76d8\u642dNAS - \u77e5\u4e4e</p> <p>Types of disks you can use with Time Machine on Mac Samba and macOS Time Machine \u5229\u7528\u6811\u8393\u6d3e\u6253\u9020\u65f6\u95f4\u673a\u5668 - \u5c11\u6570\u6d3e</p> <p>\u5c40\u57df\u7f51\u5185\u4f7f\u7528 Samba \u642d\u5efa macOS \u65f6\u95f4\u673a\u5668\u7684\u8fdc\u7a0b\u5907\u4efd - huoyanCC \u5c40\u57df\u7f51\u5185\u90e8\u7f72 SMB \u670d\u52a1\u5668\u5b9e\u73b0 macOS Time Machine \u81ea\u52a8\u5907\u4efd Linux\u4f7f\u7528SMB\u7ed9macOS\u505a\u65e0\u7ebfTime Machine\u5907\u4efd - \u77e5\u4e4e</p>","tags":["samba"]},{"location":"blog/20191029/linux-cmd-alias/","title":"Linux Command - alias","text":"<p>linux \u4e0b\u7684\u547d\u4ee4 alias \u7b80\u4ecb\u3002</p>","tags":["alias"]},{"location":"blog/20191029/linux-cmd-alias/#alias","title":"alias","text":"<p>alias \u2014 define or display aliases</p> <pre><code>OPERANDS         top\n       The following operands shall be supported:\n\n       alias-name\n                 Write the alias definition to standard output.\n\n       alias-name=string\n                 Assign the value of string to the alias alias-name.\n\n       If no operands are given, all alias definitions shall be written to standard output.\n</code></pre> <p>\u4e0d\u5e26\u4efb\u4f55\u53c2\u6570\u8f93\u5165 <code>alias</code> \u5217\u4e3e\u6240\u6709\u7684\u5173\u8054\u547d\u4ee4\u3002</p> <pre><code>\u279c  ~ type -a ls\nls is an alias for ls -G\nls is a shell function from /Users/ifan/.oh-my-zsh/custom/plugins/ls/ls.plugin.zsh\nls is /bin/ls\n\n\u279c  ~ type -a ll\nll is an alias for ls -lh\nll is a shell function from /Users/ifan/.oh-my-zsh/custom/plugins/ls/ls.plugin.zsh\n</code></pre>","tags":["alias"]},{"location":"blog/20191029/linux-cmd-alias/#set","title":"set","text":"<p>\u8bbe\u7f6e\u5173\u8054\u547d\u4ee4\uff1a</p> <pre><code>\u279c  ~ alias ll='ls -lh'\n\u279c  ~ alias ctags=\"`brew --prefix`/bin/ctags\"\n\u279c  ~ alias prefs='open /System/Applications/System\\ Preferences.app'\n</code></pre>","tags":["alias"]},{"location":"blog/20191029/linux-cmd-alias/#bash_aliases","title":".bash_aliases","text":"<p>How to Create and Remove alias in Linux</p> <p>\u8003\u8651\u521b\u5efa\u4e00\u4e2a <code>~/.bash_aliases</code> \u5c06\u5e38\u7528\u7684\u4fbf\u6377\u547d\u4ee4\u6536\u96c6\u5728\u4e00\u8d77\uff0c\u7136\u540e\u5728 <code>~/.bashrc</code> \u6216 <code>~/.zshrc</code> \u4e2d source \u8f7d\u5165\u3002</p> <p>Create Permanent aliases</p> <p>To define a permanent alias we must add it in <code>~/.bashrc</code> file. Also, we can have a separate file for all aliases (<code>~/.bash_aliases</code>) but to make this file to work we must append the following lines at the end of the <code>~/.bashrc</code> file, using any text editor:</p> <pre><code>if [ -f ~/.bash_aliases ]; then\n    . ~/.bash_aliases # source\nfi\n</code></pre> <p>Also we can use the following command to add alias without opening the <code>~/.bash_aliases</code> file</p> <pre><code>echo \"alias vps='ssh user@ip_address_of_the_remote_server'\" &gt;&gt; ~/.bash_aliases\n</code></pre> <p>this alias can help us to connect to our vps server via a three-letter command</p> <p>Here are some examples of permanent aliases that can help in daily work</p> <pre><code>alias update='sudo -- sh -c \"apt update &amp;&amp; apt upgrade\"'    # update Ubuntu distro\nalias netstat='netstat -tnlp'                               # set default options for netstat command\nalias vnstat='vnstat -i eth0'                               # set eth0 as an interface for vnstat\nalias flush_redis='redis-cli -h 127.0.0.1 FLUSHDB'          # flush redis cache for wp\n</code></pre> <p>All created aliases will work next time we log in to via ssh or open new terminal. To apply aliases immediately we can use the following command:</p> <pre><code>source ~/.bash_aliases\n# or\n. ~/.bash_aliases\n</code></pre>","tags":["alias"]},{"location":"blog/20191029/linux-cmd-alias/#common-aliases","title":"common-aliases","text":"<p>oh-my-zsh \u53ef\u4ee5\u5b89\u88c5 lol\u3001singlechar\u3001common-aliases\u3001systemadmin \u63d2\u4ef6\uff0ccommon-aliases.plugin.zsh \u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e9b\u5e38\u7528\u7684 alias \u66ff\u8eab\u547d\u4ee4\u3002</p> <p>\u53ef\u8003\u8651\u5728 ~/.zsh_aliases \u4e2d\u6dfb\u52a0\u5e38\u7528\u8f6f\u4ef6\u7684\u4fbf\u6377\u66ff\u8eab\u547d\u4ee4\uff1a</p> <pre><code># vim ~/.zsh_aliases\n\n# \u6bcf\u6b21\u6267\u884c\u5220\u9664\u90fd\u9700\u8981\u786e\u8ba4\nalias rm='rm -i'\n# tnmp\u6307\u5b9a\u817e\u8baf\u4e91\u6e90\nalias tnpm='npm --registry https://mirrors.tencent.com/npm/'\n# \u5feb\u6377\u6253\u5f00\u7cfb\u7edf\u504f\u597d\u8bbe\u7f6e\uff0c\u6ce8\u610f\u7a7a\u683c\u9700\u8981\u8f6c\u4e49\u3002\nalias prefs='open /System/Applications/System\\ Preferences.app'\n# \u5feb\u6377\u6253\u5f00Android Studio\uff0c\u540e\u9762\u53ef\u63a5\u5de5\u7a0b\u76ee\u5f55\nalias AndroidStudio='open -a /Applications/Android\\ Studio.app'\n# \u5feb\u6377\u6253\u5f00 GoogleChrome \u6d4f\u89c8\u5668\nalias chrome='/Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome'\n</code></pre> <p>\u7136\u540e\u5728 <code>~/.zshrc</code> \u4e2d\u5f15\u5165\u52a0\u8f7d <code>~/.zsh_aliases</code>\uff0c\u4ee5\u4fbf\u5728zsh\u4e2d\u5feb\u901f\u8c03\u8d77\u76f8\u5173\u5de5\u5177/\u8f6f\u4ef6\u3002</p> <pre><code># vim ~/.zshrc\n\nif [ -f ~/.zsh_aliases ]; then\n    . ~/.zsh_aliases # source\nfi\n</code></pre>","tags":["alias"]},{"location":"blog/20191029/linux-cmd-alias/#read","title":"read","text":"<p>\u67e5\u770b ll \u5173\u8054\u7684\u547d\u4ee4\uff1a</p> <pre><code>\u279c  ~ alias ll\nll='ls -lh'\n\n\u279c  ~ alias prefs\nprefs='open /System/Applications/System\\ Preferences.app'\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u5bf9\u4e00\u4e2a\u66ff\u8eab\u547d\u4ee4\u6267\u884c which \u65f6\uff0c\u4e5f\u4f1a\u6253\u5370\u5176\u5173\u8054\u6e90\u4fe1\u606f\uff1a</p> <pre><code>\u279c  ~ which AndroidStudio\nAndroidStudio: aliased to open -a /Applications/Android\\ Studio.app\n</code></pre> <p>oh-my-zsh \u53ef\u4ee5\u5b89\u88c5 aliases \u63d2\u4ef6\uff0c\u7528\u6cd5\u5982\u4e0b\uff1a</p> <ul> <li><code>acs</code>: show all aliases by group.  </li> <li><code>acs &lt;keyword&gt;</code>: filter aliases by <code>&lt;keyword&gt;</code> and highlight.  </li> </ul>","tags":["alias"]},{"location":"blog/20191029/linux-cmd-alias/#unset","title":"unset","text":"<p>unalias</p> <pre><code>unalias alias-name...\n\nDESCRIPTION\n\nThe unalias utility shall remove the definition for each alias name specified. See Alias Substitution . The aliases shall be removed from the current shell execution environment; see Shell Execution Environment .\n\nunalias -a Removes All aliases\n</code></pre> <p>\u89e3\u9664 ll \u5173\u8054\u547d\u4ee4\uff1a</p> <pre><code>\u279c  ~ unalias ll\n</code></pre>","tags":["alias"]},{"location":"blog/20191029/linux-cmd-alias/#refs","title":"refs","text":"<p>Creating bash commands and aliases</p>","tags":["alias"]},{"location":"blog/20191029/linux-cmd-find-xargs/","title":"Linux Command - find & xargs","text":"<p>linux \u4e0b\u7684\u547d\u4ee4 find \u7528\u6cd5\u603b\u7ed3\u3002</p>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#man","title":"man","text":"<p>\u4ee5\u4e0b\u662f\u5404\u5927\u5e73\u53f0\u7684 find \u5728\u7ebf\u624b\u518c\uff1a</p> <ul> <li>unix/POSIX - find </li> <li> <p>FreeBSD/Darwin - find </p> </li> <li> <p>linux - find(1) &amp; find(1p) </p> </li> <li> <p>debian - find(1) </p> </li> <li> <p>ubuntu - find(1) </p> </li> </ul> <p>\u4ee5\u4e0b\u662f\u5404\u5927\u5e73\u53f0\u5bf9 find \u7684\u5b9a\u4e49\uff1a</p> <ul> <li>unix/POSIX\uff1afind - find files  </li> <li>FreeBSD/Darwin\uff1afind -- walk a file hierarchy  </li> <li>linux/debian/ubuntu\uff1afind - search for files in a directory hierarchy  </li> </ul>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#helpusage","title":"help/usage","text":"<p>\u6267\u884c <code>man find</code> \u53ef\u67e5\u770b find \u547d\u4ee4\u5e2e\u52a9\u624b\u518c\u3002</p> <pre><code># macOS\nFIND(1)         FreeBSD General Commands Manual            FIND(1)\n\nNAME\n     find -- walk a file hierarchy\n\nSYNOPSIS\n     find [-H | -L | -P] [-EXdsx] [-f path] path ... [expression]\n     find [-H | -L | -P] [-EXdsx] -f path [path ...] [expression]\n\nDESCRIPTION\n     The find utility recursively descends the directory tree for each path\n     listed, evaluating an expression (composed of the \"primaries\" and\n     \"operands\" listed below) in terms of each file in the tree.\n</code></pre> <p>find \u547d\u4ee4\u7684\u5de5\u4f5c\u65b9\u5f0f\u5982\u4e0b\uff1a\u6cbf\u7740\u6587\u4ef6\u5c42\u6b21\u7ed3\u6784\u5411\u4e0b\u904d\u5386\uff0c\u5339\u914d\u67e5\u627e\u7b26\u5408\u6761\u4ef6\u7684\u6587\u4ef6\uff08\u5939\uff09\uff0c\u6267\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\u3002</p> <pre><code>find path [options] [expression]\n</code></pre> <p>\u5176\u4e2d path \u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u76ee\u5f55\u3002</p>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#options","title":"options","text":"","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#operators","title":"OPERATORS","text":"<p>\u8868\u8fbe\u5f0f\u53ca\u64cd\u4f5c\u7b26\u3002</p> <p>The operator <code>-or</code> was implemented as <code>-o</code>, and the operator <code>-and</code> was implemented as <code>-a</code>.</p> <pre><code>     The primaries may be combined using the following operators.  The operators are listed in order of\n     decreasing precedence.\n\n     ( expression )\n             This evaluates to true if the parenthesized expression evaluates to true.\n\n     ! expression\n     -not expression\n             This is the unary NOT operator.  It evaluates to true if the expression is false.\n\n     -false  Always false.\n     -true   Always true.\n\n     expression -and expression\n     expression expression\n             The -and operator is the logical AND operator.  As it is implied by the juxtaposition of two\n             expressions it does not have to be specified.  The expression evaluates to true if both\n             expressions are true.  The second expression is not evaluated if the first expression is\n             false.\n\n     expression -or expression\n             The -or operator is the logical OR operator.  The expression evaluates to true if either the\n             first or the second expression is true.  The second expression is not evaluated if the first\n             expression is true.\n\n     All operands and primaries must be separate arguments to find.  Primaries which themselves take argu-\n     ments expect each argument to be a separate argument to find.\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-name","title":"-name","text":"<p>\u6309\u7167\u6587\u4ef6\u540d\u67e5\u627e\u6587\u4ef6\u3002</p> <p>\u6ce8\u610f\uff1a-name \u6a21\u7cca\u5339\u914d\u76ee\u5f55\u6216\u6587\u4ef6\uff0c\u662f\u57fa\u4e8e\u901a\u914d\u7b26\uff08globbing/wildcard patterns\uff09\uff0c\u800c\u975e\u6b63\u5219\u8868\u8fbe\u5f0f\uff01</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u901a\u914d\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709txt\u6587\u4ef6\uff1a</p> <pre><code>$ find . -name *.txt\nfind: data.txt: unknown primary or operator\n</code></pre> <p>\u6839\u636e\u63d0\u793a\u901a\u914d\u7b26\u9700\u8981\u8f6c\u4e49\uff0c\u6216\u8005\u5c06 <code>-name</code> \u53c2\u6570\u7528\u5f15\u53f7\u5305\u8d77\u6765\uff1a</p> <pre><code>find . -name \\*.txt\nfind . -name '*.txt'\nfind . -name \"*.log\"\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u901a\u914d\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u540d\u79f0\u5305\u542bOfflineFile\u7684\u6587\u4ef6\u5939\u53ca\u6587\u4ef6\u3002</p> <pre><code>$ find . -iname '*OfflineFile*'\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u901a\u914d\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u540e\u7f00\u4e3aproto\u7684\u6587\u4ef6\uff08\u5373protobuf\u534f\u8bae\u6587\u4ef6\uff09\u3002</p> <pre><code>$ find . -type f -name \"*.proto\"\n</code></pre> <p>\u5728 /usr/include \u76ee\u5f55\u4e0b\uff08\u9012\u5f52\uff09\u67e5\u627e\u540d\u79f0\u4e3a wordsize.h \u7684\u6587\u4ef6\u3002</p> <pre><code>$ find /usr/include -type f -name wordsize.h\n/usr/include/aarch64-linux-gnu/bits/wordsize.h\n</code></pre> <p>\u5982\u679c\u77e5\u9053\u8fd9\u4e2a\u5934\u6587\u4ef6\u5728\u65d7\u4e0b\u4e00\u7ea7 target \u7684 bits \u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u7f29\u5c0f\u8303\u56f4\u901a\u914d\u67e5\u627e\uff1a</p> <pre><code>$ find /usr/include/*/bits -type f -name wordsize.h\n/usr/include/aarch64-linux-gnu/bits/wordsize.h\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#case-insensitive","title":"case-insensitive","text":"<p><code>-iname</code>\uff1a\u5339\u914d\u540d\u5b57\u65f6\u4f1a\u5ffd\u7565\u5927\u5c0f\u5199\u3002</p> <p>\u5927\u90e8\u5206\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u6587\u4ef6\u540d\u4e2d\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c<code>file.txt</code> \u548c <code>FILE.txt</code> \u8868\u793a\u540c\u4e00\u4e2a\u6587\u4ef6\uff1b<code>file.txt</code> \u548c <code>file.TXT</code> \u4e5f\u8868\u793a\u540c\u4e00\u4e2a\u6587\u4ef6\u3002</p> <p>\u56e0\u6b64\u5728\u6267\u884c\u76f8\u5173 find \u67e5\u627e\u65f6\uff0c\u6bd4\u5982\u7edf\u8ba1C\u8bed\u8a00\u7a0b\u5e8f\u4ee3\u7801\u6587\u4ef6\uff0c\u5176\u540e\u7f00\u53ef\u80fd\u4e3a <code>*.c</code> \u6216 <code>*.C</code>\u3002\u6b64\u65f6\uff0c<code>-iname</code> \u6bd4 <code>-name</code> \u66f4\u5b9e\u7528\u3002</p>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#inverse","title":"inverse","text":"<p><code>!</code>\uff08<code>-not</code>\uff09\u8fd0\u7b97\u7b26\u652f\u6301\u53cd\u5411\u5339\u914d\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u67e5\u627e\u6240\u6709\u975e\u6307\u5b9a\u540e\u7f00\u7684\u6587\u4ef6\uff1a</p> <pre><code>$ find . ! -name '*.txt'\n$ find . -not -name '*.txt'\n# \u8f6c\u4e49\u53cd\u659c\u6760\u8c8c\u4f3c\u53ef\u6709\u53ef\u65e0\n$ find . \\! -iname \"*.c\"\n</code></pre> <p>\u4ee5\u4e0b\u4e3a find \u7684 man page \u4e2d\u7684\u4e24\u4e2a\u76f8\u5173\u793a\u4f8b\uff1a</p> <pre><code>     find / \\! -name \"*.c\" -print\n             Print out a list of all the files whose names do not end in .c.\n\n     find / \\! \\( -newer ttt -user wnj \\) -print\n             Print out a list of all the files which are not both newer than ttt and owned by ``wnj''.\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u540c\u65f6\u6307\u5b9a\u7b26\u5408\u548c\u4e0d\u7b26\u5408\u7684\u6761\u4ef6\uff1a</p> <pre><code># \u67e5\u627e *.txt \u6587\u4ef6\uff0c\u4f46\u662f\u5ffd\u7565 .txt\u3001.vimrc\u3001.data \u7b49\u9690\u85cf\u6587\u4ef6\uff08hidden dot files\uff09\u3002\n$ find . -type f \\( -iname \"*.txt\" ! -iname \".*\" \\)\n\n# \u67e5\u627e\u6240\u6709\u7684\u70b9\u9690\u85cf\u6587\u4ef6\uff08hidden dot files\uff09\uff0c\u4f46\u662f\u5ffd\u7565 .htaccess \u6587\u4ef6\u3002\n$ find . -type f \\( -iname \".*\" ! -iname \".htaccess\" \\)\n\n# \u67e5\u627e\u6240\u6709\u975eC/C++\u4ee3\u7801\u6587\u4ef6\uff08\u5305\u62ec\u5934\u6587\u4ef6\u548c\u6e90\u7801\u6587\u4ef6\uff09\uff0c\u4ee5\u4fbf\u5220\u9664\u4e2d\u95f4\u4ea7\u7269\n$ find . -type f \\( ! -iname '*.h' ! -iname '*.hh' ! -iname '*.hpp' ! -iname '*.c' ! -iname '*.cc' ! -iname '*.cpp' \\)\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#or","title":"or","text":"<p><code>-name</code> \u6bcf\u6b21\u53ea\u80fd\u6307\u5b9a\u4e00\u79cd\u6587\u4ef6\u540d\u901a\u914d\u89c4\u5219\uff0c\u5982\u679c\u8981\u590d\u5408\u5339\u914d\u591a\u4e2a\u89c4\u5219\uff0c\u53ef\u4f7f\u7528\u903b\u8f91\u8fd0\u7b97\u7b26\u3002</p> <p>\u5982\u679c\u60f3\u540c\u65f6\u5339\u914d\u591a\u4e2a\u6761\u4ef6\uff0c\u53ef\u4ee5\u91c7\u7528 AND \u6761\u4ef6\u8fd0\u7b97\u7b26\uff08<code>-and</code> \u6216 <code>-a</code>\uff09\u3002</p> <p>\u591a\u4e2a\u5339\u914d\u6761\u4ef6\u6ca1\u6709\u6307\u5b9a\u903b\u8f91\u8fd0\u7b97\u7b26\u65f6\uff0c\u9ed8\u8ba4\u5c31\u662f\u540c\u65f6\u6ee1\u8db3\uff08AND\uff09\u3002 \u4e00\u822c -type \u548c -name \u9009\u9879\u540c\u65f6\u51fa\u73b0\uff0c\u5c31\u662f\u540c\u65f6\u901a\u914d\u6ee1\u8db3\u7c7b\u578b\u548c\u540d\u79f0\u3002</p> <p>\u5982\u679c\u60f3\u5339\u914d\u591a\u4e2a\u6761\u4ef6\u4e2d\u7684\u4e00\u4e2a\uff0c\u53ef\u4ee5\u91c7\u7528 OR \u6761\u4ef6\u8fd0\u7b97\u7b26\uff08<code>-or</code> \u6216 <code>-o</code>\uff09\uff1a</p> <pre><code>$ ls\nnew.txt some.jpg text.pdf \n$ find . -iname \"*.txt\" -o -iname \"*.pdf\"\n./text.pdf\n./new.txt\n./hello world.txt\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u4f1a\u6253\u5370\u51fa\u6240\u6709\u540e\u7f00\u4e3a .txt \u548c .pdf \u6587\u4ef6\u3002</p> <p>\u5f53\u5e26\u6709\u591a\u4e2a\u540c\u7c7b\u6761\u4ef6\u65f6\uff0c\u4e5f\u53ef\u901a\u8fc7\u62ec\u53f7\u5c06\u540c\u7c7b\u6761\u4ef6\uff08-iname\uff09\u62ec\u8d77\u6765\uff0c\u65b9\u4fbf\u5f52\u62e2\u903b\u8f91\u548c\u63d0\u9ad8\u9605\u8bfb\u4f53\u9a8c\u3002</p> <p><code>\\(</code> \u4ee5\u53ca <code>\\)</code> \u7528\u4e8e\u5c06 <code>-name \"*.txt\" -o -name \"*.pdf</code> \u89c6\u4e3a\u4e00\u4e2a\u903b\u8f91\u6574\u4f53\u3002</p> <pre><code>$ find . \\( -iname \"*.txt\" -o -iname \"*.pdf\" \\)\n</code></pre> <p>\u5f53\u628a find \u7ed3\u679c\u4f20\u7ed9 -exec \u6267\u884c\u6216\u7ba1\u4f20\u7ed9 xargs \u6267\u884c\u65f6\uff0c\u5982\u679c\u4e0d\u52a0\u62ec\u53f7\uff0c\u5219\u5b9e\u9645\u6548\u679c\u770b\u8d77\u6765\u53ea\u4f20\u53c2\u4e86\u5339\u914d -o \u540e\u9762\u7684\u90a3\u4e00\u90e8\u5206\uff01\uff1f</p> <p>\u4ee5\u4e0b\u811a\u672c\u672c\u610f\u662f\u5220\u9664 testDir1 \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u5939 __MACOSX \u548c\u9690\u85cf\u6587\u4ef6 .DS_Store\uff0c\u5b9e\u9645\u53ea\u5220\u9664\u4e86 .DS_Store\uff1a</p> <pre><code>$ find testDir1 -name \"__MACOSX\" -o -name \".DS_Store\" -exec rm -rf {} \\;\n</code></pre> <p>\u6309\u7167\u903b\u8f91\u7ed3\u5408\u4f18\u5148\u7ea7\uff0c\u4ee5\u4e0a\u8868\u8fbe\u5f0f\u7b49\u6548\u4e8e\uff1a</p> <pre><code>$ find testDir1 \\( -name \"__MACOSX\" \\) -o \\( -name \".DS_Store\" -exec rm -rf {} \\; \\)\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-type","title":"-type","text":"<p><code>-type</code> \u9009\u9879\u652f\u6301\u6309\u7167\u6587\u4ef6\u7c7b\u578b\u67e5\u627e\u6587\u4ef6\u3002</p> <pre><code>     -type t\n             True if the file is of the specified type.  Possible file types are as follows:\n\n             b       block special\n             c       character special\n             d       directory\n             f       regular file\n             l       symbolic link\n             p       FIFO\n             s       socket\n</code></pre> <p>\u5f53\u672a\u6307\u5b9a <code>-type</code> \u9009\u9879\u65f6\uff0c\u9ed8\u8ba4\u67e5\u627e\u6240\u6709\u6587\u4ef6\u7c7b\u578b\uff0c\u5305\u62ec\u6587\u4ef6\u5939\u3001\u6587\u4ef6\u548c\u8f6f\u94fe\u7b49\u3002</p> <p>\u4e0a\u9762\u7684\u975e\u540d\u79f0\u5339\u914d\uff08-not -name\uff09\u793a\u4f8b\u4e2d\uff0c\u7b2c\u4e00\u884c\u9ed8\u8ba4\u8f93\u51fa\u5f53\u524d\u76ee\u5f55\uff08.\uff09\uff0c\u56e0\u4e3a\u672a\u6307\u5b9a -type \u3002</p> <pre><code>$ find . ! -name '*.txt'\n# \u660e\u786e\u67e5\u627e\u7c7b\u578b\u4e3a\u6587\u4ef6\n$ find . -type f ! -name '*.txt'\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u901a\u914d\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u540d\u79f0\u4ee5 data \u5f00\u5934\u7684\u6587\u4ef6\u3002</p> <pre><code>$ find . -type f -iname 'data*'\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u5217\u4e3e\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u7684\u5b50\u76ee\u5f55\uff1a</p> <pre><code>$ find . -type d\n# \u8fc7\u6ee4\u6389\u5f53\u524d\u76ee\u5f55dot('.')\n$ find . -type d ! -name '.'\n# \u6216\u8005\n$ find ./* -type d\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u7cbe\u786e\u67e5\u627e\u540d\u4e3a <code>OfflineFile</code> \u7684\u6587\u4ef6\u5939\uff1a</p> <pre><code>$ find . -type d -name 'OfflineFile'\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u7cbe\u786e\u67e5\u627e\u540d\u4e3a <code>libOfflineFile.a</code> \u7684\u6587\u4ef6\uff1a</p> <pre><code>$ find . -type f -name 'libOfflineFile.a'\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u7edf\u8ba1 <code>OfflineFile</code> \u6587\u4ef6\u5939\u4e0b\u6240\u6709\u53ef\u53c2\u4e0e\u7f16\u8bd1\u7684\u6e90\u4ee3\u7801\u6587\u4ef6\uff08Compile Sources\uff09\u6570\u91cf\uff1a</p> <pre><code>$ find OfflineFile -type f \\( -iname \"*.c\" -o -iname \"*.cpp\" -o -iname \"*.m\" -o -iname \"*.mm\" \\) | wc -l\n     273\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#or_1","title":"or","text":"<p><code>-type</code> \u6bcf\u6b21\u53ea\u80fd\u6307\u5b9a\u4e00\u79cd\u7c7b\u578b\uff0c\u5982\u679c\u8981\u590d\u5408\u5339\u914d\u591a\u79cd\u7c7b\u578b\uff0c\u53ef\u4f7f\u7528\u903b\u8f91\u8fd0\u7b97\u7b26\u3002</p> <p>\u5173\u4e8e AND \u6761\u4ef6\u8fd0\u7b97\u7b26\uff08<code>-and</code> \u6216 <code>-a</code>\uff09\u548c OR \u6761\u4ef6\u8fd0\u7b97\u7b26\uff08<code>-or</code> \u6216 <code>-o</code>\uff09\u5177\u4f53\u53c2\u8003 -name \u4e2d\u7684\u9610\u8ff0\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u67e5\u627e\u9879\u76ee\u5de5\u7a0b\u4e2d\u7684\u6587\u4ef6 <code>JceObjectV2.h</code>\uff1a</p> <pre><code>$ find . -type f -name 'JceObjectV2.h'\n./Classes/module/WaterMarkCamera/3rd/WirelessUnifiedProtocol/Serializable/JceObjectV2.h\n./Classes/extern/Analytics/BuglyOA/BuglyCocoa/BuglyCocoa/JceProtocol/CocoaJce/JceObjectV2.h\n./Pods/CocoaJCE/Include/JceObjectV2.h\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u67e5\u627e\u9879\u76ee\u5de5\u7a0b\u4e2d\u7684\u8f6f\u94fe <code>JceObjectV2.h</code>\uff1a</p> <pre><code>$ find . -type l -name 'JceObjectV2.h'\n./Pods/Headers/Public/CocoaJCE/JceObjectV2.h\n./Pods/Headers/Private/CocoaJCE/JceObjectV2.h\n</code></pre> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u7528 <code>-o</code> \u6307\u5b9a\u5e76\u5217\u7684 <code>-type</code> \u7c7b\u578b\u7ea6\u675f\uff1a</p> <p>\u901a\u8fc7\u62ec\u53f7\u5c06\u540c\u7c7b\u6761\u4ef6\uff08-type\uff09\u62ec\u8d77\u6765\uff0c\u65b9\u4fbf\u5f52\u62e2\u903b\u8f91\u548c\u63d0\u9ad8\u9605\u8bfb\u4f53\u9a8c\u3002</p> <pre><code>$ find . -name 'JceObjectV2.h' \\( -type f -o -type l \\)\n./Classes/module/WaterMarkCamera/3rd/WirelessUnifiedProtocol/Serializable/JceObjectV2.h\n./Classes/extern/Analytics/BuglyOA/BuglyCocoa/BuglyCocoa/JceProtocol/CocoaJce/JceObjectV2.h\n./Pods/Headers/Public/CocoaJCE/JceObjectV2.h\n./Pods/Headers/Private/CocoaJCE/JceObjectV2.h\n./Pods/CocoaJCE/Include/JceObjectV2.h\n</code></pre> <p>\u5982\u679c <code>JceObjectV2.h</code> \u5f88\u660e\u786e\u662f\u5934\u6587\u4ef6\uff08\u6216\u8f6f\u94fe\u66ff\u8eab\uff09\uff0c\u4e0d\u53ef\u80fd\u4e3a\u6587\u4ef6\u5939\u7684\u8bdd\uff0c\u4e5f\u53ef\u4e0d\u6307\u5b9a <code>-type</code> \u9009\u9879\uff0c\u67e5\u627e\u9879\u76ee\u5de5\u7a0b\u4e2d\u7684\u6240\u6709\u540d\u4e3a <code>JceObjectV2.h</code> \u7684\u6587\u4ef6\uff1a</p> <pre><code>$ find . -name 'JceObjectV2.h'\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#\u5176\u4ed6\u9009\u9879","title":"\u5176\u4ed6\u9009\u9879","text":"","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-path","title":"-path","text":"<pre><code>     -path pattern\n             True if the pathname being examined matches pattern.  Special shell pattern matching charac-\n             ters (``['', ``]'', ``*'', and ``?'') may be used as part of pattern.  These characters may\n             be matched explicitly by escaping them with a backslash (``\\'').  Slashes (``/'') are treated\n             as normal characters and do not have to be matched explicitly.\n</code></pre> <p>\u9009\u9879 <code>-path</code> \u7684\u53c2\u6570\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\u6765\u5339\u914d\u6587\u4ef6\u8def\u5f84\u3002 <code>-name</code> \u603b\u662f\u7528\u7ed9\u5b9a\u7684\u6587\u4ef6\u540d\u8fdb\u884c\u5339\u914d\uff0c<code>-path</code> \u5219\u5c06\u6587\u4ef6\u8def\u5f84\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u8fdb\u884c\u5339\u914d\u3002\u4f8b\u5982\uff1a</p> <pre><code>$ find /home/users -path \"*/slynux/*\"\n</code></pre> <p>\u53ef\u4ee5\u5339\u914d\u51fa\u4ee5\u4e0b\u8def\u5f84\uff1a</p> <pre><code>/home/users/list/slynux.txt\n/home/users/slynux/eg.css\n</code></pre> <p>shell - How to exclude this / current / dot folder from find \"type d\" - Stack Overflow</p> <p>\u5f53 find -d \u8981\u8fc7\u6ee4\u6389\u5f53\u524d\u76ee\u5f55\uff0c\u9664\u4e86 <code>! -name $targetDir</code> \u540d\u79f0\u6392\u9664\uff0c\u8fd8\u53ef\u4ee5 <code>! -path \"$targetDir\"</code> \u901a\u8fc7\u8def\u5f84\u6392\u9664\u3002</p> <pre><code>targetDir=\"dir_path\"\nfind \"$targetDir\" ! -path \"$targetDir\" -type d\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-user-group","title":"-user/-group","text":"<p>\u6309\u7167\u6587\u4ef6\u5c5e\u4e3b\u3001\u7528\u6237\u7ec4\u6765\u67e5\u627e\u6587\u4ef6\uff0c\u67e5\u627e\u5c5e\u4e8e\u8be5\u7528\u6237\u7684\u6240\u6709\u6587\u4ef6\u3002</p> <pre><code>$ find / -user $USER_ACCOUNT &gt; $REPORT_FILE\n</code></pre> <p>\u67e5\u627e webdav \u76ee\u5f55\u4e0b user \u6216 group \u4e0d\u4e3a <code>_www</code> \u7684\u6587\u4ef6\u3002</p> <pre><code>$ find /usr/local/var/webdav ! -user _www -o ! -group _www\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-size","title":"-size","text":"<p>\u53ef\u4ee5\u6309\u7167\u6587\u4ef6\u957f\u5ea6\u6765\u67e5\u627e\u8fc7\u6ee4\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4ee5\u5757\uff08block\uff09\u4e3a\u8ba1\u91cf\u5355\u4f4d\u3002 \u4e5f\u53ef\u4ee5\u7528\u5b57\u8282\u6765\u8ba1\u91cf\uff0c\u8868\u8fbe\u5f62\u5f0f\u4e3a Nc\u3001Nk\u3001NM\u3001NG\u3002</p> <pre><code>     -size n[ckMGTP]\n             True if the file's size, rounded up, in 512-byte blocks is n.  If n is followed by a c, then\n             the primary is true if the file's size is n bytes (characters).  Similarly if n is followed\n             by a scale indicator then the file's size is compared to n scaled as:\n\n             k       kilobytes (1024 bytes)\n             M       megabytes (1024 kilobytes)\n             G       gigabytes (1024 megabytes)\n             T       terabytes (1024 gigabytes)\n             P       petabytes (1024 terabytes)\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u5728 /home/apache \u76ee\u5f55\u4e0b\u67e5\u627e\u5927\u5c0f\u6070\u597d\u4e3a100\u5b57\u8282\u7684\u6587\u4ef6\uff1a</p> <pre><code>$ find /home/apache -size 100c -print\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u67e5\u627e\u5927\u5c0f\u8d85\u8fc710\u5757\uff085120c\uff09\u7684\u6587\u4ef6\uff1a</p> <pre><code>$ find . -size +10 -print\n# \u5b57\u8282\u8ba1\u91cf\n$ find . -size +5120c\n# kilobytes\u8ba1\u91cf\n$ find . -size +5k\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u67e5\u627e\u5927\u5c0f\u8d85\u8fc71M\u7684\u6587\u4ef6\uff1a</p> <pre><code># \u5b57\u8282\u8ba1\u91cf\n$ find . -size +1048576c -print\n# kilobytes\u8ba1\u91cf\n$ find . -size +1024k -print\n# megabytes\u8ba1\u91cf\n$ find . -size +1M -print\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-regex","title":"-regex","text":"<pre><code># macOS\n     -regex pattern\n             True if the whole path of the file matches pattern using regular expression.  To match a file\n             named ``./foo/xyzzy'', you can use the regular expression ``.*/[xyz]*'' or ``.*/foo/.*'', but\n             not ``xyzzy'' or ``/foo/''.\n# ubuntu\n       -regex pattern\n              File name matches regular expression pattern.  This is a match on the whole path, not a  search.   For\n              example,  to match a file named ./fubar3, you can use the regular expression `.*bar.' or `.*b.*3', but\n              not `f.*r3'.  The regular expressions understood by find are by default Emacs Regular Expressions (ex\u2010\n              cept that `.' matches newline), but this can be changed with the -regextype option.\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-depth","title":"-depth","text":"<p>find \u547d\u4ee4\u5728\u4f7f\u7528\u65f6\u4f1a\u904d\u5386\u6240\u6709\u7684\u5b50\u76ee\u5f55\uff0c\u9996\u5148\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u7136\u540e\u518d\u5728\u5176\u5b50\u76ee\u5f55\u4e2d\u67e5\u627e\u3002</p> <p>\u5982\u679c\u53ea\u9700\u5728\u5f53\u524d\u76ee\u5f55\u4e2d\u8fdb\u884c\u641c\u7d22\uff0c\u65e0\u987b\u7ee7\u7eed\u8fdb\u5165\u5b50\u76ee\u5f55\u6df1\u5ea6\u67e5\u627e\uff0c\u5219\u53ef\u901a\u8fc7\u6307\u5b9a\u6df1\u5ea6\u9009\u9879 <code>-maxdepth</code>/<code>-mindepth</code> \u6765\u9650\u5236 find \u904d\u5386\u67e5\u627e\u7684\u6df1\u5ea6\u3002</p> <ul> <li>\u5982\u679c\u53ea\u5141\u8bb8 find \u5728\u5f53\u524d\u76ee\u5f55\u4e2d\u67e5\u627e\uff0c\u6df1\u5ea6\u53ef\u4ee5\u8bbe\u7f6e\u4e3a1\uff1b  </li> <li>\u5f53\u9700\u8981\u5411\u4e0b\u4e24\u7ea7\u65f6\uff0c\u6df1\u5ea6\u53ef\u4ee5\u8bbe\u7f6e\u4e3a2\uff1b</li> <li>\u5176\u4ed6\u60c5\u51b5\u53ef\u4ee5\u4f9d\u6b21\u7c7b\u63a8\u3002  </li> </ul> <p>\u901a\u8fc7 <code>-maxdepth</code> \u9009\u9879\u53ef\u6307\u5b9a\u6700\u5927\u641c\u7d22\u6df1\u5ea6\u3002 \u4ee5\u4e0b\u793a\u4f8b\u5c06 find \u547d\u4ee4\u7684\u6700\u5927\u641c\u7d22\u6df1\u5ea6\u9650\u5236\u4e3a1\uff1a</p> <pre><code>$ find . -maxdepth 1 -name \"f*\" -print\n</code></pre> <p>\u8be5\u547d\u4ee4\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u540d\u79f0\u4ee5 f \u6253\u5934\u7684\u6587\u4ef6\uff08\u5939\uff09\u3002 <code>-maxdepth 2</code> \u5219\u8868\u793a\u6700\u591a\u5411\u4e0b\u904d\u5386\u4e24\u7ea7\u5b50\u76ee\u5f55\u3002</p> <p>\u901a\u8fc7 <code>-mindepth</code> \u9009\u9879\u5219\u53ef\u7528\u6765\u67e5\u627e\u5e76\u6253\u5370\u90a3\u4e9b\u8ddd\u79bb\u8d77\u59cb\u8def\u5f84\u4e00\u5b9a\u6df1\u5ea6\u7684\u6240\u6709\u6587\u4ef6\u3002 \u5982\u679c\u60f3\u4ece\u7b2c\u4e8c\u7ea7\u76ee\u5f55\u5f00\u59cb\u641c\u7d22\uff0c\u90a3\u4e48\u4f7f\u7528 <code>-mindepth 2</code> \u53ef\u8bbe\u7f6e\u6700\u5c0f\u6df1\u5ea6\u4e3a2\u3002 \u4ee5\u4e0b\u793a\u4f8b\u6253\u5370\u51fa\u6df1\u5ea6\u8ddd\u79bb\u5f53\u524d\u76ee\u5f55\u81f3\u5c11\u4e24\u4e2a\u5b50\u76ee\u5f55\u7684\u6240\u6709\u6587\u4ef6\uff1a</p> <pre><code>$ find . -mindepth 2 -name \"f*\" -print\n</code></pre> <p>\u67e5\u627e\u4e00\u7ea7\u76ee\u5f55\u548c\u4e8c\u7ea7\u76ee\u5f55\u4e0b\u7684 conf \u6587\u4ef6\uff1a</p> <pre><code>$ find / -type f -name \"*.conf\" -not -path \"/etc/fonts/*\" ! -path \"*/tmpfiles.d/*\" -maxdepth 2 2&gt;/dev/null\n</code></pre> <p>\u90e8\u5206\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>/etc/deluser.conf\n/etc/sudo.conf\n/etc/fuse.conf\n/etc/overlayroot.conf\n/etc/host.conf\n/etc/adduser.conf\n/etc/multipath.conf\n/etc/ca-certificates.conf # line\n/etc/sysctl.conf\n/etc/ucf.conf\n</code></pre> <p>\u67e5\u627e\u4e09\u7ea7\u76ee\u5f55\u4e0b\u7684 conf \u6587\u4ef6\uff1a</p> <pre><code>$ find / -type f -name \"*.conf\" -not -path \"/etc/fonts/*\" ! -path \"*/tmpfiles.d/*\" -mindepth 3 -maxdepth 3 2&gt;/dev/null\n</code></pre> <p>\u90e8\u5206\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>/etc/avahi/avahi-daemon.conf\n/etc/ldap/ldap.conf\n/etc/pulse/client.conf\n/etc/dhcp/dhclient.conf\n/etc/ufw/ufw.conf\n/etc/ufw/sysctl.conf\n/etc/systemd/user.conf\n/etc/systemd/resolved.conf\n/etc/systemd/system.conf\n/etc/systemd/sleep.conf\n/etc/systemd/networkd.conf\n/etc/udev/udev.conf\n/etc/PackageKit/Vendor.conf\n/etc/PackageKit/PackageKit.conf\n/etc/lvm/lvm.conf\n</code></pre> <p>\u67e5\u627e\u9650\u5b9a\u56db\u7ea7\u76ee\u5f55\u4e0b\u7684\u90e8\u5206\u7ed3\u679c\uff1a</p> <pre><code>/run/NetworkManager/conf.d/netplan.conf\n/run/systemd/resolve/resolv.conf\n/usr/lib/systemd/resolv.conf\n/usr/share/ufw/ufw.conf\n/usr/share/adduser/adduser.conf\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-prune","title":"-prune","text":"<p>\u4f7f\u7528 <code>-prune</code> \u9009\u9879\u53ef\u4f7f find \u547d\u4ee4\u4e0d\u5728\u5f53\u524d\u6307\u5b9a\u7684\u76ee\u5f55\u4e2d\u67e5\u627e\u3002 \u5982\u679c\u540c\u65f6\u4f7f\u7528\u4e86 <code>-depth</code> \u9009\u9879\uff0c\u90a3\u4e48 <code>-prune</code> \u9009\u9879\u5c06\u88abfind\u547d\u4ee4\u5ffd\u7565\u3002</p> <p>\u5728\u641c\u7d22\u76ee\u5f55\u5e76\u6267\u884c\u67d0\u4e9b\u64cd\u4f5c\u65f6\uff0c\u6709\u65f6\u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd\uff0c\u9700\u8981\u8df3\u8fc7\u4e00\u4e9b\u5b50\u76ee\u5f55\u3002 \u4ee5\u4e0b\u547d\u4ee4\u6253\u5370\u51fa\u4e0d\u5305\u62ec\u5728 <code>.git</code> \u76ee\u5f55\u4e2d\u7684\u6240\u6709\u6587\u4ef6\u7684\u540d\u79f0\uff08\u8def\u5f84\uff09\u3002</p> <pre><code>$ find workspace/project \\( -name \".git\" -prune \\) -o \\( -type f \\)\n</code></pre> <p>\u4ee5\u4e0b\u4e3a find \u7684 man page \u4e2d\u7684\u4e24\u4e2a\u76f8\u5173\u793a\u4f8b\uff1a</p> <pre><code>     find /usr/src -name CVS -prune -o -depth +6 -print\n             Find files and directories that are at least seven levels deep in the working directory\n             /usr/src.\n\n     find /usr/src -name CVS -prune -o -mindepth 7 -print\n             Is not equivalent to the previous example, since -prune is not evaluated below level seven.\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#utility","title":"utility","text":"","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-exec","title":"-exec","text":"<p>find \u6709\u4e00\u4e2a\u9009\u9879 <code>-exec</code>\uff0c\u652f\u6301\u5bf9\u6bcf\u4e2afind\u67e5\u627e\u5230\u7684\u6587\u4ef6\u6267\u884c\u547d\u4ee4\u3002</p> <pre><code>     -exec utility [argument ...] ;\n             True if the program named utility returns a zero value as its exit status.  Optional\n             arguments may be passed to the utility.  The expression must be terminated by a semicolon\n             (``;'').  If you invoke find from a shell you may need to quote the semicolon if the shell\n             would otherwise treat it as a control operator.  If the string ``{}'' appears anywhere in the\n             utility name or the arguments it is replaced by the pathname of the current file.  Utility\n             will be executed from the directory from which find was executed.  Utility and arguments are\n             not subject to the further expansion of shell patterns and constructs.\n\n     -exec utility [argument ...] {} +\n             Same as -exec, except that ``{}'' is replaced with as many pathnames as possible for each\n             invocation of utility.  This behaviour is similar to that of xargs(1).\n</code></pre> <p><code>{}</code> \u8868\u793a\u4e00\u4e2a\u5339\u914d\uff0c\u5bf9\u4e8e\u4efb\u4f55\u5339\u914d\u7684\u6587\u4ef6\u540d\uff0c<code>{}</code> \u5747\u4f1a\u88ab\u8be5\u6587\u4ef6\u540d\u6240\u66ff\u6362\u3002</p> <p>\u4ee5\u4e0b\u5c06 find \u7ed3\u679c\u6267\u884c <code>echo</code> \u6253\u5370\uff1a</p> <pre><code>$ find . -type f -exec echo {} \\;\n</code></pre> <p>\u7ed3\u675f\u5206\u53f7\uff08<code>;</code>\uff09\u5982\u679c\u4e0d\u52a0\u53cd\u659c\u6760\u8f6c\u4e49\u7684\u8bdd\uff0c\u5c06\u4f1a\u62a5\u9519\uff1a</p> <pre><code>$ find . -type f -exec echo {} ;\nfind: -exec: no terminating \";\" or \"+\"\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u5206\u53f7\uff08<code>;</code>\uff09\u9700\u8981\u8f6c\u4e49\u5462\uff1f\u56e0\u4e3a Bash Shell \u4e2d\u4f7f\u7528\u7a7a\u683c\u6216\u5206\u53f7\uff08<code>;</code>\uff09\u8fde\u63a5\u65e0\u76f8\u5173\u6027\u7684\u8fde\u7eed\u547d\u4ee4\uff0c\u5373\u5206\u53f7\u672c\u8eab\u662f\u4e00\u4e2a control operator\u3002  </p> <p>\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e2d\u7684\u6240\u6709\u540d\u4e3a <code>DerivedData</code> \u7684\u6587\u4ef6\u5939\uff0c\u5e76\u6267\u884c <code>du -hs</code> \u7edf\u8ba1\u8f93\u51fa\u5404\u4e2a\u6587\u4ef6\u5939\u7684\u78c1\u76d8\u5360\u7528\u5927\u5c0f\u3002</p> <pre><code>$ find . -type d -name DerivedData -exec du -hs {} \\;\n385M    ./Classes/base/WXBaseUtil/DerivedData\n 22M    ./Frameworks/WX/PublicProtocolFiles/DerivedData\n 17G    ./DerivedData\n</code></pre> <p>\u6392\u9664 <code>./ten/mars</code> \u76ee\u5f55\uff1a</p> <pre><code>$ find . \\( -name ./ten/mars -prune \\) -o \\( -type d -name DerivedData \\) -exec du -hs {} \\;\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u67e5\u627e <code>OfflineFile</code> \u76ee\u5f55\u4e0b\u6240\u6709\u7684 cpp \u6587\u4ef6\uff0c\u5e76\u5c06\u67e5\u627e\u5230\u7684\u6587\u4ef6\u540d\u5b58\u50a8\u5230 <code>all_cpp_files.txt</code> \u4e2d\u3002</p> <pre><code>$ find OfflineFile -type f -iname \"*.cpp\" &gt; all_cpp_files.txt\n</code></pre> <p>\u8fd9\u91cc\u4f7f\u7528 <code>&gt;</code> \u64cd\u4f5c\u7b26\u5c06\u6765\u81ea find \u7684\u6570\u636e\uff08CPP\u4ee3\u7801\uff09\u91cd\u5b9a\u5411\u5230 all_cpp_codes.cpp \u6587\u4ef6\u3002 \u6ca1\u6709\u4f7f\u7528 <code>&gt;&gt;</code>\uff08\u8ffd\u52a0\uff09\u662f\u56e0\u4e3a find \u547d\u4ee4\u7684\u5168\u90e8\u8f93\u51fa\u5c31\u53ea\u6709\u4e00\u4e2a\u6570\u636e\u6d41\uff08stdin\uff09\uff0c\u800c\u53ea\u6709\u5f53\u591a\u4e2a\u6570\u636e\u6d41\u88ab\u8ffd\u52a0\u5230\u5355\u4e2a\u6587\u4ef6\u4e2d\u65f6\u624d\u6709\u5fc5\u8981\u4f7f\u7528 <code>&gt;&gt;</code>\u3002</p> <p>\u82e5\u8981\u5c06\u67e5\u627e\u5230\u7684\u6240\u6709cpp\u6587\u4ef6\u62fc\u63a5\u5199\u5165\u4e00\u4e2a\u6587\u4ef6 <code>all_cpp_codes.cpp</code>\uff0c\u5219\u53ef\u501f\u52a9 <code>-exec cat</code> \u6253\u5f00\u67e5\u770b\u6587\u4ef6\u5185\u5bb9\u5e76\u91cd\u5b9a\u5411\u5b9e\u73b0\u62fc\u63a5\uff1a</p> <pre><code>$ find OfflineFile -type f -iname \"*.cpp\" -exec cat {} \\; &gt; all_cpp_codes.cpp\n</code></pre> <p>\u4e0b\u9762\u5bf9\u67e5\u627e\u5230\u7684\u6240\u6709\u6587\u4ef6\u540d\u4e3a <code>JceObjectV2.h</code> \u7684\u6587\u4ef6\uff08\u5305\u62ec\u8f6f\u94fe\u66ff\u8eab\uff09\uff0c\u8fdb\u4e00\u6b65\u6267\u884c <code>ls -F</code> \u5217\u4e3e\u6253\u5370\u5404\u6587\u4ef6\u5c5e\u6027\uff0c\u4ee5\u4fbf\u533a\u5206\u54ea\u4e9b\u662f\u6587\u4ef6\u54ea\u4e9b\u662f\u8f6f\u94fe\uff1a</p> <pre><code>$ find . -name 'JceObjectV2.h' \\( -type f -o -type l \\) -exec ls -F {} \\;\n./Classes/extern/Analytics/BuglyOA/BuglyCocoa/BuglyCocoa/JceProtocol/CocoaJce/JceObjectV2.h*\n./Classes/module/WaterMarkCamera/3rd/WirelessUnifiedProtocol/Serializable/JceObjectV2.h*\n./Pods/CocoaJCE/Include/JceObjectV2.h*\n./Pods/Headers/Private/CocoaJCE/JceObjectV2.h@\n./Pods/Headers/Public/CocoaJCE/JceObjectV2.h@\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#_1","title":"+","text":"<p>\u6709\u65f6\u5019\u5e76\u4e0d\u5e0c\u671b\u5bf9\u6bcf\u4e2a\u6587\u4ef6\u90fd\u6267\u884c\u4e00\u6b21\u547d\u4ee4\uff0c\u800c\u662f\u5e0c\u671b\u4f7f\u7528\u6587\u4ef6\u5217\u8868\u4f5c\u4e3a\u547d\u4ee4\u53c2\u6570\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5c11\u8fd0\u884c\u51e0\u6b21\u547d\u4ee4\u4e86\u3002 \u6b64\u79cd\u573a\u666f\u4e0b\uff0c\u53ef\u4ee5\u5728 exec \u4e2d\u4f7f\u7528 <code>+</code> \u6765\u4ee3\u66ff <code>;</code> \u8fbe\u5230\u9884\u671f\u6548\u679c\u3002</p> <p>\u4ee5\u4e0bman page\u4e2d\u7684\u793a\u4f8b\u5220\u9664 <code>/usr/ports/packages</code> \u76ee\u5f55\u4e0b\u6240\u6709\u7684\u8f6f\u94fe\uff08\u6e90\u6587\u4ef6\uff09\uff1a</p> <p><code>-L</code> \u66ff\u4ee3\u65e7\u7684 <code>-follow</code>\u3002</p> <pre><code># Delete all broken symbolic links in /usr/ports/packages.\n$ find -L /usr/ports/packages -type l -exec rm -- {} +\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u5927\u5c0f\u8d85\u8fc71M\u7684\u6587\u4ef6\uff0c\u5c06\u7ed3\u679c\u6c47\u805a\u4e3a\u5217\u8868\u4e00\u6b21\u6027\u4f20\u9012\u7ed9 <code>du -csh</code> \u67e5\u770b\u6240\u5360\u78c1\u76d8\u5bb9\u91cf\uff0c\u8fdb\u800c\u7ba1\u4f20\u7ed9 sort \u964d\u5e8f\u6392\u5217\u3002</p> <pre><code>$ find . -size +1M -exec du -csh -- {} + | sort -rh\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c<code>-exec utility [argument ...] ;</code> \u7ed3\u679c\u6b63\u786e\uff0c\u4f46\u662f\u62a5\u9519 No such file or directory\uff1a</p> <pre><code>$ find testDir1 -type d -name \"__MACOSX\" -exec rm -rf {} \\;\n</code></pre> <p>\u6539\u4e3a <code>-exec utility [argument ...] {} +</code> \u683c\u5f0f\uff0c\u5219\u8fd0\u884c\u6b63\u5e38\uff0c\u4e0d\u518d\u62a5\u9519\uff1a</p> <pre><code>$ find testDir1 -type d -name \"__MACOSX\" -exec rm -rf -- {} \\+\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#xargs","title":"xargs","text":"<p>xargs \u548c find \u7b97\u662f\u4e00\u5bf9\u597d\u57fa\u53cb\uff0c\u4e24\u8005\u7ed3\u5408\u4f7f\u7528\u53ef\u4ee5\u8ba9\u4efb\u52a1\u53d8\u5f97\u66f4\u8f7b\u677e\u3002</p> <p>\u4ee5\u4e0b\u662f\u5404\u5927\u5e73\u53f0\u7684 xargs \u5728\u7ebf\u624b\u518c\uff1a</p> <ul> <li>unix/POSIX - xargs </li> <li>FreeBSD/Darwin - xargs </li> <li>linux - xargs(1) </li> <li>debian - xargs(1) </li> <li>ubuntu - xargs(1) </li> </ul> <p>\u4ee5\u4e0b\u662f\u5404\u5927\u5e73\u53f0\u5bf9 xargs \u7684\u5b9a\u4e49\uff1a</p> <ul> <li>unix/POSIX\uff1axargs - construct argument lists and invoke utility  </li> <li>FreeBSD/Darwin\uff1axargs -- construct argument list(s) and execute utility  </li> <li>linux/debian/ubuntu\uff1axargs - build and execute command lines from standard input  </li> </ul>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#usage","title":"usage","text":"<p><code>find -exec utility [argument ...] {} +</code> \u53ef\u4ee5\u6539\u4e3a\u57fa\u4e8e <code>find | xargs</code> \u7684\u7b49\u6548\u5b9e\u73b0\u3002  </p> <p>\u4e0a\u8ff0\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e2d\u7684\u6240\u6709\u540d\u4e3a <code>DerivedData</code> \u7684\u6587\u4ef6\u5939\u5e76\u6267\u884c <code>du -hs</code> \u8f93\u51fa\u5927\u5c0f\u7684\u793a\u4f8b\uff0c\u4e5f\u53ef\u6539\u4e3a\u57fa\u4e8e xargs \u7684\u7b49\u6548\u5b9e\u73b0\u3002</p> <pre><code>$ find . -type d -name DerivedData | xargs du -hs\n</code></pre> <p>\u4e0a\u9762\u67e5\u627e\u62fc\u63a5 all_cpp_codes \u793a\u4f8b\uff0c\u4e5f\u53ef\u501f\u52a9 ls-grep \u53ca xargs \u7b49\u6548\u5b9e\u73b0\uff1a</p> <pre><code># \u9700\u8981\u5148 cd \u5230 OfflineFile \u76ee\u5f55\n# cat \u627e\u5230\u7684\u6240\u6709 cpp \u6587\u4ef6\uff0c\u90fd\u91cd\u5b9a\u5411\u5230 all \u6587\u4ef6\uff0c\u76f8\u5f53\u4e8e\u62fc\u63a5\n$ ls -R | grep '.*\\.cpp$' | xargs cat &gt; all_cpp_codes.cpp\n# or\n$ find OfflineFile -type f -iname \"*.cpp\" | xargs cat &gt; all_cpp_codes.cpp\n</code></pre> <p>\u4e0a\u9762\u67e5\u627e\u6587\u4ef6 <code>JceObjectV2.h</code> \u5e76\u6267\u884c <code>ls -F</code> \u5217\u4e3e\u6587\u4ef6\u7c7b\u578b\u7684 xargs \u7b49\u6548\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code>$ find . -name 'JceObjectV2.h' \\( -type f -o -type l \\) | xargs ls -F\n</code></pre> <p>\u4e0a\u9762\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u5927\u5c0f\u8d85\u8fc71M\u7684\u6587\u4ef6\uff0c\u5e76\u5c06\u6587\u4ef6\u5217\u8868\u7ba1\u4f20 <code>du -csh</code> \u67e5\u770b\u6240\u5360\u78c1\u76d8\u5bb9\u91cf\uff0c\u8fdb\u800c\u7ba1\u4f20\u7ed9 sort \u964d\u5e8f\u6392\u5217\uff0c\u6539\u4e3a\u57fa\u4e8e xargs \u7684\u7b49\u6548\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code># \u6ce8\u610f\uff1a\u5982\u679c\u6587\u4ef6\u8def\u5f84\u4e2d\u5b50\u76ee\u5f55\u5b58\u5728\u7a7a\u683c\uff0c\u4f8b\u5982 Visual Studio\uff0c\u5219\u4f1a\u62a5\u9519\uff01\n$ find . -size +1M | xargs du -csh | sort -rh\n</code></pre> <p>\u4e0a\u9762\u7edf\u8ba1\u8fc7 <code>OfflineFile</code> \u6587\u4ef6\u5939\u4e0b\u6240\u6709\u53c2\u4e0e\u7f16\u8bd1\u7684\u6587\u4ef6\uff08Compile Sources\uff09\u6570\u91cf\u3002 \u8fdb\u4e00\u6b65\u601d\u8003\uff0c\u5982\u4f55\u7edf\u8ba1\u8be5\u5b50\u5de5\u7a0b\u76ee\u5f55\u4e0b\u6240\u6709\u53c2\u4e0e\u7f16\u8bd1\u7684\u4ee3\u7801\u6587\u4ef6\u7684\u4ee3\u7801\u884c\u6570\u5462\uff1f \u501f\u52a9 <code>xargs</code> \u5bf9\u6bcf\u4e2a\u6587\u4ef6\u6267\u884c <code>wc -l</code> \u884c\u6570\u7edf\u8ba1\u5373\u53ef\u3002</p> <pre><code>$ find OfflineFile -type f \\( -iname \"*.c\" -o -iname \"*.cpp\" -o -iname \"*.m\" -o -iname \"*.mm\" \\) -print0 | xargs -0 wc -l\n\n   98021 total\n</code></pre> <p>\u5f53\u7136\uff0c\u4ee5\u4e0a\u7edf\u8ba1\u4ee3\u7801\u884c\u6570\uff0c\u5305\u62ec\u4e86\u6ce8\u91ca\u548c\u7a7a\u884c\u90e8\u5206\uff0c\u66f4\u4e13\u4e1a\u7684\u7edf\u8ba1\u5de5\u5177\u53c2\u8003 SLOCCount \u548c cloc\u3002</p>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-t","title":"-t","text":"<p>xargs \u7684 <code>-t</code> \u9009\u9879\u5141\u8bb8\u6bcf\u6b21\u6267\u884c xargs \u540e\u9762\u7684\u547d\u4ee4\u4e4b\u524d\uff0c\u5148\u5728 stderr \u4e0a\u6253\u5370\u51fa\u6269\u5c55\u5f00\u7684\u771f\u5b9e\u547d\u4ee4\u3002</p> <pre><code>$ find . -type d -iname \"xcuserdata\" | xargs -t rm -rf\nrm -rf ./EmptyApplication.xcodeproj/xcuserdata ./EmptyApplication.xcodeproj/project.xcworkspace/xcuserdata\n\n$ find . -type f -name \"*.txt\" | xargs -t ls -1lhFA\nls -1lhFA ./detail2.txt ./detail.txt ./data0.txt ./data1.txt ./data3.txt ./data2.txt ./data6.txt ./data.txt\n...\n</code></pre> <p>\u4ee5\u4e0a -t \u8c03\u8bd5\u8f93\u51fa\uff0c\u4e5f\u9a8c\u8bc1\u4e86 xargs \u540c <code>find -exec utility [argument ...] {} +</code> \u7684\u7b49\u6548\u6027\u3002</p>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#-0","title":"-0","text":"<p>xargs \u9ed8\u8ba4\u662f\u4ee5\u7a7a\u767d\u5b57\u5143\u4f5c\u4e3a\u5206\u5272\u7b26\uff0c\u5982\u679c\u6709\u4e00\u4e9b\u6863\u540d\u6216\u8005\u662f\u5176\u4ed6\u610f\u4e49\u7684\u540d\u8bcd\u5185\u542b\u6709\u7a7a\u767d\u5b57\u5143\u7684\u65f6\u5019\uff0cxargs \u53ef\u80fd\u4f1a\u8bef\u5224\u5206\u5272\u5bfc\u81f4\u53c2\u6570\u9519\u8bef\u3002</p> <p>linux \u4e0b\u652f\u6301 <code>-d delim</code> \u9009\u9879\uff0cmacOS Shell \u4e0d\u652f\u6301\u3002</p> <p>\u6211\u4eec\u6ca1\u6cd5\u9884\u6d4b\u5206\u9694 find \u547d\u4ee4\u8f93\u51fa\u7ed3\u679c\u7684\u5b9a\u754c\u7b26\u7a76\u7adf\u662f\u4ec0\u4e48\uff08<code>\\n</code> \u6216\u8005\u7a7a\u683c\uff09\u3002 \u5f88\u591a\u6587\u4ef6\u540d\u4e2d\u90fd\u53ef\u80fd\u4f1a\u5305\u542b\u7a7a\u683c\u7b26\uff08' '\uff09\uff0c\u56e0\u6b64 xargs \u5f88\u53ef\u80fd\u4f1a\u8bef\u8ba4\u4e3a\u5b83\u4eec\u662f\u5b9a\u754c\u7b26\u3002</p> <p>\u5f53\u524d\u76ee\u5f55\u4e0b\u67093\u4e2a\u6587\u4ef6\uff0c\u5176\u4e2d <code>hello world.txt</code> \u6587\u4ef6\u540d\u5305\u542b\u7a7a\u683c\uff1a</p> <pre><code>$ ls -1\nhello\nhello world.txt\nworld.TXT\n\n$ tree -L 1\n.\n\u251c\u2500\u2500 hello\n\u251c\u2500\u2500 hello\\ world.txt\n\u2514\u2500\u2500 world.TXT\n</code></pre> <p>\u5c06 ls \u7ed3\u679c\u91cd\u5b9a\u5411\u7ed9 xargs \u8fdb\u884c echo \u56de\u663e\uff0c\u6307\u5b9a <code>-n 1</code> \u6bcf\u6b21\u53d61\u4e2a\u53c2\u6570\uff1a</p> <pre><code>$ ls | xargs -n 1\nhello\nhello\nworld.txt\nworld.TXT\n</code></pre> <p>\u7b2c2\u4e2a\u6587\u4ef6\u540d <code>hello world.txt</code> \u5305\u542b\u7a7a\u683c\uff0c\u88ab\u7a7a\u683c\u9519\u8bef\u5730\u5206\u5272\u4e3a\u4e24\u4e2a\u6587\u4ef6\u53c2\u6570\u3002 \u4e3a xargs \u6dfb\u52a0 <code>-0</code> \u53c2\u6570\uff0c\u6307\u5b9a NUL \u5b57\u7b26\uff08<code>\\0</code>\uff09\u4f5c\u4e3a\u5206\u9694\u7b26\uff0c\u5219\u8f93\u51fa\u7b26\u5408\u9884\u671f\u3002  </p> <pre><code>$ ls | xargs -0 -n 1\nhello\nhello world.txt\nworld.TXT\n</code></pre> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u7ed3\u5408\u4e00\u4e2a\u5177\u4f53\u7684\u4f8b\u5b50\uff0c\u6765\u5206\u6790\u4e00\u4e0b <code>-0</code> \u9009\u9879\u7684\u4f5c\u7528\u3002 \u5047\u8bbetestDir\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff0c\u5176\u4e2d\u90e8\u5206\u5b50\u76ee\u540d\u79f0\u4e2d\u5e26\u6709\u7a7a\u683c\uff1a</p> <pre><code>$ tree -a\n.\n\u251c\u2500\u2500 testDir1\n\u251c\u2500\u2500 testDir2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 testDir 21\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 testDir211\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 .DS_Store\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 testDir212\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 __MACOSX\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 testDir213\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 testDir23\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 hello world.txt\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 test.txt\n\u2514\u2500\u2500 testDir3\n    \u251c\u2500\u2500 testDir 31\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 .DS_Store\n    \u251c\u2500\u2500 testDir 32\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 testDir321\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 __MACOSX\n    \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 .DS_Store\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 testDir323\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 testDir3231\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 testDir3232\n    \u2514\u2500\u2500 testDir33\n</code></pre> <p>\u5c1d\u8bd5\u6267\u884c find | xargs\uff0c\u7a7a\u683c\u88ab\u622a\u65ad\u5e76\u62a5\u9519 No such file or directory\uff1a</p> <pre><code>$ find . -type f -name \".DS_Store\" | xargs -t ls -1\nls -1 ./testDir3/testDir 32/testDir322/.DS_Store ./testDir3/testDir 31/.DS_Store ./testDir2/testDir 21/testDir211/.DS_Store\nls: ./testDir2/testDir: No such file or directory\nls: ./testDir3/testDir: No such file or directory\nls: ./testDir3/testDir: No such file or directory\nls: 21/testDir211/.DS_Store: No such file or directory\nls: 31/.DS_Store: No such file or directory\nls: 32/testDir322/.DS_Store: No such file or directory\n</code></pre> <p>\u4ece xargs -t \u7684\u8c03\u8bd5\u8f93\u51fa\u770b\uff0cls \u540e\u9762\u7684\u53c2\u6570\u4e2d\u7a7a\u683c\u6ca1\u6709\u8f6c\u4e49\uff0c\u5bfc\u81f4\u88ab\u9519\u8bef\u5207\u5272\u6210\u4e86\u591a\u4e2a\u53c2\u6570\u3002</p> <p>find \u547d\u4ee4\u9ed8\u8ba4\u5bf9\u5339\u914d\u7ed3\u679c\u6267\u884c\u6253\u5370\u64cd\u4f5c\uff08<code>-print</code>\uff09\uff0c\u4ee5\u6362\u884c\u7b26 <code>\\n</code> \u4f5c\u4e3a\u5206\u9694\u7b26\u5bf9\u8f93\u51fa\u7684\u7ed3\u679c\u884c\uff08\u6761\u76ee\uff09\u8fdb\u884c\u5206\u9694\u3002</p> <pre><code>$ find . -type f -name \".DS_Store\"\n./testDir3/testDir 32/testDir322/.DS_Store\n./testDir3/testDir 31/.DS_Store\n./testDir2/testDir 21/testDir211/.DS_Store\n</code></pre> <p>\u6539\u4e3a <code>-print0</code> \u6307\u660e\u4f7f\u7528 <code>\\0</code> \u4f5c\u4e3a\u8f93\u51fa\u7ed3\u679c\u5206\u9694\u7b26\uff0c\u5219\u8f93\u51fa\u770b\u8d77\u6765\u662f\u4e00\u884c\uff0c\u5b9e\u9645\u4e0a\u6bcf\u4e2a .DS_Store \u540e\u6709\u4e00\u4e2a\u5b57\u7b26 NUL\uff08<code>\\0</code>\uff09\u3002</p> <pre><code>$ find . -type f -name \".DS_Store\" -print0\n./testDir3/testDir 32/testDir322/.DS_Store./testDir3/testDir 31/.DS_Store./testDir2/testDir 21/testDir211/.DS_Store%\n</code></pre> <p>\u6b64\u65f6\uff0c\u518d\u8fdb\u4e00\u6b65\u7ba1\u4f20\u7ed9 xargs\uff0c\u7ed3\u5408-t\u8c03\u8bd5\u8f93\u51fa\uff0c\u5206\u6790\u5982\u4e0b\uff1a</p> <ol> <li> <p>xargs \u63a5\u53d7\u5230\u7684\u53c2\u6570\u6309\u7167\u7a7a\u767d\u5b57\u5143\u5207\u5272\u5e94\u8be5\u4e3a\u56db\u6bb5\uff1a</p> <ul> <li>./testDir3/testDir  </li> <li>32/testDir322/.DS_Store./testDir3/testDir  </li> <li>31/.DS_Store./testDir2/testDir  </li> <li>21/testDir211/.DS_Store  </li> </ul> </li> <li> <p>\u7531\u4e8e\u6bcf\u4e2a.DS_Store\u540e\u9762\u9690\u85cf\u4e86\u4e00\u4e2aNUL\u5b57\u7b26\uff08<code>\\0</code>\uff09\uff0cls\u518d\u6309\u7167C\u8bed\u8a00\u6790\u53d6\u5b57\u7b26\u4e32\u53c2\u6570\u65f6\u4f1a\u622a\u65ad\uff1a</p> <ul> <li>./testDir3/testDir  </li> <li>32/testDir322/.DS_Store  </li> <li>31/.DS_Store  </li> <li>21/testDir211/.DS_Store  </li> </ul> </li> </ol> <pre><code>$ find . -type f -name \".DS_Store\" -print0 | xargs -t ls -1\nls -1 ./testDir3/testDir 32/testDir322/.DS_Store 31/.DS_Store 21/testDir211/.DS_Store\nls: ./testDir3/testDir: No such file or directory\nls: 21/testDir211/.DS_Store: No such file or directory\nls: 31/.DS_Store: No such file or directory\nls: 32/testDir322/.DS_Store: No such file or directory\n</code></pre> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u7ed9 xargs \u52a0\u4e0a -0 \u9009\u9879\uff0c\u6309\u7167 find -print0 \u4e00\u81f4\u7684\u5207\u5272\u65b9\u5f0f\u8bfb\u53d6\u7ba1\u4f20\u53c2\u6570\uff0c\u5219\u7b26\u5408\u9884\u671f\uff1a</p> <pre><code>$ find . -type f -name \".DS_Store\" -print0 | xargs -t0 ls -1\nls -1 ./testDir3/testDir 32/testDir322/.DS_Store ./testDir3/testDir 31/.DS_Store ./testDir2/testDir 21/testDir211/.DS_Store\n./testDir2/testDir 21/testDir211/.DS_Store\n./testDir3/testDir 31/.DS_Store\n./testDir3/testDir 32/testDir322/.DS_Store\n</code></pre> <p>\u4e4b\u524d\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u6587\u4ef6\u8def\u5f84\u4e2d\u5b50\u76ee\u5f55\u5b58\u5728\u7a7a\u683c\uff08\u4f8b\u5982 Visual Studio\uff09\uff0c\u90fd\u4f1a\u62a5\u9519\uff01</p> <pre><code>$ find . -type f -name \"*.txt\" | xargs rm -f\n$ find . -size +1M | xargs du -csh | sort -rh\n</code></pre> <p><code>find -print0</code> \u642d\u914d <code>xargs -0</code> \u4f7f\u7528\uff0c\u5219\u53ef\u5b89\u5168\u5904\u7406\u53ef\u80fd\u5305\u542b\u7a7a\u683c\u5bfc\u81f4\u7684\u8def\u5f84\u95ee\u9898\uff1a</p> <pre><code>$ find . -type f -name \"*.txt\" -print0 | xargs -0 rm -f\n$ find . -type f -size +1M -print0 | xargs -0 du -csh | sort -rh\n</code></pre> <p>\u4e3a\u5b89\u5168\u8d77\u89c1\uff0c\u5efa\u8bae\u540e\u7eed\u90fd\u914d\u5957\u91c7\u7528 <code>find -print0 | xargs -0</code> \u89e3\u6790\u6a21\u5f0f\u3002</p>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#demos","title":"demos","text":"","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#exclude_dir","title":"exclude dir","text":"<p>\u9700\u6c42\uff1afind \u67e5\u627e / \u56db\u7ea7\u4ee5\u5185\u76ee\u5f55\u4e0b\u7684\u7684\u6240\u6709 conf \u6587\u4ef6\uff0c\u6392\u9664 /etc/fonts/ \u548c\u8def\u5f84\u5305\u542b tmpfiles.d \u7684\u76ee\u5f55\uff0c\u5982\u4e0b\uff1a</p> <ul> <li>./etc/fonts/  </li> <li>./etc/tmpfiles.d/  </li> <li>./usr/lib/tmpfiles.d/  </li> </ul> <p>Exclude Certain Paths With the find Command </p> <pre><code># 2. Using the -prune Option\n$ find . \\( -path ./jpeg -prune -o -path ./mp3 -prune \\) -o -print\n# 3,4. Using the -not/! Operator; \n$ find . -type f -not -path '*/mp3/*'\n</code></pre> <p>Find command Exclude or Ignore Files (e.g. Ignore All Hidden .dot Files ) </p> <pre><code># find all *.txt files in the current directory but exclude ./Movies/, ./Downloads/, and ./Music/ folders:\n$ find . -type f -name \"*.txt\" ! -path \"./Movies/*\" ! -path \"./Downloads/*\" ! -path \"./Music/*\" \n</code></pre> <p>\u5b9e\u6d4b\uff1a</p> <pre><code># \u4ec5\u5ffd\u7565\u4e86 /etc/fonts/*/*\uff0c\u8fd8\u662f\u6253\u5370 /etc/fonts/conf.avail,/etc/fonts/fonts.conf,/etc/fonts/conf.d\n$ find / \\( -path \"/etc/fonts/*\" -prune -o -path \"*/tmpfiles.d/*\" -prune \\) -o -name \"*.conf\" -maxdepth 4\n$ find / -type d \\( -path \"/etc/fonts/*\" -o -path \"*/tmpfiles.d/*\" \\) -prune -o -name \"*.conf\" -maxdepth 4\n# \u627e\u5230\u4e86\u8def\u5f84\u5339\u914d\u4e86\u4e24\u4e2a\u76ee\u5f55\uff0c\u4e14\u540e\u7f00\u4e3aconf\u7684\u6587\u4ef6\uff0c\u4e0e\u9884\u671f\u76f8\u53cd\u7684\u7ed3\u679c\n$ find / \\( -path \"/etc/fonts/*\" -prune -o -path \"*/tmpfiles.d/*\" -prune \\) -name \"*.conf\" -maxdepth 4\n$ find / \\( -path \"/etc/fonts/*\" -o -path \"*/tmpfiles.d/*\" \\) -prune -name \"*.conf\" -maxdepth 4\n# \u7b26\u5408\u9884\u671f\uff01\n$ find / -type f -name \"*.conf\" -not -path \"/etc/fonts/*\" ! -path \"*/tmpfiles.d/*\" -maxdepth 4\n</code></pre> <p>How to exclude a directory in find . command </p> <p>https://stackoverflow.com/a/15736463</p> <p>If -prune doesn't work for you, this will:</p> <pre><code>$ find -name \"*.js\" -not -path \"./directory/*\"\n</code></pre> <p>https://stackoverflow.com/a/4210072</p> <pre><code># Use the -prune primary. For example, if you want to exclude ./misc:\n$ find . -path ./misc -prune -o -name '*.txt' -print\n\n# To exclude multiple directories, OR them between parentheses.\n$ find . -type d \\( -path ./dir1 -o -path ./dir2 -o -path ./dir3 \\) -prune -o -name '*.txt' -print\n\n# And, to exclude directories with a specific name at any level, use the -name primary instead of -path.\n$ find . -type d -name node_modules -prune -o -name '*.json' -print\n\n# From ~/ on my macOS cleans it up nicely ?\n$ find . -type d \\( -path \"./Library/*\" -o -path \"./.Trash\" \\) -prune -o -name '.DS_Store' -print0 | xargs -0 rm\n</code></pre> <p>https://stackoverflow.com/a/16595367</p> <pre><code># I find the following easier to reason about than other proposed solutions:\n$ find build -not \\( -path build/external -prune \\) -name \\*.js\n# you can also exclude multiple paths\n$ find build -not \\( -path build/external -prune \\) -not \\( -path build/blog -prune \\) -name \\*.js\n</code></pre> <p>https://stackoverflow.com/a/4210234</p> <p>I prefer the -not notation ... it's more readable:</p> <pre><code>$ find . -name '*.js' -and -not -path directory\n</code></pre> <p>https://stackoverflow.com/a/49296451</p> <p>This is the only one that worked for me.</p> <pre><code># Searching for \"MyFile\" excluding \"Directory\".\n# Give emphasis to the stars * .\n# works on macOS\n$ find / -name MyFile ! -path '*/Directory/*'\n# locate native package.json\n$ find . -name package.json ! -path '*/node_modules/*'\n</code></pre> <p>\u53e6\u5916\uff0cfind / \u8fd8\u4f1a\u6709\u5927\u91cf\u8bbf\u95ee\u6743\u9650\u53d7\u9650\u7684\u9519\u8bef\u63d0\u793a\uff1a<code>find: \u2018/lost+found\u2019: Permission denied</code>\u3002</p> <p>How can I exclude all \"permission denied\" messages from \"find\"?</p> <p>\u6240\u4ee5\u6700\u7ec8\u7684\u7b54\u6848\u5982\u4e0b\uff1a</p> <pre><code>$ find / -type f -name \"*.conf\" -not -path \"/etc/fonts/*\" ! -path \"*/tmpfiles.d/*\" -maxdepth 4 2&gt;/dev/null\n$ find / -not \\( -path \"/etc/fonts/*\" -prune \\) -not \\( -path \"*/tmpfiles.d/*\" -prune \\) -name \"*.conf\" -maxdepth 4 2&gt;/dev/null\n$ find nodejs/src -type f -iname \"*banner.vue\" -not -path \"nodejs/src/node_modules/*\" -not -path \"nodejs/src/dist/*\" 2&gt;/dev/null\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#delete_file","title":"delete file","text":"<p><code>-delete</code> \u64cd\u4f5c\u53ef\u4ee5\u7528\u6765\u5220\u9664 find \u5339\u914d\u51fa\u6765\u7684\u7ed3\u679c\u6587\u4ef6\uff08\u5939\uff09\u3002</p> <p>\u9012\u5f52\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u7684 <code>.o</code>/<code>.DS_Store</code> \u6587\u4ef6\uff0c\u7136\u540e\u6267\u884c <code>-delete</code> \u5220\u9664\u64cd\u4f5c\u3002</p> <pre><code># \u672b\u5c3e\u53ef\u8ffd\u52a0 -print \u6253\u5370\u5220\u9664\u7684\u6587\u4ef6\n$ find . -name \"*.o\" -delete\n$ find . -type f -name \".DS_Store\" -delete\n</code></pre> <p>\u9ed8\u8ba4\u6267\u884c <code>-print</code> \u6253\u5370\u67e5\u627e\u7ed3\u679c\uff1b \u53ef\u663e\u5f0f\u6307\u5b9a <code>-type f</code> \u53ea\u67e5\u627e\u6587\u4ef6\u7c7b\u578b\uff1b  </p> <p>\u8fd8\u53ef\u9488\u5bf9\u7ed3\u679c\u6267\u884c <code>-exec rm</code> \u6216\u91cd\u5b9a\u5411\u7ed9 xargs \u4f5c\u4e3a\u53c2\u6570\u6267\u884c <code>rm</code> \u547d\u4ee4\u3002 \u4ee5\u4e0b\u793a\u4f8b\u6e05\u9664 macOS \u6587\u4ef6\u5939\u4e0b\u81ea\u52a8\u751f\u6210\u7684 <code>.DS_Store</code> \u6587\u4ef6\uff1a</p> <pre><code># \u8fd0\u884c\u6b63\u5e38\uff08\u672b\u5c3e\u53ef\u8ffd\u52a0 -print \u6253\u5370\u5220\u9664\u7684\u6587\u4ef6\uff09\nfind testDir1 -name \".DS_Store\" -exec rm -rf {} \\;\n# \u8fd0\u884c\u6b63\u5e38\uff08\u672b\u5c3e\u53ef\u8ffd\u52a0 -print \u6253\u5370\u5220\u9664\u7684\u6587\u4ef6\uff09\nfind testDir1 -name \".DS_Store\" -exec rm -rf -- {} \\+\n# \u8fd0\u884c\u6b63\u5e38\nfind testDir1 -name \".DS_Store\" -print0 | xargs -0 rm -rf\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u6e05\u9664 visual studio \u5de5\u7a0b sln/vcproj \u4e0b\u7684 <code>*.user</code> \u6587\u4ef6\uff1a</p> <pre><code># delete file: *.user\necho \"delete files: *.user\"\n#find . -name \"*.user\" -delete\n#find . -name \"*.user\" -exec rm {} \\;\nfind . -name \"*.user\" -print0 | xargs -0 rm -f\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#delete_folder","title":"delete folder","text":"<p>\u4e00\u822c git \u4ed3\u5e93\u7684\u4f1a\u914d\u7f6e\u5ffd\u7565\u4e00\u4e9b\u4e34\u65f6\u76ee\u5f55\u6216\u6587\u4ef6\uff0c\u4f8b\u5982 __MACOSX\u3001.DS_Store \u7b49\u3002 find \u67e5\u627e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u6240\u6709\u7684 <code>__MACOSX</code> \u76ee\u5f55\uff0c\u7136\u540e\u901a\u8fc7 <code>-delete</code> \u5220\u9664\u4e4b\u3002</p> <p>\u4f46\u662f\uff0c-delete \u5220\u9664\u76ee\u5f55\u65f6\u5e95\u5c42\u8c03\u7528\u7684\u5e94\u8be5\u662f rmdir\uff0c\u53ea\u80fd\u5220\u9664\u7a7a\u76ee\u5f55\uff0c\u65e0\u6cd5\u5220\u9664\u975e\u7a7a\u76ee\u5f55\u3002 \u6b64\u65f6\uff0c\u53ef\u8003\u8651\u5c06 find \u7ed3\u679c\u7ba1\u4f20\u7ed9 xargs \u4f5c\u4e3a\u53c2\u6570\u8fdb\u4e00\u6b65\u4f20\u9012\u7ed9 <code>rm -rf</code> \u6267\u884c\u9012\u5f52\u5220\u9664\u3002</p> <pre><code># \u7ed3\u679c\u6b63\u786e\uff0c\u62a5\u9519 No such file or directory\n$ find testDir1 -type d -name \"__MACOSX\" -exec rm -rf {} \\;\n# \u8fd0\u884c\u6b63\u5e38\uff08\u672b\u5c3e\u53ef\u8ffd\u52a0 -print \u6253\u5370\u5220\u9664\u7684\u6587\u4ef6\u5939\uff09\n$ find testDir1 -type d -name \"__MACOSX\" -exec rm -rf -- {} \\+\n# \u8fd0\u884c\u6b63\u5e38\n$ find testDir1 -type d -name \"__MACOSX\" -print0 | xargs -0 rm -rf\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 __MACOSX \u5b50\u76ee\u5f55\u548c\u9690\u85cf\u6587\u4ef6 .DS_Store\uff0c\u5e76\u4e88\u4ee5\u5220\u9664\uff1a</p> <p>\u6ce8\u610f\uff1a\u4e00\u5b9a\u8981\u6dfb\u52a0\u62ec\u53f7\u8868\u8fbe\u5f0f\uff0c\u5426\u5219 -o \u540e\u9762\u90e8\u5206\u8fdb\u884c\u4e86\u903b\u8f91\u7ed3\u5408\uff0c\u8fd0\u884c\u7ed3\u679c\u975e\u9884\u671f\uff01</p> <pre><code># \u7ed3\u679c\u6b63\u786e\uff0c\u62a5\u9519 No such file or directory\n$ find testDir1 \\( -name \"__MACOSX\" -o -name \".DS_Store\" \\) -exec rm -rf {} \\;\n# \u8fd0\u884c\u6b63\u5e38\uff08\u672b\u5c3e\u53ef\u8ffd\u52a0 -print \u6253\u5370\u5220\u9664\u7684\u6587\u4ef6\u5939\uff09\n$ find testDir1 \\( -name \"__MACOSX\" -o -name \".DS_Store\" \\) -exec rm -rf -- {} \\+\n# \u8fd0\u884c\u6b63\u5e38\n$ find testDir1 \\( -name \"__MACOSX\" -o -name \".DS_Store\" \\) -print0 | xargs -0 rm -rf\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u6e05\u9664\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5939\uff08rm -rf\u9012\u5f52\u5f3a\u5236\u5220\u9664\uff09\uff1a</p> <pre><code>find \"$targetDir\"  -maxdepth 1 ! -path \"$targetDir\" -type d -print0 | xargs -0 rm -rf\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u6e05\u9664 visual studio \u5de5\u7a0b sln/vcproj \u4e0b\u7f16\u8bd1\u751f\u6210\u7684 <code>Debug</code> \u6587\u4ef6\u5939\uff1a</p> <pre><code># delete folder: Debug\necho \"delete folder: Debug\"\nfind . -type d -iname \"debug\" -print0 | xargs -0 rm -rf\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u6e05\u9664 xcodeproj \u76ee\u5f55\u4e0b\u7684 <code>xcuserdata</code> \u6587\u4ef6\u5939\uff1a</p> <pre><code># delete folder: xcuserdata\necho \"delete folder: xcuserdata\"\nfind . -type d -iname \"xcuserdata\" -print0 | xargs -0 rm -rf\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u6e05\u9664 python \u8fd0\u884c\u8fc7\u7a0b\u4e2d\u751f\u6210\u7684 <code>__pycache__</code> \u6587\u4ef6\u5939\uff1a</p> <pre><code># delete folder: __pycache__\necho \"delete folder: __pycache__\"\nfind . -type d -iname \"__pycache__\" -print0 | xargs -0 rm -rf\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#format_files","title":"format files","text":"<p><code>clang-format</code> \u8c8c\u4f3c\u53ea\u63a5\u53d7\u5355\u4e2a\u6587\u4ef6\u8def\u5f84\u4f5c\u4e3a\u683c\u5f0f\u5316\u76ee\u6807\u53c2\u6570\u3002</p> <pre><code>$ cd ~/Projects/mars\n$ clang-format -style=file -i mars/comm/messagequeue/message_queue.cc\n</code></pre> <p>\u5982\u679c\u60f3\u6279\u91cf\u683c\u5f0f\u5316\u67d0\u4e2a\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u4ee3\u7801\u6587\u4ef6\uff0c\u53ef\u4ee5\u5728\u7ec8\u7aef\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ # \u8bbe\u7f6e\u8981\u683c\u5f0f\u5316\u7684\u5b50\u76ee\u5f55\n$ subdir=\"mars/comm/messagequeue/\"\n</code></pre> <p>find \u9012\u5f52\u67e5\u627e\u5e76 more \u6eda\u52a8\u9884\u89c8\u6216\u7edf\u8ba1 subdir \u4e0b\u5c06\u8981\u683c\u5f0f\u5316\u7684\u4ee3\u7801\u6587\u4ef6\uff1a</p> <pre><code># \u6216\u7ba1\u4f20 | wc -l \u7edf\u8ba1\u6570\u91cf\n$ find $subdir -type f \\( -iname \"*.h\" -iname \"*.hpp\" -iname \"*.c\" -o -iname \"*.cpp\" -o -iname \"*.m\" -o -iname \"*.mm\" \\) | more\n</code></pre> <p>\u5c06 find \u7ed3\u679c\u91cd\u5b9a\u5411\u7ed9 xargs \u4f20\u53c2\u7ed9 clang-format \u6267\u884c\u683c\u5f0f\u5316\uff1a</p> <pre><code>$ find $subdir -type f \\( -iname \"*.h\" -iname \"*.hpp\" -iname \"*.c\" -o -iname \"*.cpp\" -o -iname \"*.m\" -o -iname \"*.mm\" \\) -print0 | xargs -0 clang-format --verbose -style=file -i\n</code></pre> <p>find \u7684 path \u53c2\u6570\u53ef\u63a5\u53d7\u591a\u4e2a\u76ee\u5f55\uff1a</p> <pre><code>$ subdir1=\"mars/comm/messagequeue/\"\n$ subdir2=\"mars/comm/coroutine/\"\n$ find $subdir1 $subdir2 -type f \\( -iname \"*.h\" -iname \"*.hpp\" -iname \"*.c\" -o -iname \"*.cpp\" -o -iname \"*.m\" -o -iname \"*.mm\" \\) -print0 | xargs -0 clang-format --verbose -style=file -i\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#copy_files","title":"copy files","text":"<p>\u4e0b\u9762\u793a\u4f8b\u5c06\u6240\u6709\u7684.mp3\u6587\u4ef6\u79fb\u5165\u76ee\u5f55 targetDir\uff1a</p> <pre><code>$ find $dirPath -type f -name \"*.mp3\" -exec mv {} $targetDir \\;\n</code></pre> <p>\u4e0b\u9762\u793a\u4f8b\u5c0610\u5929\u524d\u7684.txt\u6587\u4ef6\u5907\u4efd\u5230\u76ee\u5f55 targetDir\uff1a</p> <pre><code>$ find $dirPath -type f -mtime +10 -name \"*.txt\" -exec cp {} $targetDir \\;\n</code></pre> <p>\u8003\u8651\u8fd9\u4e48\u4e00\u4e2a\u9700\u6c42\u573a\u666f\uff1a\u5728Xcode\u5de5\u7a0b\u7684\u6784\u5efa\u76ee\u5f55\u4e0b\uff0c\u67e5\u627e\u6240\u6709\u6587\u4ef6\u5939\u4e0b\u7684 <code>.d</code> \u6587\u4ef6\uff0c\u7136\u540e\u62f7\u8d1d\u5230 <code>~/Downloads/dependencies</code> \u76ee\u5f55\u4e0b\u3002</p> <p>\u9664\u4e86\u4e0a\u9762\u7684 find -exec \u5b9e\u73b0\u65b9\u6848\u5916\uff0c\u57fa\u4e8ewhile\u5faa\u73af\u7684\u5b50shell\u7684\u8868\u8fbe\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code>$ cd DerivedData/Mars/Build/Intermediates.noindex\n$ find . -type f -name \"*.d\" | (while read line; do cp $line ~/Downloads/dependencies; done)\n</code></pre> <p>\u5b9e\u9645\u8fd0\u884c\u5c55\u5f00\u5982\u4e0b\uff1a</p> <pre><code>cp -v file1.d ~/Downloads/dependencies\ncp -v file2.d ~/Downloads/dependencies\n...\n</code></pre> <p>\u5230\u76ee\u524d\u4e3a\u6b62\u7684 utility \u7528\u4f8b\u573a\u666f\uff0c\u90fd\u662f\u76f4\u63a5\u4e3a\u7279\u5b9a\u7684\u547d\u4ee4\uff08\u4f8b\u5982 echo,cat,du,ls,rm\uff09\u63d0\u4f9b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u8fd9\u4e9b\u53c2\u6570\u90fd\u76f4\u63a5\u6e90\u4e8e stdin\uff0c\u53ea\u662f\u501f\u52a9\u91cd\u5b9a\u5411 xargs \u5b9e\u73b0\u7ba1\u63a5\u3002</p> <p>\u4f46\u5728\u672c\u6848\u4f8b\u4e2d\uff0ccp \u547d\u4ee4\u7684\u62f7\u8d1d\u76ee\u6807\u6587\u4ef6\u5939\uff08<code>target_directory</code>\uff09\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\uff0c\u62f7\u8d1d\u6e90\u53c2\uff08<code>source_file</code>\uff09\u5219\u9700\u8981 find | xargs \u63d0\u4f9b\u3002</p> <p>\u6b64\u65f6\u53ef\u8003\u8651\u501f\u52a9 xargs \u7684 <code>-I</code> \u9009\u9879\uff0c\u6307\u5b9a\u66ff\u6362\u5b57\u7b26\u4e32\u4e3a <code>replstr</code>\uff0c\u5c06\u4ece stdin \u8bfb\u53d6\u5230\u7684\u53c2\u6570\uff0c\u66ff\u6362\u6389 utility \u547d\u4ee4\u4e2d\u7684\u5360\u4f4d\u53c2\u6570\uff08placeholder\uff09 <code>replstr</code>\u3002</p> <pre><code>     -I replstr\n         Execute utility for each input line, replacing one or more occur-\n         rences of replstr in up to replacements (or 5 if no -R flag is\n         specified) arguments to utility with the entire line of input.\n</code></pre> <p>\u57fa\u4e8e xargs \u7684\u66f4\u52a0\u7b80\u6d01\u9ad8\u6548\u7684\u7b49\u6548\u8868\u8fbe\u5982\u4e0b\uff1a</p> <pre><code># replstr = {}\n$ find . -type f -name \"*.d\" -print0 | xargs -0 -I {} cp {} ~/Downloads/dependencies\n</code></pre> <p>\u4f7f\u7528 <code>-I</code> \u7684\u65f6\u5019\uff0c\u547d\u4ee4\u4ee5\u5faa\u73af\u7684\u65b9\u5f0f\u6267\u884c\u3002\u5982\u679c\u67093\u4e2a\u53c2\u6570\uff08\u5373 find \u51fa\u4e863\u4e2a.d\u6587\u4ef6\uff09\uff0c\u90a3\u4e48\u547d\u4ee4\u5c31\u4f1a\u8fde\u540c <code>{}</code> \u4e00\u8d77\u88ab\u6267\u884c3\u6b21\u3002 \u5728\u6bcf\u4e00\u6b21\u7684 cp \u547d\u4ee4\u6267\u884c\u4e2d\uff0csource_file \u53c2\u6570\u5360\u4f4d\u7b26 <code>{}</code> \u90fd\u4f1a\u88ab\u66ff\u6362\u4e3a xargs \u4f20\u9012\u7684\u76f8\u5e94\u53c2\u6570\u4f5c\u4e3a\u62f7\u8d1d\u6e90\u3002</p> <p>\u4e3a\u65b9\u4fbf\u8c03\u8bd5\u53ca\u7406\u89e3\uff0c\u53ef\u4ee5\u7ed9 xargs \u5e26\u4e0a <code>-t</code> \u9009\u9879\uff0c\u67e5\u770b\u5faa\u73af\u6267\u884c\u7684cp\u547d\u4ee4\u5c55\u5f00\u3002\u518d\u914d\u5408 cp \u7684 <code>-v</code> \u9009\u9879\uff0c\u53ef\u4ee5\u770b\u5230\u62f7\u8d1d\u6d41\u7a0b\u3002 \u8fd9\u6837\uff0c\u547d\u4ee4\u884c\u6267\u884c\u8f93\u51fa\u5c31\u66f4\u660e\u4e86\u4e86\uff1a</p> <pre><code># replstr = srcd\n$ find . -type f -name \"*.d\" -print0 | xargs -0t -I srcd cp -v srcd ~/Downloads/dependencies\ncp -v ./cDACoreOperateCallBack.d /Users/faner/Downloads/dependencies\n./cDACoreOperateCallBack.d -&gt; /Users/faner/Downloads/dependencies/cDACoreOperateCallBack.d\ncp -v ./cDACoreListenerCallBack.d /Users/faner/Downloads/dependencies\n./cDACoreListenerCallBack.d -&gt; /Users/faner/Downloads/dependencies/cDACoreListenerCallBack.d\n...\n</code></pre> <p>\u601d\u8003\uff1axargs \u5982\u4f55\u4e00\u6b21\u6027\u4f20\u9012\u591a\u4e2a\u53c2\u6570\u7ed9\u540e\u9762\u7684 utility \u547d\u4ee4\u5462\uff1f\u8fd9\u6d89\u53ca\u5230 <code>xargs -n</code> \u5206\u6bb5\u5212\u6279\u548c Bash Shell \u547d\u4ee4\u53c2\u6570\u5217\u8868\u3002</p>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#edit_files","title":"edit files","text":"<p>\u7ecf\u5e38\u9700\u8981\u5c06\u67d0\u4e2a\u76ee\u5f55\u4e2d\u7684\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u6587\u4ef6\u5185\u7684\u4e00\u90e8\u5206\u6587\u672c\u8fdb\u884c\u66ff\u6362\uff0c\u4f8b\u5982\u5728\u7f51\u7ad9\u7684\u6e90\u6587\u4ef6\u76ee\u5f55\u4e2d\u66ff\u6362\u4e00\u4e2aURI\u3002</p> <p>\u573a\u666f\uff1a\u904d\u5386\u9879\u76ee\u76ee\u5f55\u4e0b\u7684\u6240\u6709.cpp\u6587\u4ef6\uff0c\u5e76\u5c06\u6bcf\u4e2a.cpp\u6587\u4ef6\u4e2d\u7684 Copyright \u66ff\u6362\u6210 Copyleft\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528find\u547d\u4ee4\u7684 <code>-exec</code> \u9009\u9879\u6267\u884c sed \u547d\u4ee4\u5bf9\u6bcf\u4e2a\u67e5\u627e\u5230\u7684\u6587\u4ef6\u6267\u884c\u67e5\u627e\u66ff\u6362\uff1a</p> <pre><code># \u4e3a\u6bcf\u4e2a\u67e5\u627e\u5230\u7684\u6587\u4ef6\u8c03\u7528\u4e00\u6b21sed\n$ find . -name \"*.cpp\" -exec sed -i '' 's/Copyright/Copyleft/g' {} \\;\n# \u6216\u8005\u5c06\u591a\u4e2a\u6587\u4ef6\u540d\u4e00\u5e76\u4f20\u9012\u7ed9sed\n$ find . -name \"*.cpp\" -exec sed -i '' 's/Copyright/Copyleft/g' {} \\+\n</code></pre> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5bf9find\u7ed3\u679c\u91cd\u5b9a\u5411\u7ed9 <code>| xargs -I{}</code> \u4f5c\u4e3a\u53c2\u6570\u8c03\u7528 sed \u7f16\u8f91\u66ff\u6362\uff1a</p> <pre><code>$ find . -name \"*.cpp\" -print0 | xargs -0 -I{} sed -i '' 's/Copyright/Copyleft/g' {}\n</code></pre> <p>\u601d\u8003\uff1a\u5982\u679c\u5934\u90e8\u6ca1\u6709\u5305\u542b Copyright \u6216 Copyleft\uff0c\u5982\u4f55\u5728\u5934\u90e8\u8865\u63d2\u4e00\u6761\u6807\u51c6\u7684\u7248\u6743\u58f0\u660e\u5462\uff1f</p> <pre><code># replstr = file\n$ find . -name \"*.cpp\" -print0 | xargs -0 -I file sed -i '' '1i\\\n// Tencent is pleased to support the open source community by making Mars available.\\\n// Copyright (C) 2016 THL A29 Limited, a Tencent company. All rights reserved.\\\n\n' file\n</code></pre>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-find-xargs/#dos2unix","title":"dos2unix","text":"<p>\u5728 vim \u4e0b\u6267\u884c <code>:%s/\\r//g</code> \u53ef\u5c06DOS\u6587\u4ef6\u4e2d\u7684\u56de\u8f66\u7b26 <code>^M</code> \u66ff\u6362\u4e3a\u7a7a\uff08\u5373\u5220\u9664\uff09\u3002</p> <p>dos2unix \u6279\u91cf\u66ff\u6362\u65b9\u6848\uff1a<code>find ./ -type f print0 | xargs -0 sed -i 's/^M$//'</code>\u3002  </p>","tags":["find","xargs"]},{"location":"blog/20191029/linux-cmd-iconv-enca/","title":"Linux Command - file iconv & enca","text":"<p>linux \u4e0b\u6587\u4ef6\u7f16\u7801\u683c\u5f0f\u8f6c\u6362\u76f8\u5173\u7684\u547d\u4ee4\u7b80\u4ecb\u3002</p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u5b57\u7b26\u96c6\u7f16\u7801","title":"\u5b57\u7b26\u96c6\u7f16\u7801","text":"","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#gb2312_gbk__gb18030","title":"GB2312, GBK &amp; GB18030","text":"<p>\u5173\u4e8eGBK\u3001GB2312\u3001UTF8 GB2312\u3001GBK\u3001GB18030 \u8fd9\u51e0\u79cd\u5b57\u7b26\u96c6\u7684\u4e3b\u8981\u533a\u522b\u662f\u4ec0\u4e48\uff1f </p> <p>\u5e38\u7528\u5b57\u7b26\u96c6\u7f16\u7801\u8be6\u89e3 ASCII\uff0cISO8859-1\uff0cGBK\uff0cGB18030\uff0cUnicode\uff0cUTF-8\u8be6\u89e3 </p> <p>GB2312 \u662f GBK \u7684\u5b50\u96c6\uff0cGBK \u662f GB18030 \u7684\u5b50\u96c6\u3002</p> <p></p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#utf-8_bom","title":"UTF-8 BOM","text":"<p>BOM\uff08Byte Order Mark\uff09\uff0c\u610f\u4e3a\u5b57\u8282\u5e8f\u6807\u8bb0\u3002</p> <p>BOM \u5728 UTF-16 \u4e2d\u7528\u6765\u8868\u793a\u9ad8\u4f4e\u5b57\u8282\u5e8f\u5217\u3002\u5728\u5b57\u8282\u6d41\u4e4b\u524d\u6709 BOM \u8868\u793a\u91c7\u7528\u4f4e\u5b57\u8282\u5e8f\u5217\uff08\u4f4e\u5b57\u8282\u5728\u524d\u9762\uff09\u3002</p> <p>\u5728 UCS\uff08THE UNIVERSAL CHARACTER SET\uff09\u7f16\u7801\u4e2d\u6709\u4e00\u4e2a\u53eb\u505a \"ZERO WIDTH NO-BREAK SPACE\" \u7684\u5b57\u7b26\uff0c\u5b83\u7684\u7f16\u7801\u662f <code>FE FF</code>\u3002\u800c <code>FF FE</code> \u5728 UCS \u4e2d\u662f\u4e0d\u5b58\u5728\u7684\u5b57\u7b26\uff0c\u6240\u4ee5\u4e0d\u5e94\u8be5\u51fa\u73b0\u5728\u5b9e\u9645\u4f20\u8f93\u4e2d\u3002</p> <p>UCS \u89c4\u8303\u5efa\u8bae\u6211\u4eec\u5728\u4f20\u8f93\u5b57\u8282\u6d41\u524d\uff0c\u5148\u4f20\u8f93\u5b57\u7b26 \"ZERO WIDTH NO-BREAK SPACE\"\u3002</p> <ul> <li>\u5982\u679c\u6536\u5230 <code>FE FF</code>\uff0c\u5c31\u8868\u660e\u8fd9\u4e2a\u5b57\u8282\u6d41\u662f <code>Big-Endian</code> \u7684\uff1b  </li> <li>\u5982\u679c\u6536\u5230 <code>FF FE</code>\uff0c\u5c31\u8868\u660e\u8fd9\u4e2a\u5b57\u8282\u6d41\u662f <code>Little-Endian</code> \u7684\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u5b57\u7b26 \"ZERO WIDTH NO-BREAK SPACE\" \u53c8\u88ab\u79f0\u4f5c BOM\u3002</p> <p>UTF-8 \u4ee5\u5b57\u8282\u4e3a\u7f16\u7801\u5355\u5143\uff0c\u6ca1\u6709\u5b57\u8282\u5e8f\u7684\u95ee\u9898\uff0c\u6545 UTF-8 \u6709\u65e0 BOM \u90fd\u53ef\u4ee5\u3002UTF-8 \u4e0d\u9700\u8981 BOM \u6765\u8868\u660e\u5b57\u8282\u987a\u5e8f\uff0c\u4f46\u53ef\u4ee5\u7528 BOM \u6765\u8868\u660e\u7f16\u7801\u65b9\u5f0f\u3002</p> <p>\u5b57\u7b26 \"ZERO WIDTH NO-BREAK SPACE\" \u7684 UTF-8 \u7f16\u7801\u662f <code>EF BB BF</code>\uff0c\u6240\u4ee5\u5982\u679c\u63a5\u6536\u8005\u6536\u5230\u4ee5 <code>EF BB BF</code> \u5f00\u5934\u7684\u5b57\u8282\u6d41\uff0c\u5c31\u77e5\u9053\u8fd9\u662f UTF-8 \u7f16\u7801\u4e86\u3002</p> <p>Windows \u5c31\u662f\u4f7f\u7528 BOM \u6765\u6807\u8bb0\u6587\u672c\u6587\u4ef6\u7684\u7f16\u7801\u65b9\u5f0f\u7684\u3002</p> <p>\u4f7f\u7528 Sublime Text 3 \u6253\u5f00\u6587\u4ef6\uff0c\u901a\u8fc7\u83dc\u5355 <code>File | Save with Encoding</code> \u53ef\u4ee5\u9009\u62e9\u8bbe\u7f6e\u4fdd\u5b58\u7f16\u7801\u4e3a <code>UTF8 with BOM</code>\u3002</p> <p>UCS-2 and UTF-8 </p> <p>UTF8 \u5e26BOM\u548c\u4e0d\u5e26BOM UTF8 with BOM \u4e0e UTF8 without BOM UTF-8 and UTF-8 without BOM \u23a1\u5e26 BOM \u7684 UTF-8\u23a6 \u548c \u23a1\u65e0 BOM \u7684 UTF-8\u23a6 </p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u4e2d\u6587\u663e\u793a\u4e71\u7801\u95ee\u9898","title":"\u4e2d\u6587\u663e\u793a\u4e71\u7801\u95ee\u9898","text":"<p>Xcode \u4ee3\u7801\u6587\u6863\u7684\u9ed8\u8ba4\u7f16\u7801\u901a\u5e38\u662f\u4e2d\u82f1\u6587\u6df7\u6392\u7684 <code>No Explicit Encoding</code>\u3002 \u4f46\u8001\u7248\u672c\u7684 Xcode \u5bf9\u5e26 BOM \u5934\u7684 UTF8 \u6587\u4ef6\u7f16\u7801\u65e0\u6cd5\u8bc6\u522b\uff0c\u4f7f\u7528\u4e86 GBK \u7f16\u7801\u7684\u6587\u4ef6\u5728 Xcode \u4e0b\u4e5f\u65e0\u6cd5\u8bc6\u522b\u7684\uff0c\u4ece\u800c\u5bfc\u81f4 Xcode \u4e0b\u7684\u4e2d\u6587\u663e\u793a\u53ef\u80fd\u4e71\u7801\u3002</p> <p>VS2015 \u53ea\u652f\u6301\u5e26 BOM \u7684 UTF-8\uff0c\u5426\u5219\u65e0\u6cd5\u8bc6\u522b\u5176\u4e2d\u7684\u4e2d\u6587\u90e8\u5206\uff1bXCode \u80fd\u591f\u76f4\u63a5\u6253\u5f00\u548c\u7f16\u8f91 <code>UTF-8 with BOM</code> \u7f16\u7801\u7684\u6587\u4ef6\u3002\u56e0\u6b64\uff0c<code>UTF-8 with BOM</code> \u662f\u76ee\u524d\u8de8\u5e73\u53f0\u5f00\u53d1\u517c\u5bb9\u6027\u6700\u597d\u7684\u7f16\u7801\u9009\u62e9\u3002</p> <p>\u9057\u61be\u7684\u662f\uff0c\u4e24\u6b3e IDE \u90fd\u4e0d\u80fd\u76f4\u63a5\u521b\u5efa\u8fd9\u79cd\u7f16\u7801\u7684\u6587\u4ef6\uff0c\u53ea\u80fd\u5728\u521b\u5efa\u4e4b\u540e\u518d\u624b\u5de5\u6216\u501f\u52a9\u7b2c\u4e09\u65b9\u7f16\u8f91\u5de5\u5177\u8f6c\u6362\u3002  </p> <p>\u89e3\u51b3Visual Studio 2005\u663e\u793a\u4e2d\u6587\u4e71\u7801 \u89e3\u51b3VS2008\u751f\u6210\u7684\u6587\u4ef6\u5728XCode\u4e0b\u4e2d\u6587\u4e71\u7801 \u4f7f\u7528Xcode\u6253\u5f00Winnows\u4e0bC\u6587\u4ef6\u4e2d\u6587\u4e71\u7801\u95ee\u9898\u89e3\u51b3 Visual Studio 2015 \u4e2d\u5982\u4f55\u4f7f\u6587\u4ef6\u9ed8\u8ba4\u4fdd\u5b58\u4e3a UTF - 8 \u7f16\u7801\u683c\u5f0f\uff1f </p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u67e5\u770b\u6587\u4ef6\u7f16\u7801","title":"\u67e5\u770b\u6587\u4ef6\u7f16\u7801","text":"<p>How do I determine file encoding in OSX? How to Determine File Type &amp; Encoding from Command Line in Mac OS X linux\u4e0b\u67e5\u770b\u6587\u4ef6\u7f16\u7801\u53ca\u4fee\u6539\u7f16\u7801 </p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#file_\u547d\u4ee4","title":"file \u547d\u4ee4","text":"<p>macOS Bash Shell \u5185\u7f6e\u7684 <code>file</code> \u547d\u4ee4\u53ef\u4ee5\u7528\u6765\u6253\u5370\u6587\u4ef6\u7c7b\u578b\u4fe1\u606f\u3002</p> <pre><code>pi@raspberrypi:~ $ man file\n\nFILE(1)                                         BSD General Commands Manual                                        FILE(1)\n\nNAME\n     file \u2014 determine file type\n\nSYNOPSIS\n     file [-bcdEhiklLNnprsvzZ0] [--apple] [--extension] [--mime-encoding] [--mime-type] [-e testname] [-F separator]\n          [-f namefile] [-m magicfiles] [-P name=value] file ...\n     file -C [-m magicfiles]\n     file [--help]\n\nDESCRIPTION\n     This manual page documents version 5.30 of the file command.\n\n     file tests each argument in an attempt to classify it.  There are three sets of tests, performed in this order:\n     filesystem tests, magic tests, and language tests.  The first test that succeeds causes the file type to be printed.\n</code></pre>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u4f7f\u7528_file_\u547d\u4ee4","title":"\u4f7f\u7528 file \u547d\u4ee4","text":"<p>\u6267\u884c file \u547d\u4ee4\uff0c\u67e5\u770b\u5f53\u524d\u76ee\u5f55\u4e0b include \u548c src \u5b50\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5c5e\u6027\u4fe1\u606f\uff1a</p> <pre><code>$ file include/* src/*\ninclude/CheckPCIf.h:      C++ source text, UTF-8 Unicode text\ninclude/UtilcFunctions.h: C++ source text, ASCII text\ninclude/WifiPhotoIf.h:    C++ source text, ISO-8859 text\ninclude/liteif.h:         C++ source text, ISO-8859 text, with CRLF line terminators\ninclude/litelog.h:        c program text, UTF-8 Unicode (with BOM) text\ninclude/litenet.h:        c program text, ASCII text, with CRLF, LF line terminators\ninclude/litestd.h:        c program text, ASCII text, with CRLF line terminators\ninclude/litetime.h:       c program text, ASCII text, with CRLF line terminators\nsrc/CheckPC:              directory\nsrc/FileHash:             directory\nsrc/WiFiPhoto:            directory\nsrc/base:                 directory\nsrc/http:                 directory\nsrc/liteafx.h:            C++ source text, ASCII text, with CRLF, LF line terminators\nsrc/liteconststr.cpp:     ASCII text, with CRLF line terminators\nsrc/liteconststr.h:       c program text, ASCII text, with CRLF line terminators\nsrc/litetransfer.cpp:     C++ source text, ISO-8859 text, with CRLF line terminators\nsrc/litetransfer.h:       C++ source text, ASCII text, with CRLF line terminators\nsrc/sink.h:               C++ source text, ASCII text, with CRLF, LF line terminators\nsrc/tcprelaychannel:      directory\nsrc/transfer:             directory\nsrc/tuple.h:              C++ source text, ISO-8859 text, with CRLF line terminators\n</code></pre> <p>\u5305\u62ec UTF8 \u7f16\u7801\u7684 with BOM \u4fe1\u606f\u3002</p> <p>\u5e26 <code>-I</code> \u9009\u9879\u6267\u884c <code>file -I filename</code> \u5c06\u8f93\u51fa MIME \u7c7b\u578b\u4fe1\u606f\uff1a</p> <pre><code>$ file -I include/*\ninclude/CheckPCIf.h:      text/x-c++; charset=utf-8\ninclude/UtilcFunctions.h: text/x-c++; charset=us-ascii\ninclude/WifiPhotoIf.h:    text/x-c++; charset=iso-8859-1\ninclude/liteif.h:         text/x-c++; charset=iso-8859-1\ninclude/litelog.h:        text/x-c; charset=utf-8\ninclude/litenet.h:        text/x-c; charset=us-ascii\ninclude/litestd.h:        text/x-c; charset=us-ascii\ninclude/litetime.h:       text/x-c; charset=us-ascii\n</code></pre> <p>\u67e5\u770b\u5355\u4e2a\u6587\u4ef6\u65f6\uff0cfile \u547d\u4ee4\u8bbe\u7f6e <code>-b</code>\uff08--brief\uff09\u4e0d\u663e\u793a\u6587\u4ef6\u540d\uff1a</p> <pre><code>$ file -b include/WifiPhotoIf.h\nC++ source text, ISO-8859 text\n\n$ file -bI include/WifiPhotoIf.h\ntext/x-c++; charset=iso-8859-1\n</code></pre> <p>\u4ece <code>file include/* src/*</code> \u8f93\u51fa\u7ed3\u679c\u770b\uff0csrc \u4e0b\u5b58\u5728\u591a\u7ea7\u5b50\u76ee\u5f55\uff0c\u800c file \u547d\u4ee4\u53ea\u80fd\u901a\u914d src \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u65e0\u6cd5\u7a7f\u8d8a\u5b50\u76ee\u5f55\u3002 <code>file *</code> \u901a\u914d\u5f53\u524d\u76ee\u5f55\uff0c\u76f8\u5f53\u4e8e find \u6307\u5b9a\u4e86 -maxdepth 1\u3002\u82e5\u60f3\u9012\u5f52\u67e5\u627e\u6307\u5b9a\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\uff0cfind \u9ed8\u8ba4\u4e0d\u6307\u5b9a maxdepth \u5373\u53ef\u3002</p> <pre><code>$ find include src -type f | xargs file | tee include_src-file.log\n</code></pre> <p>\u67e5\u770b <code>include_src-file.log</code> \u53ef\u77e5\uff0c\u603b\u5171\u6709\u56db\u5927\u7c7b\u7f16\u7801\u683c\u5f0f\uff1a</p> <ol> <li>ASCII text  </li> <li>UTF-8 Unicode  </li> <li>ISO-8859 text  </li> <li>Non-ISO extended-ASCII text  </li> </ol>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u8fc7\u6ee4\u6307\u5b9a\u7f16\u7801\u7684\u6587\u4ef6","title":"\u8fc7\u6ee4\u6307\u5b9a\u7f16\u7801\u7684\u6587\u4ef6","text":"<p>\u8fc7\u6ee4\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\u7f16\u7801\u4e3a <code>ISO-8859</code> \u7684\u6587\u4ef6\u4fe1\u606f\uff1a</p> <pre><code>$ file * | grep -i 'ISO-8859'\nbuild.bat:              DOS batch file text, ISO-8859 text, with CRLF line terminators\n</code></pre> <p>\u8c03\u7528 find \u9012\u5f52\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\uff0c\u5e76\u8fc7\u6ee4\u51fa\u7f16\u7801\u4e3a <code>ISO-8859</code> \u7684\u6587\u4ef6\uff1a</p> <pre><code>find . -type f -exec file {} \\; | grep -i 'ISO-8859'\nfind . -type f | xargs file | grep -i 'ISO-8859'\n</code></pre> <p>\u8fc7\u6ee4\u51fa incldue \u76ee\u5f55\u4e0b\u6587\u4ef6\u7f16\u7801\u4e3a <code>ISO-8859</code> \u548c <code>Non-ISO</code> \u7684\u6587\u4ef6\uff1a</p> <pre><code>$ file include/* | grep -i 'ISO-8859\\|Non-ISO'\ninclude/WifiPhotoIf.h:    C++ source text, ISO-8859 text\ninclude/liteif.h:         C++ source text, ISO-8859 text, with CRLF line terminators\n</code></pre> <p>\u9012\u5f52\u67e5\u627e include \u548c src \u5b50\u76ee\u5f55\u4e0b\u7f16\u7801\u4e3a <code>ISO-8859</code> \u548c <code>Non-ISO</code> \u7684\u6587\u4ef6\uff1a</p> <pre><code>find include src -type f -exec file {} \\; | grep -i 'ISO-8859\\|Non-ISO'\nfind include src -type f | xargs file | grep -i 'ISO-8859\\|Non-ISO'\n</code></pre>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#enca_\u547d\u4ee4","title":"enca \u547d\u4ee4","text":"<p><code>enca</code> \u547d\u4ee4\u53ef\u67e5\u770b\u3001\u8f6c\u6362\u6587\u4ef6\u7684\u7f16\u7801\u3002</p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u5b89\u88c5_enca","title":"\u5b89\u88c5 enca","text":"<p>macOS \u901a\u8fc7\u5305\u7ba1\u7406\u5668 brew \u53ef\u641c\u7d22\u5b89\u88c5 enca \u5de5\u5177\u5305\uff1a</p> <pre><code># \u67e5\u627e enca\nifan@FAN-MC1:~|$ brew search enca\n==&gt; Searching local taps...\nenca\n==&gt; Searching taps on GitHub...\n==&gt; Searching blacklisted, migrated and deleted formulae...\n\n# enca \u6982\u8ff0\nifan@FAN-MC1:~|$ brew desc enca\nenca: Charset analyzer and converter\n\n# enca \u4fe1\u606f\nifan@FAN-MC1:~|$ brew info enca\nenca: stable 1.19 (bottled), HEAD\nCharset analyzer and converter\nhttps://cihar.com/software/enca/\nNot installed\nFrom: http://android.oa.com/homebrew-core/Formula/enca.rb\n\n# \u5b89\u88c5 enca\nifan@FAN-MC1:~|$ brew install enca\n\n# \u67e5\u770b enca \u7248\u672c\u4fe1\u606f\nfaner@MBP-FAN:~|$ enca -v\nenca 1.19\n\nFeatures: -librecode-interface +iconv-interface +external-converter +language-detection +locale-alias +target-charset-auto +ENCAOPT \n\nCopyright (C) 2000-2005 David Necas (Yeti) (&lt;yeti@physics.muni.cz&gt;),\n              2005 Zuxy Meng (&lt;zuxy.meng@gmail.com&gt;).\n\nEnca is free software; it can be copied and/or modified under the terms of\nversion 2 of GNU General Public License, run `enca --license' to see the full\nlicense text.  There is NO WARRANTY; not even for MERCHANTABILITY or FITNESS\nFOR A PARTICULAR PURPOSE.\n</code></pre> <p>raspbian \u901a\u8fc7\u5305\u7ba1\u7406\u5668 apt \u53ef\u641c\u7d22\u5b89\u88c5 enca \u5de5\u5177\u5305\uff1a</p> <pre><code># \u67e5\u627e enca\npi@raspberrypi:~ $ apt-cache search enca --names-only \nenca - Extremely Naive Charset Analyser - binaries\n\n# \u67e5\u770b enca \u5b89\u88c5\u5305\u4fe1\u606f\npi@raspberrypi:~ $ apt-cache show enca\n\nDescription: Extremely Naive Charset Analyser - binaries\n Enca is an Extremely Naive Charset Analyser. It detects the character set and\n the encoding of text files and can also convert them to other encodings using\n either a built-in converter or external libraries and tools like libiconv,\n librecode, or cstocs.\n\n# \u5b89\u88c5 enca\npi@raspberrypi:~ $ sudo apt-get install enca\n\n# \u67e5\u770b enca \u7248\u672c\u4fe1\u606f\npi@raspberrypi:~ $ enca -v\n</code></pre>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u4f7f\u7528_enca_\u547d\u4ee4","title":"\u4f7f\u7528 enca \u547d\u4ee4","text":"<p>\u7528 enca \u547d\u4ee4\u68c0\u6d4b\u6587\u4ef6\u7f16\u7801\u4fe1\u606f\uff1a</p> <pre><code># -f, --human-readable\n$ enca -L zh_CN include/* src/*\ninclude/CheckPCIf.h: Universal transformation format 8 bits; UTF-8\ninclude/UtilcFunctions.h: 7bit ASCII characters\ninclude/WifiPhotoIf.h: Unrecognized encoding\ninclude/liteif.h: Simplified Chinese National Standard; GB2312\n  CRLF line terminators\ninclude/litelog.h: Universal transformation format 8 bits; UTF-8\ninclude/litenet.h: 7bit ASCII characters\n  Mixed line terminators\ninclude/litestd.h: 7bit ASCII characters\n  CRLF line terminators\ninclude/litetime.h: 7bit ASCII characters\n  CRLF line terminators\nenca: Cannot read file `src/CheckPC': Is a directory\nenca: Cannot read file `src/FileHash': Is a directory\nenca: Cannot read file `src/WiFiPhoto': Is a directory\nenca: Cannot read file `src/base': Is a directory\nenca: Cannot read file `src/http': Is a directory\nsrc/liteafx.h: 7bit ASCII characters\n  Mixed line terminators\nsrc/liteconststr.cpp: 7bit ASCII characters\n  CRLF line terminators\nsrc/liteconststr.h: 7bit ASCII characters\n  CRLF line terminators\nsrc/litetransfer.cpp: Simplified Chinese National Standard; GB2312\n  CRLF line terminators\nsrc/litetransfer.h: 7bit ASCII characters\n  CRLF line terminators\nsrc/sink.h: 7bit ASCII characters\n  Mixed line terminators\nenca: Cannot read file `src/tcprelaychannel': Is a directory\nenca: Cannot read file `src/transfer': Is a directory\nsrc/tuple.h: Simplified Chinese National Standard; GB2312\n  CRLF line terminators\n</code></pre> <p><code>enca -m</code> \u540c <code>file -I</code>\uff0c\u67e5\u770b\u6587\u4ef6\u7684 MIME \u7c7b\u578b\u4fe1\u606f\uff1a</p> <pre><code># -m, --mime-name\uff0c\u540c file -I\n$ enca -L zh_CN -m include/*\ninclude/CheckPCIf.h: UTF-8\ninclude/UtilcFunctions.h: US-ASCII\ninclude/WifiPhotoIf.h: unknown\ninclude/liteif.h: GB2312\ninclude/litelog.h: UTF-8\ninclude/litenet.h: US-ASCII\ninclude/litestd.h: US-ASCII\ninclude/litetime.h: US-ASCII\n</code></pre> <pre><code># -i, --iconv-name\n$ enca -L zh_CN -i include/*\ninclude/CheckPCIf.h: UTF-8\ninclude/UtilcFunctions.h: ASCII\ninclude/WifiPhotoIf.h: ???\ninclude/liteif.h: GBK\ninclude/litelog.h: UTF-8\ninclude/litenet.h: ASCII\ninclude/litestd.h: ASCII\ninclude/litetime.h: ASCII\n</code></pre> <p>\u65e0\u6cd5\u68c0\u6d4b BOM \u4fe1\u606f\uff1f</p> <p>\u501f\u52a9 cut \u547d\u4ee4\uff0c\u53ef\u63d0\u53d6\u51fa\u4ee5\u5192\u53f7\u5b57\u7b26\u4e3a\u5206\u5272\u7b26\u53f7\uff0c\u63d0\u53d6\u6587\u4ef6\u548c\u7f16\u7801\uff1a</p> <pre><code>enca -L zh_CN -i include/* | cut -d ':' -f 1\nenca -L zh_CN -i include/* | cut -d ':' -f 2 # \u524d\u9762\u6709\u7a7a\u683c\n</code></pre> <p>\u5efa\u8bae\u91c7\u7528\u66f4\u4e3a\u7075\u6d3b\u7684 awk \u547d\u4ee4\uff0c\u53ef\u6307\u5b9a\u5b57\u7b26\u4e32\uff08\u5192\u53f7\u7a7a\u683c\uff09\u4e3a\u5206\u5272\u7b26\uff1a</p> <pre><code>enca -L zh_CN -i include/* | awk -F ': ' '{print $1}'\nenca -L zh_CN -i include/* | awk -F ': ' '{print $2}'\n</code></pre> <p>\u501f\u52a9 find \u547d\u4ee4\uff0c\u53ef\u4ee5\u9012\u5f52\u67e5\u627e\u6307\u5b9a\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\uff0c\u518d\u91cd\u5b9a\u5411\u7ed9 enca \u67e5\u770b\u7f16\u7801\u4fe1\u606f\uff1a</p> <pre><code>$ find include src -type f | xargs enca -L zh_CN -i | tee include_src-enca.log\n</code></pre> <p>\u67e5\u770b <code>include_src-enca.log</code> \u53ef\u77e5\uff0c\u603b\u5171\u6709\u56db\u5927\u7c7b\u7f16\u7801\u683c\u5f0f\uff1a</p> <ol> <li>ASCII  </li> <li>UTF-8  </li> <li>GBK  </li> <li>???  </li> </ol> <p><code>enca -m</code> \u6309 MIME \u7c7b\u578b\u8fc7\u6ee4\u51fa\u7f16\u7801\u4e3a <code>GB2312</code> \u548c <code>unknown</code> \u7684\u6587\u4ef6\uff1a</p> <pre><code>find include src -type f | xargs enca -L zh_CN -m | grep -i 'GB2312\\|unknown'\n</code></pre> <p>\u6216 <code>enca -i</code> \u6309 iconv-name \u8fc7\u6ee4\u51fa\u7f16\u7801\u4e3a <code>GBK</code> \u548c <code>???</code> \u7684\u6587\u4ef6\uff1a</p> <pre><code>find include src -type f | xargs enca -L zh_CN -i | grep -i 'GBK\\|\\?\\?\\?'\n</code></pre>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#editor_file_inspector","title":"Editor File Inspector","text":"<p>\u7528 Vim \u6253\u5f00\u6587\u4ef6\uff0c\u6267\u884c\u5e95\u884c\u547d\u4ee4 <code>:set fileencoding ?</code> \u53ef\u67e5\u770b\u5f53\u524d\u6587\u4ef6\u7f16\u7801\uff0c\u8c8c\u4f3c\u68c0\u6d4b\u4e0d\u51c6\u786e\uff1f</p> <p>\u5177\u4f53\u7f16\u7801\u683c\u5f0f\u53ef\u67e5\u8be2\u5173\u952e\u5b57 encoding-names \u548c encoding-values\u3002</p> <p>Sublime Text 3 \u9ed8\u8ba4\u4e0d\u5728\u72b6\u6001\u680f\u663e\u793a\u7f16\u7801\u683c\u5f0f\uff0c<code>~/Library/Application Support/Sublime Text 3/Packages/Default/Preferences.sublime-settings</code> \u4e2d\u9ed8\u8ba4\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>    // Display file encoding in the status bar\n    \"show_encoding\": false,\n</code></pre> <p><code>Preferences &gt; Settings - Users</code> \u6253\u5f00 <code>~/Library/Application Support/Sublime Text 3/Packages/User/Preferences.sublime-settings</code>\uff0c\u5728\u5176\u4e2d\u8bbe\u7f6e </p> <pre><code>    \"show_encoding\": true,\n</code></pre> <p>\u5219\u5728\u72b6\u6001\u680f\u4e2d\u5c06\u6709\u4e00\u683c\u663e\u793a\u5f53\u524d\u6587\u4ef6\u7f16\u7801\u683c\u5f0f\uff1a</p> <p> </p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u7279\u6b8a\u7f16\u7801\u6587\u4ef6","title":"\u7279\u6b8a\u7f16\u7801\u6587\u4ef6","text":"<p>\u4ee5\u4e0b\u6709\u4e24\u4e2a\u7279\u6b8a\u7f16\u7801\u7684\u6587\u4ef6\uff1a</p> <ul> <li><code>include/WifiPhotoIf.h</code> </li> <li><code>src/WiFiPhoto/WifiPhotoConnMgr.h</code> </li> <li><code>src/http/lthttpchannel.cpp</code> </li> </ul> <p><code>file</code> \u547d\u4ee4\u67e5\u770b\u6587\u4ef6\u7f16\u7801\u4fe1\u606f\uff1a</p> <pre><code>$ file include/WifiPhotoIf.h src/WiFiPhoto/WifiPhotoConnMgr.h src/http/lthttpchannel.cpp\ninclude/WifiPhotoIf.h:            C++ source text, ISO-8859 text\nsrc/WiFiPhoto/WifiPhotoConnMgr.h: C++ source text, Non-ISO extended-ASCII text\nsrc/http/lthttpchannel.cpp:       c program text, Non-ISO extended-ASCII text, with CRLF line terminators\n</code></pre> <p><code>enca</code> \u547d\u4ee4\u65e0\u6cd5\u8bc6\u522b\u6587\u4ef6\u7f16\u7801\u4fe1\u606f\uff1a</p> <pre><code>$ enca -L zh_CN include/WifiPhotoIf.h src/WiFiPhoto/WifiPhotoConnMgr.h src/http/lthttpchannel.cpp\ninclude/WifiPhotoIf.h: Unrecognized encoding\nsrc/WiFiPhoto/WifiPhotoConnMgr.h: Unrecognized encoding\nsrc/http/lthttpchannel.cpp: Unrecognized encoding\n</code></pre> <p>\u5c1d\u8bd5\u7528 Sublime Text 3 \u6253\u5f00\u4ee5\u4e0a3\u4e2a\u6587\u4ef6\uff1a</p> <ul> <li><code>include/WifiPhotoIf.h</code>\uff1aDetected WINDOWS-1252 vs Western (Windows 1252) with 73% confidence\uff1b  </li> <li><code>src/WiFiPhoto/WifiPhotoConnMgr.h</code>\uff1aDetected WINDOWS-1252 vs Western (Windows 1252) with 62% confidence\uff1b </li> </ul> <p>\u5f39\u7a97\u8ba9\u7528\u6237\u81ea\u884c\u9009\u62e9\u53ef\u80fd\u7684\u7f16\u7801\uff1a</p> <p></p> <ul> <li>\u6253\u5f00 <code>src/http/lthttpchannel.cpp</code> \u65f6\uff0c\u5f39\u7a97\u63d0\u793a\u9519\u8bef\uff1a</li> </ul> <pre><code>Errors occurred while converting lthttpchannel.cpp with GB18030 encoding.\n\nWARNING: Continue to load this file using GB18030, malformed data will be ignored.\n\nPress \"Cancel\" to choose another encoding manually.\n</code></pre> <p></p> <p>\u5e95\u90e8\u72b6\u6001\u680f\u7f16\u7801\u663e\u793a\u4e3a <code>GB18030</code>\u3001<code>Western(Windows 1252)</code>\uff0c\u5982\u679c\u70b9\u51fb Cancel \u4e5f\u4f1a\u5f39\u51fa\u4e0a\u9762\u7684\u7f16\u7801\u9009\u62e9\u5217\u8868\u3002</p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u6587\u4ef6\u7f16\u7801\u683c\u5f0f\u8f6c\u6362","title":"\u6587\u4ef6\u7f16\u7801\u683c\u5f0f\u8f6c\u6362","text":"<p>Visual Studio C/C++ \u53ef\u4ee5 \u5c06\u65b0\u5efa\u7684\u6e90\u7801\u6587\u4ef6\u7684\u7f16\u7801\u683c\u5f0f\u81ea\u52a8\u8bbe\u7f6e\u6210UTF8\uff0c\u6216\u4ece\u5176\u4ed6\u683c\u5f0f \u66f4\u6539\u7f16\u7801\u683c\u5f0f\u4e3a UTF-8\u3002</p> <p>\u5bf9\u4e8e\u67d0\u4e9b\u5728 Xcode \u4e2d\u6587\u4e71\u7801\u95ee\u9898\uff0c\u901a\u8fc7\u53f3\u4fa7\u680f\u7684 Text Settings | Text Encoding \u9009\u62e9 <code>Simplified Chinese(Mac OS)</code> \u53ef\u6b63\u786e\u663e\u793a\u3002</p> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u501f\u52a9 Sublime Text \u7b49\u7b2c\u4e09\u65b9\u53ef\u89c6\u5316\u7f16\u8f91\u5668\uff0c\u6253\u5f00\u6587\u4ef6\u540e\u5bf9\u5df2\u6709\u7f16\u7801\u6267\u884c\u8f6c\u6362\u3002</p> <p>\u53e6\u5916\u4e00\u79cd\u601d\u8def\u662f\u501f\u52a9 <code>iconv</code> \u6216 <code>enca</code> \u7b49\u547d\u4ee4\u884c\u5de5\u5177\u5b9e\u73b0\u8f6c\u7801\u3002</p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#iconv_\u547d\u4ee4\u8f6c\u7801","title":"iconv \u547d\u4ee4\u8f6c\u7801","text":"<p>Linux\u4e0bGBK-&gt;UTF-8\u6587\u4ef6\u7f16\u7801\u6279\u91cf\u8f6c\u6362\u547d\u4ee4 linux \u6279\u91cf\u8f6c\u6362GBK\u5230UTF-8\u7f16\u7801\u7684\u65b9\u6cd5 \u7528iconv\u5b9e\u73b0\u7684gb18030\u5230utf-8\u7684\u7f16\u7801\u8f6c\u6362 macOS \u4f7f\u7528 iconv \u547d\u4ee4\u5c06 gb18030 \u7f16\u7801\u8f6c\u6362\u4e3a utf-8 \u683c\u5f0f </p> <p>\u63a7\u5236\u53f0\u8f93\u5165 <code>iconv --help</code> \u67e5\u770b iconv \u547d\u4ee4\u5e2e\u52a9\uff1a</p> <pre><code>$ iconv --help\nUsage: iconv [OPTION...] [-f ENCODING] [-t ENCODING] [INPUTFILE...]\nor:    iconv -l\n\nConverts text from one encoding to another encoding.\n\nOptions controlling the input and output format:\n  -f ENCODING, --from-code=ENCODING\n                              the encoding of the input\n  -t ENCODING, --to-code=ENCODING\n                              the encoding of the output\n\nOptions controlling conversion problems:\n  -c                          discard unconvertible characters\n  --unicode-subst=FORMATSTRING\n                              substitution for unconvertible Unicode characters\n  --byte-subst=FORMATSTRING   substitution for unconvertible bytes\n  --widechar-subst=FORMATSTRING\n                              substitution for unconvertible wide characters\n\nOptions controlling error output:\n  -s, --silent                suppress error messages about conversion problems\n\nInformative output:\n  -l, --list                  list the supported encodings\n  --help                      display this help and exit\n  --version                   output version information and exit\n\nReport bugs to &lt;bug-gnu-libiconv@gnu.org&gt;.\n</code></pre> <p><code>iconv</code> \u547d\u4ee4\u9ed8\u8ba4\u5c06\u8f6c\u7801\u7ed3\u679c\u8f93\u51fa\u5230\u63a7\u5236\u53f0\uff08stdout\uff09\u4e0a\u3002</p> <ul> <li>\u65b0\u7248 iconv\uff08raspbian \u4e0b\u7684 2.24\uff09\u53ef\u901a\u8fc7 <code>-o</code> \u9009\u9879\u6307\u5b9a\u8f93\u51fa\u6587\u4ef6\uff08outputfile\uff09\uff1b  </li> <li>\u65e7\u7248 iconv\uff08macOS \u4e0b\u7684 1.11\uff09\u547d\u4ee4\u4e0d\u652f\u6301 <code>-o</code> \u9009\u9879\uff0c\u5219\u53ef\u4f7f\u7528 <code>&gt;</code> \u5c06\u8f6c\u7801\u7ed3\u679c\u91cd\u5b9a\u5411\u5230\u6307\u5b9a\u6587\u4ef6\u3002  </li> </ul> <p>iconv \u547d\u4ee4\u4e3b\u8981\u7531 <code>-f</code> \u548c <code>-t</code> \u4e24\u4e2a\u9009\u9879\uff0c\u6307\u5b9a\u539f\u59cb\u7f16\u7801\u548c\u76ee\u6807\u8f6c\u7801\uff1a</p> <ul> <li><code>-f</code> ENCODING, --from-code=ENCODING : the encoding of the input</li> <li><code>-t</code> ENCODING, --to-code=ENCODING : the encoding of the output</li> </ul> <pre><code>iconv -f GBK -t UTF-8 file1 -o file2\niconv -f GB18030 -t UTF-8 file1 -o file2\n\n# macOS \u4e0b\u4e0d\u652f\u6301 -o \u9009\u9879\uff0c\u53ea\u80fd\u91cd\u5b9a\u5411\niconv -f GB2312 -t UTF-8 file1 &gt; file2\n</code></pre> <p>\u8f6c\u6362\u524d <code>include/</code> \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u7f16\u7801\u4fe1\u606f\u5982\u4e0b\uff1a</p> <pre><code># \u8f6c\u6362\u524d\n$ file include/*\ninclude/CheckPCIf.h:      C++ source text, UTF-8 Unicode text # \u4e2d\u82f1\u6587\ninclude/UtilcFunctions.h: C++ source text, ASCII text # \u7eaf\u82f1\u6587\ninclude/WifiPhotoIf.h:    C++ source text, ISO-8859 text # \u4e2d\u82f1\u6587\ninclude/liteif.h:         C++ source text, ISO-8859 text, with CRLF line terminators # \u4e2d\u82f1\u6587\ninclude/litelog.h:        c program text, UTF-8 Unicode (with BOM) text # \u7eaf\u82f1\u6587\ninclude/litenet.h:        c program text, ASCII text, with CRLF, LF line terminators # \u7eaf\u82f1\u6587\ninclude/litestd.h:        c program text, ASCII text, with CRLF line terminators # \u4e2d\u82f1\u6587\ninclude/litetime.h:       c program text, ASCII text, with CRLF line terminators # \u7eaf\u82f1\u6587\n\n$ enca -L zh_CN include/*\ninclude/CheckPCIf.h: Universal transformation format 8 bits; UTF-8\ninclude/UtilcFunctions.h: 7bit ASCII characters\ninclude/WifiPhotoIf.h: Unrecognized encoding\ninclude/liteif.h: Simplified Chinese National Standard; GB2312\n  CRLF line terminators\ninclude/litelog.h: Universal transformation format 8 bits; UTF-8\ninclude/litenet.h: 7bit ASCII characters\n  Mixed line terminators\ninclude/litestd.h: 7bit ASCII characters\n  CRLF line terminators\ninclude/litetime.h: 7bit ASCII characters\n  CRLF line terminators\n</code></pre> <p>\u6267\u884c <code>iconv</code> \u8f6c\u6362\u7f16\u7801\u4e3a UTF-8\uff1a</p> <pre><code>$ mkdir include2\n# \u8f6c\u6362\n$ iconv -f GB18030 -t UTF-8 include/CheckPCIf.h &gt; include2/CheckPCIf.h\niconv: include/CheckPCIf.h:5:24: cannot convert\n$ iconv -f GB18030 -t UTF-8 include/UtilcFunctions.h &gt; include2/UtilcFunctions.h\n$ iconv -f GB18030 -t UTF-8 include/WifiPhotoIf.h &gt; include2/WifiPhotoIf.h\n$ iconv -f GB18030 -t UTF-8 include/liteif.h &gt; include2/liteif.h\n$ iconv -f GB18030 -t UTF-8 include/litelog.h &gt; include2/litelog.h\niconv: include/litelog.h:1:2: cannot convert\n$ iconv -f GB18030 -t UTF-8 include/litenet.h &gt; include2/litenet.h\n$ iconv -f GB18030 -t UTF-8 include/litestd.h &gt; include2/litestd.h\n$ iconv -f GB18030 -t UTF-8 include/litetime.h &gt; include2/litetime.h\n</code></pre> <p>CheckPCIf.h \u548c litelog.h \u672c\u8eab\u5df2\u662f UTF-8 Unicode \u7f16\u7801\uff0c\u90e8\u5206\u5b57\u5143\u65e0\u6cd5\u8f6c\u6362\uff1f</p> <p>\u8f6c\u6362\u6210\u529f\u540e\uff0c\u91cd\u65b0\u6267\u884c <code>file</code> \u548c <code>enca</code> \u547d\u4ee4\uff1a</p> <pre><code># \u8f6c\u6362\u540e\n$ file include2/*\ninclude2/CheckPCIf.h:      UTF-8 Unicode text\ninclude2/UtilcFunctions.h: C++ source text, ASCII text\ninclude2/WifiPhotoIf.h:    C++ source text, UTF-8 Unicode text\ninclude2/liteif.h:         C++ source text, UTF-8 Unicode text, with CRLF line terminators\ninclude2/litelog.h:        UTF-8 Unicode text, with no line terminators\ninclude2/litenet.h:        c program text, ASCII text, with CRLF, LF line terminators\ninclude2/litestd.h:        c program text, ASCII text, with CRLF line terminators\ninclude2/litetime.h:       c program text, ASCII text, with CRLF line terminators\n\n$ enca -L zh_CN include/*\ninclude2/CheckPCIf.h: Universal transformation format 8 bits; UTF-8\ninclude2/UtilcFunctions.h: 7bit ASCII characters\ninclude2/WifiPhotoIf.h: Universal transformation format 8 bits; UTF-8\ninclude2/liteif.h: Universal transformation format 8 bits; UTF-8\n  CRLF line terminators\ninclude2/litelog.h: Universal transformation format 8 bits; UTF-8\ninclude2/litenet.h: 7bit ASCII characters\n  Mixed line terminators\ninclude2/litestd.h: 7bit ASCII characters\n  CRLF line terminators\ninclude2/litetime.h: 7bit ASCII characters\n  CRLF line terminators\n</code></pre> <p>\u8c8c\u4f3c\u53ea\u6709 ISO-8859 \u7684\u88ab\u8f6c\u7801\u4e86\uff1flitelog.h \u4e22\u4e86 BOM?</p> <p><code>ASCII text</code>\uff1a\u8868\u793a\u7eaf ASCII \u7f16\u7801\uff0c\u53ea\u6709\u82f1\u6587\u5b57\u7b26\uff0c\u6ca1\u6709\u4e2d\u6587\u7b49\u5176\u4ed6\u8bed\u8a00\u5b57\u7b26\u3002 \u5f53\u8f93\u5165\u4e2d\u6587\u7b49\u5176\u4ed6\u8bed\u8a00\u5b57\u7b26\u540e\uff0c\u5219\u7f16\u7801\u5c06\u663e\u793a\u4e3a <code>UTF-8 Unicode text</code>\u3002  </p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#iconv_\u6279\u91cf\u66f4\u6539\u6587\u4ef6\u7f16\u7801","title":"iconv \u6279\u91cf\u66f4\u6539\u6587\u4ef6\u7f16\u7801","text":"<p>\u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u7684 php \u6587\u4ef6 <code>$file</code> \u4ece GB18030 \u8f6c\u7801\u4e3a utf8 \u6587\u4ef6 <code>$file.new</code>\uff0c\u7136\u540e\u5c06 <code>$file.new</code> \u91cd\u547d\u540d\u4e3a <code>$file</code>\uff0c\u5373\u8986\u76d6\u6e90\u6587\u4ef6\u3002</p> <pre><code>#!/bin/bash\nfor file in *.php\ndo\n    iconv -f GB18030 -t utf8 -o \"$file.new\" \"$file\" &amp;&amp;\n    mv -f \"$file.new\" \"$file\"\ndone\n</code></pre> <p>\u4e5f\u53ef\u5229\u7528 find \u9012\u5f52\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709 php \u6587\u4ef6\u8fdb\u884c\u8f6c\u7801\u3002</p> <ol> <li>\u5c06\u6bcf\u4e2a find \u7ed3\u679c\u884c\uff08\u6587\u4ef6\u540d\uff09\u8bfb\u53d6\u5230\u53d8\u91cf file \u4e2d\uff0c\u7136\u540e echo \u6253\u5370\u51fa\u6587\u4ef6\u540d\uff1b  </li> <li>\u7d27\u63a5\u7740\u5c06 <code>$file</code> \u4ece GB18030 \u8f6c\u7801\u4e3a UTF-8 \u6587\u4ef6 <code>$file.utf8</code>\uff1b  </li> <li>\u7b2c\u4e00\u4e2a mv \u547d\u4ee4\u5c06\u6e90\u6587\u4ef6\u91cd\u547d\u540d\u4e3a <code>*.18030</code> \u5907\u4efd\uff1b  </li> <li>\u7b2c\u4e8c\u4e2a mv \u5c06\u8f6c\u7801\u6587\u4ef6\uff08<code>*.utf8</code>\uff09\u6539\u540d\u8986\u76d6\u6e90\u6587\u4ef6\u3002</li> </ol> <pre><code>#!/bin/bash\nfind . -type f -name \"*.php\" | while read file;\ndo\n   echo $file\n   iconv -f GB18030 -t UTF-8 $file &gt; ${file}.utf8\n   mv $file ${file}.18030\n   mv ${file}.utf8 $file\ndone\n</code></pre> <p>format_converter.sh</p> <p>iconv \u547d\u4ee4\u4e0d\u80fd\u76f4\u63a5\u8f6c\u7801\u8986\u76d6\u6e90\u6587\u4ef6\uff0c\u53ea\u80fd\u901a\u8fc7 <code>mv -f</code> \u5f3a\u5236\u8986\u76d6\u3002</p> <p>How can I make iconv replace the input file with the converted output? </p> <pre><code>find include src -type f | xargs file | grep -i 'ISO-8859\\|Non-ISO' | cut -d ':' -f 1 | xargs iconv -f GB18030 -t UTF-8\n</code></pre> <p>\u5982\u4f55\u91cd\u5b9a\u5411\u8f93\u51fa src\uff1f</p> <pre><code>find include src -type f | xargs file | grep -i 'ISO-8859\\|Non-ISO' | cut -d ':' -f 1 | xargs -I src iconv -f GB18030 -t UTF-8 src\n</code></pre> <p>\u5355\u884c\u547d\u4ee4\u8c8c\u4f3c\u4e0d\u597d\u5b9e\u73b0\uff0c\u53ea\u80fd\u7f16\u5199shell\u811a\u672c\u3002</p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#enca_\u547d\u4ee4\u8f6c\u6362","title":"enca \u547d\u4ee4\u8f6c\u6362","text":"<p><code>enca -L zh_CN -x utf-8 *</code> \u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u8f6c\u7801\u4e3a UTF-8\u3002  </p> <p>\u5982\u679c\u4e0d\u60f3\u8986\u76d6\uff0c\u5219\u53ef\u4ee5\u6267\u884c <code>enca -L zh_CN -x UTF-8 &lt; file1 &gt; file2</code>\uff0c\u5c06 file1 \u8f6c\u6362\u6210 file2\u3002</p> <p>\u5229\u7528\u7ba1\u9053\u6279\u91cf\u67e5\u627e\u8fc7\u6ee4\u51fa\u6df7\u5408\u4e2d\u6587\u7f16\u7801\u7684\u6587\u4ef6\uff1a</p> <pre><code>find include src -type f | xargs file | grep -i 'ISO-8859\\|Non-ISO' | cut -d ':' -f 1\nfind include src -type f | xargs enca -L zh_CN -i | grep -i 'GBK\\|\\?\\?\\?' | awk -F: '{print $1}'\n</code></pre> <ol> <li>\u5229\u7528 <code>find</code> \u547d\u4ee4\u67e5\u627e\u6307\u5b9a\u6587\u4ef6\u5939\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\uff1b  </li> <li>\u9488\u5bf9\u67e5\u627e\u7ed3\u679c\u96c6\uff0c\u5229\u7528 xargs \u91cd\u5b9a\u5411\u6267\u884c <code>file</code> \u6216 <code>enca</code> \u547d\u4ee4\u67e5\u770b\u7f16\u7801\u4fe1\u606f\uff1b  </li> <li>\u5229\u7528 <code>grep</code> \u547d\u4ee4\u8fc7\u6ee4\u51fa\u7f16\u7801\u4e3a ISO-8859(iso-8859)/GBK(GB2312) \u7684\u6587\u4ef6\u4fe1\u606f\uff1b  </li> <li>\u5229\u7528 <code>cut</code> \u6216 <code>awk</code> \u547d\u4ee4\u5bf9grep\u7ed3\u679c\u96c6\u7684\u6587\u4ef6\u4fe1\u606f\u884c\u4ee5 <code>:</code> \u5207\u5272\u63d0\u53d6\u51fa\u7b2c\u4e00\u5217\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u540d\uff1b  </li> <li>\u5bf9\u76f8\u5bf9\u8def\u5f84\u6587\u4ef6\u540d\u7ed3\u679c\u96c6\u6267\u884c <code>enca -L zh_CN -x utf-8</code> \u547d\u4ee4\u5c06\u5176\u8f6c\u7801\u4e3a UTF-8\u3002  </li> </ol> <pre><code>find include src -type f | xargs file | grep -i 'ISO-8859\\|Non-ISO' | cut -d ':' -f 1 | xargs enca -V -L zh_CN -x utf-8 | tee enca-x.log\n</code></pre>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#utf8__bom","title":"UTF8 + BOM","text":"<p>Set Encoding of File to UTF8 With BOM in Sublime Text 3 </p> <p>\u4f7f\u7528 iconv \u6216 enca \u547d\u4ee4\u5c06\u6240\u6709 GB18030 \u5b57\u7b26\u90fd\u8f6c\u6362\u4e3a UTF8 \u540e\uff0c\u518d\u4f7f\u7528 Sublime Text 3 \u6253\u5f00\u6587\u4ef6\uff0c\u901a\u8fc7\u83dc\u5355 File | Save with Encoding \u9009\u62e9 <code>UTF8 with BOM</code>\uff1a</p> <pre><code>$ file *\nUtilcFunctions.h: c program text, UTF-8 Unicode (with BOM) text\nWifiPhotoIf.h:    c program text, UTF-8 Unicode (with BOM) text\nliteif.h:         c program text, UTF-8 Unicode (with BOM) text\nlitelog.h:        c program text, UTF-8 Unicode (with BOM) text\nlitenet.h:        c program text, UTF-8 Unicode (with BOM) text, with CRLF line terminators\nlitestd.h:        c program text, UTF-8 Unicode (with BOM) text, with CRLF line terminators\nlitetime.h:       c program text, UTF-8 Unicode (with BOM) text, with CRLF line terminators\n\n$ enca *\nUtilcFunctions.h: Universal transformation format 8 bits; UTF-8\nWifiPhotoIf.h: Universal transformation format 8 bits; UTF-8\nliteif.h: Universal transformation format 8 bits; UTF-8\nlitelog.h: Universal transformation format 8 bits; UTF-8\nlitenet.h: Universal transformation format 8 bits; UTF-8\n  CRLF line terminators\nlitestd.h: Universal transformation format 8 bits; UTF-8\n  CRLF line terminators\nlitetime.h: Universal transformation format 8 bits; UTF-8\n  CRLF line terminators\n</code></pre>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#line_endings","title":"Line Endings","text":"","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#\u56de\u8f66\u6362\u884c","title":"\u56de\u8f66\u6362\u884c","text":"<p>\u4ee5\u4e0b\u6458\u81ea\u300a\u6211\u7684\u7535\u8111\u751f\u6daf\uff082\uff09\uff1aASCII\u7801\u300b\uff1a</p> <p>\u4f7f\u7528\u8fc7\u673a\u68b0\u5f0f\u82f1\u6587\u6253\u5b57\u673a\u7684\u4eba\u90fd\u77e5\u9053\uff0c\u5f53\u4e00\u884c\u5b57\u7b26\u5feb\u6253\u5b8c\u7684\u65f6\u5019\uff0c\u6253\u5b57\u673a\u4f1a\u53d1\u51fa\u201c\u53ee\u201d\u7684\u4e00\u58f0\u94c3\u54cd\uff0c\u63d0\u9192\u6253\u5b57\u5458\u522b\u518d\u4e0d\u505c\u5730\u51fb\u952e\u4e86\uff0c\u5426\u5219\u5b57\u7b26\u5c31\u6253\u5230\u7eb8\u5916\u9762\u53bb\u4e86\u3002\u6b64\u65f6\uff0c\u6253\u5b57\u5458\u8981\u7528\u624b\u628a\u6253\u5b57\u673a\u7684\u6ed1\u8f66\u63a8\u5230\u6700\u5de6\u8fb9\uff0c\u8fd9\u4e2a\u52a8\u4f5c\u79f0\u4e3a\u201c\u56de\u8f66\u201d\u3002  </p> <p><code>\\r</code>\uff08ASCII \u7801\u4e3a 0x0d\uff09\uff1a\u672c\u4e49\u662f\u5149\u6807\u91cd\u65b0\u56de\u5230\u672c\u884c\u5f00\u5934\uff0cr \u5373 return\uff0c\u63a7\u5236\u5b57\u7b26\u53ef\u4ee5\u5199\u6210 CR\uff08Carriage Return\uff09\uff1b  </p> <p>\u4ec5\u4ec5\u56de\u8f66\u662f\u4e0d\u591f\u7684\uff0c\u5982\u679c\u6b64\u65f6\u6253\u5b57\u5458\u7ee7\u7eed\u6253\u5b57\uff0c\u5b57\u7b26\u5c31\u4f1a\u91cd\u53e0\u5728\u521a\u624d\u5df2\u7ecf\u6253\u8fc7\u5b57\u7684\u8fd9\u4e00\u884c\u4e0a\u9762\uff0c\u6240\u4ee5\u6253\u5b57\u5458\u8fd8\u8981\u7528\u624b\u628a\u7eb8\u5377\u6eda\u7b52\u5411\u524d\u8f6c\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u52a8\u4f5c\u53eb\u201c\u6362\u884c\u201d\u3002  </p> <p><code>\\n</code>\uff08ASCII \u7801\u4e3a 0x0a\uff09\uff1a\u672c\u4e49\u662f\u5149\u6807\u5f80\u4e0b\u4e00\u884c\uff08\u4e0d\u4e00\u5b9a\u5230\u4e0b\u4e00\u884c\u884c\u9996\uff09\uff0cn \u53ca newline\uff0c\u63a7\u5236\u5b57\u7b26\u53ef\u4ee5\u5199\u6210 LF\uff08Line Feed\uff09\u3002  </p> <p>\u5728\u8ba1\u7b97\u673a\u4e0a\u7f16\u8f91\u6587\u672c\uff0c\u6bcf\u5f53\u6309\u4e0b enter(return) \u952e\uff0c\u7cfb\u7edf\u4f1a\u5728\u884c\u672b\uff08EOL\uff09\u63d2\u5165\u4e0d\u53ef\u89c1\u7684\u7ed3\u675f\u7b26\uff08invisible Line Ending\uff09\u6807\u8bb0\u6362\u884c\uff0c\u540c\u65f6\u5149\u6807\u81ea\u52a8\u79fb\u52a8\u5230\u4e0b\u4e00\u884c\u9996\u3002</p> <p>\u5728\u975e\u82f1\u8bed\u7cfb\u56fd\u5bb6\u7684\u952e\u76d8\u4e0a\uff0c\u56de\u8f66\u952e\u4f1a\u7528 \u21b5\uff08U+21B5\u3001<code>&amp;crarr;</code>\uff09\u7b26\u53f7\u8868\u793a\uff0c\u5f62\u8c61\u76f4\u89c2\u5730\u8bf4\u660e\u4e86\u8be5\u952e\u7684\u529f\u80fd\u3002</p> <p>\u5c3d\u7ba1\u56de\u8f66\u6362\u884c\u8fd9\u4e24\u4e2a\u6982\u5ff5\u4e5f\u88ab\u632a\u5230\u4e86\u8ba1\u7b97\u673a\u4e0a\uff0c\u4f46\u662f\u65e9\u671f\u5b58\u50a8\u5668\u8f83\u8d35\uff0c\u4e00\u4e9b\u79d1\u5b66\u5bb6\u8ba4\u4e3a\u5728\u6bcf\u884c\u7ed3\u5c3e\u52a0\u4e24\u4e2a\u989d\u5916\u7684\u5b57\u7b26\u6765\u6807\u8bc6\u884c\u672b\u592a\u6d6a\u8d39\u5b58\u50a8\uff0c\u52a0\u4e00\u4e2a\u5373\u53ef\u3002</p> <p>\u5177\u4f53\u5230\u6587\u672c\u7f16\u7801\u4e2d\uff0c\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u5728\u6572\u4e0b enter \u952e\u65f6\u63d2\u5165\u7684\u4e0d\u53ef\u89c1\u884c\u672b\u7ed3\u675f\u7b26\u6709\u6240\u4e0d\u540c\u3002\u5177\u4f53\u5206\u4e3a\u4e09\u5927\u6d41\u6d3e\uff1a</p> <ul> <li>\u5728 Windows \u7cfb\u7edf\u4e0b\uff0c<code>\\r\\n</code> \u8fd9\u4e24\u4e2a\u5b57\u7b26\u8fde\u5728\u4e00\u8d77\u6807\u8bc6\u884c\u672b\uff0c\u672c\u4e49\u8868\u793a\u56de\u8f66\u6362\u884c\uff1b  </li> <li>\u5728 UNIX \u7c7b\u7cfb\u7edf\uff08\u5305\u62ec\u6700\u65b0\u7684 macOS\uff09\u4e2d\uff0c\u6362\u884c\u7b26 <code>\\n</code> \u6807\u8bc6\u884c\u672b\uff0c\u8868\u793a\u5149\u6807\u79fb\u5230\u4e0b\u4e00\u884c\u5e76\u56de\u5230\u884c\u9996\uff1b  </li> <li>\u5728\u5df2\u7ecf\u9000\u51fa\u5386\u53f2\u821e\u53f0\u7684 Mac OS  9 \u53ca\u66f4\u53e4\uff0c<code>\\r</code> \u6807\u8bc6\u884c\u672b\uff0c\u8868\u793a\u56de\u5230\u672c\u884c\u5f00\u5934\u5e76\u5f80\u4e0b\u4e00\u884c\u3002  </li> </ul> <p>\u4e24\u5927\u4e3b\u6d41\u64cd\u4f5c\u7cfb\u7edf\u9635\u8425\u91c7\u7528\u4e0d\u540c\u7684 Line Endings\uff0c\u9020\u6210\u7684\u540e\u679c\u662f\uff1a</p> <ul> <li>Unix/macOS \u7cfb\u7edf\u4e0b\u7684\u6587\u4ef6\u5728 Windows \u4e2d\u6253\u5f00\uff0c\u6240\u6709\u6587\u5b57\u90fd\u4f1a\u53d8\u6210\u4e00\u884c\uff1b  </li> <li>\u800c Windows \u4e0b\u7684\u6587\u4ef6\u5728 Unix/macOS \u4e0b\u6253\u5f00\u7684\u8bdd\uff0c\u5728\u6bcf\u884c\u7684\u7ed3\u5c3e\u53ef\u80fd\u4f1a\u591a\u51fa\u4e00\u4e2a <code>^M</code> \u7b26\u53f7\u3002  </li> </ul> <ol> <li> <p>Xcode \u53f3\u4fa7\u7684 Line Endings\uff1a</p> <ul> <li>macOS/Unix(LF)  </li> <li>Classic Mac OS(CR)  </li> <li>Windows(CRLF)  </li> </ul> </li> <li> <p>\u5728 vim \u4e0b\u5e95\u884c\u6a21\u5f0f\u8f93\u5165\u547d\u4ee4 <code>:set fileformat ?</code> \u53ef\u67e5\u8be2\u5f53\u524d\u6587\u6863\u7684 EOL \u683c\u5f0f\uff1b\u95ee\u53f7\u53ef\u6362\u4e3a unix/dos \u8bbe\u7f6e\u5177\u4f53\u683c\u5f0f\u3002  </p> </li> <li>\u5728\u7ec8\u7aef\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528 <code>od -A x -t xCa tuple.h</code> \u6216 <code>hexdump -C tuple.h</code>\uff0c\u6216\u5728 Sublime Text \u4e0b\u4f7f\u7528 hexviewer \u53ef\u67e5\u770b tuple.h \u6587\u4ef6\u7684\u5341\u516d\u8fdb\u5236\u7801\uff0c\u4ee5\u67e5\u9a8c\u884c\u672b\u7ed3\u675f\u7b26\u3002  </li> <li>\u5728 python \u4e2d\uff08sublime text \u63a7\u5236\u53f0\uff09\u6267\u884c <code>import os;os.linesep</code> \u53ef\u4ee5\u67e5\u770b\u884c\u5206\u9694\u7b26\uff08<code>line separator in text files</code>\uff09\u3002  </li> </ol>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#vim_\u7f16\u8f91\u66ff\u6362","title":"vim \u7f16\u8f91\u66ff\u6362","text":"<p>\u5728 vim \u4e0b\u6267\u884c <code>:%s/\\r//g</code> \u53ef\u5c06DOS\u6587\u4ef6\u4e2d\u7684\u56de\u8f66\u7b26 <code>^M</code> \u66ff\u6362\u4e3a\u7a7a\uff08\u5373\u5220\u9664\uff09\u3002  </p> <p>Vim \u4e2d\u5982\u4f55\u53bb\u6389 ^M \u5b57\u7b26\uff1f vim linux\u4e0b\u67e5\u627e\u663e\u793a^M\u5e76\u4e14\u5220\u9664 </p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#tr_\u547d\u4ee4","title":"tr \u547d\u4ee4","text":"<p>dos2unix\uff08crlf-&gt;lf\uff09: </p> <p>\u5229\u7528 <code>tr -s</code> \u66ff\u6362\u56de\u8f66\u6362\u884c\u7b26\uff08<code>\\r\\n</code>\uff09\u4e3a\u6362\u884c\u7b26\uff08<code>\\n</code>\uff09\uff0c\u4ec5\u4f9b\u8c03\u8bd5\uff1a</p> <pre><code>tr -s \"[\\r\\n]\" \"[\\n*]\" &lt; include/litestd.h\ntr -s \"[\\015\\012]\" \"[\\012*]\" &lt; include/litestd.h\n</code></pre> <p>\u5229\u7528 <code>tr -d</code> \u5220\u9664\u56de\u8f66\u63a7\u5236\u5b57\u7b26\uff08<code>\\r</code>\uff09\uff0c\u5e76\u8f93\u51fa\u5230\u65b0\u6587\u4ef6\uff1a</p> <pre><code>cat include/litestd.h | tr -d '[\\r]' &gt; include/litestd2.h\ntr -d '[\\r]' &lt; include/litestd.h &gt; include/litestd2.h\ntr -d \"[\\015]\" &lt; include/litestd.h | tee include/litestd2.h\n</code></pre>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#sed_\u66ff\u6362","title":"sed \u66ff\u6362","text":"<p>dos2unix\uff08crlf-&gt;lf\uff09</p> <p>\u6279\u91cf\u66ff\u6362\u65b9\u6848\uff1a<code>find . -type f -print0 | xargs -0 sed -i 's/^M$//'</code>\uff0c\u8c8c\u4f3c\u4e0d\u884c\u3002</p> <p>\u4fee\u6539\u4e3a <code>sed -i '' 's/\\r//g' file</code>\uff0c\u5bf9\u5355\u4e2a\u6587\u4ef6\u6267\u884cOK\u3002 \u6539\u4e3a\u4ee5\u4e0b\u7ba1\u63a5\u62a5\u9519\uff0c\u5c1a\u5f85\u5b8c\u5584\uff01</p> <pre><code>$ find include -type f -print0 | xargs -0 file | grep -i 'CRLF' | cut -d ':' -f 1 | xargs sed -i '' 's/\\r//g'\nsed: RE error: illegal byte sequence\n</code></pre> <p>unix2dos\uff08lf-&gt;crlf\uff09\u8f6c\u6362\u65b9\u6848\u53c2\u8003 \u5982\u4f55\u4f7f\u7528sed\u66ff\u6362\u6362\u884c\u7b26\uff1f - \u817e\u8baf\u4e91\u3002</p> <p>sed \u5339\u914d\\n\u6362\u884c\u7b26 sed\u547d\u4ee4\u5982\u4f55\u66ff\u6362\u6362\u884c\u7b26\u201c\\n\u201d </p> <p>\u5728 GNU \u4e2d\u91c7\u7528 sed \u89e3\u51b3\uff1a</p> <pre><code>sed ':a;N;$!ba;s/\\n/\\r\\n/g' file\n</code></pre> <p>\u8fd9\u5c06\u5728\u5faa\u73af\u4e2d\u8bfb\u53d6\u6574\u4e2a\u6587\u4ef6\uff0c\u7136\u540e\u5b9e\u73b0 lf-&gt;crlf \u66ff\u6362\u3002</p> <ol> <li>\u521b\u5efa\u6807\u7b7e <code>a</code>\u3002  </li> <li>\u901a\u8fc7 <code>N</code> \u6307\u4ee4\u5c06\u5f53\u524d\u548c\u4e0b\u4e00\u884c\u9644\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4\uff1b  </li> <li>\u5728\u6700\u540e\u4e00\u884c\u4e4b\u524d\uff08<code>$!</code>\uff09\uff0c\u5219\u8df3\u8f6c\u5230\u6807\u7b7ea\uff08<code>ba</code>\uff09\uff1b     &gt; $! \u610f\u5473\u7740\u4e0d\u8981\u5728\u6700\u540e\u4e00\u884c\u6267\u884c\uff0c\u56e0\u4e3a\u5e94\u8be5\u6709\u4e00\u4e2a\u6700\u7ec8\u6362\u884c\u7b26\u3002  </li> <li>\u901a\u8fc7 <code>s</code> \u66ff\u6362\u6307\u4ee4\u5c06\u6574\u4e2a\u6587\u4ef6\uff08<code>g</code>\u6807\u8bb0\uff09\u4e2d\u7684 lf \u66ff\u6362\u4e3a crlf\u3002  </li> </ol> <p>\u652f\u6301 BSD \u548c macOS \u7684\u8de8\u5e73\u53f0\u517c\u5bb9sed\u8bed\u6cd5\uff1a</p> <pre><code>sed -i -e ':a' -e 'N' -e '$!ba' -e 's/\\n/\\r\\n/g' file\n</code></pre> <p>\u6539\u4e3a\u4ee5\u4e0b\u7ba1\u63a5\u62a5\u9519\uff0c\u5c1a\u5f85\u5b8c\u5584\uff01</p> <pre><code>$ find include -type f -print0 | xargs -0 file | grep -v 'CRLF' | cut -d ':' -f 1 | xargs sed -i '' -e ':a' -e 'N' -e '$!ba' -e 's/\\n/\\r\\n/g'\nsed: RE error: illegal byte sequence\n</code></pre>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-iconv-enca/#sublime_text_3_\u7f16\u8f91\u66ff\u6362","title":"Sublime Text 3 \u7f16\u8f91\u66ff\u6362","text":"<p>Sublime Text \u7684 <code>~/Library/Application Support/Sublime Text 3/Packages/Default/Preferences.sublime-settings</code></p> <pre><code>    // Determines what character(s) are used to terminate each line in new files.\n    // Valid values are 'system' (whatever the OS uses), 'windows' (CRLF) and\n    // 'unix' (LF only).\n    \"default_line_ending\": \"system\",\n\n    // Display line endings in the status bar\n    \"show_line_endings\": false,\n</code></pre> <p><code>default_line_ending</code>: \u9ed8\u8ba4 line ending \u8ddf\u968f\u7cfb\u7edf\uff0cmacOS \u4e0b\u662f LF\u3002 <code>show_line_endings</code>: \u9ed8\u8ba4\u4e0d\u5728\u72b6\u6001\u680f\u663e\u793a\u5f53\u524d Line Ending\uff0c\u53ef\u4ee5 <code>Preferences &gt; Settings - Users</code> \u6253\u5f00 <code>~/Library/Application Support/Sublime Text 3/Packages/User/Preferences.sublime-settings</code>\uff0c\u5728\u5176\u4e2d\u8bbe\u7f6e\uff1a</p> <pre><code>    \"show_line_endings\": true,\n</code></pre> <p>\u5e95\u90e8\u72b6\u6001\u680f\u5c06\u663e\u793a\u5f53\u524d Line Ending\uff1a</p> <ul> <li>Windows\uff1aWindows Line Endings(CRLF)  </li> <li>Unix\uff1aUnix Line Endings(LF)  </li> <li>CR\uff1aMac OS 9 Line Endings(CR)  </li> </ul> <p>\u53ef\u4ee5\u70b9\u51fb\u9009\u62e9\u5207\u6362\uff0c\u5c06 <code>litenet.h</code>,<code>litestd.h</code>,<code>litetime.h</code> \u8fd93\u4e2a\u6587\u4ef6\u7684 Line Ending \u90fd\u5207\u6362\u4e3a Unix(LF)\u3002</p> <p>Difference between CR LF, LF and CR line break types? </p> <p>Dealing with line endings git replacing LF with CRLF </p> <p>crlf.py: Replace CRLF (windows) line endings with LF (unix) line endings in files.  </p> <p>How to Ensure Always LF not CRLF on Windows </p>","tags":["iconv","enca"]},{"location":"blog/20191029/linux-cmd-ls/","title":"Linux Command - ls","text":"<p>linux \u4e0b\u7684\u547d\u4ee4 ls \u7b80\u4ecb\u3002</p>","tags":["ls"]},{"location":"blog/20191029/linux-cmd-ls/#ls","title":"ls","text":"<p>ls - list directory contents</p> <p>\u9ed8\u8ba4\u6309\u6587\u4ef6\u540d\u6392\u5e8f\u3002</p>","tags":["ls"]},{"location":"blog/20191029/linux-cmd-ls/#options","title":"options","text":"","tags":["ls"]},{"location":"blog/20191029/linux-cmd-ls/#-1","title":"-1","text":"<p><code>-1</code>: \u6bcf\u4e00\u9879\u5355\u884c\u5217\u51fa\uff08list one file per line\uff09\uff0c\u4fbf\u4e8e\u6309\u5217\u7edf\u8ba1\u6216\u5217\u9009\u62f7\u8d1d\u7b49\u64cd\u4f5c\u3002</p> <pre><code>     -1      (The numeric digit ``one''.)  Force output to be one entry per line.  This is\n             the default when output is not to a terminal.\n</code></pre> <p>\u5f53\u8f93\u51fa\u4e0d\u662f\u63a7\u5236\u53f0\uff08stdout\uff09\u65f6\uff0c\u9ed8\u8ba4\u5c31\u662f\u5355\u884c\u5217\u51fa\uff0c\u4f8b\u5982 <code>ls &gt; ls-out.txt</code>\u3002</p>","tags":["ls"]},{"location":"blog/20191029/linux-cmd-ls/#-l","title":"-l","text":"<p><code>-l</code>: \u663e\u793a\u957f\u5217\u8868\uff08long listing format\uff09\uff0c\u6bcf\u4e00\u9879\u5355\u884c\u5217\u51fa\uff0c\u663e\u793a\u5305\u62ec\u6587\u4ef6\u7684\u8bfb\u5199\u6743\u9650\u3001\u6240\u6709\u8005\u53ca\u65e5\u671f\u7b49\u5c5e\u6027\u4fe1\u606f\u3002</p> <pre><code>     -l      (The lowercase letter ``ell''.)  List in long format.  (See below.)  A total\n             sum for all the file sizes is output on a line before the long listing.\n</code></pre>","tags":["ls"]},{"location":"blog/20191029/linux-cmd-ls/#all","title":"all","text":"<p><code>-a</code>: \u663e\u793a\u6240\u6709\u6587\u4ef6\uff08all\uff09\uff0c\u5305\u62ec <code>.</code>\u3001<code>..</code> \u548c <code>.git</code>\u3001<code>.svn</code>\u3001<code>.DS_Store</code> \u7b49\u9690\u85cf\u6587\u4ef6\u3002 <code>-A</code>: \u663e\u793a\u51e0\u4e4e\u6240\u6709\u6587\u4ef6\uff08almost-all\uff09\uff0c\u5305\u62ec <code>.git</code>\u3001<code>.svn</code>\u3001<code>.DS_Store</code> \u7b49\u9690\u85cf\u6587\u4ef6\uff0c\u4f46\u4e0d\u663e\u793a <code>.</code> \u548c <code>..</code>\u3002  </p> <pre><code>     -A      List all entries except for . and ...  Always set for the super-user.\n     -a      Include directory entries whose names begin with a dot (.).\n</code></pre> <p><code>-d</code>: \u67e5\u770b\u5f53\u524d\u76ee\u5f55\u672c\u8eab\u7684\u4fe1\u606f\uff0c\u4e0d\u5217\u4e3e\u76ee\u5f55\u5185\u7684\u6587\u4ef6\u6570\u636e\u3002</p> <pre><code>-d      Directories are listed as plain files (not searched recursively).\n</code></pre> <p><code>ls -ld</code>: \u5217\u4e3e\u663e\u793a\u5f53\u524d\u76ee\u5f55\uff08\u6587\u4ef6\u5939\uff09(<code>.</code>)\u7684\u5c5e\u6027\u4fe1\u606f\u3002  </p> <p><code>-F</code>: append indicator (one of <code>*/=&gt;@|</code>) to entries for classify.</p> <p>\u5c06\u5728\u76ee\u5f55\u540e\u9762\u8ffd\u52a0 <code>/</code>\uff0c\u5728\u53ef\u6267\u884c\u6587\u4ef6\u540e\u9762\u8ffd\u52a0 <code>*</code>\uff0c\u5728\u8f6f\u94fe\u540e\u9762\u8ffd\u52a0 <code>@</code> \u7b49\u7279\u6b8a\u7b26\u53f7\uff0c\u533a\u5206\u666e\u901a\u6587\u4ef6\u3002</p> <pre><code>     -F      Display a slash (`/') immediately after each pathname that is a directory, an\n             asterisk (`*') after each that is executable, an at sign (`@') after each\n             symbolic link, an equals sign (`=') after each socket, a percent sign (`%')\n             after each whiteout, and a vertical bar (`|') after each that is a FIFO.\n</code></pre> <p>\u521b\u5efa\u8f6f\u8fde\u63a5\u547d\u4ee4\uff1a<code>ln -s ../Documents/iDev iDev</code>\u3002 \u5bf9\u4e8e\u8f6f\u94fe\u63a5\uff0c\u9664\u4e86 <code>ls -l iDev</code> \u4f1a\u663e\u793a\u771f\u8eab\u5916\uff0c\u4e5f\u53ef\u8c03\u7528 <code>readlink -f iDev</code> \u67e5\u770b\u6e90\u6587\u4ef6\uff08original\uff09\u3002</p> <p><code>ls -lR</code>\uff1a\u9012\u5f52\u5217\u4e3e\u5f53\u524d\u53ca\u6240\u6709\u5b50\u6587\u4ef6\u5939\u3002</p> <pre><code>     -R      Recursively list subdirectories encountered.\n</code></pre>","tags":["ls"]},{"location":"blog/20191029/linux-cmd-ls/#size__sort","title":"size &amp; sort","text":"<p><code>-h</code>: \u4ee5 KB\u3001MB\u3001GB \u7b49\u6613\u8bfb\u65b9\u5f0f\u663e\u793a\u6587\u4ef6\u5927\u5c0f\uff08human-readable size\uff09\u3002</p> <pre><code>     -h      When used with the -l option, use unit suffixes: Byte, Kilobyte, Megabyte,\n             Gigabyte, Terabyte and Petabyte in order to reduce the number of digits to\n             three or less using base 2 for sizes.\n</code></pre> <p>ls \u9ed8\u8ba4\u6309\u6587\u4ef6\u540d\u6392\u5e8f\uff0c\u53ef\u4ee5 <code>-S</code> \u6307\u5b9a\u6309\u6587\u4ef6\u5927\u5c0f\u964d\u5e8f\u6392\u5217\uff0c\u6216 <code>-Sr</code> \u6309\u7167\u6587\u4ef6\u5927\u5c0f\u5347\u5e8f\u6392\u5217\u3002</p> <pre><code>     -r      Reverse the order of the sort to get reverse lexicographical order or the\n             oldest entries first (or largest files last, if combined with sort by size\n\n     -S      Sort files by size\n</code></pre> <p><code>ls -lS</code>\uff1a\u6309\u5927\u5c0f\uff08\u964d\u5e8f\uff09\u5217\u51fa\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u8be6\u7ec6\u4fe1\u606f\u3002 <code>ls -lSr</code>\uff1a\u6309\u5927\u5c0f\u5347\u5e8f\u5217\u51fa\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u8be6\u7ec6\u4fe1\u606f\u3002  </p> <p><code>-t</code>\uff1a\u901a\u8fc7\u6700\u540e\u4fee\u6539\u65f6\u95f4\u6392\u5e8f\u3002</p> <pre><code>     -t      Sort by time modified (most recently modified first) before sorting the oper-\n             ands by lexicographical order.\n</code></pre> <p><code>ls -lt</code>\uff1a\u6309\u4fee\u6539\u65f6\u95f4\uff08\u964d\u5e8f\uff09\u5217\u51fa\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u8be6\u7ec6\u4fe1\u606f\u3002 <code>ls -ltr</code>\uff1a\u6309\u4fee\u6539\u65f6\u95f4\u5347\u5e8f\u5217\u51fa\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u8be6\u7ec6\u4fe1\u606f\u3002  </p>","tags":["ls"]},{"location":"blog/20191029/linux-cmd-ls/#\u5e38\u7528\u7ec4\u5408","title":"\u5e38\u7528\u7ec4\u5408","text":"<p>\u6700\u5e38\u7528\u7ec4\u5408\uff1a<code>ls -lhF</code></p> <ul> <li><code>ls -lhFA</code>\uff1a\u663e\u793a\u9690\u85cf\u6587\u4ef6\uff08\u5939\uff09\uff1b  </li> <li><code>ls -lhFSr</code>\uff1a\u6309\u6587\u4ef6\u5927\u5c0f\u5347\u5e8f\u6392\u5217\uff1b  </li> <li><code>ls -lhFtr</code>\uff1a\u6309\u4fee\u6539\u65f6\u95f4\u5347\u5e8f\u6392\u5217\uff1b  </li> </ul> <p>ls \u9012\u5f52\u5217\u4e3e\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u7136\u540e\u6309\u7167\u6587\u4ef6\u540d\u5339\u914d\u8fc7\u6ee4\u51fa\u90e8\u5206\u6587\u4ef6\u4e88\u4ee5\u5220\u9664\uff1a</p> <pre><code>rm $(ls -AR | grep -e .DS_Store -e AVEngine.log -e *_WTLOGIN.*.log)\n</code></pre>","tags":["ls"]},{"location":"blog/20191029/linux-cmd-ls/#ls_only_filedir","title":"ls only file/dir","text":"<p>\u6ce8\u610f\uff1als \u6a21\u7cca\u5339\u914d\u76ee\u5f55\u6216\u6587\u4ef6\uff0c\u662f\u57fa\u4e8e\u901a\u914d\u7b26\uff08globbing/wildcard patterns\uff09\uff0c\u800c\u975e\u6b63\u5219\u8868\u8fbe\u5f0f\uff01</p> <ul> <li><code>ls -d */</code>\uff1a\u901a\u914d\u7b26\u8bed\u6cd5\uff0c\u5217\u4e3e\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u5b50\u76ee\u5f55  </li> <li><code>ls -1 -d Pods/*</code>\uff1a\u5217\u4e3e Pods \u6240\u6709\u5b50\u76ee\u5f55\uff0c\u65b9\u4fbf\u91cd\u5b9a\u5411\u7ed9\u5176\u4ed6\u547d\u4ee4\u5904\u7406  </li> <li><code>ls -l | grep '^d'</code>\uff1agrep \u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u8fc7\u6ee4\u51fa\u4ee5 d \u5f00\u5934\u7684\u6587\u4ef6\u5939 </li> <li><code>ls -al | grep '^[^d]'</code>\uff1agrep \u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u8fc7\u6ee4\u51fa\u975e d \u5f00\u5934\u7684\u6587\u4ef6 </li> </ul> <p>\u5176\u4ed6\u547d\u4ee4\uff1a</p> <ul> <li><code>find . -maxdepth 1 -type d</code> </li> <li><code>tree -d -L 1</code> </li> </ul> <p>Listing only directories in UNIX ls to view directories only List Directories in Unix and Linux Systems first two results from ls command </p>","tags":["ls"]},{"location":"blog/20191029/linux-cmd-ps-kill/","title":"Linux Command - ps, kill","text":"<p>linux \u4e0b\u7684\u547d\u4ee4 ps, kill \u7b80\u4ecb\u3002</p>","tags":["ps","kill"]},{"location":"blog/20191029/linux-cmd-ps-kill/#ps","title":"ps","text":"<p>\u4ee5\u4e0b\u4e3a\u4e3a\u5404\u5927\u5e73\u53f0 ps \u547d\u4ee4\u5728\u7ebf\u624b\u518c\uff1a</p> <ul> <li>unix/POSIX - ps - report process status </li> <li>FreeBSD/Darwin - ps -- process status </li> <li>linux - ps - report a snapshot of the current processes </li> <li>debian - ps - report a snapshot of the current processes </li> <li>ubuntu - ps - report a snapshot of the current processes </li> <li>windows - tasklist - Displays a list of currently running processes </li> </ul> <pre><code>$ man ps # macOS\n\nPS(1)                     BSD General Commands Manual                    PS(1)\n\nNAME\n     ps -- process status\n\nSYNOPSIS\n     ps [-AaCcEefhjlMmrSTvwXx] [-O fmt | -o fmt] [-G gid[,gid...]] [-g grp[,grp...]] [-u uid[,uid...]]\n        [-p pid[,pid...]] [-t tty[,tty...]] [-U user[,user...]]\n     ps [-L]\n</code></pre> <p><code>ps</code> \u53ea\u5217\u4e3e\u5f53\u524d\u7528\u6237\u8fdb\u7a0b\uff0c<code>ps -A</code> \u6216 <code>ps -e</code> \u5219\u4f1a\u5217\u4e3e\u5176\u4ed6\u7528\u6237\u8fdb\u7a0b\u3002</p> <pre><code>$ ps\n  PID TTY           TIME CMD\n 1701 ttys000    0:00.10 /bin/zsh -l\n 4338 ttys004    0:03.58 /Applications/Xcode.app/Contents/Developer/usr/bin/xcdevice observe --both\n13387 ttys005    0:01.47 -zsh\n 9710 ttys007    0:00.29 ssh pifan@rpi4b-ubuntu.local\n</code></pre> <pre><code>$ ps x\n  PID   TT  STAT      TIME COMMAND\n 1701 s000  Ss+    0:00.10 /bin/zsh -l\n 4338 s004  Ss+    0:03.58 /Applications/Xcode.app/Contents/Developer/usr/bin/xcdevice observe --both\n13386 s005  Ss     0:00.06 /usr/bin/login -fpl faner /Applications/iTerm.app/Contents/MacOS/ShellLauncher --launch_shell\n13387 s005  S      0:01.57 -zsh\n16312 s005  R+     0:00.00 ps x\n 9710 s007  Ss+    0:00.29 ssh pifan@rpi4b-ubuntu.local\n</code></pre>","tags":["ps","kill"]},{"location":"blog/20191029/linux-cmd-ps-kill/#pstree","title":"pstree","text":"<pre><code>$ man pstree # on macOS\n\nPSTREE(1)                 BSD General Commands Manual                PSTREE(1)\n\nNAME\n     pstree -- list processes as a tree\n\nSYNOPSIS\n     pstree [-Uw] [-f file] [-g n] [-l n] [-p pid] [-s string] [-u user] [rootpid ...]\n</code></pre>","tags":["ps","kill"]},{"location":"blog/20191029/linux-cmd-ps-kill/#top","title":"top","text":"<pre><code>$ man top # macOS\n\nTOP(1)                    BSD General Commands Manual                   TOP(1)\n\nNAME\n     top -- display sorted information about processes\n\nSYNOPSIS\n     top [-a | -d | -e | -c mode]\n         [-F | -f]\n         [-h]\n         [-i interval]\n         [-l samples]\n         [-ncols columns]\n         [-o key | -O skey]\n         [-R | -r]\n         [-S]\n         [-s delay-secs]\n         [-n nprocs]\n         [-stats keys]\n         [-pid processid]\n         [-user username]\n         [-U username]\n         [-u]\n</code></pre>","tags":["ps","kill"]},{"location":"blog/20191029/linux-cmd-ps-kill/#kill","title":"kill","text":"<pre><code>$ man kill # macOS\n\nKILL(1)                   BSD General Commands Manual                  KILL(1)\n\nNAME\n     kill -- terminate or signal a process\n\nSYNOPSIS\n     kill [-s signal_name] pid ...\n     kill -l [exit_status]\n     kill -signal_name pid ...\n     kill -signal_number pid ...\n</code></pre>","tags":["ps","kill"]},{"location":"blog/20191029/linux-cmd-ps-kill/#pgreppkill","title":"pgrep/pkill","text":"<pre><code>$ man pkill # macOS\n\nPKILL(1)                  BSD General Commands Manual                 PKILL(1)\n\nNAME\n     pgrep, pkill -- find or signal processes by name\n\nSYNOPSIS\n     pgrep [-Lafilnoqvx] [-F pidfile] [-G gid] [-P ppid] [-U uid] [-d delim] [-g pgrp] [-t tty] [-u euid] pattern ...\n     pkill [-signal] [-ILafilnovx] [-F pidfile] [-G gid] [-P ppid] [-U uid] [-g pgrp] [-t tty] [-u euid] pattern ...\n</code></pre> <p>Bash: Killing all processes in subprocess</p> <p>You can set a trap in the subshell to kill any active jobs before exiting:</p> <pre><code>(trap 'kill $(jobs -p)' EXIT; sleep 5; echo done ) &amp; pid=$!\n</code></pre> <p>This does not work for me. What is jobs -p supposed to output? It doesn't output anything when I run it.</p> <p>I don't know exactly why that sleep process gets orphaned, anyway instead kill you can use pkill with -P flag to also kill all children</p> <pre><code>pkill -TERM -P $pid\n</code></pre> <p>EDIT: that means that in order to kill a process and all it's children you should use instead</p> <pre><code># gets pids of child processes\nCPIDS=`pgrep -P $pid`\nkill -KILL $pid\nfor cpid in $CPIDS ; do kill -9 $cpid ; done\n</code></pre>","tags":["ps","kill"]},{"location":"blog/20191029/linux-cmd-ps-kill/#pslistrkill","title":"pslist/rkill","text":"<ul> <li>FreeBSD - pslist </li> <li>debian - pslist </li> </ul> <pre><code>PSLIST(1)                  BSD General Commands Manual                 PSLIST(1)\n\nNAME\n     pslist -- control processes and their descendants\n\nSYNOPSIS\n     pslist [pid/name...]\n     pslist -h | --help\n     pslist -v | --version\n\n     rkill [-SIG] pid/name...\n\n     rrenice [+/-]pri pid/name...\n</code></pre> <p>Bash: Killing all processes in subprocess</p> <p>You can have a look at <code>rkill</code> that seems to meet your requirements :</p> <p>Works, though <code>pslist</code>/<code>rkill</code> does not seem to be standard tool installed on most Linux systems</p>","tags":["ps","kill"]},{"location":"blog/20191029/linux-cmd-ps-kill/#systemadmin","title":"systemadmin","text":"<p>ohmyzsh/plugins/systemadmin/ \u63d0\u4f9b\u4e86\u4e00\u4e9b ps \u548c kill \u7684\u4fbf\u6377\u5c01\u88c5\u3002</p> <p>pkill \u6740\u6b7b\u6307\u5b9aprocess name\uff0ckill\u5219\u57fa\u4e8ePID\u6740\u8fdb\u7a0b\u3002</p> <pre><code># \u6740\u6b7b\u6302\u8d77\u8fdb\u7a0b\nkill_run() {\n    pkill -KILL nginx # default SIGTERM\n    pgrep -f 'dart run.*SHELF_PROXY' | xargs kill -KILL\n    pgrep -f 'flutter run.*NGINX_REVERSE_PROXY' | xargs kill -KILL\n#     ps -ef | grep '(dart|flutter) run' | grep -v grep | awk '{ print $2}' | xargs kill -KILL\n}\n</code></pre> <p>\u67e5\u770b Linux TCP Port \u88ab\u54ea\u96bb\u7a0b\u5f0f(Process)\u4f54\u7528 Finding the PID of the Process Using a Specific Port Linux Find Out Which Process Is Listening Upon a Port 3 Ways to Find Out Which Process Listening on a Particular Port </p> <pre><code>lsof -i :8010 | awk 'NR&gt;1 {print $2}' | xargs kill -KILL\n</code></pre>","tags":["ps","kill"]},{"location":"blog/20191029/linux-cmd-split-merge/","title":"Linux Command - file split & merge","text":"<p>linux \u4e0b\u5206\u5272\u548c\u5408\u5e76\u6587\u4ef6\u547d\u4ee4\u7b80\u4ecb\u3002</p>","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-split-merge/#diff","title":"diff","text":"<p>How to Compare Two Files in Bash Script</p> <p>unix - how to compare output of two ls in linux</p> <p>Compare two files and output the differences</p>","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-split-merge/#join","title":"join","text":"<p>Bash join ls output - Stack Overflow</p> <p>No need to run\u00a0ls\u00a0twice, just put multiple file specifications as arguments.</p> <pre><code>ls $dir1 $dir2\n\n(ls $dir1; ls $dir2) | sort\n\n{ ls $dir1 &amp;&amp; ls $dir2; }\n\nfind $dir1 $dir2 -mindepth 1 -maxdepth 1 | sort\n</code></pre>","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-split-merge/#comm","title":"comm","text":"<p>Intersection of two lists in Bash - Stack Overflow</p> <p>Use the comm command:</p> <pre><code>comm -12 &lt;(ls $dir1) &lt;(ls $dir2)\n</code></pre> <pre><code>ls $dir1 | sort &gt; /tmp/one_list\nls $dir2 | sort &gt; /tmp/two_list\ncomm -12 /tmp/one_list /tmp/two_list\n</code></pre> <p>comm\u00a0requires the inputs to be sorted. In this case,\u00a0ls\u00a0automatically sorts its output, but other uses may need to do this:</p> <pre><code>comm -12 &lt;(some-command | sort) &lt;(some-other-command | sort)\n</code></pre> <p>Alternative with\u00a0<code>sort</code>:</p> <p>Intersection of two lists: </p> <pre><code>sort &lt;(ls $dir1) &lt;(ls $dir2) | uniq -d\n</code></pre> <p>Symmetric difference of two lists:</p> <pre><code>sort &lt;(ls $dir1) &lt;(ls $dir2) | uniq -u\n</code></pre> <p>\u4efb\u52a1\uff1amacOS \u67e5\u627e/usr/bin/ \u548c/Library/Developer/CommandLineTools/usr/bin/ \u4e0b\u7684\u540c\u540d\u6587\u4ef6\u3002</p> <pre><code>xcdevpath=`xcode-select -p`\ndir1=/Library/Developer/CommandLineTools/usr/bin\ndir2=/usr/bin\n\ncomm -12 &lt;(ls $dir1) &lt;(ls $dir2)\nsort &lt;(ls $dir1) &lt;(ls $dir2) | uniq -d\n</code></pre>","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-split-merge/#split","title":"split","text":"<p>How to split a large text file into smaller files with equal number of lines?</p> <pre><code>\u2717 split -h\nsplit: illegal option -- h\nusage: split [-a sufflen] [-b byte_count] [-l line_count] [-p pattern]\n             [file [prefix]]\n</code></pre> <p>\u5c06\u5927\u6587\u4ef6 <code>mybigfile.txt</code> \u5206\u5272\u6210\u5c0f\u6587\u4ef6\uff0c\u6bcf\u4e2a\u5c0f\u6587\u4ef6\u6700\u591a20\u4e07\u884c\uff1a</p> <pre><code>split -l 200000 mybigfile.txt\n</code></pre> <p>\u57fa\u4e8e <code>sed</code> \u63d0\u53d6 1~100 \u884c\u5185\u5bb9\u5230\u6587\u4ef6\uff1a</p> <pre><code>sed -n '1,100p' filename &gt; output.txt\n</code></pre> <p>How to Split Large Text File into Smaller Files in Linux</p> <p>11 Useful split command examples for Linux/UNIX systems</p>","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-split-merge/#merge","title":"merge","text":"","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-split-merge/#windows","title":"Windows","text":"<p>Merge a text (.txt) file in the Windows command line</p> <p>Type in the following command to merge all TXT files in the current directory into the file named newfile.txt (any name could be used).</p> <pre><code>copy *.txt newfile.txt\n</code></pre>","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-split-merge/#linux","title":"Linux","text":"<p>Merge a file in the Linux command line</p> <p>Linux users can merge two or more files into one file using the merge command or lines of files using the paste command.</p> <p>Linux merge command</p> <p>Linux paste command</p>","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-split-merge/#cat","title":"cat","text":"<p>unix/POSIX - cat FreeBSD/Darwin - cat </p> <p>linux - cat(1) - cat(1p) debian/Ubuntu - cat </p> <p>cat(1) - concatenate files and print on the standard output</p> <p>SYNOPSIS: <code>cat [OPTION]... [FILE]...</code></p> <p>macOS \u4e0b cat \u547d\u4ee4\u53ea\u652f\u63017\u4e2a\u9009\u9879 <code>cat [-benstuv] [file ...]</code></p> <pre><code>     -b      Number the non-blank output lines, starting at 1.\n\n     -e      Display non-printing characters (see the -v option), and display a dollar sign (`$') at the end\n             of each line.\n\n     -n      Number the output lines, starting at 1.\n\n     -s      Squeeze multiple adjacent empty lines, causing the output to be single spaced.\n\n     -t      Display non-printing characters (see the -v option), and display tab characters as `^I'.\n\n     -u      Disable output buffering.\n\n     -v      Display non-printing characters so they are visible.  Control characters print as `^X' for con-\n             trol-X; the delete character (octal 0177) prints as `^?'.  Non-ASCII characters (with the high\n             bit set) are printed as `M-' (for meta) followed by the character for the low 7 bits.\n</code></pre> <p><code>-n</code>\uff1anumber all output lines\uff0c\u6253\u5370\u6240\u6709\u884c\u53f7\u3002 <code>-b</code>\uff1anumber nonempty output lines, overrides <code>-n</code>\u3002\u975e\u7a7a\u884c\u624d\u663e\u793a\u884c\u53f7\u3002 <code>-s</code>\uff1asuppress repeated empty output lines\uff0c\u5c06\u4e24\u884c\u4ee5\u4e0a\u7684\u7a7a\u884c\u538b\u7f29\u4e3a\u4e00\u884c\u7a7a\u767d\u3002 <code>-v</code>\uff1ause <code>^</code> and <code>M-</code> notation, except for LFD and TAB\u3002 <code>-e</code>(end)\uff1a\u663e\u793a\u975e\u6253\u5370\u5b57\u7b26\uff0c\u5728 <code>-v</code> \u7684\u57fa\u7840\u4e0a\uff0c\u884c\u672b LFD \u663e\u793a<code>$</code>\u7b26\u53f7\u3002linux \u4e0b\u7b49\u6548\u4e8e <code>-vE</code>\u3002 <code>-t</code>(tab)\uff1a\u663e\u793a\u975e\u6253\u5370\u5b57\u7b26\uff0c\u5728 <code>-v</code> \u7684\u57fa\u7840\u4e0a\uff0c\u5236\u8868\u7b26 TAB \u663e\u793a\u4e3a<code>^I</code>\u3002linux \u4e0b\u7b49\u6548\u4e8e <code>-vT</code>\u3002  </p> <p>Windows CRLF \u65f6\uff0c<code>-v</code> \u5c06\u5728\u884c\u672b\u663e\u793a <code>^M</code>\u3002 <code>-et</code> \u76f8\u5f53\u4e8e linux \u4e0b\u7684 <code>-A</code> = <code>-vET</code>\u3002  </p> <p>linux \u4e0b\u591a\u51fa3\u4e2a\u9009\u9879\uff1a</p> <pre><code>       -A, --show-all\n              equivalent to -vET\n\n       -E, --show-ends\n              display $ at end of each line\n\n       -T, --show-tabs\n              display TAB characters as ^I\n</code></pre> <p>Linux: Putting two or more files together using cat How to Combine Text Files Using the \u201ccat\u201d Command in Linux How can I concatenate two files in Unix? </p> <p>\u901a\u8fc7\u547d\u4ee4\u884c\u5728 file4 \u672b\u5c3e\u8ffd\u52a0\u8f93\u5165\u5185\u5bb9\uff1a</p> <pre><code>cat &gt;&gt; file4.txt\n</code></pre> <p>\u8f93\u5165\u6700\u540e\u4e00\u884c\u540e\uff0c\u6362\u884c + Ctrl-D \u7ed3\u675f\u3002</p> <p>\u5c06 file1\u3001file2 \u8fd92\u4e2a\u6587\u4ef6\u8ffd\u52a0\u5230 file3 \u5c3e\u90e8:</p> <pre><code>cat file1.txt file2.txt &gt;&gt; file3.txt\n</code></pre> <p>\u5c06 file1\u3001file2\u3001file3 \u8fd93\u4e2a\u6587\u4ef6\u5408\u5e76\u6210 file4\uff08\u8986\u76d6\uff09:</p> <pre><code>cat file1.txt file2.txt file3.txt &gt; file4.txt\n</code></pre> <p>How can I cat multiple files together into one without intermediary file?</p> <pre><code>for file in file1 file2 file3 ... fileN; do\n  cat \"$file\" &gt;&gt; bigFile &amp;&amp; rm \"$file\"\ndone\n</code></pre> <p>\u5047\u5982\u5f53\u524d\u76ee\u5f55\u4e0b\u6709\u51e0\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u5e76\u4e14\u662f\u6309\u7167\u65f6\u95f4\u6392\u5e8f\u7684\uff1a</p> <pre><code>Logs $ ls\n1001-10K.log 1003-20K.log 1004-30K.log 1006-40K.log 1007-50K.log 1009-60K.log 1010-70K.log\nLogs $ ls -1\n1001-10K.log\n1003-20K.log\n1004-30K.log\n1006-40K.log\n1007-50K.log\n1009-60K.log\n1010-70K.log\n</code></pre> <p>\u53ef\u5c06\u6240\u6709\u6587\u4ef6\uff08\u540d\uff09\u4f5c\u4e3a cat \u7684\u5217\u8868\u53c2\u6570\uff0c\u5c06\u5b83\u4eec\u62fc\u63a5\u6210\u4e00\u4e2a\u5927\u7684\u65e5\u5fd7\u8fdb\u884c\u7efc\u5408\u5206\u6790\uff1a</p> <pre><code>Logs $ ls | xargs cat &gt; ../1001_1010-10K_70K.log\n</code></pre> <p>\u5982\u679c\u8981\u4ece\u591a\u5c42\u76ee\u5f55\u4e2d\u7b5b\u68c0\u6587\u4ef6\uff0c\u9700\u8981 <code>ls -R | grep</code> \u6216\u501f\u52a9 <code>find</code> \u547d\u4ee4\u3002</p>","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-split-merge/#tee","title":"tee","text":"<p>\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u65b0\u5efa\u6587\u4ef6\uff1b \u5982\u679c\u6587\u4ef6\u5df2\u5b58\u5728\uff0c\u5219\u4f1a Truncate/Overwrite \u8986\u5199\u5df2\u6709\u6587\u4ef6\uff1a</p> <pre><code>cat file1.txt file2.txt file3.txt | tee file4.txt\n</code></pre> <p>\u5982\u679c\u60f3\u8ffd\u52a0\u5230\u5df2\u5b58\u5728\u6587\u4ef6\u5c3e\u90e8\uff0c\u53ef\u6307\u5b9a <code>-a</code> \u9009\u9879\uff1a</p> <pre><code>cat file1.txt file2.txt file3.txt | tee -a file4.txt\n</code></pre>","tags":["split","cat"]},{"location":"blog/20191029/linux-cmd-tree/","title":"Linux Command - tree","text":"<p>linux \u4e0b\u7684\u547d\u4ee4 tree \u7b80\u4ecb\u3002</p>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#microsoft_dos_tree_command","title":"Microsoft DOS tree command","text":"","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#function","title":"function","text":"<p>\u4ee5\u56fe\u5f62\u663e\u793a\u9a71\u52a8\u5668\u6216\u8def\u5f84\u7684\u6587\u4ef6\u5939\u7ed3\u6784\u3002</p>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#help","title":"help","text":"<p><code>tree /?</code>\uff1a\u67e5\u770b\u5e2e\u52a9</p>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#usages__synopsis","title":"usages &amp; synopsis","text":"<p><code>TREE [Drive:[[Path] [/F] [/A]</code></p> option instruction <code>Drive:\\Path</code> Drive and directory containing disk for display of directory structure. <code>/F</code> Displays file names in each directory.\u663e\u793a\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e2d\u6587\u4ef6\u7684\u540d\u79f0\u3002 <code>/A</code> ext characters used for linking lines, instead of graphic characters. <code>/a</code> is used with code pages that do not support graphic characters and to send output to printers that do not properly interpret graphic characters.\u4f7f\u7528 ASCII \u5b57\u7b26\uff0c\u800c\u4e0d\u4f7f\u7528\u6269\u5c55\u5b57\u7b26\u3002 <p>\u4f7f\u7528 <code>/F</code> \u53c2\u6570\u65f6\u663e\u793a\u6240\u6709\u76ee\u5f55\u53ca\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u3002</p>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#demonstrations","title":"demonstrations","text":"<ol> <li> <p>\u628a D \u76d8\u4e0b\u7684\u6240\u6709\u76ee\u5f55\u7ed3\u6784\u4ee5\u6811\u72b6\u7ed3\u6784\u5bfc\u51fa\uff0c\u4ee5\u6587\u672c\u6587\u4ef6 <code>dTree.txt</code> \u4fdd\u5b58\u5728\u6587\u4ef6\u5939 <code>d:\\</code> \u4e0b\u3002</p> <p>tree d: &gt; d:\\dTree.txt \u6216 tree d: &gt; d:\\dTree.txt</p> </li> <li> <p>\u628a D \u76d8\u4e0b\u7684\u6240\u6709\u76ee\u5f55\u53ca\u6587\u4ef6\u7ed3\u6784\u4ee5\u6811\u72b6\u7ed3\u6784\u5bfc\u51fa\uff0c\u4ee5\u6587\u672c\u6587\u4ef6 <code>dF.txt</code> \u4fdd\u5b58\u5728\u6587\u4ef6\u5939 <code>d:\\</code> \u4e0b\u3002</p> <p>tree d: /f &gt; d:\\dF.txt \u6216 tree d: /f &gt; d:\\dF.txt</p> </li> </ol>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#reference","title":"reference","text":"<p>Windows \u4e2d\u7684 Tree \u547d\u4ee4\u4f60\u4f1a\u7528\u5417\uff1f \u6700\u5f3a\u6700\u5168\u7684Tree\u547d\u4ee4\u8be6\u89e3 Saving 'tree /f /a\" results to a textfile with unicode support</p>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#macos_\u4e0b\u7684_tree_\u547d\u4ee4","title":"macOS \u4e0b\u7684 tree \u547d\u4ee4","text":"","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#function_1","title":"function","text":"<p>list contents of directories in a tree-like format.</p>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#help_1","title":"help","text":"<p><code>tree --version</code>\uff1a\u67e5\u770b\u7248\u672c\uff08Print version and exit.\uff09 <code>tree --help</code>\uff1a\u67e5\u770b\u5e2e\u52a9\uff08Print usage and this help message and exit.\uff09 <code>man tree</code>\uff1a\u67e5\u770b\u8be6\u7ec6\u5e2e\u52a9\u624b\u518c  </p>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#usages__synopsis_1","title":"usages &amp; synopsis","text":"<p><code>tree [-acdfghilnpqrstuvxACDFQNSUX]</code></p> <pre><code>usage: tree [-acdfghilnpqrstuvxACDFJQNSUX] [-H baseHREF] [-T title ]\n    [-L level [-R]] [-P pattern] [-I pattern] [-o filename] [--version]\n    [--help] [--inodes] [--device] [--noreport] [--nolinks] [--dirsfirst]\n    [--charset charset] [--filelimit[=]#] [--si] [--timefmt[=]&lt;f&gt;]\n    [--sort[=]&lt;name&gt;] [--matchdirs] [--ignore-case] [--] [&lt;directory list&gt;]\n</code></pre> <ol> <li>------- Listing options -------</li> <li>-------- File options ---------</li> <li>------- Sorting options -------</li> <li>------- Graphics options ------</li> <li>------- XML/HTML/JSON options -------</li> <li>---- Miscellaneous options ----</li> </ol>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#demonstrations_1","title":"demonstrations","text":"<ul> <li><code>-d</code>\uff1aList directories only\uff08\u6253\u5370\u76ee\u5f55\uff09</li> </ul> <pre><code>faner@FAN-MB0:~/Library/Application Support/FoldingText/Plug-Ins|\n\u21d2  tree -d\n.\n\u251c\u2500\u2500 change\\ document\\ expansion\\ level.ftplugin\n\u251c\u2500\u2500 change\\ number\\ of\\ heading\\ levels.ftplugin\n\u251c\u2500\u2500 concentrate.ftplugin\n\u251c\u2500\u2500 date\\ and\\ time.ftplugin\n\u251c\u2500\u2500 paste\\ table\\ of\\ shortcut\\ keys.ftplugin\n\u251c\u2500\u2500 rendered_images.ftplugin\n\u251c\u2500\u2500 smart\\ quotes.ftplugin\n\u2514\u2500\u2500 theme\\ basic.ftplugin\n    \u251c\u2500\u2500 assets\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 Orig_ratio\n    \u2514\u2500\u2500 images\n\n11 directories\n</code></pre> <ul> <li><code>-L level</code>\uff1aDescend only level directories deep\uff08\u6307\u5b9a\u76ee\u5f55\u5c42\u7ea7\uff09</li> </ul> <pre><code>faner@FAN-MB0:~/Library/Application Support/Sublime Text 3/Packages|\n\u21d2  tree -d -L 1\n.\n\u251c\u2500\u2500 Clickable\\ Urls\n\u251c\u2500\u2500 Codecs33\n\u251c\u2500\u2500 Color\\ Scheme\\ -\\ Brogrammer\n\u251c\u2500\u2500 ConvertToUTF8\n\u251c\u2500\u2500 Delete\\ Blank\\ Lines\n\u251c\u2500\u2500 FileBrowser\n\u251c\u2500\u2500 Filter\\ Lines\n\u251c\u2500\u2500 GBK\\ Encoding\\ Support\n\u251c\u2500\u2500 OmniMarkupPreviewer\n\u251c\u2500\u2500 User\n\u251c\u2500\u2500 backrefs\n\u251c\u2500\u2500 bs4\n\u251c\u2500\u2500 markupsafe\n\u251c\u2500\u2500 mdpopups\n\u251c\u2500\u2500 package_events\n\u251c\u2500\u2500 pathtools\n\u251c\u2500\u2500 pygments\n\u251c\u2500\u2500 python-jinja2\n\u251c\u2500\u2500 python-markdown\n\u251c\u2500\u2500 pyyaml\n\u2514\u2500\u2500 watchdog\n\n21 directories\n</code></pre>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-tree/#reference_1","title":"reference","text":"<p>mac\u5b89\u88c5tree\u547d\u4ee4 MAC\u7ec8\u7aef\u4e2d\u5b89\u88c5\u547d\u4ee4\u884c\u5de5\u5177TREE mac \u4e0a\u4f7f\u7528tree\u547d\u4ee4\u751f\u6210\u6811\u72b6\u76ee\u5f55 mac \u4e0b\u7684 tree \u547d\u4ee4 \u7ec8\u7aef\u5c55\u793a\u4f60\u7684\u76ee\u5f55\u6811\u7ed3\u6784 </p>","tags":["tree"]},{"location":"blog/20191029/linux-cmd-utility/","title":"Linux Command - utilities","text":"<p>linux \u4e0b\u4e00\u4e9b\u5b9e\u7528\u7684\u5c0f\u547d\u4ee4\u96c6\u9526\u3002</p>"},{"location":"blog/20191029/linux-cmd-utility/#cd","title":"cd","text":"<p>cd\uff08change directory\uff09\uff1a\u5207\u6362\u6587\u4ef6\u76ee\u5f55\u3002</p> <ul> <li><code>cd</code> / <code>cd ~</code>\uff1a\u8fdb\u5165\u5f53\u524d\u7528\u6237\u7684\u5bb6\u76ee\u5f55\uff08$HOME\uff09\uff1b  </li> <li><code>cd ..</code>\uff1a\u8fd4\u56de\u4e0a\u7ea7\u76ee\u5f55\uff1b  </li> <li><code>cd -</code>\uff1a\u8fd4\u56de\u4e0a\u6b21\u8bbf\u95ee\u76ee\u5f55\uff08\u76f8\u5f53\u4e8e <code>cd $OLDPWD</code>\uff09\uff0c\u518d\u6b21\u6267\u884c\u5728\u8fd1\u4e24\u6b21\u76ee\u5f55\u4e4b\u95f4\u5207\u6362\u3002  </li> </ul> <p>\u5207\u6362\u5230\u5e26\u6709\u7a7a\u683c\u7684\u8def\u5f84\uff0c\u9700\u8981\u52a0\u8f6c\u4e49\u5b57\u7b26\uff08\u53cd\u659c\u6760\\\uff09\u6765\u6807\u8bc6\u7a7a\u683c\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u4ece <code>~/</code> \u76ee\u5f55\u5207\u6362\u5230 <code>/Library/Application Support/Sublime Text 3/Packages/User</code>\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  cd /Users/faner/Library/Application\\ Support/Sublime\\ Text\\ 3/Packages/User/\nfaner@FAN-MB0:~/Library/Application Support/Sublime Text 3/Packages/User|\n\u21d2  \n</code></pre> <p>\u53e6\u5916\u4e00\u79cd\u505a\u6cd5\u662f\u5b9a\u4e49 shell \u5b57\u7b26\u4e32\u53d8\u91cf\uff0c\u7136\u540e\u4f7f\u7528 $ \u7b26\u53f7\u89e3\u5f15\u7528\u53d8\u91cf\u4f5c\u4e3a cd \u7684\u53c2\u6570\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  dir=\"/Users/faner/Library/Application Support/Sublime Text 3/Packages/User/\"                    \nfaner@FAN-MB0:~|\u21d2  cd $dir\nfaner@FAN-MB0:~/Library/Application Support/Sublime Text 3/Packages/User|\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#pushd__popd","title":"pushd &amp; popd","text":"<p><code>cd -</code> \u53ef\u5728\u8fd1\u4e24\u6b21\u76ee\u5f55\u4e4b\u95f4\u5207\u6362\uff0c\u5f53\u6d89\u53ca3\u4e2a\u4ee5\u4e0a\u7684\u5de5\u4f5c\u76ee\u5f55\u9700\u8981\u5207\u6362\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 pushd \u548c popd \u547d\u4ee4\u3002</p> <p>macOS \u7684 zsh \u547d\u4ee4\u884c\u8f93\u5165 push \u7136\u540e tab \u53ef\u4ee5\u67e5\u770b\u6240\u6709 push \u76f8\u5173\u547d\u4ee4\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  push\npushd   pushdf  pushln\n</code></pre> <ul> <li>\u5176\u4e2d pushdf \u8868\u793a\u5207\u6362\u5230\u5f53\u524d Finder \u76ee\u5f55\uff08<code>pushd</code> to the current Finder directory\uff09\u3002  </li> <li>\u5173\u4e8e pushln \u53ef\u53c2\u8003 zsh-manual Shell Builtin Commands \u4e2d\u7684\u8bf4\u660e\u3002  </li> </ul> <p>\u5728 macOS \u7ec8\u7aef\u4e2d\u6267\u884c <code>man pushd</code> \u6216 <code>man popd</code> \u53ef\u77e5\uff0c\u4ed6\u4eec\u4e3a BASH \u5185\u7f6e\u547d\u4ee4\uff08Shell builtin commands\uff09\u3002</p> <p><code>pushd</code> \u548c <code>popd</code> \u53ef\u4ee5\u7528\u4e8e\u5728\u591a\u4e2a\u76ee\u5f55\uff08directory\uff09\u4e4b\u95f4\u8fdb\u884c\u5207\u6362\uff08push/pop\uff09\u800c\u65e0\u9700\u590d\u5236\u5e76\u7c98\u8d34\u76ee\u5f55\u8def\u5f84\u3002 </p> <p><code>pushd</code> \u548c <code>popd</code> \u4ee5\u6808\u7684\u65b9\u5f0f\u6765\u8fd0\u4f5c\uff0c\u540e\u8fdb\u5148\u51fa\uff08Last In First Out, LIFO\uff09\u3002\u76ee\u5f55\u8def\u5f84\u88ab\u5b58\u50a8\u5728\u6808\u4e2d\uff0c\u7136\u540e\u7528 push \u548c pop \u64cd\u4f5c\u5728\u76ee\u5f55\u4e4b\u95f4\u8fdb\u884c\u5207\u6362\u3002</p> <pre><code># \u6267\u884c dirs -c \u6e05\u7406\u6808\u4e4b\u540e\uff0c\u53ea\u5269\u5f53\u524d\u76ee\u5f55\nfaner@MBP-FAN:~|\u21d2  dirs\n~\n\n# \u5c06 ~/Downloads \u76ee\u5f55\u538b\u6808\nfaner@MBP-FAN:~|\u21d2  pushd Downloads \n~/Downloads ~\n\n# \u5c06 ~/Documents \u76ee\u5f55\u538b\u6808\nfaner@MBP-FAN:~/Downloads|\u21d2  pushd ../Documents \n~/Documents ~/Downloads ~\n\n# \u4f9d\u6b21\u6267\u884c pushd ../Movies\u3001pushd ../Pictures\u3001pushd ../AppData\u3001pushd ../Applications\u3001pushd ../Desktop\n\n# \u5c06 ~/Music \u76ee\u5f55\u538b\u6808\nfaner@MBP-FAN:~/Desktop|\u21d2  pushd ../Music \n~/Music ~/Desktop ~/Applications ~/AppData ~/Pictures ~/Movies ~/Documents ~/Downloads ~\n</code></pre> <p><code>dirs</code>\uff1a\u67e5\u770b\u5f53\u524d Shell \u7a97\u53e3\u64cd\u4f5c\u8fc7\u7684\u76ee\u5f55\u6808\u8bb0\u5f55\uff0c\u7d22\u5f150\u8868\u793a\u6808\u9876\u3002</p> <p><code>dirs [\u2212clpv] [+n] [\u2212n]</code> : Without options, displays the list of currently remembered directories.</p> \u9009\u9879 \u542b\u4e49 -p \u6bcf\u884c\u663e\u793a\u4e00\u6761\u8bb0\u5f55 -v \u6bcf\u884c\u663e\u793a\u4e00\u6761\u8bb0\u5f55\uff0c\u540c\u65f6\u5c55\u793a\u8be5\u8bb0\u5f55\u5728\u6808\u4e2d\u7684index -c \u6e05\u7a7a\u76ee\u5f55\u6808 <pre><code># \u67e5\u770b\u5f53\u524d\u6808\uff0c0\u4e3a\u6808\u9876\uff0c8\u4e3a\u6808\u5e95\nfaner@MBP-FAN:~/Music|\u21d2  dirs -v\n0   ~/Music\n1   ~/Desktop\n2   ~/Applications\n3   ~/AppData\n4   ~/Pictures\n5   ~/Movies\n6   ~/Documents\n7   ~/Downloads\n8   ~\n</code></pre> <ul> <li> <p>\u4e0d\u5e26\u53c2\u6570\u8f93\u5165 pushd \u4f1a\u5c06\u6808\u9876\u76ee\u5f55\u548c\u4e0b\u4e00\u76ee\u5f55\u5bf9\u8c03\uff0c\u76f8\u5f53\u4e8e <code>cd -</code> \u7684\u6548\u679c\u3002  </p> <p>pushd \u8fd8\u53ef\u4ee5\u5e26\u7d22\u5f15\u9009\u9879 +n\uff0c\u5207\u6362\u5230\u5f53\u524d\u6808\u4e2d\u4ece\u6808\u5e95\u5f00\u59cb\u8ba1\u6570\u7684\u67d0\u4e2a\u76ee\u5f55\u3002</p> </li> <li> <p>\u4e0d\u5e26\u53c2\u6570\u8f93\u5165 popd \u4f1a\u79fb\u9664\u6808\u9876\uff08\u5f53\u524d\uff09\u76ee\u5f55\uff0c\u5207\u6362\u5230\u4e0a\u4e00\u6b21\u8bbf\u95ee\u7684\u76ee\u5f55\u3002  </p> <p>popd \u8fd8\u53ef\u4ee5\u5e26\u7d22\u5f15\u9009\u9879 +n\uff0c\u79fb\u9664\u5f53\u524d\u6808\u4e2d\u4ece\u6808\u5e95\u5f00\u59cb\u8ba1\u6570\u7684\u67d0\u4e2a\u76ee\u5f55\u3002</p> </li> </ul> <p>\u5bf9\u4e8e <code>pushd +n</code> \u548c <code>popd +n</code>\uff0c\u7d22\u5f15\u987a\u5e8f\u4e0e <code>dirs -v</code> \u76f8\u53cd\uff0c\u4ece\u6808\u5e95\u5f00\u59cb\u8ba1\u6570\uff1b \u53cd\u8fc7\u6765 <code>pushd -n</code> \u548c <code>popd -n</code> \u7d22\u5f15\u987a\u5e8f\u4e0e <code>dirs -v</code> \u76f8\u540c\uff0c\u4ece\u6808\u9876\u5f00\u59cb\u8ba1\u6570\u3002</p> <pre><code># \u4ece\u6808\u5e95\uff08\u7d22\u5f15\u4e3a0\uff09\u53f3\u5f80\u5de6\u6570\u7b2c3\u4e2a\u76ee\u5f55 ~/Movies \u91cd\u65b0\u538b\u5165\u6808\u9876\uff0c\u76f8\u5f53\u4e8e\u5207\u6362\u5230\u8be5\u76ee\u5f55\nfaner@MBP-FAN:~/Music|\u21d2  pushd +3\n~/Movies ~/Documents ~/Downloads ~ ~/Music ~/Desktop ~/Applications ~/AppData ~/Pictures\n\n# \u4ece\u6808\u9876\uff08\u7d22\u5f15\u4e3a-0\uff09\u5de6\u5f80\u53f3\u6570\u7b2c3\u4e2a\u76ee\u5f55 ~ \u79fb\u9664\u51fa\u6808\nfaner@MBP-FAN:~/Movies|\u21d2  popd -3\n~/Movies ~/Documents ~/Downloads ~/Music ~/Desktop ~/Applications ~/AppData ~/Pictures\n\n# \u4ece\u6808\u9876\uff08\u7d22\u5f15\u4e3a-0\uff09\u5de6\u5f80\u53f3\u6570\u7b2c3\u4e2a\u76ee\u5f55 ~/Music \u91cd\u65b0\u538b\u5165\u6808\u9876\uff0c\u76f8\u5f53\u4e8e\u5207\u6362\u5230\u8be5\u76ee\u5f55\nfaner@MBP-FAN:~/Movies|\u21d2  pushd -3\n~/Music ~/Desktop ~/Applications ~/AppData ~/Pictures ~/Movies ~/Documents ~/Downloads\n\n# \u4ece\u6808\u5e95\uff08\u7d22\u5f15\u4e3a0\uff09\u53f3\u5f80\u5de6\u6570\u7b2c3\u4e2a\u76ee\u5f55 ~/Pictures \u79fb\u9664\u51fa\u6808\nfaner@MBP-FAN:~/Music|\u21d2  popd +3\n~/Music ~/Desktop ~/Applications ~/AppData ~/Movies ~/Documents ~/Downloads\n</code></pre> <p>Linux\u4e2d\u7684pushd\u548cpopd \u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528pushd\u548cpopd\u8fdb\u884c\u5feb\u901f\u5b9a\u4f4d </p>"},{"location":"blog/20191029/linux-cmd-utility/#dirname__basename","title":"dirname &amp; basename","text":"<p>dirname\u3001basename \u7528\u4e8e\u83b7\u53d6\u8def\u5f84\u5b57\u7b26\u4e32\u7684\u76ee\u5f55\u548c\u6587\u4ef6\u90e8\u5206\u3002</p> <pre><code>$ man basename\nBASENAME(1)               BSD General Commands Manual              BASENAME(1)\n\nNAME\n     basename, dirname -- return filename or directory portion of pathname\n\nSYNOPSIS\n     basename string [suffix]\n     basename [-a] [-s suffix] string [...]\n     dirname string\n</code></pre> <p>Linux\u4e2dbasename\u548cdirname\u547d\u4ee4\u7684\u5999\u7528</p> <p>\u5178\u578b\u5e94\u7528\u573a\u666f\uff1a\u5728sh\u811a\u672c\u4e2d\uff0c\u57fa\u4e8e dirname/basename \u83b7\u53d6\u5f53\u524d\u811a\u672c\u7684\u8def\u5f84\u548c\u540d\u79f0\u3002</p> <pre><code>echo \"dirname = $(dirname $0)\"\necho \"basename = $(basename $0)\"\n</code></pre> <p>\u4f8b\u5982 transfer.sh \u4e2d\uff0c\u4ece\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e2d\u57fa\u4e8e basename \u63d0\u53d6\u7eaf\u6587\u4ef6\u540d\uff1a</p> <pre><code>        file=\"$1\"\n        file_name=$(basename \"$file\")\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#printf","title":"printf","text":"<pre><code>$man bash\n\nSHELL BUILTIN COMMANDS\n\nprintf [\u2212v var] format [arguments]\n\nWrite the formatted arguments to the standard output under the control of the format. The format is a character string which contains three types of objects: plain characters, which are simply copied to standard output, character escape sequences, which are converted and copied to the standard output, and format speci\ufb01cations, each of which causes printing of the next successive argument. In addition to the standard printf(1) formats, %b causes printf to expand backslash escape sequences in the corresponding argument (except that \\c terminates output, backslashes in \\', \\\", and \\? are not removed, and octal escapes beginning with \\0 may contain up to four digits), and %q causes printf to output the corresponding argument in a format that can be reused as shell input.\n\nThe \u2212v option causes the output to be assigned to the variable var rather than being printed to the standard output.\n\nThe format is reused as necessary to consume all of the arguments. If the format requires more arguments than are supplied, the extra format speci\ufb01cations behave as if a zero value or null string, as appropriate, had been supplied. The return value is zero on success, non-zero on failure.\n</code></pre> <ul> <li>Shell printf\u547d\u4ee4\uff1a\u683c\u5f0f\u5316\u8f93\u51fa\u8bed\u53e5 </li> <li>Shell printf\u547d\u4ee4\u8be6\u89e3 </li> <li> <p>Bash Printf \u547d\u4ee4 </p> </li> <li> <p>Bash's Built-in printf Function </p> </li> <li>Linux printf command </li> <li>Bash Printf command </li> <li>Bash printf Command </li> <li>Bash printf Function: 7 Examples for Linux </li> </ul>"},{"location":"blog/20191029/linux-cmd-utility/#headtail","title":"head/tail","text":"<p>head/tail \u547d\u4ee4\u652f\u6301\u67e5\u770b\u6587\u4ef6(file)\u524d/\u540e\u6307\u5b9a\u5b57\u8282(-c)\u6216\u884c\u6570(-n)\u7684\u5185\u5bb9\u3002</p> <pre><code># macOS\n$ man head\nHEAD(1)                   BSD General Commands Manual                  HEAD(1)\n\nNAME\n     head -- display first lines of a file\n\nSYNOPSIS\n     head [-n count | -c bytes] [file ...]\n\n$ man tail\nTAIL(1)                   BSD General Commands Manual                  TAIL(1)\n\nNAME\n     tail -- display the last part of a file\n\nSYNOPSIS\n     tail [-F | -f | -r] [-q] [-b number | -c number | -n number] [file ...]\n</code></pre> <p>\u5728 bash_history \u4e2d\uff0c\u5f53\u8fc7\u5f80\u8f93\u5165\u5386\u53f2\u63a5\u8fd1 HISTSIZE \u65f6\uff0c<code>history</code> \u547d\u4ee4\u5217\u8868\u8f83\u957f\uff0c\u4e0d\u4fbf\u7ffb\u9605\u3002 \u6b64\u65f6\uff0c\u53ef\u901a\u8fc7\u7ba1\u9053\u547d\u4ee4\u5bfc\u5411 <code>head</code> / <code>tail</code> \u7b5b\u9009\u67e5\u770b\u5f00\u5934/\u7ed3\u5c3e\u90e8\u5206\u3002</p> <pre><code># history\u65e5\u5fd7\u6761\u76ee\u6309\u63d2\u5165\u65f6\u95f4\u5347\u5e8f\uff08\u4ece\u8fdc\u5230\u8fd1\uff09\n# \u67e5\u770b\u6700\u8fdc10\u6761\u8f93\u5165\u547d\u4ee4\u8bb0\u5f55\uff1a\n$ history | head # \u9ed8\u8ba4\u663e\u793a10\u6761\n$ history | head -n 10\n# \u67e5\u770b\u6700\u8fd110\u6761\u8f93\u5165\u547d\u4ee4\u8bb0\u5f55\uff1a\n$ history | tail # \u9ed8\u8ba4\u663e\u793a10\u6761\n$ history | tail -n 10\n</code></pre> <p>\u4e0b\u9762\u901a\u8fc7 du \u547d\u4ee4\u6309\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u5927\u5c0f\u964d\u5e8f\u5217\u4e3e\u67d0\u4e00\u76ee\u5f55\u4e0b\u5404\u4e2a\u5b50\u76ee\u5f55\u3002 \u5f53\u5b50\u76ee\u5f55\u592a\u591a\u65f6\uff0c\u53ef\u91cd\u5b9a\u5411\u7ed9 <code>more</code> \u6eda\u52a8\u67e5\u770b\uff0c\u6216\u91cd\u5b9a\u5411\u7ed9 <code>head</code> \u67e5\u770b\u524d10\u6761\u3002</p> <pre><code>$ du -csh ~/Library/Developer/* | sort -rh | head\n</code></pre> <p>\u5728 Linux \u4e0b\uff0chead \u7684 -n \u63a5\u8d1f\u53f7\u6570\uff08-NUM\uff09\u8868\u793a\u6253\u5370\u9664\u672b\u5c3e\u51e0\u884c\u7684\u5f00\u5934\u90e8\u5206\u3002</p> <pre><code>$ man head\n       -n, --lines=[-]NUM\n              print the first NUM lines instead of the first 10; with the leading\n              '-', print all but the last NUM lines of each file\n</code></pre> <p>\u5728 Linux \u4e0b\uff0ctail \u7684 -n \u63a5\u6b63\u53f7\u6570\uff08+NUM\uff09\u8868\u793a\u6253\u5370\u4ece\u7b2cNUM\u884c\u5f00\u5934\u5230\u5c3e\u90e8\u90e8\u5206\uff08\u5373\u5ffd\u7565\u524dNUM-1\u884c\uff09\u3002</p> <pre><code>$ man tail\n       -n, --lines=[+]NUM\n              output  the  last NUM lines, instead of the last 10; or use -n +NUM\n              to output starting with line NUM\n</code></pre> <p>\u5728 Linux \u4e0b\uff0c\u5982\u60f3\u6253\u5370\u9664\u5f00\u5934\u548c\u7ed3\u5c3e10\u884c\u7684\u4e2d\u95f4\u90e8\u5206\u53ef\u4ee5\u6267\u884c\uff1a<code>head -n -10 file.txt | tail +11</code>\u3002</p> <p>\u5728 macOS \u4e0b\u7531\u4e8e\u4e0d\u652f\u6301\u4ee5\u4e0a\u7279\u6027\uff0c\u9700\u8981\u6309\u7167\u4e0b\u9762\u7684\u6b65\u9aa4\u5b9e\u73b0\u540c\u7b49\u6548\u679c\uff1a</p> <pre><code># \u5148\u7edf\u8ba1\u603b\u884c\u6570\nlines=$(wc -l file.txt | awk '{print $1}')\n# \u51cf\u53bb\u672b\u5c3e10\u884c\uff0chead\u663e\u793a\u5f00\u5934\u90e8\u5206\nhl=$(expr $lines - 10)\n# \u518d\u51cf\u53bb\u5f00\u593410\u884c\uff0ctail\u663e\u793a\u672b\u5c3e\u90e8\u5206\ntl=$(expr $hl - 10)\nhead -n $hl file.txt | tail -n $tl\n</code></pre> <p><code>-f</code> \u53c2\u6570\u662f tail \u547d\u4ee4\u7684\u4e00\u4e2a\u7a81\u51fa\u7279\u6027\uff0c\u5b83\u4f7f\u8be5\u547d\u4ee4\u4fdd\u6301\u6d3b\u52a8\u72b6\u6001\uff0c\u652f\u6301\u76d1\u89c6\u6587\u4ef6\u8ffd\u52a0\u53d8\u66f4\uff0c\u5e76\u5b9e\u65f6\u663e\u793a\u8ffd\u52a0\u5230\u5230\u6587\u672b\u7684\u5185\u5bb9\u3002 \u8fd9\u662f\u5b9e\u65f6\u76d1\u6d4b\u65e5\u5fd7\u7684\u7edd\u5999\u65b9\u5f0f\uff0c\u53ef\u4ee5\u7528\u6765\u5b9e\u65f6\u6eda\u52a8\u663e\u793a\u65e5\u5fd7\u6587\u4ef6\u6700\u65b0\u7684\u5185\u5bb9\u3002</p> <pre><code># macOS/FreeBSD/Darwin\n     -f      The -f option causes tail to not stop when end of file is reached, but rather to wait for addi-\n             tional data to be appended to the input.  The -f option is ignored if the standard input is a\n             pipe, but not if it is a FIFO.\n\n# linux\n       -f, --follow[={name|descriptor}]\n              output appended data as the file grows;\n              an absent option argument means 'descriptor'\n</code></pre> <p>\u4ee5\u4e0b\u7528\u4e8e\u5b9e\u65f6\u6eda\u52a8\u663e\u793a nginx \u6700\u65b0\u8bbf\u95ee\u65e5\u5fd7\uff1a</p> <pre><code>$ tail -f nginx-access.log\n</code></pre> <p>sed\uff08<code>s</code>tream <code>ed</code>itor\uff09\u610f\u5373\u6d41\u5f0f\u7f16\u8f91\u5668\uff0c\u53ef\u8f7b\u677e\u5b9e\u73b0\u7c7b\u4f3chead/more\u7684\u8fc7\u6ee4\u6587\u672c\u663e\u793a\u3002 \u5f53\u7136\u4e5f\u53ef\u501f\u52a9sed\u6307\u5b9a\u6b63\u5219\u5339\u914d\u89c4\u5219\uff0c\u8fc7\u6ee4\u51fa\u67d0\u4e9b\u884c\u6216\u67d0\u4e9b\u6709\u7279\u6b8a\u8d77\u59cb\u683c\u5f0f\u7684\u6bb5\u843d\u3002</p> <p>\u5177\u4f53\u53c2\u8003 sed-basic.md \u4e2d\u7684\u793a\u4f8b\u3002</p> <p>\u4ee5\u4e0a\u60f3\u6253\u5370\u9664\u5f00\u5934\u548c\u7ed3\u5c3e10\u884c\u7684\u4e2d\u95f4\u90e8\u5206\uff0c\u4e5f\u53ef\u5148\u8ba1\u7b97\u597d\u4e2d\u95f4\u90e8\u5206\u7684\u8d77\u59cb\u884c\u53f7\uff0c\u518d\u7528sed\u8fc7\u6ee4\u6253\u5370\uff1a</p> <pre><code># \u5148\u7edf\u8ba1\u603b\u884c\u6570\nlines=$(wc -l file.txt | awk '{print $1}')\n# \u5f00\u59cb\u884c\u53f711\nhl=11\n# \u51cf\u53bb\u672b\u5c3e10\u884c\uff0c\u5f97\u51fa\u7ed3\u675f\u884c\u53f7\ntl=$(expr $lines - 10)\n# \u6ce8\u610f\u4e0d\u80fd\u7528\u5355\u5f15\u53f7(inhibit parameter expansion)\uff01\nsed -n \"$hl, $tl p\" file.txt\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#du","title":"du","text":"<p>\u5173\u4e8e\u78c1\u76d8\u7edf\u8ba1\u6d89\u53ca\u5230\u4e24\u4e2a\u547d\u4ee4\uff1a</p> <ul> <li><code>df</code> (Disk FileSystem)  </li> <li><code>du</code> (Disk Usage)  </li> </ul> <pre><code>$ df -lh\nFilesystem       Size   Used  Avail Capacity iused      ifree %iused  Mounted on\n/dev/disk1s1s1  466Gi   15Gi   16Gi    48%  567381 4882909539    0%   /\n/dev/disk1s4    466Gi   12Gi   16Gi    42%       9 4883476911    0%   /System/Volumes/VM\n/dev/disk1s2    466Gi  507Mi   16Gi     3%    2991 4883473929    0%   /System/Volumes/Preboot\n/dev/disk1s6    466Gi  2.3Mi   16Gi     1%      17 4883476903    0%   /System/Volumes/Update\n/dev/disk1s5    466Gi  422Gi   16Gi    97% 4976082 4878500838    0%   /System/Volumes/Data\n</code></pre> <p>How to Get the Size of a Directory in Linux How To Find The Size Of A Directory In Linux How to Get the Size of a Directory from Command Line How do I get the size of a directory on the command line? 3 Simple Ways to Get the Size of Directories in Linux </p> <p>\u8fdb\u5165\u6307\u5b9a\u6587\u4ef6\u5939\u6267\u884c <code>du</code>\uff0c\u5217\u4e3e\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u53ca\u6240\u6709\u9012\u5f52\u6587\u4ef6\u5939\u5360\u7528\u78c1\u76d8\u7684\u5927\u5c0f\u3002</p> <pre><code>du ~/Documents\ndu ~/Library/Developer\ndu Pods\n</code></pre> <ul> <li>\u6dfb\u52a0 <code>-c</code> \u9009\u9879\uff0c\u6700\u540e\u4f1a\u8f93\u51fa\u4e00\u6761\u603b\u5360\u7528\u5927\u5c0f\uff1b  </li> <li>\u6dfb\u52a0 <code>-s</code> \u9009\u9879\uff0c\u76f8\u5f53\u4e8e <code>-d 0</code> \u6307\u5b9a\u4e00\u7ea7\u76ee\u5f55\uff0c\u4e0d\u9012\u5f52\u5b50\u76ee\u5f55\uff1b  </li> <li>\u6dfb\u52a0 <code>-h</code> \u9009\u9879\uff0c\u662f\u8f93\u51fa\u7684 fileSize \u66f4\u6613\u9605\u8bfb\uff1b  </li> </ul> <pre><code>$ du -sh ~/Documents\nor\n$ du -h -d 0 ~/Documents\n$ du -h --max-depth=0 ~/Documents\n</code></pre> <p>\u7edf\u8ba1\u76ee\u5f55 <code>~/Library/Developer</code> \u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u5927\u5c0f\uff1a</p> <pre><code>$ du -sh ~/Library/Developer\n 66G    /Users/faner/Library/Developer\n</code></pre> <p>\u7edf\u8ba1\u76ee\u5f55 <code>~/Library/Developer</code> \u5b50\u76ee\u5f55\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u5927\u5c0f\uff1a</p> <pre><code>$ du -csh ~/Library/Developer/*\n 23G    /Users/faner/Library/Developer/CoreSimulator\n1.4G    /Users/faner/Library/Developer/XCTestDevices\n 39G    /Users/faner/Library/Developer/Xcode\n425M    /Users/faner/Library/Developer/chromium\n2.2G    /Users/faner/Library/Developer/flutter\n 66G    total\n</code></pre> <p>\u6309\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u964d\u5e8f\uff08\u7531\u5927\u5230\u5c0f\uff09\u6392\u5e8f\uff1a</p> <pre><code>$ du -sh ~/Library/Developer/* | sort -rh\n 39G    /Users/faner/Library/Developer/Xcode\n 23G    /Users/faner/Library/Developer/CoreSimulator\n2.2G    /Users/faner/Library/Developer/flutter\n1.4G    /Users/faner/Library/Developer/XCTestDevices\n425M    /Users/faner/Library/Developer/chromium\n</code></pre> <p>\u5f53\u5b50\u76ee\u5f55\u592a\u591a\u65f6\uff0c\u53ef\u91cd\u5b9a\u5411\u7ed9 <code>more</code> \u6eda\u52a8\u67e5\u770b\uff0c\u6216\u91cd\u5b9a\u5411\u7ed9 <code>head -n 10</code> \u67e5\u770b\u524d10\u6761\u3002</p> <p>\u5217\u4e3e Pods \u76ee\u5f55\u4e0b\u6240\u6709\u7684\u4e00\u7ea7\u5b50\u76ee\u5f55\uff08\u4e0d\u9012\u5f52\uff09\uff1a</p> <pre><code>ls -1 -d Pods/* | tee ~/Downloads/Pods-tree-L1.log\n</code></pre> <p>\u67e5\u770b Pods \u76ee\u5f55\u4e0b\u6240\u6709\u7684\u4e00\u7ea7\u5b50\u76ee\u5f55\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u5927\u5c0f\uff1a</p> <pre><code>du -csh Pods/* | more\ndu -csh Pods/* | tee ~/Downloads/Pods-tree-L1-du.log\nls -1 -d Pods/* | xargs du -chs | tee ~/Downloads/Pods-tree-L1-du.log\n</code></pre> <p>The <code>tree</code> command is a recursive directory listing program that produces a depth indented listing of files and directories in a tree-like format.</p> <pre><code>tree --du -h /opt/ktube-media-downloader\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#bc","title":"bc","text":"<p>bc(basic calculator) - An arbitrary precision calculator language  </p> <p>bc is typically used as either a <code>mathematical scripting language</code> or as an <code>interactive mathematical shell</code>.  </p> <p>\u5173\u4e8e bc \u8868\u8fbe\u5f0f\u8bed\u8a00\uff0c\u53c2\u8003 wiki - bc\u3002</p> <p>There are four special variables, <code>scale</code>, <code>ibase</code>, <code>obase</code>, and <code>last</code>.  </p> <p>\u652f\u6301\u8f93\u5165\u6570\u5b66\u8868\u8fbe\u5f0f\u7684\u89e3\u91ca\u578b\u8ba1\u7b97\u8bed\u8a00  </p> <p>\u5728\u7ec8\u7aef\u8f93\u5165 <code>bc</code> \u5373\u53ef\u8fdb\u5165 bc \u547d\u4ee4\u884c\u89e3\u91ca\u5668\uff1b\u8f93\u5165 <code>quit</code> \u6216\u8005 <code>&lt;C-d&gt;</code> \u53d1\u9001 EOF \u7ed3\u675f\u9000\u51fa bc\u3002</p> <p>COMMAND LINE CALCULATOR, BC How to Use the \"bc\" Calculator in Scripts Linux\u4e0b\u7684\u8ba1\u7b97\u5668(bc\u3001expr\u3001dc\u3001echo\u3001awk)\u77e5\u591a\u5c11\uff1f Linux\u4e2d\u7684super pi(bc \u547d\u4ee4\u603b\u7ed3) \u6211\u4f7f\u7528\u8fc7\u7684Linux\u547d\u4ee4\u4e4bbc - \u6d6e\u70b9\u8ba1\u7b97\u5668\u3001\u8fdb\u5236\u8f6c\u6362 </p>"},{"location":"blog/20191029/linux-cmd-utility/#basic","title":"basic","text":"<ol> <li>\u5728 bash shell \u7ec8\u7aef\u8f93\u5165 <code>bc</code> \u5373\u53ef\u542f\u52a8 bc \u8ba1\u7b97\u5668\u3002</li> </ol> <p>\u8f93\u5165\u8868\u8fbe\u5f0f <code>56.8 + 77.7</code>\uff0c\u518d\u6309\u56de\u8f66\u952e\u5373\u53ef\u5728\u65b0\u884c\u5f97\u5230\u8ba1\u7b97\u7ed3\u679c\uff1a</p> <pre><code>pi@raspberrypi:~ $ bc\nbc 1.06.95\nCopyright 1991-1994, 1997, 1998, 2000, 2004, 2006 Free Software Foundation, Inc.\nThis is free software with ABSOLUTELY NO WARRANTY.\nFor details type `warranty'. \n\n56.8 + 77.7\n134.5\n</code></pre> <p>\u4e5f\u53ef\u4e66\u5199\u4ee3\u6570\u8868\u8fbe\u5f0f\uff0c\u7528\u53d8\u91cf\u627f\u8f7d\u8ba1\u7b97\u7ed3\u679c\uff0c\u4f5c\u4e3a\u8fdb\u4e00\u6b65\u8ba1\u7b97\u7684\u64cd\u4f5c\u6570\uff1a</p> <pre><code>$ bc -q # -q \u4e0d\u663e\u793a\u5197\u957f\u7684\u6b22\u8fce\u4fe1\u606f\na=2+3;\na\n5\nb=a*4;\nb\n20\n</code></pre> <ol> <li>\u53ef\u901a\u8fc7 bc \u5185\u7f6e\u7684 <code>scale</code> \u53d8\u91cf\u53ef\u6307\u5b9a\u6d6e\u70b9\u6570\u8ba1\u7b97\u8f93\u51fa\u7cbe\u5ea6\uff1a</li> </ol> <pre><code>$ bc -q\n5 * 7 /3\n11\nscale=2; 5 * 7 /3\n11.66\n</code></pre> <ol> <li>\u5728\u7ec8\u7aef\u53ef\u57fa\u4e8e\u6570\u636e\u6d41\u91cd\u5b9a\u5411\u6216\u7ba1\u9053\u4f5c\u4e3a <code>bc</code> \u7684\u8f93\u5165\u8868\u8fbe\u5f0f\uff1a</li> </ol> <pre><code>$ echo \"56.8 + 77.7\" | bc\n134.5\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#inline","title":"inline","text":"<p>\u5bf9\u4e8e\u7b80\u5355\u7684\u5355\u884c\u8fd0\u7b97\uff0c\u53ef\u7528 echo \u91cd\u5b9a\u5411\u6216\u5185\u8054\u91cd\u5b9a\u5411\u5b9e\u73b0\uff1a</p> <pre><code>$ bc &lt;&lt;&lt; \"56.8 + 77.7\"\n134.5\n</code></pre> <p>\u5982\u679c\u9700\u8981\u8fdb\u884c\u5927\u91cf\u8fd0\u7b97\uff0c\u5728\u4e00\u4e2a\u547d\u4ee4\u884c\u4e2d\u5217\u51fa\u591a\u4e2a\u8868\u8fbe\u5f0f\u5c31\u4f1a\u6709\u70b9\u9ebb\u70e6\u3002 bc\u547d\u4ee4\u80fd\u8bc6\u522b\u8f93\u5165\u91cd\u5b9a\u5411\uff0c\u5141\u8bb8\u4f60\u5c06\u4e00\u4e2a\u6587\u4ef6\u91cd\u5b9a\u5411\u5230bc\u547d\u4ee4\u6765\u5904\u7406\u3002 \u4f46\u8fd9\u540c\u6837\u4f1a\u53eb\u4eba\u5934\u75bc\uff0c\u56e0\u4e3a\u4f60\u8fd8\u5f97\u5c06\u8868\u8fbe\u5f0f\u5b58\u653e\u5230\u6587\u4ef6\u4e2d\u3002  </p> <p>\u6700\u597d\u7684\u529e\u6cd5\u662f\u4f7f\u7528\u5185\u8054\u8f93\u5165\u91cd\u5b9a\u5411\uff0c\u5b83\u5141\u8bb8\u4f60\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u4e2d\u91cd\u5b9a\u5411\u6570\u636e\u3002 \u5728shell\u811a\u672c\u4e2d\uff0c\u4f60\u53ef\u4ee5\u5c06\u8f93\u51fa\u8d4b\u7ed9\u4e00\u4e2a\u53d8\u91cf\u3002</p> <pre><code>variable=$(bc &lt;&lt; EOF\n           options\n           statements\n           expressions\n           EOF)\n</code></pre> <p><code>EOF</code> \u6587\u672c\u5b57\u7b26\u4e32\u6807\u8bc6\u4e86\u5185\u8054\u91cd\u5b9a\u5411\u6570\u636e\u7684\u8d77\u6b62\u3002</p> <p>\u4ee5\u4e0b\u5728\u7ec8\u7aef\u6d4b\u8bd5\u8fd9\u79cd\u7528\u6cd5\uff1a</p> <pre><code>$ bc &lt;&lt; EOF\nheredoc&gt; 56.8 + 77.7\nheredoc&gt; EOF\n134.5\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#script","title":"script","text":"<p>\u5728shell\u811a\u672c\u4e2d\uff0c\u53ef\u8c03\u7528bash\u8ba1\u7b97\u5668\u5e2e\u52a9\u5904\u7406\u6d6e\u70b9\u8fd0\u7b97\u3002\u53ef\u4ee5\u7528\u547d\u4ee4\u66ff\u6362\u8fd0\u884cbc\u547d\u4ee4\uff0c\u5e76\u5c06\u8f93\u51fa\u8d4b\u7ed9\u4e00\u4e2a\u53d8\u91cf\u3002\u57fa\u672c\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>variable=$(echo \"options; expression\" | bc)\n</code></pre> <p>\u7b2c\u4e00\u90e8\u5206 options \u5141\u8bb8\u4f60\u8bbe\u7f6e\u53d8\u91cf\u3002 \u5982\u679c\u4f60\u9700\u8981\u4e0d\u6b62\u4e00\u4e2a\u53d8\u91cf\uff0c \u53ef\u4ee5\u7528\u5206\u53f7\u5c06\u5176\u5206\u5f00\u3002 expression\u53c2\u6570\u5b9a\u4e49\u4e86\u901a\u8fc7bc\u6267\u884c\u7684\u6570\u5b66\u8868\u8fbe\u5f0f\u3002</p> <p>\u4ee5\u4e0b\u4e3a\u5728 shell scripts \u8c03\u7528 bc \u5bf9\u5e38\u91cf\u8868\u8fbe\u5f0f\u505a\u8ba1\u7b97\u7684\u793a\u4f8b:</p> <pre><code>$ result=$(echo \"scale=2; 5 * 7 /3;\" | bc)\n$ echo $result\n11.66\n</code></pre> <p>\u4ee5\u4e0b\u4e3a\u5728 shell scripts \u8c03\u7528 bc \u5bf9\u53d8\u91cf\u8868\u8fbe\u5f0f\u505a\u8ba1\u7b97\u7684\u793a\u4f8b:</p> <pre><code>$ var1=100\n$ var2=45\n$ result=`echo \"scale=2; $var1 / $var2\" | bc`\n$ echo $result\n2.22\n</code></pre> <p>\u5982\u679c\u5728\u811a\u672c\u4e2d\u4f7f\u7528\uff0c\u53ef\u4f7f\u7528\u5185\u8054\u91cd\u5b9a\u5411\u5199\u6cd5\uff0c\u5c06\u6240\u6709bash\u8ba1\u7b97\u5668\u6d89\u53ca\u7684\u90e8\u5206\u90fd\u653e\u5230\u540c\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\u7684\u4e0d\u540c\u884c\u3002 \u5c06\u9009\u9879\u548c\u8868\u8fbe\u5f0f\u653e\u5728\u811a\u672c\u7684\u4e0d\u540c\u884c\u4e2d\u53ef\u4ee5\u8ba9\u5904\u7406\u8fc7\u7a0b\u53d8\u5f97\u66f4\u6e05\u6670\uff0c\u63d0\u9ad8\u6613\u8bfb\u6027\u3002 \u5f53\u7136\uff0c\u4e00\u822c\u9700\u8981\u7528\u547d\u4ee4\u66ff\u6362\u7b26\u53f7\u5c06 bc \u547d\u4ee4\u7684\u8f93\u51fa\u8d4b\u7ed9\u53d8\u91cf\uff0c\u4ee5\u4f5c\u540e\u7528\u3002  </p> <p><code>EOF</code> \u5b57\u7b26\u4e32\u6807\u8bc6\u4e86\u91cd\u5b9a\u5411\u7ed9bc\u547d\u4ee4\u7684\u6570\u636e\u7684\u8d77\u6b62\uff0cbc \u5185\u90e8\u53ef\u521b\u5efa\u4e34\u65f6\u53d8\u91cf\u8f85\u52a9\u8ba1\u7b97\uff08\u5b9a\u4e49\u8f85\u52a9\u53d8\u91cf\u6216\u627f\u63a5\u4e2d\u95f4\u8ba1\u7b97\u7ed3\u679c\uff09\uff0c\u4f46\u603b\u662f\u8fd4\u56de\u6700\u540e\u4e00\u6761\u8868\u8fbe\u5f0f\u7684\u8ba1\u7b97\u7ed3\u679c\u3002</p> <p>\u4e0b\u9762\u662f\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u8fd9\u79cd\u5199\u6cd5\u7684\u4f8b\u5b50\u3002</p> <pre><code>$ cat test12.sh\n#!/bin/bash\n\nvar1=10.46\nvar2=43.67\nvar3=33.2\nvar4=71\nvar5=$(bc &lt;&lt; EOF\nscale = 4\na1 = ( $var1 * $var2)\nb1 = ($var3 * $var4)\na1 + b1\nEOF)\n\necho The final answer for this mess is $var5\n</code></pre> <pre><code>$ chmod u+x test12.sh\n$ ./test12.sh\nThe final answer for this mess is 2813.9882\n</code></pre> <p>\u6ce8\u610f\uff1a\u5728bash\u8ba1\u7b97\u5668\u4e2d\u521b\u5efa\u7684\u5c40\u90e8\u53d8\u91cf\u53ea\u5728\u5185\u90e8\u6709\u6548\uff0c\u4e0d\u80fd\u5728shell\u811a\u672c\u4e2d\u5f15\u7528\uff01</p>"},{"location":"blog/20191029/linux-cmd-utility/#last","title":"last","text":"<p><code>last</code>  (an  extension)  is a variable that has the value of the last printed number.</p> <p>bc \u5185\u7f6e\u7684 <code>last</code> \u53d8\u91cf\u4ee3\u8868\u4e0a\u4e2a\u8868\u8fbe\u5f0f\u7684\u8ba1\u7b97\u7ed3\u679c\uff0c\u53ef\u5c06 last \u53d8\u91cf\u4f5c\u4e3a\u540e\u7eed\u8868\u8fbe\u5f0f\u7684\u64cd\u4f5c\u6570\uff0c\u8fdb\u884c\u4e8c\u6b21\u8ba1\u7b97\uff1a</p> <pre><code>$ bc -q\n2+3\n5\nlast*4\n20\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#ibaseobase","title":"ibase/obase","text":"<p>\u9ed8\u8ba4\u8f93\u5165\u548c\u8f93\u51fa\u90fd\u662f\u57fa\u4e8e\u5341\u8fdb\u5236\uff1a</p> <pre><code>$ bc -q\nibase\n10\nobase\n10\n</code></pre> <p>\u5728 bc \u547d\u4ee4\u89e3\u91ca\u5668\u4e2d\u8f93\u5165 <code>ibase=10;obase=16;2017</code>\uff0c\u8f6c\u6362\u8f93\u51fa2017\uff08\u5341\u8fdb\u5236\uff09\u7684\u5341\u516d\u8fdb\u5236\uff1a</p> <pre><code>ibase=10;obase=16;2017\n7E1\n</code></pre> <p>\u6216\u8005 echo \u5206\u53f7\u76f8\u9694\u7684\u8868\u8fbe\u5f0f\u91cd\u5b9a\u5411\u4f5c\u4e3a bc \u7684\u8f93\u5165\u8fdb\u884c\u89e3\u91ca\u8fd0\u884c\uff1a</p> <pre><code>$ echo \"ibase=10;obase=16;2017\" | bc\n7E1\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u7528 <code>bc</code> \u8ba1\u7b97\u5668\u5b9e\u73b0\u8fdb\u5236\u8f6c\u6362\u3002</p> <p>\u5148\u5c06\u5341\u8fdb\u5236\u8f6c\u6362\u6210\u4e8c\u8fdb\u5236\uff1a</p> <pre><code>$ no=100\n$ echo \"obase=2;$no\" | bc \n1100100\n</code></pre> <p>\u518d\u5c06\u4e8c\u8fdb\u5236\u8f6c\u6362\u56de\u5341\u8fdb\u5236</p> <pre><code>$ no=1100100\n$ echo \"obase=10;ibase=2;$no\" | bc\n100\n</code></pre> <p>\u9700\u8981\u6ce8\u610f\u5148\u5199obase\u518d\u5199ibase\uff0c\u5426\u5219\u51fa\u9519\uff1a</p> <pre><code>$ no=1100100\n$ echo \"ibase=2;obase=10;$no\" | bc\n1100100\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#checksum","title":"Checksum","text":""},{"location":"blog/20191029/linux-cmd-utility/#cksum","title":"cksum","text":"<p>cksum, sum -- display file checksums and block counts</p>"},{"location":"blog/20191029/linux-cmd-utility/#crc32","title":"CRC32","text":"<p>crc32 - Perform a 32bit Cyclic Redundancy Check</p> <p>\u8ba1\u7b97\u4ece crx4chrome \u79bb\u7ebf\u4e0b\u8f7d\u7684 Vimium CRX 1.60.3 for Chrome  \u63d2\u4ef6\u7684 crc32 \u6821\u9a8c\u548c\uff1a</p> <pre><code>faner@FAN-MB0:~/Downloads/crx|\n\u21d2  crc32 dbepggeogbaibhgnhhndojpepiihcmeb-1.60.3-Crx4Chrome.com.crx \ndb950177\n</code></pre> <p>\u4e0e\u5b98\u7f51\u7ed9\u51fa\u7684 CRC32 Checksum \u503c\u4e00\u81f4\uff0c\u5219\u8bf4\u660e\u672a\u88ab\u7be1\u6539\uff0c\u53ef\u653e\u5fc3\u5b89\u88c5\u3002</p>"},{"location":"blog/20191029/linux-cmd-utility/#md5","title":"MD5","text":"<p>md5 -- calculate a message-digest fingerprint (checksum) for a file</p> <p>md5 \u547d\u4ee4\u540e\u7684\u9ed8\u8ba4\u8f93\u5165\u53c2\u6570\u4e3a\u6587\u4ef6\u540d\uff0c\u4e5f\u53ef\u901a\u8fc7 <code>-s</code> \u9009\u9879\u6307\u5b9a\u8ba1\u7b97\u5b57\u7b26\u4e32\u53c2\u6570\u7684MD5\u3002</p> <pre><code>     -s string\n             Print a checksum of the given string.\n</code></pre> <p>\u8ba1\u7b97\u4ece crx4chrome \u79bb\u7ebf\u4e0b\u8f7d\u7684 Vimium CRX 1.60.3 for Chrome  \u63d2\u4ef6\u7684 MD5\uff1a</p> <pre><code>faner@FAN-MB0:~/Downloads/crx|\n\u21d2  md5 dbepggeogbaibhgnhhndojpepiihcmeb-1.60.3-Crx4Chrome.com.crx \nMD5 (dbepggeogbaibhgnhhndojpepiihcmeb-1.60.3-Crx4Chrome.com.crx) = c98057821ee3cede87d911ead832dcc1\n</code></pre> <p>\u4e0e\u5b98\u7f51\u7ed9\u51fa\u7684 MD5 Checksum \u503c\u4e00\u81f4\uff0c\u5219\u8bf4\u660e\u672a\u88ab\u7be1\u6539\uff0c\u53ef\u653e\u5fc3\u5b89\u88c5\u3002</p> <p>\u8ba1\u7b97\u4e0b\u8f7d\u5230\u672c\u5730\u7684 Vimium CRX 1.60.3 for Chrome \u63d2\u4ef6\u6240\u5728\u8def\u5f84\u5b57\u7b26\u4e32\u7684 MD5 \u503c\uff1a</p> <pre><code>faner@FAN-MB0:~/Downloads/crx|\n\u21d2  md5 -s \"/Users/faner/Downloads/crx/dbepggeogbaibhgnhhndojpepiihcmeb-1.60.3-Crx4Chrome.com.crx\" \nMD5 (\"/Users/faner/Downloads/crx/dbepggeogbaibhgnhhndojpepiihcmeb-1.60.3-Crx4Chrome.com.crx\") = 2f6f9a98b561f995564793765c205a66\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#sha","title":"SHA","text":"<p>shasum - Print or Check SHA Checksums</p> <pre><code>SYNOPSIS\n        Usage: shasum [OPTION]... [FILE]...\n        Print or check SHA checksums.\n        With no FILE, or when FILE is -, read standard input.\n\n          -a, --algorithm   1 (default), 224, 256, 384, 512, 512224, 512256\n          -b, --binary      read in binary mode\n          -c, --check       read SHA sums from the FILEs and check them\n          -t, --text        read in text mode (default)\n</code></pre> <p>When verifying SHA-512/224 or SHA-512/256 checksums, indicate the algorithm explicitly using the <code>-a</code> option, e.g.</p> <p><code>shasum -a 512224 -c checksumfile</code></p> <p>\u8ba1\u7b97\u4ece crx4chrome \u79bb\u7ebf\u4e0b\u8f7d\u7684 Vimium CRX 1.60.3 for Chrome \u63d2\u4ef6\u7684 SHA-1\uff1a</p> <pre><code>faner@FAN-MB0:~/Downloads/crx|\n\u21d2  shasum dbepggeogbaibhgnhhndojpepiihcmeb-1.60.3-Crx4Chrome.com.crx \n476c61437d3c34e38ed1ee15950d202ded0902c8  dbepggeogbaibhgnhhndojpepiihcmeb-1.60.3-Crx4Chrome.com.crx\n</code></pre> <p>\u4e0e\u5b98\u7f51\u7ed9\u51fa\u7684 SHA1 Checksum \u503c\u4e00\u81f4\uff0c\u5219\u8bf4\u660e\u672a\u88ab\u7be1\u6539\uff0c\u53ef\u653e\u5fc3\u5b89\u88c5\u3002</p> <p>SHA1 vs SHA256 Why use SHA256 instead of SHA1? Re-Hashed: The Difference Between SHA-1, SHA-2 and SHA-256 Hash Algorithms </p>"},{"location":"blog/20191029/linux-cmd-utility/#binhex","title":"binhex","text":"<p>Convert binary data to hexadecimal in a shell script Binary to hexadecimal and decimal in a shell script </p> <p>shell \u7f16\u7a0b\u8fdb\u5236\u8f6c\u6362 Linux Bash\uff1a\u8fdb\u5236\u95f4\u8f6c\u6362</p> <p>\u7b2c\u4e00\u79cd\u65b9\u5f0f\u662f\u57fa\u4e8e printf \u51fd\u6570\u683c\u5f0f\u5316\u8f93\u51fa\uff1a</p> <pre><code># hexadecimal to decimal\n$ printf '%d\\n' 0x24\n36\n# decimal to hexadecimal\n$ printf '%x\\n' 36\n24\n</code></pre> <p>\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u662f\u57fa\u4e8e <code>$((...))</code> \u8868\u8fbe\u5f0f\uff0c\u5c06\u5176\u4ed6\u8fdb\u5236\u8f6c\u6362\u4e3a\u5341\u8fdb\u5236\uff1a</p> <pre><code># binary to decimal\n$ echo \"$((2#101010101))\"\n341\n# binary to hexadecimal\n$ printf '%x\\n' \"$((2#101010101))\"\n155\n# hexadecimal to decimal\n$ echo \"$((16#FF))\"\n255\n</code></pre> <p>\u7b2c\u4e09\u79cd\u65b9\u5f0f\u662f\u57fa\u4e8e\u4e0a\u6587\u63d0\u5230\u7684bc\u8ba1\u7b97\u5668\uff0c\u5b9e\u73b0\u4efb\u610f\u8fdb\u5236\u95f4\u4e92\u8f6c\uff1a</p> <pre><code># binary to decimal\n$ echo 'obase=10;ibase=2;101010101' | bc\n341\n# decimal to hexadecimal\n$ bc &lt;&lt;&lt; 'obase=16;ibase=10;254'\nFE\n# hexadecimal to decimal\n$ bc &lt;&lt;&lt; 'obase=10;ibase=16;FE'\n254\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#hexdump","title":"hexdump","text":""},{"location":"blog/20191029/linux-cmd-utility/#od","title":"od","text":"<p>Linux/Unix\uff08macOS\uff09\u4e0b\u7684\u547d\u4ee4\u884c\u5de5\u5177 <code>od</code> \u53ef\u6309\u6307\u5b9a\u8fdb\u5236\u683c\u5f0f\u67e5\u770b\u6587\u6863\uff1a</p> <pre><code>pi@raspberrypi:~ $ od --version\nod (GNU coreutils) 8.26\nCopyright (C) 2016 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\nWritten by Jim Meyering.\n</code></pre> <pre><code>pi@raspberrypi:~ $ man od\n\nNAME\n       od - dump files in octal and other formats\n\nSYNOPSIS\n       od [OPTION]... [FILE]...\n       od [-abcdfilosx]... [FILE] [[+]OFFSET[.][b]]\n       od --traditional [OPTION]... [FILE] [[+]OFFSET[.][b] [+][LABEL][.][b]]\n</code></pre> <p><code>-A</code>, --address-radix=RADIX</p> <p>output format for file offsets; RADIX is one of [doxn], for Decimal, Octal, Hex or None  </p> <p>\u8f93\u51fa\u5de6\u4fa7\u7684\u5730\u5740\u683c\u5f0f\uff0c\u9ed8\u8ba4\u4e3a o\uff08\u516b\u8fdb\u5236\uff09\uff0c\u53ef\u6307\u5b9a\u4e3a x\uff08\u5341\u516d\u8fdb\u5236\uff09\u3002   </p> <p><code>-j</code>, --skip-bytes=BYTES</p> <p>skip BYTES input bytes first\uff08\u8df3\u8fc7\u5f00\u5934\u6307\u5b9a\u957f\u5ea6\u7684\u5b57\u8282\uff09</p> <p><code>-N</code>, --read-bytes=BYTES</p> <p>limit dump to BYTES input bytes\uff08\u53ea dump \u8f6c\u8bd1\u6307\u5b9a\u957f\u5ea6\u7684\u5185\u5bb9\uff09</p> <p><code>-t</code>, --format=TYPE</p> <p>select output format or formats\uff08dump \u8f93\u51fa\u7684\u7ea7\u8054\u590d\u5408\u683c\u5f0f\uff1a<code>[d|o|u|x][C|S|I|L|n]</code>\uff09</p> <ul> <li><code>[doux]</code> \u53ef\u6307\u5b9a\u6709\u7b26\u53f7\u5341\u3001\u516b\u3001\u65e0\u7b26\u53f7\u5341\u3001\u5341\u516d\u8fdb\u5236\uff1b  </li> <li> <p><code>[CSIL]</code> \u53ef\u6307\u5b9a sizeof(char)=1, sizeof(short)=2, sizeof(int)=4, sizeof(long)=8 \u4f5c\u4e3a group_bytes_by_bits\uff1b\u6216\u76f4\u63a5\u8f93\u5165\u6570\u5b57[1,2,4,8]\u3002</p> </li> <li> <p><code>a</code>\uff1aNamed characters (ASCII)\uff0c\u6253\u5370\u53ef\u89c1 ASCII \u5b57\u7b26\u3002</p> </li> </ul> <p><code>-x</code>: same as <code>-t x2</code>, select hexadecimal 2-byte units</p> <p>\u9ed8\u8ba4 group_bytes_by_bits = 16\uff0c\u4e24\u4e2a\u5b57\u8282\uff08shorts\uff09\u4e3a\u4e00\u7ec4\u3002  </p> <p>\u4ee5\u4e0b\u793a\u4f8b hex dump <code>tuple.h</code> \u6587\u4ef6\u5f00\u5934\u768464\u5b57\u8282\uff1a</p> <pre><code># \u7b49\u6548 od -N 64 -A x -t xCa tuple.h\nfaner@MBP-FAN:~/Downloads|\u21d2  od -N 64 -A x -t x1a tuple.h\n0000000    ef  bb  bf  0d  0a  23  70  72  61  67  6d  61  20  6f  6e  63\n           ?   ?   ?  cr  nl   #   p   r   a   g   m   a  sp   o   n   c\n0000010    65  0d  0a  0d  0a  6e  61  6d  65  73  70  61  63  65  20  41\n           e  cr  nl  cr  nl   n   a   m   e   s   p   a   c   e  sp   A\n0000020    73  79  6e  63  54  61  73  6b  0d  0a  7b  0d  0a  0d  0a  2f\n           s   y   n   c   T   a   s   k  cr  nl   {  cr  nl  cr  nl   /\n0000030    2f  20  e5  85  83  e7  bb  84  28  54  75  70  6c  65  29  e6\n           /  sp   ?  85  83   ?   ?  84   (   T   u   p   l   e   )   ?\n0000040\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#xxd","title":"xxd","text":"<p>\u8fd8\u6709\u4e00\u4e2aod\u7c7b\u4f3c\u7684\u547d\u4ee4\u884c\u5de5\u5177\u662fxxd\u3002</p> <pre><code>XXD(1)                                                                                                XXD(1)\n\n\n\nNAME\n       xxd - make a hexdump or do the reverse.\n\nSYNOPSIS\n       xxd -h[elp]\n       xxd [options] [infile [outfile]]\n       xxd -r[evert] [options] [infile [outfile]]\n\nDESCRIPTION\n       xxd creates a hex dump of a given file or standard input.  It can also convert a hex dump back to its\n       original binary form.  Like uuencode(1) and uudecode(1) it allows the transmission of binary data  in\n       a  `mail-safe' ASCII representation, but has the advantage of decoding to standard output.  Moreover,\n       it can be used to perform binary file patching.\n</code></pre> <p>dstebila/bin2hex.sh</p> <pre><code>#!/bin/bash\n\n# Read either the first argument or from stdin\ncat \"${1:-/dev/stdin}\" | \\\n# Convert binary to hex using xxd in plain hexdump style\nxxd -ps | \\\n# Put spaces between each pair of hex characters\nsed -E 's/(..)/\\1 /g' | \\\n# Merge lines\ntr -d '\\n'\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#hexdump_1","title":"hexdump","text":"<p>Linux/Unix\uff08macOS\uff09\u4e0b\u7684\u547d\u4ee4\u884c\u5de5\u5177 <code>hexdump</code> \u53ef\u6309\u6307\u5b9a\u8fdb\u5236\u683c\u5f0f\u67e5\u770b\u6587\u6863\uff1a</p> <pre><code>pi@raspberrypi:~ $ man hexdump\n\nNAME\n     hexdump, hd \u2014 ASCII, decimal, hexadecimal, octal dump\n\nSYNOPSIS\n     hexdump [-bcCdovx] [-e format_string] [-f format_file] [-n length] [-s skip] file ...\n     hd [-bcdovx] [-e format_string] [-f format_file] [-n length] [-s skip] file ...\n</code></pre> <p><code>-b</code>      One-byte octal display. <code>-c</code>      One-byte character display. <code>-C</code>      Canonical hex+ASCII display. <code>-d</code>      Two-byte decimal display. <code>-o</code>      Two-byte octal display. <code>-x</code>      Two-byte hexadecimal display.  </p> <p><code>-s</code> offset: Skip offset bytes from the beginning of the input\uff08\u8df3\u8fc7\u5f00\u5934\u6307\u5b9a\u957f\u5ea6\u7684\u5b57\u8282\uff09 <code>-n</code> length: Interpret only length bytes of input\uff08 \u53ea dump \u8f6c\u8bd1\u6307\u5b9a\u957f\u5ea6\u7684\u5185\u5bb9\uff09  </p> <p>\u53ef\u4ee5 hexdump \u51fa UTF-8 \u7f16\u7801\u7684\u6587\u672c\u6587\u4ef6\uff0c\u901a\u8fc7\u5f00\u59343\u4e2a\u5b57\u8282\u6765\u5224\u65ad\u662f\u5426\u5e26BOM\uff1a</p> <p>\u5982\u679c\u5f00\u59343\u4e2a\u5b57\u8282\u4e3a <code>ef bb bf</code>\uff0c\u5219\u4e3a\u5e26 BOM \u7f16\u7801\uff1b\u5426\u5219\u4e3a\u4e0d\u5e26 BOM \u7f16\u7801\u3002</p> <pre><code># \u7b49\u6548 hexdump -C litetransfer.cpp | head -n 4\nfaner@MBP-FAN:~/Downloads|\u21d2  hexdump -n 64 -C tuple.h\n00000000  ef bb bf 0d 0a 23 70 72  61 67 6d 61 20 6f 6e 63  |.....#pragma onc|\n00000010  65 0d 0a 0d 0a 6e 61 6d  65 73 70 61 63 65 20 41  |e....namespace A|\n00000020  73 79 6e 63 54 61 73 6b  0d 0a 7b 0d 0a 0d 0a 2f  |syncTask..{..../|\n00000030  2f 20 e5 85 83 e7 bb 84  28 54 75 70 6c 65 29 e6  |/ ......(Tuple).|\n00000040\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#strings","title":"strings","text":"<pre><code>pi@raspberrypi:~ $ man strings\n\nSTRINGS(1)                          GNU Development Tools                          STRINGS(1)\n\nNAME\n       strings - print the strings of printable characters in files.\n\nSYNOPSIS\n       strings [-afovV] [-min-len]\n               [-n min-len] [--bytes=min-len]\n               [-t radix] [--radix=radix]\n               [-e encoding] [--encoding=encoding]\n               [-] [--all] [--print-file-name]\n               [-T bfdname] [--target=bfdname]\n               [-w] [--include-all-whitespace]\n               [-s] [--output-separatorsep_string]\n               [--help] [--version] file...\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#\u5176\u4ed6","title":"\u5176\u4ed6","text":""},{"location":"blog/20191029/linux-cmd-utility/#rev","title":"rev","text":"<pre><code>NAME\n     rev -- reverse lines of a file\n\nSYNOPSIS\n     rev [file ...]\n\nDESCRIPTION\n     The rev utility copies the specified files to the standard output, reversing the order of characters in\n     every line.  If no files are specified, the standard input is read.\n</code></pre> <pre><code>echo \"Bash Shell\" | rev\nllehS hsaB\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#fuser","title":"fuser","text":"<pre><code>$ man fuser\nNAME\n       fuser - list process IDs of all processes that have one or more files open\n\nSYNOPSIS\n       fuser [ -cfu ] file ...\n</code></pre>"},{"location":"blog/20191029/linux-cmd-utility/#lsof","title":"lsof","text":"<pre><code>NAME\n       lsof - list open files\n\nSYNOPSIS\n       lsof  [  -?abChlnNOPRtUvVX ] [ -A A ] [ -c c ] [ +c c ] [ +|-d d ] [ +|-D D ] [ +|-e s ] [ +|-E ] [ +|-f [cfgGn] ] [ -F [f] ] [ -g [s] ] [\n       -i [i] ] [ -k k ] [ -K k ] [ +|-L [l] ] [ +|-m m ] [ +|-M ] [ -o [o] ] [ -p s ] [ +|-r [t[m&lt;fmt&gt;]] ] [ -s [p:s] ] [ -S [t] ] [ -T [t] ]  [\n       -u s ] [ +|-w ] [ -x [fl] ] [ +|-X ] [ -z [z] ] [ -Z [Z] ] [ -- ] [names]\n</code></pre> <p>\u67e5\u627e\u76d1\u542c\u6307\u5b9a\u7aef\u53e3\u7684\u8fdb\u7a0bPID\uff1a</p> <pre><code>lsof -i :8010 | awk 'NR&gt;1 {print $2}' | xargs kill -KILL\n</code></pre> <ul> <li>\u67e5\u770b Linux TCP Port \u88ab\u54ea\u96bb\u7a0b\u5f0f(Process)\u4f54\u7528 </li> <li>Finding the PID of the Process Using a Specific Port </li> <li>Linux Find Out Which Process Is Listening Upon a Port </li> <li>3 Ways to Find Out Which Process Listening on a Particular Port </li> </ul>"},{"location":"blog/20191029/linux-cmd-utility/#jq","title":"jq","text":"<p>\u5bf9\u4e8e\u538b\u7f29/\u8f6c\u4e49\u7684 JSON \u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u5728\u4ee5\u4e0b\u7f51\u7ad9\u8fdb\u884c\u683c\u5f0f\u5316\u6216\u89e3\u6790\u8f6c\u6362\u3002</p> <ul> <li>JSON\u5728\u7ebf\u89e3\u6790\u53ca\u683c\u5f0f\u5316\u9a8c\u8bc1\uff1a\u652f\u6301\u5728\u7ebf\u89e3\u6790\u548c\u538b\u7f29\u8f6c\u4e49\u3002</li> <li>JSON\u89e3\u6790\u683c\u5f0f\u5316\u5de5\u5177\uff1a\u652f\u6301\u6821\u9a8c/\u683c\u5f0f\u5316\u3001\u538b\u7f29/\u8f6c\u4e49\u3002</li> <li>JSON\u683c\u5f0f\u5316\u67e5\u770b\u5de5\u5177\uff1a\u652f\u6301\u5bf9 JSON \u8fdb\u884c\u538b\u7f29\uff0c\u4ee5\u53ca\u5bf9\u538b\u7f29\uff08\u8f6c\u4e49\uff09\u7684JSON\u5b57\u7b26\u4e32\u8fdb\u884c\u8fd8\u539f\u3002</li> </ul> <p>macOS/Linux \u4e0b\u8fd8\u53ef\u4ee5\u5b89\u88c5 <code>jq</code> \u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5c06\u538b\u7f29/\u8f6c\u4e49\u7684json\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u683c\u5f0f\u5316\u7684 JSON \u5bf9\u8c61\u3002</p> <p>jq is a lightweight and flexible command-line JSON processor.</p> <ul> <li>linux\u4e0bjq\u7684\u4f7f\u7528</li> <li>\u7ed9\u529b\u7684linux\u547d\u4ee4--jq\u7b80\u6613\u6559\u7a0b</li> <li>jq - \u4e00\u4e2a\u7075\u6d3b\u7684\u8f7b\u91cf\u7ea7\u547d\u4ee4\u884cJSON\u5904\u7406\u5668</li> </ul> <p>\u4ee5\u4e0b\u5c06\u538b\u7f29\u8f6c\u4e49\u7684json\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u4e3aJSON\u5bf9\u8c61\u8f93\u51fa\u63a7\u5236\u53f0\u5e76\u5b58\u50a8\u5230 banner-exposure.json \u6587\u4ef6\u3002</p> <pre><code>$ echo \"{\\\"bizName\\\":\\\"yidian\\\",\\\"plat\\\":\\\"h5\\\",\\\"actionName\\\":\\\"banner\\\",\\\"actionType\\\":\\\"exposure\\\",\\\"extra\\\":{\\\"value\\\":{\\\"banner_id\\\":\\\"3303\\\",\\\"title\\\":\\\"\u4f53\u68c0\u5b63\u6765\u4e86\uff1a\u4f60\u6700\u5173\u5fc3\u7684\u5404\u79cd\u68c0\u67e5\uff0c\u8fd9\u91cc\u90fd\u6709\\\",\\\"index\\\":0}}}\" | jq | tee banner-exposure.json\n{\n  \"bizName\": \"yidian\",\n  \"plat\": \"h5\",\n  \"actionName\": \"banner\",\n  \"actionType\": \"exposure\",\n  \"extra\": {\n    \"value\": {\n      \"banner_id\": \"3303\",\n      \"title\": \"\u4f53\u68c0\u5b63\u6765\u4e86\uff1a\u4f60\u6700\u5173\u5fc3\u7684\u5404\u79cd\u68c0\u67e5\uff0c\u8fd9\u91cc\u90fd\u6709\",\n      \"index\": 0\n    }\n  }\n}\n</code></pre> <p>\u4ee5\u4e0b\u5bf9 banner-exposure.json \u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u538b\u7f29\u4e3a\u4e00\u884c\u8f93\u51fa\u3002</p> <pre><code>$ cat banner-exposure.json | jq -c .\n{\"bizName\":\"yidian\",\"plat\":\"h5\",\"actionName\":\"banner\",\"actionType\":\"exposure\",\"extra\":{\"value\":{\"banner_id\":\"3303\",\"title\":\"\u4f53\u68c0\u5b63\u6765\u4e86\uff1a\u4f60\u6700\u5173\u5fc3\u7684\u5404\u79cd\u68c0\u67e5\uff0c\u8fd9\u91cc\u90fd\u6709\",\"index\":0}}}\n</code></pre>"},{"location":"blog/20191028/Command_Line_Editing/","title":"Linux Command Line Editing","text":"<p>Linux command line editing actions: readling, moving, editing, killing/yanking, completing, and so on.</p> <p>Bash Reference Manual </p> <p>8 Command Line Editing </p>"},{"location":"blog/20191028/Command_Line_Editing/#readline","title":"readline","text":"<p>The GNU Readline Library: Library for command-line editing</p> <p>\u5728 BASH(1) \u7684 man page \u8f93\u5165 <code>/^READLINE</code>\uff08<code>^</code> \u4e3a vim \u4e2d\u7684\u884c\u9996\u5b57\u5143\u4f4d\u7f6e\uff09\uff0c\u53ef\u641c\u7d22 READLINE \u76f8\u5173\u7684\u8bf4\u660e\uff08the READLINE section of the bash(1) man page\uff09\u3002</p> <p>This is the library that handles reading input when using an interactive shell, unless the <code>--noediting</code> option is given at shell invocation. Line editing is also used when using the <code>-e</code> option to the read builtin. By default, the line editing commands are similar to those of Emacs. A vi-style line editing interface is also available. Line editing can be enabled at any time using the <code>-o emacs</code> or <code>-o vi</code> options to the set builtin.  </p> <p>Bash Reference Manual </p> <p>8 Command Line Editing </p> <p>8.2 Readline Interaction </p>"},{"location":"blog/20191028/Command_Line_Editing/#moving","title":"Moving","text":"<p>BASH(1) \u7684 man page \u4e2d\u8f93\u5165 <code>/Commands for Moving</code> \u5373\u53ef\u5b9a\u4f4d\u5230\u5bf9\u5e94\u7ae0\u8282\u3002</p> <p>emacs-compatible keybindings</p> <pre><code>beginning-of-line (C-a)\n      Move to the start of the current line.\nend-of-line (C-e)\n      Move to the end of the line.\nforward-char (C-f)\n      Move forward a character.\nbackward-char (C-b)\n      Move back a character.\nforward-word (M-f)\n      Move forward to the end  of  the  next  word.   Words  are  composed  of\n      alphanumeric characters (letters and digits).\nbackward-word (M-b)\n      Move  back to the start of the current or previous word.  Words are com-\n      posed of alphanumeric characters (letters and digits).\nclear-screen (C-l)\n      Clear the screen leaving the current line at  the  top  of  the  screen.\n      With  an argument, refresh the current line without clearing the screen.\nredraw-current-line\n      Refresh the current line.\n</code></pre> <p><code>&lt;C-l&gt;</code>\uff1a\u6eda\u52a8\u5c4f\u5e55\u5c06\u5f53\u524d\u884c\u7f6e\u9876\uff0c\u540c clear \u547d\u4ee4\u3002\u4e0d\u6e05\u9664\u7f13\u51b2\u533a\uff0c\u53ef\u7ee7\u7eed\u4e0b\u62c9\u6eda\u52a8\u7ffb\u770b\u8fc7\u5f80\u8bb0\u5f55\u3002</p> <ul> <li><code>&lt;C-b&gt;</code>/<code>&lt;C-f&gt;</code>\uff08\u2190/\u2192\uff09\uff1a\u6309\u5b57\u7b26\u4e3a\u5355\u4f4d\u79fb\u52a8  </li> <li><code>&lt;M-b&gt;</code>/<code>&lt;M-f&gt;</code>\uff08\u2325+\u2190/\u2192\uff09\uff1a\u6309\u5355\u8bcd\u4e3a\u5355\u4f4d\u79fb\u52a8  </li> <li><code>&lt;C-a&gt;</code>/<code>&lt;C-e&gt;</code>\uff1a\u5b9a\u4f4d\u53e5\u9996/\u5c3e </li> </ul>"},{"location":"blog/20191028/Command_Line_Editing/#editing","title":"Editing","text":"<p>BASH(1) \u7684 man page \u4e2d\u8f93\u5165 <code>/Commands for Changing Text</code> \u5373\u53ef\u5b9a\u4f4d\u5230\u5bf9\u5e94\u7ae0\u8282\u3002</p> <pre><code>delete-char (C-d)\n      Delete the character at point. If this function is bound to the same character as the tty EOF character, as C-d commonly is, see above for the effects.\n</code></pre> <ul> <li><code>C-h</code>\uff1adelete char backward\uff08\u5411\u5de6\u56de\u5220\u4e00\u4e2a\u5b57\u7b26\uff09.  </li> <li><code>C-d</code>\uff1adelete-char (forward)\uff08\u5411\u53f3\u5220\u9664\u4e00\u4e2a\u5b57\u7b26\uff09.  </li> </ul>"},{"location":"blog/20191028/Command_Line_Editing/#killing_and_yanking","title":"Killing and Yanking","text":"<p>BASH(1) \u7684 man page \u4e2d\u8f93\u5165 <code>/Killing and Yanking</code> \u5373\u53ef\u5b9a\u4f4d\u5230\u5bf9\u5e94\u7ae0\u8282\u3002</p> <pre><code>kill-line (C-k)\n      Kill the text from point to the end of the line.\nbackward-kill-line (C-x Rubout)\n      Kill backward to the beginning of the line.\nunix-line-discard (C-u)\n      Kill backward from point to the beginning of the line.   The  killed  text  is saved on the kill-ring.\nkill-whole-line\n      Kill all characters on the current line, no matter where point is.\nkill-word (M-d)\n      Kill  from  point  to the end of the current word, or if between words, to the end of the next word.  Word boundaries are the same  as  those  used  by  for ward-word.\nbackward-kill-word (M-Rubout)\n      Kill  the  word  behind  point.  Word boundaries are the same as those used by backward-word.\nshell-kill-word\n      Kill from point to the end of the current word, or if between  words,  to  the end  of  the  next  word.   Word  boundaries  are  the  same  as those used by shell-forward-word.\nshell-backward-kill-word\n      Kill the word behind point.  Word boundaries are the same  as  those  used by shell-backward-word.\nunix-word-rubout (C-w)\n      Kill  the word behind point, using white space as a word boundary.  The killed text is saved on the kill-ring.\n\nyank (C-y)\n      Yank the top of the kill ring into the buffer at point.\nyank-pop (M-y)\n      Rotate  the  kill  ring,  and  yank the new top.  Only works following yank or yank-pop.\n</code></pre> <ul> <li><code>C-w</code> / <code>M-delete</code>(backspace)\uff0c\u5411\u540e\uff08backward\uff09\u5220\u9664\u81f3\u5355\u8bcd\u5f00\u5934\uff1b  </li> <li><code>M-d</code>\uff1a\u5411\u524d\uff08forward\uff09\u5220\u9664\u81f3\u5355\u8bcd\u672b\u5c3e\uff1b  </li> <li><code>C-u</code>\uff1a\u5220\u9664\u81f3\u884c\u9996\uff08raspbian/CentOS\uff09 or \u5220\u9664\u6574\u884c\uff08macOS\uff09\uff1b  </li> <li><code>C-k</code>\uff1a\u5220\u9664\u81f3\u884c\u672b\uff1b  </li> </ul> <p><code>&lt;C-y&gt;</code>\uff1a\u53ec\u56de\uff08yank\uff09\u7c98\u8d34 <code>&lt;C-w&gt;</code>\u3001<code>&lt;M-d&gt;</code>\u3001<code>&lt;C-u&gt;</code>\u3001<code>&lt;C-k&gt;</code> \u526a\u5207\u5220\u9664\uff08kill\uff09\u7684\u6587\u672c\u3002</p>"},{"location":"blog/20191028/Command_Line_Editing/#completing","title":"Completing","text":"<p>complete (<code>TAB</code>) possible-completions (<code>M-?</code>) possible-filename-completions (<code>C-x /</code>) possible-variable-completions (<code>C-x $</code>)  </p>"},{"location":"blog/20191028/Command_Line_Editing/#keyboard_macros","title":"Keyboard Macros","text":"<p>BASH(1) \u7684 man page \u4e2d\u8f93\u5165 <code>/Keyboard Macros</code> \u5373\u53ef\u5b9a\u4f4d\u5230\u5bf9\u5e94\u7ae0\u8282\u3002</p>"},{"location":"blog/20191022/bash_history/","title":"Linux\u547d\u4ee4\u5386\u53f2\u8bb0\u5f55(bash_history)","text":"<p>BASH Command History \u662f\u6309\u7167\u8f93\u5165\u65f6\u95f4\u7531\u8fdc\u5230\u8fd1\u5c3e\u90e8\u8ffd\u52a0\u7684\uff0c\u7f16\u53f7\u8d8a\u5c0f\u65f6\u95f4\u8d8a\u4e45\u8fdc\uff0c\u6700\u8fd1\u8f93\u5165\u7684\u4e0a\u4e00\u6761\u547d\u4ee4\u7f16\u53f7\u6700\u5927\u3002</p> <p>\u5728 BASH(1) \u7684 man page \u8f93\u5165 <code>/^HISTORY</code> \u53ef\u4ee5\u67e5\u770b\u5185\u5efa history \u547d\u4ee4\u7684\u5e2e\u52a9\u8bf4\u660e\u90e8\u5206\u3002</p> <p>\u53ef\u5728 BASH(1) \u7684 man page \u4e2d <code>/</code> \u6216 <code>?</code> \u641c\u7d22\u4ee5\u4e0b\u8bae\u9898\uff1a</p> <ul> <li>Searching  </li> <li>Commands for Manipulating the History   </li> </ul> <p>history \u589e\u52a0\u8be6\u7ec6\u5386\u53f2\u8bb0\u5f55 Linux \u7528\u6237\u767b\u5f55\u540e\u7cbe\u786e\u547d\u4ee4\u8bb0\u5f55 \u8ba9 history \u547d\u4ee4\u663e\u793a\u65e5\u671f\u548c\u65f6\u95f4 </p> <p>Linux\u4e0bhistory\u547d\u4ee4\u7528\u6cd5 Linux\u4e0bhistory\u547d\u4ee4\u914d\u7f6e\u53ca\u9ad8\u7ea7\u5e94\u7528 Linux\u4e2dhistory\u5386\u53f2\u547d\u4ee4\u4f7f\u7528\u65b9\u6cd5\u8be6\u89e3 </p>","tags":["bash"]},{"location":"blog/20191022/bash_history/#histfile__histsize","title":"HISTFILE &amp; HISTSIZE","text":"<p>\u73af\u5883\u53d8\u91cf HISTFILE \u5b9a\u4e49\u4e86\u4fdd\u5b58\u5386\u53f2\u8f93\u5165\u8bb0\u5f55\u7684\u6587\u4ef6\u8def\u5f84\uff1b \u73af\u5883\u53d8\u91cf HISTSIZE \u5219\u5b9a\u4e49\u4e86\u4fdd\u5b58\u6700\u8fd1\u5386\u53f2\u8bb0\u5f55\u7684\u6761\u6570\u3002  </p> <pre><code># macOS\nfaner@FAN-MB0:~|\u21d2  echo $HISTFILE\n/Users/faner/.zsh_history\nfaner@FAN-MB0:~|\u21d2  echo $HISTSIZE\n10000\n</code></pre> <pre><code># raspbian\npi@raspberrypi:~ $ echo $HISTFILE\n/home/pi/.bash_history\npi@raspberrypi:~ $ echo $HISTSIZE\n1000\n</code></pre> <p>\u5f53\u6211\u4eec\u4ee5 bash \u767b\u5f55 linux(raspbian) \u65f6\uff0c\u7cfb\u7edf\u4f1a\u4ece <code>~/.bash_history</code> \u4e2d\u8bfb\u53d6\u4ee5\u524d\u6572\u8fc7\u7684\u547d\u4ee4\uff0c\u603b\u5171\u4e0d\u8d85\u8fc7 1000 \u6761\u3002 \u5047\u8bbe\u6b64\u6b21\u6267\u884c <code>/bin/bash</code> \u65b0\u5efa Shell \u7a97\u53e3\uff0c\u767b\u5f55 Bash Shell \u540e\u5171\u8f93\u5165\u4e86100\u6761\u547d\u4ee4\uff0c\u5219\u5f53\u6211\u4eec exit \u6ce8\u9500\u9000\u51fa Bash Shell \u65f6\uff0c\u7cfb\u7edf\u4f1a\u5c06\u6700\u65b0\u7684 101~1100 \u6761\u5386\u53f2\u547d\u4ee4\u66f4\u65b0\u5230 <code>~/.bash_history</code> \u4e2d\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5728\u7ec8\u7aef\u504f\u597d\u8bbe\u7f6e\u4e2d\u4fee\u6539 Scrollback lines \u884c\u6570\u9650\u5236\u3002</p> <p>\u6216\u8005 <code>vim .bashrc</code> \u4fee\u6539 <code>~/.bashrc</code> \u4e2d\u7684 <code>HISTSIZE</code> \u548c <code>HISTFILESIZE</code> \u8fd9\u4e24\u4e2a Shell Variables\uff1a</p> <pre><code>pi@raspberrypi:~ $ vim .bashrc\n\n# for setting history length see HISTSIZE and HISTFILESIZE in bash(1)\nHISTSIZE=1000\nHISTFILESIZE=2000\n</code></pre> <p>\u4e5f\u53ef\u4fee\u6539 system-wide \u7ea7\u522b\u7684\u914d\u7f6e<code>/etc/profile</code>\uff0c\u4f46 <code>/etc/profile</code> \u4f1a\u88ab <code>~/.bash_profile</code> \u4fee\u6539\u8986\u76d6\uff0c <code>~/.bash_profile</code> \u4f1a\u88ab <code>~/.bashrc</code> \u4fee\u6539\u8986\u76d6\u3002  </p>","tags":["bash"]},{"location":"blog/20191022/bash_history/#rolling","title":"rolling","text":"<p>\u5728\u7ec8\u7aef\u6309\u4e0b <code>C-p</code>/<code>C-n</code>\uff08\u2191/\u2193\uff0c\u540c <code>&lt;M-p&gt;</code>/<code>&lt;M-n&gt;</code>\uff09\u53ef\u4ee5\u8c03\u51fa\u4e0a\u4e00\u6761/\u4e0b\u4e00\u6761\u5386\u53f2\u547d\u4ee4\u3002</p> <pre><code>previous-history (C-p)\n      Fetch the previous command from the history list, moving back in the list.\nnext-history (C-n)\n      Fetch the next command from the history list, moving forward in the list.\n\nnon-incremental-reverse-search-history (M-p)\n      Search backward through the history starting at the current line using  a  non-incremental search for a string supplied by the user.\nnon-incremental-forward-search-history (M-n)\n      Search  forward through the history using a non-incremental search for a string supplied by the user.\n\nbeginning-of-history (M-&lt;)\n      Move to the first line in the history.\nend-of-history (M-&gt;)\n      Move to the end of the input history, i.e., the line currently being entered.\n</code></pre>","tags":["bash"]},{"location":"blog/20191022/bash_history/#display","title":"display","text":"<p>\u5728 macOS/raspbian \u7ec8\u7aef\u8f93\u5165 <code>history</code> \u547d\u4ee4\u53ef\u67e5\u770b\u5386\u53f2\u8f93\u5165\u8bb0\u5f55\u3002</p> <p>\u5982\u679c\u8fc7\u5f80\u8f93\u5165\u5386\u53f2\u63a5\u8fd1 HISTSIZE\uff0c<code>history</code> \u547d\u4ee4\u5217\u8868\u8f83\u957f\uff0c\u4e0d\u4fbf\u7ffb\u9605\u3002 \u6b64\u65f6\uff0c\u53ef\u901a\u8fc7\u7ba1\u9053\u547d\u4ee4\u5bfc\u5411 <code>head</code> / <code>tail</code> \u7b5b\u9009\u67e5\u770b\u5f00\u5934/\u7ed3\u5c3e\u90e8\u5206\uff0c\u6216\u5bfc\u5411 <code>more</code> / <code>less</code> \u7ffb\u9875\u67e5\u770b\u3002  </p> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5728 <code>history</code> \u547d\u4ee4\u540e\u63a5\u53c2\u6570 <code>[n]</code> \u67e5\u770b\u6307\u5b9a\u884c\u6570\u7684\u5386\u53f2\u8bb0\u5f55\u3002</p> <ul> <li>raspbian \u4e0b\u8f93\u5165 <code>history N</code> \u5217\u663e\u7ed3\u5c3e\uff08\u6700\u8fd1\uff09\u7684 N \u6761\u5386\u53f2\u8f93\u5165\u8bb0\u5f55\u3002  </li> <li>macOS \u4e0b\u8f93\u5165 <code>history N</code> \u5217\u663e\u5f00\u5934\u7684 N \u6761\u5386\u53f2\u8f93\u5165\u8bb0\u5f55\u3002</li> </ul> <p>\u53ef\u901a\u8fc7\u7ba1\u9053\u5c06 <code>history</code> \u5bfc\u5411 <code>tail -n N</code> \u9009\u53d6\u5217\u663e\u7ed3\u5c3e\uff08\u6700\u8fd1\uff09\u7684 N \u6761\u5386\u53f2\u8f93\u5165\u8bb0\u5f55\uff1a</p> <pre><code># \u67e5\u770b\u6700\u8fd110\u6761\u8f93\u5165\u547d\u4ee4\u8bb0\u5f55\nfaner@MBP-FAN:~|\u21d2  history | tail -n 10\n</code></pre>","tags":["bash"]},{"location":"blog/20191022/bash_history/#event_designators","title":"Event Designators","text":"<p>\u9488\u5bf9 history list\uff0c\u652f\u6301\u4ee5\u4e0b\u524d\u7f00\u4e3a <code>!</code> \u7684 Event Designators\uff1a</p> <pre><code>!      Start a history substitution, except when followed by a blank,  newline,  carriage return, = or ( (when the extglob Shell option is enabled using the shopt builtin).\n!n     Refer to command line n.\n!-n    Refer to the current command minus n.\n!!     Refer to the previous command.  This is a synonym for `!-1'.\n!string\n      Refer to the most recent command preceding the current position in the history list starting with string.\n!?string[?]\n      Refer to the most recent command preceding the current position in the history list containing string.  The trailing ? may be omitted if string  is  followed immediately by a newline.\n^string1^string2^\n      Quick  substitution.   Repeat  the  previous  command,  replacing string1 with string2.  Equivalent to ``!!:s/string1/string2/'' (see Modifiers below).\n!#    The entire command line typed so far.\n</code></pre> <ul> <li><code>!!</code>\uff1a\u9009\u5b9a\u4e0a\u4e00\u6761\u547d\u4ee4\uff1b  </li> <li><code>!n</code>\uff1a\u9009\u5b9a\u7f16\u53f7\u4e3a n \u7684\u5386\u53f2\u8bb0\u5f55\uff1b  </li> <li><code>!-n</code>\uff1a\u9009\u5b9a\u7f16\u53f7\u4e3a -n\uff08\u6700\u8fd1\u7b2c n-1 \u6761\uff09 \u7684\u5386\u53f2\u8bb0\u5f55\uff1b  </li> <li><code>!string</code>\uff1a\u9009\u5b9a\u6700\u8fd1\u5386\u53f2\u8bb0\u5f55\u4e2d\u4ee5 string \u5f00\u5934\u7684\u5386\u53f2\u8bb0\u5f55\uff1b  </li> <li><code>!?string</code>\uff1a\u9009\u5b9a\u6700\u8fd1\u5386\u53f2\u8bb0\u5f55\u4e2d\u5305\u542b string \u7684\u5386\u53f2\u8bb0\u5f55\uff1b  </li> </ul> <pre><code># \u6700\u8fd1\u4e00\u6761\u4ee5 curl \u5f00\u5934\u7684\u547d\u4ee4\nfaner@MBP-FAN:~|\u21d2  !curl\nfaner@MBP-FAN:~|\u21d2  curl http://linux.vbird.org/linux_basic/0330regularex/regular_express.txt -o regular_express.txt\n\n# \u6700\u8fd1\u4e00\u6761\u5305\u542b curl \u7684\u547d\u4ee4\nfaner@MBP-FAN:~|\u21d2  !?curl\nfaner@MBP-FAN:~|\u21d2  curl http://linux.vbird.org/linux_basic/0330regularex/regular_express.txt -o regular_express.txt\n</code></pre> <p>\u66f4\u590d\u6742\u7684\u53ef\u4ee5\u57fa\u4e8e grep \u6b63\u5219\u67e5\u627e\u7b26\u5408\u67d0\u4e9b\u89c4\u5b9a\u7684\u5386\u53f2\u547d\u4ee4\u8bb0\u5f55\uff1a</p> <pre><code># \u67e5\u627e\u5305\u542b curl \u4e14\u4ee5 regular_express.txt \u7ed3\u5c3e\u7684\u5386\u53f2\u547d\u4ee4\nfaner@MBP-FAN:~|\u21d2  history | grep 'curl.*regular_express.txt$' \n 9950  curl http://linux.vbird.org/linux_basic/0330regularex/regular_express.txt\n 9953  curl http://linux.vbird.org/linux_basic/0330regularex/regular_express.txt -o regular_express.txt\n</code></pre>","tags":["bash"]},{"location":"blog/20191022/bash_history/#search","title":"Search","text":"<pre><code>reverse-search-history (C-r)\n      Search backward starting at the current line and moving `up' through  the  history as necessary. This is an incremental search.\n\nforward-search-history (C-s)\n      Search  forward starting at the current line and moving `down' through the history as necessary. This is an incremental search.\n</code></pre> <p>\u91cd\u590d\u6309 <code>C-r</code> \u53ef\u7ffb\u770b\u8fc7\u5f80\u5339\u914d\u7684\u547d\u4ee4\u3002</p> <ul> <li>\u8fde\u6309\u4e24\u4e0b esc \u786e\u8ba4\u9009\u5b9a\uff1b  </li> <li>\u6309\u4e0b enter \u6216 <code>C-j</code> \u9009\u5b9a\u6267\u884c\uff1b  </li> <li>\u6309\u4e0b <code>C-g</code> \u53d6\u6d88\u653e\u5f03\u5f53\u524d\u641c\u7d22\u5339\u914d\u7ed3\u679c\uff1b  </li> </ul>","tags":["bash"]},{"location":"blog/20191028/command-lists/","title":"Linux Command Lists","text":"<p>Linux command lists \u2014\u2014 ;, &amp;&amp;, ||.</p>"},{"location":"blog/20191028/command-lists/#continuous","title":"continuous","text":"<p>\u4f7f\u7528\u7a7a\u683c\u6216\u5206\u53f7\uff08<code>;</code>\uff09\u53ef\u6267\u884c\u65e0\u76f8\u5173\u6027\u7684\u8fde\u7eed\u547d\u4ee4\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  test1='test 1' test2='test 2'\nfaner@FAN-MB0:~|\u21d2  echo $test1\ntest 1\nfaner@FAN-MB0:~|\u21d2  echo $test2\ntest 2\nfaner@FAN-MB0:~|\u21d2  echo $test1;echo $test2\ntest 1\ntest 2\n\nfaner@MBP-FAN:~|\u21d2  testShellVar=string; cd ~/Downloads\nfaner@MBP-FAN:~/Downloads|\u21d2  echo $testShellVar \nstring\nfaner@MBP-FAN:~/Downloads|\u21d2 \n</code></pre> <p>Commands separated by a <code>;</code> are executed sequentially</p>"},{"location":"blog/20191028/command-lists/#andor","title":"AND/OR","text":"<p><code>&amp;&amp;</code> \u548c <code>||</code> \u5219\u53ef\u8fde\u7eed\u6267\u884c\u76f8\u5173\u6027\u7684\u547d\u4ee4\u3002</p> <p>AND and OR lists are sequences of one or more pipelines separated by the &amp;&amp; and || control operators, respectively. AND and OR lists are executed with left associativity.</p> <p><code>command1 || command2</code>\uff1a\u5728\u903b\u8f91\u4e0a\u53ea\u8981\u6709\u7b2c\u4e00\u6761\u547d\u4ee4\u6267\u884c\u6210\u529f\u5c31\u4e0d\u4f1a\u6267\u884c\u7b2c\u4e8c\u6761\u547d\u4ee4\uff0c\u53ea\u6709\u7b2c\u4e00\u6761\u547d\u4ee4\u6267\u884c\u5931\u8d25\u624d\u4f1a\u542f\u52a8\u6267\u884c\u7b2c\u4e8c\u6761\u547d\u4ee4\u3002</p> <p>command2 is executed if and only if command1 returns a non-zero exit status.</p> <p><code>command1 &amp;&amp; command2</code>\uff1a\u53ea\u6709\u5728\u7b2c\u4e00\u6761\u547d\u4ee4\u6267\u884c\u6210\u529f\u65f6\u624d\u4f1a\u542f\u52a8\u6267\u884c\u7b2c\u4e8c\u6761\u547d\u4ee4\u3002</p> <p>command2 is executed if, and only if, command1 returns an exit status of zero.</p> <pre><code>mkdir homebrew &amp;&amp; curl -L https://github.com/Homebrew/brew/tarball/master\n</code></pre> <p><code>mkdir homebrew</code> \u6b63\u786e\u6267\u884c\u5b8c\u6bd5\uff0c\u5373\u6210\u529f\u521b\u5efa\u76ee\u5f55 <code>homebrew</code>\uff0c\u624d\u4f1a\u542f\u52a8\u6267\u884c\u540e\u9762\u7684 <code>curl -L</code> \u547d\u4ee4\u3002  </p> <p>\u8fd9\u4e9b\u7b26\u53f7\u4e3a BASH \u7684 token(control operator)\u3002</p>"},{"location":"blog/20191028/command-lists/#demo","title":"demo","text":"<ol> <li>\u4e0b\u9762\u7684 bash \u7cfb\u7edf\u7ea7\u914d\u7f6e <code>/etc/profile</code> \u7684\u5185\u5bb9\uff1a</li> </ol> <pre><code>$ cat /etc/profile\n\n# System-wide .profile for sh(1)\n\nif [ -x /usr/libexec/path_helper ]; then\n    eval `/usr/libexec/path_helper -s`\nfi\n\nif [ \"${BASH-no}\" != \"no\" ]; then\n    # \u5f53 `/etc/bashrc` \u6587\u4ef6\u5b58\u5728\u4e14\u53ef\u8bfb\u65f6\uff0csource \u5f15\u5165\u3002\n    [ -r /etc/bashrc ] &amp;&amp; . /etc/bashrc\nfi\n</code></pre> <ol> <li>vim-interaction.plugin.zsh \u4e2d\u5224\u7b49\u4e32\u8054\u6267\u884c\u547d\u4ee4\uff1a</li> </ol> <pre><code>  # If before or after commands begin with : and don't end with &lt;cr&gt;, append it\n  [[ ${after}  = :* &amp;&amp; ${after}  != *\\&lt;cr\\&gt; ]] &amp;&amp; after+=\"&lt;cr&gt;\"\n  [[ ${before} = :* &amp;&amp; ${before} != *\\&lt;cr\\&gt; ]] &amp;&amp; before+=\"&lt;cr&gt;\"\n  # Open files passed (:A means abs path resolving symlinks, :q means quoting special chars)\n  [[ $# -gt 0 ]] &amp;&amp; files=':args! '\"${@:A:q}&lt;cr&gt;\"\n</code></pre> <ol> <li>\u4e0b\u9762\u662f RapaNui - getopts-12523979.sh \u4e2d\u5224\u65ad\u4e32\u8054\u3001\u5e76\u8054\u6267\u884c\u547d\u4ee4\uff1a</li> </ol> <pre><code>[ $OPTIND -ge 1 ] &amp;&amp; optind=$(expr $OPTIND - 1) || optind=$OPTIND\n</code></pre> <ol> <li> <p>\u5f53\u524d\u76ee\u5f55\u4e0b\u5982\u679c\u6709 <code>forms-debug</code> \u6587\u4ef6\u5939\u5219\u8fdb\u5165\uff0c\u5426\u5219\u5148\u521b\u5efa\u518d\u8fdb\u5165\u3002</p> <ul> <li>Check if a directory exists in a shell script </li> <li>Linux / UNIX: Find Out If a Directory Exists or Not </li> </ul> </li> </ol> <pre><code>([ -d forms-debug ] || mkdir forms-debug) &amp;&amp; cd forms-debug\n</code></pre>"},{"location":"blog/20191028/command-string/","title":"Linux Command Strings","text":"<p>Linux command strings, assignment, quoting, substituion, etc.</p>"},{"location":"blog/20191028/command-string/#assign","title":"assign","text":"<p>bash shell \u4e2d\u53ef\u901a\u8fc7\u7b49\u53f7\uff08equality sign\uff09\u8d4b\u503c\u5b9a\u4e49\u53d8\u91cf\uff0c\u53f3\u503c\u5373\u4f7f\u6ca1\u6709\u5f15\u53f7\uff08\u5355/\u53cc\uff09\u5f15\u7528\uff0c\u9ed8\u8ba4\u89c6\u4f5c\u5b57\u7b26\u4e32\u7c7b\u578b\u3002</p> <pre><code>faner@MBP-FAN:~|\u21d2  testString=define\nfaner@MBP-FAN:~|\u21d2  echo $testString\ndefine\n</code></pre> <p>\u6ce8\u610f\uff1a\u5728\u53d8\u91cf\u3001\u7b49\u53f7\u548c\u503c\u4e4b\u95f4\u4e0d\u80fd\u51fa\u73b0\u7a7a\u683c\u3002</p>"},{"location":"blog/20191028/command-string/#meta","title":"meta","text":"<p>\u5f53\u6ca1\u6709\u5f15\u53f7\u5c01\u95ed\uff08unquoted\uff09\uff0c\u9047\u5230 \u5143\u5b57\u7b26\uff08metacharacter\uff09 \u65f6\uff0c\u5c06\u81ea\u52a8\u5206\u5272\u4e3a\u591a\u6761\u5206\u7ec4\u547d\u4ee4\u3002</p> <p>\u5173\u4e8e bash shell \u7684\u5143\u5b57\u7b26\uff0c\u53c2\u8003 <code>man 1 bash</code> \u4e2d DEFINITIONS \u90e8\u5206\u7684\u5b9a\u4e49\uff1a</p> <pre><code>DEFINITIONS\n\nmetacharacter\n A character that, when unquoted, separates words. One of the following:\n\n| &amp; ; ( ) &lt; &gt; space tab newline\n</code></pre> <p>\u4ee5\u4e0b\u7b2c\u4e00\u4e2a\u7a7a\u683c\u5c06\u53f3\u503c\u622a\u65ad\uff0c\u5b9e\u9645\u6709\u6548\u7684\u8d4b\u503c\u547d\u4ee41\u4e3a <code>testString=define</code> \uff0c\u6b63\u5e38\u6709\u6548\u6267\u884c\uff1b string \u4e3a\u547d\u4ee42\uff0c\u7531\u4e8e\u627e\u4e0d\u5230 <code>string</code> \u547d\u4ee4\u800c\u63d0\u793a\u62a5\u9519\u3002</p> <pre><code>faner@MBP-FAN:~|\u21d2  testString=define string in shell command line\nzsh: command not found: string\nfaner@MBP-FAN:~|\u21d2  echo $testString \ndefine\n</code></pre> <p>\u5982\u679c\u6bcf\u4e2a\u5206\u7ec4\u90fd\u4e3a\u6709\u6548\u53ef\u6267\u884c\u547d\u4ee4\uff0c\u4e00\u822c\u4f1a\u4f9d\u6b21\u6267\u884c\u3002</p> <p>\u53c2\u8003\u4e0b\u6587\u7684 <code>test1='test 1' test2='test 2'</code> \u6d4b\u8bd5\u7528\u4f8b\u3002  </p> <p>\u4f46\u4ee5\u4e0b\u793a\u4f8b\u5ffd\u7565\u4e86\u7b2c\u4e00\u6761\u8d4b\u503c\u547d\u4ee4\uff0c\u800c\u53ea\u6267\u884c\u4e86\u7b2c2\u6761 cd \u547d\u4ee4\uff1f</p> <pre><code>faner@MBP-FAN:~|\u21d2  testShellVar=string cd ~/Downloads\nfaner@MBP-FAN:~/Downloads|\u21d2  echo $testShellVar\n\nfaner@MBP-FAN:~/Downloads|\u21d2  \n</code></pre>"},{"location":"blog/20191028/command-string/#escape","title":"escape","text":"<p>\u53e6\u5916\u4e00\u79cd\u5e38\u89c1\u5199\u6cd5\u662f\u5229\u7528\u5355\u53cd\u659c\u6760 <code>\\\\</code> \u8f6c\u4e49\u6389\u7a7a\u683c\u7b49\u5143\u5b57\u7b26\u542b\u4e49\uff0c\u663e\u5f0f\u58f0\u660e\u91c7\u7528\u539f\u751f\u5b57\u7b26\u4e49\u3002</p> <p>\u4ee5\u4e0b\u5bf9\u7a7a\u683c\u8fdb\u884c\u8f6c\u4e49\uff0c\u5f53\u505a\u539f\u4e49\u4f7f\u7528\u65f6\uff0c\u7b49\u53f7\u53f3\u4fa7\u4e0d\u518d\u5206\u5272\u4e3a\u591a\u6761\u547d\u4ee4\uff0c\u800c\u662f\u5f53\u505a\u4e00\u6574\u6761\u5b57\u7b26\u4e32\u3002</p> <pre><code>faner@MBP-FAN:~|\u21d2  testString=define\\ string\\ in\\ shell\\ command\\ line\nfaner@MBP-FAN:~|\u21d2  echo $testString\ndefine string in shell command line\n</code></pre> <p>\u4ee5\u4e0b\u5bf9\u5206\u53f7\u548c\u7a7a\u683c\u8fdb\u884c\u8f6c\u4e49\uff0c\u5f53\u505a\u539f\u4e49\u4f7f\u7528\u65f6\uff0c\u4e0d\u518d\u6267\u884c cd \u5207\u6362\u76ee\u5f55\u3002</p> <pre><code>faner@MBP-FAN:~|\u21d2  testShellVar=string\\;\\ cd\\ ~/Downloads\nfaner@MBP-FAN:~|\u21d2  echo $testShellVar\nstring; cd ~/Downloads\n</code></pre>"},{"location":"blog/20191028/command-string/#quoting","title":"QUOTING","text":"<p>\u9664\u4e86\u5229\u7528\u5355\u53cd\u659c\u6760 <code>\\\\</code> \u8f6c\u4e49\u6389\u7a7a\u683c\u7b49\u5143\u5b57\u7b26\u542b\u4e49\uff0c\u663e\u5f0f\u58f0\u660e\u91c7\u7528\u539f\u751f\u5b57\u7b26\u4e49\u5916\uff0c\u4e00\u79cd\u66f4\u666e\u9002\u7684\u65b9\u6848\u662f\u5f15\u7528\u3002</p> <p>\u901a\u8fc7\u5355\u5f15\u53f7\uff08<code>'single_quoting'</code>\uff09\u6216\u53cc\u5f15\u53f7\uff08<code>\"double_quoting\"</code>\uff09\u6765\u5c01\u95ed\u5f15\u7528\u662f\u7f16\u7a0b\u8bed\u8a00\u4e2d\u5e38\u89c1\u7684\u5b57\u7b26\u4e32\u5b9a\u4e49\u65b9\u5f0f\u3002</p> <pre><code>QUOTING\n\nQuoting is used to remove the special meaning of certain characters or words to the shell. Quoting can be used to disable special treatment for special characters, to prevent reserved words from being recognized as such, and to prevent parameter expansion.\n\nEach of the metacharacters listed above under DEFINITIONS has special meaning to the shell and must be quoted if it is to represent itself.\n</code></pre> <p>\u901a\u8fc7\u5355\u5f15\u53f7\u95ed\u5305\u7684\u5b57\u7b26\u4e32\u4e2d\u7684\u6240\u6709\u5b57\u7b26\u90fd\u91c7\u7528\u539f\u4e49\uff0c\u4f46\u662f\u4e2d\u95f4\u4e0d\u80fd\u51fa\u73b0\u5355\u5f15\u53f7\u81ea\u8eab\uff0c\u5373\u4f7f\u91c7\u7528\u53cd\u659c\u6760\uff08backslash\uff09\u4e5f\u65e0\u6cd5\u8f6c\u4e49\uff08escape\uff09\u3002</p> <pre><code>Enclosing characters in single quotes preserves the literal value of each character within the quotes. A single quote may not occur between single quotes, even when preceded by a backslash.\n</code></pre> <p>\u901a\u8fc7\u53cc\u5f15\u53f7\u95ed\u5305\u7684\u5b57\u7b26\u4e32\u4e2d\u7684 $\u3001`\u3001\\ \u7b49\u5b57\u7b26\u5c06\u5177\u6709\u7279\u6b8a\u610f\u4e49\u3002</p> <pre><code>Enclosing characters in double quotes preserves the literal value of all characters within the quotes, with the exception of $, `, \\, and, when history expansion is enabled, !.\n</code></pre>"},{"location":"blog/20191028/command-string/#demo","title":"demo","text":"<p>\u5b9a\u4e49\u5305\u542b\u7a7a\u683c\u548c\u5206\u53f7\u7b49\u5143\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\uff1a</p> <pre><code># \u5355\u5f15\u53f7\u5b9a\u4e49\u5b57\u7b26\u4e32\npi@raspberrypi:~ $ testString='define string in shell command line'\npi@raspberrypi:~ $ echo $testString \ndefine string in shell command line\n\n# \u53cc\u5f15\u53f7\u91cd\u5b9a\u4e49\u5b57\u7b26\u4e32\nfaner@MBP-FAN:~|\u21d2  testShellVar=\"string cd ~/Downloads\"\nfaner@MBP-FAN:~|\u21d2  echo $testShellVar \nstring cd ~/Downloads\n</code></pre> <p>\u5f15\u8ff0\u5305\u542b\u7a7a\u683c\u7684\u6587\u4ef6\u540d\uff1a</p> <pre><code># \u5355\u5f15\u53f7\u5f15\u7528\nmv 'a ~file name.txt' another.txt\n\n# \u53cc\u5f15\u53f7\u5f15\u7528\nmv \"a ~file name.txt\" another.txt\n</code></pre> <p>cd \u8fdb\u5165\u5305\u542b\u7a7a\u683c\u7684\u76ee\u5f55\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  cd /Applications/Google\\ Chrome.app/Contents/MacOS/\n# \u6216\u5c06 cd \u5230\u7684\u76ee\u5f55\u8def\u5f84\u5b57\u7b26\u4e32\u6574\u4f53\u7528\u5f15\u53f7\u5c01\u95ed\uff0c\u5c31\u65e0\u9700\u5bf9\u7a7a\u683c\u8fdb\u884c\u8f6c\u4e49\u3002\nfaner@MBP-FAN:~|\u21d2  cd \"/Applications/Google Chrome.app/Contents/MacOS/\"\n</code></pre> <p>\u5728 <code>~/.zshrc</code> \u4e2d\u6dfb\u52a0\u66ff\u8eab\u547d\u4ee4prefs\uff0c\u4ee5\u4fbf\u5feb\u6377\u6253\u5f00\u7cfb\u7edf\u504f\u597d\u8bbe\u7f6e\u9762\u677f\u3002</p> <pre><code>alias prefs='open /System/Applications/System\\ Preferences.app'\n# \u4e5f\u53ef\u5c06 open \u540e\u9762\u7684app\u8def\u5f84\u53c2\u6570\u6574\u4f53\u7528\u53cc\u5f15\u53f7\u5c01\u95ed\nalias prefs='open \"/System/Applications/System Preferences.app\"'\n</code></pre> <p>\u5728 <code>~/.zshrc</code> \u4e2d\u6dfb\u52a0\u66ff\u8eab\u547d\u4ee4chrome\uff0c\u4ee5\u4fbf\u5feb\u6377\u6253\u5f00 Google Chrome \u6d4f\u89c8\u5668\uff0c\u6ce8\u610f\u7a7a\u683c\u5fc5\u987b\u52a0\u8f6c\u4e49\u3002</p> <pre><code>alias chrome=\"/Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome\"\n</code></pre> <p>\u4f46\u662f\uff0c\u5bf9\u4e8e export \u8d4b\u503c\u73af\u5883\u53d8\u91cf\uff0c\u5982\u679c\u5bf9\u53f3\u503c\u6574\u4f53\u52a0\u53cc\u5f15\u53f7\u5f15\u7528\uff0c\u5219\u5176\u4e2d\u7684\u7a7a\u683c\u65e0\u9700\u8f6c\u4e49\u3002</p> <pre><code>export CHROME_EXECUTABLE=/Applications/Google\\ Chrome.app/Contents/MacOS/launch-unsafe.sh\n</code></pre>"},{"location":"blog/20191028/command-string/#vs_assign","title":"vs. assign","text":"<p>\u5f15\u7528\u4e00\u4e2a\u53d8\u91cf\u503c\u65f6\uff0c\u9700\u8981\u4f7f\u7528\u7f8e\u5143\u7b26\u53f7\uff1b\u800c\u5f15\u7528\u53d8\u91cf\u6765\u5bf9\u5176\u8fdb\u884c\u8d4b\u503c\u65f6\u4e0d\u9700\u8981\u4f7f\u7528\u7f8e\u5143\u7b26\u53f7\u3002</p> <pre><code>#!/bin/bash\nvalue1=10       #\u5de6\u503c\u8d4b\u503c\nvalue2=$value1  #\u53f3\u503c\u5f15\u7528\necho The resulting value is $value2\n</code></pre>"},{"location":"blog/20191028/command-string/#command_substitution","title":"Command Substitution","text":"<p>shell \u811a\u672c\u4e2d\u6700\u6709\u7528\u7684\u7279\u6027\u4e4b\u4e00\u5c31\u662f\u53ef\u4ee5\u4ece\u547d\u4ee4\u8f93\u51fa\u4e2d\u63d0\u53d6\u4fe1\u606f\uff0c\u5e76\u5c06\u5176\u8d4b\u7ed9\u53d8\u91cf\u3002\u628a\u8f93\u51fa\u8d4b\u7ed9\u53d8\u91cf\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u968f\u610f\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u4e86\u3002</p> <pre><code># man bash\n   Command Substitution\n       Command  substitution allows the output of a command to replace the command name.  There\n       are two forms:\n\n\n              $(command)\n       or\n              `command`\n\n       Bash performs the expansion by executing command and replacing the command  substitution\n       with  the  standard output of the command, with any trailing newlines deleted.  Embedded\n       newlines are not deleted, but they may be removed during word  splitting.   The  command\n       substitution $(cat file) can be replaced by the equivalent but faster $(&lt; file).\n\n       When the old-style backquote form of substitution is used, backslash retains its literal\n       meaning except when followed by $, `, or \\.  The first backquote not preceded by a back-\n       slash  terminates the command substitution.  When using the $(command) form, all charac-\n       ters between the parentheses make up the command; none are treated specially.\n\n       Command substitutions may be nested.  To nest when using the backquoted form, escape the\n       inner backquotes with backslashes.\n\n       If  the substitution appears within double quotes, word splitting and pathname expansion\n       are not performed on the results.\n</code></pre> <p>\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5c06\u547d\u4ee4\u8f93\u51fa\u8d4b\u7ed9\u53d8\u91cf\uff1a</p> <ol> <li>\u53cd\u5f15\u53f7\u5b57\u7b26\uff08`\uff09\uff1b  </li> <li>$() \u683c\u5f0f\uff1b  </li> </ol>"},{"location":"blog/20191028/command-string/#_1","title":"$","text":"<p>\u5355\u5f15\u53f7\u5c06\u5176\u95ed\u5305\u5b57\u7b26\u4e32\u4e2d\u7684 <code>$</code> \u89c6\u4f5c\u666e\u901a\u5b57\u7b26\uff0c\u4e0d\u4f1a\u66ff\u4ee3\u89e3\u5f15\u7528\u53d8\u91cf\u503c\uff1a</p> <pre><code>pi@raspberrypi:~ $ varLANG='env LANG=$LANG'\npi@raspberrypi:~ $ echo $varLANG \nenv LANG=$LANG\n</code></pre> <p>\u53cc\u5f15\u53f7\u53ef\u8bc6\u522b\u95ed\u5305\u5b57\u7b26\u4e32\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26 <code>$</code>\uff0c\u89e3\u5f15\u7528\u53d8\u91cf\u503c\u5e76\u66ff\u6362\u3002</p> <pre><code>pi@raspberrypi:~ $ varLC_CTYPE=\"LC_CTYPE = $LC_CTYPE\"\npi@raspberrypi:~ $ echo ${varLC_CTYPE}\nLC_CTYPE = UTF-8\n</code></pre> <p>\u53cc\u5f15\u53f7\u4e2d\u82e5\u8981\u6253\u5370\u666e\u901a\u7684 <code>$</code> \u7b26\u53f7\uff0c\u53ef\u4f7f\u7528\u53cd\u659c\u6760 <code>\\$</code> \u8f6c\u4e49\u4e3a\u666e\u901a\u5b57\u7b26\u3002</p> <pre><code>pi@raspberrypi:~ $ varLC_CTYPE=\"LC_CTYPE = \\$LC_CTYPE\"\npi@raspberrypi:~ $ echo ${varLC_CTYPE}\nLC_CTYPE = $LC_CTYPE\n</code></pre> <p>\u5728\u6761\u4ef6\u6d4b\u8bd5\u4e00\u8282 test \u4e2d\uff0c\u5bf9\u4e8e <code>[ -n $var ]</code> \u6216 <code>[ -z $var ]</code> \u5224\u7a7a\u5b57\u7b26\u4e32\u65f6\uff0c\u5982\u679c var \u4e3a\u672a\u5b9a\u4e49\uff08unset\uff09\u72b6\u6001\uff0c\u90a3\u4e48 <code>$var</code> \u4f1a\u5f53\u505a\u666e\u901a\u5b57\u7b26\u4e32\uff0c\u800c\u4e0d\u4f1a\u89e3\u5f15\u7528\uff0c\u5bfc\u81f4 <code>-n</code> \u6d4b\u8bd5\u901a\u8fc7\uff01</p> <p>\u5177\u4f53\u53c2\u8003 shellcheck\uff0c\u5176\u4e2d\u4f1a\u8b66\u544a SC2070 \u548c SC2086\u3002</p> <p>\u4e3a\u4e86\u5b89\u5168\u5bf9\u53d8\u91cf\u7684\u5f15\u7528\u8fdb\u884c\u5224\u7a7a\uff0c\u5efa\u8bae Apply fix for SC2086 \u2014\u2014 \u52a0\u53cc\u5f15\u53f7\u786e\u4fdd\u5b89\u5168\u89e3\u5f15\u7528\uff0c\u517c\u987e\u53d8\u91cf unset \u7684\u60c5\u51b5\u3002</p> <ul> <li> : if [ -n $var ]; then echo \"not empty\" ; fi </li> <li> : if [ -n \"$var\" ]; then echo \"not empty\" ; fi  </li> </ul>"},{"location":"blog/20191028/command-string/#demo_1","title":"demo","text":"<pre><code>#!/bin/bash\n\ntesting=$(date) #\u547d\u4ee4\u66ff\u6362\necho \"The date and time are: \" $testing #\u5f15\u7528\u53d8\u91cf\n</code></pre> <p>\u4e0b\u9762\u7684\u8fd9\u4e2a\u4f8b\u5b50\uff0c\u901a\u8fc7\u547d\u4ee4\u66ff\u6362\u83b7\u5f97\u5f53\u524d\u65e5\u671f\u5e76\u7528\u5b83\u6765\u751f\u6210\u5f53\u5929\u7684\u65e5\u5fd7\u6587\u4ef6\u540d\u3002</p> <pre><code>#!/bin/bash\n\ntoday=$(date +%y%m%d)\nls /usr/bin -al &gt; log.$today\n</code></pre> <p>\u4ee5\u4e0b\u53f3\u503c\u5f15\u7528\u4e2d\u7684 <code>$testPATH</code> \u548c <code>${testPATH}</code> \u53ef\u52a0\u53cc\u5f15\u53f7\u3002</p> <pre><code># testPATH \u521d\u59cb\u503c\npi@raspberrypi:~ $ testPATH=/usr/bin:/bin:/usr/sbin:/sbin\n\n# \u5934\u90e8\u63d2\u5165\npi@raspberrypi:~ $ testPATH=/usr/local/bin:$testPATH\n\n# \u5c3e\u90e8\u8ffd\u52a0\npi@raspberrypi:~ $ testPATH=${testPATH}:/usr/local/sbin\n</code></pre> <p>\u4ee5\u4e0b brew \u7684\u5b98\u7f51\u9996\u9875 \u7ed9\u51fa\u7684 Homebrew \u5b89\u88c5\u547d\u4ee4\uff1a</p> <pre><code>/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n</code></pre> <ol> <li> <p>\u8c03\u7528 curl \u4e0b\u8f7d Homebrew \u7684 \u5b89\u88c5\u811a\u672c install.rb </p> <p><code>-f</code>, --fail: (HTTP)  Fail  silently (no output at all) on server errors. <code>-s</code>, --silent: Silent or quiet mode. Don't show progress meter or  error  messages. Makes  Curl mute. <code>-S</code>, --show-error: When used with -s, --silent, it makes curl show an error message if it fails. <code>-L</code>, --location: (HTTP)  If  the  server  reports  that the requested page has moved to a different location (indicated with a Location: header and a 3XX response code), this  option will  make  curl  redo  the  request  on  the new place.  </p> </li> <li> <p>\u8c03\u7528 ruby \u6267\u884c\u4e0b\u8f7d\u7684\u5b89\u88c5\u811a\u672c\uff08install.rb\uff09\u3002</p> <p><code>-e</code> 'command': one line of script.  </p> </li> </ol> <p>\u4ee5\u4e0b\u9009\u81ea \u6e05\u534e\u5927\u5b66\u5f00\u6e90\u8f6f\u4ef6\u955c\u50cf\u7ad9 \u7684 Homebrew \u955c\u50cf\u4f7f\u7528\u5e2e\u52a9\uff1a</p> <pre><code># $(brew --repo) \u53ef\u52a0\u53cc\u5f15\u53f7\nfaner@FAN-MB0:~|\u21d2  cd $(brew --repo)\nfaner@FAN-MB0:/usr/local/Homebrew|stable\n\n# $(brew --repo) \u53ef\u52a0\u53cc\u5f15\u53f7\n\u21d2  cd $(brew --repo)/Library/Taps/homebrew/homebrew-core\nfaner@FAN-MB0:/usr/local/Homebrew/Library/Taps/homebrew/homebrew-core|master\n\u21d2  \n</code></pre>"},{"location":"blog/20191028/command-string/#secondary","title":"secondary","text":"<p>\u8003\u8651\u8fd9\u6837\u4e00\u79cd\u60c5\u5f62\uff1a\u4f20\u5165\u53c2\u6570 <code>$1</code> \u4e3a\u8fd0\u884c\u6a21\u5f0f\uff0cmode\u53ef\u80fd\u53d6\u503c debug\u3001profile\u3001release\u3002 \u5148\u5c1d\u8bd5\u4ece\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6 .env.debug(profile,release) \u4e2d\u8bfb\u53d6 AUTH_TOKEN\uff0c\u5982\u679c\u8bfb\u53d6\u4e0d\u5230\uff0c\u518d\u5c1d\u8bd5\u8bfb\u53d6\u73af\u5883\u53d8\u91cf DEBUG_AUTH_TOKEN\uff08PROFILE_AUTH_TOKEN\u3001RELEASE_AUTH_TOKEN\uff09\u3002</p> <p>export DEBUG_AUTH_TOKEN=<code>****************************************</code></p> <p>\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u4e2d\u672a\u5b9a\u4e49AUTH_TOKEN\uff0c\u9996\u5148\u8981\u5c06mode\uff08\u9ed8\u8ba4\u4e3adebug\uff09\u8f6c\u6362\u4e3a\u5927\u5199\u7684env_mode\uff0c\u518d\u62fc\u63a5\u51fa\u73af\u5883\u53d8\u91cf\u540denv_token_key\uff08DEBUG_AUTH_TOKEN\uff09\uff0c\u7136\u540e\u8981\u8bfb\u53d6\u540d\u4e3aenv_token_key\u7684\u73af\u5883\u53d8\u91cf\u7684\u503c\u3002</p> <p>\u5982\u679c\u76f4\u63a5\u5f15\u7528 $env_mode_key\uff0c\u5219\u5176\u503c\u4e3a DEBUG_AUTH_TOKEN\u3002\u4f46\u6211\u4eec\u5b9e\u9645\uff0c\u662f\u60f3\u8bfb\u53d6\u73af\u5883\u53d8\u91cf DEBUG_AUTH_TOKEN \u7684\u503c\u3002 \u8fd9\u91cc\u9700\u8981\u8bfb\u53d6\u5b57\u7b26\u4e32\u5b9a\u4e49\u7684\u53d8\u91cf\u7684\u503c\uff0c\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u95ee\u9898\u6709\u70b9\u7c7b\u4f3cC\u8bed\u8a00\u4e2d\u7684\u4e8c\u7ea7\u6307\u9488\u89e3\u5f15\u7528\u3002</p> <p>\u53c2\u8003 How to get a variable value if variable name is stored as string?\uff0c\u53ef\u4ee5\u8fd9\u6837\u8fdb\u884c\u4e8c\u7ea7\u89e3\u5f15\u7528\u8d4b\u503c\uff1a<code>eval \"env_token=\\$$env_token_key\"</code>\u3002</p> <pre><code>    # \u914d\u7f6e\u6587\u4ef6\u672a\u68c0\u6d4b\u5230\u4ee4\u724c\n    if [ -z \"$auth_token\" ]; then\n        # \u5c1d\u8bd5\u8bfb\u53d6\u73af\u5883\u53d8\u91cf (DEBUG PROFILE RELEASE)_AUTH_TOKEN\n        local env_mode=''\n        env_mode=$(echo \"$mode\" | tr '[:lower:]' '[:upper:]')\n        local env_token_key=\"$env_mode\"_AUTH_TOKEN\n        local env_token=''\n        eval \"env_token=\\$$env_token_key\" # string as var name\n        if [ -n \"$env_token\" ]; then\n            auth_token=$env_token\n        else\n            echo -e \"\\033[1;31m\u672a\u68c0\u6d4b\u5230\u8bbf\u95ee CODING API \u7684\u8eab\u4efd\u8ba4\u8bc1\u4fe1\u606f\\033[0m\uff0c\\033[1m\u8bf7\u6309\u4ee5\u4e0b\u6b65\u9aa4\u7533\u8bf7\u914d\u7f6e\uff1a\\033[0m\"\n        fi\n    fi\n</code></pre>"},{"location":"blog/20191028/command-string/#_2","title":"`","text":"<p>\u5728 shell \u547d\u4ee4\u4e2d\uff0c\u5f80\u5f80\u9700\u8981\u5c06\u5176\u4ed6\u547d\u4ee4\u6267\u884c\u7ed3\u679c\u4f5c\u4e3a\u8f93\u5165\u4fe1\u606f\uff0c\u6b64\u65f6\u53ef\u4f7f\u7528 \u201c`command`\u201d \u6216 \u201c$(command)\u201d \u5f15\u7528 command \u6267\u884c\u7ed3\u679c\u3002</p> <p>Linux Distributions \u90fd\u53ef\u80fd\u62e5\u6709\u591a\u4e2a\u5185\u6838\u7248\u672c\uff0c\u4e14\u51e0\u4e4e distribution \u7684\u6240\u6709\u5185\u6838\u7248\u672c\u90fd\u4e0d\u76f8\u540c\u3002 \u82e5\u60f3\u8fdb\u5165\u5f53\u524d\u5185\u6838\u7684\u6a21\u5757\u76ee\u5f55\uff0c\u53ef\u4ee5\u5148\u6267\u884c <code>uname -r</code> \u83b7\u53d6\u53d1\u884c\u7248\u672c\u4fe1\u606f\uff08-r, --kernel-release\uff09\uff0c\u7136\u540e cd \u8fdb\u5165\u76ee\u524d\u5185\u6838\u7684\u9a71\u52a8\u7a0b\u5e8f\u6240\u653e\u4f4d\u7f6e\u3002</p> <pre><code>pi@raspberrypi:~ $ uname -r\n4.9.59-v7+\npi@raspberrypi:~ $ cd /lib/modules/`uname -r`/kernel\npi@raspberrypi:/lib/modules/4.9.59-v7+/kernel $ ls\narch  crypto  drivers  fs  kernel  lib  mm  net  sound\npi@raspberrypi:/lib/modules/4.9.59-v7+/kernel $ ls | wc -l\n9\n</code></pre> <p>\u4ee5\u4e0a `uname -r` \u53ef\u66ff\u6362\u4e3a <code>$(uname -r)</code> \u6216 <code>\"$(uname -r)\"</code>\u3002</p> <ol> <li>\u5148\u6267\u884c\u53cd\u5355\u5f15\u53f7\u5185\u7684\u547d\u4ee4 <code>uname -r</code> \u83b7\u53d6\u5185\u6838\u7248\u672c\u4e3a <code>4.9.59-v7+</code>\uff1b  </li> <li>\u5c06\u4e0a\u8ff0\u7ed3\u679c\u4ee3\u5165 cd \u547d\u4ee4\u7684\u76ee\u5f55\u4e2d\uff0c\u5f97\u5230\u5b9e\u9645\u547d\u4ee4 <code>/lib/modules/4.9.59-v7+/kernel</code>\u3002  </li> </ol> <p>\u9274\u4e8e\u53cd\u5355\u5f15\u53f7\u5bb9\u6613\u6253\u9519\u6216\u5f04\u9519\uff0c\u5efa\u8bae\u4f7f\u7528 <code>$(uname -r)</code> \u8fd9\u79cd\u89e3\u5f15\u7528\u683c\u5f0f\u3002</p> <p>\u76f8\u6bd4\u53cd\u5f15\u53f7\uff0c<code>$()</code> \u53ef\u4ee5\u533a\u5206\u5de6\u53f3\uff0c\u56e0\u6b64\u652f\u6301\u5d4c\u5957\u3002</p> <p>\u4ee5\u4e0b\u4e3a\u67e5\u770b\u548c\u590d\u4f4d\uff08reset\uff09 <code>brew --repo</code> \u7684 git url \u4fe1\u606f\uff1a</p> <pre><code>git -C `brew --repo` remote get-url origin\n\ngit -C \"$(brew --repo)\" remote set-url origin https://github.com/Homebrew/brew.git\ngit -C \"$(brew --repo homebrew/core)\" remote set-url origin https://github.com/Homebrew/homebrew-core.git\ngit -C \"$(brew --repo homebrew/cask)\" remote set-url origin https://github.com/Homebrew/homebrew-cask.git\n\nbrew update\n</code></pre>"},{"location":"blog/20191103/Globbing%28Wildcard%29/","title":"Linux Globbing(Wildcard)","text":"<p>\u53c2\u8003 <code>man 1 bash</code> \u4e2d\u7684 EXPANSION | Pathname Expansion | Pattern Matching\uff08glob &amp; extglob\uff09\u3002  </p> <p>\u53c2\u8003 Bash Reference Manual\uff08PDF\uff09\u7684 3.5 Shell Expansions | Filename Expansion | Pattern Matching\u3002  </p> <p>Shell GLOB patterns Bash Extended Globbing </p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#man_7_glob","title":"man 7 GLOB","text":"<p>NOTES | Regular expressions of man 7 glob </p> <p>Note that wildcard patterns are not regular expressions, although they are a bit similar. First of all, they match filenames, rather than text, and secondly, the conventions are not the same: for example, in a regular expression '' means  zero  or  more copies of the preceding* thing.</p> <p>Now  that regular expressions have bracket expressions where the negation is indicated by a '^', POSIX has declared the effect of a wildcard pattern  \"[^...]\"  to  be undefined.</p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#advanced_bash-scripting_guide","title":"Advanced Bash-Scripting Guide","text":"<p>Globbing &amp; Wildcards</p> <p>Bash itself cannot recognize Regular Expressions. Inside scripts, it is commands and utilities -- such as sed and awk -- that interpret RE's.</p> <p>Bash does carry out filename expansion -- a process known as globbing -- but this does not use the standard RE set. Instead, globbing recognizes and expands wild cards.</p> <p>Bash performs filename expansion on unquoted command-line arguments.</p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#glob","title":"glob","text":"<p>In computer programming, in particular in a Unix-like environment, glob patterns specify sets of filenames with wildcard characters.</p> <p>For example, the Unix command <code>mv *.txt textfiles/</code> moves (<code>mv</code>) all files with names ending in <code>.txt</code> from the current directory to the directory <code>textfiles</code>. Here, <code>mv *.txt textfiles/</code>, <code>*</code> is a wildcard standing for \"any string of characters\" and <code>*.txt</code> is a glob pattern.</p> <p>The other common wildcard is the question mark (<code>?</code>), which stands for one character.</p> <p>The most common wildcards are <code>*</code>, <code>?</code>, and <code>[list]</code>.</p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#wildcards","title":"wildcards","text":"<p>In software, a wildcard character is a kind of placeholder represented by a single character, such as an asterisk (<code>*</code>), which can be interpreted as a number of literal characters or an empty string. It is often used in file searches so the full name need not be typed.</p> <p>Bash \u4e2d\u5e38\u7528\u901a\u914d\u7b26\u53ea\u67093\u4e2a: <code>*</code>, <code>?</code>, <code>[list]</code>\u3002  </p> <p><code>**</code>\uff1a\u51fa\u73b0\u5728\u8def\u5f84\u4e2d\uff0c\u5339\u914d\u4efb\u610f\u7ea7\u522b\u76ee\u5f55\uff08\u9012\u5f52\uff09\u3002  </p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#_1","title":"*","text":"<p><code>*</code>\uff08asterisk\uff09: match any number of any characters  </p> <p>matches zero or more of any character in a name, including spaces or other strange characters. <code>*</code>\uff1a\u51fa\u73b0\u5728\u8def\u5f84\u4e2d\uff0c\u5339\u914d\u4e00\u7ea7\u5b50\u76ee\u5f55\uff08\u4e0d\u9012\u5f52\uff09\u3002  </p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#_2","title":"?","text":"<p><code>?</code>\uff08question mark\uff09\uff1amatch only one single character, any character  </p> <p>matches exactly one of any character in a name, including a space or other strange character.  </p> <ul> <li>The GLOB pattern <code>???*</code> matches non-hidden names that are three or more characters long.  </li> </ul>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#list","title":"[list]","text":"<p><code>[list]</code>\uff08square brackets\uff09\uff1amatch single characters from a list   </p> <p>match exactly one character in a name from a list of characters.  </p> <ul> <li><code>[aA]</code>: it matches any one-character name that is either a or A.  </li> <li><code>[a][A]</code>: only matches aA.  </li> </ul>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#demo","title":"demo","text":"<pre><code>*.txt               # \u5339\u914d\u5168\u90e8\u540e\u7f00\u4e3a.txt\u7684\u6587\u4ef6\nfile?.log           # \u5339\u914dfile1.log, file2.log, ...\n[a-z]*.log          # \u5339\u914da-z\u5f00\u5934\u7684.log\u6587\u4ef6\n[^a-z]*.log         # \u4e0a\u9762\u7684\u53cd\u5411\u5339\u914d\n/etc/**/*.conf      # \u731c\u731c\u770b?\n</code></pre> <p>\u53cd\u659c\u6760(<code>\\</code>)\u6216\u5f15\u53f7(<code>'</code>, <code>\"</code>)\u90fd\u4f1a\u4f7f\u901a\u914d\u7b26\u5931\u6548\u3002</p> <p>\u5982: <code>\\*</code>, <code>'*'</code>, <code>\"*\"</code> \u90fd\u8868\u793a <code>*</code> \u672c\u8eab\uff0c\u4e0d\u901a\u914d\u4efb\u4f55\u6587\u4ef6\u3002</p> <pre><code># \u5339\u914d usr/include \u4e0b\u7684\u4e00\u7ea7\u5b50\u76ee\u5f55\uff08\u4e0d\u9012\u5f52\uff09\nls -d usr/include/*/\n# \u5339\u914d usr/include \u4e0b\u7684\u6240\u6709\u5b50\u76ee\u5f55\uff08\u9012\u5f52\uff09\nls -d usr/include/**/\n\n# \u5339\u914d /etc/ \u4e0b\u4e00\u7ea7\u5b50\u76ee\u5f55\u4e0b\u7684 conf \u914d\u7f6e\u6587\u4ef6\uff08\u4e0d\u9012\u5f52\uff09\nls -l /etc/*/*.conf\n# \u5339\u914d /etc/ \u4e0b\u6240\u6709\u5b50\u76ee\u5f55\u4e0b\u7684 conf \u914d\u7f6e\u6587\u4ef6\uff08\u9012\u5f52\uff09\nls -l /etc/**/*.conf\n</code></pre> <p>\u5728 /usr/include \u76ee\u5f55\u4e0b\uff08\u9012\u5f52\uff09\u67e5\u627e\u540d\u79f0\u4e3a wordsize.h \u7684\u6587\u4ef6\u3002</p> <pre><code>$ find /usr/include -type f -name wordsize.h\n/usr/include/aarch64-linux-gnu/bits/wordsize.h\n</code></pre> <p>\u5982\u679c\u77e5\u9053\u8fd9\u4e2a\u5934\u6587\u4ef6\u5728\u65d7\u4e0b\u4e00\u7ea7 target \u7684 bits \u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u7f29\u5c0f\u8303\u56f4\u901a\u914d\u67e5\u627e\uff1a</p> <pre><code>$ find /usr/include/*/bits -type f -name wordsize.h\n/usr/include/aarch64-linux-gnu/bits/wordsize.h\n</code></pre>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#cheatsheet","title":"cheatsheet","text":"","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#syntax","title":"Syntax","text":"<p>The most common wildcards are <code>*</code>, <code>?</code>, and <code>[\u2026]</code>.</p> Wildcard              Description              Example              Matches              Does not match              <code>*</code> matches any number of any characters including none              <code>Law*</code> <code>Law</code>, <code>Laws</code>, or <code>Lawyer</code> <code>GrokLaw</code>, <code>La</code>, or <code>aw</code> <code>*Law*</code> <code>Law</code>, <code>GrokLaw</code>, or <code>Lawyer</code>.              <code>La</code>, or <code>aw</code> <code>?</code> matches any single character              <code>?at</code> <code>Cat</code>, <code>cat</code>, <code>Bat</code> or <code>bat</code> <code>at</code> <code>[abc]</code> matches one character given in the bracket              <code>[CB]at</code> <code>Cat</code> or <code>Bat</code> <code>cat</code> or <code>bat</code> <code>[a-z]</code> matches one character from the (locale-dependent) range given in the bracket              <code>Letter[0-9]</code> <code>Letter0</code>, <code>Letter1</code>, <code>Letter2</code>                 up to <code>Letter9</code> <code>Letters</code>, <code>Letter</code> or <code>Letter10</code> <p>In all cases the path separator character (<code>/</code> on Unix or <code>\\</code> on Windows) will never be matched.  </p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#unix","title":"UNIX","text":"<p>On Linux and POSIX systems <code>*</code>, <code>?</code> is defined as above while <code>[\u2026]</code> has two additional meanings:</p> Wildcard              Description              Example              Matches              Does not match              <code>[!abc]</code> matches one character that is not given in the bracket              <code>[!C]at</code> <code>Bat</code>, <code>bat</code>, or <code>cat</code> <code>Cat</code> <code>[!a-z]</code> matches one character that is not from the range given in the bracket              <code>Letter[!3-5]</code> <code>Letter1</code>, <code>Letter2</code>, <code>Letter6</code>                 up to <code>Letter9</code> and <code>Letterx</code> etc.              <code>Letter3</code>, <code>Letter4</code>, <code>Letter5</code>                 or <code>Letterxx</code> <p>Some shells (such as the C shell and Bash) support additional syntax known as <code>alternation</code> or <code>brace expansion</code>.</p> <p>The Bash shell also supports Extended Globbing which allows other pattern matching operators to be used to match multiple occurrences of a pattern enclosed in parentheses. It can be enabled by setting the <code>extglob</code> shell option.</p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#globbing_vs_regexp","title":"Globbing vs RegExp","text":"<p>\u901a\u914d\u7b26\u662f\u7528\u6765\u5339\u914d \u6587\u4ef6\u540d \u7684\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u5219\u662f\u7528\u6765\u5339\u914d \u6587\u4ef6\u5185\u5bb9\uff08\u6587\u672c\u5b57\u7b26\u4e32\uff09\u7684\u3002</p> <p>BASH \u6240\u505a\u7684\u662f\u6269\u5c55\u6587\u4ef6\u540d\uff0c\u57fa\u4e8e\u901a\u914d\u7b26\uff08globbing/wildcard patterns\uff09\uff0c\u5e76\u975e\u6b63\u5219\u8868\u8fbe\u5f0f\u3002 \u901a\u914d\u7b26\u591a\u7528\u5728\u6587\u4ef6\u540d\u5339\u914d\u4e0a\uff0c\u6bd4\u5982 <code>ls</code>\u3001<code>find</code>\u3001<code>cp</code>\u3001<code>rm</code> \u7b49\u547d\u4ee4\u53ef\u901a\u914d\u67e5\u627e\u51fa\u7b26\u5408\u5339\u914d\u6761\u4ef6\u7684\u6587\u4ef6\u8fdb\u884c\u64cd\u4f5c\u3002  </p> <p>BASH \u672c\u8eab\u6ca1\u6709\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u529f\u80fd\uff0c\u5728\u811a\u672c\u91cc\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u662f\u547d\u4ee4\uff08grep,sed\uff09\u548c\u5de5\u5177\u5305\uff08awk\uff09\uff0c\u5b83\u4eec\u53ef\u4ee5\u89e3\u6790\u6b63\u5219\u8868\u8fbe\u5f0f\u3002 \u9488\u5bf9\u6587\u4ef6\u5185\u5bb9\u7684\u6587\u672c\u8fc7\u6ee4\u5de5\u5177 <code>grep</code>(-G,-e,-E),<code>awk</code>,<code>sed</code> \u7b49\uff0c\u90fd\u662f\u57fa\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u3002  </p> <p>Wildcards are more limited in what they can pattern, as they have fewer metacharacters and a simple language-base.</p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#equivalence","title":"Equivalence","text":"glob regexp \u8bf4\u660e <code>?</code> <code>.</code> \u9664 <code>\u6362\u884c\u7b26</code> \u4ee5\u5916\u7684\u4efb\u610f\u5355\u5b57\u7b26 <code>*</code> <code>.*</code> \u4efb\u610f\u6570\u91cf\uff080\u6216\u591a\u4e2a\uff09\u7684\u5b57\u7b26 <code>???*</code> <code>.{3,}</code> 3\u6216\u591a\u4e2a\u5b57\u7b26 <code>[:digit:]</code> <code>\\d</code> \u6570\u5b57 <code>[:space:]</code> <code>\\s</code> \u7a7a\u767d <p>\u6700\u4e3b\u8981\u7684\u533a\u522b\u662f\u901a\u914d\u7b26\u662f\u57fa\u4e8e \u4f4d\u7f6e \u5339\u914d\uff0c\u800c\u6b63\u5219\u8868\u8fbe\u5f0f\u662f \u524d\u5411 \u9650\u5b9a\uff08<code>a*</code>\u3001<code>a+</code>\u3001<code>a?</code>\uff09\u3002</p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#ranges_exclude","title":"ranges exclude","text":"<p>Now that regular expressions have bracket expressions where the negation is indicated by a '<code>^</code>', POSIX has declared the effect of a wildcard pattern \"<code>[^...]</code>\" to be undefined.</p> <p>\u901a\u914d\u53ca\u6b63\u5219\u8868\u8fbe\u5f0f\u90fd\u652f\u6301\u5bf9\u5b57\u7b26\u96c6\u8303\u56f4\u7684\u5339\u914d\u548c\u6392\u9664\u5339\u914d\u3002\u8303\u56f4\u5339\u914d\u8868\u8fbe\u5f0f\u90fd\u4e3a <code>[abc]</code> \u683c\u5f0f\uff0c\u4f46\u662f\u6392\u9664\u5339\u914d\u7565\u6709\u4e0d\u540c\u3002</p> <p>\u4f20\u7edf POSIX \u4e2d\u5bf9\u4e8e\u901a\u914d\u5b57\u7b26\u96c6\u6392\u9664\u5339\u914d\u57fa\u4e8e <code>!</code> \u7684 <code>[!abc]</code> \u683c\u5f0f\uff0c\u73b0\u4ee3\u5927\u90e8\u5206\u901a\u914d\u53ca\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\uff0c\u90fd\u652f\u6301 <code>[^abc]</code> \u683c\u5f0f\u6392\u9664\u5339\u914d\u3002</p>","tags":["Globbing"]},{"location":"blog/20191103/Globbing%28Wildcard%29/#references","title":"references","text":"<p>Linux\u547d\u4ee4ls\u901a\u914d\u7b26\u7684\u4f7f\u7528 shell\u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u548c\u901a\u914d\u7b26 @github Linux\u57fa\u7840\u6982\u8981 \u4e4b \u901a\u914d\u7b26 &amp; \u6b63\u5219\u8868\u8fbe\u5f0f \u547d\u4ee4\u884c\u901a\u914d\u7b26\u6559\u7a0b - \u962e\u4e00\u5cf0  </p> <p>python: glob - Filename globbing utility.</p>","tags":["Globbing"]},{"location":"blog/20191103/RegularExpression/","title":"Linux Regular Expression","text":"<p>Linux \u547d\u4ee4\u884c\u4e0b\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f \u2014\u2014 Regular Expression\u3002</p> <p>A regular expression, regex or regexp (sometimes called a rational expression) is, in theoretical computer science and formal language theory, a sequence of characters that define a search pattern. Usually this pattern is then used by string searching algorithms for \"find\" or \"find and replace\" operations on strings, or for input validation.</p> <p>The concept arose in the 1950s when the American mathematician Stephen Cole Kleene formalized the description of a regular language. The concept came into common use with Unix text-processing utilities.</p> <p>Since the 1980s, different syntaxes for writing regular expressions exist, one being the POSIX standard and another, widely used, being the Perl syntax.</p> <p>Regular-Expressions.info - The Premier website about Regular Expressions</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#references","title":"references","text":"<p>\u6b63\u5219\u8868\u8fbe\u5f0f\u53c2\u8003\u624b\u518c - PCRE\u8868\u8fbe\u5f0f\u5168\u96c6@wiki \u6b63\u5219\u8868\u8fbe\u5f0f\u5feb\u901f\u53c2\u8003 \u6b63\u5219\u8868\u8fbe\u5f0f30\u5206\u949f\u5165\u95e8\u6559\u7a0b </p> <p>\u7b2c 19 \u5355\u5143\uff1a\u6b63\u5219\u8868\u8fbe\u5f0f MSDN .NET \u6b63\u5219\u8868\u8fbe\u5f0f \u5feb\u901f\u53c2\u8003 </p> <p>RegEx Reference </p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#perlre","title":"perlre","text":"<p>perlrequick perlre </p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#regexp","title":"RegExp","text":"<p>ecma262 </p> <p>w3: en / zh MDN: en / zh liaoxuefeng / ruanyifeng</p> <p>Using Regular Expressions with JavaScript The Little Guide for Regular Expressions in JS </p> <p>String &amp; RegExp:</p> <ul> <li><code>String.match(regexp)</code>\uff1a\u8fd4\u56de RegExpMatchArray\uff1b  </li> <li><code>String.search(regexp)</code>\uff1a\u8fd4\u56de number \u7c7b\u578b\uff0c\u7b2c\u4e00\u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684\u5339\u914d\u7ed3\u679c\u5728\u6574\u4e2a\u5b57\u7b26\u4e32\u4e2d\u7684\u4f4d\u7f6e\u6216 -1\u3002  </li> <li><code>String.replace(searchValue, replaceValue)</code>\uff1a\u66ff\u6362\u6e90 searchValue \u652f\u6301 RegExp \u8868\u8fbe\u5f0f\uff1b  </li> <li> <p><code>String.split(regexp)</code>\uff1a\u6309\u7167\u6b63\u5219\u89c4\u5219\u5206\u5272\u5b57\u7b26\u4e32\uff0c\u8fd4\u56de\u4e00\u4e2a\u7531\u5206\u5272\u540e\u7684\u5404\u4e2a\u90e8\u5206\u7ec4\u6210\u7684\u5b50\u4e32\u6570\u7ec4\uff08<code>string[]</code>\uff09\uff1b  </p> </li> <li> <p><code>RegExp.test(string)</code>\uff1a\u6d4b\u8bd5\u5b57\u7b26\u4e32\u662f\u5426\u5339\u914d\u6a21\u5f0f\uff1b  </p> </li> <li><code>RegExp.exec(string)</code>\uff1a\u8fd4\u56de RegExpMatchArray\uff1b  </li> </ul>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#expression","title":"expression","text":"<p>\u6709\u4e24\u79cd\u4e66\u5199\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u65b9\u5f0f\uff1a</p> <ol> <li>Literal Expression: <code>let re = /pattern/flags</code>;  </li> <li>Class RegExp: let re = <code>new RegExp('pattern', 'flags')</code>;  </li> </ol> <ul> <li>Use the literal expression when the regular expression is going to be constant, because this way offers the immediate compilation of the regular expression when the script is loaded.  </li> <li>Use the RegExp constructor when the regular expressions is going to change or maybe the user is going to determinate the pattern.  </li> </ul>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#flags","title":"flags","text":"<p><code>/g</code> enables \"global\" matching. </p> <p>Is for global search. Meaning it\u2019ll match all occurrences, not just the first. When using the replace() method, specify this modifier to replace all matches, rather than only the first one.  </p> <p><code>/i</code> makes the regex match case insensitive.  </p> <p><code>/m</code> enables \"multi-line mode\", for multi-line searching.  </p> <p>In this mode, the caret and dollar match before and after newlines in the subject string.  </p> <p><code>y</code>: call Sticky, matches only from the index indicated by the lastIndex property of this regular expression. (not standard yet).  </p> <p>\u6ce8\u610f\uff1a<code>/m</code> \u591a\u884c\u5339\u914d\uff0c\u5c06\u4f1a\u5f71\u54cd <code>^</code> \u548c <code>$</code>\u3002</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#python","title":"python","text":"<p>re - Support for regular expressions (RE).</p> <p>The sequence</p> <pre><code>prog = re.compile(pattern)\nresult = prog.match(string)\n</code></pre> <p>is equivalent to</p> <pre><code>result = re.match(pattern, string)\n</code></pre> <p>\u5e38\u7528 API \u5982\u4e0b\uff1a</p> <p><code>re.search(pattern, string, flags=0)</code>: \u626b\u63cf\u6574\u4e2a\u5b57\u7b26\u4e32\u5e76\u8fd4\u56de \u7b2c\u4e00\u4e2a \u6210\u529f\u7684\u5339\u914d\u3002 <code>re.match(pattern, string, flags=0)</code>: \u5c1d\u8bd5\u4ece\u5b57\u7b26\u4e32\u7684\u8d77\u59cb\u4f4d\u7f6e\u5339\u914d\u4e00\u4e2a\u6a21\u5f0f\uff0c\u5982\u679c\u4e0d\u662f\u8d77\u59cb\u4f4d\u7f6e\u5339\u914d\u6210\u529f\u7684\u8bdd\u5c31\u8fd4\u56de None\u3002 <code>re.fullmatch(pattern, string, flags=0)</code>: \u5339\u914d\u6574\u4e2a\u5b57\u7b26\u4e32\u3002 <code>re.split(pattern, string, maxsplit=0, flags=0)</code>: \u6309\u7167\u80fd\u591f\u5339\u914d\u7684\u5b50\u4e32\u5c06\u5b57\u7b26\u4e32\u5206\u5272\u540e\u8fd4\u56de\u5217\u8868\u3002 <code>re.findall(pattern, string, flags=0)</code>:  \u5728\u5b57\u7b26\u4e32\u4e2d\u627e\u5230\u6b63\u5219\u8868\u8fbe\u5f0f\u6240\u5339\u914d\u7684\u6240\u6709\u5b50\u4e32\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5217\u8868\uff0c\u5982\u679c\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\uff0c\u5219\u8fd4\u56de\u7a7a\u5217\u8868\u3002  </p> <p>\u6ce8\u610f\uff1a match \u548c search \u662f\u5339\u914d \u4e00\u6b21\uff0cfindall \u5219\u662f\u5339\u914d \u6240\u6709\u3002</p> <p>flags \u53ef\u4e3a re.M, re.I, re.S\u3002</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#standards","title":"standards","text":"","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#bre","title":"BRE","text":"<p>\u57fa\u672c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Basic Regular Expressions\uff09\uff0c\u53c8\u53eb Basic RegEx\uff0c\u7b80\u79f0 <code>BRE</code>\u3002</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#ere","title":"ERE","text":"<p>\u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Extended Regular Expressions\uff09\uff0c\u53c8\u53eb Extended RegEx\uff0c\u7b80\u79f0 <code>ERE</code>\u3002</p> <p><code>BRE</code> and <code>ERE</code> work together.</p> <p><code>BRE</code> requires that the metacharacters <code>( )</code> and <code>{ }</code> be designated <code>\\(\\)</code> and <code>\\{\\}</code>, whereas Extended Regular Syntax (<code>ERE</code>) does not. <code>ERE</code> adds <code>?</code>, <code>+</code>, and <code>|</code>, and it removes the need to escape the metacharacters <code>( )</code> and <code>{ }</code>, which are required in <code>BRE</code>.  </p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#perl_and_pcre","title":"Perl and PCRE","text":"<p>https://pcre.org/</p> <p>Perl \u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Perl Regular Expressions\uff09\uff0c\u53c8\u53eb Perl RegEx\uff0c\u7b80\u79f0 <code>PRE</code>\u3002 Perl \u517c\u5bb9\u683c\u5f0f\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Perl Compatible Regular Expressions\uff09\uff0c\u7b80\u79f0 <code>PCRE</code>\u3002  </p> <p>PCRE is a library written in C, which implements a regular expression engine, inspired by the capabilities of the Perl programming language. Philip Hazel started writing PCRE in summer 1997. PCRE's syntax is much more powerful and flexible than either of the POSIX regular expression flavors and than that of many other regular-expression libraries.</p> <p>Because of its expressive power and (relative) ease of reading, many other utilities and programming languages have adopted syntax similar to Perl's\u2014for example, <code>Java</code>, <code>JavaScript</code>, <code>Python</code>, <code>Ruby</code>, <code>Qt</code>, <code>Microsoft's .NET Framework</code>, and <code>XML Schema</code>.</p> <p>A number of prominent open-source programs, such as the Apache and Nginx HTTP Servers, and the PHP and R scripting languages, incorporate the PCRE library; proprietary software can do likewise, as the library is BSD licensed.</p> <p>Perl 5.10 implements syntactic extensions originally developed in PCRE and Python.</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#regex_online","title":"regex online","text":"<p>regexper - railroad regexr </p> <p>w3cschool chinaz / oschina </p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#cheatsheet","title":"cheatsheet","text":"<p>Regular expressions in Perl Tables of Perl Regular Expression (PRX) Metacharacters </p> Character classes .any character except newline \\w \\d \\sword, digit, whitespace \\W \\D \\Snot word, digit, whitespace [abc]any of a, b, or c [^abc]not a, b, or c [a-g]character between a &amp; g Anchors ^abc$start / end of the string \\b \\Bword, not-word boundary Escaped characters \\. \\* \\\\escaped special characters \\t \\n \\rtab, linefeed, carriage return Groups &amp; Lookaround (abc)capture group \\1backreference to group #1 (?:abc)non-capturing group (?=abc)positive lookahead (?!abc)negative lookahead Quantifiers &amp; Alternation a* a+ a?0 or more, 1 or more, 0 or 1 a{5} a{2,}exactly five, two or more a{1,3}between one &amp; three a+? a{2,}?match as few as possible ab|cdmatch ab or cd <p><code>(?:re)</code> \u7c7b\u4f3c <code>(\u2026)</code>\uff0c\u5339\u914d\u90e8\u5206\u533a\u5757\uff0c\u4f46\u662f\u4e0d\u6355\u83b7\u5b58\u50a8\u4e3a\u7ec4\u3002</p> <p>\u4f8b1: <code>industr(?:y|ies)</code>\uff1a\u975e\u6355\u83b7\u5339\u914d industry|industries\u3002 \u4f8b2\uff1a<code>/(?:^)\\d{4}/m</code> \u9876\u683c\u5339\u914d\u4ee5\u56db\u4e2a\u6570\u5b57\u5f00\u5934\u7684\u884c\u3002  </p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#\u5e38\u7528\u9650\u5b9a\u7b26","title":"\u5e38\u7528\u9650\u5b9a\u7b26","text":"\u4ee3\u7801/\u8bed\u6cd5 \u8bf4\u660e ? \u91cd\u590d0\u6b21\u62161\u6b21 + \u91cd\u590d1\u6b21\u6216\u591a\u6b21 * \u91cd\u590d0\u6b21\u6216\u591a\u6b21 {n} \u91cd\u590dn\u6b21 {n,} \u91cd\u590dn\u6b21\u6216\u66f4\u591a\u6b21 {n,m} \u91cd\u590dn\u5230m\u6b21 <p><code>+</code> is equivalent to <code>{1,}</code></p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#\u5e38\u7528\u5143\u5b57\u7b26","title":"\u5e38\u7528\u5143\u5b57\u7b26","text":"\u4ee3\u7801 \u8bf4\u660e . \u5339\u914d\u9664 <code>\u6362\u884c\u7b26</code> \u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 \\w \u5339\u914d <code>\u5b57\u6bcd</code> \u6216 <code>\u6570\u5b57</code> \u6216 <code>\u4e0b\u5212\u7ebf</code>\uff08word\uff09 \\s \u5339\u914d\u4efb\u610f\u7684 <code>\u7a7a\u767d\u7b26</code>\uff08space\uff09 \\d \u5339\u914d <code>\u6570\u5b57</code>\uff08digit\uff09 \\b \u5339\u914d\u5355\u8bcd\u7684 <code>\u5f00\u59cb</code> \u6216 <code>\u7ed3\u675f</code>\uff08word boundary\uff09 ^ \u5339\u914d\u5b57\u7b26\u4e32\u7684 <code>\u5f00\u59cb</code> $ \u5339\u914d\u5b57\u7b26\u4e32\u7684 <code>\u7ed3\u675f</code> <p>To match any character including newline, use a pattern such as <code>[.\\n]</code>.</p> <p>Python \u4e2d\u5bf9\u5e94 flag \u4e3a <code>re.S</code>\u3002</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#\u5e38\u7528\u53cd\u4e49\u8bcd","title":"\u5e38\u7528\u53cd\u4e49\u8bcd","text":"\u4ee3\u7801/\u8bed\u6cd5 \u8bf4\u660e \\W \u5339\u914d\u4efb\u610f \u4e0d\u662f \u5b57\u6bcd\uff0c\u6570\u5b57\uff0c\u4e0b\u5212\u7ebf\uff0c\u6c49\u5b57\u7684\u5b57\u7b26 \\S \u5339\u914d\u4efb\u610f \u4e0d\u662f \u7a7a\u767d\u7b26\u7684\u5b57\u7b26 \\D \u5339\u914d\u4efb\u610f \u975e \u6570\u5b57\u7684\u5b57\u7b26 \\B \u5339\u914d \u4e0d\u662f \u5355\u8bcd\u5f00\u5934\u6216\u7ed3\u675f\u7684\u4f4d\u7f6e [^x] \u5339\u914d\u9664\u4e86 x \u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 [^aeiou] \u5339\u914d\u9664\u4e86 aeiou \u8fd9\u51e0\u4e2a\u5b57\u6bcd\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#vscode_extensions","title":"vscode extensions","text":"<p>vscode 1.29.0 \u57fa\u4e8e ripgrep \u5b9e\u73b0\u652f\u6301 multiline search\u3002</p> <p>vscode \u9ed8\u8ba4\u662f <code>search.useRipgrep</code>\uff08Deprecated\uff09\uff0c\u5efa\u8bae\u91c7\u7528 <code>search.usePCRE2</code>\uff0c\u652f\u6301 lookaround \u548c backreferences \u7b49\u7279\u6027\u3002</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#regex_railroad_diagrams","title":"Regex Railroad Diagrams","text":"<p>Display railroad diagram of regex under cursor.</p> <p>A regular expression railroad diagram view for regular expression under cursor. This is inspired by regex railroad diagrams.</p> <p>\u5149\u6807\u5b9a\u4f4d\u5230 js \u6587\u4ef6\u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08RegExp\uff09\u6240\u5728\u884c\uff0c\u518d\u5728\u63a7\u5236\u9762\u677f\u4e2d\u6267\u884c <code>Show RegExp preview</code> \u547d\u4ee4\uff0c\u5c06\u5728\u53f3\u4fa7\u65b0\u5f00\u8f85\u52a9\u7f16\u8f91\u5668\u663e\u793a <code>RegExp Diagram Preview</code>\u3002</p> <p></p> <p>\u6700\u65b0\u7248 vscode \u4e2d\u4e0d\u53ef\u7528\uff01</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#regexp_preview_and_editor","title":"RegExp Preview and Editor","text":"<p>VSCode extension based on regexper-static. Including regexp expression preivewer and realtime preivew editor.</p> <p>\u5728\u63a7\u5236\u9762\u677f\u4e2d\u6267\u884c <code>RegExp Editor</code>\uff0c\u5c06\u6253\u5f00\u5de6\u4fa7\u7f16\u8f91\u5668\uff0c\u53ef\u5728\u5176\u8f93\u5165\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u53f3\u4fa7\u7684 <code>RegExp Preview</code> \u5c06\u5c55\u5f00\u5176\u5339\u914d\u5206\u89e3\u903b\u8f91\u56fe\u3002</p> <p></p> <p>\u6700\u65b0\u7248 vscode \u4e2d\u4e0d\u53ef\u7528\uff0c\u8003\u8651\u5b89\u88c5 Lulus Young \u6216 LouisWT \u9002\u914d\u7684\u65b0\u7248\u672c\uff01</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#regex_previewer","title":"Regex Previewer","text":"<p>Regex matches previewer for JavaScript, TypeScript, PHP and Haxe in Visual Studio Code.</p> <p>\u65b0\u5efa\u4e00\u4e2a js \u6587\u4ef6\uff0c\u8be5\u63d2\u4ef6\u4f1a\u81ea\u52a8\u68c0\u6d4b\u5176\u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5e76\u5728\u5176\u4e0a\u6d6e\u73b0 <code>Test Regex...</code> \u63d0\u793a\u6761\u3002 \u70b9\u51fb\u6216\u5728\u63a7\u5236\u9762\u677f\u4e2d\u6267\u884c <code>Toggle Regex Preview In Side-By-Side Editors</code> \u547d\u4ee4\u5c06\u5728\u53f3\u4fa7\u5f00\u542f\u6d4b\u8bd5\u7f16\u8f91\u5668\u3002 \u5728\u6d4b\u8bd5\u7f16\u8f91\u5668\u4e2d\u8f93\u5165\u6d4b\u8bd5\u5b57\u7b26\u4e32\uff0c\u518d\u5c06\u5149\u6807\u79fb\u52a8\u5230 js \u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u6240\u5728\u884c\uff0c\u53f3\u4fa7\u5c06\u9ad8\u4eae\u5339\u914d\u7684\u6587\u672c\u3002</p> <p></p> <p><code>/g</code> \u6807\u5fd7\u5339\u914d\u6240\u6709\u884c\uff0c\u672a\u52a0\u5219\u53ea\u5339\u914d\u7b2c\u4e00\u884c\u3002</p>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#filter_line","title":"Filter Line","text":"<ul> <li>By Input String  </li> <li>By Input Regex </li> <li>By Not Contain Input String  </li> <li>By Not Match Input Regex </li> <li>By Config File  </li> </ul>","tags":["regular_expression"]},{"location":"blog/20191103/RegularExpression/#config","title":"config","text":"<p>\u5fc5\u987b\u5728\u5f53\u524d\u6587\u4ef6\u6240\u5728\u6839\u76ee\u5f55\uff08\u5373 vscode \u6253\u5f00\u7684\u6587\u4ef6\u5939\uff09\u4e0b\u521b\u5efa\u8fc7\u6ee4\u914d\u7f6e\u6587\u4ef6\u3002</p> <ol> <li>\u5982\u679c\u6253\u5f00\u7684\u662f\u72ec\u7acb\u6587\u4ef6\uff0c\u4e0d\u662f\u4ee5\u6587\u4ef6\u5939\u6253\u5f00\uff0c\u5219\u63d0\u793a <code>Can not locate workspace folder for current file</code>\uff1b  </li> <li>\u5982\u679c\u662f\u4ee5\u6587\u4ef6\u5939\uff08<code>~/folder</code>\uff09\u6253\u5f00\u6587\u4ef6\uff08<code>~/folder/subfolder/test.log</code>\uff09\uff0c\u6267\u884c <code>Filter Line By Config File</code>\uff0c\u5219\u63d0\u793a <code>Can not locate config file ~/folder/.vscode/filterline.json</code>\u3002  </li> </ol> <p>Config file format type</p> <p>There are 3 format types. As they are so simple, I will not describe them here. Please visit the demo directly :</p> <ol> <li><code>stringlist</code>: String list json or eoml </li> <li><code>regexlist</code>: Regular expressions list json or eoml </li> <li><code>general</code>: This is default if type is not specified. json or eoml </li> </ol>","tags":["regular_expression"]},{"location":"blog/20191102/linux-cmd-grep/","title":"Linux Command - grep","text":"<p>grep \u8fc7\u6ee4\u7b5b\u9009\u51fa\u7b26\u5408\u6761\u4ef6\u7684\u884c\uff0c\u8d77\u6e90\u4e8e vim\uff08ex\uff09\u7f16\u8f91\u5668\u4e2d\u7684\u6a21\u5f0f\u5339\u914d\u547d\u4ee4\uff1a<code>:g/re/p</code>\u3002 grep\u547d\u4ee4\u4f1a\u5728\u8f93\u5165\u6216\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\u67e5\u627e\u5305\u542b\u5339\u914d\u6307\u5b9a\u6a21\u5f0f\u7684\u5b57\u7b26\u7684\u884c\uff0c\u8f93\u51fa\u5c31\u662f\u5305\u542b\u4e86\u5339\u914d\u6a21\u5f0f\u7684\u884c\u3002</p> <p>\u4ee5\u4e0b\u662f\u5404\u5927\u5e73\u53f0\u5bf9 grep \u7684\u5b9a\u4e49\uff1a</p> <ul> <li>unix/POSIX\u3001debian\u3001ubuntu\uff1a<code>grep</code> - search a file for a pattern  </li> <li>FreeBSD/Darwin\uff1a<code>grep</code>, egrep, fgrep, rgrep -- file pattern searcher  </li> <li>macOS\uff1a<code>grep</code>, egrep, fgrep, zgrep, zegrep, zfgrep -- file pattern searcher</li> <li>linux\uff1a<code>grep</code> - print lines that match patterns  </li> </ul> <p>\u6267\u884c <code>grep -V</code> \u67e5\u770b\u7248\u672c\u4fe1\u606f\uff1a</p> <pre><code># macOS\n&gt; grep -V\ngrep (BSD grep) 2.5.1-FreeBSD\n\n# raspberrypi\npi@raspberrypi:~ $ grep -V\ngrep (GNU grep) 2.27\nCopyright (C) 2016 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#man","title":"man","text":"<p>\u4ee5\u4e0b\u662f\u5404\u5927\u5e73\u53f0\u7684 grep \u5728\u7ebf\u624b\u518c\uff1a</p> <ul> <li>unix/POSIX - grep</li> <li> <p>FreeBSD/Darwin - grep </p> </li> <li> <p>linux - grep(1) &amp; grep(1p) </p> </li> <li> <p>debian - grep </p> </li> <li> <p>ubuntu - grep </p> </li> <li> <p>Windows - findstr </p> </li> </ul>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#usage","title":"usage","text":"<p>\u6267\u884c <code>grep --help</code> \u53ef\u67e5\u770b\u7b80\u8981\u5e2e\u52a9\uff08Usage\uff09\u3002  </p> <p>\u6267\u884c <code>man grep</code> \u53ef\u67e5\u770b\u8be6\u7ec6\u5e2e\u52a9\u624b\u518c\uff08Manual Page\uff09\uff1a</p> <pre><code># macOS\n$ man grep\nGREP(1)                   BSD General Commands Manual                  GREP(1)\n\nNAME\n     grep, egrep, fgrep, zgrep, zegrep, zfgrep -- file pattern searcher\n\nSYNOPSIS\n     grep [-abcdDEFGHhIiJLlmnOopqRSsUVvwxZ] [-A num] [-B num] [-C[num]] [-e pattern] [-f file]\n          [--binary-files=value] [--color[=when]] [--colour[=when]] [--context[=num]] [--label]\n          [--line-buffered] [--null] [pattern] [file ...]\n\nDESCRIPTION\n     The grep utility searches any given input files, selecting lines that match one or more patterns.  By\n     default, a pattern matches an input line if the regular expression (RE) in the pattern matches the\n     input line without its trailing newline.  An empty expression matches every line.  Each input line\n     that matches at least one of the patterns is written to the standard output.\n\n     grep is used for simple patterns and basic regular expressions (BREs); egrep can handle extended reg-\n     ular expressions (EREs).  See re_format(7) for more information on regular expressions.  fgrep is\n     quicker than both grep and egrep, but can only handle fixed patterns (i.e. it does not interpret reg-\n     ular expressions).  Patterns may consist of one or more lines, allowing any of the pattern lines to\n     match a portion of the input.\n\n     zgrep, zegrep, and zfgrep act like grep, egrep, and fgrep, respectively, but accept input files com-\n     pressed with the compress(1) or gzip(1) compression utilities.\n</code></pre> <p>\u67e5\u770b\u6b63\u5219\u8868\u8fbe\u5f0f\uff08regex\uff09\u76f8\u5173\u7684\u624b\u518c\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  man 7 re_format\nfaner@MBP-FAN:~|\u21d2  man 3 regex\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#options","title":"options","text":"","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#pattern_syntax","title":"Pattern Syntax","text":"<p>\u4ee5\u4e0b\u4e3a <code>man grep</code> \u4e2d\u7684\u6a21\u5f0f\u8bf4\u660e\uff1a</p> <pre><code>OPTIONS\n\n   Generic Program Information\n       --help Output a usage message and exit.\n\n       -V, --version\n              Output the version number of grep and exit.\n\n   Matcher Selection\n       -E, --extended-regexp\n              Interpret PATTERN as an extended regular expression (ERE, see below).\n\n       -F, --fixed-strings\n              Interpret PATTERN as a list of fixed strings (instead of regular expressions), separated by newlines, any of which is to be matched.\n\n       -G, --basic-regexp\n              Interpret PATTERN as a basic regular expression (BRE, see below).  This is the default.\n\n       -P, --perl-regexp\n              Interpret the pattern as a Perl-compatible regular expression(PCRE).  This is experimental and grep -P may warn of unimplemented features.\n</code></pre> <p><code>grep</code>, <code>egrep</code>, <code>fgrep</code> - print lines matching a pattern</p> <p>the variant programs <code>egrep</code> and <code>fgrep</code> are the same as <code>grep -E</code> and <code>grep -F</code>, respectively. These variants are deprecated, but are provided for backward compatibility.  </p> <p>\u9ed8\u8ba4\u9009\u9879\u662f <code>-G</code>(<code>--basic-regexp</code>)\uff0c\u5373 BRE\u3002 \u5982\u679c\u8981\u652f\u6301 <code>?</code>, <code>+</code> \u548c <code>|</code>\uff0c\u5219\u9700\u8981\u663e\u5f0f\u6307\u5b9a <code>-E</code> \u9009\u9879\uff0c\u5373\u6267\u884c ERE\u3002</p>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#matching_control","title":"Matching Control","text":"<ol> <li><code>-e</code> \u652f\u6301\u8f93\u5165\u591a\u4e2a\u6a21\u5f0f\uff1b  </li> <li><code>-i</code>\uff1a\u652f\u6301\u5ffd\u7565\u5927\u5c0f\u5199\u654f\u611f\uff1b  </li> <li><code>-v</code>\uff1a\u652f\u6301\u8f93\u51fa\u4e0d\u5339\u914d\u7684\u884c\uff1b  </li> </ol> <pre><code>-e pattern, --regexp=pattern\n\n  Specify a pattern used during the search of the input: an input line is selected if it matches\n  any of the specified patterns.  \n  This option is most useful when multiple -e options are used to\n  specify multiple patterns, or when a pattern begins with a dash (`-`).\n\n# \u9ed8\u8ba4\u5927\u5c0f\u5199\u654f\u611f\uff0c\u8be5\u9009\u9879\u652f\u6301\u5ffd\u7565\u5927\u5c0f\u5199\u654f\u611f\n  -i, --ignore-case         ignore case distinctions\n\n# \u5339\u914d\u8865\u96c6\uff0c\u8fc7\u6ee4\u8f93\u51fa\u4e0d\u5305\u542b\u6a21\u5f0f\u7684\u884c\n  -v, --invert-match        select non-matching lines\n\n# \u5339\u914d\u6574\u4e2a\u5355\u8bcd\u3001\u6574\u884c\n  -w, --word-regexp         force PATTERN to match only whole words\n  -x, --line-regexp         force PATTERN to match only whole lines\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#general_output_control","title":"General Output Control","text":"<ol> <li><code>-l</code> \u53ea\u8f93\u51fa\u5339\u914d\u7684\u6587\u4ef6\u540d\uff1b  </li> <li><code>-c</code> \u53ea\u8f93\u51fa\u5339\u914d\u7684\u884c\u6570\uff08\u6761\u76ee\u6570\uff09\uff1b  </li> <li><code>-m</code> \u9650\u5b9a\u6700\u591a\u67e5\u627e\u5339\u914d\u6761\u76ee\u6570\uff1b  </li> <li><code>-q</code> \u9884\u68c0\u5224\u65ad\u662f\u5426\u5b58\u5728\u5339\u914d\u6761\u76ee\uff1b  </li> </ol> <pre><code>Output control:\n# \u53ea\u6253\u5370\u5339\u914d\u7684\u90e8\u5206\uff0c\u800c\u975e\u5339\u914d\u7684\u884c\uff0c\u7528\u7684\u8f83\u5c11\n  -o, --only-matching\n          Prints only the matching part of the lines.\n\n# \u8f93\u51fa\u6587\u4ef6\u540d+\u5339\u914d\u884c\n  -H, Always print filename headers with output lines.\n\n# \u53ea\u5217\u4e3e\uff08\u4e0d\uff09\u6ee1\u8db3\u5339\u914d\u6761\u4ef6\u7684\u6587\u4ef6\u540d\uff0c\u4e0d\u8f93\u51fa\u5177\u4f53\u7684\u5339\u914d\u884c\n  -L, --files-without-match  print only names of FILEs containing no match\n  -l, --files-with-matches  print only names of FILEs containing matches\n\n# \u4ec5\u6253\u5370\u5339\u914d\u7684\u884c\u6570\uff0c\u7528\u4e8e\u7edf\u8ba1\u5339\u914d\u6761\u76ee\u6570\n  -c, --count               print only a count of matching lines per FILE\n\n# \u6700\u591a\u67e5\u627e\u6761\u76ee\uff08\u8fbe\u6807\u505c\u6b62\u67e5\u627e\uff09\uff0c\u4e5f\u53ef\u4ee5 grep | head -n NUM \u622a\u53d6\u53ea\u8f93\u51fa\u524dN\u4e2a\u5339\u914d\u7ed3\u679c\n  -m, --max-count=NUM       stop after NUM matches\n\n# \u4e0d\u5411STDOUT\u8f93\u51fa\u7ed3\u679c\uff0c\u53ea\u8981\u5339\u914d\u5230\u4e86\u4e00\u6761\u5373\u9000\u51fa\uff08\u76f8\u5f53\u4e8e -m 1\uff09\uff0c\u9002\u5408\u53ea\u5224\u65ad\u662f\u5426\u5339\u914d\u800c\u4e0d\u5173\u6ce8\u5177\u4f53\u5339\u914d\u7ed3\u679c\u7684\u573a\u666f\u3002\n## \u4e5f\u53ef\u7528\u4e8e\u5927\u91cf\u67e5\u627e\u7684\u9884\u6d4b\u8bd5\uff0c\u7528 $? \u6765\u5224\u65ad\u5339\u914d\u7ed3\u679c\uff1a0 \u8868\u793a\u6210\u529f\u5339\u914d\uff08\u5230\u4e00\u6761\uff09\uff1b1 \u8868\u793a\u5339\u914d\u5931\u8d25\u3002\n  -q, --quiet, --silent\n          Quiet mode: suppress normal output.  grep will only search a file until a match has been found,\n          making searches potentially less expensive.\n\n# \u5f53\u4f20\u5165\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u4e0d\u5b58\u5728\u65f6\uff0c\u5c4f\u853d\u4e0d\u8f93\u51fa No such file or directory \u7b49\u9519\u8bef\u63d0\u793a\u4fe1\u606f\uff0c\u907f\u514d\u6df9\u6ca1\u67e5\u627e\u7ed3\u679c\u3002\n  -s, --no-messages\n          Silent mode.  Nonexistent and unreadable files are ignored (i.e. their error messages are sup-\n          pressed).\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#context_line_control","title":"Context Line Control","text":"<p>\u6307\u5b9a\u8f93\u51fa\u67e5\u627e\u7ed3\u679c\u4e0a\u4e0b\u6587\u4fe1\u606f\u3002</p> <pre><code># \u987a\u4fbf\u6253\u5370\u67e5\u627e\u7ed3\u679c\u4e0a\u9762 NUM \u884c\n  -B, --before-context=NUM  print NUM lines of leading context\n# \u987a\u4fbf\u6253\u5370\u67e5\u627e\u7ed3\u679c\u4e0b\u9762 NUM \u884c\n  -A, --after-context=NUM   print NUM lines of trailing context\n# \u987a\u4fbf\u6253\u5370\u67e5\u627e\u7ed3\u679c\u4e0a\u9762\u548c\u4e0b\u9762\u5404 NUM \u884c\n  -C, --context=NUM         print NUM lines of output context\n  -NUM                      same as --context=NUM\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#output_line_prefix_control","title":"Output Line Prefix Control","text":"<ol> <li><code>-h</code>\uff1a\u4e0d\u8f93\u51fa\u6587\u4ef6\u540d\uff0c\u53ea\u8f93\u51fa\u5339\u914d\u884c\uff1b  </li> <li><code>-n</code>\uff1a\u6253\u5370\u5339\u914d\u884c\u7684\u884c\u53f7\uff1b  </li> </ol> <pre><code>  -b, --byte-offset         print the byte offset with output lines\n\n# \u9ed8\u8ba4\u4e3a -H\uff0c\u8f93\u51fa\u5339\u914d\u7684\u6587\u4ef6\u540d\u548c\u884c\u4fe1\u606f\uff1b\u6307\u5b9a -h \u5219\u4e0d\u8f93\u51fa\u6587\u4ef6\u540d\uff0c\u53ea\u8f93\u51fa\u5339\u914d\u884c\n  -H      Always print filename headers with output lines.\n  -h, --no-filename\n          Never print filename headers (i.e. filenames) with output lines.\n\n# \u987a\u4fbf\u6253\u5370\u884c\u53f7\n  -n, --line-number         print line number with output lines\n      --line-buffered       flush output on every line\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#file_and_directory_selection","title":"File and Directory Selection","text":"<p><code>-r</code> \u9012\u5f52\u641c\u7d22\u76ee\u5f55\uff0c\u904d\u5386\u67e5\u627e\u6307\u5b9a\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u3002</p> <pre><code># \u9012\u5f52\u904d\u5386\u67e5\u627e\u6307\u5b9a\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\n  -R, -r, --recursive       Recursively search subdirectories listed.\n\n# \u5c06\u4e8c\u8fdb\u5236\u6587\u4ef6\u5f53\u505a\u6587\u672c\u6587\u4ef6\u5904\u7406\n  -a, --text                equivalent to --binary-files=text\n\n# \u5ffd\u7565\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4e0d\u4e88\u67e5\u627e\n  -I      Ignore binary files.  This option is equivalent to --binary-file=without-match option.\n\n# \u9488\u5bf9\u76ee\u5f55\u7684\u884c\u4e3a\uff0c-d recurse \u7b49\u6548\u4e8e -r\n  -d action, --directories=action\n          Specify the demanded action for directories.  It is 'read' by default, which means that the\n          directories are read in the same manner as normal files.  Other possible values are 'skip' to\n          silently ignore the directories, and 'recurse' to read them recursively, which has the same\n          effect as the -R and -r option.\n\n# \u6307\u5b9a\u8981\u641c\u7d22\u7684\u6587\u4ef6\u540d\u79f0\u6a21\u5f0f\uff0c--exclude \u4f18\u5148 --include\n  --include=GLOB\n          If specified, only files matching the given filename pattern are searched.  Note that --exclude\n          patterns take priority over --include patterns.  Patterns are matched to the full path speci-\n          fied, not only to the filename component.\n\n# -R \u9012\u5f52\u6a21\u5f0f\uff0c\u53ea\u5339\u914d\u7b26\u5408\u540d\u79f0\u6a21\u5f0f\u7684\u6587\u4ef6\u5939\uff0c\u8fdb\u5165\u641c\u7d22\u3002linux\u4e0b\u6ca1\u6709\u8be5\u9009\u9879\u3002\n  --include-dir\n          If -R is specified, only directories matching the given filename pattern are searched.  Note\n          that --exclude-dir patterns take priority over --include-dir patterns.\n\n# \u6307\u5b9a\u8981\u6392\u9664\u641c\u7d22\u7684\u6587\u4ef6\u540d\u79f0\u6a21\u5f0f\uff0c--exclude \u4f18\u5148 --include\n  --exclude=GLOB\n          If specified, it excludes files matching the given filename pattern from the search.  Note that\n          --exclude patterns take priority over --include patterns, and if no --include pattern is speci-\n          fied, all files are searched that are not excluded.  Patterns are matched to the full path\n          specified, not only to the filename component.\n\n# -R \u9012\u5f52\u6a21\u5f0f\uff0c\u6392\u9664\u7b26\u5408\u540d\u79f0\u6a21\u5f0f\u7684\u6587\u4ef6\u5939\uff0c\u4e0d\u8fdb\u5165\u641c\u7d22\n  --exclude-dir=GLOB\n          If -R is specified, it excludes directories matching the given filename pattern from the\n          search.  Note that --exclude-dir patterns take priority over --include-dir patterns, and if no\n          --include-dir pattern is specified, all directories are searched that are not excluded.\n\n# \u5173\u4e8e\u7b26\u53f7\u94fe\u63a5\u8f6f\u94fe\u7684\u5904\u7406\n    -p      If -R is specified, no symbolic links are followed.  This is the default.\n    -O      If -R is specified, follow symbolic links only if they were explicitly listed on the command\n            line.  The default is not to follow symbolic links.\n    -S      If -R is specified, all symbolic links are followed.  The default is not to follow symbolic\n            links.\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#examples","title":"Examples","text":"","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#basic","title":"basic","text":"<p>To find all occurrences of the word <code>patricia</code> in a file:</p> <pre><code>$ grep 'patricia' myfile\n</code></pre> <p>To find all occurrences of the pattern <code>.Pp</code> at the beginning of a line:</p> <pre><code>$ grep '^\\.Pp' myfile\n</code></pre> <p>The apostrophes ensure the entire expression is evaluated by grep instead of by the user's shell. The caret <code>^</code> matches the null string at the beginning of a line, and the <code>\\</code> escapes the <code>.</code>, which would otherwise match any character.</p> <p>\u4ece\u6700\u8fd1100\u6761\u65e5\u5fd7\u4e2d\u67e5\u627e fan \u63d0\u4ea4\u7684\u8bb0\u5f55\uff1a</p> <pre><code>svn log -l 100 | grep fan\nsvn log --search fan -l 100\n</code></pre> <p>git-log \u7684 <code>--grep</code> \u9009\u9879\u652f\u6301\u8fc7\u6ee4\u63d0\u4ea4\u65e5\u5fd7\uff1a</p> <pre><code>git log -100 --author=fan --grep='\u6587\u4ef6' --stat\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#ls-grep","title":"ls-grep","text":"<p><code>ls -al | grep '^d'</code>\uff1a\u8fc7\u6ee4\u51fa ls \u7ed3\u679c\u4e2d\u4ee5 d \u5f00\u5934\u7684\uff08\u5373\u6587\u4ef6\u5939\uff09\u3002</p> <p>\u9012\u5f52\u67e5\u627e\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u5305\u542b git \u51b2\u7a81\u8d77\u59cb\u6807\u8bb0\u7684\u6587\u4ef6\uff1a</p> <pre><code>grep -lr '&lt;&lt;&lt;&lt;&lt;&lt;&lt;' .\ngrep -lr '&lt;&lt;&lt;&lt;&lt;&lt;&lt;' . | xargs git checkout --theirs\n</code></pre> <p>\u9012\u5f52\u626b\u63cf\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\uff0c\u6267\u884c file \u547d\u4ee4\u67e5\u770b\u6587\u4ef6\u4fe1\u606f\uff0c\u7136\u540e grep \u8fc7\u6ee4\u51fa\u7f16\u7801\u4e3a ISO-8859 \u7684\u6587\u4ef6\u4e2a\u6570\uff1a</p> <pre><code>find . -type f -exec file {} \\; | grep -c 'ISO-8859'\n15\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#find-grep","title":"find-grep","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u67e5\u627e\u540d\u79f0\u4e3a src \u7684\u5b50\u76ee\u5f55\uff0c\u5e76\u5728\u6240\u6709\u5b50\u76ee\u5f55\u4e0b\uff0c\u6267\u884c grep \u67e5\u627e\u5305\u542b XPTask \u7684\u6587\u4ef6\u3002</p> <pre><code># -r \u9012\u5f52\u67e5\u627e\n# -I \u5ffd\u7565\u4e8c\u8fdb\u5236\u6587\u4ef6\n# -m10 \u53ea\u67e5\u627e\u524d10\u6761\n# --exclude \u6392\u9664\u7279\u6b8a\u540e\u7f00\u7684\u6587\u4ef6\nfind . -type d -name src | xargs grep -rIm10 --exclude=\"*.o\" --exclude=\"*.o.d\" 'XPTask'\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u9012\u5f52\u904d\u5386 nodejs/src \u76ee\u5f55\uff0c\u4f46\u662f\u6392\u9664 dist \u76ee\u5f55\uff0c\u67e5\u627e <code>InquiryEntrance</code>\u3002</p> <p>\u76f8\u5f53\u4e8e vscode \u7b49 IDE \u7f16\u8f91\u5668\u4e2d Search: Find in Files \u5168\u5c40\u67e5\u627e\uff08findInFiles\uff09\u3002</p> <pre><code># -l \u53ea\u8f93\u51fa\u5339\u914d\u7684\u6587\u4ef6\u540d\ngrep -rIl --exclude-dir=dist 'InquiryEntrance' nodejs/src\n# \u8f93\u51fa\u5339\u914d\u7684\u6587\u4ef6\u540d\u548c\u884c\u53ca\u884c\u53f7\ngrep -rIn --exclude-dir=dist 'InquiryEntrance' nodejs/src\n</code></pre> <p>\u5728 Xcode sdk-path \u4e0b\u7684 usr/include \u4e2d\u67e5\u627e\u5b8f <code>WORD_BIT</code> \u548c <code>__WORDSIZE</code> \u5b9a\u4e49\u6240\u5728\u7684\u6587\u4ef6\uff1a</p> <pre><code>$ cd `xcrun --show-sdk-path`\n# grep -R -H \"#define LONG_BIT\" usr/include 2&gt;/dev/null\n$ grep -R -H \"#define WORD_BIT\" usr/include 2&gt;/dev/null\nusr/include/i386/limits.h:#define WORD_BIT        32\nusr/include/arm/limits.h:#define WORD_BIT        32\n\n$ grep -R -l \"#define __WORDSIZE\" usr/include 2&gt;/dev/null\nusr/include/stdint.h:#define __WORDSIZE 64\nusr/include/stdint.h:#define __WORDSIZE 32\n</code></pre> <p>\u5728 rpi4b-ubuntu \u4e0b\u7684 /usr/include \u4e2d\u67e5\u627e\u5b8f <code>WORD_BIT</code> \u548c <code>__WORDSIZE</code> \u5b9a\u4e49\u6240\u5728\u7684\u6587\u4ef6\uff1a</p> <pre><code># -l: \u53ea\u8f93\u51fa\u5339\u914d\u6587\u4ef6\n$ grep -R -l \"#*define WORD_BIT\" /usr/include 2&gt;/dev/null\n\n$ grep -R -l \"#*define __WORDSIZE\" /usr/include 2&gt;/dev/null\n/usr/include/aarch64-linux-gnu/bits/wordsize.h\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#multiple_patterns","title":"multiple patterns","text":"<p>How do I grep for multiple patterns with pattern having a pipe character?</p> <p>\u5305\u542b <code>foo|bar</code>\uff08\u6ce8\u610f\u8fd9\u91cc\u7684 <code>|</code> \u4e3a\u666e\u901a\u5b57\u7b26\uff0c\u975e\u6b63\u5219\u6216\uff09\uff1a</p> <pre><code>grep -- 'foo|bar' *.txt\n</code></pre> <p>\u5982\u679c\u60f3\u6b63\u5219\u8fc7\u6ee4\u5305\u542b <code>foo</code> \u6216 <code>bar</code> \u7684\u884c\uff0c\u5219\u9700\u8981\u8f6c\u4e49\uff1a</p> <pre><code>grep -- 'foo\\|bar' *.txt\n</code></pre> <p>\u4ece myapp.log \u65e5\u5fd7\u4e2d\u8fc7\u6ee4\u5305\u542b <code>start: role</code> \u548c <code>stop: role</code> \u7684\u884c\uff0c\u5e76\u6253\u5370\u884c\u53f7\uff1a</p> <pre><code>grep -n 'start: role\\|stop: role' myapp.log\n</code></pre> <p>\u6216\u8005\u7528 <code>-E</code> \u901a\u8fc7\u6269\u5c55 egrep \u5b9e\u73b0\u6309\u6216\u67e5\u627e\uff0c\u8fd9\u6837\u53ef\u4ee5\u7701\u6389\u8f6c\u4e49\u5b57\u7b26\uff1a</p> <pre><code>grep -E 'foo|bar' # \u7b49\u6548\u4e8e egrep 'foo|bar'\n</code></pre> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u7528 <code>-e</code> \u6307\u5b9a\u591a\u4e2a\u5339\u914d\u6a21\u5f0f\uff1a</p> <pre><code>grep -e 'foo' -e 'bar' myfile\n</code></pre> <p>ls \u9012\u5f52\u5217\u4e3e\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff0c\u7136\u540e\u6309\u7167\u6587\u4ef6\u540d\u5339\u914d\u8fc7\u6ee4\u51fa\u90e8\u5206\u6587\u4ef6\u4e88\u4ee5\u5220\u9664\uff1a</p> <pre><code>rm $(ls -AR | grep -e .DS_Store -e AVEngine.log -e *_WTLOGIN.*.log)\n</code></pre> <p>\u5982\u679c\u60f3\u8fc7\u6ee4\u51fa\u4e0d\u5305\u542b <code>foo</code> \u548c <code>bar</code> \u7684\u884c\uff0c\u53ef\u6307\u5b9a <code>-v</code> \u9009\u9879\u8fdb\u884c\u53cd\u5411\u8fc7\u6ee4\uff1a</p> <pre><code>grep -v -e 'foo' -e 'bar' myfile\n</code></pre> <p>\u4ee5\u4e0b ps \u7ed3\u679c\u7ba1\u4f20\u7ed9 grep\uff0c\u5176\u4e2d\u5305\u542b\u4e86 grep \u8fdb\u7a0b\uff0c\u901a\u8fc7 <code>grep -v 'grep'</code> \u8fc7\u6ee4\u6389 grep \u8fdb\u7a0b\u4fe1\u606f\u3002</p> <pre><code>ps -ef | grep 'nginx:' | grep -v 'grep'\nps aux | grep 'nginx:' | grep -v 'grep'\n# \u6216\u8005\u6dfb\u52a0 -l \u9009\u9879\nps -lef | grep 'nginx:'\n</code></pre>","tags":["grep"]},{"location":"blog/20191102/linux-cmd-grep/#refs","title":"refs","text":"<p>linux\u4e2dgrep\u547d\u4ee4\u7684\u7528\u6cd5</p>","tags":["grep"]},{"location":"blog/20191101/Pipelines/","title":"Linux Pipeline\uff08\u7ba1\u9053\uff09","text":"<p>\u53c2\u8003 BASH(1) manual page \u7684 <code>SHELL GRAMMAR &gt; Pipelines</code> \u90e8\u5206\u3002</p>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#_1","title":"|","text":"<p>A <code>pipeline</code> is a sequence of one or more commands separated by one of the control operators <code>|</code> or <code>|&amp;</code>. The format for a pipeline is:</p> <pre><code>[time [-p]] [ ! ] command [ [|\u23aa|&amp;] command2 ... ]\n</code></pre> <p>The standard output of <code>command</code> is connected via a pipe to the standard input of <code>command2</code>. If <code>|&amp;</code> is used, <code>command</code>'s standard error, in addition to its standard output, is connected to <code>command2</code>'s standard input through the pipe; it is shorthand for <code>2&gt;&amp;1 |</code>.  </p> <p>\u7ba1\u9053\u88ab\u653e\u5728\u547d\u4ee4\u4e4b\u95f4\uff0c\u5c06\u4e00\u4e2a\u547d\u4ee4\u7684\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u53e6\u4e00\u4e2a\u547d\u4ee4\u4e2d\uff1a</p> <pre><code>command1 | command2\n</code></pre> <p>\u4e0d\u8981\u4ee5\u4e3a\u7531\u7ba1\u9053\u4e32\u8d77\u7684\u4e24\u4e2a\u547d\u4ee4\u4f1a\u4f9d\u6b21\u6267\u884c\u3002Linux\u7cfb\u7edf\u5b9e\u9645\u4e0a\u4f1a\u540c\u65f6\u8fd0\u884c\u8fd9\u4e24\u4e2a\u547d\u4ee4\uff0c\u5728\u7cfb\u7edf\u5185\u90e8\u5c06\u5b83\u4eec\u8fde\u63a5\u8d77\u6765\u3002\u5728\u7b2c\u4e00\u4e2a\u547d\u4ee4\u4ea7\u751f\u8f93\u51fa\u7684\u540c\u65f6\uff0c\u8f93\u51fa\u4f1a\u88ab\u7acb\u5373\u9001\u7ed9\u7b2c\u4e8c\u4e2a\u547d\u4ee4\uff0c\u6570\u636e\u4f20\u8f93\u4e0d\u4f1a\u7528\u5230\u4efb\u4f55\u4e2d\u95f4\u6587\u4ef6\u6216\u7f13\u51b2\u533a\u3002</p> <p>\u7ba1\u9053\u5206\u9694\u754c\u5b9a\u7b26\u662f <code>|</code>\uff0c\u9ed8\u8ba4\u53ea\u5c06\u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684stdout\u8f93\u51fa\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u547d\u4ee4\u7684stdin\u8f93\u5165\uff0c\u4e0d\u5305\u62ecstderr\u3002\u91c7\u7528 <code>|&amp;</code> \u7ba1\u4f20\uff0c\u5219\u540c\u65f6\u4f20\u5165\u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684stdout\u548cstderr\u8f93\u51fa\uff0c\u76f8\u5f53\u4e8e <code>2&gt;&amp;1 |</code>\u3002</p> <p>\u5f53\u547d\u4ee4\u8f93\u51fa\u8f83\u591a\u65f6\uff0c\u4e3a\u4e86\u907f\u514d\u6eda\u52a8\u8d85\u51fa\uff0c\u53ef\u4ee5\u5bfc\u5411\u7ed9 more \u6216 less \u7ffb\u9875\u67e5\u770b\uff0c\u4f8b\u5982 <code>ls -al /etc | less</code>\u3002</p> <p>cat\u547d\u4ee4\u4e0d\u4ec5\u53ef\u4ee5\u8bfb\u53d6\u6587\u4ef6\u3001\u62fc\u63a5\u6570\u636e\uff0c\u8fd8\u652f\u6301\u4ece\u6807\u51c6\u8f93\u5165\u4e2d\u8fdb\u884c\u8bfb\u53d6\u3002\u4ee5\u4e0b\u811a\u672c\u5c06ls\u7684\u8f93\u51fa\u4f20\u7ed9 <code>cat -n</code>\uff0c\u540e\u8005\u63a5\u6536stdin\u8f93\u5165\u5e76\u5c06\u5185\u5bb9\u52a0\u4e0a\u884c\u53f7\uff0c\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6out.txt\u3002</p> <pre><code>ls | cat -n &gt; out.txt\n</code></pre> <p>\u7ec8\u7aef\u901a\u8fc7 curl \u4ece github \u4e0b\u8f7d\u5b89\u88c5\u6d41\u884c\u7684 Zsh \u914d\u7f6e Oh My ZSH\uff1a</p> <pre><code># curl\n$ sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"\n## \u6216\u8005\n$ curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | sh -c\n</code></pre> <p>\u4ee5\u4e0b\u811a\u672c\u4e0b\u8f7d Homebrew \u5b89\u88c5\u5305tarball\uff0c\u57fa\u4e8e <code>&amp;&amp;</code> \u9012\u8fdb\u6267\u884c\u521b\u5efa\u76ee\u5f55\u548c\u4e0b\u8f7d\u6587\u4ef6\u3002 \u4e0b\u8f7d\u5b8c\u6210\u540e\uff0c\u5c06\u4e0b\u8f7d\u7684\u538b\u7f29\u5305\uff08\u672c\u5730\u5b58\u50a8\u7684\u6587\u4ef6\u8def\u5f84\uff09\u91cd\u5b9a\u5411\u7ed9 tar \u8fdb\u884c\u89e3\u538b\u3002</p> <pre><code>mkdir homebrew &amp;&amp; curl -L https://github.com/Homebrew/brew/tarball/master | tar xz --strip 1 -C homebrew\n</code></pre> <p>\u4ee5\u4e0b\u662f\u6765\u81ea stackoverflow \u4e0a Amir Mehler \u5bf9\u95ee\u9898 How to read from a file or standard input in Bash \u7684\u56de\u7b54\u3002</p> <pre><code>$ cat reader.sh\n#!/bin/bash\nwhile read line; do\n  echo \"reading: ${line}\"\ndone &lt; /dev/stdin\n\n$ cat writer.sh\n#!/bin/bash\nfor i in {0..5}; do\n  echo \"line ${i}\"\ndone\n</code></pre> <p>\u8be5\u6848\u4f8b\u76f4\u89c2\u9610\u8ff0\u4e86\u7ba1\u9053\u7684\u8fd0\u884c\u673a\u5236\uff1a</p> <pre><code>$ ./writer.sh | ./reader.sh\nreading: line 0\nreading: line 1\nreading: line 2\nreading: line 3\nreading: line 4\nreading: line 5\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#tee","title":"tee","text":"<p>\u5982\u679c\u5bf9stderr\u6216stdout\u8fdb\u884c\u91cd\u5b9a\u5411\uff0c\u88ab\u91cd\u5b9a\u5411\u7684\u6587\u672c\u4f1a\u4f20\u5165\u6587\u4ef6\u3002 \u56e0\u4e3a\u6587\u672c\u5df2\u7ecf\u88ab\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u4e2d\uff0c\u4e5f\u5c31\u6ca1\u5269\u4e0b\u4ec0\u4e48\u4e1c\u897f\u53ef\u4ee5\u901a\u8fc7\u7ba1\u9053\u4f20\u7ed9\u540e\u7eed\u547d\u4ee4\u3002 \u6709\u4e00\u79cd\u65b9\u6cd5\u65e2\u53ef\u4ee5\u5c06\u6570\u636e\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\uff0c\u8fd8\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4efd\u91cd\u5b9a\u5411\u6570\u636e\u7684\u526f\u672c\u4f5c\u4e3a\u540e\u7eed\u547d\u4ee4\u7684stdin\u3002</p> <p>\u53cc\u5411\u91cd\u5b9a\u5411\u547d\u4ee4 <code>tee</code> \u901a\u8fc7\u7ba1\u9053\u8fde\u63a5\u524d\u540e\uff0c\u53ef\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u6807\uff1a<code>command1 | tee FILE | command2</code>\u3002</p> <ol> <li>command1\u7684stdout\u8f93\u51fa\u7ba1\u4f20\u4f5c\u4e3atee\u547d\u4ee4\u7684stdin\u8f93\u5165\uff1b</li> <li>tee\u5c06\u63a5\u6536\u7684\u6570\u636e(stdin\u8f93\u5165)\u91cd\u5b9a\u5411\u5230\u6587\u4ef6FILE\uff0c\u540c\u65f6\u590d\u5236\u4e00\u4efd\u5230stdout\u8f93\u51fa\uff1b</li> <li>tee\u5c06\u4ea7\u751f\u7684stdout\u8f93\u51fa\u518d\u901a\u8fc7\u7ba1\u9053\u4f20\u9012\u7ed9\u540e\u7eed\u547d\u4ee4\uff0ccommand2\u4ee5\u6b64\u4f5c\u4e3astdin\u8f93\u5165\u7ee7\u7eed\u5904\u7406\u3002</li> </ol> <p>tee \u9ed8\u8ba4\u91cd\u5b9a\u5411\u662f <code>&gt;</code> \u4f1a\u6e05\u7a7a\u8986\u5199\u5df2\u6709\u6587\u4ef6\uff0c\u5982\u679c\u4e0d\u60f3\u8986\u5199\u800c\u662f\u8ffd\u52a0\uff0c\u53ef\u4ee5\u6307\u5b9a <code>-a</code> \u7b49\u6548 <code>&gt;&gt;</code>\u3002</p> <p><code>-a</code>: Append the output to the files rather than overwriting(default).</p> <pre><code># \u5c06 ls -l \u7ed3\u679c\u8ffd\u52a0\u5230\u6587\u4ef6\uff0c\u540c\u65f6\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u7528more\u5206\u9875\u663e\u793a\u3002\nfaner@MBP-FAN:~|\u21d2  ls -l / | tee -a ~/homefile | more\n</code></pre> <p>\u6267\u884c <code>shadowsocks.sh</code> \u811a\u672c\u5b89\u88c5 shadowsocks \u65f6\uff0c\u5c06\u6267\u884c\u7684 stdout \u548c stderr \u8f93\u51fa\u65e2\u5728\u63a7\u5236\u53f0\u663e\u793a\uff0c\u540c\u65f6\u5199\u5165\u65e5\u5fd7\u6587\u4ef6 shadowsocks.log\uff0c\u65b9\u4fbf\u540e\u7eed\u56de\u770b\u3002</p> <pre><code>./shadowsocks.sh |&amp; tee shadowsocks.log # or\n./shadowsocks.sh 2&gt;&amp;1 | tee shadowsocks.log\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#wcsortuniq","title":"wc,sort,uniq","text":"","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#wc","title":"wc","text":"<p>wc - print newline, word, and byte counts for each file</p> <pre><code>-c, --bytes\n      print the byte counts\n\n-m, --chars\n      print the character counts\n\n-w, --words\n      print the word counts\n\n-l, --lines\n      print the newline counts\n</code></pre> <p>\u7edf\u8ba1 Podfile \u6587\u4ef6\u7684\u884c\u6570\uff1a</p> <pre><code>$ wc -l Podfile\n     879 Podfile\n</code></pre> <p>\u7edf\u8ba1 Podfile \u6587\u4ef6\u7684\u884c\u6570\u548c\u5b57\u8282\u6570\uff1a</p> <pre><code>$ wc -lc Podfile\n     879   38508 Podfile\n</code></pre> <p>how count all lines in all files in current dir and omit empty lines with wc, grep, cut and bc commands</p> <pre><code>echo `wc -l * | grep total | cut -f2 -d\u2019 \u2018` \u2013 `grep -in \u201c^$\u201d * | wc -l ` | bc\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#sort","title":"sort","text":"<p>sort - sort lines of text files</p>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#uniq","title":"uniq","text":"<p>uniq - report or omit repeated lines</p> <p>\u7edf\u8ba1 <code>mars/mars/stn/src</code> \u76ee\u5f55\u4e0b\u7c7b\u6570\uff08\u540c\u540d\u7684 h/cc\uff09</p> <pre><code>faner@MBP-FAN:~/Projects/git/framework/mars/mars/stn/src|master\u26a1 \n\u21d2  ls | cut -d '.' -f 1 | uniq -c\n   2 anti_avalanche\n   2 dynamic_timeout\n   2 flow_limit\n   2 frequency_limit\n   2 longlink\n   2 longlink_connect_monitor\n   2 longlink_identify_checker\n   2 longlink_speed_test\n   2 longlink_task_manager\n   2 net_channel_factory\n   2 net_check_logic\n   2 net_core\n   2 net_source\n   2 netsource_timercheck\n   2 proxy_test\n   2 shortlink\n   1 shortlink_interface\n   2 shortlink_task_manager\n   2 signalling_keeper\n   2 simple_ipport_sort\n   2 smart_heartbeat\n   1 special_ini\n   1 task_profile\n   2 timing_sync\n   2 zombie_task_manager\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#cut","title":"cut","text":"<p><code>cut</code> \u547d\u4ee4\u53ef\u57fa\u4e8e\u7d22\u5f15\u6216\u5206\u9694\u7b26\uff08separator/delimiter\uff09\u5c06\u6587\u4ef6\u6216stdin\u6587\u672c\u884c\u5185\u6570\u636e\u8fdb\u884c\u5207\u5272\u63d0\u53d6\uff0c\u83b7\u53d6\u6240\u9700\u7684\u4fe1\u606f\u57df\u3002</p> <p>\u5728 macOS \u7ec8\u7aef\u6267\u884c cut \u5c06\u663e\u793a usage \u7b80\u8981\u8bf4\u660e\uff0c\u6267\u884c <code>man cut</code> \u53ef\u67e5\u770b\u8be6\u7ec6\u5e2e\u52a9\u624b\u518c\uff08Manual Page\uff09\uff1a</p> <pre><code>faner@MBP-FAN $ man cut\nCUT(1)                    BSD General Commands Manual                   CUT(1)\n\nNAME\n     cut -- cut out selected portions of each line of a file\n\nSYNOPSIS\n     cut -b list [-n] [file ...]\n     cut -c list [file ...]\n     cut -f list [-d delim] [-s] [file ...]\n\nDESCRIPTION\n     The cut utility cuts out selected portions of each line (as specified by list) from each file and\n     writes them to the standard output.  If no file arguments are specified, or a file argument is a single\n     dash (`-'), cut reads from the standard input.  The items specified by list can be in terms of column\n     position or in terms of fields delimited by a special character.  Column numbering starts from 1.\n\n     The list option argument is a comma or whitespace separated set of numbers and/or number ranges.  Num-\n     ber ranges consist of a number, a dash (`-'), and a second number and select the fields or columns from\n     the first number to the second, inclusive.  Numbers or number ranges may be preceded by a dash, which\n     selects all fields or columns from 1 to the last number.  Numbers or number ranges may be followed by a\n     dash, which selects all fields or columns from the last number to the end of the line.  Numbers and\n     number ranges may be repeated, overlapping, and in any order.  If a field or column is specified multi-\n     ple times, it will appear only once in the output.  It is not an error to select fields or columns not\n     present in the input line.\n\n     The options are as follows:\n\n     -b list\n             The list specifies byte positions.\n\n     -c list\n             The list specifies character positions.\n\n     -d delim\n             Use delim as the field delimiter character instead of the tab character.\n\n     -f list\n             The list specifies fields, separated in the input by the field delimiter character (see the -d\n             option.)  Output fields are separated by a single occurrence of the field delimiter character.\n\n     -n      Do not split multi-byte characters.  Characters will only be output if at least one byte is\n             selected, and, after a prefix of zero or more unselected bytes, the rest of the bytes that form\n             the character are selected.\n\n     -s      Suppress lines with no field delimiter characters.  Unless specified, lines with no delimiters\n             are passed through unmodified.\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#bytes","title":"bytes","text":"<p><code>-b</code>, --bytes=LIST\uff1aselect only these bytes\uff0c\u6309\u4e8c\u8fdb\u5236\u89e3\u6790\u5904\u7406\uff0c\u63d0\u53d6\u6307\u5b9a\u7d22\u5f15\u7684\u5b57\u8282\u3002</p> <pre><code># \u63d0\u53d6\u7b2c4\u4e2a\u5b57\u8282\nfaner@MBP-FAN $ echo \"/usr/local/bin\" | cut -b 4\nr\n# \u63d0\u53d6\u5f00\u5934\uff08\u7b2c1\u4e2a\uff09\u81f3\u7b2c4\u4e2a\u5b57\u8282\nfaner@MBP-FAN $ echo \"/usr/local/bin\" | cut -b -4\n/usr\n# \u63d0\u53d6\u7b2c2\u4e2a\u3001\u7b2c6\u4e2a\u8fd9\u4e24\u4e2a\u5b57\u8282\nfaner@MBP-FAN $ echo \"/usr/local/bin\" | cut -b 2,6\nul\n# \u63d0\u53d6\u7b2c6\u4e2a\u81f3\u672b\u5c3e\u7684\u5b57\u8282\nfaner@MBP-FAN $ echo \"/usr/local/bin\" | cut -b 6-\nlocal/bin\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#characters","title":"characters","text":"<p>\u5bf9\u4e8e\u82f1\u8bed ASCII \u7801\uff0c\u4e00\u4e2a\u5b57\u7b26\u5360\u4e00\u4e2a\u5b57\u8282\uff0c\u5bf9\u4e8e CJK \u7b49\u591a\u5b57\u7b26\u96c6\uff0c\u4e00\u4e2a\u5b57\u7b26\u7684Unicode\u7f16\u7801\u5360\u75282~4\u4e2a\u5b57\u8282\u3002 \u5982\u679c\u4ee5\u53ef\u89c6\u5b57\u7b26\u4f5c\u4e3a\u7d22\u5f15\u5b9a\u4f4d\uff0c\u5219\u9700\u8981\u6539\u7528 <code>-c</code> \u9009\u9879\u3002</p> <p><code>-c</code>, --characters=LIST\uff1aselect only these characters</p> <p>\u5bf9\u4e8e\u6df7\u5408\u4e86\u5b57\u6bcd\u548c\u6c49\u5b57\u7684\u5b57\u7b26\u4e32 <code>w\u6211m\u4eecd\u7684a\u7231</code>\uff0c\u5f53\u5176\u6309\u7167 <code>-b</code> \u7d22\u5f15\u65f6\uff0c\u7b2c\u4e8c\u4e2a<code>\u6211</code>\u5b57\u5360\u636e\u7b2c2~4\u4e2a\u5b57\u8282\u4f4d\u7f6e\u3002</p> <pre><code>faner@MBP-FAN $ echo \"w\u6211m\u4eecd\u7684a\u7231\" | cut -b 1\nw\nfaner@MBP-FAN $ echo \"w\u6211m\u4eecd\u7684a\u7231\" | cut -b 2\n\ufffd\nfaner@MBP-FAN $ echo \"w\u6211m\u4eecd\u7684a\u7231\" | cut -b 2,3\n\ufffd\nfaner@MBP-FAN $ echo \"w\u6211m\u4eecd\u7684a\u7231\" | cut -b 2,3,4\n\u6211\nfaner@MBP-FAN $ echo \"w\u6211m\u4eecd\u7684a\u7231\" | cut -b 2,3,4,5\n\u6211m\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7 <code>hexdump</code> \u6216 <code>od</code> \u67e5\u770b\u5176\u4e8c\u8fdb\u5236\u7f16\u7801\uff0c\u53ef\u89c1\u8fd9\u51e0\u4e2a\u6c49\u5b57\u6bcf\u4e2a\u5360\u636e3\u4e2a\u5b57\u8282\u3002</p> <pre><code>faner@MBP-FAN $ echo \"w\u6211m\u4eecd\u7684a\u7231\" | hexdump -C\n00000000  77 e6 88 91 6d e4 bb ac  64 e7 9a 84 61 e7 88 b1  |w...m...d...a...|\n00000010  0a                                                |.|\n00000011\nfaner@MBP-FAN $ echo \"w\u6211m\u4eecd\u7684a\u7231\" | od -N 18 -A x -t xCa\n0000000    77  e6  88  91  6d  e4  bb  ac  64  e7  9a  84  61  e7  88  b1\n           w   \ufffd  88  91   m   \ufffd   \ufffd   \ufffd   d   \ufffd  9a  84   a   \ufffd  88   \ufffd\n0000010    0a\n          nl\n0000011\n</code></pre> <p>\u901a\u5e38\uff0c\u4f7f\u7528 <code>-c</code> \u9009\u9879\uff0c\u6309\u7167\u53ef\u89c6\u5b57\u7b26\u5b9a\u4f4d\u63d0\u53d6\u7684\u573a\u666f\u66f4\u591a\u4e00\u70b9\u3002</p> <pre><code># \u63d0\u53d6\u7b2c2\u4e2a\u5b57\u7b26\nfaner@MBP-FAN $ echo \"w\u6211m\u4eecd\u7684a\u7231\" | cut -c 2\n\u6211\n# \u63d0\u53d6\u7b2c2\u4e2a\u548c\u7b2c3\u4e2a\u5b57\u7b26\nfaner@MBP-FAN $ echo \"w\u6211m\u4eecd\u7684a\u7231\" | cut -c 2,3\n\u6211m\n</code></pre> <p>export \u58f0\u660e\u53d8\u91cf\u6392\u5217\u6574\u9f50\uff0c\u53ef\u636e\u6b64\u4ee5\u5b57\u7b26\u4e3a\u5355\u4f4d\u63d0\u53d6\u56fa\u5b9a\u5b57\u7b26\u4f4d\u7f6e\u533a\u95f4\uff1a</p> <pre><code># \u83b7\u53d6 export \u524d4\u6761\npi@raspberrypi:~ $ export | head -n 4\ndeclare -x DBUS_SESSION_BUS_ADDRESS=\"unix:path=/run/user/1000/bus\"\ndeclare -x HOME=\"/home/pi\"\ndeclare -x INFINALITY_FT_AUTOHINT_HORIZONTAL_STEM_DARKEN_STRENGTH=\"10\"\ndeclare -x INFINALITY_FT_AUTOHINT_INCREASE_GLYPH_HEIGHTS=\"true\"\n\n# \u63d0\u53d612\u4e2a\u5b57\u7b26\u53ca\u5176\u540e\u7684\u90e8\u5206\uff08\u79fb\u9664\u884c\u9996\u768411\u4e2a\u5b57\u7b26(declare -x )\uff09\n## 12\u4e3a\u8d77\u59cb\u4f4d\u7f6e\uff0c-\u540e\u9762\u672a\u6307\u5b9a\u7ed3\u675f\u4f4d\u7f6e\uff0c\u8868\u793a\u81f3\u884c\u5c3e\npi@raspberrypi:~ $ export | head -n 4 | cut -c 12-\nDBUS_SESSION_BUS_ADDRESS=\"unix:path=/run/user/1000/bus\"\nHOME=\"/home/pi\"\nINFINALITY_FT_AUTOHINT_HORIZONTAL_STEM_DARKEN_STRENGTH=\"10\"\nINFINALITY_FT_AUTOHINT_INCREASE_GLYPH_HEIGHTS=\"true\"\n</code></pre> <p>\u5176\u4ed6\u50cf ps\u3001last \u7b49\u547d\u4ee4\u8f93\u51fa\u90fd\u7531\u7a7a\u767d\uff08\u7a7a\u683c\u6216tab \u5236\u8868\u7b26\uff09\u63a7\u5236\u6392\u7248\u683c\u5f0f\uff0c\u8fde\u7eed\u7a7a\u767d\u8f83\u96be\u5408\u9002\u5206\u5272\u3002</p> <p>\u4ee5\u4e0b\u6765\u81ea manpage \u7684\u793a\u4f8b\uff0c\u76f8\u5f53\u4e8e\u63d0\u53d6\u4e24\u4e2arange\u7684\u5b50\u4e32\uff1a</p> <pre><code># Show the names and login times of the currently logged in users:\nfaner@MBP-FAN $ who | cut -c 1-16,26-38\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#delimiter","title":"delimiter","text":"<p>\u9664\u4e86 <code>-b</code>\u3001<code>-c</code> \u6309\u7167\u5b57\u8282\u3001\u5b57\u7b26\u7d22\u5f15\u63d0\u53d6\u6587\u672c\u884c\uff0c\u8fd8\u6709\u4e00\u4e2a\u66f4\u5e38\u7528\u7684 <code>-d</code> \u652f\u6301\u6309\u5206\u5272\u7b26\u63d0\u53d6\u57df\u3002</p> <p><code>-d</code>, --delimiter=DELIM\uff1ause DELIM instead of TAB for field delimiter</p> <p>\u4e00\u822c\u4f7f\u7528 <code>-d</code> \u6307\u5b9a DELIM \u5bf9\u6587\u672c\u884c\u8fdb\u884c\u5206\u5272\u540e\uff0c\u5f80\u5f80\u642d\u914d\u4f7f\u7528 <code>-f</code> \u9009\u9879\u63d0\u53d6\u6307\u5b9a\u7d22\u5f15\u57df\u3002</p> <p><code>-f</code>, --fields=LIST\uff1aselect only these fields; also print any line that contains no delimiter character, unless the -s option is specified</p> <p><code>cut -d</code> \u53ef\u66ff\u4ee3 awk \u9002\u7528\u4e00\u4e9b\u7b80\u5355\u7684\u5207\u5272\u63d0\u53d6\u573a\u666f\uff0c<code>-d</code> \u9009\u9879\u76f8\u5f53\u4e8e awk \u7684 <code>-F</code>\uff08<code>FS</code>\uff09\uff0c<code>-f</code> \u5219\u76f8\u5f53\u4e8e <code>$NF</code> \u5f15\u7528\u53d6\u57df\u3002</p> <p>\u63d0\u53d6 /etc/passwd \u6587\u4ef6\u4e2d\u6587\u672c\u884c\u7b2c1\u4e2a\u57df\u548c\u7b2c7\u4e2a\u57df\uff1a</p> <pre><code>faner@MBP-FAN $ echo \"nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false\" | cut -d : -f 1,7\nnobody:/usr/bin/false\n\n# \u5bf9\u6574\u4e2a\u6587\u4ef6\u6587\u672c\u884c\u8fdb\u884c\u63d0\u53d6\u57df1\u548c\u57df7\n# Extract users' login names and shells from the system passwd(5) file as ``name:shell'' pairs:\nfaner@MBP-FAN $ cut -d : -f 1,7 /etc/passwd | head -20\n</code></pre> <p>PATH \u73af\u5883\u53d8\u91cf\u662f\u4ee5 <code>:</code> \u5206\u9694\u591a\u4e2a\u8def\u5f84\uff0c\u53ef\u4ee5\u4f7f\u7528 cut \u547d\u4ee4\u63d0\u53d6\u5176\u4e2d\u90e8\u5206\u8def\u5f84\u3002</p> <pre><code>faner@MBP-FAN $ echo $PATH\n/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin\nfaner@MBP-FAN $ echo $PATH | cut -d ':' -f 3\n/bin\nfaner@MBP-FAN $ echo $PATH | cut -d ':' -f 5\n/sbin\nfaner@MBP-FAN $ echo $PATH | cut -d ':' -f 3,5\n/bin:/sbin\n</code></pre> <p>\u4e0d\u5c0f\u5fc3\u5411 PATH \u91cd\u590d\u8ffd\u52a0\u4e86 <code>/usr/local/sbin</code>\uff1a</p> <pre><code>pi@raspberrypi:~ $ echo $PATH\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games\npi@raspberrypi:~ $ PATH=$PATH:/usr/local/sbin\npi@raspberrypi:~ $ echo $PATH \n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games:/usr/local/sbin\n</code></pre> <p>\u5982\u4f55\u5220\u9664\u521a\u624d\u8ffd\u52a0\u91cd\u590d\u7684 <code>/usr/local/sbin</code>\uff1f</p> <p>\u76f4\u63a5 <code>PATH=</code> \u8d4b\u503c\u4fee\u6539\u524d\u7684\u503c <code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games</code>\u3002</p> <p>\u6267\u884c <code>PATH=$(echo $PATH | cut -d : -f 1,3-)</code> \u53ef\u79fb\u9664\u7b2c2\u9879\u3002</p>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#tr","title":"tr","text":"<p><code>tr</code>\uff08translate\uff09\u547d\u4ee4\u652f\u6301\u5bf9\u6807\u51c6\u8f93\u5165\u8fdb\u884c\u66ff\u6362\u6216\u5220\u9664\uff0c\u4e00\u822c\u7528\u4e8e\u5220\u9664\u6587\u4ef6\u4e2d\u7684\u63a7\u5236\u5b57\u7b26\u6216\u8fdb\u884c\u5b57\u7b26\u8f6c\u6362\u3002</p> <p>tr\u53ea\u80fd\u901a\u8fc7stdin\uff0c\u800c\u65e0\u6cd5\u901a\u8fc7\u547d\u4ee4\u884c\u53c2\u6570\u6765\u63a5\u53d7\u8f93\u5165\uff0c\u5b83\u7684\u8c03\u7528\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>tr [options] set1 set2\n</code></pre> <p>\u5c06\u6765\u81eastdin\u7684\u8f93\u5165\u5b57\u7b26\u4eceset1\u6620\u5c04\u5230set2\uff0c\u7136\u540e\u5c06\u8f93\u51fa\u5199\u5165stdout\u3002 \u5176\u4e2dset1\u548cset2\u662f\u5b57\u7b26\u7c7b\u6216\u5b57\u7b26\u96c6\uff0cset1\u7528\u4e8e\u67e5\u8be2\uff0cset2\u7528\u4e8e\u8f6c\u6362\u3002</p> <ul> <li>\u5982\u679c\u4e24\u4e2a\u5b57\u7b26\u96c6\u7684\u957f\u5ea6\u4e0d\u76f8\u7b49\uff0c\u90a3\u4e48set2\u4f1a\u4e0d\u65ad\u91cd\u590d\u5176\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\uff0c\u76f4\u5230\u957f\u5ea6\u4e0eset1\u76f8\u540c\u3002</li> <li>\u5982\u679cset2\u7684\u957f\u5ea6\u5927\u4e8eset1\uff0c\u90a3\u4e48\u5728set2\u4e2d\u8d85\u51faset1\u957f\u5ea6\u7684\u90a3\u90e8\u5206\u5b57\u7b26\u5219\u5168\u90e8\u88ab\u5ffd\u7565\u3002</li> </ul> <p>\u5728 macOS \u7ec8\u7aef\u6267\u884c <code>man tr</code> \u53ef\u67e5\u770b\u8be6\u7ec6\u5e2e\u52a9\u624b\u518c\uff08Manual Page\uff09\uff1a</p> <pre><code>faner@MBP-FAN $ man tr\nTR(1)                     BSD General Commands Manual                    TR(1)\n\nNAME\n     tr -- translate characters\n\nSYNOPSIS\n     tr [-Ccsu] string1 string2\n     tr [-Ccu] -d string1\n     tr [-Ccu] -s string1\n     tr [-Ccu] -ds string1 string2\n\nDESCRIPTION\n     The tr utility copies the standard input to the standard output with substitution or deletion of\n     selected characters.\n\n     The following options are available:\n\n     -C      Complement the set of characters in string1, that is ``-C ab'' includes every character except\n             for `a' and `b'.\n\n     -c      Same as -C but complement the set of values in string1.\n\n     -d      Delete characters in string1 from the input.\n\n     -s      Squeeze multiple occurrences of the characters listed in the last operand (either string1 or\n             string2) in the input into a single instance of the character.  This occurs after all deletion\n             and translation is completed.\n\n     -u      Guarantee that any output is unbuffered.\n</code></pre> <ul> <li><code>-c</code>, -C, --complement: use the complement of SET1. \u53cd\u9009\u8bbe\u5b9a\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u7b26\u5408 SET1 \u7684\u90e8\u4efd\u4e0d\u505a\u5904\u7406\uff0c\u4e0d\u7b26\u5408\u7684\u5269\u4f59\u90e8\u4efd\u624d\u8fdb\u884c\u8f6c\u6362\u3002</li> <li><code>-d</code>, --delete: delete characters in SET1, do not translate. \u5220\u9664\u6307\u4ee4\u5b57\u7b26\u3002  </li> <li><code>-s</code>, --squeeze-repeats: replace  each  sequence of a repeated character that is listed in the last specified SET, with a single occurrence of that character. \u7f29\u51cf\u8fde\u7eed\u91cd\u590d\u7684\u5b57\u7b26\u6210\u6307\u5b9a\u7684\u5355\u4e2a\u5b57\u7b26\u3002  </li> </ul>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#substite","title":"substite","text":"<p>\u6ca1\u6709\u6307\u5b9a\u4efb\u4f55\u9009\u9879\u65f6\uff0c\u4e00\u822c\u8868\u793a\u66ff\u6362string1\u4e2d\u7684\u5b57\u7b26\u5e8f\u5217\u4e3astring2\u4e2d\u7684\u5b57\u7b26\uff08\u5e8f\u5217\uff09\u3002</p> <p>\u6700\u5178\u578b\u5730\u5e94\u7528\u662f\u5927\u5c0f\u5199\u8f6c\u6362\uff1a</p> <ul> <li>convert to Uppercase in shell </li> <li>Changing to Uppercase or Lowercase </li> <li>Shell Scripting: Convert Uppercase to Lowercase </li> </ul> <pre><code># \u5c06\u6587\u4ef6 testfile \u4e2d\u7684\u5927\u5199\u5b57\u6bcd\u5168\u90e8\u8f6c\u6362\u4e3a\u5c0f\u5199\nfaner@MBP-FAN $ cat testfile | tr A-Z a-z\n\n# \u5c06\u5c0f\u5199\u5b57\u6bcd\u5168\u90e8\u8f6c\u6362\u4e3a\u5927\u5199\u5b57\u6bcd\n# \u7b49\u6548\u5b9e\u73b0\uff1aawk 'BEGIN { getline; print toupper($0) }'\nfaner@MBP-FAN $ echo \"dos2unix\" | tr '[:lower:]' '[:upper:]'\nDOS2UNIX\n</code></pre> <p>\u4ee5\u4e0b\u4e3a manpage \u4e2d\u7684\u793a\u4f8b\uff0c\u5c06\u542b\u9644\u52a0\u6807\u53f7\u7684\u82f1\u6587\u5b57\u6bcd\uff08\u53c2\u8003 Diacritic\uff09\u66ff\u6362\u4e3a\u666e\u901a\u5b57\u6bcd\u3002</p> <ul> <li>\u62c9\u4e01\u6587\u4e2d\u7684\u5b57\u6bcd\uff1a\u00f9\u00fa\u00fb\u00fc  </li> <li>\u6c49\u8bed\u62fc\u97f3\u5b57\u6bcd\uff1a\u016b\u00fa\u01d4\u00f9\u01d6\u01d8\u01da\u01dc\u00fc  </li> </ul> <pre><code># \u5c06\u62c9\u4e01\u5b57\u6bcd\u4e2d\u7684\u53d8\u79cdu\u66ff\u6362\u4e3a\u666e\u901au\nfaner@MBP-FAN $ tr \"[=u=]\" \"u\" &lt;&lt;&lt; \u00f9\u00fa\u00fb\u00fc\nuuuu\n# \u79fb\u9664\u5b57\u6bcde\u7684\u53d8\u79cd\u6807\u53f7\uff0c\u66ff\u6362\u4e3a\u666e\u901ae\nfaner@MBP-FAN $ tr \"[=e=]\" \"e\" &lt;&lt;&lt; \"h\u00ebh\u00eb, h\u0113cha, h\u00e9liu, \u00eaxin, h\u00e8ka, \u0119\u011b\"\nhehe, h\u0113cha, heliu, exin, heka, \u0119\u011b\n# \u5c06\u6587\u4ef6file1\u4e2d\u7684\u53d8\u79cde\u666e\u901a\u5316\u540e\u4fdd\u5b58\u5230file2\nfaner@MBP-FAN $ tr \"[=e=]\" \"[e*]\" &lt;file1 &gt;file2\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u5c06\u6587\u4ef61\u4e2d\u7684\u5927\u62ec\u53f7\u66ff\u6362\u4e3a\u5c0f\u62ec\u53f7\uff0c\u7136\u540e\u4fdd\u5b58\u8f93\u51fa\u5230 file2\u3002</p> <p>\u6ce8\u610f\u8fd9\u91cc\u5de6\u53f3\u62ec\u53f7\u7684\u5bf9\u5e94\u66ff\u6362\u987a\u5e8f\u3002</p> <pre><code>faner@MBP-FAN $ tr '{}' '()' &lt; file1 &gt; file2\n</code></pre> <p>\u901a\u8fc7\u5728tr\u4e2d\u4f7f\u7528\u96c6\u5408\u7684\u6982\u5ff5\uff0c\u53ef\u4ee5\u8f7b\u677e\u5730\u5c06\u5b57\u7b26\u4ece\u4e00\u4e2a\u96c6\u5408\u6620\u5c04\u5230\u53e6\u4e00\u4e2a\u96c6\u5408\u4e2d\u3002 \u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528tr\u5b8c\u6210\u7b80\u5355\u5730\u52a0\u89e3\u5bc6\uff1aset1 \u4e2d\u7684 12345 \u57fa\u4e8e\u7d22\u5f15\u4f4d\u7f6e\u5c06\u6620\u5c04\u4e3a set2 \u4e2d\u7684 87654\uff0c\u53cd\u4e4b\u89e3\u5bc6\u3002</p> <pre><code># \u52a0\u5bc6\n$ echo 12345 | tr '0-9' '9876543210'\n87654\n# \u89e3\u5bc6\n$ echo 87654 | tr '9876543210' '0-9'\n12345\n</code></pre> <p>ROT13\u662f\u4e00\u4e2a\u8457\u540d\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u5b83\u6309\u7167\u5b57\u6bcd\u8868\u6392\u5217\u987a\u5e8f\u6267\u884c13\u4e2a\u5b57\u6bcd\u8f6c\u6362\u3002 \u5728ROT13\u7b97\u6cd5\u4e2d\uff0c\u6587\u672c\u52a0\u5bc6\u548c\u89e3\u5bc6\u90fd\u4f7f\u7528\u540c\u4e00\u4e2a\u51fd\u6570\u3002 \u4e0b\u9762\u7528tr\u8fdb\u884cROT13\u52a0\u5bc6\uff1a</p> <pre><code>$ echo \"tr came, tr saw, tr conquered.\" | tr 'a-zA-Z' 'n-za-mN-ZA-M'\nge pnzr, ge fnj, ge pbadhrerq.\n</code></pre> <p>\u5bf9\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\u518d\u6b21\u4f7f\u7528\u540c\u6837\u7684ROT13\u51fd\u6570\u5373\u53ef\u8fdb\u884c\u89e3\u5bc6\uff1a</p> <pre><code>$ echo ge pnzr, ge fnj, ge pbadhrerq. | tr 'a-zA-Z' 'n-za-mN-ZA-M'\ntr came, tr saw, tr conquered.\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#squeeze","title":"Squeeze","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\u5c06\u5b57\u7b26\u4e32\u4e2d\u7684\u7a7a\u683c\u8f6c\u6362\u4e3a\u5236\u8868\u7b26\uff0c\u9ed8\u8ba4\u6bcf\u4e2a\u7a7a\u683c\u90fd\u4f1a\u8f6c\u6362\u3002</p> <pre><code>faner@MBP-FAN $ echo \"This is a  test\" | tr '[:space:]' '\\t'\nThis    is      a               test    %\n</code></pre> <p>\u6307\u5b9a <code>-s</code> \u9009\u9879\uff0c\u53ef\u538b\u7f29\u8fd9\u4e9b\u91cd\u590d\u7684\u7a7a\u683c\uff1a</p> <pre><code>faner@MBP-FAN $ echo \"This is a  test\" | tr -s '[:space:]' '\\t'\nThis    is      a       test    %\n</code></pre> <p>\u4ee5\u4e0b\u4f7f\u7528 <code>-s</code> \u9009\u9879\u53bb\u9664\u91cd\u590d\u5b57\u6bcd\uff0c\u6216\u5c06\u76f8\u540c\u5b57\u6bcd\u8fdb\u884c\u538b\u7f29\u3002</p> <pre><code>faner@MBP-FAN $  cat oops.txt\nAnd the cowwwwws went homeeeeeeee\nOr did theyyyy\n\nfaner@MBP-FAN $  tr -s '[a-z]' &lt; oops.txt\nAnd the cows went home\nOr did they\n</code></pre> <p>\u4ee5\u4e0b\u4f7f\u7528 <code>-s</code> \u9009\u9879\u79fb\u9664\u6587\u4ef6\u4e2d\u7684\u7a7a\u884c\u3002</p> <p><code>-d</code> \u4f1a\u79fb\u9664\u6240\u6709\u6587\u672c\u884c\u7ed3\u5c3e\u7684\u6362\u884c\u7b26\u3002</p> <pre><code># tr -s \"[\\012]\" &lt; oops.txt\nfaner@MBP-FAN $ tr -s \"[\\n]\" &lt; oops.txt\n</code></pre> <p>\u5229\u7528 <code>tr -s</code> \u66ff\u6362\u56de\u8f66\u6362\u884c\u7b26\uff08<code>\\r\\n</code>\uff09\u4e3a\u6362\u884c\u7b26\uff08<code>\\n</code>\uff09\uff0c\u5b9e\u73b0dos2unix\uff08crlf-&gt;lf\uff09\uff1a</p> <pre><code>faner@MBP-FAN $ tr -s \"[\\r\\n]\" \"[\\n*]\" &lt; include/litestd.h\nfaner@MBP-FAN $ tr -s \"[\\015\\012]\" \"[\\012*]\" &lt; include/litestd.h\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#complement","title":"Complement","text":"<p>\u6765\u81ea unix/POSIX - tr manpage \u7684\u4e00\u4e2a\u6837\u4f8b\uff1a</p> <pre><code># creates a list of all words in file1 one per line in file2, where a word is taken to be a maximal string of letters.\ntr -cs \"[:alpha:]\" \"[\\n*]\" &lt;file1 &gt;file2\n</code></pre> <p>\u4e0b\u9762\u7684\u6587\u4ef6\u5305\u542b\u4e00\u4e2a\u661f\u671f\u7684\u65e5\u7a0b\u8868\uff0c\u9700\u8981\u4ece\u5176\u4e2d\u5220\u9664\u6240\u6709\u6570\u5b57\uff0c\u53ea\u4fdd\u7559\u65e5\u671f\u3002</p> <pre><code>faner@MBP-FAN $ $ cat diary.txt\nMonday     08:00\nTuesday    08:10\nwednesday  08:20\nThursday   08:30\nfriday     08:40\nSaturday   08:50\nsunday     09:00\n</code></pre> <p>\u57fa\u4e8e <code>-c</code> \u7684\u8865\u96c6\u601d\u8def\uff1a\u628a\u661f\u671f\u4e4b\u5916\u7684\u975e\u5b57\u6bcd\u66ff\u6362\u4e3a\u6362\u884c\u7b26\uff0c\u76f8\u5f53\u4e8e\u79fb\u9664\u661f\u671f\u4e4b\u540e\u7684\u90e8\u5206\u3002</p> <pre><code># cat diary.txt | tr -cs \"[a-z][A-Z]\" \"[\\n*]\"\nfaner@MBP-FAN $ cat diary.txt | tr -cs \"[:alpha:]\" \"[\\n*]\"\nMonday\nTuesday\nWednesday\nThursday\nFriday\nSaturday\nSunday\n</code></pre> <p>\u6587\u4ef6\u6bcf\u884c\u6240\u6709\u4e0d\u5305\u542b\u5728\u5927\u5c0f\u5199\u5b57\u6bcd\u96c6\u5408 <code>[a-z]</code> \u6216 <code>[A-Z]</code> \u4e2d\u7684\u5b57\u7b26\u4e32\u653e\u5728\u5b57\u7b26\u4e321\u4e2d\u5e76\u8f6c\u6362\u4e3a\u65b0\u884c\u3002</p> <p><code>-c</code> \u8868\u660e\u4fdd\u7559\u6240\u6709\u5b57\u6bcd\u4e0d\u52a8\uff0c\u53d6\u5176\u8865\u96c6\uff1b<code>-s</code> \u9009\u9879\u8868\u660e\u538b\u7f29\u6240\u6709\u65b0\u884c\u3002</p>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#delete","title":"delete","text":"<p>\u4f7f\u7528 <code>-d</code> \u9009\u9879\u53ef\u4ee5\u5220\u9664\u6307\u5b9a\u7684\u5b57\u7b26\uff08\u96c6\uff09\uff0c\u4f8b\u5982 <code>tr -d '[:space:]'</code>\uff08<code>tr -d ' '</code>\uff09 \u5220\u9664\u7a7a\u683c\u3002</p> <pre><code># \u5220\u9664\u6240\u6709\u7684\u5c0f\u5199\u5b57\u6bcd\nfaner@MBP-FAN $ echo 'Hua Wei' | tr -d a-z\nH W\n</code></pre> <p>\u4f7f\u7528 <code>-cd</code> \u7ec4\u5408\u9009\u9879\uff0c\u5219\u5220\u9664\u6307\u5b9a\u7684\u5b57\u7b26\uff08\u96c6\uff09\u4e4b\u5916\u7684\u5176\u4ed6\u5b57\u7b26\uff0c\u4ee5\u4e0b\u4e3a manpage \u793a\u4f8b\u3002</p> <pre><code># \u5220\u9664\u53ef\u6253\u5370\u5b57\u7b26\u7684\u8865\u96c6\uff0c\u5373\u5220\u9664\u4e0d\u53ef\u6253\u5370\u5b57\u7b26\u3002\nfaner@MBP-FAN $ tr -cd \"[:print:]\" &lt; file1\n</code></pre> <p>dos2unix\uff08crlf-&gt;lf\uff09\u7684\u53e6\u5916\u4e00\u79cd\u5b9e\u73b0\u662f\u5229\u7528 <code>tr -d</code>\uff0c\u5220\u9664\u56de\u8f66\u63a7\u5236\u5b57\u7b26\uff08<code>\\r</code>\uff09\uff0c\u5e76\u8f93\u51fa\u5230\u65b0\u6587\u4ef6\uff1a</p> <pre><code>faner@MBP-FAN $ cat include/litestd.h | tr -d '[\\r]' &gt; include/litestd2.h\nfaner@MBP-FAN $ tr -d '[\\r]' &lt; include/litestd.h &gt; include/litestd2.h\nfaner@MBP-FAN $ tr -d \"[\\015]\" &lt; include/litestd.h | tee include/litestd2.h\n</code></pre> <p>\u4e0a\u9762\u793a\u4f8b\u57fa\u4e8e\u8865\u96c6\u66ff\u6362\u63d0\u53d6 diary.txt \u4e2d\u7684\u65e5\u671f\u5217\uff0c\u53e6\u4e00\u79cd\u601d\u8def\u662f\u57fa\u4e8e <code>-d</code> \u5220\u9664\u9664\u661f\u671f\u4e4b\u5916\u7684\u6240\u6709\u5b57\u7b26\uff0c\u5305\u62ec\u7a7a\u683c\u3001\u6570\u5b57\u548c\u5192\u53f7\u3002</p> <pre><code>faner@MBP-FAN $ cat diary.txt | tr -d \"[0-9][: ]\"\n</code></pre> <p>\u6ce8\u610f\uff1a<code>tr -cd \"[:alpha:]\"</code> \u4f1a\u5c06\u672b\u5c3e\u7684\u6362\u884c\u7b26\u4e5f\u5220\u9664\uff0c<code>tr -cd \"[:alpha:][\\n]\"</code> \u7b26\u5408\u9884\u671f\u3002</p>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#xargs","title":"xargs","text":"<p>unix/POSIX - xargs FreeBSD/Darwin - xargs </p> <p>linux - xargs(1) &amp; xargs(1p) debian/Ubuntu - xargs </p> <p>\u6267\u884c <code>xargs --help</code> \u53ef\u67e5\u770b\u7b80\u8981\u5e2e\u52a9\uff08Usage\uff09\u3002 \u6267\u884c <code>man xargs</code> \u53ef\u67e5\u770b\u8be6\u7ec6\u5e2e\u52a9\u624b\u518c\uff08Manual Page\uff09\uff1a</p> <pre><code>pi@raspberrypi:~ $ man xargs\n\nXARGS(1)                           General Commands Manual                           XARGS(1)\n\nNAME\n     xargs -- construct argument list(s) and execute utility\n\nSYNOPSIS\n     xargs [-0oprt] [-E eofstr] [-I replstr [-R replacements] [-S replsize]]\n       [-J replstr] [-L number] [-n number [-x]] [-P maxprocs] [-s size]\n       [utility [argument ...]]\n\nDESCRIPTION\n     The xargs utility reads space, tab, newline and end-of-file delimited\n     strings from the standard input and executes utility with the strings as\n     arguments.\n\n     Any arguments specified on the command line are given to utility upon\n     each invocation, followed by some number of the arguments read from the\n     standard input of xargs.  This is repeated until standard input is ex-\n     hausted.\n</code></pre> <p>\u6267\u884c <code>xargs --version</code> \u67e5\u770b\u7248\u672c\u4fe1\u606f\uff1a</p> <pre><code>pi@raspberrypi:~ $ xargs --version\nxargs (GNU findutils) 4.7.0-git\nCopyright (C) 2016 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\nWritten by Eric B. Decker, James Youngman, and Kevin Dalley.\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#options","title":"options","text":"<p>\u4ee5\u4e0b\u5217\u4e3e\u4e865\u4e2a\u5e38\u7528\u7684\u547d\u4ee4\u9009\u9879\uff1a</p> <pre><code>     -0      Change xargs to expect NUL (``\\0'') characters as separators, in-\n         stead of spaces and newlines.  This is expected to be used in\n         concert with the -print0 function in find(1).\n\n     -I replstr\n         Execute utility for each input line, replacing one or more occur-\n         rences of replstr in up to replacements (or 5 if no -R flag is\n         specified) arguments to utility with the entire line of input.\n\n     -n number\n         Set the maximum number of arguments taken from standard input for\n         each invocation of utility.\n\n     -p      Echo each command to be executed and ask the user whether it\n         should be executed.  An affirmative response, `y' in the POSIX\n         locale, causes the command to be executed, any other response\n         causes it to be skipped.  No commands are executed if the process\n         is not attached to a terminal.\n\n     -t      Echo the command to be executed to standard error immediately be-\n         fore it is executed.\n</code></pre> <p><code>xargs -I</code> \u548c <code>xargs -i</code> \u662f\u4e00\u6837\u7684\uff0c\u53ea\u662f <code>-i</code> \u9ed8\u8ba4\u4f7f\u7528\u5927\u62ec\u53f7\uff08<code>{}</code>\uff09\u4f5c\u4e3a\u66ff\u6362\u5b57\u7b26\u4e32\uff08replstr\uff09\uff0c<code>-I</code> \u5219\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5176\u4ed6\u5b57\u7b26\u4e32\u4f5c\u4e3a replstr\uff0c\u4f46\u662f\u5fc5\u987b\u7528\u5f15\u53f7\u5305\u8d77\u6765\uff08\uff1f\uff09\u3002</p> <p>man \u63a8\u8350\u4f7f\u7528 <code>-I</code> \u4ee3\u66ff <code>-i</code>\uff0c\u4f46\u662f\u4e00\u822c\u90fd\u4f7f\u7528 <code>-i</code> \u56fe\u4e2a\u7b80\u5355\uff0c\u9664\u975e\u5728\u547d\u4ee4\u4e2d\u4e0d\u80fd\u4f7f\u7528\u5927\u62ec\u53f7\u3002</p> <p>macOS \u4e0b\u4e0d\u652f\u6301 <code>-i</code> \u9009\u9879\uff01</p>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#usage","title":"usage","text":"<p>\u5927\u591a\u6570\u65f6\u5019\uff0cxargs \u547d\u4ee4\u90fd\u662f\u8ddf\u7ba1\u9053\u4e00\u8d77\u4f7f\u7528\u7684\u3002\u4f46\u662f\uff0c\u5b83\u4e5f\u53ef\u4ee5\u5355\u72ec\u4f7f\u7528\u3002 <code>xargs</code> \u540e\u9762\u7684\u547d\u4ee4\u9ed8\u8ba4\u662f <code>echo</code>\u3002</p> <p><code>xargs</code> \u662f\u6784\u5efa\u5355\u884c\u547d\u4ee4\u7684\u91cd\u8981\u7ec4\u4ef6\u4e4b\u4e00\uff0c\u5b83\u64c5\u957f\u5c06\u6807\u51c6\u8f93\u5165\u6570\u636e\u8f6c\u6362\u6210\u547d\u4ee4\u884c\u53c2\u6570\u3002 xargs \u547d\u4ee4\u4e00\u822c\u7d27\u8ddf\u5728\u7ba1\u9053\u64cd\u4f5c\u7b26\u4e4b\u540e\uff0c\u4ee5\u6807\u51c6\u8f93\u5165\u4f5c\u4e3a\u4e3b\u8981\u7684\u6e90\u6570\u636e\u6d41\u3002\u5b83\u4f7f\u7528 stdin \u5e76\u901a\u8fc7\u63d0\u4f9b \u547d\u4ee4\u884c\u53c2\u6570 \u6765\u6267\u884c\u5176\u4ed6\u547d\u4ee4\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b xargs \u5c06\u5176\u6807\u51c6\u8f93\u5165\u4e2d\u7684\u5185\u5bb9\u4ee5\u7a7a\u767d(\u5305\u62ec\u7a7a\u683c\u3001tab\u3001\u56de\u8f66\u6362\u884c\u7b49)\u5206\u5272\u6210\u591a\u4e2a arguments \u4e4b\u540e\u5f53\u4f5c\u547d\u4ee4\u884c\u53c2\u6570\u4f20\u9012\u7ed9\u5176\u540e\u9762\u7684\u547d\u4ee4\u3002 \u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>-d</code> \u547d\u4ee4\u6307\u5b9a\u7279\u5b9a\u5206\u9694\u7b26\uff08macOS \u8c8c\u4f3c\u4e0d\u652f\u6301\u8be5\u9009\u9879\uff09\u3002  </p> <p>\u57fa\u4e8e\u8fd9\u4e00\u539f\u7406\uff0c\u6700\u7b80\u5355\u7684\u5e94\u7528\u662f\u901a\u8fc7 <code>| xargs</code> \u79fb\u9664\u5b57\u7b26\u4e32\u9996\u5c3e\u7a7a\u683c\u3002</p> <p>``Shell $ echo \"   lol  \" | xargs lol <pre><code>md5 \u547d\u4ee4\u652f\u6301\u8ba1\u7b97\u6307\u5b9a\u6587\u4ef6\u6216\u5b57\u7b26\u4e32\u7684MD5\u503c\uff0c\u4f46\u4e0d\u652f\u6301\u4ecestdin\u8f93\u5165\uff0c\u56e0\u6b64\u65e0\u6cd5\u5c06\u5b57\u7b26\u4e32\u7ba1\u4f20\u7ed9md5\u6267\u884c\u8ba1\u7b97\u3002\n\u6b64\u65f6\u53ef\u8003\u8651\u57fa\u4e8e `| xargs md -s` \u53d8\u901a\u5b9e\u73b0\uff1a\n\n```Shell\n$ echo 'How many roads must a man walk down' | xargs md5 -s\n</code></pre></p> <p>\u4ee5\u4e0b\u901a\u8fc7 <code>brew list --cask</code> \u5217\u4e3e\u6240\u6709brew\u5b89\u88c5\u7684cask\u5e94\u7528\uff0c\u7136\u540e\u901a\u8fc7\u7ba1\u9053 xargs \u4f20\u53c2\u7ed9 <code>brew upgrade --cask</code> \u6267\u884c\u5347\u7ea7\uff1a</p> <pre><code>brew list --cask | xargs -t brew upgrade --cask\n</code></pre> <p>xargs \u548c find \u7b97\u662f\u4e00\u5bf9\u6b7b\u515a\uff0c\u4e24\u8005\u7ed3\u5408\u4f7f\u7528\u53ef\u4ee5\u8ba9\u4efb\u52a1\u53d8\u5f97\u66f4\u8f7b\u677e\uff0c\u8be6\u60c5\u53c2\u8003 find\u3002</p>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#tricks","title":"tricks","text":"<p>\u65e0\u6cd5\u901a\u8fc7 xargs \u4f20\u9012\u6570\u503c\u505a\u6b63\u786e\u7684\u7b97\u672f\u6269\u5c55\uff1a</p> <pre><code>$ echo 1 | xargs -I \"x\" echo $((2*x))\n</code></pre> <p>\u8fd9\u65f6\u53ea\u80fd\u6539\u53d8\u65b9\u6cd5\u6216\u5bfb\u627e\u4e00\u4e9b\u5c0f\u6280\u5de7\uff0c\u4f8b\u5982\uff1a</p> <pre><code>$ echo 1 | xargs -I {} expr 2 \\* {}\n</code></pre> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cxargs \u6bcf\u6b21\u53ea\u80fd\u4f20\u9012\u4e00\u6761\u5206\u5272\u7684\u6570\u636e\u5230\u547d\u4ee4\u884c\u4e2d\u4f5c\u4e3a\u53c2\u6570\u3002\u4f46\u6709\u65f6\u5019\u60f3\u8981\u8ba9 xargs \u4e00\u6b21\u4f20\u90122\u4e2a\u62162\u4e2a\u4ee5\u4e0a\u53c2\u6570\u5230\u547d\u4ee4\u884c\u4e2d\u3002\u5982\u4f55\u5b9e\u73b0\u5462\uff1f</p> <p>\u4f8b\u5982\u6709\u4e00\u4e2a\u6587\u4ef6\u4fdd\u5b58\u4e86 wget \u60f3\u8981\u4e0b\u8f7d\u7684\u5927\u91cf\u94fe\u63a5\u548c\u5bf9\u5e94\u8981\u4fdd\u5b58\u7684\u6587\u4ef6\u540d\uff0c\u4e00\u884c\u94fe\u63a5\u4e00\u884c\u6587\u4ef6\u540d\u3002\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>https://www.xxx.yyy/a1\nfilename1\nhttps://www.xxx.yyy/a2\nfilename2\nhttps://www.xxx.yyy/a3\nfilename3\n</code></pre> <p>\u73b0\u5728\u60f3\u8981\u901a\u8fc7\u8bfb\u53d6\u8fd9\u4e2a\u6587\u4ef6\uff0c\u5c06\u6bcf\u4e00\u4e2aURL\u548c\u5bf9\u5e94\u7684\u6587\u4ef6\u540d\u4f20\u9012\u7ed9wget\u53bb\u4e0b\u8f7d\uff1a</p> <pre><code>$ wget '{URL}' -O '{FILENAME}'\n</code></pre> <p>xargs \u81ea\u8eab\u7684\u529f\u80fd\u65e0\u6cd5\u4e00\u6b21\u6027\u4f20\u9012\u591a\u4e2a\u53c2\u6570\uff08parallel\u547d\u4ee4\u53ef\u4ee5\uff0c\u800c\u4e14\u65b9\u5f0f\u591a\u79cd\uff09\uff0c\u53ea\u80fd\u5bfb\u6c42\u4e00\u4e9b\u6280\u5de7\u6765\u5b9e\u73b0\u3002</p> <pre><code>cat url.txt | xargs -n 2 bash -c 'wget \"$1\" -O \"$2\"'\n</code></pre>","tags":["pipeline"]},{"location":"blog/20191101/Pipelines/#refs","title":"refs","text":"<p>\u5173\u4e8e xargs \u7684\u7528\u6cd5\uff0c\u53ef\u4ee5\u53c2\u8003 \u300aLinux Shell \u811a\u672c\u653b\u7565\u300b\u4e2d\u7684 <code>2.5 \u73a9\u8f6c xargs</code> \u76f8\u5173\u7ae0\u8282\u3002</p> <p>xargs \u547d\u4ee4\u6559\u7a0b xargs \u547d\u4ee4\u8be6\u89e3 Xargs \u7528\u6cd5\u8be6\u89e3 xargs \u539f\u7406\u5256\u6790\u53ca\u7528\u6cd5\u8be6\u89e3 </p>","tags":["pipeline"]},{"location":"blog/20191101/REDIRECTION/","title":"Linux Redirection\uff08\u91cd\u5b9a\u5411\uff09","text":"<p>\u53c2\u8003 BASH(1) manual page \u7684 <code>REDIRECTION</code> \u90e8\u5206\u3002</p> <p>\u6570\u636e\u6d41\u91cd\u5b9a\u5411(REDIRECTION)\u5c31\u662f\u5c06\u67d0\u4e2a\u547d\u4ee4\u6267\u884c\u540e\u672c\u5e94\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u7684\u7ed3\u679c\u6570\u636e\u4f20\u5bfc\u5230\u6307\u5b9a\u7684\u5730\u65b9\uff0c\u4f8b\u5982\u6587\u4ef6\u6216\u6253\u5370\u673a\u4e4b\u7c7b\u7684\u8bbe\u5907\u3002</p> <p>\u5f53\u5728shell\u4e2d\u6267\u884c\u547d\u4ee4\u7684\u65f6\u5019\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u548c\u4e09\u4e2a\u6253\u5f00\u7684\u6587\u4ef6\u76f8\u8054\u7cfb\uff0c\u5e76\u4f7f\u7528\u6587\u4ef6\u63cf\u8ff0\u7b26\u6765\u5f15\u7528\u8fd9\u4e9b\u6587\u4ef6\u3002</p> <p>\u7531\u4e8e\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0d\u5bb9\u6613\u8bb0\u5fc6\uff0cshell\u7ed9\u51fa\u4e86\u76f8\u5e94\u7684\u6587\u4ef6\u540d\u4ee3\u79f0\u3002</p> <ol> <li> <p>\u6807\u51c6\u8f93\u5165\uff08stdin\uff09\uff1a\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u4e3a0\uff0c\u7f3a\u7701\u4ece\u952e\u76d8\u63a5\u53d7\u8f93\u5165\u3002</p> <ul> <li>\u4e5f\u53ef\u4f7f\u7528 <code>&lt;</code>\uff08<code>0&lt;</code>\uff09 \u6216 <code>&lt;&lt;</code>\uff08<code>0&lt;&lt;</code>\uff09\u4ece\u6587\u4ef6\u6216\u5176\u4ed6\u8bbe\u5907\u5bfc\u5165\u3002</li> </ul> </li> <li> <p>\u6807\u51c6\u8f93\u51fa\uff08stdout\uff09\uff1a\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u4e3a1\uff0c\u7f3a\u7701\u8f93\u51fa\u5230\u63a7\u5236\u53f0\uff08\u5c4f\u5e55\uff09\u3002</p> <ul> <li>\u4e5f\u53ef\u4f7f\u7528 <code>&gt;</code>\uff08<code>1&gt;</code>\uff09 \u6216 <code>&gt;&gt;</code>\uff08<code>1&gt;&gt;</code>\uff09\u91cd\u5b9a\u5411\u5bfc\u51fa\u5230\u6587\u4ef6\u6216\u5176\u4ed6\u8bbe\u5907\u3002</li> </ul> </li> <li> <p>\u6807\u51c6\u9519\u8bef\u8f93\u51fa\uff08stderr\uff09\uff1a\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u4e3a2\uff0c\u7f3a\u7701\u8f93\u51fa\u5230\u63a7\u5236\u53f0\uff08\u5c4f\u5e55\uff09\u3002</p> <ul> <li>\u4e5f\u53ef\u4f7f\u7528 <code>&gt;</code>\uff08<code>2&gt;</code>\uff09 \u6216 <code>&gt;&gt;</code>\uff08<code>2&gt;&gt;</code>\uff09\u91cd\u5b9a\u5411\u5bfc\u51fa\u5230\u6587\u4ef6\u6216\u5176\u4ed6\u8bbe\u5907\u3002</li> </ul> </li> </ol> <p>\u5982\u679c\u6ca1\u6709\u7279\u522b\u6307\u5b9a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u547d\u4ee4\u9ed8\u8ba4\u5c06\u6267\u884c\u4fe1\u606f\u8f93\u51fa\u5230\u7f3a\u7701\u201c\u6587\u4ef6\u201d\u2014\u2014\u4f60\u7684\u5c4f\u5e55\uff0c\u66f4\u786e\u5207\u5730\u8bf4\u662f\u4f60\u7684\u7ec8\u7aef\u3002</p>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#stderr","title":"stderr","text":"<p>\u4e3a\u4ec0\u4e48\u4f1a\u6709\u4e00\u4e2a\u4e13\u95e8\u9488\u5bf9\u9519\u8bef\u7684\u7279\u6b8a\u6587\u4ef6stderr\u5462\uff1f</p> <p>\u5f53\u7528\u547d\u4ee4\u5904\u7406\u5927\u6570\u636e\u6587\u4ef6\u65f6\uff0c\u9664\u4e86\u6b63\u5e38\u7684\uff08\u975e\u9519\u8bef\u7684\uff09\u8f93\u51fa\u4fe1\u606f\uff0c\u8fd8\u6709\u53ef\u80fd\u8f93\u51fa\u5f88\u591a\u9519\u8bef\u4fe1\u606f\u3002 \u5e38\u89c1\u505a\u6cd5\u662f\u5148\u5c06\u6807\u51c6\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\uff0c\u7136\u540e\u518d\u628a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u53e6\u5916\u4e00\u4e2a\u6587\u4ef6\u3002 \u628a\u9519\u8bef\u4fe1\u606f\u5b58\u50a8\u5230\u72ec\u7acb\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u53ef\u4ee5\u907f\u514d\u9519\u8bef\u4fe1\u606f\u6df9\u6ca1\u6b63\u5e38\u7ed3\u679c\u8f93\u51fa\uff0c\u4e5f\u4fbf\u4e8e\u6392\u67e5\u95ee\u9898\u3002</p> <ul> <li>\u4f8b\u5982 nginx \u5373\u662f\u5206\u5f00\u5b58\u50a8\u666e\u901a\u65e5\u5fd7 access_log \u548c\u51fa\u9519\u65e5\u5fd7 error_log\u3002</li> </ul> <p>stdout\u548cstderr\u533a\u522b\u5728\u4e8e\uff1a</p> <ol> <li>\u91cd\u5b9a\u5411 <code>&gt;</code> \u9ed8\u8ba4\u662f\u6307 <code>1&gt;</code>\uff0c\u53ea\u5c06stdout\u8f93\u51fa\u91cd\u5b9a\u5411\u3002</li> <li>\u7ba1\u9053 <code>|</code> \u9ed8\u8ba4\u4e5f\u53ea\u5c06stdout\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u547d\u4ee4\u7684\u8f93\u5165\uff0c\u4e0d\u5305\u62ecstderr\uff1b<code>|&amp;</code> \u5219\u5305\u62ec\u4e86stdout\u548cstderr\u3002</li> </ol>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#_","title":"&gt;, &gt;&gt;","text":"<p>\u8f93\u51fa\u5bfc\u5411\uff0c\u5206\u522b\u662f \u66ff\u6362\uff08Redirecting Output\uff09\u4e0e \u7d2f\u52a0\uff08Appending Redirected Output\uff09\u3002</p>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#_1","title":"&gt;","text":"<p>\u6700\u57fa\u672c\u7684\u91cd\u5b9a\u5411\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u53d1\u9001\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0cbash shell\u7528\u5927\u4e8e\u53f7\uff08<code>&gt;</code>\uff09\u6765\u5b8c\u6210\u8fd9\u9879\u529f\u80fd\uff1a</p> <pre><code>command &gt; outputfile\n# \u4ee5\u4e0a\u7f3a\u7701\u4e86\u6807\u51c6\u8f93\u51fa1\ncommand 1&gt; outputfile\n</code></pre> <p>\u8fd9\u6837\u4e4b\u524d\u663e\u793a\u5668\u4e0a\u51fa\u73b0\u7684\u547d\u4ee4\u8f93\u51fa\uff0c\u4e0d\u518d\u8f93\u51fa\u5230\u5c4f\u5e55\u63a7\u5236\u53f0\uff0c\u800c\u662f\u4fdd\u5b58\u5230\u6307\u5b9a\u7684\u8f93\u51fa\u6587\u4ef6\u4e2d\u3002</p> <p>\u5982\u679c\u8f93\u51fa\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\u4f1a\u7528\u65b0\u7684\u6570\u636e\u8986\u76d6\u5df2\u6709\u6587\u4ef6\uff1b\u5426\u5219\u5148\u57fa\u4e8e\u9ed8\u8ba4umask\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\u3002</p> <p>\u53ef\u4ee5\u5c06stderr\u5355\u72ec\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c06stdout\u91cd\u5b9a\u5411\u5230\u53e6\u4e00\u4e2a\u6587\u4ef6\uff1a</p> <pre><code>cmd 2&gt;stderr.txt 1&gt;stdout.txt\n# \u6807\u51c6\u8f93\u51fa1\u53ef\u4ee5\u7701\u7565\ncmd 2&gt;stderr.txt &gt;stdout.txt\n</code></pre> <p>\u5047\u8bbe\u6709\u4e24\u4e2a\u5ba1\u8ba1\u6587\u4ef6\uff0c\u5176\u4e2d\u4e00\u4e2a\u7684\u786e\u5b58\u5728\u4e14\u5305\u542b\u4e00\u4e9b\u4fe1\u606f\uff0c\u800c\u53e6\u4e00\u4e2a\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u53ef\u80fd\u5df2\u7ecf\u4e0d\u5b58\u5728\u4e86\u3002 \u4ee5\u4e0b\u811a\u672c\u628a\u8fd9\u4e24\u4e2a\u6587\u4ef6\u5408\u5e76\u5230accounts.out\u4e2d\uff0c\u76f8\u5e94\u7684\u9519\u8bef\u5c06\u4f1a\u4fdd\u5b58\u5728accounts.err\u6587\u4ef6\u4e2d\u3002</p> <pre><code>$ cat account_qtr.doc account_end.doc 1&gt;accounts.out 2&gt;accounts.err\n</code></pre> <p>\u6211\u4eec\u6765\u770b\u4e00\u4e2agcc\u7f16\u8bd1\u7684\u4f8b\u5b50\u3002\u53c2\u8003 Overall Options\uff0cgcc \u7684 <code>-E</code> \u9009\u9879\u6307\u5b9a\u53ea\u6267\u884c\u9884\u5904\u7406\uff08preprocessing\uff09\uff0c\u5e76\u5c06\u7ed3\u679c\u8f93\u51fa\u5230standard output\uff08\u9ed8\u8ba4\u8f93\u51fa\u5230\u5c4f\u5e55\u63a7\u5236\u53f0\uff09\u3002</p> <pre><code>-E\nStop after the preprocessing stage; do not run the compiler proper. The output is in the form of preprocessed source code, which is sent to the standard output.\n</code></pre> <p>\u5982\u679cc\u4ee3\u7801\u4e2d\u5305\u542b\u4e86\u5f88\u591a <code>#define</code> \u548c <code>#include</code> \u9884\u5904\u7406\u4f2a\u6307\u4ee4\uff08Preprocessor Directives\uff09\uff0c\u63a7\u5236\u53f0\u8f93\u51fa\u5c06\u5f88\u957f\uff0c\u53ef\u8003\u8651\u5c06\u9884\u5904\u7406\u7ed3\u679c\u91cd\u5b9a\u5411\u5230\u6587\u672c\u6587\u4ef6\u4e2d\uff0c\u7a0d\u540e\u7528\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00\u6162\u6162\u5206\u6790\u3002</p> <pre><code>$ gcc helloworld.c -E &gt; preprocessing_E.txt\n</code></pre> <p>\u5982\u679c\u60f3\u770b\u770b preprocessing \u8fc7\u7a0b\u5177\u4f53\u6267\u884c\u4e86\u54ea\u4e9b\u547d\u4ee4\uff0c\u53ef\u4ee5\u6253\u5f00 <code>-v</code> \u5f00\u5173\uff0c\u8fd9\u4e9b\u6267\u884cverbose\u4fe1\u606f\u5c06\u8f93\u51fa\u5230stderr\uff08\u9ed8\u8ba4\u8f93\u51fa\u5230\u5c4f\u5e55\u63a7\u5236\u53f0\uff09\u3002</p> <pre><code>-v\nPrint (on standard error output) the commands executed to run the stages of compilation. Also print the version number of the compiler driver program and of the preprocessor and the compiler proper.\n</code></pre> <p>\u5982\u679c\u8981\u5c06verbose\u4fe1\u606f\u5355\u72ec\u4fdd\u5b58\u5230\u6587\u672c\u6587\u4ef6\uff0c\u53ef\u4ee5\u8ffd\u52a0 <code>2&gt;</code>\uff1a</p> <pre><code>$ gcc helloworld.c -E -v &gt;preprocessing_E.txt 2&gt;preprocessing_v.txt\n# or\n$ gcc helloworld.c -E -v 1&gt;preprocessing_E.txt 2&gt;preprocessing_v.txt\n</code></pre>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#_devnull","title":"&gt; /dev/null","text":"<p>\u6709\u65f6\u5019\uff0c\u5728\u8f93\u51fa\u4e2d\u53ef\u80fd\u5305\u542b\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684\u4fe1\u606f\uff08\u5982\u8c03\u8bd5\u4fe1\u606f\uff09\u3002 \u5982\u679c\u4e0d\u60f3\u8ba9\u7ec8\u7aef\u5145\u65a5\u7740\u6709\u5173stderr\u7684\u7e41\u679d\u672b\u8282\uff0c\u53ef\u8003\u8651\u5c06stderr\u8f93\u51fa\u91cd\u5b9a\u5411\u5230 <code>/dev/null</code>\uff0c\u4e88\u4ee5\u5ffd\u7565\u3002</p> <p>\u5728\u4f7f\u7528 grep \u67e5\u627e\u65f6\uff0c\u5f53\u4f20\u5165\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u4e0d\u5b58\u5728\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a <code>-s</code> \u9009\u9879\u5c4f\u853d No such file or directory \u4e4b\u7c7b\u7684\u9519\u8bef\u4fe1\u606f\u8f93\u51fa\u3002 find \u547d\u4ee4\u5219\u6ca1\u6709\u7c7b\u4f3c\u7684\u9009\u9879\uff0c\u5f53\u67e5\u627e\u7684\u6587\u4ef6\uff08\u5939\uff09\u6ca1\u6709\u8bfb\u6743\u9650\u65f6\uff0c\u53ef\u80fd\u4f1a\u6709\u5927\u91cf\u7684 Permission denied \u62a5\u9519\u4fe1\u606f\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u3002 find \u6267\u884c\u8f93\u51fa\u7684\u9519\u8bef\u4fe1\u606f\u53ef\u4ee5\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u5355\u72ec\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u4e5f\u53ef\u5bfc\u5411\u5783\u573e\u6876\u9ed1\u6d1e\u8bbe\u5907\uff0c\u88ab\u541e\u566c\u4e0d\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u3002</p> <ul> <li>Linux / Unix Find Command Avoid Permission Denied Messages </li> <li>How can I exclude all \"permission denied\" messages from \"find\"? </li> </ul> <pre><code># \u5c06\u9519\u8bef\u4fe1\u606f\u91cd\u5b9a\u5411\u5230\u65e5\u5fd7\u6587\u4ef6\uff0c\u4e0d\u8f93\u51fa\u5230\u63a7\u5236\u53f0\n$ find /home -name .bashrc 2&gt; finderrors.log\n# \u5c06\u9519\u8bef\u4fe1\u606f\u91cd\u5b9a\u5411\u5230\u7cfb\u7edf\u5783\u573e\u6876\uff0c\u4e0d\u8f93\u51fa\u5230\u63a7\u5236\u53f0\n$ find /home -name .bashrc 2&gt; /dev/null\n$ find / -type f -name \"*.conf\" -maxdepth 4 2&gt;/dev/null\n</code></pre> <p>\u6709\u65f6\u5019 stdout \u548c stderr \u4e2d\u90fd\u6709\u5185\u5bb9\uff0c\u53ef\u5c06\u5176\u4e2d\u4e4b\u4e00\u91cd\u5b9a\u5411\u5230\u9ed1\u6d1e\uff0c\u53ea\u6253\u5370\u53e6\u5916\u4e00\u4e2a\u3002</p> <pre><code># echo \u547d\u4ee4\u6267\u884c\u6b63\u5e38\uff0c\u53ea\u8f93\u51fa stdout\uff0c\u4e0d\u8f93\u51fa stderr\uff1bdump \u4e00\u4efd\u5230 stderr\n$ echo hello 1&gt;&amp;2\nhello\n\n# \u8fc7\u6ee4\u6389 stdout\uff0c\u8f93\u51fa stderr\n$ echo hello 1&gt;&amp;2 1&gt;/dev/null\nhello\n</code></pre> <p>\u5728 transfer.sh \u4e2d\uff0ccurl \u6b63\u5e38\u8f93\u51fa <code>| tee /dev/null</code> \u53ea\u8f93\u51fa\u5230\u63a7\u5236\u53f0\uff0c\u5bfc\u5165\u9ed1\u6d1e\uff08\u4e0d\u5b58\u6587\u4ef6\uff09\uff1a</p> <pre><code>curl --progress-bar --upload-file \"-\" \"https://transfer.sh/$file_name\" | tee /dev/null\n</code></pre> <p>\u5047\u8bbe\u8981\u68c0\u6d4b\u672c\u5730\u5b89\u88c5\u7684Python\u7248\u672c\uff0c\u9700\u6267\u884c <code>python -V</code> \u5373\u53ef\u3002</p> <ol> <li>\u5df2\u5b89\u88c5python\uff0c\u8f93\u51fa\u63d0\u793a Python 3.9.6 \u5230 1-stdout</li> <li>\u672a\u5b89\u88c5python\uff0c\u8f93\u51fa\u63d0\u793a zsh: command not found: python \u5230 2-stderr</li> </ol> <p>\u7b2c3\u53e5 <code>if python -V;</code> \u4e3a\u8bd5\u63a2\u68c0\u6d4b\u8bed\u53e5\uff0c\u7531\u4e8e\u540e\u9762\u4f1a\u9488\u5bf9\u6210\u529f\u5931\u8d25\u5206\u60c5\u51b5\u5904\u7406\uff0c\u82e5\u5df2\u5b89\u88c5\u540e\u7eed\u4f1a\u518d\u6b21\u8bfb\u53d6\u7248\u672c\u5e76\u8f93\u51fa\u5b89\u88c5\u4fe1\u606f\u3002 \u82e5\u4e0d\u5e0c\u671b\u5728\u63a7\u5236\u53f0\u8f93\u51fa\u4e34\u65f6\u6267\u884c\u7ed3\u679c\uff0c\u53ef\u7eed\u63a5 <code>&amp;&gt;/dev/null</code> \u5c06\u6267\u884c\u7ed3\u679c(stdout or stderr)\u91cd\u5b9a\u5411\u5230\u9ed1\u6d1e\u3002</p> <p>\u8bd5\u63a2\u6267\u884c\u6210\u529f\uff0c\u8868\u793a\u5df2\u5b89\u88c5python\uff0c\u5728then\u5206\u652f\u4e2d\u518d\u6b21\u6267\u884c <code>python -V</code> \u5c06\u7ed3\u679c\u4fdd\u5b58\u5728 python_version \u53d8\u91cf\u4e2d\u3002 \u7531\u4e8e\u540e\u7eed\u6709echo\u8f93\u51fapython\u5b89\u88c5\u548c\u7248\u672c\u4fe1\u606f\uff0c\u56e0\u6b64\u8fd9\u91cc\u4fdd\u5b58\u6267\u884c\u7ed3\u679c\u5230\u53d8\u91cf\u540e\uff0c\u4e0d\u5e0c\u671b\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u3002 \u53ef\u5728\u53d8\u91cf\u8d4b\u503c\u540e\uff0c\u7eed\u63a5 <code>1&gt;/dev/null</code> \u5c4f\u853dstdout\u8f93\u51fa\uff08suppress stdout\uff09\u3002</p> <pre><code>check_python_version()\n{\n    if python -V &amp;&gt;/dev/null; # \u4e0d\u8f93\u51fa\u6267\u884c\u7ed3\u679c\n    then\n        python_version=$(python -V) 1&gt;/dev/null # \u4e0d\u8f93\u51fa\u7248\u672c\u4fe1\u606f\n        echo \"python installed: $python_version\"\n        return 0\n    else\n        echo \"python uninstalled!\"\n        return 1\n    fi\n}\n</code></pre>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#12","title":"1&gt;&amp;2","text":"<p>\u5728\u7f16\u5199shell\u811a\u672c\u65f6\uff0c\u7ecf\u5e38\u4f1a\u5728\u6355\u83b7\u9519\u8bef\u5f02\u5e38\u65f6\u8c03\u7528echo\u6253\u5370\u81ea\u5b9a\u4e49\u7684\u51fa\u9519\u4fe1\u606f\uff0c\u5e76\u5c06\u8fd9\u4e9b\u9519\u8bef\u4fe1\u606f\u91cd\u5b9a\u5411\u5230stderr\u8bbe\u5907\u4e2d\u3002 \u5982\u679c\u4e4b\u524d\u5df2\u7ecf\u5c06stderr\u91cd\u5b9a\u5411\u5230\u4e86\u6307\u5b9a\u65e5\u5fd7\u6587\u4ef6\uff0c\u90a3\u4e48\u81ea\u5b9a\u4e49\u7684echo\u4fe1\u606f\u4e5f\u4f1a\u968fstderr\u91cd\u5b9a\u5411\u5230\u65e5\u5fd7\u6587\u4ef6\u3002 \u53ef\u4ee5\u5728\u4e2d\u9014\u91c7\u53d6\u8fd9\u79cd\u91cd\u5b9a\u5411\u7b56\u7565\uff0c\u4f7f\u6807\u51c6\u8f93\u51fa\u5c3d\u53ef\u80fd\u7b80\u6d01\uff0c\u4ee5\u514d\u88ab\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u7684\u5927\u91cf\u8f93\u51fa\u6df9\u6ca1\u3002</p> <p>redirect stdout to stderr: sending the output to standard error instead of standard out.</p> <p>\u91cd\u5b9a\u5411\u7b26\u53f7 <code>&gt;</code> \u6b63\u5e38\u60c5\u51b5\uff0c\u8fde\u63a5\u5de6\u4fa7\u7684\u6e90\u5934\u548c\u53f3\u4fa7\u7684\u76ee\u6807\uff0c\u5de6\u4fa7\u6e90\u5934\u7f3a\u7701\u662f1-stdout\u3002\u56e0\u6b64 <code>&gt;&amp;2</code> \u5b9e\u9645\u4e0a\u662f <code>1&gt;&amp;2</code> \u7684\u7b80\u7565\u5199\u6cd5\u3002</p> <p><code>[n]&gt;&amp;word</code> - If <code>n</code> is not speci\ufb01ed, the standard output (\ufb01le descriptor 1) is used.</p> <p>\u53f3\u4fa7\u7684 <code>&amp;2</code> \u4e2d\u7684<code>&amp;</code>\u7c7b\u4f3cC\u8bed\u8a00\u4e2d\u7684\u5730\u5740\u5f15\u7528\uff08denote\uff09\uff0c\u800c\u540e\u9762\u7684\u6570\u5b57<code>2</code>\u4e3astderr\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002 \u56e0\u6b64\uff0c<code>&gt;&amp;2</code> \u8868\u793a\u5c061\uff08stdout\uff0c\u6807\u51c6\u8f93\u51fa\uff09\u91cd\u5b9a\u5411\u52302\uff08stderr\uff0c\u6807\u51c6\u9519\u8bef\uff09\u4e2d\u3002</p> <p>\u6ce8\u610f\uff1a<code>&gt;2</code>\u8868\u793a\u91cd\u5b9a\u5411\u5230\u666e\u901a\u6587\u4ef62\u4e2d\uff0c<code>&gt;&amp;2</code>\u5219\u8868\u793a\u91cd\u5b9a\u5411\u5230fd=2\u7684\u8bbe\u5907stdout\u4e2d\u3002</p> <p>\u76f8\u5173\u53c2\u8003\uff1a</p> <ul> <li>shell\u4e2d&gt;&amp;2\u7684\u542b\u4e49\u53ca\u7528\u6cd5 </li> <li>Linux \u91cd\u5b9a\u5411 2&gt;&amp;1\uff0c1&gt;&amp;2 </li> <li>echo &gt;&amp;2 \"some text\" what does it mean in shell scripting </li> </ul> <p>bash - echo that outputs to stderr - Stack Overflow</p> <p>You could do this, which facilitates reading: <code>&gt;&amp;2 echo \"error\"</code></p> <p>\u4ee5\u4e0b\u662f\u6765\u81ea transfer.sh \u4e2d\u7684\u4e00\u6bb5\u811a\u672c\uff0c\u662f\u5178\u578b\u7684\u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\u7684\u9519\u8bef\u6355\u83b7\u5904\u7406\uff1a</p> <pre><code>        if [ ! -e \"$file\" ]; then\n            echo \"$file: No such file or directory\" &gt;&amp;2\n            return 1\n        fi\n</code></pre> <p>echo hello 1&gt;&amp;2 \u914d\u5408\u7ba1\u9053\u64cd\u4f5c\uff1a</p> <pre><code># echo \u547d\u4ee4\u6267\u884c\u6b63\u5e38\uff0c\u53ea\u8f93\u51fa stdout\uff0c\u4e0d\u8f93\u51fa stderr\uff1bdump \u4e00\u4efd\u5230 stderr\n$ echo hello 1&gt;&amp;2\nhello\n\n# \u8fc7\u6ee4\u6389 stdout\uff0c\u8f93\u51fa stderr\n$ echo hello 1&gt;&amp;2 1&gt;/dev/null\nhello\n\n# echo \u8f93\u51fa stdout\uff1bstderr(+stdout) \u5bfc\u5411\u6267\u884c grep\n$ echo hello 1&gt;&amp;2 | grep hello\nhello\nhello\n\n# echo \u8f93\u51fa stdout\uff1bstderr(+stdout) \u5bfc\u5411\u6267\u884c grep\uff0c\u51fa\u9519\u8f93\u51fastderr\n$ echo hello 1&gt;&amp;2 | grep world\nhello\n\n# \u5bf9\u6bd4\uff1agrep \u5339\u914d\u5931\u8d25\u9ed8\u8ba4\u6ca1\u6709\u8f93\u51fa\uff08\u6ca1\u6709\u8bbe\u7f6estderr\uff09\n$ echo hello | grep world\n</code></pre>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#21","title":"2&gt;&amp;1","text":"<p>\u5f53\u8fd0\u884c\u67d0\u4e9b\u547d\u4ee4\u7684\u65f6\u5019\uff0c\u51fa\u9519\u4fe1\u606f\u5f80\u5f80\u4e5f\u5f88\u91cd\u8981\uff0c\u4ee5\u4fbf\u7528\u4e8e\u5206\u6790\u95ee\u9898\u3002 \u90a3\u4e48\uff0c\u5982\u4f55\u4f7f\u9519\u8bef\u4fe1\u606f\u4e5f\u548c\u6b63\u5e38\u8f93\u51fa\u4e00\u6837\uff0c\u90fd\u5199\u5165\u540c\u4e00\u4e2a\u6587\u4ef6\u4e2d\u5462\uff1f</p> <p>\u4ee5\u4e0b\u662f man bash \u4e2d\u5173\u4e8e Redirecting Standard Output and Standard Error \u7684\u4f7f\u7528\u8bf4\u660e\uff1a</p> <pre><code>Bash allows both the standard output (file descriptor 1) and the standard error output (file descriptor 2) to be redirected to the file whose name is the expansion of word with this construct.\n\nThere are two formats for redirecting standard output and standard error:\n\n&amp;&gt;word\n\nand\n\n&gt;&amp;word\n\nOf the two forms, the first is preferred. This is semantically equivalent to\n\n&gt;word 2&gt;&amp;1\n</code></pre> <p>\u4ee5\u4e0b\u7684\u5199\u6cd5\uff0c\u4e24\u6761\u6570\u636e\u4ea4\u53c9\u5199\u5165\uff0c\u53ef\u80fd\u5bfc\u81f4\u9519\u4e71\uff1a</p> <pre><code>$ find /home -name .bashrc 1&gt; file 2&gt; file\n</code></pre> <p>\u6839\u636e manpage \u6587\u6863\uff0c\u6b63\u786e\u7684\u5199\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>$ find /home -name .bashrc &amp;&gt; file\n$ find /home -name .bashrc 2&gt;&amp;1 file\n$ find /home -name .bashrc &gt; file 2&gt;&amp;1\n</code></pre> <p>\u7b2c\u4e00\u79cd\u5199\u6cd5 <code>command &amp;&gt; file</code>\uff1a\u5176\u4e2d\u7684 <code>&amp;</code> \u7701\u7565\u4e86\u88ab\u5f15\u7528\u76841\u548c2\uff0c\u8868\u793astdout\u548cstderr\u90fd\u91cd\u5b9a\u5411\u5230\u6587\u4ef6file\u4e2d\u3002 \u7b2c\u4e8c\u79cd\u5199\u6cd5\uff1a\u9519\u8bef\u5199\u6cd5\uff0c\u5c11\u4e86<code>&gt;</code>\uff0c\u53c2\u8003\u4e0b\u9762\u7684\u7ecf\u5178\u793a\u4f8b\u3002\u8fd9\u91cc\u4f1a\u5c06file\u7406\u89e3\u4e3a\u547d\u4ee4\u884c\u53c2\u6570\uff01\uff1f \u7b2c\u4e09\u79cd\u5199\u6cd5 <code>command &gt; file 2&gt;&amp;1</code>\uff1a\u524d\u9762\u5c06\u6807\u51c6\u8f93\u51fa1-stdout\u91cd\u5b9a\u5411\u5230file\u4e2d\uff0c\u540e\u9762\u7684 <code>2&gt;&amp;1</code> \u600e\u4e48\u7406\u89e3\u5462\uff1f</p> <p><code>2&gt;&amp;1</code> \u8868\u793a\u5c062-stderr\u91cd\u5b9a\u5411\u52301-stdout\uff0c\u8fd9\u6837\u9519\u8bef\u4fe1\u606f\u548c\u6b63\u5e38\u7ed3\u679c\u8f93\u51fa\u90fd\u91cd\u5b9a\u5411\u5230\u4e86\u6587\u4ef6file\u4e2d\u3002</p> <p>\u4ee5\u4e0b\u662f man bash \u4e2d\u7684\u7ecf\u5178\u5bf9\u6bd4\u793a\u4f8b\uff1a</p> <pre><code># Note that the order of redirections is significant. For example, the command\n# directs both standard output and standard error to the file dirlist,\nls &gt; dirlist 2&gt;&amp;1\n\n# while the command directs only the standard output to file dirlist,\n# because the standard error was duplicated as standard output before the standard output was redirected to dirlist.\nls 2&gt;&amp;1 &gt; dirlist\n</code></pre> <p>\u7b2c\u4e8c\u79cd\u5199\u6cd5 <code>ls 2&gt;&amp;1 &gt; dirlist</code> \u548c\u7b2c\u4e00\u79cd\u5199\u6cd5\u7684\u533a\u522b\u5728\u4e8e <code>2&gt;&amp;1</code> \u5728\u91cd\u5b9a\u5411 <code>1 &gt; dirlist</code> \u524d\u9762\u3002</p> <ol> <li>\u5148\u6267\u884c <code>2&gt;&amp;1</code>\uff0c\u6b64\u65f6stdout\u9ed8\u8ba4\u8fd8\u662f\u8f93\u51fa\u5230\u7ec8\u7aef\uff0c\u6240\u4ee5stderr\u540cstdout\u4e00\u6837\u90fd\u8f93\u51fa\u5230\u7ec8\u7aef\u63a7\u5236\u53f0\uff1b  </li> <li>\u518d\u6267\u884c <code>&gt; dirlist</code>\uff0c\u53ea\u6709stdout\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230dirlist\u6587\u4ef6\u4e2d\u3002  </li> </ol> <p>echo hello 2&gt;&amp;1 \u914d\u5408\u7ba1\u9053\u64cd\u4f5c\uff1a</p> <p>2&gt;&amp;1 \u76f8\u5f53\u4e8e |&amp;\uff0c\u540c\u65f6\u7ba1\u4f20 stderr \u548c stdout\u3002</p> <pre><code># echo \u547d\u4ee4\u6267\u884c\u6b63\u5e38\uff0c\u53ea\u8f93\u51fa stdout\uff0c\u4e0d\u8f93\u51fa stderr\uff1bdump \u7a7a\u7684 stderr \u5230 stdout\n$ echo hello 2&gt;&amp;1\nhello\n\n# stdout \u6709\u5185\u5bb9\n$ echo hello 2&gt;&amp;1 2&gt;/dev/null\nhello\n\n# stderr \u4e3a\u7a7a\n$ echo hello 2&gt;&amp;1 1&gt;/dev/null\n\n\n# echo \u8f93\u51fa stdout\uff1bstdout(+stderr) \u5bfc\u5411\u6267\u884c grep\n$ echo hello 2&gt;&amp;1 | grep hello\nhello\n\n# echo \u8f93\u51fa stdout\uff1bstdout(+stderr) \u5bfc\u5411\u6267\u884c grep\uff0c\u51fa\u9519\u8f93\u51fastderr(\u4e3a\u7a7a)\n$ echo hello 2&gt;&amp;1 | grep world\n</code></pre> <p>\u4ee5\u4e0b\u662f How to Run Linux Commands in Background \u4e2d\u6267\u884c\u540e\u53f0\u547d\u4ee4\uff0c\u5e76\u5ffd\u7565stdout\u548cstderr\u8f93\u51fa\uff1a</p> <pre><code># suppress the stdout and stderr messages\n# redirect stdout to /dev/null and stderr to stdout\ncommand &gt; /dev/null 2&gt;&amp;1 &amp;\n</code></pre> <p>\u4ee5\u4e0b\u662f\u6765\u81ea do shell script in AppleScript \u4e2d\u7684\u542f\u52a8\u540e\u53f0daemon\u7684\u811a\u672c\u793a\u4f8b\uff1a</p> <pre><code>do shell script \"command &amp;&gt; file_path &amp;\"\ndo shell script \"command &gt; file_path 2&gt;&amp;1 &amp;\"\n</code></pre>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#_2","title":"&gt;&amp;","text":"<p>\u6765\u770b\u4e00\u7ec4\u7efc\u5408\u5bf9\u6bd4\u793a\u4f8b\uff0c\u4ee5\u4fbf\u52a0\u6df1\u7406\u89e3\uff1a</p> <pre><code># greplog1\uff1a\u53ea\u6709\u6b63\u5e38\u8f93\u51fa\u5185\u5bb9\ngrep pattern file &gt; greplog1\n# greplog2\uff1a\u5185\u5bb9\u4e3a\u7a7a\uff0cstdout\u88ab\u5bfc\u5411\u4e86stderr\ngrep pattern file &gt; greplog2 1&gt;&amp;2\n# greplog3\u3001greplog4\uff1a\u65e2\u6709\u6b63\u5e38\u8f93\u51fa\u5185\u5bb9\uff0c\u53c8\u6709\u9519\u8bef\u8f93\u51fa\u5185\u5bb9\u3002\ngrep pattern file &gt; greplog3 2&gt;&amp;1  # stdout &gt; file, stderr same as stdout\ngrep pattern file 2&gt; greplog4 1&gt;&amp;2 # stderr &gt; file, stdout same as stderr\necho 'df' 2&gt; test.txt &gt;&amp;2 # same as above\n</code></pre> <p>\u56de\u5230\u4e0a\u9762\u7684gcc\u9884\u5904\u7406\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u8981\u5c06 <code>-E</code> \u9884\u5904\u7406(stdout)\u548c <code>-v</code>(stderr)\u4fe1\u606f\u4e00\u8d77\u4fdd\u5b58\u5230\u6587\u672c\u6587\u4ef6\uff0c\u53ef\u4ee5\u6709\u4ee5\u4e0b\u4e24\u79cd\u5199\u6cd5\uff1a</p> <pre><code># directs both stdout &amp; stderr to file, nothing to console\ngcc helloworld.c -E -v &amp;&gt; preprocessing.txt\n\n# directs stdout to file, stderr to stdout(file), both to file, nothing to console\ngcc helloworld.c -E -v &gt; preprocessing.txt 2&gt;&amp;1\n</code></pre> <p>\u6ce8\u610f\uff1a\u4ee5\u4e0b\u60c5\u51b5\u4e2d\uff0c\u5f00\u59cb\u7684stderr(-v verbose\u4fe1\u606f)\u91cd\u5b9a\u5411\u5230stdout\uff0c\u5148\u8f93\u51fa\u5230\u63a7\u5236\u53f0\uff1b\u7136\u540estdout\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u3002</p> <pre><code># directs stderr(-v) to stdout, slip to console\n# then directs only the original stdout(-E) to file\ngcc helloworld.c -E -v 2&gt;&amp;1 &gt; preprocessing_v.txt\n</code></pre> <p>\u5982\u679c\u60f3\u547d\u4ee4\u884c\u6267\u884c\u7684\u5b8c\u6574\u4fe1\u606f\uff0c\u65e2\u4fdd\u7559\u8f93\u51fa\u5230\u63a7\u5236\u53f0\uff0c\u53c8\u5199\u5165\u6587\u4ef6\uff0c\u53ef\u4ee5\u901a\u8fc7\u7ba1\u9053\u52a0tee\u547d\u4ee4\u5b9e\u73b0\uff1a</p> <pre><code># directs stderr(-v) to stdout, then pipe stdout to both console and file\ngcc helloworld.c -E -v 2&gt;&amp;1 | tee preprocessing.txt\ngcc helloworld.c -E -v |&amp; tee preprocessing.txt\n</code></pre>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#_3","title":"&gt;&gt;","text":"<p>\u6709\u65f6\u5e76\u4e0d\u60f3\u8986\u76d6\u6587\u4ef6\u539f\u6709\u5185\u5bb9\uff0c\u800c\u662f\u60f3\u8981\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u8ffd\u52a0\u5230\u5df2\u6709\u6587\u4ef6\u4e2d\uff0c\u6b64\u65f6\u53ef\u4ee5\u7528\u53cc\u5927\u4e8e\u53f7\uff08<code>&gt;&gt;</code>\uff09\u6765\u5411\u73b0\u5b58\u6587\u4ef6\u672b\u5c3e\u8ffd\u52a0\u65b0\u6570\u636e\u3002</p> <p>\u5173\u4e8e\u7d2f\u52a0\u8f93\u51fa\u5bfc\u5411\u7684\u5e7f\u6cdb\u5e94\u7528\u662f echo \u4e00\u884c\u65b0\u914d\u7f6e\uff0c\u8ffd\u52a0\u5230\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002 \u4ee5\u4e0b\u793a\u4f8b\u5728 <code>~/.zshrc</code> \u672b\u5c3e\u8ffd\u52a0\u4e00\u53e5 export \u547d\u4ee4\uff1a</p> <pre><code>echo export ALL_PROXY=socks5://127.0.0.1:1080 &gt;&gt; ~/.zshrc\n</code></pre> <p>brew install openssl \u8fc7\u7a0b\u4e2d\uff0cCaveats \u63d0\u793a\u53ef\u6267\u884c\u811a\u672c\u5c06\u5176\u53ef\u6267\u884c\u8def\u5f84\u6dfb\u52a0\u5230 PATH \u4e2d\uff1a</p> <pre><code>If you need to have this software first in your PATH run:\n  echo 'export PATH=\"/usr/local/opt/openssl/bin:$PATH\"' &gt;&gt; ~/.zshrc\n</code></pre> <p>macOS Bash 3 \u4e0b\u53ef\u4ee5\u7528 <code>&gt;&gt; file 2&gt;&amp;1</code> \u7b49\u6548\u5b9e\u73b0 Bash 4 \u4e0b &amp;&gt;&gt; file \u7684\u6548\u679c\u3002</p>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#__1","title":"&lt;, &lt;&lt;","text":"<p>\u8f93\u5165\u91cd\u5b9a\u5411\u548c\u8f93\u51fa\u91cd\u5b9a\u5411\u6b63\u597d\u76f8\u53cd\uff1a\u8f93\u5165\u91cd\u5b9a\u5411\u5c06\u6587\u4ef6\u7684\u5185\u5bb9\u91cd\u5b9a\u5411\u5230\u547d\u4ee4\uff0c\u800c\u975e\u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u3002</p> <pre><code>command &lt; inputfile\n</code></pre> <p>\u4e00\u4e2a\u7b80\u5355\u7684\u533a\u5206\u8bb0\u5fc6\u65b9\u6cd5\u662f\uff1a\u5728\u547d\u4ee4\u884c\u4e0a\uff0c\u547d\u4ee4\u603b\u662f\u5728\u5de6\u4fa7\uff0c\u800c\u91cd\u5b9a\u5411\u7b26\u53f7\u201c\u6307\u5411\u201d\u6570\u636e\u6d41\u52a8\u7684\u65b9\u5411\u3002</p> <ul> <li>\u8f93\u51fa\u91cd\u5b9a\u5411\u7b26\u53f7\u662f\u5927\u4e8e\u53f7\uff08&gt;\uff09\uff0c\u610f\u5473\u7740\u6570\u636e\u4ece\u547d\u4ee4\u6d41\u5411\u8f93\u51fa\u6587\u4ef6\u3002</li> <li>\u8f93\u5165\u91cd\u5b9a\u5411\u7b26\u53f7\u662f\u5c0f\u4e8e\u53f7\uff08&lt;\uff09\uff0c\u610f\u5473\u7740\u6570\u636e\u4ece\u8f93\u5165\u6587\u4ef6\u6d41\u5411\u547d\u4ee4\u3002</li> </ul>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#_4","title":"&lt;","text":"<p>\u8f93\u5165\u5bfc\u5411\u7b26\u53f7 <code>&lt;</code> \u53ef\u4ee5\u5c06\u539f\u672c\u5e94\u7531\u952e\u76d8\u8f93\u5165\u7684\u6570\u636e\u6e90\u6539\u4e3a\u4ece\u6587\u4ef6\u8bfb\u53d6\u3002</p> <p><code>cat &gt; catfile</code>\uff1a\u547d\u4ee4\u5c06\u521b\u5efa <code>catfile</code> \u6587\u4ef6\uff0c\u5e76\u628a\u6807\u51c6\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u4e2d\uff0c\u8fd9\u65f6cat\u547d\u4ee4\u5c06\u4ece\u6807\u51c6\u8f93\u5165\uff08\u952e\u76d8\uff09\u63a5\u53d7\u8f93\u5165\uff0c\u8f93\u5165 <code>&lt;C-C&gt;</code> \u6216 <code>&lt;C-D&gt;</code> \u7ed3\u675f\u3002</p> <pre><code># \u7528 stdin \u66ff\u4ee3\u952e\u76d8\u7684\u8f93\u5165\u4ee5\u521b\u5efa\u65b0\u6587\u4ef6\ncat &gt; catfile &lt; ~/.bash_logout\n</code></pre> <p>\u4e0d\u8fc7\uff0c\u4ee5\u4e0a\u793a\u4f8b\u7684\u5199\u6cd5\u6709\u70b9\u4ee4\u4eba\u8d39\u89e3\uff0c\u66f4\u5e38\u89c1\u7684\u7b49\u6548\u5199\u6cd5\u5982\u4e0b\uff1a</p> <ul> <li><code>cat ~/.bash_logout &gt; ~/Documents/catfile</code> </li> <li><code>cp ~/.bash_logout Documents/catfile</code> </li> </ul> <p>\u4ee5\u4e0b\u811a\u672c\u4ecefile1\u8bfb\u5165\u5185\u5bb9\u5230stdin\u4f5c\u4e3aenca\u7684\u8f93\u5165\u53c2\u6570\uff0c\u7136\u540e\u5c06\u6267\u884c\u7ed3\u679c\u91cd\u5b9a\u5411\u5230file2\u4e2d\u3002</p> <pre><code>$ enca -L zh_CN -x UTF-8 &lt; file1 &gt; file2\n</code></pre> <p><code>[n]&lt;&gt;file2</code>\uff1an\u7f3a\u7701\u4e3a0-stdin\uff0c\u7701\u7565\u4e86file1\uff0c\u8bfb\u53d6file2\u5230stdin\u7ed9\u547d\u4ee4\u64cd\u4f5c\uff0c\u7136\u540e\u5c06\u7ed3\u679c\u8986\u5199\u5230file\u4e2d\u3002</p>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#_5","title":"&lt;&lt;","text":"<p>\u8fdc\u5c0f\u4e8e\u53f7\uff08<code>&lt;&lt;</code>\uff09\u4e5f\u79f0\u4f5c\u5185\u8054\u8f93\u5165\u91cd\u5b9a\u5411\u7b26\u53f7\uff0c\u540e\u9762\u9700\u8981\u7eed\u63a5\u7ec8\u6b62\u8f93\u5165\u63a7\u5236\u6807\u8bb0\u5355\u8bcd\uff08\u5b57\u7b26\u4e32\uff09\uff0c\u7528\u4e8e\u5212\u5206\u8f93\u5165\u6570\u636e\u7684\u5f00\u59cb\u548c\u7ed3\u5c3e\u3002</p> <p><code>Here Documents</code>: This type of redirection instructs the shell to read input from the current source until a line containing only word (with no trailing blanks) is seen. All of the lines read up to that point are then used as the standard input for a command.</p> <p>The format of here-documents is:</p> <pre><code>&lt;&lt;[\u2212]word\n    here-document\ndelimiter\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u4e2d\u5f53\u8f93\u5165 <code>eof</code> \u65f6\uff0c\u5219\u7ed3\u675f\u8f93\u5165\u3002</p> <p>\u5728\u4f7f\u7528tr\u8fdb\u884c\u8f6c\u6362\u65f6\uff0c\u9700\u8981\u63a5\u53d7stdin\u8f93\u5165\uff0c\u901a\u5e38\u662fecho string\u6216cat file\u7ba1\u9053\u4f20\u7ed9tr\u5904\u7406\u3002 \u5982\u679c\u591a\u6b21\u590d\u5236\u7684\u6bb5\u843d\u4e2d\u6709\u7a7a\u683c\u9700\u8981\u79fb\u9664\uff0c\u53ef\u4ee5\u5728\u9884\u8bbe\u547d\u4ee4\u672b\u5c3e\u6307\u5b9a <code>command &lt;&lt; eof</code>\u3002 \u91c7\u7528heredoc\u9010\u884c\u7c98\u8d34\u5f85\u5904\u7406\u6587\u672c\uff0c\u6700\u540e\u4e00\u884c\u8f93\u5165eof\u7ed3\u675f\u8f93\u5165\u6267\u884c\u5904\u7406\u3002</p> <pre><code>$ tr -d '[:space:]' &lt;&lt; eof\nheredoc&gt; \u6211 \u4eec \u7684 \u7231\nheredoc&gt; \u4e00\u65e6 \u9519\u8fc7 \u5c31 \u4e0d\u518d\nheredoc&gt; eof\n\u6211\u4eec\u7684\u7231\u4e00\u65e6\u9519\u8fc7\u5c31\u4e0d\u518d%\n</code></pre> <p>\u8fd9\u6837\u5728\u547d\u4ee4\u884c\u8f93\u5165shell\u6307\u4ee4\u540e\uff0c\u5bf9\u5373\u65f6\u8f93\u5165\u7684\u6587\u672c\u884c\uff08\u6bb5\u843d\uff09\u505a\u4e00\u4e9b\u5904\u7406\uff0c\u6bd4\u6bcf\u6b21\u5148\u4fdd\u5b58\u4e34\u65f6\u6587\u4ef6\u518dcat\u7ba1\u4f20\u65b9\u4fbf\u5f97\u591a\uff01</p>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#cat","title":"cat","text":"<p>\u4ee5\u4e0b\u51fd\u6570\u7528\u4e8e\u8f93\u51fa\u4e00\u6bb5\u4fe1\u606f\uff0c\u901a\u8fc7getopts\u6355\u83b7\u5230\u7528\u6237\u8f93\u5165<code>-h, --help</code>\u9009\u9879\u65f6\uff0c\u5411\u5c4f\u5e55\u6253\u5370Usage\u5e2e\u52a9\u4fe1\u606f\u3002</p> <p>\u8fd9\u6837\u5199\u7684\u597d\u5904\u662f\u53ef\u4ee5\u4fdd\u6301\u6392\u7248\u683c\u5f0f\u3002</p> <pre><code>show_help() {\n    cat &lt;&lt;EOF\n$(basename \"$0\") version: 1.0.0\nUsage: $(basename \"$0\") [-?hvSPdpr]\n\nOptions:\n    -?,-h,--help            : show help and exit\n    -v, --version           : show version and exit\n    -S, --server            : start as server, default\n    -P, --proxy             : start as proxy daemon\n    -d, --debug             : run in debug mode, default\n    -p, --profile           : run in profile mode\n    -r, --release           : run in release mode\nEOF\n}\n\n# vue -h \u8c03\u7528\u4ee5\u4e0b\u51fd\u6570\u6253\u5370 usage \u5e2e\u52a9\u8bf4\u660e\nvue_usage() {\n    cat &lt;&lt;EOF\nUsage: vue &lt;command&gt; [options]\n\nOptions:\n  -V, --version  output the version number\n  -h, --help     output usage information\n\nCommands:\n  init           generate a new project from a template\n  list           list available official templates\n  build          prototype a new project\n  create         (for v3 warning only)\n  help [cmd]     display help for [cmd]\nEOF\n}\n</code></pre> <p>\u5728\u4ee5\u4e0a\u6848\u4f8b\u57fa\u7840\u4e0a\uff0c\u52a0\u4e2a\u91cd\u5b9a\u5411\u5c06\u952e\u76d8\u8f93\u5165\u6253\u5370\u5230\u5c4f\u5e55\u4e0a\uff0c\u540c\u65f6\u4e5f\u4fdd\u5b58\u5230\u6587\u4ef6catfile\u4e2d\u3002</p> <pre><code># \u7528 stdin \u66ff\u4ee3\u952e\u76d8\u7684\u8f93\u5165\u4ee5\u521b\u5efa\u65b0\u6587\u4ef6\ncat &gt; catfile &lt;&lt; \"eof\"\n</code></pre> <p>\u4ee5\u4e0b\u662f\u5b8c\u6574\u793a\u4f8b\uff1a</p> <pre><code>$ cat &gt; catfile.txt &lt;&lt; eof\nheredoc&gt; line1\nheredoc&gt; line2\nheredoc&gt; line3\nheredoc&gt; eof\n\n$ cat catfile.txt\nline1\nline2\nline3\n</code></pre> <p>\u6211\u4eec\u7ecf\u5e38\u5728\u7f51\u4e0a\u770b\u5230\u4e00\u6bb5\u811a\u672c\uff0c\u60f3\u590d\u5236\u4e0b\u6765\u4fdd\u5b58\u4e3a\u672c\u5730sh\u6587\u4ef6\uff0c\u518d\u6267\u884c\u8c03\u8bd5\u3002 \u5728\u547d\u4ee4\u884c\u6309\u7167\u4ee5\u4e0b\u683c\u5f0f\uff0c\u4fee\u6539\u811a\u672c\u540d\u79f0\uff0c\u7c98\u8d34\u5185\u5bb9\u5230EOF\u4e2d\u95f4\uff0c\u6267\u884c\u5b8c\u811a\u672c\u6587\u4ef6\u5373\u4fdd\u5b58\u5230\u4e86\u5f53\u524d\u76ee\u5f55\u4e0b\u3002</p> <p>\u9057\u7559\u95ee\u9898\uff1a\u5f15\u7528\u53d8\u91cf\u90e8\u5206\u88ab\u6267\u884c\u4e86\u975e\u9884\u671f\u66ff\u6362\uff1f</p> <pre><code>cat &gt; reader.sh &lt;&lt; EOF\n#!/bin/bash\nwhile read line; do\n  echo \"reading: ${line}\"\ndone &lt; /dev/stdin\nEOF\n</code></pre>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#bc","title":"bc","text":"<p>\u53e6\u5916\u4e00\u4e2a\u7ecf\u5178\u7684\u4f8b\u5b50\u662f\uff0c\u57fa\u4e8e\u5185\u8054\u8f93\u5165\u91cd\u5b9a\u5411\uff0c\u5c06\u8868\u8fbe\u5f0f\u5b57\u7b26\u4e32\u4f20\u7ed9 <code>bc</code> \u6267\u884c\u6570\u5b66\u8fd0\u7b97\u3002</p> <pre><code>$ bc &lt;&lt;&lt; \"scale=4;3.44/5\"\n.6880\n</code></pre> <p>\u4e00\u79cd\u65b9\u5f0f\u662f\u91cd\u5b9a\u5411\uff1a</p> <pre><code>$ var1=$(echo \"scale=4;3.44/5\" | bc)\n$ echo $var1\n.6880\n</code></pre> <p>\u8fd9\u79cd\u65b9\u5f0f\u9002\u7528\u4e8e\u8f83\u77ed\u7684\u8fd0\u7b97\u8868\u8fbe\u5f0f\uff0c\u5f53\u9700\u8fdb\u884c\u5927\u91cf\u8fd0\u7b97\u3001\u6d89\u53ca\u66f4\u591a\u7684\u6570\u5b57\u65f6\uff0c\u5728\u4e00\u4e2a\u547d\u4ee4\u884c\u4e2d\u5217\u51fa\u591a\u4e2a\u8868\u8fbe\u5f0f\u4f1a\u5f88\u9ebb\u70e6\u3002 \u7b2c\u4e8c\u79cd\u65b9\u5f0f\u662f\u4f7f\u7528\u5185\u8054\u8f93\u5165\u91cd\u5b9a\u5411\uff0c\u5b83\u5141\u8bb8\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u4e2d\u91cd\u5b9a\u5411\u6570\u636e\u3002</p> <pre><code>variable=$(bc &lt;&lt; EOF\noptions\nstatements\nexpressions\nEOF\n)\n</code></pre> <p>\u8fd9\u6837\uff0c\u53ef\u4ee5\u5c06\u6240\u6709\u6d89\u53ca bash \u8ba1\u7b97\u5668\u7684\u90e8\u5206\u90fd\u653e\u5230\u540c\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\u7684\u4e0d\u540c\u884c\u3002</p> <pre><code>#!/bin/bash\n\nvar1=10.46\nvar2=43.67\nvar3=33.2\nvar4=71\n\nvar5=$(bc &lt;&lt; EOF\nscale = 4\na1 = ( $var1 * $var2)\nb1 = ($var3 * $var4)\na1 + b1\nEOF)\n\necho The final answer for this mess is $var5\n</code></pre>","tags":["redirection"]},{"location":"blog/20191101/REDIRECTION/#_6","title":"&lt;&lt;&lt;","text":"<p><code>Here Strings</code>: A variant of here documents, the format is:</p> <pre><code>command &lt;&lt;&lt; string\n</code></pre> <p>The word is expanded and supplied to the command on its standard input.</p> <p>\u5728\u4f7f\u7528tr\u8fdb\u884c\u8f6c\u6362\u65f6\uff0c\u9700\u8981\u63a5\u53d7stdin\u8f93\u5165\uff0c\u901a\u5e38\u662fecho string\u6216cat file\u7ba1\u9053\u4f20\u7ed9tr\u5904\u7406\u3002 \u5982\u679c\u6709\u5b57\u7b26\u4e32\u6587\u672c\u884c\u9700\u8981\u6267\u884c\u4e00\u4e9b\u8f6c\u6362\u5904\u7406\uff0c\u53ef\u4ee5\u91c7\u7528herestr\u5728\u9884\u8bbe\u547d\u4ee4\u672b\u5c3e\u8f93\u5165\u5f85\u5904\u7406\u5b57\u7b26\u4e32\u3002</p> <p>\u8fd9\u6837\u5728\u547d\u4ee4\u884c\u8f93\u5165shell\u6307\u4ee4\u540e\uff0c\u5bf9\u5373\u65f6\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u505a\u4e00\u4e9b\u5904\u7406\uff0c\u6bd4\u6bcf\u6b21echo\u7ba1\u4f20\u65b9\u4fbf\u5f97\u591a\uff01</p> <p>Here Documents \u548c Here Strings \u673a\u5236\u5b9e\u73b0\u4e86\u7c7b\u4f3cread\u7b49\u5f85\u7528\u6237\u8f93\u5165\u5f85\u5904\u7406\u6570\u636e\u7684\u6548\u679c\u3002</p> <p>\u6848\u4f8b\u4e00\uff1a\u8c03\u7528 tr \u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u5b57\u7b26\u66ff\u6362\uff1a</p> <pre><code># echo \u6211 \u4eec \u7684 \u7231 | tr -d '[:space:]'\n$ tr -d '[:space:]' &lt;&lt;&lt; '\u6211 \u4eec \u7684 \u7231' # \u6709\u7a7a\u683c\uff0c\u6ce8\u610f\u52a0\u5f15\u53f7\n\n# echo dos2unix | tr '[:lower:]' '[:upper:]'\n$ tr '[:lower:]' '[:upper:]' &lt;&lt;&lt; dos2unix\n</code></pre> <p>\u6848\u4f8b\u4e8c\uff1abc\u8fd0\u884c\u5373\u65f6\u8f93\u5165\u7684\u8868\u8fbe\u5f0f\u6267\u884c\u8fd0\u7b97\uff1a</p> <pre><code># echo \"5 * 7 /3\" | bc\n$ bc &lt;&lt;&lt; \"5 * 7 /3\"\n# \u5341\u8fdb\u5236\u8f6c\u5341\u516d\u8fdb\u5236\n$ bc &lt;&lt;&lt; 'obase=16;ibase=10;254'\n# \u5341\u516d\u8fdb\u5236\u8f6c\u5341\u8fdb\u5236\n$ bc &lt;&lt;&lt; 'obase=10;ibase=16;FE'\n</code></pre> <p>\u5176\u4ed6\u6848\u4f8b\uff1a</p> <pre><code># \u4fbf\u6377\u8ba1\u7b97\u5b57\u7b26\u4e32\u7684SHA-1\n$ shasum &lt;&lt;&lt; \"How many roads must a man walk down\"\n5d9678bcd687051fa93b14fe8d21c681c7eecbc0  -\n</code></pre> <p>\u811a\u672c read_by_line.sh \u7528\u4e8e\u6d4b\u8bd5\u7528\u6237\u8f93\u5165\u53c2\u6570\u3002</p> read_by_line.sh <pre><code>#!/bin/bash\n\n# Read either the first argument or from stdin\n\n# test cases\n## 1. `./read_by_line.sh README.md`\uff1a\u6253\u5370\u6587\u4ef6\u3002  \n## 2. `./read_by_line.sh`\uff1a\u7b49\u5f85\u952e\u76d8\u8f93\u5165\uff0c\u7136\u540e\u56de\u663e\u3002  \n## 3. `./read_by_line.sh &lt;&lt; eof`\uff1a\u7b49\u5f85\u952e\u76d8\u8f93\u5165\u5185\u5bb9\uff0c\u8f93\u5165eof\u7ed3\u675f\uff0c\u7136\u540e\u56de\u663e\u3002  \n## 4. `./read_by_line.sh &lt;&lt;&lt; hello`\uff1a\u6253\u5370\u56de\u663e\u3002  \n\nfunc7126967() {\n    # https://stackoverflow.com/a/7126967\n    cat \"${1:-/dev/stdin}\" &gt;\"${2:-/dev/stdout}\"\n}\n\nfunc7045517() {\n    # https://stackoverflow.com/a/7045517\n    while read -r line; do\n        echo \"$line\"\n    done &lt;\"${1:-/dev/stdin}\"\n}\n\nfunc28786207() {\n    # https://stackoverflow.com/a/28786207\n    file=${1--} # POSIX-compliant; ${1:--}\n    while IFS= read -r line; do\n        printf '%s\\n' \"$line\" # Or: env POSIXLY_CORRECT=1 echo \"$line\"\n    done &lt; &lt;(cat -- \"$file\")\n}\n\nfunc28788047() {\n    # https://stackoverflow.com/a/28788047\n    (($#)) || set -- -\n    while (($#)); do\n        { [[ $1 = - ]] || exec &lt;\"$1\"; } &amp;&amp;\n            while read -r; do\n                printf '%s\\n' \"$REPLY\"\n            done\n        shift\n    done\n}\n\nfunc7126967 \"$@\"\n# func7045517 \"$@\"\n# func28786207 \"$@\"\n# func28788047 \"$@\"\n</code></pre> <p>\u5982\u679c\u4f20\u5165\u4e86\u53c2\u6570$1\uff0c\u5219\u5c06\u5176\u4f5c\u4e3aread\u8f93\u5165\uff0c\u5426\u5219\u7b49\u5f85\u63a5\u6536stdin\u6807\u51c6\u8f93\u5165\u3002\u56db\u79cd\u6d4b\u8bd5\u7528\u4f8b\u5982\u4e0b\uff1a</p> <ol> <li><code>./read_by_line.sh README.md</code>\uff1a\u8bfb\u53d6\u6253\u5370\u6587\u4ef6\u3002  </li> <li><code>./read_by_line.sh</code>\uff1a\u7b49\u5f85\u952e\u76d8\u8f93\u5165\uff0c\u7136\u540e\u56de\u663e\u3002  </li> <li><code>./read_by_line.sh &lt;&lt; eof</code>\uff1a\u7b49\u5f85\u952e\u76d8\u8f93\u5165\u5185\u5bb9\uff0c\u8f93\u5165eof\u7ed3\u675f\uff0c\u7136\u540e\u56de\u663e\u3002  </li> <li><code>./read_by_line.sh &lt;&lt;&lt; hello</code>\uff1a\u6253\u5370\u56de\u663e\u3002  </li> </ol>","tags":["redirection"]},{"location":"blog/20191106/1-sh-basic/","title":"Linux Shell Program - basic","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u57fa\u672c\u6982\u5ff5\u3002</p>"},{"location":"blog/20191106/1-sh-basic/#\u4f7f\u7528\u591a\u4e2a\u547d\u4ee4","title":"\u4f7f\u7528\u591a\u4e2a\u547d\u4ee4","text":"<p>shell\u53ef\u4ee5\u5c06\u591a\u4e2a\u547d\u4ee4\u4e32\u8d77\u6765\uff0c\u4e00\u6b21\u6267\u884c\u5b8c\u6210\u3002 \u5982\u679c\u60f3\u591a\u4e2a\u547d\u4ee4\u4e00\u8d77\u8fd0\u884c\uff0c\u53ef\u4ee5\u628a\u5b83\u4eec\u653e\u5728\u540c\u4e00\u884c\u4e2d\uff0c\u5f7c\u6b64\u95f4\u7528\u5206\u53f7\uff08<code>;</code>\uff09\u9694\u5f00\u3002</p> <pre><code>[] ~ date\nMon Dec  9 22:39:22 CST 2019\n[] ~ who\nfaner    console  Nov 29 07:00\nfaner    ttys000  Dec  7 07:48\nfaner    ttys002  Dec  7 07:48\nfaner    ttys004  Dec  8 07:02\nfaner    ttys006  Dec  9 22:39\n</code></pre> <p>\u4e24\u4e2a\u547d\u4ee4\u5199\u5230\u4e00\u884c\u6267\u884c\uff1a</p> <pre><code>[] ~ date ; who\nMon Dec  9 22:39:40 CST 2019\nfaner    console  Nov 29 07:00\nfaner    ttys000  Dec  7 07:48\nfaner    ttys002  Dec  7 07:48\nfaner    ttys004  Dec  8 07:02\nfaner    ttys006  Dec  9 22:39\n</code></pre> <p>\u4f7f\u7528\u8fd9\u79cd\u529e\u6cd5\u5c31\u80fd\u5c06\u591a\u4e2a\u547d\u4ee4\u4e32\u8fde\u5728\u4e00\u8d77\u6267\u884c\uff0c\u53ea\u8981\u4e0d\u8d85\u8fc7\u6700\u5927\u547d\u4ee4\u884c\u5b57\u7b26\u6570255\u5c31\u884c\u3002 \u7528\u5206\u53f7\u4e32\u8054\u7684\u547d\u4ee4\u4e4b\u95f4\u6ca1\u6709\u903b\u8f91\u4f9d\u8d56\uff0c\u8fd8\u53ef\u4ee5\u7528 <code>&amp;&amp;</code> \u6216 <code>||</code> \u5c06\u591a\u6761\u547d\u4ee4\u4e32\u8054\u5f62\u6210 command-lists\u3002</p> <p>\u5bf9\u4e8e\u5c0f\u578b\u811a\u672c\u5c1a\u53ef\uff0c\u4f46\u5b83\u6709\u4e00\u4e2a\u5f88\u5927\u7684\u7f3a\u9677\uff1a\u6bcf\u6b21\u90fd\u5fc5\u987b\u5728\u547d\u4ee4\u63d0\u793a\u7b26\u4e0b\u8f93\u5165\u6574\u4e2a\u547d\u4ee4\u3002 \u53ef\u4ee5\u5c06\u8fd9\u4e9b\u547d\u4ee4\u7ec4\u5408\u6210\u4e00\u4e2a\u7b80\u5355\u7684\u811a\u672c\u6587\u4ef6\uff0c\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u6bcf\u6b21\u90fd\u91cd\u590d\u8f93\u5165\u4e86\u3002 \u540e\u7eed\u9700\u8981\u8fd0\u884c\u8fd9\u4e9b\u547d\u4ee4\u65f6\uff0c\u53ea\u8981\u8fd0\u884c\u8fd9\u4e2a\u811a\u672c\u6587\u4ef6\u5c31\u884c\u4e86\uff0c\u4ee5\u4fbf\u590d\u7528\u3002</p>"},{"location":"blog/20191106/1-sh-basic/#\u521b\u5efa\u811a\u672c","title":"\u521b\u5efa\u811a\u672c","text":"<p>\u53ef\u4ee5\u628a\u8981\u6267\u884c\u7684\u547d\u4ee4\u5199\u5165sh\u811a\u672c\u6587\u4ef6\u4e2d\uff0cshell \u89e3\u91ca\u5668\u4f1a\u6839\u636e\u547d\u4ee4\u5728\u811a\u672c\u6587\u4ef6\u4e2d\u7684\u987a\u5e8f\u89e3\u91ca\u6267\u884c\u3002</p> <pre><code>#!/bin/bash\n# This script displays the date and who's logged on\ndate\nwho\n</code></pre>"},{"location":"blog/20191106/1-sh-basic/#shebang","title":"shebang","text":"<p>\u811a\u672c\u9996\u884c\u7684 shebang\uff0c\u4e00\u822c\u7528\u6765\u544a\u8bc9\u7cfb\u7edf\u91c7\u7528\u54ea\u79cd\u89e3\u91ca\u5668\u6765\u89e3\u91ca\u8fd0\u884c\u8be5\u811a\u672c\u3002</p> <p>\u5728\u5927\u591a\u6570 Linux \u548c BSD \u53d1\u884c\u7248\u4e2d\uff0cenv \u7684\u8def\u5f84\u90fd\u662f usr/bin/env\u3002 shebang \u7684\u4e00\u822c\u662f\u4ee5 <code>#!</code> \u5f00\u5934\uff0c\u5728 <code>/usr/bin/env</code> \u540e\u9762\u7a7a\u683c\u63a5\u89e3\u91ca\u5668\u540d\u79f0\u3002</p> <pre><code>#!/usr/bin/env interpreter\n</code></pre> <p>\u4f8b\u5982\uff0c.py \u548c .js \u6587\u4ef6\u7684sha-bang \u7533\u660e\u5982\u4e0b\uff1a</p> <ul> <li>python\uff1a<code>#!/usr/bin/env python</code> </li> <li>node js\uff1a<code>/usr/bin/env node</code> </li> </ul> <p>\u5728\u521b\u5efabash shell\u811a\u672c\u65f6\uff0c\u7b2c\u4e00\u884c\u7684 shebang\uff0c\u901a\u5e38\u6709\u4ee5\u4e0b\u683c\u5f0f\u4e3a\uff1a</p> <pre><code>#!/bin/sh\n#!/bin/bash\n#!/usr/bin/env sh\n#!/usr/bin/env bash\n</code></pre> <p>\u5728\u901a\u5e38\u7684shell\u811a\u672c\u4e2d\uff0c\u4e95\u53f7\uff08<code>#</code>\uff09\u7528\u4f5c\u6ce8\u91ca\u884c\uff0cshell\u4f1a\u5ffd\u7565\u811a\u672c\u4e2d\u7684\u6ce8\u91ca\u884c\uff0c\u4e0d\u4f1a\u89e3\u91ca\u6267\u884c\u3002 \u7136\u800c\uff0cshell\u811a\u672c\u6587\u4ef6\u7684\u7b2c\u4e00\u884c\u662f\u4e2a\u4f8b\u5916\uff0c<code>#!</code> \u544a\u8bc9\u7cfb\u7edf\u8be5\u811a\u672c\u7528\u54ea\u79cdshell\u6765\u89e3\u91ca\u6267\u884c\u3002 \u5982\u679c\u5199\u7684\u662fzsh\u811a\u672c\uff0c\u90a3\u4e48 shebang \u53ef\u4ee5\u5199\u6210 <code>#!/bin/zsh</code>\u3002</p> <p><code>/bin/sh</code> \u548c <code>/bin/bash</code> \u4e00\u81f4\uff1a</p> <pre><code>$ /bin/sh --version\nGNU bash, version 3.2.57(1)-release (x86_64-apple-darwin21)\nCopyright (C) 2007 Free Software Foundation, Inc.\n\n$ /bin/bash --version\nGNU bash, version 3.2.57(1)-release (x86_64-apple-darwin21)\nCopyright (C) 2007 Free Software Foundation, Inc.\n</code></pre> <p>\u5173\u4e8e #!/bin/bash \u548c #!/usr/bin/env bash \u8fd9\u4e24\u79cd shebang \u7684\u533a\u522b\uff0c\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u8bdd\u9898\uff1a</p> <ul> <li> </li> <li>#!/bin/bash \u548c #!/usr/bin/env bash \u7684\u533a\u522b </li> <li>What is the difference between \"#!/usr/bin/env bash\" and \"#!/usr/bin/bash\"? </li> <li>Why is it better to use \"#!/usr/bin/env NAME\" instead of \"#!/path/to/NAME\" as my shebang? </li> </ul> <p>Bash Shebang \u5c0f\u7ed3 \uff1a</p> <ol> <li> <p><code>#!/bin/bash</code> \u662f\u6307\u5b9a\u89e3\u91ca\u5668\u7edd\u5bf9\u8def\u5f84\u7684\u7ecf\u5178\u5199\u6cd5\uff0c\u4f46\u65e0\u6cd5\u4fdd\u8bc1\u6240\u6709\u7cfb\u7edf\u4e2d\u7684 bash \u7a0b\u5e8f\u90fd\u5b89\u88c5\u5728 /bin \u76ee\u5f55\u3002</p> <ul> <li>\u4f8b\u5982 macOS \u53ef\u80fd\u901a\u8fc7 brew \u5b89\u88c5\u4e86\u6700\u65b0\u7684 GNU bash\uff0c\u9700\u8981 shebang \u66ff\u6362\u6210\u65b0\u5b89\u88c5\u7684bash\u8def\u5f84\uff1a<code>#!/usr/local/bin/bash</code>\u3002</li> </ul> </li> <li> <p><code>#!/usr/bin/env bash</code> \u4e0d\u6307\u5b9a\u7edd\u5bf9\u8def\u5f84\uff0c\u5728\u5f53\u524d\u73af\u5883\u4e2d\u67e5\u627e\u7a0b\u5e8f\u7684\u9ed8\u8ba4\u7248\u672c\uff0c\u56e0\u6b64\u5728\u4e0d\u540c\u7cfb\u7edf\u4e0a\u7684\u79fb\u690d\u6027\u66f4\u597d\u3002</p> <ul> <li>\u53ef\u80fd\u7684\u5b89\u5168\u9690\u60a3\uff1a\u7528\u6237\u8bef\u521b\u5efa\u4e86\u540d\u79f0\u4e3a bash \u7684\u7a0b\u5e8f\uff0c\u5e76\u628a\u5b83\u7684\u8def\u5f84\u6dfb\u52a0\u5230 PATH \u53d8\u91cf\u7684\u9760\u524d\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5c31\u4f1a\u4f7f\u7528\u5047 bash \u6765\u6267\u884c\u811a\u672c\uff01</li> </ul> </li> <li> <p>\u5982\u679c\u811a\u672c\u8c03\u7528\u4e86OS\u7279\u6027\u76f8\u5173\u547d\u4ee4\uff0c\u53ea\u9700\u5728\u5355\u4e00\u7cfb\u7edf\u4e2d\u6267\u884c\uff0c\u65e0\u9700\u8003\u8651\u517c\u5bb9\u6027\uff0c\u53ef\u91c7\u7528\u7b2c\u4e00\u79cd\u5199\u6cd5\u3002  </p> </li> <li>\u5982\u679c\u76ee\u6807\u662f\u9762\u5411\u8de8\u591a\u79cd\u7c7b Unix \u7cfb\u7edf\uff0c\u5219\u811a\u672c\u8bbe\u8ba1\u9700\u8981\u517c\u5bb9\u901a\u7528\uff0c\u5efa\u8bae\u91c7\u7528\u53ef\u79fb\u690d\u6027\u8f83\u5f3a\u7684\u5199\u6cd5\u3002  </li> </ol> <p>\u53e6\u5916\uff0csed \u548c awk \u90fd\u652f\u6301 <code>-f</code> \u9009\u9879\uff0c\u4ece\u6307\u5b9a\u811a\u672c\u6587\u4ef6\u4e2d\u52a0\u8f7d\u6267\u884c\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u5728 .sed \u548c .awk \u811a\u672c\u5f00\u5934\u6307\u5b9a shebang\u3002</p> <ul> <li>linux: <code>#!/bin/sed -f</code>\uff0c<code>#!/bin/awk -f</code> </li> <li>macOS: <code>#!/usr/bin/sed -f</code>\uff0c <code>#!/usr/bin/awk -f</code> </li> </ul> <p>\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u6267\u884c <code>./scripts/test.sed</code>\u3001<code>./scripts/test.awk</code> \u6765\u52a0\u8f7d\u89e3\u91ca\u8fd0\u884c sed/awk \u811a\u672c\u4e86\u3002</p>"},{"location":"blog/20191106/1-sh-basic/#usrbinpython_\u4e0e_usrbinenv_python_\u7684\u533a\u522b123","title":"!/usr/bin/python \u4e0e #!/usr/bin/env python \u7684\u533a\u522b\uff1a1\uff0c2\uff0c3\u3002","text":""},{"location":"blog/20191106/1-sh-basic/#\u6267\u884c\u6743\u9650","title":"\u6267\u884c\u6743\u9650","text":"<pre><code>$ ./test1\nbash: ./test1: Permission denied\n</code></pre> <p>\u5feb\u901f\u67e5\u770b\u4e00\u4e0b\u6587\u4ef6\u6743\u9650\u5c31\u80fd\u627e\u5230\u95ee\u9898\u6240\u5728\uff1a</p> <pre><code>$ ls -l test1\n-rw-rw-r-- 1 user   user    73 Sep 24 19:56 test1\n</code></pre> <p>\u6267\u884c  <code>chmod +x test1</code>\u3001<code>chmod u+x test1</code> \u6216 <code>chmod a+x test1</code>  \u53ef\u6dfb\u52a0\u6267\u884c\u6743\u9650\u3002</p>"},{"location":"blog/20191106/1-sh-basic/#\u547d\u4ee4\u884c\u53c2\u6570","title":"\u547d\u4ee4\u884c\u53c2\u6570","text":"<ol> <li><code>$#</code>\uff1a\u53c2\u6570\u4e2a\u6570\uff1b  </li> <li> <p><code>$0</code>\uff1a\u76f8\u5bf9\u6216\u7edd\u5bf9\u7684\u811a\u672c\u540d\u79f0\uff1b  </p> <ul> <li><code>$(dirname $0)</code> \u53d6\u811a\u672c\u76f8\u5bf9\u8def\u5f84\uff1b  </li> <li><code>$(basename $0)</code> \u53d6\u7eaf\u811a\u672c\u540d\u79f0\uff1b  </li> </ul> </li> <li> <p><code>$1</code>\u3001<code>$2</code>\u3001...\u3001<code>$9</code>\uff0c<code>${10}</code>\u3001<code>${11}</code>\u3001...\uff1a\u987a\u5e8f\u4f4d\u7f6e\u53c2\u6570\uff1b  </p> <ul> <li><code>${!#}</code> \u4ee3\u8868\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff1b</li> </ul> </li> <li> <p><code>$@</code>\uff08\u6216 <code>$*</code>\uff09: \u6240\u6709\u53c2\u6570\uff1b  </p> <ul> <li><code>$@</code> \u4ee3\u8868\u53c2\u6570\u6570\u7ec4\uff0c\u9075\u5faa\u7d22\u5f15\u89c4\u5219\u548c\u5207\u7247\u5199\u6cd5\uff0c</li> <li><code>${@:2}</code> \u8868\u793a\u4ece\u7d22\u5f152\u5f00\u59cb\u7684\u540e\u9762\u7684\u6240\u6709\u53c2\u6570\uff0c</li> <li><code>exec \"${@:2}\"</code> \u5219\u5c06\u540e\u9762\u6240\u6709\u7684\u53c2\u6570\u5f53\u505a\u547d\u4ee4\u6267\u884c\u3002</li> </ul> </li> </ol> <p>index\u53d8\u91cf\u8d4b\u503c\u7d22\u5f153\uff0c\u5219 <code>${!index}</code> \u8868\u793a\u5f15\u7528\u7b2c3\u4e2a\u53c2\u6570\u3002</p> <pre><code>#!/bin/bash\n\nindex=3\necho \"${!index}\"\n\neval opt3=\"\\$$index\"\necho \"$opt3\"\n</code></pre>"},{"location":"blog/20191106/1-sh-basic/#_\u548c_","title":"$@ \u548c $*","text":"<p>\u6709\u65f6\u5019\u9700\u8981\u6293\u53d6\u547d\u4ee4\u884c\u4e0a\u63d0\u4f9b\u7684\u6240\u6709\u53c2\u6570\uff0c\u4e0d\u9700\u8981\u57fa\u4e8e\u53d8\u91cf\u4e2a\u6570 <code>$#</code> \u8fdb\u884c\u904d\u5386\uff0c\u800c\u662f\u53ef\u4ee5\u57fa\u4e8e\u7279\u6b8a\u53d8\u91cf\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002 <code>$*</code> \u548c <code>$@</code> \u8fd9\u4e24\u4e2a\u53d8\u91cf\u90fd\u80fd\u591f\u5728\u5355\u4e2a\u53d8\u91cf\u4e2d\u5b58\u50a8\u6240\u6709\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u8f7b\u677e\u8bbf\u95ee\u6240\u6709\u7684\u547d\u4ee4\u884c\u53c2\u6570\u3002</p> <p><code>$*</code> \u53d8\u91cf\u4f1a\u5c06\u547d\u4ee4\u884c\u4e0a\u63d0\u4f9b\u7684\u6240\u6709\u53c2\u6570\u5f53\u4f5c\u4e00\u4e2a\u5355\u8bcd\u4fdd\u5b58\uff0c\u8fd9\u4e2a\u5355\u8bcd\u5305\u542b\u4e86\u547d\u4ee4\u884c\u4e2d\u51fa\u73b0\u7684\u6bcf\u4e00\u4e2a\u53c2\u6570\u503c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c<code>$*</code> \u53d8\u91cf\u4f1a\u5c06\u8fd9\u4e9b\u53c2\u6570\u89c6\u4e3a\u4e00\u4e2a\u6574\u4f53\uff0c\u800c\u4e0d\u662f\u591a\u4e2a\u4e2a\u4f53\u3002 <code>$@</code> \u53d8\u91cf\u4f1a\u5c06\u547d\u4ee4\u884c\u4e0a\u63d0\u4f9b\u7684\u6240\u6709\u53c2\u6570\u5f53\u4f5c\u540c\u4e00\u5b57\u7b26\u4e32\u4e2d\u7684\u591a\u4e2a\u72ec\u7acb\u7684\u5355\u8bcd\uff0c\u8fd9\u6837\u4f60\u5c31\u80fd\u591f\u901a\u8fc7for\u904d\u5386\u8bfb\u53d6\u6bcf\u4e2a\u53c2\u6570\u3002 \u8fd9\u4e24\u4e2a\u53d8\u91cf\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e0d\u592a\u5bb9\u6613\u7406\u89e3\uff0c\u901a\u8fc7\u4e0b\u9762\u7684\u793a\u4f8b\u6f14\u7ece\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u66f4\u597d\u5730\u7406\u89e3\u4e8c\u8005\u4e4b\u95f4\u7684\u533a\u522b\u3002</p> <p>\u4f46\u662f\u5728\u811a\u672c\u4e2d\uff0c\u5bf9\u4e8e\u53c2\u6570\u6570\u7ec4\u7684\u5207\u7247\u5199\u6cd5 <code>${*:2:3}</code> \u548c <code>${@:2:3}</code> \u662f\u7b49\u6548\u7684\uff0c\u90fd\u662f\u8bfb\u53d6 $2 \u5f00\u59cb\u76843\u4e2a\u5143\u7d20\u3002</p> <pre><code>$ cat test11.sh\n\n#!/bin/bash\n# testing $* and $@ \n#\necho\necho \"Using the \\$* method: $*\"\necho\necho \"Using the \\$@ method: $@\"\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>$ ./test11.sh rich barbara katie jessica\n\nUsing the $* method: rich barbara katie jessica\n\nUsing the $@ method: rich barbara katie jessica\n</code></pre> <p>\u4ece\u8868\u9762\u4e0a\u770b\uff0c\u4e24\u4e2a\u53d8\u91cf\u4ea7\u751f\u4e86\u540c\u6837\u7684\u8f93\u51fa\uff0c\u90fd\u663e\u793a\u51fa\u4e86\u6240\u6709\u547d\u4ee4\u884c\u53c2\u6570\u3002</p> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\uff0c\u901a\u8fc7for\u5faa\u73af\u904d\u5386\u53ef\u4ee5\u770b\u51fa\u4e8c\u8005\u7684\u5dee\u5f02\u3002</p> <pre><code>#!/bin/bash\n# testing $* and $@\n#\necho\ncount=1\n#\nfor param in \"$*\"; do\n    echo \"\\$* Parameter #$count = $param\"\n    count=$((count + 1))\ndone\n#\necho\ncount=1\n#\nfor param in \"$@\"; do\n    echo \"\\$@ Parameter #$count = $param\"\n    count=$((count + 1))\ndone\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>$ ./test12.sh rich barbara katie jessica\n\n$* Parameter #1 = rich barbara katie jessica\n\n$@ Parameter #1 = rich\n$@ Parameter #2 = barbara\n$@ Parameter #3 = katie\n$@ Parameter #4 = jessica\n</code></pre> <p>\u901a\u8fc7\u4f7f\u7528for\u547d\u4ee4\u904d\u5386\u8fd9\u4e24\u4e2a\u7279\u6b8a\u53d8\u91cf\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u4eec\u662f\u5982\u4f55\u4e0d\u540c\u5730\u5904\u7406\u547d\u4ee4\u884c\u53c2\u6570\u7684\u3002 <code>$*</code> \u53d8\u91cf\u4f1a\u5c06\u6240\u6709\u53c2\u6570\u5f53\u6210\u5355\u4e2a\u53c2\u6570\uff1b\u800c <code>$@</code> \u53d8\u91cf\u4f1a\u5355\u72ec\u5904\u7406\u6bcf\u4e2a\u53c2\u6570\u3002 \u6545\u901a\u5e38\u57fa\u4e8e <code>$@</code> \u904d\u5386\u8bfb\u53d6\u547d\u4ee4\u884c\u53c2\u6570\u3002</p> <p>\u6211\u4eec\u518d\u6765\u770b\u770b\u4e0b\u5217\u6d4b\u8bd5\u7a0b\u5e8f</p> <pre><code>#!/usr/bin/env bash\n\nmainAt() {\n  echo \"mainAt param count = $#\"\n  count=1\n  for param in \"$@\"; do\n    echo \"\\$@ Parameter #$count = $param\"\n    count=$((count + 1))\n  done\n}\n\nmainAs() {\n  echo \"mainAs param count = $#\"\n  count=1\n  # for 1\n  for param in $*; do\n  # for 2\n  # for param in \"$*\"; do\n    echo \"\\$* Parameter #$count = $param\"\n    count=$((count + 1))\n  done\n}\n\nmainAt \"$@\"\n# mainAs 1\nmainAs $*\n# mainAs 2\n# mainAs \"$*\"\n</code></pre> <p>\u4ece\u8fd0\u884c\u7ed3\u679c\u53ef\u77e5\uff0c\u5f53\u7ed9\u51fd\u6570\u4f20\u9012 <code>$*</code> \u548c for \u5faa\u73af\u4e2d\u5f15\u7528 <code>$*</code> \u65f6\uff0c\u90fd\u6ca1\u52a0\u5f15\u53f7\uff0cfor\u904d\u5386\u6548\u679c\u624d\u7b26\u5408\u9884\u671f\u3002</p> <p>\u5982\u679c\u7ed9\u51fd\u6570\u4f20\u9012 <code>\"$*\"</code>\u52a0\u4e86\u53cc\u5f15\u53f7\uff0c\u6216\u5728for\u5faa\u73af\u7684 <code>$*</code> \u52a0\u4e86\u53cc\u5f15\u53f7\uff0c\u90a3\u4e48\u5c06\u4f1a\u88ab\u5f53\u6210\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u4e0d\u4f1a\u6309\u7a7a\u683c\u5207\u5272\u6570\u7ec4\u3002</p> <p>SC2066: Since you double quoted this, it will not word split, and the loop will only run once.</p> <pre><code># mainAs 1, for 1\n$ ./test-array-param.sh p q r\nmainAt param count = 3\n$@ Parameter #1 = p\n$@ Parameter #2 = q\n$@ Parameter #3 = r\nmainAs param count = 3\n$* Parameter #1 = p\n$* Parameter #2 = q\n$* Parameter #3 = r\n\n# mainAs 2, for 1\n$ ./test-array-param.sh p q r\nmainAt param count = 3\n$@ Parameter #1 = p\n$@ Parameter #2 = q\n$@ Parameter #3 = r\nmainAs param count = 1\n$* Parameter #1 = p\n$* Parameter #2 = q\n$* Parameter #3 = r\n\n# mainAs 1, for 2\n$ ./test-array-param.sh p q r\nmainAt param count = 3\n$@ Parameter #1 = p\n$@ Parameter #2 = q\n$@ Parameter #3 = r\nmainAs param count = 3\n$* Parameter #1 = p q r\n\n# mainAs 2, for 2\n$ ./test-array-param.sh p q r\nmainAt param count = 3\n$@ Parameter #1 = p\n$@ Parameter #2 = q\n$@ Parameter #3 = r\nmainAs param count = 1\n$* Parameter #1 = p q r\n</code></pre>"},{"location":"blog/20191106/1-sh-basic/#\u6267\u884c\u811a\u672c","title":"\u6267\u884c\u811a\u672c","text":"<p>bash shell\u7a0b\u5e8f\u53ef\u4f7f\u7528\u547d\u4ee4\u884c\u53c2\u6570\u4fee\u6539shell\u542f\u52a8\u65b9\u5f0f\u3002\u4e0b\u8868\u5217\u4e3e\u4e86bash\u4e2d\u5e38\u7528\u7684\u542f\u52a8\u53c2\u6570\uff1a</p> <p></p>"},{"location":"blog/20191106/1-sh-basic/#\u7528\u6237\u8f93\u5165\u53c2\u6570","title":"\u7528\u6237\u8f93\u5165\u53c2\u6570","text":"<p>read \u6307\u5b9a\u63a5\u6536\u53d8\u91cf\u7684\u4e2a\u6570\u5e94\u4e0e\u5b9e\u9645\u8f93\u5165\u7684\u53c2\u6570\u4e2a\u6570\u4e00\u81f4\uff0c\u5982\u679c\u53d8\u91cf\u6570\u91cf\u4e0d\u591f\uff0c\u5269\u4e0b\u7684\u6570\u636e\u5c31\u5168\u90e8\u5206\u914d\u7ed9\u6700\u540e\u4e00\u4e2a\u53d8\u91cf\u3002</p>"},{"location":"blog/20191106/1-sh-basic/#echo_-n__read","title":"echo -n + read","text":"<p>unix/POSIX - echo FreeBSD/Darwin - echo </p> <p>linux - echo(1) - echo(1p) debian/Ubuntu - echo </p> <p>echo(1) - display a line of text</p> <pre><code> -n    Do not print the trailing newline characte.\n</code></pre> <p><code>echo -n</code> \u4e0d\u6362\u884c\u63d0\u793a\u52a0 <code>read</code> \u6355\u83b7\u53d8\u91cf\uff1a</p> <pre><code>#!/bin/bash\n\necho -n \"PLS input the num (1-10): \"\nread num\nlet i=num+5\necho $i\n</code></pre>"},{"location":"blog/20191106/1-sh-basic/#read_-p","title":"read -p","text":"<p>unix/POSIX - read FreeBSD/Darwin - read is a shell builtin  </p> <p>linux - read(1p) - read(2) - read(3p) debian/Ubuntu - read </p> <p>read(1p) \u2014 read a line from standard input</p> <p>SYNOPSIS: <code>read [\u2212r] var...</code></p> <p>The read utility shall read a single line from standard input.</p> <p>\u53e6\u5916\u4e00\u79cd\u65b9\u5f0f\u66f4\u7b80\u6d01\uff0c<code>read</code> \u6307\u5b9a <code>-p</code> \u9009\u9879\uff0c\u63d0\u793a\u884c\u7eed\u63a5\u8f93\u5165\u6355\u83b7\u5230\u53d8\u91cf\uff1a</p> <pre><code>#!/bin/bash\n\nread -p \"PLS input the num (1-10): \" num\nlet i=num+5\necho $i\n</code></pre> <p>\u5982\u679c read \u4e0d\u6307\u5b9a\u53d8\u91cf\uff0c\u5219\u9ed8\u8ba4\u653e\u8fdb\u73af\u5883\u53d8\u91cf <code>REPLY</code> \u4e2d\u3002</p>"},{"location":"blog/20191106/1-sh-basic/#read_file_or_stdin","title":"read file or stdin","text":"<p>\u5f88\u591a\u7cfb\u7edf\u81ea\u5e26\u547d\u4ee4\u7684\u8bbe\u8ba1\u65f6\uff0c\u5b9e\u73b0\u4e86\u5f88\u7075\u6d3b\u7684\u4f20\u53c2\u673a\u5236\uff0c\u9664\u4e86\u652f\u6301\u8bfb\u53d6\u6587\u4ef6\u6570\u636e\u8fdb\u884c\u5904\u7406\u5916\uff0c\u4e5f\u53ef\u652f\u6301\u8bfb\u53d6\u952e\u76d8\u8f93\u5165stdin\u4f5c\u4e3a\u5f85\u5904\u7406\u6570\u636e\u3002</p> <ul> <li><code>xxd</code>: If no infile is given, standard input is read.</li> <li><code>hexdump</code>: displays the specified files, or the standard input.</li> <li><code>shasum</code>: With no FILE, or when FILE is -, read standard input.</li> <li><code>cat</code> : If file is a single dash (<code>-</code>) or absent, cat reads from the standard input.</li> </ul> <p>How to read from a file or standard input in Bash</p> <p>\u4ee5\u4e0b\u811a\u672c\u5b9e\u73b0\u4e86\u7c7b\u4f3c\u7684\u673a\u5236\uff1a\u5982\u679c\u4f20\u5165\u4e86\u53c2\u6570$1\uff0c\u5219\u5c06\u5176\u4f5c\u4e3aread\u8f93\u5165\uff0c\u5426\u5219\u7b49\u5f85\u63a5\u6536stdin\u6807\u51c6\u8f93\u5165\u3002</p> <pre><code>#!/bin/bash\n\n# https://stackoverflow.com/a/7126967\n\ncat \"${1:-/dev/stdin}\" &gt; \"${2:-/dev/stdout}\"\n</code></pre> <pre><code>#!/bin/bash\n\n# https://stackoverflow.com/a/7045517\n\n# Read either the first argument or from stdin\nwhile read line\ndo\n  echo \"$line\"\ndone &lt; \"${1:-/dev/stdin}\"\n</code></pre> <p>To read from the file or stdin (if argument is not present), you can extend it to:</p> <pre><code>#!/bin/bash\n\n# https://stackoverflow.com/a/28786207\n\nfile=${1--} # POSIX-compliant; ${1:--}\nwhile IFS= read -r line; do\n  printf '%s\\n' \"$line\" # Or: env POSIXLY_CORRECT=1 echo \"$line\"\ndone &lt; &lt;(cat -- \"$file\")\n</code></pre> <p><code>FILE=${1:--}</code> \u53ef\u7406\u89e3\u4e3a <code>[ \"$1\" ] &amp;&amp; FILE=$1 || FILE=\"-\"</code>\u3002</p> <p>If no arguments are given, set <code>-</code>(stdin) as the first positional parameter.</p> <pre><code>#!/bin/bash\n\n# https://stackoverflow.com/a/28788047\n\n(($#)) || set -- -\nwhile (($#)); do\n   { [[ $1 = - ]] || exec &lt; \"$1\"; } &amp;&amp;\n   while read -r; do\n      printf '%s\\n' \"$REPLY\"\n   done\n   shift\ndone\n</code></pre> <p>\u6d4b\u8bd5\u7528\u4f8b\uff1a</p> <ol> <li><code>./read_by_line.sh README.md</code>\uff1a\u6253\u5370\u6587\u4ef6\u3002  </li> <li><code>./read_by_line.sh</code>\uff1a\u7b49\u5f85\u952e\u76d8\u8f93\u5165\uff0c\u7136\u540e\u56de\u663e\u3002  </li> <li><code>./read_by_line.sh &lt;&lt; eof</code>\uff1a\u7b49\u5f85\u952e\u76d8\u8f93\u5165\u5185\u5bb9\uff0c\u8f93\u5165eof\u7ed3\u675f\uff0c\u7136\u540e\u56de\u663e\u3002  </li> <li><code>./read_by_line.sh &lt;&lt;&lt; hello</code>\uff1a\u6253\u5370\u56de\u663e\u3002  </li> </ol>"},{"location":"blog/20191106/1-sh-basic/#read_\u7684\u5176\u4ed6\u9009\u9879","title":"read \u7684\u5176\u4ed6\u9009\u9879","text":"<ul> <li><code>read -t seconds</code>\uff1a\u6307\u5b9a\u591a\u5c11\u79d2\u540e\u63d0\u793a\u8d85\u65f6\uff1b  </li> <li><code>read -s</code>\uff1a\u9690\u85cf\u65b9\u5f0f\u8bfb\u53d6\uff0c\u4e0d\u56de\u663e\u5bc6\u7801\u7b49\u9690\u79d8\u6570\u636e\uff08\u5b9e\u9645\u4e0a\u662f\u5c06\u6587\u672c\u989c\u8272\u8bbe\u7f6e\u548c\u80cc\u666f\u8272\u4e00\u81f4\uff09\u3002  </li> </ul>"},{"location":"blog/20191106/1-sh-basic/#\u811a\u672c\u53c2\u6570\u89e3\u6790","title":"\u811a\u672c\u53c2\u6570\u89e3\u6790","text":"<p>\u5982\u679c\u60f3\u66f4\u4e13\u4e1a\u7684\u5904\u7406\u8f93\u5165\u53c2\u6570\u5217\u8868\uff0c\u53ef\u4ee5\u7ed3\u5408 <code>shift</code> \u547d\u4ee4\u3001<code>getopts</code>\uff08getopt\uff09\u63d0\u53d6\u5206\u79bb\u53c2\u6570\uff0c\u5177\u4f53\u53c2\u8003 argparse \u4e00\u8282\u3002</p>"},{"location":"blog/20191106/1-sh-basic/#\u76f8\u5173\u53c2\u8003","title":"\u76f8\u5173\u53c2\u8003","text":"<p>\u4e00\u7bc7\u6559\u4f1a\u4f60\u519990%\u7684shell\u811a\u672c \u962e\u4e00\u5cf0 - \u300aBash \u811a\u672c\u6559\u7a0b\u300b </p> <p>explainshell Shell Tips! Shell Scripting Tutorial </p> <p>Bash-lib by aks </p>"},{"location":"blog/20191106/10-sh-map/","title":"Linux Shell Program - map","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u5b57\u5178\u5e38\u7528\u64cd\u4f5c\u3002</p>"},{"location":"blog/20191106/10-sh-map/#linux","title":"linux","text":"<p>raspi Ubuntu Desktop 21.10 \u4e0a\u81ea\u5e26\u7684 bash shell \u7248\u672c\u662f 5.1.8\uff1a</p> <pre><code>rpi4b-ubuntu% bash --version\nGNU bash, version 5.1.8(1)-release (aarch64-unknown-linux-gnu)\nCopyright (C) 2020 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\n\nThis is free software; you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n</code></pre> <p>The usage of Linux shell map Linux Shell\uff1aMap\u7684\u7528\u6cd5 </p>"},{"location":"blog/20191106/10-sh-map/#macos","title":"macOS","text":"<p>Mac\u4e0bshell\u547d\u4ee4\u652f\u6301map</p> <p>macOS \u81ea\u5e26\u7684bash\u662f3.x\u7248\u672c\u7684\uff1a</p> <pre><code>$ bash --version\nGNU bash, version 3.2.57(1)-release (x86_64-apple-darwin20)\nCopyright (C) 2007 Free Software Foundation, Inc.\n</code></pre> <p>shell\u4e2d\u7684 declare \u547d\u4ee4\u4e0d\u652f\u6301 <code>-A</code> \u8fd9\u4e2a\u53c2\u6570\uff0c\u4f1a\u62a5\u4e0b\u9762\u7684\u9519\u8bef\uff1a</p> <pre><code>declare: -A: invalid option\ndeclare: usage: declare [-afFirtx] [-p] [name[=value] ...]\n</code></pre> <p>\u53ef\u8003\u8651\u901a\u8fc7 brew \u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684bash</p> <pre><code>brew install bash\n</code></pre> <p>\u7136\u540e\uff0csh\u811a\u672c\u6587\u4ef6\u5f00\u5934\u7684 Shebang \u6ce8\u610f\u4ece <code>#!/bin/bash</code> \u66ff\u6362\u6210 <code>#!/usr/local/bin/bash</code>\uff0c\u5426\u5219\u8fd8\u662f\u7528\u65e7\u7248\u672c\u7684bash\u6765\u6267\u884c\u3002</p> <p>Mac\u73af\u5883\u4e0bshell\u811a\u672c\u4e2d\u7684map</p> <p>macOS \u4e0b\u6267\u884c sh \u811a\u672c\uff0cdeclare -A \u62a5\u9519\u4e0d\u652f\u6301\u8be5\u9009\u9879\uff1a</p> <pre><code>bash-3.2$ sh cmd.sh\nd.sh: line 2: declare: -A: invalid option\ndeclare: usage: declare [-afFirtx] [-p] [name[=value] ...]\n</code></pre> <p>macOS \u7684\u9ed8\u8ba4 Bash \u8fd8\u662f3.x\u7248\u672c\uff0c\u4e0d\u652f\u6301map\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u3002</p> <p>\u6240\u4ee5\u6709\u4e24\u79cd\u89e3\u51b3\u65b9\u6848\uff1a</p> <ol> <li>\u5347\u7ea7bash\u5230 4.x \u4ee5\u4e0a\u7248\u672c\uff1b  </li> <li>\u7528\u5176\u4ed6\u65b9\u5f0f\uff1a\u6bd4\u5982 if elif \u53bb\u5230\u8fbe\u76f8\u540c\u7684\u7ed3\u679c\uff1b  </li> </ol>"},{"location":"blog/20191106/11-argparse/","title":"Linux Shell Program - argparse","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u53c2\u6570\u89e3\u6790\uff08argparse\uff09\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#shift\u5de6\u79fb\u53d8\u91cf","title":"shift\u5de6\u79fb\u53d8\u91cf","text":"<p>bash shell\u5de5\u5177\u7bb1\u4e2d\u53e6\u4e00\u4ef6\u5de5\u5177\u662fshift\u547d\u4ee4\uff0c\u8be5\u547d\u4ee4\u80fd\u591f\u7528\u6765\u64cd\u4f5c\u547d\u4ee4\u884c\u53c2\u6570\u3002 \u8ddf\u5b57\u9762\u4e0a\u7684\u610f\u601d\u4e00\u6837\uff0cshift\u547d\u4ee4\u4f1a\u6839\u636e\u5b83\u4eec\u7684\u76f8\u5bf9\u4f4d\u7f6e\u6765\u79fb\u52a8\u547d\u4ee4\u884c\u53c2\u6570\u3002</p> <p>shift\u547d\u4ee4\u4f1a\u5c06\u6bcf\u4e2a\u53c2\u6570\u53d8\u91cf\u5411\u5de6\u79fb\u52a8\u4e00\u4e2a\u4f4d\u7f6e\uff08\u6709\u70b9\u50cf\u4e8c\u8fdb\u5236\u4f4d\u79fb <code>&lt;&lt;</code> \uff09\uff1a \u53d8\u91cf $3 \u7684\u503c\u4f1a\u79fb\u5230 $2 \u4e2d\uff0c\u53d8\u91cf $2 \u7684\u503c\u4f1a\u79fb\u5230 $1 \u4e2d\uff0c\u800c\u539f\u6765\u53d8\u91cf $1 \u7684\u503c\u5219\u4f1a\u5411\u5de6\u6ea2\u51fa\u3002</p> <p>\u6ce8\u610f\uff1a\u53d8\u91cf$0\u7684\u503c\uff0c\u4e5f\u5c31\u662f\u7a0b\u5e8f\u540d\uff0c\u4e0d\u4f1a\u6539\u53d8\u3002</p> <p>\u8fd9\u662f\u904d\u5386\u547d\u4ee4\u884c\u53c2\u6570\u7684\u53e6\u4e00\u4e2a\u597d\u65b9\u6cd5\uff0c\u5c24\u5176\u662f\u5728\u4e0d\u77e5\u9053\u53c2\u6570\u4e2a\u6570\u65f6\u3002 \u4f60\u53ef\u4ee5\u53ea\u64cd\u4f5c\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u79fb\u52a8\u53c2\u6570\uff0c\u7136\u540e\u7ee7\u7eed\u64cd\u4f5c\u7b2c\u4e00\u4e2a\u53c2\u6570\u3002</p> <p>\u4f7f\u7528 shift \u547d\u4ee4\u7684\u65f6\u5019\u8981\u5c0f\u5fc3\uff1a\u5982\u679c\u67d0\u4e2a\u53c2\u6570\u88ab\u79fb\u51fa\uff0c\u5b83\u7684\u503c\u5c31\u88ab\u4e22\u5f03\u4e86\uff0c\u65e0\u6cd5\u518d\u6062\u590d\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u89e3\u91ca\u4e86\u5176\u5de5\u4f5c\u673a\u5236\uff1a</p> <ol> <li>\u4ee5\u7b2c\u4e00\u4e2a\u53c2\u6570\u53d8\u91cf\u503c\u975e\u7a7a\u4f5c\u4e3awhile\u5faa\u73af\u6761\u4ef6\uff1b  </li> <li>\u5f53 $1 \u4e3a\u7a7a\uff08\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3a\u96f6\uff09\u65f6\uff0c\u5faa\u73af\u7ed3\u675f\u3002  </li> </ol> <pre><code>$ cat test13.sh\n\n#!/bin/bash\n# demonstrating the shift command\n\necho\ncount=1\nwhile [ -n \"$1\" ]; do\n    echo \"Parameter #$count = $1\"\n    count=$((count + 1))\n    shift\ndone\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>$ ./test13.sh rich barbara katie jessica\n\nParameter #1 = rich\nParameter #2 = barbara\nParameter #3 = katie\nParameter #4 = jessica\n</code></pre> <p>\u53e6\u5916\uff0c\u4f60\u4e5f\u53ef\u4ee5\u4e00\u6b21\u6027\u79fb\u52a8\u591a\u4e2a\u4f4d\u7f6e\uff0c\u53ea\u9700\u8981\u7ed9shift\u547d\u4ee4\u63d0\u4f9b\u4e00\u4e2a\u4f4d\u79fb\u53c2\u6570\uff0c\u6307\u660e\u8981\u79fb\u52a8\u7684\u4f4d\u7f6e\u6570\u5c31\u884c\u4e86\u3002</p> <pre><code>$ cat test14.sh\n\n#!/bin/bash\n# demonstrating a multi-position shift \n#\necho\necho \"The original parameters: $*\"\nshift 2\necho \"Here's the new first parameter: $1\"\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>$ ./test14.sh -b -c -d -e -f\n\nThe original parameters: -b -c -d -e -f\nHere's the new first parameter: -d\n</code></pre>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u5224\u65ad\u9009\u9879\u5f00\u5173","title":"\u5224\u65ad\u9009\u9879\u5f00\u5173","text":"<p>bash \u63d0\u4f9b\u7684\u5f88\u591a\u547d\u4ee4\u4f1a\u540c\u65f6\u63d0\u4f9b\u5f00\u5173\u9009\u9879\u548c\u952e\u503c\u53c2\u6570\uff0c\u9009\u9879\u4e00\u822c\u662f\u8ddf\u5728\u5355\u7834\u6298\u7ebf\uff08<code>-</code>\uff09\u540e\u9762\u7684\u5355\u4e2a\u5b57\u6bcd\uff08\u6216\u5b57\u7b26\u4e32\uff09\u3002</p> <p>bash \u5927\u90e8\u5206\u547d\u4ee4\uff0c\u4ee5 <code>--</code> \u4f5c\u4e3a\u9009\u9879\u548c\u53c2\u6570\u7684\u5206\u754c\u7b26\uff1a<code>--</code> \u524d\u4e3a\u9009\u9879\uff0c<code>--</code> \u540e\u4e3a\u6587\u4ef6\u540d\u6216\u5176\u4ed6\u53c2\u6570\u3002</p> <p>\u5177\u4f53\u53c2\u8003 man bash OPTIONS:</p> <p><code>\u2212\u2212</code>: A <code>\u2212\u2212</code> signals the end of options and disables further option processing.  Any arguments after the <code>\u2212\u2212</code> are treated as filenames and arguments.  An argument of <code>\u2212</code> is equivalent to <code>\u2212\u2212</code>.</p> <p>\u5728 SHELL BUILTIN COMMANDS \u5f00\u5934\u5373\u9610\u8ff0\u4e86\u5185\u7f6e\u547d\u4ee4\u7684\u9009\u9879\u548c\u53c2\u6570\u4ee5 <code>--</code> \u5206\u9694\u7684\u60ef\u4f8b\u3002</p> <p>Unless otherwise noted, each builtin command documented in this section as accepting options preceded by <code>\u2212</code> accepts <code>\u2212\u2212</code> to signify the end of the options.  For example, the <code>:</code>, <code>true</code>, <code>false</code>, and <code>test</code> builtins do not accept options.</p> <p>\u4e00\u822c\uff0c\u53ef\u4ee5\u7528case\u6765\u68c0\u67e5\u6bcf\u4e2a\u9009\u9879\u662f\u5426\u6709\u6548\uff0c\u8fdb\u800c\u6267\u884c\u5bf9\u5e94\u7684\u547d\u4ee4\u3002 \u4e0d\u7ba1\u9009\u9879\u6309\u4ec0\u4e48\u987a\u5e8f\u51fa\u73b0\u5728\u547d\u4ee4\u884c\u4e0a\uff0c\u8fd9\u79cd\u65b9\u6cd5\u90fd\u9002\u7528\u3002</p> <pre><code>$ cat test15.sh\n\n#!/bin/bash\n# extracting command line options as parameters\n#\necho\nwhile [ -n \"$1\" ]; do\n    case \"$1\" in\n    -a) echo \"Found the -a option\" ;;\n    -b) echo \"Found the -b option\" ;;\n    -c) echo \"Found the -c option\" ;;\n    *) echo \"$1 is not an option\" ;;\n    esac\n    shift\ndone\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>$ ./test15.sh -a -b -c -d\n\nFound the -a option\nFound the -b option\nFound the -c option\n-d is not an option\n\n$ ./test15.sh -d -c -a\n\n-d is not an option\nFound the -c option\nFound the -a option\n</code></pre>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u9009\u9879\u548c\u53c2\u6570\u5206\u79bb","title":"\u9009\u9879\u548c\u53c2\u6570\u5206\u79bb","text":"<p>\u7ecf\u5e38\u4f1a\u9047\u5230\u5728shell\u811a\u672c\u4e2d\u540c\u65f6\u4f7f\u7528\u9009\u9879\u548c\u53c2\u6570\u7684\u60c5\u51b5\uff0cLinux\u4e2d\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\u7684\u6807\u51c6\u65b9\u5f0f\u662f\u7528\u7279\u6b8a\u5b57\u7b26\u6765\u5c06\u4e8c\u8005\u5206\u5f00\u3002 \u5bf9Linux\u6765\u8bf4\uff0c\u8fd9\u4e2a\u7279\u6b8a\u5b57\u7b26\u662f\u53cc\u7834\u6298\u7ebf\uff08<code>--</code>\uff09\uff0c\u7528\u6765\u8868\u660e\u9009\u9879\u5217\u8868\u7ed3\u675f\u548c\u666e\u901a\u53c2\u6570\u5f00\u59cb\u3002 \u5728\u53cc\u7834\u6298\u7ebf\u4e4b\u540e\uff0c\u811a\u672c\u5c06\u5269\u4e0b\u7684\u547d\u4ee4\u884c\u53c2\u6570\u5f53\u4f5c\u53c2\u6570\uff0c\u800c\u4e0d\u662f\u9009\u9879\u6765\u5904\u7406\u4e86\u3002 \u8981\u68c0\u67e5\u53cc\u7834\u6298\u7ebf\uff0c\u53ea\u8981\u5728case\u8bed\u53e5\u4e2d\u52a0\u4e00\u9879\u5c31\u884c\u4e86\u3002</p> <p>\u4ee5\u4e0b\u6d4b\u8bd5\u811a\u672c\u4e2d\uff0c\u5728\u9047\u5230\u53cc\u7834\u6298\u7ebf\u65f6\uff0c\u811a\u672c\u7528break\u547d\u4ee4\u6765\u8df3\u51fawhile\u5faa\u73af\u3002 \u7531\u4e8e\u8fc7\u65e9\u5730\u8df3\u51fa\u4e86\u5faa\u73af\uff0c\u9700\u8981\u518d\u52a0\u4e00\u6761shift\u547d\u4ee4\u6765\u5c06\u53cc\u7834\u6298\u7ebf\u79fb\u51fa\u53c2\u6570\u53d8\u91cf\u3002 \u540e\u7eed\u4ece$1\u5f00\u59cb\u5c31\u53ef\u4ee5\u6309\u7167\u666e\u901a\u53c2\u6570\u89e3\u6790\u3002</p> <pre><code>$ cat test16.sh\n\n#!/bin/bash\n# extracting options and parameters\n\necho\nwhile [ -n \"$1\" ]; do\n    case \"$1\" in\n    -a) echo \"Found the -a option\" ;;\n    -b) echo \"Found the -b option\" ;;\n    -c) echo \"Found the -c option\" ;;\n    --)\n        shift\n        break\n        ;;\n    *) echo \"$1 is not an option\" ;;\n    esac\n    shift\ndone\n#\ncount=1\nfor param in $@; do\n    echo \"Parameter #$count: $param\"\n    count=$((count + 1))\ndone\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>$ ./test16.sh -c -a -b test1 test2 test3\n\nFound the -c option\nFound the -a option\nFound the -b option\ntest1 is not an option\ntest2 is not an option\ntest3 is not an option\n\n$ ./test16.sh -c -a -b -- test1 test2 test3\n\nFound the -c option\nFound the -a option\nFound the -b option\nParameter #1: test1\nParameter #2: test2\nParameter #3: test3\n</code></pre> <p>\u5f53\u811a\u672c\u9047\u5230\u53cc\u7834\u6298\u7ebf\u65f6\uff0c\u5b83\u4f1a\u505c\u6b62\u5904\u7406\u9009\u9879\uff0c\u5e76\u5c06\u5269\u4e0b\u7684\u53c2\u6570\u90fd\u5f53\u4f5c\u547d\u4ee4\u884c\u53c2\u6570\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u5904\u7406\u5e26\u503c\u7684\u9009\u9879","title":"\u5904\u7406\u5e26\u503c\u7684\u9009\u9879","text":"<p>\u6709\u4e9b\u9009\u9879\u4f1a\u5e26\u4e0a\u4e00\u4e2a\u989d\u5916\u7684\u53c2\u6570\u503c\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u547d\u4ee4\u884c\u770b\u8d77\u6765\u5982\u4e0b\uff1a</p> <pre><code>$ ./testing.sh -a test1 -b -c -d test2\n</code></pre> <p>\u5f53\u547d\u4ee4\u884c\u9009\u9879\u8981\u6c42\u989d\u5916\u7684\u53c2\u6570\u65f6\uff0c \u811a\u672c\u5fc5\u987b\u80fd\u68c0\u6d4b\u5230\u5e76\u6b63\u786e\u5904\u7406\u3002</p> <p>\u4e0b\u9762\u662f\u5982\u4f55\u5904\u7406\u7684\u4f8b\u5b50\uff1acase\u8bed\u53e5\u5b9a\u4e49\u4e86\u4e09\u4e2a\u9009\u9879\uff0c<code>-b</code> \u9009\u9879\u8fd8\u9700\u8981\u4e00\u4e2a\u989d\u5916\u7684\u53c2\u6570\u503c\u3002 \u5f53\u524d\u5904\u7f6e\u9009\u9879\u662f <code>$1</code>\uff0c\u53c2\u6570\u503c\u662f\u7d27\u968f\u5176\u540e\u7684 <code>$2</code>\uff0c\u53ef\u4ece <code>$2</code> \u4e2d\u63d0\u53d6\u51fa\u53c2\u6570\u503c\u3002 \u56e0\u4e3a\u8fd9\u4e2a\u9009\u9879\u5360\u7528\u4e86\u4e24\u4e2a\u53c2\u6570\u4f4d\uff0c\u6240\u4ee5\u8fd8\u9700\u8981\u4f7f\u7528shift\u547d\u4ee4\uff0c\u6d88\u9664\u989d\u5916\u53c2\u6570\u5360\u4f4d\u3002</p> <pre><code>$ cat test17.sh\n\n#!/bin/bash\n# extracting command line options and values\n\necho\nwhile [ -n \"$1\" ]; do\n    case \"$1\" in\n    -a) echo \"Found the -a option\" ;;\n    -b)\n        param=\"$2\"\n        echo \"Found the -b option, with parameter value $param\"\n        shift\n        ;;\n    -c) echo \"Found the -c option\" ;;\n    --)\n        shift\n        break\n        ;;\n    *) echo \"$1 is not an option\" ;;\n    esac\n    shift\ndone\n#\ncount=1\nfor param in \"$@\"; do\n    echo \"Parameter #$count: $param\"\n    count=$((count + 1))\ndone\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>$ ./test17.sh -a -b test1 -d\n\nFound the -a option\nFound the -b option, with parameter value test1\n-d is not an option\n\n$ ./test17.sh -b test1 -a -d\n\nFound the -b option, with parameter value test1\nFound the -a option\n-d is not an option\n</code></pre> <p>\u73b0\u5728shell\u811a\u672c\u4e2d\u5df2\u7ecf\u6709\u4e86\u5904\u7406\u547d\u4ee4\u884c\u9009\u9879\u7684\u57fa\u672c\u80fd\u529b\uff0c\u4f46\u8fd8\u6709\u4e00\u4e9b\u9650\u5236\u3002 \u6bd4\u5982\uff0c\u5982\u679c\u4f60\u60f3\u5c06\u591a\u4e2a\u9009\u9879\u653e\u8fdb\u4e00\u4e2a\u53c2\u6570\u4e2d\u65f6\uff0c\u5b83\u5c31\u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c\u4e86\u3002</p> <pre><code>$ ./test17.sh -ac\n-ac is not an option\n</code></pre> <p>\u5728Linux\u4e2d\uff0c\u5408\u5e76\u9009\u9879\u662f\u4e00\u79cd\u5f88\u5e38\u89c1\u7684\u5199\u6cd5\uff0c\u5efa\u8bae\u63d0\u4f9b\u8fd9\u79cd\u5bf9\u7528\u6237\u66f4\u53cb\u597d\u7684\u7279\u6027\u652f\u6301\u3002 \u5e78\u597d\uff0c\u6709\u53e6\u5916\u4e00\u79cd\u5904\u7406\u9009\u9879\u7684\u65b9\u6cd5\u80fd\u591f\u5e2e\u5fd9\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u4f7f\u7528_getopt_\u547d\u4ee4","title":"\u4f7f\u7528 getopt \u547d\u4ee4","text":"<p>getopt \u547d\u4ee4\u662f\u4e00\u4e2a\u5728\u5904\u7406\u547d\u4ee4\u884c\u9009\u9879\u548c\u53c2\u6570\u65f6\u975e\u5e38\u65b9\u4fbf\u7684\u5de5\u5177\u3002 \u5b83\u80fd\u591f\u8bc6\u522b\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u4ece\u800c\u5728\u811a\u672c\u4e2d\u66f4\u65b9\u4fbf\u5730\u89e3\u6790\u51fa\u9009\u9879\u53c2\u6570\u3002</p> <p>getopt\u547d\u4ee4\u53ef\u4ee5\u63a5\u53d7\u4e00\u7cfb\u5217\u4efb\u610f\u5f62\u5f0f\u7684\u547d\u4ee4\u884c\u9009\u9879\u548c\u53c2\u6570\uff0c\u5e76\u81ea\u52a8\u5c06\u5b83\u4eec\u8f6c\u6362\u6210\u9002\u5f53\u7684\u683c\u5f0f\u3002 \u5b83\u7684\u547d\u4ee4\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>getopt optstring parameters\n</code></pre> <p><code>optstring</code> \u662f\u8fd9\u4e2a\u8fc7\u7a0b\u7684\u5173\u952e\u6240\u5728\uff0c\u5b83\u5b9a\u4e49\u4e86\u547d\u4ee4\u884c\u6709\u6548\u7684\u9009\u9879\u5b57\u6bcd\uff0c\u8fd8\u5b9a\u4e49\u4e86\u54ea\u4e9b\u9009\u9879\u5b57\u6bcd\u9700\u8981\u5e26\u53c2\u6570\u503c\u3002</p> <ul> <li>\u9996\u5148\uff0c\u5728optstring\u4e2d\u5217\u51fa\u4f60\u8981\u5728\u811a\u672c\u4e2d\u7528\u5230\u7684\u6bcf\u4e2a\u547d\u4ee4\u884c\u9009\u9879\u5b57\u6bcd\u3002</li> <li>\u7136\u540e\uff0c\u5728\u6bcf\u4e2a\u9700\u8981\u53c2\u6570\u503c\u7684\u9009\u9879\u5b57\u6bcd\u540e\u52a0\u4e00\u4e2a\u5192\u53f7\uff08:\uff09\u3002</li> </ul> <p>getopt\u547d\u4ee4\u4f1a\u57fa\u4e8e\u4f60\u5b9a\u4e49\u7684optstring\u89e3\u6790\u63d0\u4f9b\u7684\u9009\u9879\u53ca\u53c2\u6570\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#getopt_\u547d\u4ee4\u89e3\u6790\u673a\u5236","title":"getopt \u547d\u4ee4\u89e3\u6790\u673a\u5236","text":"<p>\u4e0b\u9762\u662f\u4e2agetopt\u5982\u4f55\u5de5\u4f5c\u7684\u7b80\u5355\u4f8b\u5b50\u3002</p> <pre><code>$ getopt ab:cd -a -b test1 -cd test2 test3\n-a -b test1 -c -d -- test2 test3\n</code></pre> <p>optstring\u5b9a\u4e49\u4e86\u56db\u4e2a\u6709\u6548\u9009\u9879\u5b57\u6bcd\uff1aa\u3001b\u3001c\u548cd\uff0c<code>b:</code> \u8bf4\u660eb\u9009\u9879\u9700\u8981\u8ddf\u4e00\u4e2a\u53c2\u6570\u503c\u3002</p> <p>\u5f53getopt\u547d\u4ee4\u8fd0\u884c\u65f6\uff0c\u5b83\u4f1a\u68c0\u67e5\u63d0\u4f9b\u7684\u53c2\u6570\u5217\u8868\uff0c\u5e76\u57fa\u4e8e\u63d0\u4f9b\u7684optstring\u8fdb\u884c\u89e3\u6790\u3002</p> <ol> <li>\u81ea\u52a8\u5c06\u5408\u5e76\u9009\u9879 <code>-cd</code> \u5206\u89e3\u6210\u4e24\u4e2a\u9009\u9879\u3002  </li> <li>\u89e3\u6790\u5230\u6700\u540e\u4e00\u4e2a\u9009\u9879 <code>-d</code>\uff0c\u4f1a\u63d2\u5165\u53cc\u7834\u6298\u7ebf\u6765\u5206\u9694\u540e\u7eed\u7684\u666e\u901a\u53c2\u6570\u3002  </li> </ol> <p>\u5982\u679c\u6307\u5b9a\u4e86\u4e00\u4e2a\u4e0d\u5728optstring\u4e2d\u58f0\u660e\u7684\u5b57\u6bcd\u9009\u9879\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u4ea7\u751f\u4e00\u6761\u9519\u8bef\u6d88\u606f\u3002</p> <pre><code>$ getopt ab:cd -a -b test1 -cde test2 test3\ngetopt: invalid option -- e\n -a -b test1 -c -d -- test2 test3\n</code></pre> <p>\u5982\u679c\u60f3\u5ffd\u7565\u8fd9\u6761\u9519\u8bef\u6d88\u606f\uff0c\u53ef\u4ee5\u5728 getopt \u547d\u4ee4\u540e\u52a0\u4e0a <code>-q</code> \u9009\u9879\u3002</p> <pre><code>$ getopt -q ab:cd -a -b test1 -cde test2 test3\n-a -b 'test1' -c -d -- 'test2' 'test3'\n</code></pre> <p>\u6ce8\u610f\uff1agetopt\u547d\u4ee4\u7684\u9009\u9879\uff08<code>-q</code>\uff09\u5fc5\u987b\u51fa\u73b0\u5728optstring\u4e4b\u524d\u3002</p> <p>\u63a5\u4e0b\u6765\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u6b64\u547d\u4ee4\u5904\u7406\u547d\u4ee4\u884c\u9009\u9879\u4e86\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u5728\u811a\u672c\u4e2d\u4f7f\u7528_getopt","title":"\u5728\u811a\u672c\u4e2d\u4f7f\u7528 getopt","text":"<p>\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u4f7f\u7528getopt\u6765\u683c\u5f0f\u5316\u811a\u672c\u6240\u643a\u5e26\u7684\u4efb\u4f55\u547d\u4ee4\u884c\u9009\u9879\u6216\u53c2\u6570\uff0c\u4f46\u7528\u8d77\u6765\u7565\u5fae\u590d\u6742\u3002 \u65b9\u6cd5\u662f\u7528getopt\u547d\u4ee4\u751f\u6210\u7684\u683c\u5f0f\u5316\u540e\u7684\u7248\u672c\u6765\u66ff\u6362\u5df2\u6709\u7684\u547d\u4ee4\u884c\u9009\u9879\u548c\u53c2\u6570\uff0cset \u547d\u4ee4\u80fd\u591f\u5904\u7406shell\u4e2d\u7684\u5404\u79cd\u53d8\u91cf\u3002</p> <p>set\u547d\u4ee4\u7684\u9009\u9879\u4e4b\u4e00\u662f\u53cc\u7834\u6298\u7ebf\uff08--\uff09\uff0c\u5b83\u4f1a\u5c06\u547d\u4ee4\u884c\u53c2\u6570\u66ff\u6362\u6210set\u547d\u4ee4\u7684\u547d\u4ee4\u884c\u503c\u3002\u7136\u540e\uff0c\u8be5\u65b9\u6cd5\u4f1a\u5c06\u539f\u59cb\u811a\u672c\u7684\u547d\u4ee4\u884c\u53c2\u6570\u4f20\u7ed9getopt\u547d\u4ee4\u3002 \u4e4b\u540e\u518d\u5c06getopt\u547d\u4ee4\u7684\u8f93\u51fa\u4f20\u7ed9set\u547d\u4ee4\uff0c\u7528getopt\u683c\u5f0f\u5316\u540e\u7684\u547d\u4ee4\u884c\u53c2\u6570\u6765\u66ff\u6362\u539f\u59cb\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u770b\u8d77\u6765\u5982\u4e0b\u6240\u793a\u3002</p> <pre><code>set -- $(getopt -q ab:cd \"$@\")\n</code></pre> <p>\u73b0\u5728\u539f\u59cb\u7684\u547d\u4ee4\u884c\u53c2\u6570\u53d8\u91cf\u7684\u503c\u4f1a\u88abgetopt\u547d\u4ee4\u7684\u8f93\u51fa\u66ff\u6362\uff0c\u800cgetopt\u5df2\u7ecf\u4e3a\u6211\u4eec\u683c\u5f0f\u5316\u597d\u4e86\u547d\u4ee4\u884c\u53c2\u6570\u3002 \u5229\u7528\u8be5\u65b9\u6cd5\uff0c\u73b0\u5728\u5c31\u53ef\u4ee5\u5199\u51fa\u80fd\u5e2e\u6211\u4eec\u5904\u7406\u547d\u4ee4\u884c\u53c2\u6570\u7684\u811a\u672c\u3002</p> <pre><code>$ cat test18.sh\n\n#!/bin/bash\n# Extract command line options &amp; values with getopt\n#\nset -- $(getopt -q ab:cd \"$@\")\n#\necho\nwhile [ -n \"$1\" ]; do\n    case \"$1\" in\n    -a) echo \"Found the -a option\" ;;\n    -b)\n        param=\"$2\" echo \"Found the -b option, with parameter value $param\"\n        shift\n        ;;\n    -c) echo \"Found the -c option\" ;;\n    --)\n        shift\n        break\n        ;;\n    *) echo \"$1 is not an option\" ;;\n    esac\n    shift\ndone\n#\ncount=1\nfor param in \"$@\"; do\n    echo \"Parameter #$count: $param\"\n    count=$((count + 1))\ndone\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <ul> <li>\u5728 Ubuntu Desktop 21.10 / bash version 5.1.8(1) \u4e0a\u6267\u884c\u7ed3\u679c\u7b26\u5408\u9884\u671f\uff1b  </li> <li>\u8be5\u7528\u4f8b\u5728 macOS 11.6.4 / bash version 3.2.57(1) \u4e0a\u7684\u6267\u884c\u7ed3\u679c\u975e\u9884\u671f\u3002  </li> </ul> <pre><code>$ ./test18.sh -ac\n\nFound the -a option\nFound the -c option\n\n$ ./test18.sh -a -b test1 -cd test2 test3 test4\n\nFound the -a option\nFound the -b option, with parameter value\nFound the -c option\n-d is not an option\nParameter #1: 'test2'\nParameter #2: 'test3'\nParameter #3: 'test4'\n</code></pre> <p>\u73b0\u5728\u770b\u8d77\u6765\u76f8\u5f53\u4e0d\u9519\u4e86\uff0c\u4f46\u662f\u5728getopt\u547d\u4ee4\u4e2d\u4ecd\u7136\u9690\u85cf\u7740\u4e00\u4e2a\u5c0f\u95ee\u9898\uff0c\u5177\u4f53\u770b\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>./test18.sh -a -b test1 -cd \"test2 test3\" test4\n\nFound the -a option\nFound the -b option, with parameter value\nFound the -c option\n-d is not an option\nParameter #1: 'test2\nParameter #2: test3'\nParameter #3: 'test4\n</code></pre> <p>getopt\u547d\u4ee4\u5e76\u4e0d\u64c5\u957f\u5904\u7406\u5e26\u7a7a\u683c\u548c\u5f15\u53f7\u7684\u53c2\u6570\u503c\u3002\u5b83\u4f1a\u5c06\u7a7a\u683c\u5f53\u4f5c\u53c2\u6570\u5206\u9694\u7b26\uff0c\u800c\u4e0d\u662f\u6839\u636e\u53cc\u5f15\u53f7\u5c06\u4e8c\u8005\u5f53\u4f5c\u4e00\u4e2a\u53c2\u6570\u3002 \u5e78\u800c\u8fd8\u6709\u53e6\u5916\u4e00\u4e2a\u529e\u6cd5\u80fd\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#mac\u5e73\u53f0\u7684\u517c\u5bb9\u6027\u95ee\u9898","title":"mac\u5e73\u53f0\u7684\u517c\u5bb9\u6027\u95ee\u9898","text":"<p>test18.sh \u5728 macOS 11.6.4 / bash version 3.2.57(1) \u4e0a\u8fd0\u884c\u7ed3\u679c\u975e\u9884\u671f\u3002</p> <p>\u5728 macOS \u4e2d\u6267\u884c man getopt \u53ef\u67e5\u770b\u8bf4\u660e\u624b\u518c\u548c\u7528\u4f8b\u3002</p> <p>How can I make bash deal with long param using \"getopt\" command in mac? \u3010Shell\u3011Linux\u548cMac\u4e0b\u811a\u672c\u53c2\u6570\u7684\u89e3\u6790 </p> <p>\u5728macOS\u4e0a\u53ef\u8003\u8651\u6267\u884c <code>brew install gnu-getopt</code> \u5b89\u88c5 gnu-getopt \u6765\u66ff\u4ee3\u9ed8\u8ba4\u7684 getopt\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u4f7f\u7528\u66f4\u9ad8\u7ea7\u7684_getopts","title":"\u4f7f\u7528\u66f4\u9ad8\u7ea7\u7684 getopts","text":"<p>\u5173\u4e8eBash\u7684\u5185\u7f6egetopts\u547d\u4ee4 </p> <p>getopts\u547d\u4ee4\uff08\u6ce8\u610f\u662f\u590d\u6570\uff09\u5185\u5efa\u4e8ebash shell\uff0c\u5b83\u8ddf\u8fd1\u4eb2getopt\u770b\u8d77\u6765\u5f88\u50cf\uff0c\u4f46\u591a\u4e86\u4e00\u4e9b\u6269\u5c55\u529f\u80fd\u3002</p> <p>\u53c2\u8003 man bash - SHELL BUILTIN COMMANDS - <code>getopts optstring name [args]</code></p> <p>\u4e0egetopt\u4e0d\u540c\uff0c\u524d\u8005\u5c06\u547d\u4ee4\u884c\u4e0a\u9009\u9879\u548c\u53c2\u6570\u5904\u7406\u540e\u53ea\u751f\u6210\u4e00\u4e2a\u8f93\u51fa\uff0c\u800cgetopts\u547d\u4ee4\u80fd\u591f\u548c\u5df2\u6709\u7684shell\u53c2\u6570\u53d8\u91cf\u914d\u5408\u9ed8\u5951\u3002 \u6bcf\u6b21\u8c03\u7528\u5b83\u65f6\uff0c\u5b83\u4e00\u6b21\u53ea\u5904\u7406\u547d\u4ee4\u884c\u4e0a\u68c0\u6d4b\u5230\u7684\u4e00\u4e2a\u53c2\u6570\u3002\u5904\u7406\u5b8c\u6240\u6709\u7684\u53c2\u6570\u540e\uff0c\u5b83\u4f1a\u9000\u51fa\u5e76\u8fd4\u56de\u4e00\u4e2a\u5927\u4e8e0\u7684\u72b6\u6001\u7801\u3002 \u8fd9\u8ba9\u5b83\u975e\u5e38\u9002\u5408\u7528\u89e3\u6790\u547d\u4ee4\u884c\u6240\u6709\u53c2\u6570\u7684\u5faa\u73af\u4e2d\u3002</p> <p>getopts\u547d\u4ee4\u7684\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>getopts optstring variable\n</code></pre> <p>optstring\u503c\u7c7b\u4f3c\u4e8egetopt\u547d\u4ee4\u4e2d\u7684\u90a3\u4e2a\uff0c\u6709\u6548\u7684\u9009\u9879\u5b57\u6bcd\u90fd\u4f1a\u5217\u5728optstring\u4e2d\u3002</p> <ul> <li>\u5982\u679c\u9009\u9879\u5b57\u6bcd\u9700\u8981\u5e26\u53c2\u6570\u503c\uff0c\u53ef\u5728\u5b57\u6bcd\u540e\u52a0\u4e00\u4e2a\u5192\u53f7\u3002</li> <li>\u8981\u5c4f\u853d\u9519\u8bef\u6d88\u606f\u7684\u8bdd\uff0c\u53ef\u5728optstring\u4e4b\u524d\u52a0\u4e00\u4e2a\u5192\u53f7\u3002</li> <li>getopts\u547d\u4ee4\u5c06\u5f53\u524d\u53c2\u6570\u4fdd\u5b58\u5728\u547d\u4ee4\u884c\u4e2d\u5b9a\u4e49\u7684variable\u4e2d\u3002</li> </ul> <p>getopts\u547d\u4ee4\u4f1a\u7528\u5230\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\u3002</p> <ul> <li>\u5982\u679c\u9009\u9879\u9700\u8981\u8ddf\u4e00\u4e2a\u53c2\u6570\u503c\uff0c<code>OPTARG</code> \u73af\u5883\u53d8\u91cf\u5c31\u4f1a\u4fdd\u5b58\u8fd9\u4e2a\u503c\u3002</li> <li><code>OPTIND</code> \u73af\u5883\u53d8\u91cf\u5219\u4fdd\u5b58\u4e86\u53c2\u6570\u5217\u8868\u4e2dgetopts\u6b63\u5728\u5904\u7406\u7684\u53c2\u6570\u4f4d\u7f6e\u3002</li> </ul> <p>\u5728\u5904\u7406\u5b8c\u9009\u9879\u4e4b\u540e\uff0c\u6267\u884c <code>shift $[ $OPTIND - 1 ]</code> \u79fb\u4f4d\uff0c\u53ef\u4ee5\u7ee7\u7eed\u5904\u7406\u5176\u4ed6\u547d\u4ee4\u884c\u53c2\u6570\u4e86\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u5904\u7406\u77ed\u9009\u9879","title":"\u5904\u7406\u77ed\u9009\u9879","text":"<p>\u8ba9\u6211\u4eec\u770b\u4e2a\u4f7f\u7528getopts\u547d\u4ee4\u7684\u7b80\u5355\u4f8b\u5b50\u3002</p> <pre><code>$ cat test19.sh\n\n#!/bin/bash\n# simple demonstration of the getopts command\n#\necho\nwhile getopts :ab:c opt; do\n    case \"$opt\" in\n    a) echo \"Found the -a option\" ;;\n    b) echo \"Found the -b option, with value $OPTARG\" ;;\n    c) echo \"Found the -c option\" ;;\n    *) echo \"Unknown option: $opt\" ;;\n    esac\n    echo \"OPTIND = $OPTIND\"\ndone\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>$ ./test19.sh -ab test1 -c\n\nFound the -a option\nFound the -b option, with value test1\nFound the -c option\n</code></pre> <p>while\u8bed\u53e5\u5b9a\u4e49\u4e86getopts\u547d\u4ee4\uff0c\u6307\u660e\u4e86\u8981\u67e5\u627e\u54ea\u4e9b\u547d\u4ee4\u884c\u9009\u9879\uff0c\u4ee5\u53ca\u6bcf\u6b21\u8fed\u4ee3\u4e2d\u5b58\u50a8\u5b83\u4eec\u7684\u53d8\u91cf\u540d\uff08opt\uff09\u3002 \u672c\u4f8b\u4e2dcase\u5224\u65ad\u5355\u5b57\u6bcd\u9009\u9879\u4e0d\u7528\u5355\u7834\u6298\u7ebf\uff0c\u56e0\u4e3agetopts\u547d\u4ee4\u89e3\u6790\u547d\u4ee4\u884c\u9009\u9879\u65f6\u4f1a\u79fb\u9664\u5f00\u5934\u7684\u5355\u7834\u6298\u7ebf\u3002 getopts\u547d\u4ee4\u5728\u53c2\u6570\u503c\u4e2d\u53ef\u4ee5\u5305\u542b\u7a7a\u683c\uff0c\u53ef\u4ee5\u89e3\u51b3\u4e0a\u4e00\u8282getopt\u9057\u7559\u7684\u95ee\u9898\u3002</p> <pre><code>$ ./test19.sh -b \"test1 test2\" -a\n\nFound the -b option, with value test1 test2\nFound the -a option\n</code></pre> <p>\u53e6\u4e00\u4e2a\u597d\u7528\u7684\u529f\u80fd\u662f\u652f\u6301\u5c06\u9009\u9879\u5b57\u6bcd\u548c\u53c2\u6570\u503c\u653e\u5728\u4e00\u8d77\u4f7f\u7528\uff0c\u800c\u4e0d\u7528\u52a0\u7a7a\u683c\u3002</p> <pre><code>$ ./test19.sh -abtest1\n\nFound the -a option\nFound the -b option, with value test1\n</code></pre> <p>getopts\u547d\u4ee4\u80fd\u591f\u4ece <code>-b</code> \u9009\u9879\u4e2d\u6b63\u786e\u89e3\u6790\u51fatest1\u503c\u3002 \u9664\u6b64\u4e4b\u5916\uff0cgetopts\u8fd8\u80fd\u591f\u5c06\u547d\u4ee4\u884c\u4e0a\u627e\u5230\u7684\u6240\u6709\u672a\u5b9a\u4e49\u7684\u9009\u9879\u7edf\u4e00\u8f93\u51fa\u6210\u95ee\u53f7\u3002</p> <pre><code>$ ./test19.sh -d\n\nUnknown option: ?\n\n$ ./test19.sh -acde\n\nFound the -a option\nFound the -c option\nUnknown option: ?\nUnknown option: ?\n</code></pre> <p>optstring\u4e2d\u672a\u5b9a\u4e49\u7684\u9009\u9879\u5b57\u6bcd\u4f1a\u4ee5\u95ee\u53f7\u5f62\u5f0f\u53d1\u9001\u7ed9\u4ee3\u7801\u3002 getopts\u547d\u4ee4\u77e5\u9053\u4f55\u65f6\u505c\u6b62\u5904\u7406\u9009\u9879\uff0c\u5e76\u5c06\u53c2\u6570\u7559\u7ed9\u4f60\u5904\u7406\u3002 \u5728getopts\u5904\u7406\u6bcf\u4e2a\u9009\u9879\u65f6\uff0c\u5b83\u4f1a\u5c06 <code>OPTIND</code> \u73af\u5883\u53d8\u91cf\u503c\u589e\u4e00\u3002 \u5728getopts\u5b8c\u6210\u5904\u7406\u65f6\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528shift\u547d\u4ee4\u548cOPTIND\u503c\u6765\u79fb\u52a8\u53c2\u6570\u3002</p> <pre><code>$ cat test20.sh\n\n#!/bin/bash\n# Processing options &amp; parameters with getopts #\necho\nwhile getopts :ab:cd opt; do\n    case \"$opt\" in\n    a) echo \"Found the -a option\" ;;\n    b) echo \"Found the -b option, with value $OPTARG\" ;;\n    c) echo \"Found the -c option\" ;;\n    d) echo \"Found the -d option\" ;;\n    *) echo \"Unknown option: $opt\" ;;\n    echo \"OPTIND = $OPTIND\"\n    esac\ndone\n#\nshift $((OPTIND - 1))\n#\necho\ncount=1\nfor param in \"$@\"; do\n    echo \"Parameter $count: $param\"\n    count=$((count + 1))\ndone\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u89e3\u6790\u5230\u7b2c\u4e00\u4e2a\u975e\u7834\u6298\u53f7\u52a0\u5355\u5b57\u6bcd\uff08test2\uff09\u5f00\u59cb\uff0c\u540e\u7eed\u90fd\u4f1a\u5f53\u6210\u666e\u901a\u53c2\u6570\u3002</p> <pre><code>$ ./test20.sh -a -b test1 -cd -e test2 -f test3 --help test4\n\nFound the -a option\nFound the -b option, with value test1\nFound the -c option\nFound the -d option\nUnknown option: ?\n\nParameter 1: test2\nParameter 2: -f\nParameter 3: test3\nParameter 4: --help\nParameter 5: test4\n</code></pre>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u8c03\u8bd5_optind","title":"\u8c03\u8bd5 OPTIND","text":"<p>\u6bcf\u4e00\u8f6e while \u6267\u884c\u65f6\uff0cgetopts \u5c06\u89e3\u6790\u7d22\u5f15 <code>OPTIND</code> \u4f4d\u7f6e\u9009\u9879\uff0c\u89e3\u6790\u5b8c\u4e00\u4e2a\u4f4d\u7f6e\u540e\uff0cOPTIND++ \u6307\u5411\u4e0b\u4e00\u4f4d\u7f6e\u3002</p> <p>\u4e3a\u4e86\u66f4\u76f4\u89c2\u5730\u7406\u89e3 OPTIND \u7d22\u5f15\u673a\u5236\uff0c\u6211\u4eec\u7a0d\u4f5c\u4fee\u6539 test19 \u548c test20 \u811a\u672c\uff0c\u6dfb\u52a0\u4e00\u4e9b\u8c03\u8bd5\u8f93\u51fa\u3002</p> <p>\u7ed9 test19.sh\uff08optspec=<code>:ab:c</code>\uff09\u7684 esac \u540e\u6dfb\u52a0\u8c03\u8bd5\u8f93\u51fa <code>echo \"OPTIND = $OPTIND\"</code>\u3002</p> <pre><code>$ ./test19.sh -a -b test1 -c -d test2 -e\n\nFound the -a option\nOPTIND = 2 # next option index for -b\nFound the -b option, with value test1\nOPTIND = 4 # next option index for -c\nFound the -c option\nOPTIND = 5 # next option index for -d\nUnknown option: ?\nOPTIND = 6 # next option index for ?\n</code></pre> <ol> <li>\u521d\u59cb\u5316 OPTIND=1\uff0cgetopts \u5f00\u59cb\u89e3\u6790\u7b2c\u4e00\u4e2a\u9009\u9879 <code>-a</code>\uff0c\u89e3\u6790\u5b8c OPTIND++=2\uff1b  </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u4e8c\u4e2a\u9009\u9879 <code>-b</code>\uff0c\u89e3\u6790\u540e OPTIND++=3\uff1b  <ul> <li>\u7531\u4e8eb:\u5e26\u53c2\uff0c\u6545\u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u4e09\u4e2a\u9009\u9879 <code>test1</code>\uff0c\u8d4b\u503c\u7ed9 OPTARG \u4f5c\u4e3a\u9009\u9879\u4e8c\u7684\u53c2\u6570\uff0c\u89e3\u6790\u540e OPTIND++=4\uff1b  </li> </ul> </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u56db\u4e2a\u9009\u9879 <code>-c</code>\uff0c\u89e3\u6790\u540e OPTIND++=5\uff1b  </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u4e94\u4e2a\u9009\u9879 <code>-d</code>\uff0c\u975e\u9884\u671f\u53c2\u6570\uff0c\u89e3\u6790\u540e OPTIND++=6\uff1b  </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u516d\u4e2a\u9009\u9879 <code>test2</code>\uff0c\u975e\u7834\u6298\u7ebf\u5355\u5b57\u6bcd\uff0c\u9009\u9879\u89e3\u6790\u5b8c\u6bd5\uff0c\u540e\u9762\u89c6\u4f5c\u666e\u901a\u53c2\u6570\u3002  </li> </ol> <pre><code>$ ./test19.sh -ab test1 -c -d test2 -e\n\nFound the -a option\nOPTIND = 1 # next option index for -b\nFound the -b option, with value test1\nOPTIND = 3 # next option index for -c\nFound the -c option\nOPTIND = 4 # next option index for -d\nUnknown option: ?\nOPTIND = 5 # next option index for ?\n</code></pre> <p>\u5408\u5e76\u9009\u9879 -ab \u5360\u7528\u4e00\u4e2a\u4f4d\u7f6e\u3002</p> <ol> <li>\u521d\u59cb\u5316 OPTIND=1\uff0cgetopts \u5f00\u59cb\u89e3\u6790\u7b2c\u4e00\u4e2a\u9009\u9879 <code>-ab</code>\uff0c\u89e3\u6790\u51fa <code>-a</code>\uff0c\u7531\u4e8e\u6709\u5408\u5e76\u9009\u9879\uff0c\u7ef4\u6301 OPTIND\uff1b  </li> <li>getopts \u7ee7\u7eed\u4ece OPTIND \u7d22\u5f15\u7684\u7b2c\u4e00\u4e2a\u5408\u5e76\u9009\u9879\u4e2d\u89e3\u6790\u51fa <code>-b</code>\uff0cOPTIND++=2\uff1b  <ul> <li>\u7531\u4e8eb:\u5e26\u53c2\uff0c\u6545\u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u4e8c\u4e2a\u9009\u9879 <code>test1</code>\uff0c\u8d4b\u503c\u7ed9 OPTARG \u4f5c\u4e3a\u9009\u9879\u4e8c\u7684\u53c2\u6570\uff0c\u89e3\u6790\u540e OPTIND++=3\uff1b  </li> </ul> </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u4e09\u4e2a\u9009\u9879 <code>-c</code>\uff0c\u89e3\u6790\u540e OPTIND++=4\uff1b  </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u56db\u4e2a\u9009\u9879 <code>-d</code>\uff0c\u975e\u9884\u671f\u53c2\u6570\uff0c\u89e3\u6790\u540e OPTIND++=5\uff1b  </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u4e94\u4e2a\u9009\u9879 <code>test2</code>\uff0c\u975e\u7834\u6298\u7ebf\u5355\u5b57\u6bcd\uff0c\u9009\u9879\u89e3\u6790\u5b8c\u6bd5\uff0c\u540e\u9762\u89c6\u4f5c\u666e\u901a\u53c2\u6570\u3002  </li> </ol> <p>\u7ed9 test20.sh\uff08optspec=<code>:ab:cd</code>\uff09\u7684 esac \u540e\u6dfb\u52a0\u8c03\u8bd5\u8f93\u51fa <code>echo \"OPTIND = $OPTIND\"</code>\u3002</p> <pre><code>$ ./test20.sh -a -b test1 -cd -e test2 -f test3 --help test4\n\nFound the -a option\nOPTIND = 2\nFound the -b option, with value test1\nOPTIND = 4\nFound the -c option\nOPTIND = 4\nFound the -d option\nOPTIND = 5\nUnknown option: ?\nOPTIND = 6\n\nParameter 1: test2\nParameter 2: -f\nParameter 3: test3\nParameter 4: --help\nParameter 5: test4\n</code></pre> <p>\u5408\u5e76\u9009\u9879 -cd \u5360\u7528\u4e00\u4e2a\u4f4d\u7f6e\u3002</p> <ol> <li>\u521d\u59cb\u5316 OPTIND=1\uff0cgetopts \u5f00\u59cb\u89e3\u6790\u7b2c\u4e00\u4e2a\u9009\u9879 <code>-a</code>\uff0c\u89e3\u6790\u5b8c OPTIND++=2\uff1b  </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u4e8c\u4e2a\u9009\u9879 <code>-b</code>\uff0c\u89e3\u6790\u540e OPTIND++=3\uff1b  <ul> <li>\u7531\u4e8eb:\u5e26\u53c2\uff0c\u6545\u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u4e09\u4e2a\u9009\u9879 <code>test1</code>\uff0c\u8d4b\u503c\u7ed9 OPTARG \u4f5c\u4e3a\u9009\u9879\u4e8c\u7684\u53c2\u6570\uff0c\u89e3\u6790\u540e OPTIND++=4\uff1b  </li> </ul> </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u56db\u4e2a\u9009\u9879 <code>-cd</code>\uff0c\u89e3\u6790\u51fa <code>-c</code>\uff0c\u7531\u4e8e\u6709\u5408\u5e76\u9009\u9879\uff0c\u7ef4\u6301 OPTIND\uff1b  </li> <li>getopts \u7ee7\u7eed\u4ece OPTIND \u7d22\u5f15\u7684\u7b2c\u56db\u4e2a\u5408\u5e76\u9009\u9879\u4e2d\u89e3\u6790\u51fa <code>-d</code>\uff0cOPTIND++=5\uff1b  </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u4e94\u4e2a\u9009\u9879 <code>-e</code>\uff0c\u975e\u9884\u671f\u53c2\u6570\uff0c\u89e3\u6790\u540e OPTIND++=6\uff1b  </li> <li>getopts \u7ee7\u7eed\u89e3\u6790 OPTIND \u7d22\u5f15\u7684\u7b2c\u516d\u4e2a\u9009\u9879 <code>test2</code>\uff0c\u975e\u7834\u6298\u7ebf\u5355\u5b57\u6bcd\uff0c\u9009\u9879\u89e3\u6790\u5b8c\u6bd5\uff0c\u540e\u9762\u89c6\u4f5c\u666e\u901a\u53c2\u6570\u3002  </li> </ol> <p>\u6700\u540e\u6267\u884c <code>shift $((OPTIND - 1))</code> \u6216 <code>shift $[ $OPTIND - 1 ]</code>\uff0c\u5c06 test2 \u5de6\u79fb\u4e94\u4f4d\u5230 -a \u539f\u6765\u7684\u4f4d\u7f6e <code>$1</code>\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u5904\u7406\u957f\u9009\u9879","title":"\u5904\u7406\u957f\u9009\u9879","text":"<p>Using getopts to process long and short command line options</p> <ul> <li>\u7ffb\u8bd11\uff1a\u4f7f\u7528getopts\u5904\u7406\u957f\u548c\u77ed\u547d\u4ee4\u884c\u9009\u9879 </li> <li>\u7ffb\u8bd12\uff1a\u4f7f\u7528getopts\u5904\u7406\u957f\u548c\u77ed\u547d\u4ee4\u884c\u9009\u9879 </li> </ul>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#rapanui","title":"RapaNui","text":"<p>RapaNui \u7684\u56de\u7b54 - https://stackoverflow.com/a/12523979\uff1a</p> <p>getops with long/short flags as well as long arguments</p> <p>\u95ee\u9898\uff1a\u89e3\u6790\u77ed\u9009\u9879\u540e\u7684\u957f\u9009\u9879\uff0c\u524d\u9762\u7684\u77ed\u9009\u9879\u4f1a\u7ee7\u7eed\u547d\u4e2d\u957f\u9009\u9879\u5904\u7406default case <code>*)</code>\uff0c\u62a5\u9519 Long: &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; invalid options (long)\uff0c\u4f46\u5b9e\u9645\u89e3\u6790\u6b63\u5e38\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#arvid_requate","title":"Arvid Requate","text":"<p>Arvid Requate \u7684\u56de\u7b54 - https://stackoverflow.com/a/7680682\uff1a</p> <p>The Bash builtin getopts function can be used to parse long options by putting a dash character followed by a colon into the optspec.</p> <p>\u5728\u8fdb\u5165\u957f\u9009\u9879(-)\u7684case\u4e2d\u589e\u52a0\u6253\u5370\u8c03\u8bd5\u4fe1\u606f\uff1a</p> <pre><code>    -)\n        echo \"opt=$opt, OPTARG=$OPTARG, OPTIND=$OPTIND\" # debug\n        case \"${OPTARG}\" in\n</code></pre> <p>\u770b\u770b <code>--longOption Value</code> \u548c <code>--longOption=Value</code> \u4e24\u79cd\u60c5\u5f62\u4e0b\u7684\u5904\u7406\u903b\u8f91\u3002</p> <p><code>--longOption Value</code>\uff1agetopts\u547d\u4ee4\u89e3\u6790\u547d\u4ee4\u884c\u9009\u9879\u65f6\u4f1a\u79fb\u9664\u5f00\u5934\u7684\u5355\u7834\u6298\u7ebf\u3002</p> <ul> <li>\u5f53\u524d\u89e3\u6790\u5230\u7b2c\u4e8c\u4e2a\u9009\u9879\u4e3a -\uff0c\u5176\u53c2\u6570\u4e3a loglevel\uff1a\u8f93\u51fa <code>opt=-, OPTARG=loglevel</code>\uff0c\u4e0b\u4e00\u4e2a\u9009\u9879\u4f4d\u7f6e\u4e3a OPTIND=3\uff1b  </li> <li>OPTARG=loglevel \u4e3a\u771f\u6b63\u7684\u957f\u9009\u9879\uff0c\u8bfb\u53d6\u5176\u540e\u4e0b\u4e00\u4e2a\u9009\u9879\u4f4d\u7f6e\u7684\u503c\uff0c\u4f5c\u4e3a\u5176\u53c2\u6570\u503c\uff1a<code>val=\"${!OPTIND}\"</code>\uff1b  </li> <li>OPTIND \u81ea\u589e\u540e\u79fb\u5230\u53c2\u6570 <code>-g</code>\uff0c\u7ee7\u7eedwhile\u5faa\u73af\u5904\u7406\u540e\u7eed\u9009\u9879\u3002  </li> </ul> <pre><code>$ ./getopts-7680682.sh -v --loglevel 2 -g\nFound option '-v'\nopt=-, OPTARG=loglevel, OPTIND=3\nParsing option: '--loglevel', value: '2'\nNon-option argument: '-g'\n</code></pre> <p><code>--longOption=Value</code>\uff1agetopts\u547d\u4ee4\u89e3\u6790\u547d\u4ee4\u884c\u9009\u9879\u65f6\u4f1a\u79fb\u9664\u5f00\u5934\u7684\u5355\u7834\u6298\u7ebf\u3002</p> <ul> <li>\u5f53\u524d\u89e3\u6790\u5230\u7b2c\u4e8c\u4e2a\u9009\u9879\u4e3a -\uff0c\u5176\u53c2\u6570\u4e3a loglevel=2\uff1a\u8f93\u51fa <code>opt=-, OPTARG=loglevel=2</code>\uff0c\u4e0b\u4e00\u4e2a\u53c2\u6570\u4f4d\u7f6e\u4e3a OPTIND=3\uff1b  </li> <li>\u4eceOPTARG\u4e2d\u89e3\u6790\u51fa\u7b49\u53f7\u5de6\u8fb9\u7684\u957f\u9009\u9879\u53ca\u5176\u53f3\u8fb9\u7684\u53c2\u6570\u503c\uff1b  </li> </ul> <pre><code>$ argparse/getopts-7680682.sh -v --loglevel=2 -g\nFound option '-v'\nopt=-, OPTARG=loglevel=2, OPTIND=3\nParsing option: '--loglevel', value: '2'\nNon-option argument: '-g'\n</code></pre> <p>\u601d\u8003\uff1a\u8fd9\u79cd\u5199\u6cd5\uff0c\u9488\u5bf9\u957f\u9009\u9879\u9884\u5b9a\u4e49\u4e86case\u3002\u5982\u679c\u6709\u591a\u4e2a\u957f\u9009\u9879\uff0c\u5219\u65e0\u6cd5\u666e\u9002\u3002</p>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#adam_katz","title":"Adam Katz","text":"<p>Adam Katz \u7684\u56de\u7b54 - https://stackoverflow.com/a/28466267\uff1a</p> <p>Long options can be parsed by the standard getopts builtin as \u201carguments\u201d to the - \u201coption\u201d This is portable and native POSIX shell \u2013 no external programs or bashisms are needed.  </p> <p>\u5728 Arvid Requate \u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u4e86\u5b8c\u5584\uff0c\u9996\u5148\u5206\u6790\u957f\u9009\u9879 <code>--longOption=Value</code>\u3002 \u57fa\u4e8e OPTARG\uff08longOption=Value\uff09\uff0c\u63d0\u53d6\u771f\u6b63\u957f\u9009\u9879 OPT \u53ca\u5176\u503c OPTARG\uff0c\u540e\u7eed\u540c\u4e49\u957f\u77ed\u9009\u9879\u5408\u5e76case\u5904\u7406\u3002</p> <ul> <li>\u77ed\u9009\u9879\u540e\u7eed\u7684\u503c\u4ee5\u7a7a\u683c\u5206\u9694\uff1b\u957f\u9009\u9879\u540e\u9762\u5e26\u503c\u9700\u8981\u4ee5\u7b49\u53f7(=)\u8d4b\u503c\u3002</li> </ul> <p>\u6d4b\u8bd5\u7528\u4f8b\uff1a\u6ce8\u610f\u957f\u9009\u9879\u5e26\u503c\u9700\u8981\u7528\u7b49\u53f7\u3002</p> <pre><code># \u589e\u52a0\u5f00\u5173\u9009\u9879 -d --dogtail\n$ ./getopts-28466267.sh -ab paramB --charlie=paramC --dogtail D E F G\nFound short option 'a'\nParsing short option: 'b', value: 'paramB'\n&gt;&gt;&gt; long option: '--charlie=paramC'\nParsing long option: 'charlie', value: 'paramC'\n&gt;&gt;&gt; long option: '--dogtail'\nFound long option 'dogtail'\nlast params: D E F G\n</code></pre> <p>\u8003\u8651\u517c\u5bb9\u652f\u6301\u957f\u9009\u9879\u7a7a\u683c\u540e\u5e26\u53c2\u6570\u60c5\u5f62\uff0c\u7591\u96be\u662f\u65e0\u6cd5\u77e5\u6653\u957f\u9009\u9879\u540e\u662f\u5426\u5e26\u53c2\u6570\uff08need_arg\uff09\uff1f</p> <p>need_arg \u51fd\u6570\u5224\u65ad\u8f93\u5165\u7684\u957f\u9009\u9879\u540d\u79f0\uff08\u53c2\u6570 <code>$1</code>\uff09\u662f\u5426\u9700\u8981\u5e26\u53c2\u6570\u3002  </p> <p>\u9884\u5b9a\u4e49\u4e86\u4e09\u4e2a\u9700\u8981\u5e26\u53c2\u6570\u7684\u9009\u9879\uff1a--bravo\u3001--charlie\u3001--electric\u3002</p> <pre><code># \u5224\u65ad\u8f93\u5165\u7684\u957f\u9009\u9879\u540d\u79f0\u662f\u5426\u9700\u8981\u5e26\u53c2\u6570\nneed_arg() {\n    # if ! [ $# -eq 0 ]\n    if [ $# -gt 0 ]; then\n        case $1 in\n        bravo | charlie | electric )\n            return 0\n            ;;\n        *)\n            # echo \"Unkown option: $1\" &gt;&amp;2\n            return 1\n            ;;\n        esac\n    else\n        return 1\n    fi\n}\n</code></pre> <p>\u6d4b\u8bd5\u7ed3\u679c\u5982\u4e0b\uff0c\u80fd\u6ee1\u8db3\u4e00\u822c\u6027\u9700\u6c42\u3002</p> <pre><code># \u589e\u52a0\u9009\u9879\uff08\u8981\u5e26\u53c2\u6570\uff09-e --electric\n$ ./getopts-28466267.sh -ab paramB --charlie=paramC --dogtail --electric paramE F G H\nFound short option 'a'\nParsing short option: 'b', value: 'paramB'\n&gt;&gt;&gt; long option: '--charlie=paramC'\nParsing long option: 'charlie', value: 'paramC'\n&gt;&gt;&gt; long option: '--dogtail'\nFound long option 'dogtail'\n&gt;&gt;&gt; long option: '--electric paramE'\nParsing long option: 'electric', value: 'paramE'\nlast params: F G H\n</code></pre>","tags":["getopt"]},{"location":"blog/20191106/11-argparse/#\u76f8\u5173\u53c2\u8003","title":"\u76f8\u5173\u53c2\u8003","text":"<p>Shell \u811a\u672c\u7684\u53c2\u6570\u89e3\u6790\u5de5\u5177</p> <ul> <li>shell - \u53c2\u6570\u89e3\u6790\u4e09\u79cd\u65b9\u5f0f(\u624b\u5de5, getopts, getopt) </li> </ul> <ol> <li>\u624b\u5de5\u89e3\u6790\u4f7f\u7528\u7a7a\u683c\u5206\u9694  </li> <li>\u624b\u5de5\u89e3\u6790\u4f7f\u7528\u7b49\u53f7\u5206\u9694  </li> <li>\u4f7f\u7528 getopts \u5de5\u5177  </li> <li>\u4f7f\u7528 argbash \u5de5\u5177  </li> </ol> <p>\u4f7f\u7528 getopts \u548c getopt \u547d\u4ee4\u5904\u7406\u547d\u4ee4\u884c\u9009\u9879 </p> <ul> <li>getopt \u80fd\u5904\u7406\u957f\u53c2\u6570\u548c\u77ed\u53c2\u6570\u683c\u5f0f\uff0cmac\u4e0a\u9ed8\u8ba4\u4e0d\u652f\u6301\uff1b  </li> <li>getopts \u53ea\u80fd\u5904\u7406\u77ed\u53c2\u6570\u683c\u5f0f\uff0c\u517c\u5bb9linux\u548cmac\uff1b  </li> </ul>","tags":["getopt"]},{"location":"blog/20191106/12-get-ostype/","title":"Linux Shell Program - ostype","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u83b7\u53d6\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\u3002</p> <p>\u672c\u6587\u5217\u4e3e\u4e86\u4e00\u4e9b\u83b7\u53d6\u7cfb\u7edf\u7c7b\u578b\u548c\u7248\u672c\u4fe1\u606f\u7684\u547d\u4ee4\u548c\u65b9\u5f0f\u3002</p>"},{"location":"blog/20191106/12-get-ostype/#uname","title":"uname","text":"<pre><code># macOS\n$ uname\nDarwin\n$ uname -mrs\nDarwin 20.6.0 x86_64\n$ uname -a\nDarwin THOMASFAN-MB1 20.6.0 Darwin Kernel Version 20.6.0: Thu Jan 20 21:02:14 PST 2022; root:xnu-7195.141.20~1/RELEASE_X86_64 x86_64\n</code></pre> <pre><code># ubuntu\n$ uname\nLinux\n$ uname -mrs\nLinux 5.13.0-1016-raspi aarch64\n$ uname -a\nLinux rpi4b-ubuntu 5.13.0-1016-raspi #18-Ubuntu SMP PREEMPT Thu Jan 20 08:53:01 UTC 2022 aarch64 aarch64 aarch64 GNU/Linux\n</code></pre> <pre><code># raspbian\npi@raspberrypi:~$ uname\nLinux\n\npi@raspberrypi:~$ uname -mrs\nLinux 4.9.41-v7+ armv7l\n\npi@raspberrypi:~ $ uname -a\nLinux raspberrypi 4.9.41-v7+ #1023 SMP Tue Aug 8 16:00:15 BST 2017 armv7l GNU/Linux\n</code></pre>"},{"location":"blog/20191106/12-get-ostype/#ostype","title":"OSTYPE","text":"<pre><code># macOS\n$ echo $OSTYPE\ndarwin20.0\n\n# ubuntu\n$ echo $OSTYPE\nlinux-gnu\n\n# raspbian\n$ echo $OSTYPE\nlinux-gnueabihf\n</code></pre>"},{"location":"blog/20191106/12-get-ostype/#procversion","title":"/proc/version","text":"<pre><code># macOS \u4e0d\u5b58\u5728\n$ cat /proc/version\ncat: /proc/version: No such file or directory\n$ echo $?\n1\n\n# ubuntu\n$ cat /proc/version\nLinux version 5.13.0-1016-raspi (buildd@bos02-arm64-077) (gcc (Ubuntu 11.2.0-7ubuntu2) 11.2.0, GNU ld (GNU Binutils for Ubuntu) 2.37) #18-Ubuntu SMP PREEMPT Thu Jan 20 08:53:01 UTC 2022\n\n# raspbian\n$ cat /proc/version\nLinux version 4.9.41-v7+ (dc4@dc4-XPS13-9333) (gcc version 4.9.3 (crosstool-NG crosstool-ng-1.22.0-88-g8460611) ) #1023 SMP Tue Aug 8 16:00:15 BST 2017\n</code></pre>"},{"location":"blog/20191106/12-get-ostype/#etcissue","title":"/etc/issue","text":"<pre><code># macOS \u4e0d\u5b58\u5728\n$ cat /etc/issue\ncat: /etc/issue: No such file or directory\n\n# ubuntu\n$ cat /etc/issue\nUbuntu 21.10 \\n \\l\n\n# raspbian\n$ cat /etc/issue\nRaspbian GNU/Linux 9 \\n \\l\n</code></pre>"},{"location":"blog/20191106/12-get-ostype/#get_ostype","title":"get_ostype","text":"<p>Bash: Check Operating System is Mac</p> <pre><code>[[ $OSTYPE == 'darwin'* ]] &amp;&amp; echo 'macOS'\n</code></pre> <p>Detect operating system in shell script</p> <p>How to detect the OS from a Bash script?</p> <ul> <li>\u5982\u4f55\u4eceBash\u811a\u672c\u4e2d\u68c0\u6d4b\u64cd\u4f5c\u7cfb\u7edf\uff1f </li> <li>\u68c0\u6d4b\u4e09\u79cd\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf\u7684Bash\u811a\u672c </li> </ul> <p>\u5177\u4f53\u53c2\u8003\u6574\u7406\u7684\u811a\u672c get_ostype.sh\u3002</p> get_ostype.sh <pre><code>#!/bin/bash\n\n# https://stackoverflow.com/a/8597411\nfunction get_ostype_1 {\n    local platform1='unknown'\n    if [[ \"$OSTYPE\" == \"linux-gnu\"* ]]; then\n        platform1='linux'\n    elif [[ \"$OSTYPE\" == \"darwin\"* ]]; then\n        platform1='macos'\n    elif [[ \"$OSTYPE\" == \"msys\" ]]; then\n        # Lightweight shell and GNU utilities compiled for Windows (part of MinGW)\n        platform1='win(msys)'\n    elif [[ \"$OSTYPE\" == \"cygwin\" ]]; then\n        # POSIX compatibility layer and Linux environment emulation for Windows\n        platform1='win(cygwin)'\n    elif [[ \"$OSTYPE\" == \"win32\" ]]; then\n        # I'm not sure this can happen.\n        platform1='win32'\n    elif [[ \"$OSTYPE\" == \"freebsd\"* ]]; then\n        platform1='freebsd'\n    fi\n    echo \"$platform1\"\n}\n\n# https://stackoverflow.com/a/18434831\nfunction get_ostype_2 {\n    local platform2='unknown'\n    case \"$OSTYPE\" in\n    linux*)\n        platform2='linux'\n        ;;\n    darwin*)\n        platform2='macos'\n        ;;\n    bsd*)\n        platform2='bsd'\n        ;;\n    solaris*)\n        platform2='solaris'\n        ;;\n    msys*)\n        platform2='win(msys)'\n        ;;\n    cygwin*)\n        platform2='win(cygwin)'\n        ;;\n    *) ;;\n    esac\n    echo \"$platform2\"\n}\n\n# Detect the platform (similar to $OSTYPE)\nget_ostype_3() {\n    local OS=\"$(uname)\"\n    local platform3='unknown'\n    case $OS in\n    'Linux')\n        platform3='linux'\n        ;;\n    'Darwin')\n        platform3='macos'\n        ;;\n    'FreeBSD')\n        platform3='freebsd'\n        ;;\n    'SunOS')\n        platform3='solaris'\n        ;;\n    'WindowsNT')\n        platform3='windows'\n        ;;\n    'AIX')\n        OS='aix'\n        ;;\n    *) ;;\n    esac\n    echo \"$platform3\"\n}\n\n# https://stackoverflow.com/a/29239609\nif_os() {\n    [[ $OSTYPE == *$1* ]]\n}\n\nif_nix() {\n    case \"$OSTYPE\" in\n    *linux* | *hurd* | *msys* | *cygwin* | *sua* | *interix*) sys=\"gnu\" ;;\n    *bsd* | *darwin*) sys=\"bsd\" ;;\n    *sunos* | *solaris* | *indiana* | *illumos* | *smartos*) sys=\"sun\" ;;\n    esac\n    [[ \"${sys}\" == \"$1\" ]]\n}\n</code></pre>"},{"location":"blog/20191106/13-read-by-line/","title":"Linux Shell Program - read by line","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u9010\u884c\u8bfb\u53d6\u65b9\u5f0f\u3002</p> <pre><code>$ cat data2.txt\nOne line of test text.\nTwo lines of test text.\nThree lines of test text.\n</code></pre>"},{"location":"blog/20191106/13-read-by-line/#awk","title":"awk","text":"<p>awk \u9ed8\u8ba4\u5bf9\u6570\u636e\u6d41\u9010\u884c\u8bfb\u53d6\u5206\u6790\uff0c\u6bcf\u4e00\u884c\u5373\u4e3a\u4e00\u6761\u8bb0\u5f55\uff08Record\uff09\uff0c\u7136\u540e\u9488\u5bf9\u6bcf\u6761\u8bb0\u5f55\u6267\u884c\u52a8\u4f5c\u3002</p> <p>\u8bb0\u5f55\u4e4b\u95f4\u7684\u5206\u9694\u7b26\u53ef\u7528 <code>RS</code> \u914d\u7f6e\uff0c\u8bb0\u5f55\u5185\u90e8\u7684\u5b57\u6bb5\u5206\u9694\u7b26\u53ef\u7528 <code>FS</code> \u6307\u5b9a\u3002</p> <p>\u4ee5\u4e0b\u4e3a\u6700\u7b80\u5355\u7684\u9010\u884c\u5904\u7406\uff0c\u6253\u5370\u6bcf\u884c\uff08<code>print $0</code>\uff09\u3002</p> <pre><code># \u53ef\u7b80\u5199\u4e3a awk 1 data2.txt\n$ awk '1{print}' data2.txt\nOne line of test text.\nTwo lines of test text.\nThree lines of test text.\n</code></pre> <p>\u53ef\u5728\u4e2d\u62ec\u53f7\u4e2d\u66ff\u6362 <code>print</code>\uff0c\u9488\u5bf9\u6bcf\u884c\u6267\u884c\u66f4\u591a\u7684\u5176\u4ed6\u64cd\u4f5c\u3002</p>"},{"location":"blog/20191106/13-read-by-line/#array","title":"array","text":"<pre><code>$ array=($(cat data2.txt))\n$ array=($(awk 1 data2.txt))\n</code></pre> <pre><code>$ echo $array\nOne line of test text. Two lines of test text. Three lines of test text.\n$ echo ${#array[*]}\n15\n</code></pre>"},{"location":"blog/20191106/13-read-by-line/#ifs","title":"IFS","text":"<p>\u4ee5\u4e0a\u793a\u4f8b\u4e2d\uff0c\u4ece data2.txt \u4e2d\u8bfb\u5165\u6570\u636e\u5230 array \u6570\u7ec4\uff0c\u4f46\u662f\u6570\u7ec4\u957f\u5ea6\u4e0d\u662f3\uff0c\u800c\u662f15\uff01</p> <p>\u9020\u6210\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u662f\u7279\u6b8a\u7684\u73af\u5883\u53d8\u91cf <code>IFS</code>\uff08Internal Field Separator\uff09\uff0c\u53eb\u4f5c\u5185\u90e8\u5b57\u6bb5\u5206\u9694\u7b26\u3002  </p> <p>IFS\u73af\u5883\u53d8\u91cf\u5b9a\u4e49\u4e86 bash shell \u7528\u4f5c\u5b57\u6bb5\u5206\u9694\u7b26\u7684\u4e00\u7cfb\u5217\u5b57\u7b26\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cbash shell \u4f1a\u5c06\u4e0b\u5217\u5b57\u7b26\u5f53\u4f5c\u5b57\u6bb5\u5206\u9694\u7b26\uff1a</p> <ul> <li>\u7a7a\u683c  </li> <li>\u5236\u8868\u7b26  </li> <li>\u6362\u884c\u7b26  </li> </ul> <p>\u5728 man bash \u7684 PARAMETERS \u7ae0\u8282\u4e2d\u6709\u5bf9 IFS \u7684\u5b9a\u4e49\u548c\u8bf4\u660e\uff1a</p> <p>IFS The Internal Field Separator that is used for word splitting after expansion and to split lines into words with the read builtin command. The default value is <code>&lt;space&gt;&lt;tab&gt;&lt;newline&gt;</code>.</p> <p>\u5982\u679c bash shell \u5728\u6570\u636e\u4e2d\u770b\u5230\u4e86\u8fd9\u4e9b\u5b57\u7b26\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\uff0c\u5b83\u5c31\u4f1a\u5047\u5b9a\u8fd9\u8868\u660e\u4e86\u5217\u8868\u4e2d\u4e00\u4e2a\u65b0\u6570\u636e\u5b57\u6bb5\u7684\u5f00\u59cb\u3002</p> <p>\u547d\u4ee4\u884c\u6267\u884c <code>\"$IFS\"</code> \u4f1a\u63d0\u793a\u975e\u547d\u4ee4\uff0c\u770b\u5230 IFS \u7684\u503c\u3002</p> <pre><code>$ \"$IFS\"\nzsh: command not found:  \\t\\n\n</code></pre> <p>data2.txt \u4e2d\u67093\u884c\uff0c\u4f46\u662f\u6bcf\u4e00\u884c\u5355\u8bcd\u4e4b\u95f4\u4ee5\u7a7a\u683c\u5206\u5272\uff0c\u5bfc\u81f4for\u5faa\u73af\u8bfb\u53d6\u4e8615\u4e2a\u5355\u8bcd\uff0c\u800c\u975e\u4e09\u884c\u3002 \u82e5\u60f3\u6309\u884c\u8bfb\u5165\u6570\u7ec4\uff0c\u53ef\u4e34\u65f6\u66f4\u6539\u73af\u5883\u53d8\u91cf IFS \u7684\u503c\uff0c\u6267\u884c\u524d\u4fdd\u5b58\u65e7\u503c\uff0c\u6267\u884c\u540e\u6062\u590d\u3002</p> <pre><code>$ OLDIFS=$IFS\n$ IFS=$'\\n'\n$ array=($(cat data2.txt))\n$ echo ${#array[@]}\n3\n\n$ for line in ${array[@]}; do\n$ for&gt; echo $line\n$ for&gt; done\nOne line of test text.\nTwo lines of test text.\nThree lines of test text.\n\n$ IFS=$OLDIFS # restore\n</code></pre> <p>\u4ee5\u4e0b\u4e3a\u5728\u811a\u672c\u4e2d\u9010\u884c\u8bfb\u53d6\uff0c\u5e76\u9644\u5e26\u6253\u5370\u884c\u53f7\uff1a</p> <pre><code>#!/bin/bash\n\nfilename=$1\n\nOLDIFS=$IFS\nIFS=$'\\n'\ni=0\n\nfor line in `cat $filename`; do\n    echo \"$((i++)) : $line\" \ndone\n\nIFS=$OLDIFS # restore\n\nexit 0\n</code></pre> <p>\u6267\u884c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>$ ./dumpFileLines.sh data2.txt\n0 : One line of test text.\n1 : Two lines of test text.\n2 : Three lines of test text.\n</code></pre>"},{"location":"blog/20191106/13-read-by-line/#while","title":"while","text":"<p>Read a file line by line assigning the value to a variable</p> <p>standard form for reading lines from a file in a loop.</p> <pre><code>while IFS= read -r line; do\n    echo \"Text read from file: $line\"\ndone &lt; my_filename.txt\n</code></pre> <ul> <li><code>IFS=</code> (or <code>IFS=''</code>) prevents leading/trailing whitespace from being trimmed.  </li> <li><code>-r</code> prevents backslash escapes from being interpreted.  </li> </ul> <p>Or you can put it in a bash file helper script, example contents:</p> <pre><code>#!/bin/bash\n\nwhile IFS= read -r line; do\n    echo \"Text read from file: $line\"\ndone &lt; \"$1\"\n</code></pre> <p>If the file isn\u2019t a standard POSIX text file (= not terminated by a newline character), the loop can be modified to handle trailing partial lines:</p> <pre><code>while IFS= read -r line || [[ -n \"$line\" ]]; do\n    echo \"Text read from file: $line\"\ndone &lt; \"$1\"\n</code></pre> <p>Here, <code>|| [[ -n $line ]]</code> prevents the last line from being ignored if it doesn't end with a <code>\\n</code> (since read returns a non-zero exit code when it encounters EOF).</p> <pre><code>#! /bin/bash\ncat filename | while read LINE; do\n    echo $LINE\ndone\n</code></pre> <p>cat \u91cd\u5b9a\u5411\u5355\u884c\u7b80\u5199\uff1a<code>cat data2.txt | ( while read line; do echo $line; done )</code></p>"},{"location":"blog/20191106/15-sh-daemon1/","title":"Linux Shell Program - daemon 1","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u540e\u53f0\u6267\u884c\u3002</p> <p>vscode \u5728 <code>launch.json</code> \u4e2d\u5982\u4f55\u9884\u542f\u52a8 proxy daemon sh \u811a\u672c\uff1f Android Studio <code>Before launch</code> \u5982\u4f55\u542f\u52a8 proxy daemon sh \u811a\u672c\uff1f  </p>"},{"location":"blog/20191106/15-sh-daemon1/#sh","title":"sh","text":"<p>\u53ef\u4ee5\u65b0\u5f00 <code>xterm -e</code> \u6216\u901a\u8fc7 <code>screen</code> \u6267\u884c\u811a\u672c\u3002</p> <p>How to have terminal open when running shell script? Run a shell script in new terminal from current terminal How can I make a script that opens terminal windows and executes commands in them? </p> <p>How to Run Linux Commands in Background </p> <pre><code># suppress the stdout and stderr messages\n# redirect stdout to /dev/null and stderr to stdout\ncommand &gt; /dev/null 2&gt;&amp;1 &amp;\n</code></pre> <p><code>disown</code>: remove the job from the shell\u2019s job control</p> <p><code>nohup</code> stands for no hangup, ignores all hangup signals(SIGHUP). <code>SIGHUP</code> is a signal that is sent to a process when its controlling terminal is closed. If you log out or close the terminal, the process is not terminated.</p> <pre><code># output is redirected to the nohup.out file\nnohup command &amp;\n</code></pre> <p>Screen or GNU Screen is a terminal multiplexer program that allows you to start a screen session and open any number of windows (virtual terminals) inside that session. Processes running in Screen will continue to run when their window is not visible even if you get disconnected.</p> <p>Tmux is a modern alternative to GNU screen. With Tmux, you can also create a session and open multiple windows inside that session. Tmux sessions are persistent, which means that programs running in Tmux continue to run even if you close the terminal.</p> <p>How to Run Linux Shell Command / Script in Background </p> <p>the command will still print the output to <code>STDOUT</code> or <code>STDERR</code> which will prevent you from executing other commands on the terminal.</p> <pre><code>command &amp;\n</code></pre> <p>A better approach is to redirect the command to <code>/dev/null</code> and later append the ampersand sign at the end as shown</p> <pre><code>$ command &amp;&gt;/dev/null &amp;\n</code></pre> <p>Another way you can run a command in the background is using the <code>nohup</code> command. The <code>nohup</code> command, short for no hang up, is a command that keeps a process running even after exiting the shell.</p> <p>It does this by blocking the processes from receiving a SIGHUP (Signal Hang UP) signal which is a signal that is typically sent to a process when it exits the terminal.</p> <p>To send a command or script in the background and keep it running, use the syntax:</p> <pre><code>$ nohup command &amp;&gt;/dev/null &amp;\n$ nohup shell-script.sh &amp;&gt;/dev/null &amp;\n</code></pre> <p>How to run a shell script in background? </p> <p>just add a <code>&amp;</code> to the end of the command</p> <pre><code>command &amp;\nscript.sh &amp;\n</code></pre> <p>If you are running it in a terminal, and you want to then close the terminal, use <code>nohup</code> or <code>disown</code></p> <pre><code># nohup\nnohup script.sh &amp;\n\n# disown\nscript &amp;\ndisown\n</code></pre> <p>If you want the script to remain after closing the terminal, another option is to use <code>setsid</code>:</p> <pre><code>setsid script.sh\n</code></pre> <p>For more information about the differences between nohup, disown, &amp; and setsid: Difference between nohup, disown and &amp;.</p> <p>you can just switch <code>screen</code> and run your script on that 2nd screen. When script started on 2nd, switch back to 1st and do whatever you want. 2nd screen will be in the background as extra \"terminal window\". and it will not stop processing even when you close your ssh connection while beeing at 1st screen.</p> <p>How to run a command in the background and get no output? </p> <p>Use nohup if your background job takes a long time to finish.</p> <p>Redirect the stdout and stderr to <code>/dev/null</code> to ignore the output.</p> <pre><code>nohup /path/to/your/script.sh &gt; /dev/null 2&gt;&amp;1 &amp;\n</code></pre> <p>Redirect the output to a file like this:</p> <pre><code># redirect both stdout and stderr to the same file\n./a.sh &gt; somefile 2&gt;&amp;1 &amp;\n# redirect stdout and stderr to two different files\n./a.sh &gt; stdoutfile 2&gt; stderrfile &amp;\n</code></pre> <p>You can use <code>/dev/null</code> as one or both of the files if you don't care about the stdout and/or stderr.</p> <p>redirects output to null and keeps screen clear:</p> <pre><code>command &amp;&gt;/dev/null &amp;\n</code></pre> <p>Run in a subshell to remove notifications and close STDOUT and STDERR:</p> <pre><code>(&amp;&gt;/dev/null script.sh &amp;)\n</code></pre> <p>If they are in the same directory as your script that contains:</p> <pre><code>./a.sh &gt; /dev/null 2&gt;&amp;1 &amp;\n./b.sh &gt; /dev/null 2&gt;&amp;1 &amp;\n</code></pre> <ul> <li>The <code>&amp;</code> at the end is what makes your script run in the background.</li> <li>The <code>&gt; /dev/null 2&gt;&amp;1</code> part is not necessary - it redirects the stdout and stderr streams, so you don't have to see them on the terminal, which you may want to do for noisy scripts with lots of output.</li> </ul> <p>If you want to run the script in a linux kickstart you have to run as below .</p> <pre><code>sh /tmp/script.sh &gt; /dev/null 2&gt;&amp;1 &lt; /dev/null &amp;\n</code></pre> <p>These examples work fine, it works in background and does not show any output.</p> <pre><code>nohup sh prog.sh proglog.log 2&gt;&amp;1 &amp;\n</code></pre>"},{"location":"blog/20191106/15-sh-daemon1/#scpt","title":"scpt","text":"<p>macOS AppleScript \u811a\u672c\u540e\u7f00\uff1a<code>.scpt</code>, <code>.applescript</code>\u3002</p> <p>How can Apple Script open a shell script with options in a Terminal window?</p> <pre><code>tell application \"Terminal\"\n    do script \"~/testscript\" &amp; \" -arg1\" &amp; \" -arg2\"\nend tell\n</code></pre> <p>do shell script without waiting how to call a applescript/shell script without waiting for it How to run multiple shell scripts from applescript in background </p> <ul> <li>do shell script in AppleScript</li> </ul> <p>I want to start a background server process; how do I make do shell script not wait until the command completes?</p> <p>Use do shell script \"command &amp;&gt; file_path &amp;\". do shell script will return immediately with no result and your AppleScript script will be running in parallel with your shell script. The shell script\u2019s output will go into <code>file_path</code>; if you don\u2019t care about the output, use <code>/dev/null</code>. There is no direct support for getting or manipulating the background process from AppleScript, but see the next question.</p> <pre><code>do shell script \"/bin/blah &amp;&gt; /dev/null &amp;\"\ndo shell script \"/bin/blah &gt; /dev/null 2&gt;&amp;1 &amp;\"\ndo shell script \"/bin/blah &amp;&gt; /dev/null &amp; echo $!\" # dump process ID\n</code></pre> <p>The AppleScript code to run two commands in the background would look like this:</p> <pre><code>set pid1 to do shell script command1 &amp; \" &amp;&gt; /dev/null &amp; echo $!\"\nset pid2 to do shell script command2 &amp; \" &amp;&gt; /dev/null &amp; echo $!\"\n</code></pre> <p>The <code>pid1</code> and <code>pid2</code> variables will be set to the process ids of the two commands.  You can later check whether the commands are still running by calling a function like this one:</p> <pre><code>on isProcessRunning(pid)\n    try\n        do shell script \"kill -0 \" &amp; pid\n        set isRunning to true\n    on error\n        set isRunning to false\n    end try\n    return isRunning\nend isProcessRunning\n</code></pre>"},{"location":"blog/20191106/16-sh-daemon2/","title":"Linux Shell Program - daemon 2","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u540e\u53f0\u6267\u884c\u5b88\u62a4\u8fdb\u7a0b\u3002</p> <p>vscode \u5728 <code>launch.json</code> \u4e2d\uff0c\u901a\u8fc7 preLaunchTask \u6307\u5b9a <code>tasks.json</code> \u4e2d\u914d\u7f6e\u7684 task label\uff08isBackground\uff09\uff0c\u5b9e\u73b0\u9884\u542f\u52a8 proxy daemon\u3002 Android Studio \u53ef\u901a\u8fc7 <code>Before launch</code> \u542f\u52a8 proxy sh \u811a\u672c\uff0c\u5982\u4f55\u5728 Run \u8fd0\u884c\u5b8c\u65f6\uff0cproxy \u7a0b\u5e8f\u4f9d\u65e7\u5728\u540e\u53f0\u5b88\u62a4\uff08daemon\uff09\u4e0d\u9000\u51fa\uff1f  </p> <p>Android Studio - \u521b\u5efa\u548c\u4fee\u6539\u8fd0\u884c/\u8c03\u8bd5\u914d\u7f6e -\u5b9a\u4e49\u542f\u52a8\u4e4b\u524d\u7684\u64cd\u4f5c </p>"},{"location":"blog/20191106/16-sh-daemon2/#demo","title":"demo","text":"<p>\u7528\u4f8b1\uff1awhile true \u5faa\u73af\u6bcf\u96943s\u5411\u63a7\u5236\u53f0\u8f93\u51fa\u4e00\u53e5\u65e5\u5fd7\uff0c\u540c\u65f6\u901a\u8fc7 tee \u5c06\u65e5\u5fd7\u91cd\u5b9a\u5411\u4e00\u4efd\u5230\u65e5\u5fd7\u6587\u4ef6\u3002</p> <pre><code>$ cat while_loop.sh\n#!/usr/bin/env bash\n\nwhile true; do\n    echo \"$(date): loop\" | tee while_loop.log\n    sleep 3\ndone\n</code></pre> <p>\u7528\u4f8b2\uff1a\u901a\u8fc7 <code>python3 -m</code> \u542f\u52a8 http.server \u6a21\u5757\uff0c\u8fd0\u884c Web Server Daemon\uff0c\u5e76\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u65e5\u5fd7\u6587\u4ef6\u3002</p> <pre><code>$ cat serve_daemon.sh\n#!/usr/bin/env bash\n\npython3 -m http.server 8000 -b 0.0.0.0 -d ../web 2&gt;&amp;1 | tee serve_daemon.log\n</code></pre> <p>\u53ef\u65b0\u5efaTerminal tab\u8fd0\u884csh\u811a\u672c\uff0c\u624b\u52a8\u5173\u95edtab\u6216\u8f93\u5165 <code>exit</code> \u9000\u51fa\u5f53\u524dshell\u3002 \u4e5f\u53ef\u5728\u5f53\u524dTerminal tab\u4e2d\u6267\u884c <code>bash</code> \u65b0\u5efa\u5b50shell\u8fd0\u884c\u6d4b\u8bd5\uff0c\u6267\u884c <code>exit</code> \u9000\u51fa\u5b50shell\u3002</p> <p>\u5f53 bash exit \u6216 Terminal tab\u6216window \u7a97\u53e3\u5173\u95ed\u540e\uff1a</p> <ol> <li>\u53ef\u6267\u884c <code>tail -f *.log</code> \u6eda\u52a8\u67e5\u770b\u65e5\u5fd7\uff0c\u4ee5\u786e\u8ba4daemon\u662f\u5426\u8fd8\u5728\u8fd0\u884c\u3002  </li> <li>\u901a\u8fc7 <code>ps | grep</code> \u5339\u914d\u67e5\u627e CMD \u5bf9\u5e94\u7684\u8fdb\u7a0b PID\uff1a</li> </ol> <pre><code>ps -ef | grep while_loop | grep -v grep\n</code></pre> <ol> <li>\u53ef\u8fdb\u4e00\u6b65\u6267\u884c <code>ps | grep | xargs kill</code> \u6740\u6389\u540e\u53f0\u8fdb\u7a0b\uff1a</li> </ol> <pre><code>ps -ef | grep while_loop | grep -v grep | awk '{print $2}' | xargs kill -KILL\n</code></pre>"},{"location":"blog/20191106/16-sh-daemon2/#_1","title":"&amp;","text":"<p>man bash - SHELL GRAMMAR - Lists</p> <p>If a command is terminated by the control operator <code>&amp;</code>, the shell executes the command in the background in a subshell.  The shell does not wait for the command to \ufb01nish, and the return status is 0.</p> <p>\u5728\u547d\u4ee4\u540e\u9762\u52a0\u4e0a <code>&amp;</code> \u7b26\u53f7\uff0c\u5373\u53ef\u5c06\u547d\u4ee4\u5207\u6362\u5230\u540e\u53f0\u5b50shell\u8fdb\u7a0b\u6267\u884c\uff0c\u4f46\u547d\u4ee4\u7684stdout\u548cstderr\u4ecd\u4f1a\u8f93\u51fa\u3002</p> <pre><code>command &amp;\n</code></pre> <p>\u540e\u53f0\u547d\u4ee4\u65f6\u4e0d\u65f6\u8f93\u51fa\u4fe1\u606f\u5230\u5f53\u524dshell\uff0c\u4f1a\u963b\u788d\u5728\u5f53\u524dshell\u6d41\u7545\u6e05\u6670\u5730\u6267\u884c\u5176\u4ed6\u547d\u4ee4\u4efb\u52a1\uff0c\u53ef\u8003\u8651\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u65e5\u5fd7\u6587\u4ef6\u3002</p> <pre><code># redirect both stdout and stderr to the same file\ncommand1 &gt; output.log 2&gt;&amp;1 &amp;\n# redirect stdout and stderr to two different files\ncommand2 &gt; stdout.log 2&gt; stderr.log &amp;\n</code></pre> <p>\u4e5f\u53ef\u5c06\u91cd\u5b9a\u5411\u5230 <code>/dev/null</code>\uff0c\u5ffd\u7565\u8f93\u51fa\u4fe1\u606f\uff1a</p> <pre><code># redirects stdout to /dev/null and stderr to stdout\ncommand &gt; /dev/null 2&gt;&amp;1 &amp;\n# suppress the `stdout` and `stderr` messages, keeps screen clear\ncommand &amp;&gt; /dev/null &amp;\n</code></pre>"},{"location":"blog/20191106/16-sh-daemon2/#sh","title":"sh","text":"<p>\u5f53\u7136\uff0c\u5728\u547d\u4ee4\u884c\u8fd0\u884csh\u811a\u672c\u65f6\uff0c\u4e5f\u53ef\u5728\u8fd9\u53e5\u8fd0\u884c\u547d\u4ee4\u540e\u9762\u52a0\u4e0a <code>&amp;</code>\uff0c\u5c06\u6574\u4e2ash\u811a\u672c\u7684\u8fd0\u884c\u5207\u5230\u540e\u53f0\u8fd0\u884c\u3002</p> <pre><code>script.sh &amp;\n</code></pre> <p>\u540e\u53f0sh\u65f6\u4e0d\u65f6\u8f93\u51fa\u4fe1\u606f\u5230\u5f53\u524dshell\uff0c\u4f1a\u963b\u788d\u5728\u5f53\u524dshell\u6d41\u7545\u6e05\u6670\u5730\u6267\u884c\u5176\u4ed6\u547d\u4ee4\u4efb\u52a1\uff0c\u53ef\u8003\u8651\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u65e5\u5fd7\u6587\u4ef6\u3002</p> <pre><code># redirect both stdout and stderr to the same file\n./a.sh &gt; output.log 2&gt;&amp;1 &amp;\n# redirect stdout and stderr to two different files\n./a.sh &gt; stdout.log 2&gt; stderr.log &amp;\n</code></pre> <p>\u4e5f\u53ef\u5c06\u91cd\u5b9a\u5411\u5230 <code>/dev/null</code>\uff0c\u5ffd\u7565\u8f93\u51fa\u4fe1\u606f\uff1a</p> <pre><code># ignore noisy output\n./a.sh &gt; /dev/null 2&gt;&amp;1 &amp;\n./b.sh &amp;&gt; /dev/null &amp;\n</code></pre> <pre><code># run in a subshell to remove notifications\n(&amp;&gt;/dev/null c.sh &amp;)\n# run the script in a linux kickstart\nsh /tmp/script.sh &gt; /dev/null 2&gt;&amp;1 &lt; /dev/null &amp;\n</code></pre>"},{"location":"blog/20191106/16-sh-daemon2/#test","title":"test","text":"<p>\u6d4b\u8bd51\uff1a\u5728 while_loop.sh \u4e2d done \u672b\u5c3e\u6dfb\u52a0 <code>&amp;</code>\uff0c\u7136\u540e\u6267\u884c <code>./while_loop.sh</code>\u3002 \u6d4b\u8bd52\uff1a\u6267\u884c <code>./while_loop.sh &amp;</code>\u3002  </p> <p>\u6267\u884csh\u540e\uff0c\u901a\u8fc7 <code>ps | grep</code> \u67e5\u770b\u8fdb\u7a0b\u4fe1\u606f\uff1a</p> <pre><code>$ ps -ef | grep while_loop | grep -v grep\n#  UID   PID  PPID   C STIME   TTY           TIME CMD\n  501 52498     1   0  9:05AM ttys015    0:00.01 bash ./while_loop.sh\n</code></pre> <p>\u5f53\u6267\u884csh\u6240\u5728\u7684\u5b50bash shell\u6267\u884cexit\u9000\u51fa\u65f6TTY\u8fd8\u5728\uff0c\u5f53bash shell\u6240\u5728Terminal tab\u5173\u95ed\u65f6TTY\u53d8\u4e3a??\u3002</p> <pre><code>$ ps -ef | grep while_loop | grep -v grep\n#  UID   PID  PPID   C STIME   TTY           TIME CMD\n  501 52498     1   0  9:05AM ??         0:00.02 bash ./while_loop.sh\n</code></pre> <p>\u6d4b\u8bd51\uff1a</p> <ul> <li>exit\u5f53\u524dbash shell\u6216\u5173\u95ed\u5f53\u524dTerminal tab\uff0c\u6216\u5173\u95ed\u6574\u4e2aTerminal windown\u8fdb\u7a0b\u65f6\uff0csh\u811a\u672c\u8fdb\u7a0b\u4f9d\u7136\u5728\u540e\u53f0\u6267\u884c\u3002</li> </ul> <p>\u6d4b\u8bd52\uff1a</p> <ul> <li>exit\u5f53\u524dbash shell\u6216\u5173\u95ed\u5f53\u524dTerminal tab\uff0csh\u811a\u672c\u540e\u53f0\u5b50\u8fdb\u7a0b\u4e5f\u5c06\u9000\u51fa\uff1b</li> <li>\u6267\u884cbash\u6253\u5f00\u65b0shell\uff0c\u4f9d\u6b21exit\u5b50bash shell\u3001bash shell\uff08\u6216\u5173\u95ed\u5f53\u524dTerminal tab\uff09\uff0c\u6216\u5173\u95ed\u6574\u4e2aTerminal windown\u8fdb\u7a0b\u65f6\uff0csh\u811a\u672c\u8fdb\u7a0b\u4f9d\u7136\u5728\u540e\u53f0\u6267\u884c\u3002</li> </ul>"},{"location":"blog/20191106/16-sh-daemon2/#nohup","title":"nohup","text":"<p><code>nohup</code> \u610f\u5373 no hang up\uff0c\u5f53\u6240\u5728\u7684 Terminal window \u8fdb\u7a0b\u5173\u95ed\u65f6\uff0c\u5ffd\u7565 Terminal \u7236\u8fdb\u7a0b\u53d1\u51fa\u7684 SIGHUP \u4fe1\u53f7\u3002</p> <p>\u5f53\u5173\u95ed Terminal window \u8fdb\u7a0b\u65f6\uff0csh\u811a\u672c\u540e\u53f0\u8fdb\u7a0b\u4e0d\u4f1a\u9000\u51fa\u3002</p> <pre><code>NAME\n     nohup -- invoke a utility immune to hangups\n\nSYNOPSIS\n     nohup [--] utility [arguments]\n\nDESCRIPTION\n     The nohup utility invokes utility with its arguments and at this time sets the signal SIGHUP to be\n     ignored.  If the standard output is a terminal, the standard output is appended to the file nohup.out\n     in the current directory.  If standard error is a terminal, it is directed to the same place as the\n     standard output.\n</code></pre> <p>Use <code>nohup</code> if your background job takes a long time to finish.</p> <pre><code>nohup command &amp;\n# \u76f8\u5f53\u4e8e\nnohup command &amp;&gt; nohup.out &amp;\n</code></pre> <p>To send a command or script in the background and keep it running, use the syntax.</p> <pre><code># it works in background and does not show any output.\n$ nohup sh prog.sh proglog.log 2&gt;&amp;1 &amp;\n</code></pre> <p>redirect the stdout and stderr to <code>/dev/null</code> to ignore the output.</p> <pre><code>$ nohup command &amp;&gt;/dev/null &amp;\n$ nohup script.sh &amp;&gt;/dev/null &amp;\n$ nohup script.sh &gt; /dev/null 2&gt;&amp;1 &amp;\n</code></pre>"},{"location":"blog/20191106/2-sh-shellcheck/","title":"Linux Shell Program - shellcheck","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u8bed\u6cd5\u68c0\u67e5\u5de5\u5177 \u2014\u2014 shellcheck\u3002</p> <p>Google Shell \u98ce\u683c\u6307\u5357</p>"},{"location":"blog/20191106/2-sh-shellcheck/#android_studio","title":"Android Studio","text":"<p>Android Studio \u6253\u5f00 sh \u811a\u672c\u65f6\uff0c\u4f1a\u5efa\u8bae\u5b89\u88c5 Shell Script \u63d2\u4ef6\u3002</p> <p>Integration with external tools:</p> <ul> <li>ShellCheck,  </li> <li>Shfmt,  </li> <li>Explainshell </li> </ul>"},{"location":"blog/20191106/2-sh-shellcheck/#reformat","title":"Reformat","text":"<p>Android Studio \u901a\u8fc7\u83dc\u5355 Code - Reformat \u53ef\u683c\u5f0f\u5316\u5f53\u524d\u6587\u6863\uff0cmacOS \u4e0b\u7684 \u952e\u76d8\u5feb\u6377\u952e \u4e3a \u2318\u2325L\u3002 \u6267\u884c\u683c\u5f0f\u5316\u5f53\u524dsh\u811a\u672c\u65f6\uff0c\u4f1a\u67e5\u627e\u5f53\u524d\u8bed\u8a00\u7684\u683c\u5f0f\u5316\u5de5\u5177\uff0c\u4e0b\u8f7d\u5b89\u88c5 shell script formatter - shfmt\u3002</p> <p>Shell Script \u63d2\u4ef6\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u7f29\u8fdb\u4e3a2\u4e2a\u7a7a\u683c\uff0c\u53ef\u8003\u8651\u5bf9\u9f50 vscode \u7b49\u7f16\u8f91\u5668 use 4-space wide tab\uff0c\u5177\u4f53\u5230 Prefs Settings -&gt; Editor -&gt; Code Style -&gt; Shell Script \u4fee\u6539 Tab Size \u548c Indent \u4e3a 4\u3002</p>"},{"location":"blog/20191106/2-sh-shellcheck/#vscode","title":"vscode","text":"<p>macOS \u4e0b\u5148\u7528 brew \u5b89\u88c5 shellcheck \u548c shfmt \u5de5\u5177\uff1a</p> <ul> <li>shellcheck: Static analysis and lint tool, for (ba)sh scripts  <ul> <li>ShellCheck wiki</li> </ul> </li> <li>shfmt: Autoformat shell script source code  <ul> <li>shfmt documentation</li> </ul> </li> </ul> <pre><code>$ brew install shellcheck\n$ brew install shfmt\n</code></pre> <p>\u7136\u540e\u5728 vscode \u4e2d\u641c\u7d22\u5b89\u88c5 shellcheck \u548c shfmt \u4e24\u4e2a\u63d2\u4ef6\uff1a</p> <ul> <li>shellcheck </li> <li>shfmt </li> </ul> <p>shellcheck \u9ed8\u8ba4\u914d\u7f6e\u4e86 <code>\"shellcheck.run\": \"onType\"</code>\uff0c\u7f16\u5199\u4ee3\u7801\u65f6\u5b9e\u65f6\u68c0\u67e5\u3002</p> <p>\u5982\u679c\u9047\u5230 shellcheck \u62a5\u9519\uff0c\u53ef\u4ee5\u5728 Finding documentation for a check \u70b9\u51fb\u67e5\u8be2\u5177\u4f53\u67d0\u4e00\u4e2a SC \u63d0\u793a\u8bf4\u660e\u6587\u6863\u3002</p> <p>\u5728 vscode \u4e2d\uff0c\u6253\u5f00\u7f16\u8f91 sh \u811a\u672c\u6587\u4ef6\uff0c\u53ef\u901a\u8fc7 <code>\u21e7\u2318P</code> \u8c03\u8d77\u63a7\u5236\u9762\u677f\u6267\u884c Format Document \u547d\u4ee4\uff08\u5feb\u6377\u952e <code>\u21e7\u2325F</code>\uff09 \u8c03\u7528 shfmt \u683c\u5f0f\u5316\u5f53\u524d\u6587\u6863\u3002</p>"},{"location":"blog/20191106/2-sh-shellcheck/#cases","title":"cases","text":"<p>\u4ee5\u4e0b\u662f get_lan_ip.sh \u811a\u672c\u4e2d\u7684\u90e8\u5206\u8b66\u544a\u5206\u6790\u3002</p> get_lan_ip.sh <pre><code>#!/bin/bash\n\n# shellcheck disable=2034\n\n# \u83b7\u53d6 macOS \u672c\u673a\u7f51\u53e3\u7684\u5c40\u57df\u7f51\u5730\u5740\uff08LAN IP\uff09\n# \u652f\u6301 Ethernet\u3001Wi-Fi\uff0c\u6682\u672a\u652f\u6301 Thunderbolt Bridge\n## output: lan_ip\nget_lan_ip() {\n    # \u7b80\u5355\u6b63\u5219\u5339\u914d\u4e00\u4e0bIP\u5730\u5740\uff0c\u65e0\u6cd5\u5224\u9519 192.168 \u8fd9\u79cd\u534a\u622a\u5730\u5740\uff0c\n    # \u5305\u542b\u4e86 [ -z \"$lan_ip\" ] \u672a\u5b9a\u4e49\u6216\u4e3a\u7a7a\u7b49\u60c5\u51b5\u3002\n    if ! [[ $lan_ip =~ ^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$ ]]; then\n        # \u83b7\u53d6\u6709\u7ebf\u7f51\u5361\u63a5\u53e3\u540d\u79f0\n        local has_eth=false\n        if networksetup -listallnetworkservices | grep -q 'Ethernet'; then\n            has_eth=true\n        fi\n        local eth_dev=''\n        local eth_status='inactive'\n        local eth_inet=''\n        if [ $has_eth = true ]; then\n            eth_dev=$(networksetup -listallhardwareports | awk '/Hardware Port: Ethernet/{getline; print $NF}')\n            if [ -n \"$eth_dev\" ]; then\n                eth_status=$(ifconfig \"$eth_dev\" | awk '/status:/{print $NF}')\n                if [ \"$eth_status\" = active ]; then\n                    eth_inet=$(ifconfig \"$eth_dev\" | awk '/inet /{print $2}')\n                    echo \"Ethernet $eth_dev : status=$eth_status, inet=$eth_inet\"\n                else\n                    echo \"Ethernet $eth_dev : status=$eth_status\"\n                fi\n            fi\n        fi\n        # \u83b7\u53d6\u65e0\u7ebf\u7f51\u5361\u63a5\u53e3\u540d\u79f0\n        local has_wlan=false\n        if networksetup -listallnetworkservices | grep -q 'Wi-Fi'; then\n            has_wlan=true\n        fi\n        local wlan_dev=''\n        local wlan_status='inactive'\n        local wlan_inet=''\n        if [ $has_wlan = true ]; then\n            wlan_dev=$(networksetup -listallhardwareports | awk '/Hardware Port: Wi-Fi/{getline; print $NF}')\n            if [ -n \"$wlan_dev\" ]; then\n                wlan_status=$(ifconfig \"$wlan_dev\" | awk '/status:/{print $NF}')\n                if [ \"$wlan_status\" = active ]; then\n                    # \u83b7\u53d6Wi-Fi SSID\n                    # local wlan_ssid=$(airport -I | awk '/ SSID/{print $2}')\n                    local wlan_ssid=''\n                    wlan_ssid=$(networksetup -getairportnetwork \"$wlan_dev\" | awk '{print $NF}')\n                    # \u83b7\u53d6 IPv4 \u5730\u5740\n                    wlan_inet=$(ifconfig \"$wlan_dev\" | awk '/inet /{print $2}')\n                    echo \"Wi-Fi $wlan_dev : status=$wlan_status, ssid=$wlan_ssid, inet=$wlan_inet\"\n                else\n                    echo \"Wi-Fi $wlan_dev : status=$wlan_status\"\n                fi\n            fi\n        fi\n\n        # \u6839\u636e\u7f51\u53e3\u6d3b\u8dc3\u72b6\u6001\uff0c\u4f18\u5148\u83b7\u53d6\u6709\u7ebf\u7f51\u7edc\n        # if eth not bootped, try get wlan\n        if [ $has_eth = true ] &amp;&amp; [ \"$eth_status\" = active ]; then\n            if [ -n \"$eth_inet\" ]; then\n                lan_ip=$eth_inet\n            elif [ $has_wlan = true ] &amp;&amp; [ \"$wlan_status\" = active ]; then\n                if [ -n \"$wlan_inet\" ]; then\n                    lan_ip=$wlan_inet\n                fi\n            fi\n        elif [ $has_wlan = true ] &amp;&amp; [ \"$wlan_status\" = active ]; then\n            if [ -n \"$wlan_inet\" ]; then\n                lan_ip=$wlan_inet\n            fi\n        fi\n    fi\n}\n</code></pre>"},{"location":"blog/20191106/2-sh-shellcheck/#sc2070","title":"SC2070","text":"<pre><code>if [ -n $eth_dev ]; then\n    ...\nfi\n</code></pre> <p>\u4ee5\u4e0a\u4ee3\u7801\u7247\u6bb5\u5c06\u62a5\u4e24\u4e2a\u8b66\u544a\uff1a</p> <ol> <li>SC2070: <code>-n</code> doesn't work with unquoted arguments. Quote or use <code>[[ ]]</code>.  </li> <li>SC2086: Double quote to prevent globbing and word splitting.  </li> </ol> <p>\u56e0\u4e3a <code>eth_dev</code> \u53ef\u80fd\u672a\u5b9a\u4e49\uff08unset\uff09\uff0c\u90a3\u4e48\u6b64\u65f6 $eth_dev \u88ab\u89c6\u4e3a\u666e\u901a\u5b57\u7b26\u4e32\uff0c\u4e0d\u7b26\u5408\u9884\u671f\u3002 \u6839\u636e ShellCheck \u7684\u9759\u6001\u8bed\u6cd5\u8b66\u544a\u63d0\u793a\uff0c\u6709\u4e24\u79cd\u4fee\u590d\u65b9\u6848\uff1a\uff081\uff09\u52a0\u53cc\u5f15\u53f7\u5b89\u5168\u89e3\u5f15\u7528\uff1b\uff082\uff09\u5c06\u5355\u4e2d\u62ec\u53f7\u6539\u4e3a\u53cc\u4e2d\u62ec\u53f7\u3002  </p>"},{"location":"blog/20191106/2-sh-shellcheck/#sc2181","title":"SC2181","text":"<pre><code>        # \u5224\u65ad\u662f\u5426\u5b58\u5728\u6709\u7ebf\u7f51\u53e3\n        local has_eth=false\n        networksetup -listallnetworkservices | grep -q 'Ethernet'\n        if [ $? -eq 0 ]; then\n            has_eth=true\n        fi\n</code></pre> <p>\u4ee5\u4e0a\u4ee3\u7801\u7247\u6bb5\u5c06\u62a5\u8b66\u544a SC2181: Check exit code directly with e.g. <code>if mycmd;</code>, not indirectly with <code>$?</code>.</p> <p>\u6839\u636e\u63d0\u793a\uff0c\u5efa\u8bae\u4e0d\u7528 <code>$?</code> \u6765\u5224\u65ad\u547d\u4ee4\u6267\u884c\u72b6\u6001\uff0c\u800c\u662f\u5c06\u547d\u4ee4\u8bed\u53e5\u76f4\u63a5\u653e\u5728 if \u7684 condition \u4f4d\u7f6e\uff1a</p> <pre><code>        # \u5224\u65ad\u662f\u5426\u5b58\u5728\u6709\u7ebf\u7f51\u53e3\n        local has_eth=false\n        if networksetup -listallnetworkservices | grep -q 'Ethernet'; then\n            has_eth=true\n        fi\n</code></pre>"},{"location":"blog/20191106/2-sh-shellcheck/#disable","title":"disable","text":"<ul> <li>Inline ignore messages #145 </li> <li>How to suppress irrelevant ShellCheck messages? </li> </ul> <ol> <li>\u5728 get_lan_ip.sh \u4e2d\u5f15\u5165\u540c\u76ee\u5f55\u7684\u811a\u672c aux_etc.sh\uff0c\u4ee5\u4e0b\u76f8\u5bf9\u5f15\u5165\u5c06\u4f1a\u62a5\u9519\uff1a</li> </ol> <p>SC1091: Not following: \"./aux_etc.sh\" was not specified as input (see shellcheck -x).</p> <pre><code># shellcheck source=\"./aux_etc.sh\"\nsource \"$(dirname \"$0\")\"/aux_etc.sh\n</code></pre> <p>\u5982\u679c\u786e\u8ba4\u903b\u8f91\u65e0\u8bef\uff0c\u53ef\u4ee5\u52a0\u4e00\u4e2a\u884c\u7981\u7528\u89c4\u5219 SC1091 \u7684 disable \u6ce8\u91ca\uff0c\u4ee5\u4fbf\u5ffd\u7565\u8b66\u544a\uff1a</p> <pre><code># shellcheck disable=SC1091\n# shellcheck source=\"./aux_etc.sh\"\nsource \"$(dirname \"$0\")\"/aux_etc.sh\n</code></pre> <ol> <li>\u5728\u5de5\u5177\u51fd\u6570\u811a\u672c aux_etc.sh \u4e2d\uff0c\u53ef\u80fd\u6709\u4e9b\u51fd\u6570\u5185\u4f1a\u5b9a\u4e49\u53d8\u91cf\uff0c\u6b64\u65f6 ShellCheck \u4f1a\u62a5\u9519\uff1a</li> </ol> <p>SC2034: foo appears unused. Verify it or export it.</p> <p>\u8fd9\u4e9b\u53d8\u91cf\u975e local\u3001\u975e export\uff0c\u9ed8\u8ba4\u4e3a\u5168\u5c40\u53d8\u91cf\uff0c\u8c03\u7528\u65b9\u53ef\u80fd\u4f1a\u5f15\u7528\u8fd9\u4e9b\u53d8\u91cf\u3002 \u6b64\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u6ce8\u91ca\u7981\u7528\u89c4\u5219 SC2034\uff0c\u4ee5\u4fbf\u5ffd\u7565\u76f8\u5173\u8b66\u544a\uff1a</p> <pre><code>#!/bin/bash\n\n# shellcheck disable=2034\n# shellcheck disable=SC2034\n</code></pre> <p>\u4e5f\u53ef\u5728\u4e00\u884c\u4e2d\u5ffd\u7565\u591a\u6761\u89c4\u5219\uff1a</p> <pre><code># shellcheck disable=SC1091,SC2034\n</code></pre>"},{"location":"blog/20191106/3-sh-xtrace/","title":"Linux Shell Program - xtrace","text":"<p>Linux \u4e0b\u7684 Shell \u8c03\u8bd5\u547d\u4ee4 \u2014\u2014 set -x / +x / -o\u3002</p> <p>Setting shell options</p> <p>How do I set and unset shell variable options?</p> <p>To set shell variable option use the following syntax:</p> <pre><code>set -o variableName\n</code></pre> <p>To unset shell variable option use the following syntax:</p> <pre><code>set +o variableName\n</code></pre> <p>5 Simple Steps On How To Debug A Bash Shell Script</p> <p>three basic types of errors:</p> <ul> <li>Syntax Error  </li> <li>Runtime Error  </li> <li>Logic Error  </li> </ul> <p>\u4e94\u6b65\u8c03\u8bd5\u6cd5\uff1a</p> <ol> <li>Step 1: Use a Consistent Debug Library  </li> <li>Step 2: Check For Syntax Error  </li> <li>Step 3: Trace Your Script Command Execution  </li> <li>Step 4: Use The Extended Debug Mode  </li> <li>Step 5: Provide Meaningful Debug Logs  </li> </ol>","tags":["set"]},{"location":"blog/20191106/3-sh-xtrace/#set","title":"set","text":"<p>Bash built-in: set -x (set -o xtrace) </p> <p><code>set -x</code> (long notation: <code>set -o xtrace</code>) traces commands before executing them.</p> <p>set\u547d\u4ee4\u53ef\u8f85\u52a9\u811a\u672c\u8c03\u8bd5\u3002</p> <p>\u4ee5\u4e0b\u662f set \u547d\u4ee4\u5e38\u7528\u7684\u8c03\u8bd5\u9009\u9879\uff1a</p> <ul> <li><code>set -n</code>\uff1a\u8bfb\u547d\u4ee4\u4f46\u5e76\u4e0d\u6267\u884c\u3002  </li> <li><code>set -v</code>\uff1a\u663e\u793a\u8bfb\u53d6\u7684\u6240\u6709\u884c\u3002  </li> <li><code>set -x</code>\uff1a\u663e\u793a\u6240\u6709\u547d\u4ee4\u53ca\u5176\u53c2\u6570\u3002  </li> </ul> <p>\u5c06set\u9009\u9879\u5173\u95ed\uff0c\u53ea\u9700\u7528 <code>+</code> \u66ff\u4ee3 <code>-</code>\u3002 \u6709\u4eba\u603b\u8ba4\u4e3a <code>+</code> \u5e94\u8be5\u4e3a\u5f00\uff0c\u800c <code>-</code> \u5e94\u4e3a\u5173\u95ed\uff0c\u4f46\u5b9e\u9645\u521a\u597d\u76f8\u53cd\u3002 \u53ef\u4ee5\u5728\u811a\u672c\u5f00\u59cb\u65f6\u5c06 set \u9009\u9879\u6253\u5f00\uff0c\u7136\u540e\u5728\u7ed3\u675f\u65f6\u5173\u95ed\u5b83\uff1b\u6216\u5728\u8ba4\u4e3a\u6709\u95ee\u9898\u7684\u7279\u6b8a\u8bed\u53e5\u6bb5\u524d\u540e\u7528 <code>-x</code> ~ <code>+x</code> \u8bbe\u7f6e\u95ed\u5408\u8c03\u8bd5\u533a\u57df\u3002</p> <p>bash shell\u73af\u5883\u53d8\u91cf <code>BASH_XTRACEFD</code> \u82e5\u8bbe\u7f6e\u6210\u4e86\u6709\u6548\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff080\u30011\u30012\uff09\uff0c\u5219 <code>set -x</code> \u8c03\u8bd5\u9009\u9879\u751f\u6210\u7684\u8ddf\u8e2a\u8f93\u51fa\u53ef\u88ab\u91cd\u5b9a\u5411\uff0c\u901a\u5e38\u7528\u6765\u5c06\u8ddf\u8e2a\u8f93\u51fa\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d\u3002</p>","tags":["set"]},{"location":"blog/20191106/3-sh-xtrace/#refs","title":"refs","text":"<p>Inline debug (xtrace) in scripts</p> <p>Turn on xtrace with environment variable</p> <p>how to silently disable xtrace in a shell script?</p> <p>Sandbox it in a subshell:</p> <pre><code>(set -x; do_thing_you_want_traced)\n</code></pre> <p>shell \u811a\u672c\u4e2dset -x \u4e0eset +x \u7684\u533a\u522b </p> <p>linux shell \u811a\u672c\u7f16\u5199\u597d\u8981\u7ecf\u8fc7\u6f2b\u957f\u7684\u8c03\u8bd5\u9636\u6bb5\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>sh -x</code> \u6267\u884c\u652f\u6301\u8c03\u8bd5\uff0c\u4f46\u662f\u5728\u8fdc\u7a0b\u8c03\u7528\u811a\u672c\u7684\u65f6\u5019\u6709\u8bf8\u591a\u4e0d\u4fbf\u3002</p> <p>\u8981\u60f3\u77e5\u9053\u811a\u672c\u5185\u90e8\u6267\u884c\u7684\u53d8\u91cf\u7684\u503c\u6216\u6267\u884c\u7ed3\u679c\uff0c\u53ef\u4ee5\u5728\u811a\u672c\u5185\u90e8\u7528 <code>set -x</code> \u7b49\u76f8\u5173\u547d\u4ee4\u5f00\u59cb\u8c03\u8bd5\u3002</p> <ul> <li><code>set -x</code>\uff1a\u5f00\u542f  </li> <li><code>set +x</code>\uff1a\u5173\u95ed  </li> <li><code>set -o</code>\uff1a\u67e5\u770b  </li> </ul> <p>Linux \u811a\u672c\u4e2d\u751f\u6210\u65e5\u5fd7 set -x</p> <ul> <li><code>set -x</code> \u662f\u5f00\u542f  </li> <li><code>set +x</code> \u662f\u5173\u95ed  </li> <li><code>set -o</code> \u662f\u67e5\u770b (xtrace)  </li> </ul> <p>\u9488\u5bf9\u90e8\u5206script\uff0c\u53ef\u4ee5\u9009\u62e9 <code>set -x</code> \u548c <code>set +x</code> \u914d\u5957\u4f7f\u7528\u3002\u6bd4\u5982\u5728\u4e00\u4e2a\u811a\u672c\u91cc\uff1a</p> <pre><code>set -x            # activate debugging from here\nw\nset +x            # stop debugging from here\n</code></pre> <p>\u89e3\u91cabash\u811a\u672c\u4e2dset -e\u4e0eset -o pipefail\u7684\u4f5c\u7528</p> <p><code>set -e</code>\uff1a\u8868\u793a\u4e00\u65e6\u811a\u672c\u4e2d\u6709\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u4e3a\u975e0\uff0c\u5219\u811a\u672c\u7acb\u5373\u9000\u51fa\uff0c\u540e\u7eed\u547d\u4ee4\u4e0d\u518d\u6267\u884c\u3002</p>","tags":["set"]},{"location":"blog/20191106/3-sh-xtrace/#debug","title":"DEBUG","text":"<p>\u524d\u9762\u4ecb\u7ecd\u7684\u8c03\u8bd5\u624b\u6bb5\u662fBash\u5185\u5efa\u7684\uff0c\u5b83\u4eec\u901a\u5e38\u4ee5\u56fa\u5b9a\u7684\u683c\u5f0f\u751f\u6210\u8c03\u8bd5\u4fe1\u606f\u3002 \u82e5\u9700\u8981\u4ee5\u81ea\u5b9a\u4e49\u683c\u5f0f\u663e\u793a\u8c03\u8bd5\u4fe1\u606f\uff0c\u5219\u53ef\u901a\u8fc7\u4f20\u9012 <code>_DEBUG</code> \u73af\u5883\u53d8\u91cf\u6765\u8fdb\u884c\u6b64\u7c7b\u8c03\u8bd5\u3002</p> <p>\u4e0b\u9762\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u5728\u6bcf\u4e00\u4e2a\u9700\u8981\u6253\u5370\u8c03\u8bd5\u4fe1\u606f\u7684\u8bed\u53e5\u524d\u52a0\u4e0aDEBUG\u3002</p> <p>\u5728Bash\u4e2d\uff0c\u547d\u4ee4 <code>:</code> \u544a\u8bc9shell\u4e0d\u8981\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c\u3002</p> <pre><code>#!/bin/bash \n\nfunction DEBUG() {\n    [ \"$_DEBUG\" == \"on\" ] &amp;&amp; $@ || :\n}\n\nfor i in {1..10}\ndo\n    DEBUG echo $i\ndone\n</code></pre> <p>\u5982\u679c\u6ca1\u6709\u628a <code>_DEBUG=on</code> \u4f20\u9012\u7ed9\u811a\u672c\uff0c\u90a3\u4e48\u8c03\u8bd5\u4fe1\u606f\u5c31\u4e0d\u4f1a\u6253\u5370\u51fa\u6765\u3002</p> <p>\u53ef\u4ee5\u5c06\u8c03\u8bd5\u5f00\u5173\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e\u4e3a\"on\"\uff0c\u518d\u8fd0\u884c\u4e0a\u9762\u7684\u811a\u672c\u6253\u5370\u8c03\u8bd5\u4fe1\u606f\uff1a</p> <pre><code>$ _DEBUG=on ./script.sh\n</code></pre>","tags":["set"]},{"location":"blog/20191106/4-sh-test/","title":"Linux Shell Program - test","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u6bd4\u8f83\u548c\u6d4b\u8bd5\u8868\u8fbe\u5f0f\u3002</p> <p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5728if\u8bed\u53e5\u4e2d\u770b\u5230\u7684\u90fd\u662f\u666e\u901ashell\u547d\u4ee4\u3002 \u4f60\u53ef\u80fd\u60f3\u95ee\uff0cif-then\u8bed\u53e5\u662f\u5426\u80fd\u6d4b\u8bd5\u547d\u4ee4\u9000\u51fa\u72b6\u6001\u7801\u4e4b\u5916\u7684\u6761\u4ef6\u5462\uff1f \u7b54\u6848\u662f\u4e0d\u80fd\u3002\u4f46\u5728bash shell\u4e2d\u6709\u4e2a\u597d\u7528\u7684\u5de5\u5177\u53ef\u4ee5\u5e2e\u4f60\u901a\u8fc7if-then \u8bed\u53e5\u6d4b\u8bd5\u5176\u4ed6\u6761\u4ef6\u3002</p> <p>test\u547d\u4ee4\u63d0\u4f9b\u4e86\u5728if-then\u8bed\u53e5\u4e2d\u6d4b\u8bd5\u4e0d\u540c\u6761\u4ef6\u7684\u9014\u5f84\u3002</p> <ol> <li>\u5982\u679ctest\u547d\u4ee4\u4e2d\u5217\u51fa\u7684\u6761\u4ef6\u6210\u7acb\uff0ctest\u547d\u4ee4\u5c31\u4f1a\u9000\u51fa\u5e76\u8fd4\u56de\u9000\u51fa\u72b6\u6001\u78010\u3002\u8fd9\u6837if-then\u8bed\u53e5\u5c31\u4e0e\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u4e2d\u7684if-then\u8bed\u53e5\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u5de5\u4f5c\u4e86\u3002  </li> <li>\u5982\u679c\u6761\u4ef6\u4e0d\u6210\u7acb\uff0ctest\u547d\u4ee4\u5c31\u4f1a\u9000\u51fa\u5e76\u8fd4\u56de\u975e\u96f6\u7684\u9000\u51fa\u72b6\u6001\u7801\uff0c\u8fd9\u4f7f\u5f97 if-then\u8bed\u53e5\u4e0d\u4f1a\u518d\u88ab\u6267\u884c\u3002  </li> </ol> <p>test\u547d\u4ee4\u7684\u683c\u5f0f\u975e\u5e38\u7b80\u5355\u3002</p> <pre><code>test condition\n</code></pre> <p>condition\u662ftest\u547d\u4ee4\u8981\u6d4b\u8bd5\u7684\u4e00\u7cfb\u5217\u53c2\u6570\u548c\u503c\u3002</p> <p>\u5f53\u7528\u5728if-then\u8bed\u53e5\u4e2d\u65f6\uff0ctest\u547d\u4ee4\u770b\u8d77\u6765\u662f\u8fd9\u6837\u7684\uff1a</p> <pre><code>if test condition\nthen\n    commands\nfi\n</code></pre> <p>\u5982\u679c\u4e0d\u5199 test \u547d\u4ee4\u7684 condition \u90e8\u5206\uff0c\u5b83\u4f1a\u4ee5\u975e\u96f6\u7684\u9000\u51fa\u72b6\u6001\u7801\u9000\u51fa\uff0c\u5e76\u6267\u884c elif/else \u8bed\u53e5\u5757\u3002</p> <p>bash shell \u63d0\u4f9b\u4e86\u53e6\u4e00\u79cd\u6761\u4ef6\u6d4b\u8bd5\u65b9\u6cd5\uff0c\u65e0\u9700\u5728 if-then \u8bed\u53e5\u4e2d\u58f0\u660e test \u547d\u4ee4\u3002</p> <pre><code>if [ condition ]\nthen\n    commands\nfi\n</code></pre> <p>\u65b9\u62ec\u53f7 \u5b9a\u4e49\u4e86\u6d4b\u8bd5\u6761\u4ef6\u3002</p> <p>\u6ce8\u610f\uff0c\u7b2c\u4e00\u4e2a\u65b9\u62ec\u53f7\u4e4b\u540e\u548c\u7b2c\u4e8c\u4e2a\u65b9\u62ec\u53f7\u4e4b\u524d\u5fc5\u987b\u52a0\u4e0a\u4e00\u4e2a\u7a7a\u683c\uff0c\u5426\u5219\u5c31\u4f1a\u62a5\u8bed\u6cd5\u9519\u3002</p> <p>test \u547d\u4ee4\uff08\u65b9\u62ec\u53f7\uff09\u53ef\u4ee5\u5224\u65ad\u4e09\u7c7b\u6761\u4ef6\uff1a</p> <ul> <li>\u6570\u503c\u6bd4\u8f83  </li> <li>\u5b57\u7b26\u4e32\u6bd4\u8f83  </li> <li>\u6587\u4ef6\u5c5e\u6027\u5224\u65ad  </li> </ul>"},{"location":"blog/20191106/4-sh-test/#\u65b9\u62ec\u53f7","title":"\u65b9\u62ec\u53f7","text":"<p>bash shell \u63d0\u4f9b\u4e86\u53e6\u4e00\u79cd\u6761\u4ef6\u6d4b\u8bd5\u65b9\u6cd5\uff0c\u65e0\u9700\u5728 if-then \u8bed\u53e5\u4e2d\u58f0\u660e test \u547d\u4ee4\u3002</p> <pre><code>if [ condition ]\nthen\n    commands\nfi\n</code></pre> <p>\u65b9\u62ec\u53f7 \u5b9a\u4e49\u4e86\u6d4b\u8bd5\u6761\u4ef6\u3002</p> <p>\u6ce8\u610f\uff0c\u7b2c\u4e00\u4e2a\u65b9\u62ec\u53f7\u4e4b\u540e\u548c\u7b2c\u4e8c\u4e2a\u65b9\u62ec\u53f7\u4e4b\u524d\u5fc5\u987b\u52a0\u4e0a\u4e00\u4e2a\u7a7a\u683c\uff0c\u5426\u5219\u5c31\u4f1a\u62a5\u9519\u3002</p> <p>test \u547d\u4ee4\u53ef\u4ee5\u5224\u65ad\u4e09\u7c7b\u6761\u4ef6\uff1a</p> <ol> <li>\u6570\u503c\u6bd4\u8f83  </li> <li>\u5b57\u7b26\u4e32\u6bd4\u8f83  </li> <li>\u6587\u4ef6\u6bd4\u8f83  </li> </ol>"},{"location":"blog/20191106/4-sh-test/#\u975e\u7a7a\u5224\u65ad","title":"\u975e\u7a7a\u5224\u65ad","text":"<p>\u65b9\u62ec\u53f7 <code>if [ condition ]</code>\uff08\u7b49\u6548 <code>test condition</code>\uff09\uff0c\u53ef\u7528\u4e8e\u53d8\u91cf\u5224\u7a7a\uff1a</p> <ol> <li>\u53d8\u91cf set \u6709\u503c\uff0c\u5219\u8fd4\u56de TRUE\uff1b  </li> <li>\u53d8\u91cf unset \u4e3a\u7a7a\uff0c\u5219\u8fd4\u56de FALSE\uff1b  </li> </ol> <pre><code>\u039e ~ \u2192 if [ $isAtHome ] ; then echo \"isAtHome\" ; fi\nisAtHome\n\u039e ~ \u2192 if [ $isAtOffice ] ; then echo \"isAtOffice\" ; fi\n\u039e ~ \u2192\n</code></pre>"},{"location":"blog/20191106/4-sh-test/#\u6570\u503c\u6bd4\u8f83","title":"\u6570\u503c\u6bd4\u8f83","text":"<p>\u4f7f\u7528 test \u547d\u4ee4\u6700\u5e38\u89c1\u7684\u60c5\u5f62\u662f\u5bf9\u4e24\u4e2a\u6570\u503c\u8fdb\u884c\u6bd4\u8f83\u3002\u6570\u503c\u6761\u4ef6\u6d4b\u8bd5\u53ef\u4ee5\u7528\u5728\u6570\u5b57\u548c\u53d8\u91cf\u4e0a\u3002</p> <p></p> <p>\u5bf9\u4e8e\u547d\u4ee4\u6267\u884c\u7684\u8fd4\u56de\u72b6\u6001\u7801\uff0c\u53ef\u6309\u6570\u503c\u5f62\u5f0f\u8fdb\u884c\u5224\u65ad\uff1a<code>if [ $? -eq 0 ]</code> or <code>if [ $? -ne 0 ]</code>\u3002</p>"},{"location":"blog/20191106/4-sh-test/#\u5b57\u7b26\u4e32\u6bd4\u8f83","title":"\u5b57\u7b26\u4e32\u6bd4\u8f83","text":"<p>\u6761\u4ef6\u6d4b\u8bd5\u8fd8\u5141\u8bb8\u6bd4\u8f83\u5b57\u7b26\u4e32\u503c\u3002\u6bd4\u8f83\u5b57\u7b26\u4e32\u6bd4\u8f83\u70e6\u7410\uff0c\u4f60\u9a6c\u4e0a\u5c31\u4f1a\u770b\u5230\u3002</p> <p></p> <ul> <li><code>[ -n string ]</code>\uff1a\u6d4b\u8bd5\u5b57\u7b26\u4e32\u975e\u7a7a\uff0c\u6210\u7acb\u8fd4\u56de0\uff1b  </li> <li><code>[ -z string ]</code>\uff1a\u6d4b\u8bd5\u5b57\u7b26\u4e32\u4e3a\u7a7a\uff0c\u6210\u7acb\u8fd4\u56de0\uff1b  </li> </ul> <p>\u5bf9\u4e8e\u547d\u4ee4\u6267\u884c\u7684\u8fd4\u56de\u72b6\u6001\u7801\uff0c\u4e5f\u53ef\u6309\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fdb\u884c\u5224\u65ad\uff1a<code>if [ \"$?\" = \"0\" ]</code> or <code>if [ \"$?\" != \"0\" ]</code>\u3002</p> <p>\u4ee5\u4e0b\u9488\u5bf9 <code>$isAtOffice</code> \u7684 <code>-n</code>/<code>-z</code> \u5224\u65ad\u5747\u6210\u7acb\uff01\uff1f</p> <pre><code>\u039e ~ \u2192 if [ -n $isAtOffice ] ; then echo \"isAtOffice\" ; fi\nisAtOffice\n# \u6216\u8005\n\u039e ~ \u2192 if [ -z $isAtOffice ] ; then echo \"not isAtOffice\" ; fi\nnot isAtOffice\n</code></pre> <p>\u9700\u8981\u5bf9\u53d8\u91cf\u5f15\u7528\u6dfb\u52a0\u53cc\u5f15\u53f7\u5b57\u7b26\u4e32\u5316\uff0c\u518d\u5224\u65ad\uff1a</p> <pre><code>\u039e ~ \u2192 if [ -n \"$isAtOffice\" ] ; then echo \"isAtOffice\" ; fi\n\u039e ~ \u2192\n\u039e ~ \u2192 if [ -z \"$isAtOffice\" ] ; then echo \"not isAtOffice\" ; fi\nnot isAtOffice\n</code></pre> <p>\u5f53\u7136\uff0c\u8fd8\u53ef\u4ee5\u8fd9\u6837\u5224\u7a7a\uff1a<code>\"$isAtOffice\" = \"\"</code>\u3002</p> <p>MacBook \u4e0a\u4e00\u822c\u6ca1\u6709\u6709\u7ebf\u7f51\u5361\uff0c\u6267\u884c awk \u5339\u914d\u4e3a\u7a7a\uff0c\u6253\u5370 eth_dev \u4e3a\u7a7a\uff1a</p> <pre><code>$ eth_dev=$(networksetup -listallhardwareports | awk '/Hardware Port: Ethernet/{getline; print $NF}')\n$ echo $eth_dev\n</code></pre> <p>\u4f46\u662f <code>[ -n $eth_dev ]</code> \u6d4b\u8bd5\u4e3a\u771f\uff1a</p> <pre><code>$ if [ -n $eth_dev ]; then echo \"not empty\"; fi\nnot empty\n</code></pre> <p>\u539f\u56e0\u662f awk \u672a\u5339\u914d\uff0c\u5b9e\u9645\u4e0a\u4e0d\u4f1a\u6267\u884c\u53d8\u91cf\u5b9a\u4e49\uff08\u53ca\u8d4b\u503c\uff09\uff0c\u5bf9\u4e8e unset \u7684 eth_dev\uff0c<code>$eth_dev</code> \u88ab\u5f53\u6210\u5b57\u7b26\u4e32\uff0c\u800c\u4e0d\u662f\u89e3\u5f15\u7528\u53d8\u91cf\uff01 \u4fee\u6539\u4e3a <code>[ -n \"$eth_dev\" ]</code> \u5219\u7b26\u5408\u9884\u671f\uff0c\u5219\u53cc\u5f15\u53f7\u5185\u90e8\u4f1a\u5c1d\u8bd5\u89e3\u5f15\u7528\uff0cunset \u53d8\u91cf\u7684\u503c\u4e3a\u7a7a\u4e32\u3002</p> <pre><code>$ if [ -n \"$eth_dev\" ]; then echo \"not empty\"; fi\n\n# \u6d4b\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6\n$ echo ${#eth_dev}\n0\n</code></pre> <p>\u53ef\u4ee5\u8fdb\u4e00\u6b65\u901a\u8fc7\u53d8\u91cf\u66ff\u6362\u6d4b\u8bd5\u6765\u9a8c\u8bc1\u4ee5\u4e0a\u95ee\u9898\u3002</p> <pre><code>$ echo \"${eth_dev:-unset_or_null}\"\nunset_or_null\n# macOS bash shell \u7248\u672c\u8f83\u4f4e\uff0c\u8fd4\u56de\u7a7a\n$ echo \"${eth_dev-unset}\"\n\n# ubuntu \u7b49\u65b0 bash shell\uff0c\u8fd4\u56deunset\n$ echo \"${eth_dev-unset}\"\nunset\n</code></pre> <p>\u4e3a\u4e86\u5b89\u5168\u8d77\u89c1\uff0c\u5bf9\u4e8e\u65b9\u62ec\u53f7\u4e2d\u5bf9\u53d8\u91cf\u7684\u5f15\u7528\u5224\u7a7a\uff0c\u5efa\u8bae\u52a0\u53cc\u5f15\u53f7\u786e\u4fdd\u89e3\u5f15\u7528\uff0c\u517c\u987e\u53d8\u91cf unset \u7684\u60c5\u51b5\u3002</p> <ul> <li> : if [ -n $var ]; then echo \"not empty\" ; fi </li> <li> : if [ -n \"$var\" ]; then echo \"not empty\" ; fi  </li> </ul>"},{"location":"blog/20191106/4-sh-test/#\u6587\u4ef6\u5c5e\u6027\u5224\u65ad","title":"\u6587\u4ef6\u5c5e\u6027\u5224\u65ad","text":"<p>\u6700\u540e\u4e00\u7c7b\u6bd4\u8f83\u6d4b\u8bd5\u5f88\u6709\u53ef\u80fd\u662f shell \u7f16\u7a0b\u4e2d\u6700\u4e3a\u5f3a\u5927\u3001\u4e5f\u662f\u7528\u5f97\u6700\u591a\u7684\u6bd4\u8f83\u5f62\u5f0f\u3002\u5b83\u5141\u8bb8\u4f60\u6d4b\u8bd5 Linux \u6587\u4ef6\u7cfb\u7edf\u4e0a\u6587\u4ef6\u548c\u76ee\u5f55\u7684\u72b6\u6001\u3002</p> <p></p> <p>Check if a directory exists in a shell script </p> <p>Linux / UNIX: Find Out If a Directory Exists or Not </p> <ol> <li>\u4ee5\u4e0b\u811a\u672c\u4f7f\u7528 <code>-d</code> \u5224\u65ad\u76ee\u5f55\u662f\u5426\u5b58\u5728\uff1a</li> </ol> <pre><code># \u5f53\u524d\u76ee\u5f55\u4e0b\u5982\u679c\u6709 `forms-debug` \u6587\u4ef6\u5939\u5219\u8fdb\u5165\uff0c\u5426\u5219\u5148\u521b\u5efa\u518d\u8fdb\u5165\u3002\n([ -d forms-debug ] || mkdir forms-debug) &amp;&amp; cd forms-debug\n</code></pre> <p>\u62ec\u53f7\u7684\u4f7f\u547d\u4ee4\u5217\u8868\u53d8\u6210\u4e86\u8fdb\u7a0b\u5217\u8868\uff0c\u751f\u6210\u4e86\u4e00\u4e2a\u5b50shell\u6765\u6267\u884c\u5bf9\u5e94\u7684\u547d\u4ee4\u3002</p> <ol> <li>\u53c2\u8003 Create Permanent aliases\uff0c\u8003\u8651\u5c06\u5e38\u7528\u7684\u4fbf\u6377\u547d\u4ee4\u6536\u96c6\u5728 <code>~/.bash_aliases</code>\uff0c\u7136\u540e\u5728 <code>~/.bashrc</code> \u6216 <code>~/.zshrc</code> \u4e2d\u5224\u65ad\u6587\u4ef6\u6709\u6548 source \u8f7d\u5165\u3002</li> </ol> <pre><code>if [ -f ~/.bash_aliases ]; then\n    . ~/.bash_aliases # source\nfi\n</code></pre> <ol> <li>\u5728 <code>/etc/zprofile</code> \u548c <code>/etc/profile</code> \u4e2d\u4f7f\u7528 <code>-x</code> \u6d4b\u8bd5\u811a\u672c\u53ef\u6267\u884c\uff0c\u7136\u540e eval \u6267\u884c\uff1a</li> </ol> <pre><code>$ cat /etc/zprofile\n\n# System-wide profile for interactive zsh(1) login shells.\n\n# Setup user specific overrides for this in ~/.zprofile. See zshbuiltins(1)\n# and zshoptions(1) for more details.\n\nif [ -x /usr/libexec/path_helper ]; then\n    eval `/usr/libexec/path_helper -s`\nfi\n</code></pre> <ol> <li>\u5728 <code>/etc/profile</code> \u4e2d\u4f7f\u7528 <code>-r</code> \u6d4b\u8bd5\u811a\u672c\u53ef\u8bfb\uff0c\u7136\u540e source \u5f15\u5165\uff1a</li> </ol> <pre><code>$ cat /etc/profile\n\n# System-wide .profile for sh(1)\n\nif [ -x /usr/libexec/path_helper ]; then\n    eval `/usr/libexec/path_helper -s`\nfi\n\nif [ \"${BASH-no}\" != \"no\" ]; then\n    [ -r /etc/bashrc ] &amp;&amp; . /etc/bashrc\nfi\n</code></pre> <ol> <li>\u5728 transfer.sh \u4e2d\u4f7f\u7528 <code>! -e</code> \u6392\u67e5\u6355\u83b7\u5904\u7406\u6587\u4ef6\u4e0d\u5b58\u5728\u7684\u60c5\u5f62\uff1a</li> </ol> <pre><code>        if [ ! -e \"$file\" ]; then\n            echo \"$file: No such file or directory\" &gt;&amp;2\n            return 1\n        fi\n        if [ -d \"$file\" ]; then\n            # ...\n        fi\n</code></pre>"},{"location":"blog/20191106/4-sh-test/#\u590d\u5408\u6761\u4ef6\u6d4b\u8bd5","title":"\u590d\u5408\u6761\u4ef6\u6d4b\u8bd5","text":"<p>if-then \u8bed\u53e5\u5141\u8bb8\u4f60\u4f7f\u7528\u5e03\u5c14\u903b\u8f91\u6765\u7ec4\u5408\u6d4b\u8bd5\u3002\u6709\u4e24\u79cd\u5e03\u5c14\u8fd0\u7b97\u7b26\u53ef\u7528\uff1a</p> <ul> <li>[ condition1 ] &amp;&amp; [ condition2 ]  </li> <li>[ condition1 ] || [ condition2 ]  </li> </ul> <p>\u7b2c\u4e00\u79cd\u5e03\u5c14\u8fd0\u7b97\u4f7f\u7528 AND \u5e03\u5c14\u8fd0\u7b97\u7b26\u6765\u7ec4\u5408\u4e24\u4e2a\u6761\u4ef6\u3002\u8981\u8ba9 then \u90e8\u5206\u7684\u547d\u4ee4\u6267\u884c\uff0c\u4e24\u4e2a\u6761\u4ef6\u90fd\u5fc5\u987b\u6ee1\u8db3\u3002 \u7b2c\u4e8c\u79cd\u5e03\u5c14\u8fd0\u7b97\u4f7f\u7528 OR \u5e03\u5c14\u8fd0\u7b97\u7b26\u6765\u7ec4\u5408\u4e24\u4e2a\u6761\u4ef6\u3002\u5982\u679c\u4efb\u610f\u6761\u4ef6\u4e3a TRUE\uff0cthen \u90e8\u5206\u7684\u547d\u4ee4\u5c31\u4f1a\u6267\u884c\u3002  </p> <p>\u8fd4\u56de\u503c\u548c\u6267\u884c\u7ed3\u679c\u7efc\u5408\u5224\u65ad\u793a\u4f8b\uff1a</p> <p><code>-a</code> \u9009\u9879\u7528\u6765\u5bf9\u5176\u4ed6\u4e24\u4e2a\u9009\u9879\u7684\u7ed3\u679c\u6267\u884c\u5e03\u5c14AND\u8fd0\u7b97\u3002</p> <pre><code>is_iosdeploy_installed()\n{\n    # ios-deploy -V | read ios_deploy_version # wrong???\n    ios_deploy_version=$(ios-deploy -V)\n    if [ $? -eq 0 -a $ios_deploy_version ]\n    # if test $ios_deploy_version\n    # if [ -n \"$ios_deploy_version\" ]\n    then\n        echo \"ios-deploy version: $ios_deploy_version\"\n        return 0\n    else\n        echo \"ios-deploy not found, PLS install first!!!\"\n        return 1\n    fi\n}\n</code></pre> <p>\u6ce8\u610f\u4ee5\u4e0b\u590d\u5408\u6761\u4ef6\u6d4b\u8bd5\u7684\u7efc\u5408\u793a\u4f8b\uff1a</p> <pre><code>if is_iosdeploy_installed\nthen\n    ios_deploy_device=`ios-deploy -c`\n    # if [ $? -eq 0 -a $ios_deploy_device ]         # [: too many arguments\n    # if [ $? -eq 0 ] &amp;&amp; [ $ios_deploy_device ]     # [: too many arguments\n    # if [[ $? -eq 0 ]] &amp;&amp; [[ $ios_deploy_device ]] # right, not recommended\n    if [ $? -eq 0 ] &amp;&amp; [ -n \"$ios_deploy_device\" ]  # SC2166 \u5efa\u8bae\u5199\u6cd5\n    then\n        echo $ios_deploy_device\n        main $@ # $*\n    else\n        echo \"ios-deploy detect failed!\"\n    fi\nfi\n</code></pre>"},{"location":"blog/20191106/4-sh-test/#if-then_\u7684\u9ad8\u7ea7\u7279\u6027","title":"if-then \u7684\u9ad8\u7ea7\u7279\u6027","text":"<p>bash shell \u63d0\u4f9b\u4e86\u4e24\u9879\u53ef\u5728 if-then \u8bed\u53e5\u4e2d\u4f7f\u7528\u7684\u9ad8\u7ea7\u7279\u6027\uff1a</p> <ul> <li>\u7528\u4e8e\u6570\u5b66\u8868\u8fbe\u5f0f\u7684\u53cc\u62ec\u53f7  </li> <li>\u7528\u4e8e\u9ad8\u7ea7\u5b57\u7b26\u4e32\u5904\u7406\u529f\u80fd\u7684\u53cc\u65b9\u62ec\u53f7  </li> </ul>"},{"location":"blog/20191106/4-sh-test/#\u53cc\u62ec\u53f7","title":"\u53cc\u62ec\u53f7","text":"<p>\u53cc\u62ec\u53f7\u547d\u4ee4 <code>(( expression ))</code> \u652f\u6301\u66f4\u591a\u7684\u6570\u5b66\u8fd0\u7b97\u7b26\u3002 \u53cc\u62ec\u53f7\u8868\u8fbe\u5f0f\u6709\u72b6\u6001\u8fd4\u56de\u7801\uff0c\u5f53\u8fd0\u7b97\u7ed3\u679c\u975e\u96f6\u65f6\uff0c\u8fd4\u56de0\uff1b\u5426\u5219\uff0c\u8fd4\u56de1\u3002 \u76f8\u6bd4test\u547d\u4ee4\u53ea\u80fd\u4f7f\u7528\u7b80\u5355\u7684\u7b97\u672f\u64cd\u4f5c\uff0c\u53cc\u62ec\u53f7\u547d\u4ee4\u5141\u8bb8\u5728\u6bd4\u8f83\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u9ad8\u7ea7\u6570\u5b66\u8868\u8fbe\u5f0f\u3002</p> <pre><code>$ man bash\n\n((expression))\n\nThe expression is evaluated according to the rules described below under ARITHMETIC EVALUATION. If the value of the expression is non-zero, the return status is 0; otherwise the return status is 1. This is exactly equivalent to let \"expression\".\n</code></pre> <p></p> <p>\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u53cc\u62ec\u53f7\u6765\u6267\u884c\u6570\u5b66\u8fd0\u7b97\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528if\u5224\u65ad\u8ba1\u7b97\u7ed3\u679c\u72b6\u6001\u3002</p> <pre><code>#!/bin/bash\n\nn=0\n(( n += 1 )) #Increment\necho $? # \u8fd4\u56de0\n(( n -= 1))\necho $? # \u8fd4\u56de1\necho \"n = $n\"\n\nval1=10\n\nif (( $val1 ** 2 &gt; 90 ))\nthen (( val2 = $val1 ** 2 ))\n    echo \"The square of $val1 is $val2\"\nfi\n</code></pre>"},{"location":"blog/20191106/4-sh-test/#\u53cc\u65b9\u62ec\u53f7","title":"\u53cc\u65b9\u62ec\u53f7","text":"<p>\u53cc\u65b9\u62ec\u53f7\u8868\u8fbe\u5f0f <code>[[ expression ]]</code> \u63d0\u4f9b\u4e86\u9488\u5bf9\u5b57\u7b26\u4e32\u6bd4\u8f83\u7684\u9ad8\u7ea7\u7279\u6027\u3002</p> <pre><code>$ man bash\n\n[[ expression ]]\n\nReturn a status of 0 or 1 depending on the evaluation of the conditional expression expression.\n</code></pre> <p>\u53cc\u65b9\u62ec\u53f7\u91cc\u7684expression\u4f7f\u7528\u4e86test\u547d\u4ee4\u4e2d\u91c7\u7528\u7684\u6807\u51c6\u5b57\u7b26\u4e32\u6bd4\u8f83\u3002\u4f46\u5b83\u63d0\u4f9b\u4e86test\u547d\u4ee4\u672a\u63d0\u4f9b\u7684\u53e6\u4e00\u4e2a\u7279\u6027\u2014\u2014\u6a21\u5f0f\u5339\u914d\uff08pattern matching\uff09\u3002</p> <p>\u5728 ohmyzsh/plugins/shell-proxy/ \u4e2d\uff0c\u8fd9\u91cc\u7684\u53cc\u65b9\u62ec\u53f7\u8c8c\u4f3c\u53ef\u4ee5\u6539\u4e3a\u5355\u65b9\u62ec\u53f7\uff1f</p> <pre><code>$ cat $HOME/.config/proxy\n\n#!/bin/bash\n\nif [[ \"$(uname)\" = Darwin ]]; then\n  echo \"http://127.0.0.1:6152\" # Surge Mac\nelse\n  echo \"http://127.0.0.1:8123\" # polipo\nfi\n</code></pre> <p>\u5728\u6a21\u5f0f\u5339\u914d\u4e2d\uff0c\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u6765\u5339\u914d\u5b57\u7b26\u4e32\u503c\u3002</p> <pre><code>#!/bin/bash\n# using pattern matching\n#\n\nif [[ $USER == r* ]]\nthen\n    echo \"Hello $USER\"\nelse\n    echo \"Sorry, I do not know you\"\nfi\n</code></pre> <p>\u53cc\u7b49\u53f7\uff08<code>==</code>\uff09\u5c06\u53f3\u8fb9\u7684\u5b57\u7b26\u4e32\uff08<code>r*</code>\uff09\u89c6\u4e3a\u4e00\u4e2a\u6a21\u5f0f\uff0c\u5e76\u5e94\u7528\u6a21\u5f0f\u5339\u914d\u89c4\u5219\u3002</p> <p>\u53e6\u5916\u4e00\u79cd\u5199\u6cd5\u662f\u5229\u7528 <code>=~</code> \u5224\u65ad\u5339\u914d\u5305\u542b\u5173\u7cfb\u3002</p> <pre><code>strA=\"helloworld\"\nstrB=\"low\"\nif [[ $strA =~ $strB ]]\nthen\n    echo \"\u5305\u542b\"\nelse\n    echo \"\u4e0d\u5305\u542b\"\nfi\n</code></pre> <p>\u547d\u4ee4\u884c\u6d4b\u8bd5\uff1a</p> <pre><code>\u279c  ~ strA=\"helloworld\"\n\u279c  ~ strB=\"low\"\n\u279c  ~ if [[ $strA == *low* ]] ; then echo \"\u5305\u542b\" ; else echo \"\u4e0d\u5305\u542b\" ; fi\n\u5305\u542b\n\u279c  ~ if [[ $strA =~ $strB ]] ; then echo \"\u5305\u542b\" ; else echo \"\u4e0d\u5305\u542b\" ; fi\n\u5305\u542b\n</code></pre>"},{"location":"blog/20191106/4-sh-test/#\u5173\u4e8eshell\u4e2d\u7684boolean","title":"\u5173\u4e8eshell\u4e2d\u7684boolean","text":"<p>shell\u6709bool\u8fd0\u7b97\u4e48</p> <p>\u5728shell\u811a\u672c\u4e2d\u6ca1\u6709\u5e03\u5c14\u503c\u7684\u6982\u5ff5\uff0c\u53ea\u80fd\u6309\u7167\u5b57\u7b26\u4e32\u5904\u7406\u3002</p> <pre><code>doFirst=true\n# ...\nif [ $doFirst = true ]; then\n    doFirst=false\nfi\n# ...\n</code></pre> <p>How can I declare and use Boolean variables in a shell script?</p> <pre><code>the_world_is_flat=true\n# ...do something interesting...\nif [ \"$the_world_is_flat\" = true ] ; then\n    echo 'Be careful not to fall off!'\nfi\n</code></pre> <p>Say we have the following condition.</p> <pre><code>if $var; then\n  echo 'Muahahaha!'\nfi\n</code></pre> <p>In the following cases2, this condition will evaluate to true and execute the nested command.</p> <pre><code># Variable var not defined beforehand. Case 1\nvar=''  # Equivalent to var=\"\".      # Case 2\nvar=                                 # Case 3\nunset var                            # Case 4\nvar='&lt;some valid command&gt;'           # Case 5\n</code></pre> <p>What I do recommend:</p> <p>Here are ways I recommend you check your \"Booleans\". They work as expected.</p> <pre><code>my_bool=true\n\nif [ \"$my_bool\" = true ]; then\nif [ \"$my_bool\" = \"true\" ]; then\n\nif [[ \"$my_bool\" = true ]]; then\nif [[ \"$my_bool\" = \"true\" ]]; then\nif [[ \"$my_bool\" == true ]]; then\nif [[ \"$my_bool\" == \"true\" ]]; then\n\nif test \"$my_bool\" = true; then\nif test \"$my_bool\" = \"true\"; then\n</code></pre>"},{"location":"blog/20191106/4-sh-test/#refs","title":"refs","text":"<p>Bash\u5b57\u7b26\u4e32\u5224\u65ad \u903b\u8f91\u5224\u65ad\u548c\u5b57\u7b26\u4e32\u6bd4\u8f83 </p>"},{"location":"blog/20191106/5-sh-expr/","title":"Linux Shell Program - expr","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u8868\u8fbe\u5f0f\u3002</p> <p>Difference between let, expr and $[]</p> <p>\u547d\u4ee4\u884c\u6267\u884c\u8fd0\u7b97\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>$ expr 5 + 1\n6\n\n$ $(expr 5 + 1)\nzsh: command not found: 6\n\n$ $[5 + 1]\nzsh: command not found: 6\n\n$ $((5+1))\nzsh: command not found: 6\n</code></pre> <p>\u5982\u679c\u60f3\u5728\u547d\u4ee4\u884c\u6267\u884c\u6570\u5b66\u8ba1\u7b97\uff0c\u5efa\u8bae\u4f7f\u7528\u6570\u5b66\u8ba1\u7b97\u5668 <code>bc</code>\uff08bash calculator\uff09\u3002</p> <p>\u5728 bash shell \u811a\u672c\u4e2d\u6709\u4ee5\u4e0b\u51e0\u79cd\u8fd0\u7b97\u8868\u8fbe\u5f0f\u7684\u4e66\u5199\u65b9\u5f0f\u3002</p>"},{"location":"blog/20191106/5-sh-expr/#expr","title":"expr","text":"<p>\u6700\u5f00\u59cb\uff0cBourne shell \u63d0\u4f9b\u4e86\u4e00\u4e2a\u7279\u522b\u7684\u547d\u4ee4\u7528\u6765\u5904\u7406\u6570\u5b66\u8868\u8fbe\u5f0f\u3002 expr \u547d\u4ee4\u5141\u8bb8\u5728\u547d\u4ee4\u884c\u4e0a\u5904\u7406\u6570\u5b66\u8868\u8fbe\u5f0f\uff0c\u4f46\u662f\u7279\u522b\u7b28\u62d9\u3002</p> <p>expr \u547d\u4ee4\u80fd\u591f\u8bc6\u522b\u5c11\u6570\u7684\u6570\u5b66\u548c\u5b57\u7b26\u4e32\u64cd\u4f5c\u7b26\uff0c\u89c1\u886811-1\u3002</p> <p></p> <p>\u9700\u8981\u6ce8\u610f\u4e24\u70b9\uff1a</p> <ol> <li>\u64cd\u4f5c\u7b26\u4e24\u4fa7\u9700\u8981\u7a7a\u683c\u9694\u5f00\u7b97\u5b50\uff1b  </li> <li>\u7b97\u5b50\u5f15\u7528\u53d8\u91cf\u9700\u8981\u7528\u7f8e\u5143\u7b26\u53f7\uff1b  </li> </ol> <pre><code>$ x=$(expr 5 + 1)\n$ echo $x\n6\n\n#\u661f\u53f7\u9700\u8981\u8f6c\u4e49\n\n$ y=`expr 5 \\* 2`\n$ echo $y\n10\n</code></pre> <p>\u53ef\u7528 expr \u8868\u8fbe\u5f0f\u5b9e\u73b0 for \u5faa\u73af\u4e2d\u8bb0\u5f55\u9012\u589e\u7684\u7d22\u5f15\uff1a</p> <pre><code>$ i=0\n$ index=`expr $i + 1` # \u7b49\u6548\u4e8e index=$(expr $i + 1)\n$ echo $i $index\n0 1\n</code></pre> <p>\u7efc\u5408\u793a\u4f8b2\uff1a</p> <pre><code>#!/bin/bash\n\n$ var1=5\n$ var2=1\n$ x=$var1+$var2\n$ echo \"x=$x\"\nx=5+1\n\n$ y=$(expr $var1+$var2)\n$ echo \"y=$y\"\ny=5+1\n\n$ z=$(expr $var1 + $var2)\n$ echo \"z=$z\"\nz=6\n</code></pre> <p>\u524d\u4e24\u79cd\u8fd0\u7b97\u7b26\u4e0e\u7b97\u5b50\u4e4b\u95f4\u6ca1\u6709\u7a7a\u683c\uff0c\u88ab\u5f53\u6210\u4e86\u5b57\u7b26\u4e32\u62fc\u63a5\u3002 \u7b2c\u4e09\u79cd\u662f\u6b63\u786e\u7684 expr \u7b97\u672f\u8868\u8fbe\u5f0f\u5199\u6cd5\uff0c\u7ed3\u679c\u7b26\u5408\u9884\u671f\u3002</p>"},{"location":"blog/20191106/5-sh-expr/#let","title":"let","text":"<p><code>let</code> command performs arithmetic evaluation and is a shell built-in.</p> <p>bash shell \u5185\u7f6e\u652f\u6301\u7684 let \u8868\u8fbe\u5f0f\uff0c\u76f4\u63a5\u5f15\u7528\u53d8\u91cf\uff0c\u800c\u65e0\u9700\u7f8e\u5143\u7b26\u53f7\u89e3\u5f15\u7528\uff0c\u66f4\u63a5\u8fd1\u4e8e C \u7b49\u73b0\u4ee3\u7f16\u7a0b\u8bed\u8a00\u91cc\u9762\u7684\u81ea\u7136\u8868\u8fbe\u5f0f\u3002</p> <p>\u8303\u5f0f\uff1a<code>let var3=var1+var2</code></p> <pre><code>$ z=0\n$ let z=z+3 # \u7b49\u6548: let z+=3\n$ let \"z += 3\"\n$ echo \"z = $z\"\n6\n\n$ let 'sum=10+1'\n$ echo \"sum = $sum\"\nsum = 11\n</code></pre> <p>\u7efc\u5408\u793a\u4f8b\uff1a</p> <pre><code>$ var1=5\n$ var2=1\n$ let x=var1+var2\n$ echo \"x=$x\"\nx=6\n\n$ let \"y=var1+var2\"\n$ echo \"y=$y\"\ny=6\n</code></pre> <p>let \u8868\u8fbe\u5f0f\u66f4\u81ea\u7136\uff0c\u7b97\u5b50\u5f15\u7528\u7684\u53d8\u91cf\u76f4\u63a5\u91c7\u7528\u53d8\u91cf\u540d\uff0c\u65e0\u9700\u6dfb\u52a0\u7f8e\u5143\u7b26\u53f7\uff0c\u63a8\u8350\u4f7f\u7528\u3002</p> <p>\u4ee5\u4e0b\u7528 <code>let</code> \u8868\u8fbe\u5f0f\u5b9e\u73b0 for \u5faa\u73af\u4e2d\u8bb0\u5f55\u9012\u589e\u7684\u7d22\u5f15\uff1a</p> <pre><code>$ i=0\n$ let index=i+1\n$ echo $i $index\n0 1\n\n$ let i++\n$ echo $i\n1\n\n$ let i+=1\n$ echo $i\n2\n\n$ let index=i++\n$ echo $i $index\n3 2\n\n$ let index=++i\n$ echo $i $index\n4 4\n</code></pre>"},{"location":"blog/20191106/5-sh-expr/#_1","title":"$[]","text":"<p>bash shell \u4e3a\u4e86\u4fdd\u6301\u8ddf Bourne shell \u7684\u517c\u5bb9\u800c\u5305\u542b\u4e86 expr \u547d\u4ee4\uff0c\u4f46\u540c\u65f6\u63d0\u4f9b\u4e86\u4e00\u79cd\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\u6765\u6267\u884c\u6570\u5b66\u8868\u8fbe\u5f0f\u3002 \u5728 bash \u4e2d\uff0c\u5728\u5c06\u4e00\u4e2a\u6570\u5b66\u8fd0\u7b97\u7ed3\u679c\u8d4b\u7ed9\u67d0\u4e2a\u53d8\u91cf\u65f6\uff0c\u53ef\u4ee5\u7528\u7f8e\u5143\u7b26\u53f7\u548c\u65b9\u62ec\u53f7\uff08<code>$[operation]</code>\uff09\u5c06\u6570\u5b66\u8868\u8fbe\u5f0f\u56f4\u8d77\u6765\u3002</p> <p>\u7528\u65b9\u62ec\u53f7\u6267\u884cshell\u6570\u5b66\u8fd0\u7b97\u6bd4\u7528expr\u547d\u4ee4\u65b9\u4fbf\u5f88\u591a\u3002</p> <ol> <li>\u64cd\u4f5c\u7b26\u4e24\u4fa7\u975e\u5fc5\u987b\u8981\u7528\u7a7a\u683c\u9694\u5f00\u7b97\u5b50\uff1b  </li> <li>\u7b97\u5b50\u53ef\u76f4\u63a5\u5f15\u7528\u53d8\u91cf\uff0c\u53ef\u65e0\u9700\u7f8e\u5143\u7b26\u53f7\uff1b  </li> </ol> <p>\u5e38\u91cf\u8ba1\u7b97\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>$ x=$[5 + 1]\n$ echo $x\n6\n\n$ y=$[5*2]\n$ echo $y\n10\n</code></pre> <p>\u7528 <code>$[]</code> \u8868\u8fbe\u5f0f\u5b9e\u73b0 for \u5faa\u73af\u4e2d\u8bb0\u5f55\u9012\u589e\u7684\u7d22\u5f15\uff1a</p> <pre><code>$ i=0\n$ index=$[$i+1]\n$ echo $i $index\n0 1\n</code></pre> <p>\u53d8\u91cf\u8ba1\u7b97\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>$ var1=5\n$ var2=1\n\n$ x=$[var1 + var2]\n$ echo \"x=$x\"\nx=6\n</code></pre> <p>\u5728\u4f7f\u7528\u65b9\u62ec\u53f7\u6765\u8ba1\u7b97\u516c\u5f0f\u65f6\uff0c\u4e0d\u7528\u62c5\u5fc3shell\u4f1a\u8bef\u89e3\u4e58\u53f7\u6216\u5176\u4ed6\u7b26\u53f7\u3002 \u5bf9\u4e8e\u65b9\u62ec\u53f7\u4e2d\u7684\u661f\u53f7\uff0cshell\u77e5\u9053\u5b83\u6267\u884c\u6570\u5b66\u4e2d\u7684\u4e58\u6cd5\u8fd0\u7b97\u800c\u4e0d\u662f\u901a\u914d\u7b26\uff0c\u56e0\u4e3a\u5b83\u5728\u65b9\u62ec\u53f7\u5185\u3002</p> <pre><code>$ var1=100\n$ var2=50\n$ var3=45\n$ # var4=$[$var1 * ($var2 - $var3)]\n$ var4=$[var1*(var2-var3)] # \u7b80\u5199\n$ echo The final result is $var4\nThe final result is 500\n</code></pre> <p>\u65e0\u8bba\u662f expr \u8868\u8fbe\u5f0f\uff0c\u8fd8\u662f\u4e2d\u62ec\u53f7\u8fd0\u7b97\u5f0f\uff0cbash shell \u6570\u5b66\u8fd0\u7b97\u7b26\u53ea\u652f\u6301\u6574\u6570\u8fd0\u7b97\u3002</p> <pre><code>$ var1=100\n$ var2=45\n$ var3=$(expr $var1 / $var2)\n$ echo The final result is $var3\n2\n$ var4=$[var1/var2]\n$ echo The final result is $var4\n2\n</code></pre> <p>\u5982\u679c\u9700\u8981\u5728shell\u811a\u672c\u4e2d\u8fdb\u884c\u6d6e\u70b9\u6570\u8fd0\u7b97\uff0c\u53ef\u4ee5\u8003\u8651\u770b\u770b z shell\uff0czsh \u63d0\u4f9b\u4e86\u5b8c\u6574\u7684\u6d6e\u70b9\u6570\u7b97\u672f\u64cd\u4f5c\u3002 \u4e5f\u53ef\u5c06\u8868\u8fbe\u5f0f\u91cd\u5b9a\u5411\u5230 bash \u5185\u7f6e\u8ba1\u7b97\u5668 <code>bc</code> \u505a\u8ba1\u7b97\uff0c\u53c2\u8003 REDIRECTION \u76f8\u5173\u8bae\u9898\u3002</p>"},{"location":"blog/20191106/5-sh-expr/#_2","title":"(())","text":"<p>\u53cc\u62ec\u53f7\u547d\u4ee4 <code>(( expression ))</code> \u652f\u6301\u66f4\u591a\u7684\u6570\u5b66\u8fd0\u7b97\u7b26\u3002 \u53cc\u62ec\u53f7\u8868\u8fbe\u5f0f\u6709\u72b6\u6001\u8fd4\u56de\u7801\uff0c\u5f53\u8fd0\u7b97\u7ed3\u679c\u975e\u96f6\u65f6\uff0c\u8fd4\u56de0\uff1b\u5426\u5219\uff0c\u8fd4\u56de1\u3002 \u76f8\u6bd4test\u547d\u4ee4\u53ea\u80fd\u4f7f\u7528\u7b80\u5355\u7684\u7b97\u672f\u64cd\u4f5c\uff0c\u53cc\u62ec\u53f7\u547d\u4ee4\u5141\u8bb8\u5728\u6bd4\u8f83\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u9ad8\u7ea7\u6570\u5b66\u8868\u8fbe\u5f0f\u3002</p> <p>\u886812-4\u5217\u51fa\u4e86\u53cc\u62ec\u53f7\u547d\u4ee4\u4e2d\u4f1a\u7528\u5230\u7684\u5176\u4ed6\u8fd0\u7b97\u7b26\uff1a</p> <p></p> <p>\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u53cc\u62ec\u53f7\u6765\u6267\u884c\u6570\u5b66\u8fd0\u7b97\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528if\u5224\u65ad\u8ba1\u7b97\u7ed3\u679c\u72b6\u6001\u3002</p> <pre><code>#!/bin/bash\n\nn=0\n(( n += 1 )) #Increment\necho $? # \u8fd4\u56de0\n(( n -= 1))\necho $? # \u8fd4\u56de1\necho \"n = $n\"\n\nval1=10\n\nif (( $val1 ** 2 &gt; 90 ))\nthen (( val2 = $val1 ** 2 ))\n    echo \"The square of $val1 is $val2\"\nfi\n</code></pre> <p>\u5173\u4e8e\u53cc\u62ec\u53f7\u7684\u573a\u666f\uff0c\u53c2\u8003bash\u4e2dC\u8bed\u8a00\u98ce\u683c\u7684for\u5faa\u73af\u683c\u5f0f\uff1a</p> <pre><code>for (( variable assignment ; condition ; iteration process ))\n\n#\u5b9e\u4f8b\n\nfor (( a = 1; a &lt; 10; a++ ))\n</code></pre> <p>\u6ce8\u610f\uff0c\u6709\u4e9b\u90e8\u5206\u5e76\u6ca1\u6709\u9075\u5faabash shell\u6807\u51c6\u7684for\u547d\u4ee4\uff1a</p> <ul> <li>\u53d8\u91cf\u8d4b\u503c\u53ef\u4ee5\u6709\u7a7a\u683c  </li> <li>\u6761\u4ef6\u4e2d\u7684\u53d8\u91cf\u4e0d\u4ee5\u7f8e\u5143\u7b26\u5f00\u5934  </li> <li>\u8fed\u4ee3\u8fc7\u7a0b\u7684\u7b97\u5f0f\u672a\u7528expr\u547d\u4ee4\u683c\u5f0f\u3002  </li> </ul>"},{"location":"blog/20191106/5-sh-expr/#_3","title":"$(())","text":"<p>Arithmetic Expansion</p> <p>\u5728 dash shell\u3001z shell \u811a\u672c\u4e2d\u6267\u884c\u7b97\u672f\u8fd0\u7b97\u7684\u6b63\u786e\u683c\u5f0f\u662f\u7528\u53cc\u5706\u62ec\u53f7\u65b9\u6cd5 \u2014\u2014 <code>$((expression))</code>\u3002</p> <pre><code># man bash\n   Arithmetic Expansion\n       Arithmetic expansion allows the evaluation of an arithmetic expression and the substitu-\n       tion of the result.  The format for arithmetic expansion is:\n\n              $((expression))\n\n       The  expression is treated as if it were within double quotes, but a double quote inside\n       the parentheses is not treated specially.  All tokens in the expression undergo  parame-\n       ter  expansion,  string  expansion, command substitution, and quote removal.  Arithmetic\n       expansions may be nested.\n\n       The evaluation is performed according to the rules listed below under ARITHMETIC EVALUA-\n       TION.  If expression is invalid, bash prints a message indicating failure and no substi-\n       tution occurs.\n</code></pre> <p>\u6839\u636e Shell Check \u5efa\u8bae\uff0c\u5728\u505a\u6570\u5b66\u8fd0\u7b97\u65f6\uff0c\u5e94\u91c7\u7528 <code>$(())</code> \u4ee3\u66ff <code>expr</code> \u548c <code>let</code> \u8868\u8fbe\u5f0f\u4ee5\u53ca <code>$[ ]</code>\u3002</p> <ul> <li>SC2003: <code>expr</code> is antiquated. Consider rewriting this using <code>$((..))</code>, <code>${}</code> or <code>[[ ]]</code>.  </li> <li>SC2007: Use <code>$((..))</code> instead of deprecated <code>$[..]</code>.  </li> <li>SC2219: Instead of <code>let</code> expr, prefer <code>(( expr ))</code> .</li> </ul> <p>\u6ce8\u610f\uff1a\u53cc\u62ec\u53f7\u4e2d\u7684\u8868\u8fbe\u5f0f\uff0c\u89e3\u5f15\u7528\u53d8\u91cf\u65f6\u53ef\u4e0d\u6dfb\u52a0\u7f8e\u5143\u7b26\u53f7\u3002</p> <p>Within double parentheses, parameter dereferencing is optional.</p> <p>\u8868\u8fbe\u5f0f <code>OPTIND=$(($OPTIND + 1))</code> \u5c06\u88ab ShellCheck \u68c0\u6d4b\u62a5\u9519 C2004: <code>$</code>/<code>${}</code> is unnecessary on arithmetic variables. \u5e94\u4fee\u6539\u4e3a <code>OPTIND=$((OPTIND + 1))</code>\u3002</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>#!/bin/bash\n\nval3=$((val2+3))\n#val3=$(($val2+3)) #Also correct\n\necho \"val3=$val3\"\n</code></pre> <p>\u53cc\u91cd\u62ec\u53f7\u8868\u8fbe\u5f0f\u57fa\u672c\u4e0a\u548c let \u8868\u8fbe\u5f0f\u7b49\u6548\u3002</p> <p>\u4ee5\u4e0b\u7528 <code>(( expr ))</code> \u8868\u8fbe\u5f0f\u5b9e\u73b0 for \u5faa\u73af\u4e2d\u8bb0\u5f55\u9012\u589e\u7684\u7d22\u5f15\uff1a</p> <pre><code>$ i=0\n$ ((i += 1))\n$ echo $i\n1\n\n$ index=$((i+1))\n$ echo $i $index\n1 2\n</code></pre> <p>\u51cf\u6cd5\u8ba1\u7b97\u95f4\u9694\u8017\u65f6\uff1a</p> <pre><code>$ time_start=1668913082\n$ time_end=1668913195\n$ time_cost=$(( $time_end - $time_start ))\n$ echo $time_cost\n113\n</code></pre> <p>\u4e58\u6cd5\u8ba1\u7b97\u500d\u79ef\uff1a</p> <pre><code>$ SHOW_COUNT=5\n$ echo $(( $SHOW_COUNT * 3 ))\n15\n\n$ x=5\n$ echo $((2*x))\n10\n</code></pre> <p>\u53cc\u4e58\u8ba1\u7b97\u5e42\uff1a</p> <pre><code>$ echo $((2**x))\n32\n</code></pre> <p>\u6d6e\u70b9\u6570\u4e58\u6cd5\uff0cprintf \u53ef\u9650\u5b9a\u8f93\u51fa\u6d6e\u70b9\u4f4d\u6570\uff1a</p> <pre><code>$ value1=$(( 4 * 5.1 ))\n$ echo $value1\n20.399999999999999\n$ printf \"%6.3f\\n\" $value1\n20.400\n</code></pre> <p>\u6574\u9664\u53d6\u6a21\u8fd0\u7b97\uff1a</p> <pre><code>SECS=3600\nUNIT_TIME=60\nSTEPS=$(( $SECS / $UNIT_TIME ))\necho $STEPS\n60\n</code></pre> <p>\u53d6\u6a21\u548c\u53d6\u4f59\u8fd0\u7b97\uff1a</p> <pre><code>$ value1=10\n$ value2=$(( $value1 / 3 ))\n$ echo $value2\n3\n$ value3=$(( $value1 % 3 ))\n$ echo $value3\n1\n</code></pre> <p>\u5c06\u88ab\u9664\u6570\u6d6e\u70b9\u5316\uff0c\u4ee5\u4fbf\u8ba1\u7b97\u5b8c\u6574\u7684\u6d6e\u70b9\u9664\u6cd5\u7ed3\u679c\uff1a</p> <pre><code>$ value1=10\n$ value2=$(( $value1 / 3. ))\n$ echo $value2\n3.3333333333333335\n$ printf \"%.3f\\n\" $value2\n3.333\n</code></pre>"},{"location":"blog/20191106/6-sh-control/","title":"Linux Shell Program - control","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u6761\u4ef6\u5224\u65ad\uff08conditions\uff09\u548c\u5faa\u73af\u63a7\u5236\uff08loops\uff09\u8868\u8fbe\u5f0f\u3002</p>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#if","title":"if","text":"","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#if-then","title":"if-then","text":"<p>\u6700\u57fa\u672c\u7684\u7ed3\u6784\u5316\u547d\u4ee4\u5c31\u662f if-then \u8bed\u53e5\u3002</p> <p><code>if-then</code> \u8bed\u53e5\u683c\u5f0f\u5982\u4e0b:</p> <pre><code>if command\nthen\n    commands\nfi\n</code></pre> <p>\u5982\u679c\u8be5\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801\u662f0\uff08\u8be5\u547d\u4ee4\u6210\u529f\u8fd0\u884c\uff09\uff0c\u4f4d\u4e8e then \u90e8\u5206\u7684\u547d\u4ee4\u5c31\u4f1a\u88ab\u6267\u884c\u3002 \u5982\u679c\u8be5\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801\u662f\u5176\u4ed6\u975e0\u503c\uff0cthen \u90e8\u5206\u7684\u547d\u4ee4\u5c31\u4e0d\u4f1a\u88ab\u6267\u884c\uff0c\u800c\u662f\u7ee7\u7eed\u6267\u884c\u811a\u672c\u4e2d\u7684\u4e0b\u4e00\u4e2a\u547d\u4ee4\u3002</p> <p><code>fi</code> \u8bed\u53e5\u7528\u6765\u8868\u793a <code>if-then</code> \u8bed\u53e5\u5230\u6b64\u7ed3\u675f\uff0c\u7c7b\u4f3c HTML \u8bed\u8a00\u4e2d\u7684\u95ed\u5408\u6807\u7b7e\u3002</p> <p>\u4f60\u53ef\u80fd\u770b\u5230\u8fc7 if-then \u8bed\u53e5\u7684\u53e6\u4e00\u79cd\u5f62\u5f0f\uff1a</p> <pre><code>if command; then\n    commands\nfi\n</code></pre> <p>\u901a\u8fc7\u628a\u5206\u53f7\u653e\u5728\u5f85\u6c42\u503c\u7684\u547d\u4ee4\u5c3e\u90e8\uff0c\u5c31\u53ef\u4ee5\u5c06 then \u8bed\u53e5\u5199\u5728\u540c\u4e00\u884c\u4e2d\u4e86\uff0c\u8fd9\u6837\u770b\u8d77\u6765\u66f4\u50cf\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u4e2d\u7684 if-then \u8bed\u53e5\u3002</p> <p>\u4e5f\u53ef\u4ee5\u5c06\u6574\u4e2a <code>if ... them ... fi</code> \u5199\u5230\u4e00\u884c\u5185\uff0c\u65b9\u4fbf\u5728\u547d\u4ee4\u884c\u4e2d\u5355\u884c\u5feb\u6377\u6d4b\u8bd5\uff1a</p> <pre><code>if [ -n \"$HOME\" ]; then echo \"HOME is defined\"; fi\nif [ -z \"$ZDOTDIR\" ]; then echo \"ZDOTDIR not defined\"; fi\n</code></pre>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#if-then-else","title":"if-then-else","text":"<p>\u5f53 if \u8bed\u53e5\u4e2d\u7684\u547d\u4ee4\u8fd4\u56de\u9000\u51fa\u72b6\u6001\u78010\u65f6\uff0cthen \u90e8\u5206\u4e2d\u7684\u547d\u4ee4\u4f1a\u88ab\u6267\u884c\uff0c\u8fd9\u8ddf\u666e\u901a\u7684 if-then \u8bed\u53e5\u4e00\u6837\u3002 \u5f53 if \u8bed\u53e5\u4e2d\u7684\u547d\u4ee4\u8fd4\u56de\u975e\u96f6\u9000\u51fa\u72b6\u6001\u7801\u65f6\uff0cbash shell \u4f1a\u6267\u884c else \u90e8\u5206\u7684\u547d\u4ee4\u3002</p> <pre><code>if command\nthen\n    commands\nelse\n    commands\nfi\n</code></pre>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#elif","title":"elif","text":"<p>\u53ef\u4ee5\u4f7f\u7528 else \u90e8\u5206\u7684\u53e6\u4e00\u79cd\u5f62\u5f0f\uff1a<code>elif</code>\u3002 elif \u4f7f\u7528\u53e6\u4e00\u4e2a if-then \u8bed\u53e5\u5ef6\u7eed else \u90e8\u5206\uff0c\u8fd9\u6837\u5c31\u4e0d\u7528\u518d\u4e66\u5199\u591a\u4e2a if-then \u8bed\u53e5\u4e86\u3002</p> <pre><code>if command1\nthen\n    commands\nelif command2\nthen\n    more commands\nfi\n</code></pre> <p>elif \u8bed\u53e5\u884c\u63d0\u4f9b\u4e86\u53e6\u4e00\u4e2a\u8981\u6d4b\u8bd5\u7684\u547d\u4ee4\uff0c\u8fd9\u7c7b\u4f3c\u4e8e\u539f\u59cb\u7684 if \u8bed\u53e5\u884c\u3002 \u5982\u679c elif \u540e\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801\u662f0\uff0c\u5219 bash \u4f1a\u6267\u884c\u7b2c\u4e8c\u4e2a then \u8bed\u53e5\u90e8\u5206\u7684\u547d\u4ee4\u3002 \u4f7f\u7528\u8fd9\u79cd\u5d4c\u5957\u65b9\u6cd5\uff0c\u4ee3\u7801\u66f4\u6e05\u6670\uff0c\u903b\u8f91\u66f4\u6613\u61c2\u3002</p>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#demo","title":"demo","text":"test-if.sh <pre><code>#!/bin/bash\n\ntest_if_1()\n{\n    echo \"----------------------------------------\"\n    echo \"test_if_1\"\n    echo \"----------------------------------------\"\n    # read -p \"PLS input the num (1-10): \" ANS\n    echo -n \"PLS input the num (1-10): \"\n    read num\n\n    while [[ $num != 4 ]]\n    do\n        if [ $num -lt 4 ]\n        then\n            echo \"Too small. Try again!\"\n            read num\n        elif [ $num -gt 4 ]\n        then\n            echo \"Too high. Try again!\"\n            read num\n        else\n            # echo \"Congratulation, you are right!\" # no output !?\n            exit 0\n        fi\n    done\n\n    echo \"Congratulation, you are right!\"\n}\n\ntest_if_2()\n{\n    echo \"----------------------------------------\"\n    echo \"test_if_2\"\n    echo \"----------------------------------------\"\n}\n\ntest_if()\n{\n    test_if_1\n    test_if_2\n}\n\ntest_if\n</code></pre>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#case","title":"case","text":"<p>\u4f60\u4f1a\u7ecf\u5e38\u53d1\u73b0\u81ea\u5df1\u5728\u5c1d\u8bd5\u8ba1\u7b97\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\uff0c\u5728\u4e00\u7ec4\u53ef\u80fd\u7684\u503c\u4e2d\u5bfb\u627e\u7279\u5b9a\u503c\u3002 \u5728\u8fd9\u79cd\u60c5\u5f62\u4e0b\uff0c\u4f60\u4e0d\u5f97\u4e0d\u5199\u51fa\u5f88\u957f\u7684 if-then-else \u8bed\u53e5\u3002 elif \u8bed\u53e5\u7ee7\u7eed if-then \u68c0\u67e5\uff0c\u4e3a\u6bd4\u8f83\u53d8\u91cf\u5bfb\u627e\u7279\u5b9a\u7684\u503c\u3002</p> <p>\u6709\u4e86 case \u547d\u4ee4\uff0c\u5c31\u4e0d\u9700\u8981\u518d\u5199\u51fa\u6240\u6709\u7684 elif \u8bed\u53e5\u6765\u4e0d\u505c\u5730\u68c0\u67e5\u540c\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u4e86\u3002 case \u547d\u4ee4\u4f1a\u91c7\u7528\u5217\u8868\u683c\u5f0f\u6765\u68c0\u67e5\u5355\u4e2a\u53d8\u91cf\u7684\u591a\u4e2a\u53ef\u80fd\u53d6\u503c\uff0c\u7c7b\u4f3c\u679a\u4e3e\u547d\u4e2d\u6d4b\u8bd5\u3002</p> <pre><code>case variable in\n    pattern1 | pattern2) commands1;;\n    pattern3) commands2;;\n    *) default commands;;\nesac\n</code></pre> <p>case \u547d\u4ee4\u4f1a\u5c06\u6307\u5b9a\u7684\u53d8\u91cf\u4e0e\u4e0d\u540c\u6a21\u5f0f\u8fdb\u884c\u6bd4\u8f83\uff0c\u53ef\u4ee5\u901a\u8fc7\u7ad6\u7ebf\u64cd\u4f5c\u7b26\u5728\u4e00\u884c\u4e2d\u5e76\u5217\u591a\u4e2a\u5339\u914d\u6a21\u5f0f\u3002\u6a21\u5f0f\u5339\u914d\u540e\u4f1a\u6267\u884c\u53f3\u62ec\u53f7\u540e\u9762\u7684\u547d\u4ee4\u3002</p> <p>\u6700\u540e\u4e00\u884c\u7684\u661f\u53f7\u901a\u914d\u6240\u6709\u4e0e\u5df2\u77e5\u6a21\u5f0f\u4e0d\u5339\u914d\u7684\u503c\uff0c\u7c7b\u4f3c\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u4e2d\u7684 default fallbak \u5206\u652f\u3002</p>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#demo_1","title":"demo","text":"<ol> <li>\u4ee5\u4e0b\u4e3a ubuntu \u7684 bash \u914d\u7f6e\u6587\u4ef6 <code>~/.bashrc</code> \u4e2d\u7684\u5185\u5bb9\uff1a</li> </ol> <pre><code># set a fancy prompt (non-color, unless we know we \"want\" color)\ncase \"$TERM\" in\n    xterm-color|*-256color) color_prompt=yes;;\nesac\n</code></pre> <ol> <li> <p>\u5728 ohmyzsh/plugins/extract/extract.plugin.zsh \u4e2d\u57fa\u4e8e case \u5224\u65ad\u5404\u79cd\u538b\u7f29\u5305\u6587\u4ef6\u7684\u540e\u7f00\uff0c\u8c03\u7528\u4e0d\u540c\u7684\u7cfb\u7edf\u547d\u4ee4\u8fdb\u884c\u89e3\u538b\u3002</p> </li> <li> <p>\u5728 How to detect the OS from a Bash script? \u4e2d\uff0c\u57fa\u4e8e case \u5bf9 <code>$OSTYPE</code> \u8fdb\u884c\u5339\u914d\uff0c\u4ece\u800c\u5224\u65ad\u64cd\u4f5c\u7cfb\u7edf\u7c7b\u578b\uff0c\u53c2\u8003 get-ostype</p> </li> </ol> test-case.sh <pre><code>#!/bin/bash\n\ntest_case_1()\n{\n    echo \"----------------------------------------\"\n    echo \"test_case_1\"\n    echo \"----------------------------------------\"\n    # read -p \"enter a number from 1 to 5:\" ANS\n    echo -n \"enter a number from 1 to 5: \"\n    read ANS\n    case $ANS in\n        1) echo \"you select 1\"\n            ;;\n        2) echo \"you select 2\"\n            ;;\n        3) echo \"you select 3\"\n            ;;\n        4) echo \"you select 4\"\n            ;;\n        5) echo \"you select 5\"\n            ;;\n        *) echo \"`basename $0`: This is not between 1 and 5\" &gt;&amp;2\n            exit 1\n            ;;\n    esac\n}\n\ntest_case_2()\n{\n    echo \"----------------------------------------\"\n    echo \"test_case_2\"\n    echo \"----------------------------------------\"\n    read -p \"Do you wish to proceed [y..n] : \" ANS\n    case $ANS in\n        y|Y|yes|Yes) echo \"yes is selected\"\n            ;;\n        n|N) echo \"no is selected\"\n            exit 0 # no error so only use exit 0 to terminate\n            ;;\n        *) echo \"`basename $0`: Unknown response\" &gt;&amp;2\n            exit 1\n            ;;\n    esac\n    # if we are here then a y|Y|yes|Yes was selected only\n}\n\ntest_case()\n{\n    test_case_1\n    test_case_2\n}\n\ntest_case\n</code></pre>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#for","title":"for","text":"<p>for \u547d\u4ee4\u5141\u8bb8\u521b\u5efa\u4e00\u4e2a\u904d\u5386\u4e00\u7cfb\u5217\u503c\u7684\u5faa\u73af\uff0c\u6bcf\u6b21\u8fed\u4ee3\u90fd\u4f7f\u7528\u5176\u4e2d\u4e00\u4e2a\u503c\u6765\u6267\u884c\u5df2\u5b9a\u4e49\u597d\u7684\u4e00\u7ec4\u547d\u4ee4\u3002</p> <pre><code>for var in {list}\ndo\n    command1\n    command2\n    ...\ndone\n</code></pre> <p>\u5728 list \u53c2\u6570\u4e2d\uff0c\u4f60\u9700\u8981\u63d0\u4f9b\u8fed\u4ee3\u4e2d\u8981\u7528\u5230\u7684\u4e00\u7cfb\u5217\u503c\u3002</p>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#args","title":"args","text":"<p>\u5728 for \u5faa\u73af\u4e2d\u7701\u53bb in \u5217\u8868\u9009\u9879\u65f6\uff0c\u5b83\u5c06\u63a5\u53d7\u547d\u4ee4\u884c\u4f4d\u7f6e\u53c2\u6570\u4f5c\u4e3a\u53c2\u6570\uff0c\u7b49\u6548\u4e8e\uff1a</p> <pre><code>for params in \"$@\"\n</code></pre> <p>\u6216</p> <pre><code>for params in \"$*\"\n</code></pre>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#demo_2","title":"demo","text":"test-for.sh <pre><code>#!/bin/bash\n\ntest_for_1()\n{\n    echo \"----------------------------------------\"\n    echo \"test_for_1\"\n    echo \"----------------------------------------\"\n    for loop in 1 2 3 4 5\n    do\n        echo $loop\n    done\n}\n\n# testing the C-style for loop\ntest_for_2()\n{\n    echo \"----------------------------------------\"\n    echo \"test_for_2\"\n    echo \"----------------------------------------\"\n    for (( i=1; i &lt;= 10; i++ ))\n    do\n        echo \"The next number is $i\"\n    done\n}\n\ntest_for_3()\n{\n    echo \"----------------------------------------\"\n    echo \"test_for_3\"\n    echo \"----------------------------------------\"\n    read -p \"PLS input directory to list: \" directory\n    if [ -d $directory ]\n    cd $directory # \u5982\u679c\u4e0d\u8fdb\u5165\u8be5\u76ee\u5f55\uff0c\u4ee5\u4e0b -f \u6d4b\u8bd5\u9700\u8981\u62fc\u63a5\u7edd\u5bf9\u8def\u5f84\n    then\n        for filename in `ls -1 $directory`\n        do\n            if [ -f $filename ]\n            then\n                echo $filename\n            fi\n        done\n    fi\n}\n\n# \u4f7f\u7528 for \u5faa\u73af ping \u670d\u52a1\u5668\u5217\u8868\ntest_for_4()\n{\n    echo \"----------------------------------------\"\n    echo \"test_for_4\"\n    echo \"----------------------------------------\"\n    HOSTS=\"www.qq.com www.tencent.com www.sogo.com\"\n    for host in $HOSTS\n    do\n        ping -c 2 $host\n    done\n}\n\ntest_for()\n{\n    # test_for_0\n    test_for_1\n    test_for_2\n    test_for_3\n    test_for_4\n}\n\necho \"----------------------------------------\"\necho \"test_for_0\"\necho \"----------------------------------------\"\nfor arg\ndo\n    echo \"You supplied $arg as a command line option\"\ndone\n\ntest_for\n</code></pre>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#while","title":"while","text":"<p>while \u547d\u4ee4\u67d0\u79cd\u610f\u4e49\u4e0a\u662f if-then \u8bed\u53e5\u548c for \u5faa\u73af\u7684\u6df7\u6742\u4f53\u3002</p> <p>while \u547d\u4ee4\u5141\u8bb8\u5b9a\u4e49\u4e00\u4e2a\u8981\u6d4b\u8bd5\u7684\u547d\u4ee4\uff0c\u7136\u540e\u5faa\u73af\u6267\u884c\u4e00\u7ec4\u547d\u4ee4\uff0c\u53ea\u8981\u5b9a\u4e49\u7684\u6d4b\u8bd5\u547d\u4ee4\u8fd4\u56de\u7684\u662f\u9000\u51fa\u72b6\u6001\u7801\u4e3a0\u3002 \u5b83\u4f1a\u5728\u6bcf\u6b21\u8fed\u4ee3\u7684\u4e00\u5f00\u59cb\u6d4b\u8bd5 test \u547d\u4ee4\uff0c\u5728 test \u547d\u4ee4\u8fd4\u56de\u975e\u96f6\u9000\u51fa\u72b6\u6001\u7801\u65f6\uff0cwhile \u547d\u4ee4\u4f1a\u505c\u6b62\u6267\u884c\u90a3\u7ec4\u547d\u4ee4\u3002</p> <pre><code>while test command\ndo\n    other commands\ndone\n</code></pre> test-while.sh <pre><code>#!/bin/bash\n\ntest_while_1()\n{\n    echo \"----------------------------------------\"\n    echo \"test_while_1\"\n    echo \"----------------------------------------\"\n    COUNTER=0\n    while [ $COUNTER -lt 5 ]\n    do\n        COUNTER=`expr $COUNTER + 1` # $[ $COUNTER + 1 ]\n        echo $COUNTER\n    done\n}\n\n# \u7528while\u5faa\u73af\u9010\u884c\u8bfb\u53d6\u6587\u672c\u5185\u5bb9\ntest_while_2()\n{\n    echo \"----------------------------------------\"\n    echo \"test_while_2\"\n    echo \"----------------------------------------\"\n    # read -p \"enter filename:\" FILE\n    echo -n \"PLS enter filename to readline: \"\n    read FILE\n    if [ -f $FILE ]\n    then\n        while read LINE\n        do\n            echo $LINE\n        done &lt; $FILE\n    fi\n}\n\n# \u7528while\u5faa\u73af\u8bfb\u53d6\u952e\u76d8\u8f93\u5165\ntest_while_3()\n{\n    echo \"----------------------------------------\"\n    echo \"test_while_3\"\n    echo \"----------------------------------------\"\n    echo \"type &lt;CTRL-D&gt; to terminate\"\n    echo \"enter your most liked films: \"\n    index=0\n    while read FILM\n    do\n        # index+=1 # string contact!!!\n        # index=`expr $index + 1`\n        index=$[ $index + 1 ]\n        echo \"Yeah, great film[$index]: $FILM\"\n    done\n}\n\ntest_while()\n{\n    test_while_1\n    test_while_2\n    test_while_3\n}\n\ntest_while\n</code></pre>","tags":["condition","loop"]},{"location":"blog/20191106/6-sh-control/#until","title":"until","text":"<p>\u548c while \u547d\u4ee4\u7c7b\u4f3c\uff0c\u4f60\u53ef\u4ee5\u5728 until \u547d\u4ee4\u8bed\u53e5\u4e2d\u653e\u5165\u591a\u4e2a\u6d4b\u8bd5\u547d\u4ee4\u3002 \u53ea\u6709\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801\u51b3\u5b9a\u4e86 bash shell \u662f\u5426\u6267\u884c\u5df2\u5b9a\u4e49\u7684 other commands\u3002</p> <ol> <li>\u53ea\u6709\u6d4b\u8bd5\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801 \u4e0d\u4e3a0\uff0cbash shell \u624d\u4f1a\u6267\u884c\u5faa\u73af\u4e2d\u5217\u51fa\u7684\u547d\u4ee4\u3002</li> <li>\u5f53\u9996\u6b21\u6d4b\u8bd5\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801\u4e3a0\u65f6\uff0c\u5c06\u4e00\u6b21\u4e5f\u4e0d\u6267\u884c\u5faa\u73af\u4f53\u3002</li> </ol> <pre><code>until test commands\ndo\n    other commands\ndone\n</code></pre> test-until.sh <pre><code>#!/bin/bash\n\ntest_until_1()\n{\n    echo \"----------------------------------------\"\n    echo \"test_until_1\"\n    echo \"----------------------------------------\"\n    var1=100\n    until [ $var1 -eq 0 ]\n    do\n        echo $var1\n        var1=$[ $var1 - 25 ]\n    done\n}\n\n# \u7528while\u5faa\u73af\u9010\u884c\u8bfb\u53d6\u6587\u672c\u5185\u5bb9\ntest_until_2()\n{\n    echo \"----------------------------------------\"\n    echo \"test_until_2\"\n    echo \"----------------------------------------\"\n    var1=100\n    until echo $var1\n          [ $var1 -eq 0 ]\n    do\n        echo Inside the loop: $var1\n        var1=$[ $var1 - 25 ]\n    done\n}\n\ntest_until()\n{\n    test_until_1\n    test_until_2\n}\n\necho \"----------------------------------------\"\necho \"test_until_0\"\necho \"----------------------------------------\"\n\nvar0=0\nuntil [ $var0 -eq 0 ]\ndo\n    echo $var0\ndone\n\ntest_until\n</code></pre>","tags":["condition","loop"]},{"location":"blog/20191106/7-sh-function/","title":"Linux Shell Program - function","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u51fd\u6570\u3002</p>"},{"location":"blog/20191106/7-sh-function/#\u51fd\u6570\u5b9a\u4e49","title":"\u51fd\u6570\u5b9a\u4e49","text":"<p>bash shell \u63d0\u4f9b\u51fd\u6570\u652f\u6301\uff0c\u65b9\u4fbf\u5c06\u4ee3\u7801\u6a21\u5757\u5c01\u88c5\u4e3a\u51fd\u6570\uff0c\u4ee5\u4fbf\u590d\u7528\u3002</p> <p>\u6709\u4e24\u79cd\u521b\u5efa\u51fd\u6570\u7684\u683c\u5f0f\uff1a</p> <ol> <li>\u51fd\u6570\u540d\u52a0\u62ec\u53f7\uff1b  </li> <li>\u91c7\u7528\u5173\u952e\u5b57 function\uff0c\u540e\u8ddf\u51fd\u6570\u540d\uff1b  </li> </ol> <p>\u5f53\u524d\u51fd\u6570\u540d\u53ef\u901a\u8fc7\u5185\u7f6e\u53d8\u91cf <code>FUNCNAME</code> \u83b7\u53d6\u3002 \u5f53\u524d\u51fd\u6570\u7684\u8c03\u7528\u8005\u53ef\u901a\u8fc7\u8c03\u7528 <code>caller</code> \u6253\u5370\u3002</p> <pre><code>#\u65b9\u5f0f1\nname() {\n    commands\n    # echo \"FUNCNAME = $FUNCNAME\"\n}\n\n#\u65b9\u5f0f2\nfunction name {\n    commands\n    # echo \"FUNCNAME = $FUNCNAME\"\n}\n</code></pre> <p>transfer.sh - Easy file sharing from the command line</p> <pre><code>transfer() {\n    if [ $# -eq 0 ]; then\n        echo \"No arguments specified.\\nUsage:\\n transfer &lt;file|directory&gt;\\n ... | transfer &lt;file_name&gt;\" &gt;&amp;2\n        return 1\n    fi\n    if tty -s; then\n        file=\"$1\"\n        file_name=$(basename \"$file\")\n        if [ ! -e \"$file\" ]; then\n            echo \"$file: No such file or directory\" &gt;&amp;2\n            return 1\n        fi\n        if [ -d \"$file\" ]; then\n            file_name=\"$file_name.zip\" ,\n            (cd \"$file\" &amp;&amp; zip -r -q - .) | curl --progress-bar --upload-file \"-\" \"https://transfer.sh/$file_name\" | tee /dev/null,\n        else\n            cat \"$file\" | curl --progress-bar --upload-file \"-\" \"https://transfer.sh/$file_name\" | tee /dev/null\n        fi\n    else\n        file_name=$1\n        curl --progress-bar --upload-file \"-\" \"https://transfer.sh/$file_name\" | tee /dev/null\n    fi\n}\n</code></pre>"},{"location":"blog/20191106/7-sh-function/#\u51fd\u6570\u8c03\u7528","title":"\u51fd\u6570\u8c03\u7528","text":"<p>\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u51fd\u6570\uff0c\u53ea\u9700\u8981\u50cf\u5176\u4ed6shell\u547d\u4ee4\u4e00\u6837\uff0c\u5728\u884c\u4e2d\u6307\u5b9a\u51fd\u6570\u540d\u5c31\u884c\uff0c\u65e0\u9700\u62ec\u53f7\u3002 \u5982\u679c\u60f3\u4f20\u9012\u53c2\u6570\uff0c\u76f4\u63a5\u901a\u8fc7\u7a7a\u683c\u5206\u5272\u6307\u5b9a\u4f4d\u7f6e\u53c2\u6570\u5373\u53ef\u3002</p>"},{"location":"blog/20191106/7-sh-function/#\u51fd\u6570\u53c2\u6570","title":"\u51fd\u6570\u53c2\u6570","text":"<p>\u53c2\u8003 basic \u4e2d\u7684\u547d\u4ee4\u884c\u53c2\u6570\u3002</p> <p>\u5728\u811a\u672c\u4e2d\u6307\u5b9a\u51fd\u6570\u65f6\uff0c\u5fc5\u987b\u5c06\u53c2\u6570\u548c\u51fd\u6570\u653e\u5728\u540c\u4e00\u884c\uff0c\u50cf\u8fd9\u6837:</p> <pre><code>    func1 $value1 10\n</code></pre> <p>\u7136\u540e\u51fd\u6570\u53ef\u4ee5\u7528\u53c2\u6570\u73af\u5883\u53d8\u91cf\u6765\u83b7\u5f97\u53c2\u6570\u503c\u3002</p> <p>\u5bf9\u4e8e\u811a\u672c\uff0c<code>$0</code> \u4e3a\u811a\u672c\u540d\u79f0\uff1b\u5bf9\u4e8e\u51fd\u6570\u8c03\u7528\uff0c<code>$0</code> \u4e3a\u51fd\u6570\u540d\u79f0\u3002 \u7a7a\u683c\u76f8\u95f4\u7684 \\(1,...,\\)9 \u4e3a\u51fd\u6570\u7684\u4f4d\u7f6e\u53c2\u6570\uff0c\u5982\u679c\u53c2\u6570\u4e2a\u6570\u8d85\u8fc79\u4e2a\uff0c\u53ef\u4ee5\u4ee5 <code>${10}</code>,<code>${11}</code> \u8fd9\u79cd\u5f62\u5f0f\u5f15\u7528\u3002</p> <ol> <li><code>$#</code>\uff1a\u53c2\u6570\u4e2a\u6570\uff1b  </li> <li><code>$1</code>\u3001<code>$2</code>\u3001...\u3001<code>$9</code>\uff0c<code>${10}</code>\u3001<code>${11}</code>\u3001...\uff1a\u987a\u5e8f\u4f4d\u7f6e\u53c2\u6570\uff1b  </li> <li><code>${!#}</code> \u4ee3\u8868\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff1b  </li> </ol> <p>\u5982\u679c\u811a\u672c\u7684\u6240\u6709\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u9700\u8981\u4f20\u9012\u7ed9\u51fd\u6570\uff0c\u53ef\u901a\u8fc7 <code>func $@</code> \u6216 <code>func $*</code> \u5f62\u5f0f\u4f20\u9012\u3002</p>"},{"location":"blog/20191106/7-sh-function/#\u5c40\u90e8\u53d8\u91cf","title":"\u5c40\u90e8\u53d8\u91cf","text":"<p>\u51fd\u6570\u4f7f\u7528\u4e24\u79cd\u7c7b\u578b\u7684\u53d8\u91cf:</p> <ol> <li>\u5168\u5c40\u53d8\u91cf  </li> <li>\u5c40\u90e8\u53d8\u91cf  </li> </ol> <p>\u51fd\u6570\u5185\u90e8\u53ef\u4ee5\u901a\u8fc7 local \u4fee\u9970\u5b9a\u4e49\u5c40\u90e8\u53d8\u91cf\uff0c\u9650\u5b9a\u4f5c\u7528\u57df\u4e3a\u51fd\u6570\u5185\u90e8\u3002 \u8c03\u7528\u51fd\u6570\u540e\uff0c\u53d8\u91cf\u5728\u540e\u7eed\u811a\u672c\u4e2d\u4e0d\u53ef\u89c1\uff0c\u4e0d\u53ef\u4ee5\u5f15\u7528\u8bbf\u95ee\u3002</p> <p><code>local</code>: can only be used in a function</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728\u811a\u672c\u4e2d\u5b9a\u4e49\u7684\u4e0d\u52a0 local \u4fee\u9970\u7684\u53d8\u91cf\u90fd\u662f\u5168\u5c40\u53d8\u91cf\u3002 \u8c03\u7528\u51fd\u6570\u540e\uff0c\u53d8\u91cf\u5728\u540e\u7eed\u811a\u672c\u4e2d\u53ef\u4ee5\u7ee7\u7eed\u5f15\u7528\u8bbf\u95ee\u3002</p> <p>local\u5173\u952e\u5b57\u4fdd\u8bc1\u4e86\u53d8\u91cf\u4f5c\u7528\u57df\u53ea\u5c40\u9650\u5728\u8be5\u51fd\u6570\u4e2d\u3002 \u5982\u679c\u5728\u811a\u672c\u4e2d\u8be5\u51fd\u6570\u4e4b\u5916\u6709\u540c\u540d\u7684\u53d8\u91cf\uff0c \u90a3\u4e48shell\u5c06\u4f1a\u4fdd\u6301\u8fd9\u4e24\u4e2a\u53d8\u91cf\u7684\u503c\u662f\u5206\u79bb\u7684\u3002 \u8fd9\u6837\uff0c\u4f60\u5c31\u80fd\u5f88\u8f7b\u677e\u5730\u5c06\u51fd\u6570\u5185\u90e8\u53d8\u91cf\u548c\u811a\u672c\u4e2d\u7684\u5176\u4ed6\u53d8\u91cf\u9694\u79bb\u5f00\u4e86\uff0c\u53ea\u5171\u4eab\u9700\u8981\u5171\u4eab\u7684\u5168\u5c40\u53d8\u91cf\u3002</p> <p>\u4ee5\u4e0b\u662f\u811a\u672c brew.plugin.zsh \u4e2d\u7684\u4ee3\u7801\u7247\u6bb5\uff1a</p> <pre><code>function brews() {\n  local formulae=\"$(brew leaves | xargs brew deps --installed --for-each)\"\n\n}\n</code></pre>"},{"location":"blog/20191106/7-sh-function/#\u51fd\u6570\u8fd4\u56de","title":"\u51fd\u6570\u8fd4\u56de","text":"<p>bash shell \u4f1a\u628a\u51fd\u6570\u5f53\u4f5c\u4e00\u4e2a\u5c0f\u578b\u811a\u672c\uff0c\u8fd0\u884c\u7ed3\u675f\u65f6\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9000\u51fa\u72b6\u6001\u7801\u3002 \u51fd\u6570\u7684\u9000\u51fa\u72b6\u6001\u7801\uff0c\u5b9e\u9645\u4e0a\u662f\u6700\u540e\u4e00\u6761\u547d\u4ee4\u6267\u884c\u7684\u9000\u51fa\u72b6\u6001\u3002 \u53ef\u4ee5\u7528\u6807\u51c6\u53d8\u91cf <code>$?</code> \u6765\u83b7\u53d6\u51fd\u6570\u8c03\u7528\u7684\u8fd4\u56de\u72b6\u6001\u7801\u3002</p> <p>\u4e5f\u53ef\u4ee5\u7528 return \u547d\u4ee4\u6307\u5b9a\u8fd4\u56de\u4e00\u4e2a 0\uff5e255 \u4e4b\u95f4\u7684\u6574\u6570\u503c\u3002 \u7136\u540e\u8c03\u7528\u65b9\u901a\u8fc7 <code>if [ $? -eq 0 ]</code> \u6d4b\u8bd5\u51fd\u6570\u8fd4\u56de\u503c\u3002</p> <p>\u5982\u679c\u60f3\u8fd4\u56de\u8d85\u8fc7256\u7684\u6574\u6570\u503c\u6216\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u5219\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u51fd\u6570\u8f93\u51fa\u3002</p>"},{"location":"blog/20191106/7-sh-function/#\u51fd\u6570\u8f93\u51fa","title":"\u51fd\u6570\u8f93\u51fa","text":"<p>\u6b63\u5982\u53ef\u4ee5\u8fd9\u6837 result=<code>dbl</code> \u5c06\u547d\u4ee4\u7684\u8f93\u51fa\u4fdd\u5b58\u5230shell\u53d8\u91cf\u4e2d\u4e00\u6837\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u51fd\u6570\u7684\u8f93\u51fa\u91c7\u7528\u540c\u6837\u7684\u5904\u7406\u529e\u6cd5\u3002 \u4e0b\u9762\u662f\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f8b\u5b50\u3002</p> <pre><code>#!/bin/bash\n# using the echo to return a value\n\nfunction dbl\n{\n    read -p \"Enter a value: \" value\n    echo $[ $value * 2 ]\n}\n\nresult=$(dbl)\necho \"The new value is $result\"\n</code></pre> <p>dbl \u51fd\u6570\u4f1a\u7528 echo \u8bed\u53e5\u6765\u663e\u793a\u8ba1\u7b97\u7684\u7ed3\u679c\u3002</p>"},{"location":"blog/20191106/7-sh-function/#\u547d\u4ee4\u4e2d\u5b9a\u4e49\u51fd\u6570","title":"\u547d\u4ee4\u4e2d\u5b9a\u4e49\u51fd\u6570","text":"<p>Define function in unix/linux command line (e.g. BASH) - Stack Overflow</p> <p>\u5728\u7ec8\u7aef\u4e2d\uff0c\u5982\u679c\u60f3\u591a\u4e2a\u547d\u4ee4\u4e00\u8d77\u8fd0\u884c\uff0c\u53ef\u4ee5\u628a\u5b83\u4eec\u653e\u5728\u540c\u4e00\u884c\u4e2d\uff0c\u5f7c\u6b64\u95f4\u7528\u5206\u53f7\uff08<code>;</code>\uff09\u9694\u5f00\u3002 \u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e2d\u5b9a\u4e49\u5305\u542b\u591a\u6761\u547d\u4ee4\u7684\u4e00\u884c\u51fd\u6570\uff0c\u4f46\u6bcf\u6761\u547d\u4ee4\u7684\u7ed3\u5c3e\u5fc5\u987b\u5305\u542b\u5206\u53f7\uff0c\u8fd9\u6837shell\u624d\u77e5\u9053\u547d\u4ee4\u5728\u54ea\u5206\u5f00\u3002</p> <p>\u6b64\u5916\uff0c\u4e5f\u53ef\u4ee5\u5728\u547d\u4ee4\u4e2d\u8f93\u5165\u51fd\u6570\uff0c\u6309\u7167\u63d0\u793a\u7b26\u8f93\u5165\u5373\u53ef\u3002</p> <p>\u5047\u8bbe\u6709\u51fd\u6570 check_python_version\uff1a</p> <pre><code>check_python_version()\n{\n    if python -V &amp;&gt;/dev/null;\n    then\n        python_version=$(python -V) 1&gt;/dev/null\n        echo \"python installed: $python_version\"\n        return 0\n    else\n        echo \"python uninstalled!\"\n        return 1\n    fi\n}\n</code></pre> <p>\u4ee5\u4e0a\u811a\u672c\u76f4\u63a5\u590d\u5236\u5230\u547d\u4ee4\u884c\u4e2d\uff0c\u611f\u53f9\u53f7\u8981\u8f6c\u4e49\uff0c\u5426\u5219\u4f1a\u622a\u65ad\u63d0\u793a function else dquote&gt;\u3002</p> <p>\u5728\u547d\u4ee4\u884c\u4e0b\u9010\u884c\u8f93\u5165\u5982\u4e0b\uff1a</p> <pre><code>check_python_version() {\nfunction&gt; if python -V &amp;&gt;/dev/null;\nfunction if&gt; then\nfunction then&gt; python_version=$(python -V) 1&gt;/dev/null;\nfunction then&gt; echo \"python installed: $python_version\";\nfunction then&gt; return 0;\nfunction then&gt; else\nfunction else&gt; echo \"python uninstalled\\!\";\nfunction else&gt; return 1;\nfunction else&gt; fi\nfunction&gt; }\n</code></pre> <p>\u7136\u540e\u8f93\u5165 <code>check_python_version</code> \u56de\u8f66\u5373\u53ef\u8c03\u7528\u8be5\u51fd\u6570\u3002</p> <p>\u4ee5\u4e0b\u51fd\u6570\u5c06\u4e24\u53e5\u811a\u672c\u7528\u5206\u53f7\u9694\u5f00\u653e\u5728\u540c\u4e00\u884c\u91cc\uff1a</p> <pre><code>pman() { manpage=$(man -w $@); mandoc -T pdf $manpage | open -fa Preview; }\n</code></pre>"},{"location":"blog/20191106/7-sh-function/#\u8de8\u811a\u672c\u8c03\u7528","title":"\u8de8\u811a\u672c\u8c03\u7528","text":""},{"location":"blog/20191106/7-sh-function/#source\u5bfc\u5165\u5f15\u7528\u811a\u672c","title":"source\u5bfc\u5165\u5f15\u7528\u811a\u672c","text":"<p>Shell \u811a\u672c\u8c03\u7528\u53e6\u4e00\u4e2a\u811a\u672c\u7684\u4e09\u79cd\u65b9\u6cd5 \u5728 Shell \u811a\u672c\u4e2d\u8c03\u7528\u53e6\u4e00\u4e2a Shell \u811a\u672c\u7684\u4e09\u79cd\u65b9\u5f0f </p> <ul> <li>fork: \u5982\u679c\u811a\u672c\u6709\u6267\u884c\u6743\u9650\u7684\u8bdd\uff0c<code>path/to/foo.sh</code>\u3002\u5982\u679c\u6ca1\u6709\uff0c<code>sh path/to/foo.sh</code>\u3002  </li> <li>exec: <code>exec path/to/foo.sh</code> </li> <li>source: <code>source path/to/foo.sh</code> </li> </ul> <p><code>. aux_etc.sh</code>/<code>source aux_etc.sh</code> \u7684\u4f5c\u7528\u662f\u5728\u540c\u4e00\u4e2ashell\u8fdb\u7a0b\u4e2d\u5bfc\u5165\u53e6\u4e00\u4e2a\u6587\u4ef6\uff08bash.sh\uff09\u4e2d\u7684\u811a\u672c\uff0c\u4ee5\u4fbf\u5f15\u7528\u5176\u4e2d\u7684\u53d8\u91cf\uff0c\u8c03\u7528\u5176\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570\u3002</p> <p>\u7c7b\u4f3c C/C++ \u8bed\u8a00\u4e2d\u7684 <code>#include &lt;cstdio&gt;</code>\u3001python \u4e2d\u7684 <code>import os</code>\u3001nodejs \u4e2d\u7684 <code>const server = require('server');</code>\u3002</p> <p>\u5982\u679c\u4e0d\u662f\u5728\u811a\u672c\u6240\u5728\u76ee\u5f55\uff0c\u800c\u662f\u5728\u5916\u5c42\u76ee\u5f55\u6267\u884csh\uff0c\u90a3\u4e48 source \u5f15\u5165\u811a\u672c\u9700\u8981\u76f8\u5bf9\u8def\u5f84\u3002</p> <p>\u9664\u4e86\u7edd\u5bf9\u8def\u5f84\uff0c\u5b89\u5168\u5f15\u5165\u540c\u76ee\u5f55\u4e0b\u7684\u5176\u4ed6\u811a\u672c\u7684\u5199\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>#!/bin/bash\n\nsource $(dirname $0)/aux_etc.sh\n</code></pre> <p>\u5047\u5982\u5f15\u5165\u7684\u811a\u672c\u6587\u4ef6\u8def\u5f84\u662f\u62fc\u63a5\u7684\u5b57\u7b26\u4e32\uff0c\u5219 ShellCheck \u5c06\u4f1a\u8b66\u544a SC1090: Can't follow non-constant source. Use a directive to specify location.</p> <p>\u53c2\u8003 Source from string? Is there any way in shell?\uff0c\u53ef\u8003\u8651\u7528 <code>eval</code> \u6765\u89e3\u91ca\u6267\u884c source \u8bed\u53e5\uff1a</p> <p>\u4ee5\u4e0b\u811a\u672c\u8def\u5f84\u4e3a scripts/proxy/launch.sh\uff0c\u5bfc\u5165\u914d\u7f6e\u811a\u672c\u7684\u8def\u5f84\u4e3a scripts/conf/debug.conf\u3002</p> <pre><code>    # \u5bfc\u5165shell\u811a\u672c\u683c\u5f0f\u7684\u914d\u7f6e\u6587\u4ef6\n    script_dir=\"$(dirname \"$(dirname \"$0\")\")\"\n    conf=$script_dir/config/\"${run_mode:=debug}\".conf\n    # echo \"conf = $conf\"\n    if [ -f \"$conf\" ]; then\n        eval \"source $conf\"\n    fi\n</code></pre>"},{"location":"blog/20191106/7-sh-function/#\u7ec8\u7aef\u8c03\u7528\u811a\u672c\u4e2d\u7684\u51fd\u6570","title":"\u7ec8\u7aef\u8c03\u7528\u811a\u672c\u4e2d\u7684\u51fd\u6570","text":"<p>\u5047\u8bbe\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u811a\u672c <code>~/Projects/shell/test-function.sh</code>\uff0c\u5176\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>~/Projects/shell | cat test-function.sh\n#!/bin/bash\n\nuse_python38()\n{\n    echo \"which python3 = `which python3`\"\n    export PATH=/usr/local/opt/python@3.8/bin:$PATH\n    echo \"use_python38...\"\n    echo \"which python3 = `which python3`\"\n}\n\nfile_name=$0\nscript_dir=$(dirname $0)\nscript_name=$(basename $0)\necho \"file_name=$file_name\"\necho \"script_dir=$script_dir\"\necho \"script_name=$script_name\"\n</code></pre> <p>\u5728\u7ec8\u7aef\u6267\u884c\u70b9\u6216source\u547d\u4ee4\u5bfc\u5165\u52a0\u8f7d\u811a\u672c\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5728\u5f53\u524d\u547d\u4ee4\u884c\u4e2d\u5f15\u7528sh\u811a\u672c\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\u548c\u51fd\u6570\u4e86\u3002</p> <pre><code>~ | source ~/Projects/shell/test-function.sh\n\n~ | echo $file_name\n/Users/faner/Projects/shell/test-function.sh\n\n~ | use_python38\nwhich python3 = /usr/local/bin/python3\nuse_python38...\nwhich python3 = /usr/local/opt/python@3.8/bin/python3\n</code></pre> <p>\u5047\u8bbe\u811a\u672c check_python_version.sh \u53ea\u5305\u542b check_python_version \u51fd\u6570\uff0c\u90a3\u4e48source\u5bfc\u5165\u7ec8\u7aef\uff0c\u4ec5\u662f\u5bfc\u5165\u51fd\u6570\u3002</p> <p>\u5982\u679c sh \u811a\u672c\u4e2d\u6709\u5165\u53e3\u70b9 main \u8c03\u7528\u4e86 check_python_version \u51fd\u6570\uff0c\u90a3\u4e48source\u5bfc\u5165\u7ec8\u7aef\uff0c\u76f4\u63a5\u8fd0\u884c\u811a\u672c\u3002</p> <pre><code>#!/bin/bash\n\ncheck_python_version()\n{\n    # ...\n}\n\nmain()\n{\n    check_python_version\n}\n\nmain \"$@\" # $*\n</code></pre> <p>source\u5bfc\u5165\u6216\u8fd0\u884c\u811a\u672c\uff0c\u4e0e\u5f53\u524d\u7ec8\u7aefshell\u5171\u4eab\u73af\u5883\u53d8\u91cf\u3002 \u4f46\u76f4\u63a5\u5728\u7ec8\u7aef\u6267\u884c\u811a\u672c\uff0c\u5c06\u6309\u7167Shebang\u65b0\u8d77\u5b50shell\u8fdb\u7a0b\uff0c\u73af\u5883\u53d8\u91cf\u53ef\u80fd\u4e0e\u5f53\u524d\u7ec8\u7aefshell\u4e0d\u4e00\u81f4\u3002 \u5728\u6267\u884c\u5b8csh\u540e\uff0c\u811a\u672c\u4e2d\u672aexport\u5bfc\u51fa\u7684\u53d8\u91cf\uff0c\u65e0\u6cd5\u518d\u5f15\u7528\uff01</p> <pre><code>~/Projects/shell | ./test-function.sh\nfile_name=./test-function.sh\nscript_dir=.\nscript_name=test-function.sh\n\n# \u53d8\u91cffile_name\u672aexport\uff0c\u6267\u884c\u5b8csh\u540e\u4e0d\u53ef\u89c1\n~/Projects/shell | echo $file_name\n</code></pre>"},{"location":"blog/20191106/7-sh-function/#\u8c03\u7528\u5176\u4ed6\u811a\u672c\u4e2d\u7684\u51fd\u6570","title":"\u8c03\u7528\u5176\u4ed6\u811a\u672c\u4e2d\u7684\u51fd\u6570","text":"<p>Bash\u7f16\u7a0b\u5165\u95e8-4\uff1a\u51fd\u6570</p> <p>\u5047\u8bbe\u6709\u4e24\u4e2a\u811a\u672c <code>my_info.bash</code> \u548c <code>app.bash</code>\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>$ cat my_info.sh\n#!/bin/bash\n\nfunction my_info()\n{\n    lscpu &gt;&gt; $1\n    uname \u2013a &gt;&gt; $1\n    free \u2013h &gt;&gt; $1\n}\n</code></pre> <pre><code>$ cat app.bash\n#!/bin/bash\n\nsource ./my_info.bash  #\u5f15\u5165\u53e6\u4e00\u4e2a\u811a\u672c\nmy_info output.file    #\u8c03\u7528\u53e6\u4e00\u4e2a\u811a\u672c\u4e2d\u7684\u51fd\u6570\n</code></pre> <p>\u8fd0\u884c app.bash \u65f6\uff0c\u6267\u884c\u5230 source \u547d\u4ee4\u90a3\u4e00\u884c\u65f6\uff0c\u5c31\u4f1a\u6267\u884c my_info.bash \u811a\u672c\u3002 \u5728 app.bash \u7684\u540e\u7eed\u90e8\u5206\uff0c\u5c31\u53ef\u4ee5\u8c03\u7528 my_info.bash \u4e2d\u7684 my_info \u51fd\u6570\u3002</p>"},{"location":"blog/20191106/8-sh-string/","title":"Linux Shell Program - string","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u5b57\u7b26\u4e32\u5e38\u7528\u64cd\u4f5c\u3002</p> <p>linux shell \u5b57\u7b26\u4e32\u64cd\u4f5c\u8be6\u89e3 shell \u53d8\u91cf\u7684\u9ad8\u7ea7\u7528\u6cd5 </p>"},{"location":"blog/20191106/8-sh-string/#\u53d8\u91cf\u66ff\u6362","title":"\u53d8\u91cf\u66ff\u6362","text":"<p>\u53c2\u8003 man bash - <code>Parameter Expansion</code> \u7ae0\u8282</p> <pre><code>$ man bash\n\n       ${parameter:-word}\n              Use Default Values.  If parameter is unset or null, the  expansion  of  word  is  substituted.\n              Otherwise, the value of parameter is substituted.\n       ${parameter:=word}\n              Assign  Default  Values.   If parameter is unset or null, the expansion of word is assigned to\n              parameter.  The value of parameter is then substituted.   Positional  parameters  and  special\n              parameters may not be assigned to in this way.\n       ${parameter:?word}\n              Display  Error  if  Null or Unset.  If parameter is null or unset, the expansion of word (or a\n              message to that effect if word is not present) is written to the standard error and the shell,\n              if it is not interactive, exits.  Otherwise, the value of parameter is substituted.\n       ${parameter:+word}\n              Use  Alternate  Value.   If  parameter is null or unset, nothing is substituted, otherwise the\n              expansion of word is substituted.\n</code></pre> <p>shell \u7f16\u7a0b\uff1a:\u540e\u9762\u8ddf-=?+\u7684\u610f\u4e49 shell\u4e4b\u53d8\u91cf\u66ff\u6362\uff1a:=\u3001=\u3001:-\u3001-\u3001=?\u3001?\u3001:+\u3001+\u53e5\u6cd5 </p> <p>POSIX \u6587\u6863\u4e2d\u7684\u8fd9\u5f20\u8868\u8bf4\u5f97\u5f88\u6e05\u695a\uff1a</p> parameterSet and Not Null parameterSet But Null parameterUnset ${parameter:-word} substitute parameter substitute word substitute word ${parameter-word} substitute parameter substitute null substitute word ${parameter:=word} substitute parameter assign word assign word ${parameter=word} substitute parameter substitute null assign word ${parameter:?word} substitute parameter error, exit error, exit ${parameter?word} substitute parameter substitute null error, exit ${parameter:+word} substitute word substitute null substitute null ${parameter+word} substitute word substitute word substitute null <p>shell \u811a\u672c ${1:-\"false\"}\u7684\u542b\u4e49</p> <p>\u5982\u679c \\(1 \u5b58\u5728\u5e76\u4e14\u4e0d\u4e3a\u7a7a\uff0c\u5219 a=\\)1\uff1b\u672a\u5b9a\u4e49\u6216\u4e3a\u7a7a\uff0c\u5219 a=false;</p> <p>Usage of :- (colon dash) in bash </p> <p><code>${PUBLIC_INTERFACE:-eth0}</code>: If <code>$PUBLIC_INTERFACE</code> exists and isn't null, return its value, otherwise return \"eth0\".</p>"},{"location":"blog/20191106/8-sh-string/#demo","title":"demo","text":"<p>in <code>/etc/zshrc</code>: If <code>ZDOTDIR</code> is unset(or empty), <code>HOME</code> is used instead.</p> <pre><code>$ vim /etc/zshrc\n\nHISTFILE=${ZDOTDIR:-$HOME}/.zsh_history\n</code></pre> <p>zsh-autosuggestions/INSTALL\uff1a\u5982\u679c\u53d8\u91cf <code>ZSH_CUSTOM</code> \u672a\u5b9a\u4e49\u6216\u4e3a\u7a7a\uff0c\u5219\u66ff\u6362\u4e3a <code>~/.oh-my-zsh/custom</code>\u3002</p> <pre><code>git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions\n</code></pre> <p>How variables inside braces are evaluated </p> <p>Omitting the <code>:</code> drops the \"or null\" part of all these definitions.</p> <p>This is all described in the bash(1) manpage, and in POSIX.</p> <ol> <li>\u53d8\u91cf\u672a\u5b9a\u4e49\uff1a</li> </ol> <pre><code># \u672a\u5b9a\u4e49\u53d8\u91cf\n~  $ unset a\n# \u53d8\u91cf\u672a\u5b9a\u4e49\uff0c\u8fd4\u56dedefault\n~  $ echo \"${a:-default}\"\ndefault\n# \u53d8\u91cf\u672a\u5b9a\u4e49\uff0c\u8fd4\u56dedefault\n~  $ echo \"${a-default}\"\ndefault\n</code></pre> <ol> <li>\u53d8\u91cf\u6709\u5b9a\u4e49\uff0c\u4f46\u4e3a\u7a7a\u503c\uff08\u7a7a\u5b57\u7b26\u4e32\uff09</li> </ol> <pre><code># \u5b9a\u4e49\u53d8\u91cf\uff0c\u4f46\u8d4b\u503c\u4e3a\u7a7a\n~  $ a= # a=''\n# \u53d8\u91cfa\u5df2\u5b9a\u4e49\uff0c\u4f46\u503c\u4e3a\u7a7a\uff0c\u8fd4\u56dea\n~  $ echo \"${a:-default}\"\ndefault\n# \u53d8\u91cfa\u5df2\u5b9a\u4e49\uff0c\u8fd4\u56dea\u2014\u2014\u7a7a\u503c\n~  $ echo \"${a-default}\"\n\n~  $\n</code></pre> <ol> <li>\u5b9a\u4e49\u53d8\u91cf\uff0c\u4e14\u975e\u7a7a\u503c</li> </ol> <pre><code># \u5b9a\u4e49\u53d8\u91cf\uff0c\u4e14\u6709\u8d4b\u503c\uff08\u975e\u7a7a\uff09\uff0c\u8fd4\u56dea\n~  $ a=test\n~  $ echo \"${a:-default}\"\ntest\n~  $ echo \"${a-default}\"\ntest\n</code></pre> <ol> <li>\u53d8\u91cf\u672a\u5b9a\u4e49\u6216\u4e3a\u7a7a\uff0c\u8d4b\u9ed8\u8ba4\u503c</li> </ol> <pre><code># \u53d8\u91cf\u672a\u5b9a\u4e49\uff0c\u8d4b\u9ed8\u8ba4\u503c\n~  $ unset a\n~  $ echo \"${a:=default}\"\ndefault\n~  $ echo $a\ndefault\n\n# \u53d8\u91cf\u4e3a\u7a7a\u503c\uff0c\u8d4b\u9ed8\u8ba4\u503c\n~ $ echo $a\ndefault\n~ $ a=''\n~ $ echo \"${a:=default}\"\ndefault\n</code></pre> <p>The <code>+</code> form might seem strange, but it is useful when constructing variables in several steps:</p> <pre><code>PATH=\"${PATH}${PATH:+:}/blah/bin\"\n</code></pre> <p>will add <code>:</code> before <code>/blah/bin</code> only if PATH is non-empty, which avoids having a path starting with <code>:</code>.</p> <ul> <li>\u5982\u679c PATH \u672a\u5b9a\u4e49\u6216\u4e3a\u7a7a\uff0c\u5219\u4ec0\u4e48\u4e5f\u4e0d\u505a\uff0c\u7b2c\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\u4e0d\u7528\u6dfb\u52a0\u5192\u53f7\u524d\u7f00\u5206\u9694\u7b26\uff1b  </li> <li>\u5982\u679c PATH \u6709\u5b9a\u4e49\u6216\u975e\u7a7a\uff0c\u5219\u76f8\u5f53\u4e8e\u5728\u73b0\u6709 PATH \u540e\u9762\u8ffd\u52a0\u53d8\u91cf\uff1a<code>PATH=${PATH}:/blash/bin</code>\uff1b  </li> </ul>"},{"location":"blog/20191106/8-sh-string/#default","title":"default","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u6bb5\u6765\u81ea\u751f\u4ea7\u5b9e\u8df5\u4e2d\u7684sh\u811a\u672c\uff0c\u57fa\u4e8e <code>:=</code> \u6765\u7ed9\u672a\u5b9a\u4e49\u6216\u7a7a\u503c\u53d8\u91cf\u8d4b\u9ed8\u8ba4\u503c\u515c\u5e95\uff1a</p> <pre><code>    # \u515c\u5e95\u542f\u52a8\u89d2\u8272\u548c\u6a21\u5f0f\n    echo \"role = ${role:=client}\"\n    echo \"mode = ${mode:=debug}\"\n\n    # \u515c\u5e95\u9ed8\u8ba4\u670d\u52a1\u548c\u4ee3\u7406\u7aef\u53e3\n    echo \"web_port = ${web_port:=8080}\"\n    echo \"proxy_port = ${proxy_port:=8010}\"\n</code></pre> <p>\u4ee5\u4e0bsh\u811a\u672c\u4e2d\u8c03\u7528get_lan_ip\u51fd\u6570\uff0c\u9884\u671f\u5176\u4e2d\u4f1a\u5b9a\u4e49\u672aexport\u7684\u5168\u5c40\u53d8\u91cflan_ip\u3002</p> <pre><code>    get_lan_ip\n    echo \"lan_ip = $lan_ip\"\n</code></pre> <p>\u7531\u4e8e\u65e0\u6cd5\u786e\u4fdd\u7b2c\u4e09\u65b9\u811a\u672c\u4e2d\u7684\u5176\u4ed6\u51fd\u6570\u662f\u5426\u5b9a\u4e49\u4e86\u8be5\u53d8\u91cf\uff0cShellCheck \u4f1a\u62a5\u5f15\u7528\u5b89\u5168\u8b66\u544a\uff1a</p> <p>SC2154: lan_ip is referenced but not assigned.</p> <p>\u5982\u679c\u5c40\u57df\u7f51 LAN IP \u83b7\u53d6\u4e0d\u5230\uff0c\u5f80\u5f80\u610f\u5473\u7740\u7f51\u7edc\u670d\u52a1\u4e0d\u53ef\u7528\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>:?</code> \u8fdb\u884c\u5224\u7a7a\u8b66\u544a\u3002</p> <pre><code>    echo \"lan_ip = ${lan_ip:?unset or null}\"\n</code></pre> <p>\u8fd9\u6837\uff0c\u5982\u679c lan_ip \u672a\u5b9a\u4e49\u6216\u4e3a\u7a7a\u503c\uff0c\u5219\u76f4\u63a5\u62a5\u9519\u4e2d\u6b62\u9000\u51fa\uff08exit 1\uff09\u3002</p> <pre><code>Wi-Fi en0 : status=inactive\n./scripts/proxy/launch_shelf.sh: line 33: lan_ip: unset or null\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#read","title":"read","text":"<p>\u6211\u4eec\u6765\u770b\u4e00\u4e0b How to read from a file or standard input in Bash \u8fd9\u4e2a\u95ee\u9898\uff0c\u4f18\u5148\u4ece\u6587\u4ef6\u8bfb\u5165\u53c2\u6570\uff0c\u5426\u5219\u4ecestdin\u63a5\u53d7\u8f93\u5165\u3002</p> <p>Read either the first argument or from stdin</p> <p><code>file=${1--}</code>\uff08<code>file=${1:--}</code>\uff0c\u7b49\u6548\u4e8e <code>${1:-/dev/stdin}</code>\uff09\uff0c\u53ef\u7406\u89e3\u4e3a <code>[ \"$1\" ] &amp;&amp; file=$1 || file=\"-\"</code>\u3002</p> <p>\u4ee5\u4e0b\u811a\u672c\uff0c\u4ece\u6587\u4ef6\\(1\u6216stdin\u8bfb\u53d6\u6570\u636e\u4f20\u7ed9cat\uff0c\u7136\u540e\u8f93\u51fa\u5230\u6587\u4ef6\\)2\u6216stdout\u3002</p> <pre><code>cat \"${1:-/dev/stdin}\" &gt; \"${2:-/dev/stdout}\"\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u5b57\u7b26\u4e32\u957f\u5ea6","title":"\u5b57\u7b26\u4e32\u957f\u5ea6","text":"<p>\u5b57\u7b26\u4e32\u957f\u5ea6\u8ba1\u7b97\u8868\u8fbe\u5f0f\uff1a<code>${#string}</code></p> <pre><code>$ file_path=/Users/faner/Downloads/iosdeploy_download/Documents/2905558360/image_original_flash\n$ echo $file_path\n/Users/faner/Downloads/iosdeploy_download/Documents/2905558360/image_original_flash\n</code></pre> <p>\u5b57\u7b26\u4e32\u957f\u5ea6\uff1a</p> <pre><code># echo ${#file_path}\n83\n$ strlen=${#file_path}\n$ echo $strlen\n83\n</code></pre> <p><code>unset string1</code> \u6216 <code>string1=\"\"</code> \u65f6\uff0c\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3a0\u3002 <code>string1=\" \"</code> \u65f6\uff0c\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3a1\u3002</p> <pre><code>$ if [ ${#string1} -gt 0 ]\nthen\n    print 'hello'\nelse\n    print 'world'\nfi\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u7d22\u5f15\u533a\u95f4","title":"\u7d22\u5f15\u533a\u95f4","text":"<p>\u6ce8\u610f\uff1a\u5b57\u7b26\u4e32\u7684\u7d22\u5f15\u4ece0\u5f00\u59cb\u3002</p> \u8868\u8fbe\u5f0f \u542b\u4e49 <code>${string:offset}</code> \u5728 $string \u4e2d, \u4ece\u7d22\u5f15\u4f4d\u7f6e position \u5f00\u59cb\u63d0\u53d6\u5b50\u4e32\u81f3\u672b\u5c3e <code>${string:offset:length}</code> \u5728 $string \u4e2d, \u4ece\u7d22\u5f15\u4f4d\u7f6e position \u5f00\u59cb\u63d0\u53d6\uff0c\u603b\u8ba1 length \u4e2a\u5b57\u7b26\u7684\u5b50\u4e32 <pre><code>$ man bash\n\n       ${parameter:offset}\n       ${parameter:offset:length}\n              Substring Expansion.  Expands to up to length characters of parameter starting at the  charac-\n              ter specified by offset.  If length is omitted, expands to the substring of parameter starting\n              at the character specified by offset.  length  and  offset  are  arithmetic  expressions  (see\n              ARITHMETIC EVALUATION below).  length must evaluate to a number greater than or equal to zero.\n              If offset evaluates to a number less than zero, the value is used as an offset from the end of\n              the  value of parameter.  If parameter is @, the result is length positional parameters begin-\n              ning at offset.  If parameter is an array name indexed by @ or *, the  result  is  the  length\n              members of the array beginning with ${parameter[offset]}.  A negative offset is taken relative\n              to one greater than the maximum index of the specified array.  Note  that  a  negative  offset\n              must  be  separated  from  the colon by at least one space to avoid being confused with the :-\n              expansion.  Substring indexing is zero-based unless the positional  parameters  are  used,  in\n              which case the indexing starts at 1.\n</code></pre> <p>\u4ece\u5de6\u5411\u53f3\u622a\u53d6\u5b50\u4e32\uff1a</p> <ul> <li><code>${str:0:1}</code>: \u8868\u793a\u4ece\u5de6\u8fb9\u7b2c1\u4e2a\u5b57\u7b26\u5f00\u59cb\uff0c\u622a\u53d61\u4e2a\u5b57\u7b26\uff0c\u5373\u7b2c\u4e00\u4e2a\u5b57\u7b26\u3002  </li> <li><code>${str:0:5}</code>\uff1a\u8868\u793a\u4ece\u5de6\u8fb9\u7b2c1\u4e2a\u5b57\u7b26\u5f00\u59cb\uff0c\u622a\u53d65\u4e2a\u5b57\u7b26\u3002  </li> <li><code>${str:7}</code>\uff1a\u8868\u793a\u4ece\u5de6\u8fb9\u7b2c8\u4e2a\u5b57\u7b26\u5f00\u59cb\uff0c\u4e00\u76f4\u5230\u7ed3\u5c3e\u3002  </li> </ul> <p>\u4ece\u53f3\u5411\u5de6\u622a\u53d6\u5b50\u4e32\uff1a</p> <ul> <li><code>${str:0-1:1}</code>: \u8868\u793a\u4ece\u53f3\u8fb9\u7b2c1\u4e2a\u5b57\u7b26\u5f00\u59cb\uff0c\u622a\u53d61\u4e2a\u5b57\u7b26\uff0c\u5373\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u3002  </li> <li><code>${str:0-2:2}</code>: \u8868\u793a\u4ece\u53f3\u8fb9\u7b2c2\u4e2a\u5b57\u7b26\u5f00\u59cb\uff0c\u622a\u53d62\u4e2a\u5b57\u7b26\uff0c\u5373\u672b\u5c3e\u4e24\u4e2a\u5b57\u7b26\u3002  </li> <li><code>${str:0-5}</code>\uff1a\u8868\u793a\u4ece\u53f3\u8fb9\u7b2c5\u4e2a\u5b57\u7b26\u5f00\u59cb\uff0c\u4e00\u76f4\u5230\u7ed3\u5c3e\u3002  </li> <li><code>${str:0-7:5}</code>\uff1a\u8868\u793a\u4ece\u53f3\u8fb9\u7b2c7\u4e2a\u5b57\u7b26\u5f00\u59cb\uff0c\u622a\u53d65\u4e2a\u5b57\u7b26\u3002  </li> </ul> <pre><code>name=\"this is my name\";\n# 1:4 \u4ece\u7b2c2\u4e2a\u5f00\u59cb \u5230\u7d22\u5f154\u622a\u6b62\n$ echo ${name:1:5}\nhis i\n# \u4e0d\u80fd\u7701\u7565\u5f00\u59cb\u7d22\u5f15\n$ echo ${name::4}\nzsh: closing brace expected\n# ::4 \u4ece\u7b2c\u4e00\u4e2a\u5b57\u7b26\u5f00\u59cb \u5f80\u540e\u622a\u53d64\u4e2a\u5b57\u7b26\n$ echo ${name:0:4}\nthis\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u7d22\u5f15\u4f4d\u7f6e","title":"\u7d22\u5f15\u4f4d\u7f6e","text":"<p>Linux shell \u83b7\u5f97\u5b57\u7b26\u4e32\u6240\u5728\u884c\u6570\u53ca\u4f4d\u7f6e</p> <p>\u53ef\u4ee5\u501f\u52a9 awk \u4e2d\u7684 <code>index</code> \u51fd\u6570\uff0c\u5728 awk \u7684 BEGIN \u4e2d\u9488\u5bf9 shell \u5b57\u7b26\u4e32\u53d8\u91cf\u8fdb\u884c\u64cd\u4f5c\uff1a</p> <pre><code>$ str='uellevcmpottcap'\n$ str1='ott'\n$ awk 'BEGIN{print index(\"'${str}'\",\"'${str1}'\") }'\n</code></pre> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5c06 shell \u53d8\u91cf\u4f20\u9012\u4f5c\u4e3a awk \u53d8\u91cf\uff0c\u5728 awk \u811a\u672c\u5185\u90e8\u64cd\u4f5c\u53d8\u91cf\uff1a</p> <p>shell \u67e5\u627e\u5b57\u7b26\u4e32\u4e2d\u5b57\u7b26\u51fa\u73b0\u7684\u4f4d\u7f6e</p> <pre><code>$ a=\"The cat sat on the mat\"\n$ test=\"cat\"\n$ index=`awk -v a=\"$a\" -v b=\"$test\" 'BEGIN{print index(a,b)}'`\n$ echo $index\n5\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u5b57\u7b26\u4e32\u62fc\u63a5","title":"\u5b57\u7b26\u4e32\u62fc\u63a5","text":"<p>\u5b57\u7b26\u4e32\u4e94\u79cd\u62fc\u63a5\u6a21\u5f0f\uff1a</p> <pre><code>#!/bin/bash\nname=\"Shell\"\nstr=\"Test\"\n\nstr1=$name$str      #\u4e2d\u95f4\u4e0d\u80fd\u6709\u7a7a\u683c\nstr2=\"$name $str\"   #\u5982\u679c\u88ab\u53cc\u5f15\u53f7\u5305\u56f4\uff0c\u90a3\u4e48\u4e2d\u95f4\u53ef\u4ee5\u6709\u7a7a\u683c\nstr3=\"$name: $str\"\nstr4=$name\": \"$str  #\u4e2d\u95f4\u53ef\u4ee5\u51fa\u73b0\u522b\u7684\u5b57\u7b26\u4e32\nstr5=\"${name}Script: ${str}\" #\u8fd9\u4e2a\u65f6\u5019\u9700\u8981\u7ed9\u53d8\u91cf\u540d\u52a0\u4e0a\u5927\u62ec\u53f7\n\necho $str1\necho $str2\necho $str3\necho $str4\necho $str5\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\uff1a</p> <pre><code>ShellTest\nShell Test\nShell: Test\nShell: Test\nShellScript: Test\n</code></pre> <p>\u7ecf\u5e38\u9700\u8981\u5728shell\u73af\u5883\u53d8\u91cf <code>PATH</code> \u4e2d\u5934\u63d2\u6216\u8ffd\u52a0\u7b2c\u4e09\u65b9\u5de5\u5177\u7684\u8def\u5f84\uff1a</p> <pre><code># testPATH \u521d\u59cb\u503c\npi@raspberrypi:~ $ testPATH=/usr/bin:/bin:/usr/sbin:/sbin\n\n# \u5934\u90e8\u63d2\u5165\npi@raspberrypi:~ $ testPATH=/usr/local/bin:$testPATH\n\n# \u5c3e\u90e8\u8ffd\u52a0\npi@raspberrypi:~ $ testPATH=${testPATH}:/usr/local/sbin\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u5b57\u7b26\u4e32\u5305\u542b","title":"\u5b57\u7b26\u4e32\u5305\u542b","text":"<p>Shell\u5224\u65ad\u5b57\u7b26\u4e32\u5305\u542b\u5173\u7cfb\u7684\u51e0\u79cd\u65b9\u6cd5 Shell\u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u5305\u542b\u5c0f\u7ed3 shell\u5224\u65ad\u5b57\u7b26\u4e32\u5305\u542b\u5173\u7cfb </p>"},{"location":"blog/20191106/8-sh-string/#\u5229\u7528\u901a\u914d\u7b26","title":"\u5229\u7528\u901a\u914d\u7b26","text":"<p><code>[[ ]]</code>: \u5224\u65ad\u547d\u4ee4  </p> <pre><code>#!/bin/bash\n\nA=\"helloworld\"\nB=\"low\"\nif [[ $A == *$B* ]]\nthen\n    echo \"\u5305\u542b\"\nelse\n    echo \"\u4e0d\u5305\u542b\"\nfi\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u5229\u7528\u5b57\u7b26\u4e32\u8fd0\u7b97\u7b26","title":"\u5229\u7528\u5b57\u7b26\u4e32\u8fd0\u7b97\u7b26","text":"<p><code>=~</code>: \u6b63\u5219\u5f0f\u5339\u914d\u7b26\u53f7  </p> <pre><code>#!/bin/bash\n\nstrA=\"helloworld\"\nstrB=\"low\"\nif [[ $strA =~ $strB ]]\nthen\n    echo \"\u5305\u542b\"\nelse\n    echo \"\u4e0d\u5305\u542b\"\nfi\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u5229\u7528grep\u67e5\u627e","title":"\u5229\u7528grep\u67e5\u627e","text":"<pre><code>#!/bin/bash\n\nstrA=\"long string\"\nstrB=\"string\"\nresult=$(echo $strA | grep \"${strB}\")\n#if [[ \"$result\" != \"\" ]]\n#if [ \"$result\" != \"\" ]\n#if [ -n \"$result\" ]\nif [ $? -eq 0 ] &amp;&amp; [ -n \"$result\" ]\nthen\n    echo \"\u5305\u542b\"\nelse\n    echo \"\u4e0d\u5305\u542b\"\nfi\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u5229\u7528_case_in_\u8bed\u53e5","title":"\u5229\u7528 case in \u8bed\u53e5","text":"<pre><code>#!/bin/bash\n\nthisString=\"1 2 3 4 5\" # \u6e90\u5b57\u7b26\u4e32\nsearchString=\"1 2\" # \u641c\u7d22\u5b57\u7b26\u4e32\ncase $thisString in \n    *\"$searchString\"*) echo Enemy Spot ;;\n    *) echo nope ;;\nesac\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u8fd0\u7528\u66ff\u6362\u8fd0\u7b97","title":"\u8fd0\u7528\u66ff\u6362\u8fd0\u7b97","text":"<pre><code>#!/bin/bash\n\nSTRING_A=$1\nSTRING_B=$2\nif [[ ${STRING_A/${STRING_B}//} == $STRING_A ]]\nthen\n    ## is not substring.\n    echo N\n    return 0\nelse\n    ## is substring.\n    echo Y\n    return 1\nfi\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u5b57\u7b26\u4e32\u622a\u53d6","title":"\u5b57\u7b26\u4e32\u622a\u53d6","text":""},{"location":"blog/20191106/8-sh-string/#\u622a\u5de6\u7559\u53f3","title":"\u622a\u5de6\u7559\u53f3","text":"<p><code>#</code> \u548c <code>##</code> \u53f7\u622a\u65ad\u5de6\u8fb9\u7559\u53d6\u53f3\u8fb9\u5b50\u4e32\uff08\u975e\u8d2a\u5a6a\u6a21\u5f0f\uff0c\u8d2a\u5a6a\u6a21\u5f0f\uff09</p> <pre><code>$ man bash\n\n       ${parameter#word}\n       ${parameter##word}\n              The word is expanded to produce a pattern just as  in  pathname  expansion.   If  the  pattern\n              matches  the  beginning  of  the  value  of parameter, then the result of the expansion is the\n              expanded value of parameter with the shortest matching pattern (the ``#'' case) or the longest\n              matching pattern (the ``##'' case) deleted.  If parameter is @ or *, the pattern removal oper-\n              ation is applied to each positional parameter in turn, and  the  expansion  is  the  resultant\n              list.   If  parameter is an array variable subscripted with @ or *, the pattern removal opera-\n              tion is applied to each member of the array in turn, and the expansion is the resultant  list.\n</code></pre> \u8868\u8fbe\u5f0f \u542b\u4e49 <code>${string#substring}</code> \u4ece\u53d8\u91cf $string \u7684\u5f00\u5934, \u5220\u9664\u6700\u77ed\u5339\u914d $substring \u7684\u5b50\u4e32 <code>${string##substring}</code> \u4ece\u53d8\u91cf $string \u7684\u5f00\u5934, \u5220\u9664\u6700\u957f\u5339\u914d $substring \u7684\u5b50\u4e32 <p>\u5176\u4e2d substring \u53ef\u4ee5\u662f\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u3002</p> <pre><code>$ file_path=/Users/faner/Downloads/iosdeploy_download/Documents/2905558360/image_original_flash\n$ suffix=${file_path#*iosdeploy_download}\n$ echo $suffix\n/Documents/2905558360/image_original_flash\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u622a\u53f3\u7559\u5de6","title":"\u622a\u53f3\u7559\u5de6","text":"<p><code>%</code> \u548c <code>%%</code> \u53f7\u622a\u65ad\u53f3\u8fb9\u7559\u53d6\u5de6\u8fb9\u5b50\u4e32\uff08\u975e\u8d2a\u5a6a\u6a21\u5f0f\uff0c\u8d2a\u5a6a\u6a21\u5f0f\uff09</p> <pre><code>$ man bash\n\n       ${parameter%word}\n       ${parameter%%word}\n              The  word  is  expanded  to  produce  a pattern just as in pathname expansion.  If the pattern\n              matches a trailing portion of the expanded value of parameter, then the result of  the  expan-\n              sion is the expanded value of parameter with the shortest matching pattern (the ``%'' case) or\n              the longest matching pattern (the ``%%'' case) deleted.  If parameter is @ or *,  the  pattern\n              removal  operation  is  applied to each positional parameter in turn, and the expansion is the\n              resultant list.  If parameter is an array variable  subscripted  with  @  or  *,  the  pattern\n              removal  operation  is  applied  to each member of the array in turn, and the expansion is the\n              resultant list.\n</code></pre> \u8868\u8fbe\u5f0f \u542b\u4e49 <code>${string%substring}</code> \u4ece\u53d8\u91cf $string \u7684\u7ed3\u5c3e, \u5220\u9664\u6700\u77ed\u5339\u914d $substring\u7684\u5b50\u4e32 <code>${string%%substring}</code> \u4ece\u53d8\u91cf $string \u7684\u7ed3\u5c3e, \u5220\u9664\u6700\u957f\u5339\u914d $substring \u7684\u5b50\u4e32 <p>\u5176\u4e2d substring \u53ef\u4ee5\u662f\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u3002</p> <pre><code>$ file_path=/Users/faner/Downloads/iosdeploy_download/Documents/2905558360/image_original_flash\n$ prefix=${file_path%/Documents/*}\n$ echo $prefix\n/Users/faner/Downloads/iosdeploy_download\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#refs","title":"refs","text":"<p>bash shell\u5b57\u7b26\u4e32\u7684\u622a\u53d6 Shell\u5b57\u7b26\u4e32\u622a\u53d6 - \u975e\u5e38\u8be6\u7ec6 shell\u622a\u53d6\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5 </p> <p>Linux Shell \u622a\u53d6\u5b57\u7b26\u4e32 Shell\u811a\u672c8\u79cd\u5b57\u7b26\u4e32\u622a\u53d6\u65b9\u6cd5\u603b\u7ed3 shell\u811a\u672c\u67e5\u627e\u3001\u62bd\u53d6\u6307\u5b9a\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5 </p> <p>extract substring using regex in shell script How to extract a value from a string using regex and a shell? </p> <p>Extract word from string using grep/sed/awk How to extract string following a pattern with grep, regex or perl </p>"},{"location":"blog/20191106/8-sh-string/#\u5b57\u7b26\u4e32\u66ff\u6362","title":"\u5b57\u7b26\u4e32\u66ff\u6362","text":"<p>\u5b57\u7b26\u4e32\u64cd\u4f5c ${} \u7684\u622a\u53d6\uff0c\u5220\u9664\u548c\u66ff\u6362 Shell\u811a\u672c\u4e2d\u66ff\u6362\u5b57\u7b26\u4e32\u7b49\u64cd\u4f5c </p> <pre><code>$ man bash\n\n       ${parameter/pattern/string}\n              The pattern is expanded to produce a pattern just as  in  pathname  expansion.   Parameter  is\n              expanded and the longest match of pattern against its value is replaced with string.  If Ipat-\n              tern begins with /, all matches of pattern are replaced with string.  Normally only the  first\n              match  is  replaced.  If pattern begins with #, it must match at the beginning of the expanded\n              value of parameter.  If pattern begins with %, it must match at the end of the expanded  value\n              of  parameter.   If string is null, matches of pattern are deleted and the / following pattern\n              may be omitted.  If parameter is @ or *, the substitution operation is applied to  each  posi-\n              tional  parameter  in turn, and the expansion is the resultant list.  If parameter is an array\n              variable subscripted with @ or *, the substitution operation is applied to each member of  the\n              array in turn, and the expansion is the resultant list.\n</code></pre> expr note <code>${string/substring/replacement}</code> \u4f7f\u7528 $replacement, \u4ee3\u66ff\u7b2c\u4e00\u4e2a\u5339\u914d\u7684 $substring <code>${string//substring/replacement}</code> \u4f7f\u7528 $replacement, \u4ee3\u66ff\u6240\u6709\u5339\u914d\u7684 $substring <code>${string/#substring/replacement}</code> \u5982\u679c $string \u7684\u524d\u7f00\u5339\u914d $substring, \u90a3\u4e48\u5c31\u7528 $replacement \u6765\u4ee3\u66ff\u5339\u914d\u5230\u7684 $substring <code>${string/%substring/replacement}</code> \u5982\u679c $string \u7684\u540e\u7f00\u5339\u914d $substring, \u90a3\u4e48\u5c31\u7528 $replacement \u6765\u4ee3\u66ff\u5339\u914d\u5230\u7684 $substring"},{"location":"blog/20191106/8-sh-string/#\u666e\u901a\u66ff\u6362","title":"\u666e\u901a\u66ff\u6362","text":"<p><code>${string/match_string/replace_string}</code>: \u5c06 string \u4e2d\u7b2c\u4e00\u4e2a match_string \u66ff\u6362\u6210 replace_string\uff1b <code>${string//match_string/replace_string}</code>: \u5c06 string \u4e2d\u7684 match_string \u5168\u90e8\u66ff\u6362\u6210 replace_string\uff1b  </p> <pre><code>$ str=123abc123\n$ echo \"${str/123/r}\"\nrabc123\n$ echo \"${str//123/r}\"\nrabcr\n</code></pre> <p>\u5c06 <code>2905558360/FileRecv</code> \u4e2d\u7684 / \u66ff\u6362\u4e3a -\uff1b</p> <pre><code>&gt; str='2905558360/FileRecv'\n&gt; echo $str\n2905558360/FileRecv\n\n&gt; echo \"${str/\\//-}\"\n2905558360-FileRecv\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#\u524d\u540e\u7f00\u66ff\u6362","title":"\u524d\u540e\u7f00\u66ff\u6362","text":"<p><code>${string/#match_string/replace_string}</code>: \u5c06 string \u4e2d\u7b2c\u4e00\u4e2a match_string \u66ff\u6362\u6210 replace_string <code>${string/%match_string/replace_string}</code>: \u5c06 string \u4e2d\u6700\u540e\u4e00\u4e2a match_string \u66ff\u6362\u6210 replace_string  </p> <pre><code>$ str=123abc123\n$ echo \"${str/#123/r}\"\nrabc123\n$ echo \"${str/%123/r}\"\n123abcr\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#demo_1","title":"demo","text":"<p>doc_subdir \u5b57\u7b26\u4e32\u503c\u4e3a \"2015952713/FileRecv\" \u6216 \"/2015952713/FileRecv/\"\uff0c\u5982\u679c\u662f\u540e\u8005\u9700\u8981\u79fb\u9664\u9996\u5c3e\u7684 <code>/</code>\uff1a</p> <ol> <li>\u53bb\u6389\u5f00\u5934\u7684 <code>/</code> \u4e24\u79cd\u65b9\u6cd5\uff1a</li> </ol> <ul> <li>\u622a\u5de6\u7559\u53f3\uff1a<code>sub_dir=${sub_dir#/}</code>;  </li> <li>\u524d\u7f00\u66ff\u6362\u4e3a\u7a7a\uff1a<code>sub_dir=${sub_dir/#\\//}</code>;  </li> </ul> <ol> <li>\u53bb\u6389\u7ed3\u5c3e\u7684 <code>/</code> \u4e24\u79cd\u65b9\u6cd5\uff1a</li> </ol> <ul> <li>\u622a\u53f3\u7559\u5de6\uff1a<code>sub_dir=${sub_dir%/}</code>;  </li> <li>\u540e\u7f00\u66ff\u6362\u4e3a\u7a7a\uff1a<code>sub_dir=${sub_dir/%\\//}</code>;  </li> </ul> <pre><code>    sub_dir=$doc_subdir\n    if [ ${sub_dir:0:1} = \"/\" ]   # \u53bb\u6389\u5f00\u5934\u7684 /\n    then\n        sub_dir=${sub_dir#/} # sub_dir=${sub_dir/#\\//}\n    fi\n    if [ ${sub_dir:0-1:1} = \"/\" ] # \u53bb\u6389\u7ed3\u5c3e\u7684 /\n    then\n        sub_dir=${sub_dir%/} # sub_dir=${sub_dir/%\\//}\n    fi\n\n    sub_folder=\"/Documents/$sub_dir/\" # \u62fc\u63a5\u6c99\u76d2\u8def\u5f84\n</code></pre> <p>\u79fb\u9664\u9996\u5c3e\u7684 <code>/</code> \u540e\uff0c\u8981\u751f\u6210\u4e34\u65f6\u6587\u4ef6\u540d\uff0c\u4e2d\u95f4\u7684 <code>/</code> \u9700\u8981\u5168\u90e8\u66ff\u6362\u4e3a <code>-</code>\uff1a</p> <pre><code>    file_name=${sub_dir//\\//-} # \u66ff\u6362 / \u4e3a -\n    ls_out_file=\"./ios-deploy-list-Documents-$file_name.txt\"\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#trim_spaces","title":"trim spaces","text":"<p>\u5982\u4f55\u79fb\u9664\u5b57\u7b26\u4e32\u4e24\u4fa7\u7684\u7a7a\u683c\u5462\uff1f</p> <p>How to trim string in bash How to trim whitespace from a Bash variable? How do I trim leading and trailing whitespace from each line of some output? </p>"},{"location":"blog/20191106/8-sh-string/#\u5b57\u7b26\u4e32\u622a\u53d6_1","title":"\u5b57\u7b26\u4e32\u622a\u53d6","text":"<p>\u53ef\u4ee5\u57fa\u4e8ebash\u5185\u7f6e\u63d0\u4f9b\u7684\u53d8\u91cf\u66ff\u6362\u4e4b\u5b57\u7b26\u4e32\u622a\u53d6\uff0c\u6765\u5b9e\u73b0\u79fb\u9664\u5b57\u7b26\u4e32\u9996\u5c3e\u7a7a\u683c\u3002</p> <pre><code>trim()\n{\n    local trimmed=\"$1\"\n\n    # Strip leading spaces.\n    while [[ $trimmed == ' '* ]]; do\n       trimmed=\"${trimmed## }\"\n    done\n    # Strip trailing spaces.\n    while [[ $trimmed == *' ' ]]; do\n        trimmed=\"${trimmed%% }\"\n    done\n\n    echo \"$trimmed\"\n}\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#xargs","title":"xargs","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b xargs \u5c06\u5176\u6807\u51c6\u8f93\u5165\u4e2d\u7684\u5185\u5bb9\u4ee5\u7a7a\u767d(\u5305\u62ec\u7a7a\u683c\u3001tab\u3001\u56de\u8f66\u6362\u884c\u7b49)\u5206\u5272\u6210\u591a\u4e2a arguments \u4e4b\u540e\u5f53\u4f5c\u547d\u4ee4\u884c\u53c2\u6570\u4f20\u9012\u7ed9\u5176\u540e\u9762\u7684\u547d\u4ee4\u3002 \u57fa\u4e8e\u8fd9\u4e00\u539f\u7406\uff0c\u53ef\u4ee5\u91c7\u7528 <code>| xargs</code> \u79fb\u9664\u9996\u5c3e\u7a7a\u683c\u3002</p> <pre><code>echo \"  Bash Scripting Language   \" | xargs\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#sed","title":"sed","text":"<p>sed \u7684\u5f3a\u9879\u5c31\u6587\u672c\u884c\u66ff\u6362\u79fb\u9664\uff0c\u57fa\u4e8esed\u53ef\u5f88\u76f4\u89c2\u5730\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\u3002</p> <pre><code>echo \"  Bash Scripting Language   \" | sed 's/^[ \\t]*//g' | sed 's/[ \\t]*$//g'\necho \"  Bash Scripting Language   \" | sed -e 's/^[[:blank:]]*//' -e 's/[[:blank:]]*$//'\necho \"  Bash Scripting Language   \" | sed 's/^[[:blank:]]*//;s/[[:blank:]]*$//'\n</code></pre> <pre><code>function ltrim ()\n{\n    sed -E 's/^[[:space:]]+//'\n}\n\nfunction rtrim ()\n{\n    sed -E 's/[[:space:]]+$//'\n}\n\nfunction trim ()\n{\n    ltrim | rtrim\n}\n</code></pre>"},{"location":"blog/20191106/8-sh-string/#awk","title":"awk","text":"<p>\u53e6\u5916\uff0c\u57fa\u4e8e awk \u63d0\u4f9b\u7684 sub\uff08gsub\uff09\u66ff\u6362\u51fd\u6570\u4e5f\u53ef\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807\u3002</p> <pre><code>echo \"  Bash Scripting Language   \" | awk '{gsub(/^[ \\t]+/,\"\"); gsub(/[ \\t]+$/,\"\"); print $0 }'\necho \"  Bash Scripting Language   \" | awk '{gsub(/^[[:blank:]]+|[[:blank:]]+$/,\"\"); print $0 }'\necho \"  Bash Scripting Language   \" | awk '{gsub(/^[[:blank:]]+|[[:blank:]]+$/,\"\")}1'\n</code></pre> <p>\u53c2\u8003 awk trim \u51fd\u6570\u3002</p> <p>\u6ce8\u610f\u4ee5\u4e0b\u811a\u672c\u4f1a\u628a\u4e2d\u95f4\u7684\u7a7a\u683c\u538b\u7f29\uff1a</p> <pre><code>echo \"  Bash   Scripting  Language   \" | awk '{$1=$1};1'\n</code></pre> <p>when you assign something to one of the fields, awk rebuilds the whole record (as printed by print) by joining all fields (<code>$1</code>, ..., <code>$NF</code>) with <code>OFS</code> (space by default).</p>"},{"location":"blog/20191106/9-sh-array/","title":"Linux Shell Program - array","text":"<p>Linux \u4e0b\u7684 Shell \u7f16\u7a0b\u4e4b\u6570\u7ec4\u5e38\u7528\u64cd\u4f5c\u3002</p> <p>Arrays in unix shell? Working with Arrays in Linux Shell Scripting \u2013 Part 8 </p>"},{"location":"blog/20191106/9-sh-array/#\u6570\u7ec4\u7684\u5b9a\u4e49","title":"\u6570\u7ec4\u7684\u5b9a\u4e49","text":"<p>\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4 <code>array</code>\uff1a</p> <pre><code>$ array=()\n$ array=(\"A\" \"B\" \"ElementC\" \"ElementE\")\n</code></pre> <p>\u6574\u4f53\u6253\u5370\u6570\u7ec4\u5185\u5bb9\uff1a</p> <pre><code>$ echo $array\nA B ElementC ElementE\n$ echo ${array[@]}\n$ echo ${array[*]}\n</code></pre>"},{"location":"blog/20191106/9-sh-array/#\u6570\u7ec4\u957f\u5ea6","title":"\u6570\u7ec4\u957f\u5ea6","text":"<p>\u7528 <code>${#\u6570\u7ec4\u540d[@\u6216*]}</code> \u53ef\u4ee5\u5f97\u5230\u6570\u7ec4\u957f\u5ea6\u3002</p> <pre><code>$ echo ${#array[@]}\n$ echo ${#array[*]}\n4\n</code></pre>"},{"location":"blog/20191106/9-sh-array/#\u8bbf\u95ee\u6570\u7ec4\u5143\u7d20","title":"\u8bbf\u95ee\u6570\u7ec4\u5143\u7d20","text":"<p>\u6309\u7d22\u5f15\u83b7\u53d6\u6570\u7ec4\u5143\u7d20\uff1a</p> <p>\u5b9e\u9645\u7d22\u5f15\u4ece1\u5f00\u59cb\u3002</p> <pre><code>$ echo ${array[0]}\n\n$ echo ${array[1]}\nA\n$ echo ${array[2]}\nB\n$ echo ${array[3]}\nElementC\n$ echo ${array[4]}\nElementE\n</code></pre> <p>\u5faa\u73af\u904d\u5386\u6570\u7ec4\u5143\u7d20\uff1a</p> <pre><code>for element in \"${array[@]}\"\ndo\n    echo \"$element\"\ndone\n</code></pre> <p>\u904d\u5386\u7ed3\u679c\u8f93\u51fa\uff1a</p> <pre><code>A\nB\nElementC\nElementE\n</code></pre> <p>C \u8bed\u8a00\u5199\u6cd5\uff1a</p> <pre><code>b=0\nwhile [ $b -lt $c ]\ndo\n  echo ${filelist[$b]}\n  ((b++))\ndone\n</code></pre>"},{"location":"blog/20191106/9-sh-array/#\u6570\u7ec4\u7d22\u5f15\u533a\u95f4\u5207\u7247","title":"\u6570\u7ec4\u7d22\u5f15\u533a\u95f4\u5207\u7247","text":"<p><code>${array[@]}</code> \u4ee3\u8868\u6574\u4e2a\u6570\u7ec4\uff0c\u5219\u5207\u7247\u5199\u6cd5\u5982\u4e0b\uff1a</p> <ul> <li><code>${array[@]:0:2}</code> \u8868\u793a\u6570\u7ec4\u4ece0\uff08\u7d22\u5f15\u4e3a0+1\uff09\u5f00\u59cb\u76842\u4e2a\u5143\u7d20\uff0c\u5373 <code>${array[1]}</code>\u3001<code>${array[2]}</code>\uff1b  </li> <li><code>${array[@]:2:3}</code> \u8868\u793a\u6570\u7ec4\u4ece2\uff08\u7d22\u5f15\u4e3a2+1\uff09\u5f00\u59cb\u76843\u4e2a\u5143\u7d20\uff1b  </li> <li><code>${array[@]:2}</code> \u8868\u793a\u6570\u7ec4\u4ece2\uff08\u7d22\u5f15\u4e3a2+1\uff09\u5f00\u59cb\uff0c\u76f4\u5230\u7ed3\u5c3e\uff1b  </li> </ul> <pre><code>array=(\"A\" \"B\" \"C\" \"D\" \"E\")\n$ echo ${array[@]:0:2}\nA B\n$ echo ${array[@]:2:3}\nC D E\n$ echo ${array[@]:2}\nC D E\n</code></pre>"},{"location":"blog/20191106/9-sh-array/#c\u98ce\u683c\u6309\u7167\u7d22\u5f15\u5199\u5165","title":"C\u98ce\u683c\u6309\u7167\u7d22\u5f15\u5199\u5165","text":"<p>\u8fdb\u5165\u67d0\u4e2a\u76ee\u5f55\u5c06\u76ee\u5f55\u4e0b\u9762\u7684\u6587\u4ef6\u540d\u5b58\u5165\u6570\u7ec4 </p> <pre><code>cd $yourpathname\nj=0\nfor i in `ls -1`\ndo\n    folder_list[j]=$i\n    j=`expr $j + 1`\ndone\n</code></pre> <p>\u5728shell\u4e2d\u628als\u7684\u8f93\u51fa\u5b58\u8fdb\u4e00\u4e2a\u6570\u7ec4\u53d8\u91cf\u4e2d </p> <pre><code>c=0\nfor file in `ls`\ndo\n  filelist[$c]=$file\n  ((c++))\ndone\n</code></pre> <p>\u6216\u8005\uff1a</p> <pre><code>c=0\nfor file in *\ndo\n  filelist[$c]=\"$file\" # \u4e3a\u4e86\u51c6\u786e\u8d77\u89c1\uff0c\u6b64\u5904\u8981\u52a0\u4e0a\u53cc\u5f15\u53f7\n  ((c++))\ndone\n</code></pre> <p>\u6216\u8005\uff1a</p> <pre><code>set -a myfiles\nindex=0\nfor f in `ls`; do myfiles[index]=$f; let index=index+1; done\n</code></pre> <p>\u6ce8\u610f\uff1a\u7528\u8fd9\u79cd\u65b9\u6cd5\uff0c\u5982\u679c\u6587\u4ef6\u540d\u4e2d\u6709\u7a7a\u683c\u7684\u8bdd\uff0c\u4f1a\u5c06\u4e00\u4e2a\u6587\u4ef6\u540d\u4ee5\u7a7a\u683c\u4e3a\u5206\u9694\u7b26\u5206\u6210\u591a\u4e2a\u5b58\u5230\u6570\u7ec4\u4e2d\uff0c\u6700\u540e\u51fa\u6765\u7684\u7ed3\u679c\u5c31\u662f\u9519\u8bef\u7684\u3002</p> <p>\u628afilelist\u6570\u7ec4\u5185\u5bb9\u8f93\u51fa\u5230\u5c4f\u5e55\u4e0a\uff1a</p> <pre><code>b=0\nwhile [ $b -lt $c ]\ndo\n  echo ${filelist[$b]}\n  ((b++))\ndone\n</code></pre> <p>\u6216\u8005</p> <pre><code>b=0\nfor value in ${filelist[*]}\ndo\n  echo $value\ndone\n</code></pre> <p>\u7528 <code>${#\u6570\u7ec4\u540d[@\u6216*]}</code> \u53ef\u4ee5\u5f97\u5230\u6570\u7ec4\u957f\u5ea6\u3002</p> <p>\u5728\u5c4f\u5e55\u4e0a\u8f93\u51fafilelist\u6570\u7ec4\u957f\u5ea6\uff1a</p> <pre><code>echo ${#filelist[*]}\n</code></pre>"},{"location":"blog/20191106/9-sh-array/#mutable_access","title":"Mutable Access","text":"<p>How to add/remove an element to/from the array in bash?</p> <p>Mutable list or array structure in Bash? How can I easily append to it? </p>"},{"location":"blog/20191106/9-sh-array/#add_an_element_at_headtail","title":"add an element at head/tail","text":"<p>To add an element to the beginning of an array use.</p> <pre><code>arr=(\"new_element\" \"${arr[@]}\")\n</code></pre> <p>Generally, you would do.</p> <pre><code>arr=(\"new_element1\" \"new_element2\" \"...\" \"new_elementN\" \"${arr[@]}\")\n</code></pre> <p>To add an element to the end of an array use.</p> <pre><code>arr=( \"${arr[@]}\" \"new_element\" )\n</code></pre> <p>Or instead</p> <pre><code>arr+=( \"new_element\" )\n</code></pre> <p>Generally, you would do.</p> <pre><code>arr=( \"${arr[@]}\" \"new_element1\" \"new_element2\" \"...\" \"new_elementN\")\n# Or\narr+=( \"new_element1\" \"new_element2\" \"...\" \"new_elementN\" )\n</code></pre>"},{"location":"blog/20191106/9-sh-array/#add_an_element_to_specific_index","title":"add an element to specific index","text":"<p>To add an element to specific index of an array use.</p> <p>Let's say we want to add an element to the position of Index2 <code>arr[2]</code>, we would actually do merge on below sub-arrays:</p> <ol> <li>Get all elements before Index position2 arr[0] and arr[1];  </li> <li>Add an element to the array;  </li> <li>Get all elements with Index position2 to the last arr[2], arr[3], ....  </li> </ol> <pre><code>arr=( \"${arr[@]:0:2}\" \"new_element\" \"${arr[@]:2}\" )\n</code></pre>"},{"location":"blog/20191106/9-sh-array/#removing_an_element_from_the_array","title":"removing an element from the array","text":"<p>In addition to removing an element from an array (let's say element <code>#2</code>), we need to concatenate two sub-arrays.  The first sub-array will hold the elements before element <code>#2</code> and the second sub-array will contain the elements after element <code>#2</code>.</p> <pre><code>arr=( \"${arr[@]:0:2}\" \"${arr[@]:3}\" )\n</code></pre> <p><code>${arr[@]:0:2}</code> will get two elements <code>arr[0]</code> and <code>arr[1]</code> starts from the beginning of the array. <code>${arr[@]:3}</code> will get all elements from index3 arr[3] to the last.  </p> <p>Another possibility to remove an element is Using <code>unset</code> (actually assign 'null' value to the element)</p> <pre><code>unset arr[2]\n</code></pre> <p>Use replace pattern if you know the value of your elements.</p> <pre><code>arr=( \"${arr[@]/PATTERN/}\" )\n</code></pre>"},{"location":"blog/20191106/9-sh-array/#text_to_line_array","title":"text to line array","text":"<p>\u5728\u6267\u884c find\u3001grep \u7b49\u547d\u4ee4\u65f6\uff0c\u6bcf\u4e00\u6761\u7ed3\u679c\u5f80\u5f80\u5bf9\u5e94\u4e00\u884c\u6587\u672c\uff0c\u53ef\u5c06\u6587\u672c\u884c\u7ba1\u9053\u4f20\u8f93\u7ed9 xargs \u7b49\u8fdb\u884c\u540e\u7eed\u5904\u7406\u3002</p> <p>\u5982\u679c\u5f53\u524dShell\u73af\u5883\u6ca1\u6709\u5b89\u88c5 sed\u3001awk \u7b49\u884c\u7f16\u8f91\u5668\uff0c\u53ef\u4ee5\u5c06\u6587\u672c\u6587\u4ef6\u8f6c\u6362\u4e3a\u6587\u672c\u884c\u6570\u7ec4\uff0c\u7136\u540e\u904d\u5386\u6570\u7ec4\u8fdb\u884c\u9010\u884c\u5904\u7406\u3002</p> <pre><code>array=($(cat issue-file-list.txt)) # array=($(awk 1 issue-file-list.txt))\necho ${#array[*]}\n\nfor file in ${array[@]}; do\n    clang-format --verbose -style=file -i $file\ndone\n</code></pre> <p>\u5f53\u7136\uff0c\u901a\u8fc7\u884c\u7f16\u8f91\u5668 sed\u3001awk \u6765\u9010\u884c\u8f93\u51fa\uff0c\u8fdb\u800c\u6267\u884c\u8fdb\u4e00\u6b65\u64cd\u4f5c\u3002</p> <p><code>sed -n '1,$p' issue-file-list.txt | xargs clang-format --verbose -style=file -i</code> <code>awk 1 issue-file-list.txt | xargs clang-format --verbose -style=file -i</code></p>"},{"location":"blog/20191104/sed%26awk/","title":"Linux sed & awk","text":"<p>Linux \u4e0b\u7684 sed &amp; awk \u547d\u4ee4\u6982\u8ff0\u3002</p>","tags":["sed","awk"]},{"location":"blog/20191104/sed%26awk/#summary","title":"summary","text":"<p>\u4ecegrep\u5230sed\u548cawk\u7684\u5b66\u4e60\u8fc7\u7a0b\u662f\u5f88\u81ea\u7136\u7684\u3002 sed\u548cawk\u662f\u4e00\u822c\u7528\u6237\u3001\u7a0b\u5e8f\u5458\u548c\u7cfb\u7edf\u7ba1\u7406\u5458\u4eec\u5904\u7406\u6587\u672c\u6587\u4ef6\u7684\u6709\u529b\u5de5\u5177\u3002 sed\u7684\u540d\u5b57\u6765\u6e90\u4e8e\u5176\u529f\u80fd\uff0c\u5b83\u662f\u4e2a\u5b57\u7b26\u6d41\u7f16\u8f91\u5668\uff08stream editor\uff09\uff0c\u53ef\u4ee5\u5f88\u597d\u5730\u5b8c\u6210\u5bf9\u591a\u4e2a\u6587\u4ef6\u7684\u4e00\u7cfb\u5217\u7f16\u8f91\u5de5\u4f5c\u3002 awk\u7684\u540d\u5b57\u6765\u6e90\u4e8e\u5b83\u7684\u5f00\u53d1\u4ebaAho\u3001Weinberger\u548cKernighan\uff0c\u5b83\u662f\u4e00\u79cd\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\uff0c\u975e\u5e38\u9002\u5408\u7ed3\u6784\u5316\u6570\u636e\u7684\u5904\u7406\u548c\u683c\u5f0f\u5316\u62a5\u8868\u7684\u751f\u6210\u3002  </p>","tags":["sed","awk"]},{"location":"blog/20191104/sed%26awk/#generality","title":"generality","text":"<p>awk \u7684\u8d77\u6e90\u53ef\u4ee5\u8ffd\u6eaf\u5230 sed \u548c grep\uff0c\u5e76\u4e14\u7ecf\u7531\u8fd9\u4e24\u4e2a\u7a0b\u5e8f\u8ffd\u6eaf\u5230ed\uff08\u6700\u521d\u7684unix\u884c\u7f16\u8f91\u5668\uff09\u3002 \u5982\u679c\u4f60\u4f7f\u7528\u8fc7vi\uff0c\u90a3\u4e48\u4f60\u4e00\u5b9a\u719f\u6089\u5176\u5e95\u5c42\u7684\u884c\u7f16\u8f91\u5668ex\uff08\u5b83\u4f9d\u7136\u662fed\u4e2d\u7279\u5f81\u7684\u6269\u5c55\u96c6\uff09\u3002</p> <p>sed \u548c awk \u63a7\u5236\u6307\u4ee4\u4e0d\u540c\uff0c\u4f46\u6709\u7740\u76f8\u4f3c\u7684\u8bed\u6cd5\uff0c\u6709\u5982\u4e0b\u5171\u6027\uff1a</p> <ol> <li>\u9762\u5411\u5b57\u7b26\u6d41\uff0c\u9010\u884c\u8bfb\u53d6\u8f93\u5165\u3002  </li> <li>\u5141\u8bb8\u7528\u6237\u5728\u811a\u672c\u4e2d\u6307\u5b9a\u6307\u4ee4\u3002  </li> <li>\u652f\u6301\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\u6a21\u5f0f\u5339\u914d\u3002  </li> </ol>","tags":["sed","awk"]},{"location":"blog/20191104/sed%26awk/#refs","title":"refs","text":"<p>Linux\u4e09\u5927\u5229\u5668grep\uff0csed\uff0cawk Linux\u6587\u672c\u5904\u7406\uff08Linux\u4e09\u5251\u5ba2grep\u3001sed\u548cawk\uff09\u8be6\u89e3 </p> <p>Unix Shell Programming grep,sed,awk </p> <p>sed &amp; awk Sed and Awk 101 Hacks - ebook </p>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/","title":"Linux Command - sed & awk demos","text":"<p>Linux \u4e0b\u7684 sed &amp; awk \u547d\u4ee4\u7efc\u5408\u8fd0\u7528\u793a\u4f8b\u3002</p> <p>sed &amp; awk Sed and Awk 101 Hacks - ebook </p>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#networksetup","title":"networksetup","text":"<p>MacBook/macOS \u4e0b\u6267\u884c <code>networksetup -listallhardwareports</code> \u5217\u4e3e\u8f93\u51fa\u7684 hardwareports\uff1a</p> <pre><code>$ networksetup -listallhardwareports\n\nHardware Port: Wi-Fi\nDevice: en0\nEthernet Address: 61:e8:2d:ed:34:5e\n\nHardware Port: Bluetooth PAN\nDevice: en3\nEthernet Address: 61:e8:2d:ed:34:5f\n</code></pre> <p>MacBook/macOS \u4e0b\u6267\u884c <code>networksetup -listallhardwareports</code> \u5217\u4e3e\u8f93\u51fa\u7684 networkservice\uff1a</p> <pre><code>$ networksetup -listnetworkserviceorder\nAn asterisk (*) denotes that a network service is disabled.\n(1) Wi-Fi\n(Hardware Port: Wi-Fi, Device: en0)\n\n(2) Bluetooth PAN\n(Hardware Port: Bluetooth PAN, Device: en3)\n\n(3) Thunderbolt Bridge\n(Hardware Port: Thunderbolt Bridge, Device: bridge0)\n</code></pre> <p>\u5982\u679c\u662f iMac\uff0c\u6709\u7ebf\u7f51\u53e3\u5f80\u5f80\u662f en0\uff0c\u65e0\u7ebf\u7f51\u53e3\u662f en1\u3002</p> <p>\u5982\u4f55\u63d0\u53d6\u6709\u7ebf\u7f51\u53e3\uff08Ethernet\uff09\u548c\u65e0\u7ebf\u7f51\u5361\uff08Wi-Fi\uff09\u7684\u63a5\u53e3\u540d\u79f0\u5462\uff1f</p> <p>\u57fa\u672c\u601d\u8def\uff1a</p> <ol> <li>networksetup -listallhardwareports\uff1a\u5b9a\u4f4d\u5230 <code>Hardware Port: Wi-Fi</code> \u6240\u5728\u884c\uff0c\u518d\u5bf9\u4e0b\u4e00\u884c\u63d0\u53d6\u7b2c\u4e8c\u4e2a\u57df\u3002  </li> <li>networksetup -listnetworkserviceorder\uff1a\u5b9a\u4f4d\u5230 <code>Hardware Port: Wi-Fi</code> \u6240\u5728\u884c\uff0c\u63d0\u53d6 Device: \u540e\u9762\u7684\u8bbe\u5907\u540d\u3002  </li> </ol> <p>\u4ee5\u4e0b\u4ee5\u83b7\u53d6 wlan \u63a5\u53e3\u4e3a\u4f8b\uff0c\u5982\u679c\u8981\u83b7\u53d6 eth \u63a5\u53e3\uff0c\u8bf7\u5c06 <code>Wi-Fi</code> \u66ff\u6362\u4e3a <code>Ethernet</code> \u5373\u53ef\u3002</p>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#dev","title":"dev","text":"","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#sed","title":"sed","text":"<p>\u53ef\u4ee5\u57fa\u4e8e sed \u5b9e\u73b0\uff1a</p> <pre><code>$ networksetup -listallhardwareports | sed -n '/Hardware Port: Wi-Fi/{n;p\npipe quote&gt; }' | sed -n 's/^.*: //p' # sed 's/Device: //'\nen0\n# \u5148\u5b9a\u4f4d Hardware Port: Wi-Fi \u8fd9\u4e00\u884c\uff0c\u518d\u7ba1\u4f20 sed \u63d0\u53d6 Device \u540e\u7684\u8bbe\u5907\u540d\n$ networksetup -listnetworkserviceorder | sed -n '/Hardware Port: Wi-Fi/p' | sed 's/.*Device: \\(.*\\))/\\1/'\nen0\n</code></pre> <p>sed \u8fdb\u884c\u66ff\u6362\u5220\u51cf\u65f6\uff0c\u66ff\u6362\u7684\u90e8\u5206\u5c3d\u91cf\u5c11\u7528 <code>Device:</code> \u8fd9\u6837\u7684\u5177\u4f53\u6587\u672c\uff0c\u591a\u7528 <code>^.*:</code> \u8fd9\u79cd\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\u6a21\u5f0f\u5339\u914d\u3002</p>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#awk","title":"awk","text":"<pre><code>$ networksetup -listallhardwareports | awk '/Hardware Port: Wi-Fi/{getline; print $2}'\nen0\n# \u57fa\u4e8e sub \u628a\u6536\u5c3e\u7684\u62ec\u53f7\u53bb\u6389\uff0c\u53bb\u6700\u540e\u4e00\u4e2a\u57df\n$ networksetup -listnetworkserviceorder | awk '/Hardware Port: Wi-Fi/{sub(/\\(/, \"\"); sub(/\\)/, \"\"); print $NF}'\n# \u5148\u5b9a\u4f4d Hardware Port: Wi-Fi \u8fd9\u4e00\u884c\uff0c\u4ee5(,)\u5207\u5272\uff0c\u53d6\u7b2c\u4e09\u4e2a\u57df\uff0c\u518d\u53d6\u5192\u53f7\u7a7a\u683c\u540e\u7684\u8bbe\u5907\u540d\n$ networksetup -listnetworkserviceorder | awk -F '[(,)]' '/Hardware Port: Wi-Fi/{print $(NF-1)}' | awk '{print $NF}'\nen0\n# \u53d6\u5de7\u4e00\u4e0b\uff1a\u4ee5(\u7a7a\u683c)\u5207\u5272\uff0c\u76f4\u63a5\u53d6\u7b2c\u516d\u4e2a\u57df\n$ networksetup -listnetworkserviceorder | awk -F '[( )]' '/Hardware Port: Wi-Fi/{print $(NF-1)}'\n</code></pre> <p>\u5bf9\u4e8e\u56fa\u5b9a\u683c\u5f0f\u7684\u5b57\u6bb5\u5206\u5272\u57df\u503c\u63d0\u53d6\uff0c\u8fd8\u662f awk \u7a0d\u663e\u7b80\u6d01\u3002</p>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#ssid","title":"SSID","text":"<p>\u53ef\u5bf9\u65e0\u7ebf\u7f51\u53e3\u7ee7\u7eed\u8c03\u7528 <code>networksetup -getairportnetwork en0</code> \u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684 Wi-Fi \u7f51\u7edc\uff1a</p> <pre><code>$ networksetup -listallhardwareports | awk '/Wi-Fi/{getline; print $2}' | xargs networksetup -getairportnetwork\nCurrent Wi-Fi Network: HiWiFi-5\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#sed_1","title":"sed","text":"<p>\u4ee5\u4e0a\u7ed3\u679c\u91cd\u5b9a\u5411\u7ed9 sed\uff0c\u66ff\u6362\u5220\u9664\u6389\u5192\u53f7\u524d\u9762\u7684\u90e8\u5206\u5373\u53ef\u63d0\u53d6 SSID\uff1a</p> <pre><code>$ | sed -n 's/^.*: //p'\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#awk_1","title":"awk","text":"<p>\u4ee5\u4e0a\u7ed3\u679c\u91cd\u5b9a\u5411\u7ed9 awk\uff0c\u53ef\u63d0\u53d6 SSID\uff1a</p> <pre><code># \u57fa\u4e8e\u9ed8\u8ba4\u7684\u7a7a\u683c\u5206\u5272\n$ | awk '{print $NF}' # $4\n# \u57fa\u4e8e `: ` \u5206\u5272\n$ | awk -F \": \" '{print $NF}' # $2\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#airport","title":"airport","text":"<p>\u4ee5\u4e0b\u4e3a <code>airport -I</code> \u8f93\u51fa\u7684\u65e0\u7ebf\u7f51\u7edc\u4fe1\u606f\uff1a</p> <pre><code>$ airport -I\n     agrCtlRSSI: -35\n     agrExtRSSI: 0\n    agrCtlNoise: -92\n    agrExtNoise: 0\n          state: running\n        op mode: station\n     lastTxRate: 867\n        maxRate: 1300\nlastAssocStatus: 0\n    802.11 auth: open\n      link auth: wpa2-psk\n          BSSID: 94:d9:b4:fe:d4:57\n           SSID: HiWiFi-5\n            MCS: 9\n        channel: 157,80\n</code></pre> <p>\u5047\u5982\u60f3\u63d0\u53d6\u5404\u4e2a\u5b57\u6bb5\u7684\u503c\uff0c\u6309\u7167\u9ed8\u8ba4\u7684FS\u5206\u5272\uff0c<code>op mode</code>\u3001<code>802.11 auth</code>\u3001<code>link auth</code> \u8fd9\u4e9b\u5c06\u5931\u6548\u3002 \u9700\u8981\u6309\u7167 <code>:</code> \u4f5c\u4e3a FS \u5206\u5272\u3002</p> <pre><code>$ airport -I | awk -F ': ' '{print $1}'\n     agrCtlRSSI\n     agrExtRSSI\n    agrCtlNoise\n    agrExtNoise\n          state\n        op mode\n     lastTxRate\n        maxRate\nlastAssocStatus\n    802.11 auth\n      link auth\n          BSSID\n           SSID\n            MCS\n        channel\n\n$ airport -I | awk -F ': ' '{print $2}'\n-35\n0\n-92\n0\nrunning\nstation\n867\n1300\n0\nopen\nwpa2-psk\n94:d9:b4:fe:d4:57\nHiWiFi-5\n9\n157,80\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#field_1","title":"field 1","text":"<p>\u601d\u8003\uff1a\u5982\u4f55\u53bb\u6389 <code>$1</code> \u7684\u524d\u7f00\u7a7a\u683c\u6216\u5236\u8868\u7b26\u5462\uff1f</p> <p>\u601d\u8def1\uff1a</p> <p>\u57fa\u4e8e sed \u9996\u5c3e\u6b63\u5219\u66ff\u6362\uff1a</p> <pre><code>$ airport -I | awk -F ': ' '{print $1}' | sed 's/^[ \\t]*//;s/[ \\t]*$//'\n</code></pre> <p>\u601d\u8def2\uff1a</p> <p>\u57fa\u4e8e awk \u7684 sub \u51fd\u6570\u8fdb\u884c\u66ff\u6362\uff1a</p> <pre><code>$ airport -I | awk -F ': ' '{sub(/^[ \\t\\r\\n]+/, \"\", $1); sub(/[ \\t\\r\\n]+$/, \"\", $1); print $1}'\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#ssid_1","title":"SSID","text":"<p>\u8fdb\u4e00\u6b65\u601d\u8003\uff0c\u5982\u4f55\u63d0\u53d6\u6307\u5b9a\u57df SSID \u7684\u503c\uff0c\u5373\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684 Wi-Fi \u540d\u79f0\u5462\uff1f</p> <p>\u57fa\u672c\u601d\u8def\uff1a\u8fc7\u6ee4\u51fa SSID \u90a3\u4e00\u884c\uff0c\u518d\u63d0\u53d6\u7b2c\u4e8c\u4e2a\u57df\u3002</p>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#sed_2","title":"sed","text":"<pre><code># \u79fb\u9664\u5f00\u5934\u7a7a\u683c\u53ca SSID: \n$ airport -I | sed -n 's/^ *SSID: //p'\nHiWiFi-5\n\n$ airport -I | sed -e \"s/^ *SSID: //p\" -e d\nHiWiFi-5\n</code></pre> <p>\u6ce8\u610f <code>sed -n 's/^.*SSID: //p'</code> \u5c06\u4f1a\u63d0\u53d6 SSID \u548c BSSID\u3002</p> <ul> <li><code>sed -n 's/^ *SSID: //p'</code> \u5c06\u4f1a\u5339\u914d SSID\uff1b  </li> <li><code>sed -n 's/^ *BSSID: //p'</code> \u5c06\u4f1a\u5339\u914d BSSID\uff1b  </li> </ul>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#awk_2","title":"awk","text":"<pre><code>$ airport -I | grep ' SSID' | awk '{print $2}'\nHiWiFi-5\n</code></pre> <p>\u53ef\u7701\u6389 grep\uff0c\u8fdb\u4e00\u6b65\u7b80\u5199\u4e3a\u57fa\u4e8e awk \u8fdb\u884c\u6a21\u5f0f\u5339\u914d\u8fc7\u6ee4\u7684\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>$ airport -I | awk '/ SSID/{print $2}'\nHiWiFi-5\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#system_profiler","title":"system_profiler","text":"<p>\u5728 macOS \u4e0b\uff0c\u9664\u4e86\u57fa\u4e8e networksetup \u548c airport \u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u57fa\u4e8e system_profiler \u6765\u83b7\u53d6\u5f53\u524d\u8fde\u63a5\u7684\u7f51\u7edc\u540d\u79f0\uff1a</p> <pre><code>$ system_profiler SPAirPortDataType | grep 'Current Network Information:' -A 2\n          Current Network Information:\n            HiWiFi-5:\n              PHY Mode: 802.11ac\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#sed_3","title":"sed","text":"<p>\u57fa\u4e8e sed \u67e5\u627e\u5230 <code>Current Network Information:</code> \u7684\u4e0b\u4e00\u884c\uff0c\u518d\u8fdb\u884c\u6390\u5934\u53bb\u5c3e\uff1a</p> <pre><code>$ system_profiler SPAirPortDataType | sed -n '/Current Network Information:/{n;p\n}' | sed -n 's/^ *//p' | sed -n 's/:$//p'\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#awk_3","title":"awk","text":"<p>\u57fa\u4e8e awk \u7684 sub \u51fd\u6570\u8fdb\u884c\u66ff\u6362\uff1b</p> <pre><code>$ system_profiler SPAirPortDataType | awk '/Current Network Information:/{getline; sub(/:/,\"\",$1); print $1}'\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#ifconfig","title":"ifconfig","text":"<p>\u57fa\u4e8e networksetup \u83b7\u53d6\u65e0\u7ebf\u7f51\u53e3\u540d\u79f0\uff0c\u518d\u8c03\u7528 ifconfig \u83b7\u53d6\u7f51\u7edc\u5730\u5740\u7b49\u4fe1\u606f\uff08\u53ef\u901a\u8fc7\u91cd\u5b9a\u5411 xargs \u4f20\u53c2\uff09\u3002</p> <p>\u57fa\u672c\u601d\u8def\uff1a\u627e\u5230\u5bf9\u5e94\u7f51\u53e3 <code>en0</code>\uff0c\u63d0\u53d6\u7b2c\u4e8c\u4e2a\u57df\u503c\u3002</p>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#sed_4","title":"sed","text":"<p>\u57fa\u4e8e sed \u6390\u5934\u53bb\u5c3e\uff0c\u53ef\u63d0\u53d6 IP \u5730\u5740\u4fe1\u606f\uff1a</p> <pre><code>$ ifconfig en0 | grep 'inet ' | sed 's/^.*inet //' | sed 's/ netmask.*//'\n$ ifconfig en0 | sed -n '/inet /p' | sed 's/^.*inet //' | sed 's/ netmask.*//'\n192.168.0.107\n</code></pre> <p><code>grep 'inet '</code> \u4e5f\u53ef\u7528 <code>sed -n '/inet /p'</code> \u66ff\u4ee3\u3002</p>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#awk_4","title":"awk","text":"<p>\u7528 awk \u63d0\u53d6\u66f4\u52a0\u7b80\u6d01\uff1a</p> <pre><code>ifconfig en0 | awk '/inet /{print $2}'\n192.168.0.107\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#\u7efc\u5408\u793a\u4f8b","title":"\u7efc\u5408\u793a\u4f8b","text":"<p>\u811a\u672c get_lan_ip.sh \u5c06\u4ee5\u4e0a\u4e32\u8054\u8d77\u6765\uff0c\u5148\u83b7\u53d6\u7f51\u53e3\u8bbe\u5907\u540d\uff0c\u518d\u5224\u65ad\u7f51\u53e3\u72b6\u6001\uff0c\u6700\u540e\u83b7\u53d6\u7f51\u7edcIP\u5730\u5740\u3002</p> get_lan_ip.sh <pre><code>#!/bin/bash\n\n# shellcheck disable=2034\n\n# \u83b7\u53d6 macOS \u672c\u673a\u7f51\u53e3\u7684\u5c40\u57df\u7f51\u5730\u5740\uff08LAN IP\uff09\n# \u652f\u6301 Ethernet\u3001Wi-Fi\uff0c\u6682\u672a\u652f\u6301 Thunderbolt Bridge\n## output: lan_ip\nget_lan_ip() {\n    # \u7b80\u5355\u6b63\u5219\u5339\u914d\u4e00\u4e0bIP\u5730\u5740\uff0c\u65e0\u6cd5\u5224\u9519 192.168 \u8fd9\u79cd\u534a\u622a\u5730\u5740\uff0c\n    # \u5305\u542b\u4e86 [ -z \"$lan_ip\" ] \u672a\u5b9a\u4e49\u6216\u4e3a\u7a7a\u7b49\u60c5\u51b5\u3002\n    if ! [[ $lan_ip =~ ^[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+$ ]]; then\n        # \u83b7\u53d6\u6709\u7ebf\u7f51\u5361\u63a5\u53e3\u540d\u79f0\n        local has_eth=false\n        if networksetup -listallnetworkservices | grep -q 'Ethernet'; then\n            has_eth=true\n        fi\n        local eth_dev=''\n        local eth_status='inactive'\n        local eth_inet=''\n        if [ $has_eth = true ]; then\n            eth_dev=$(networksetup -listallhardwareports | awk '/Hardware Port: Ethernet/{getline; print $NF}')\n            if [ -n \"$eth_dev\" ]; then\n                eth_status=$(ifconfig \"$eth_dev\" | awk '/status:/{print $NF}')\n                if [ \"$eth_status\" = active ]; then\n                    eth_inet=$(ifconfig \"$eth_dev\" | awk '/inet /{print $2}')\n                    echo \"Ethernet $eth_dev : status=$eth_status, inet=$eth_inet\"\n                else\n                    echo \"Ethernet $eth_dev : status=$eth_status\"\n                fi\n            fi\n        fi\n        # \u83b7\u53d6\u65e0\u7ebf\u7f51\u5361\u63a5\u53e3\u540d\u79f0\n        local has_wlan=false\n        if networksetup -listallnetworkservices | grep -q 'Wi-Fi'; then\n            has_wlan=true\n        fi\n        local wlan_dev=''\n        local wlan_status='inactive'\n        local wlan_inet=''\n        if [ $has_wlan = true ]; then\n            wlan_dev=$(networksetup -listallhardwareports | awk '/Hardware Port: Wi-Fi/{getline; print $NF}')\n            if [ -n \"$wlan_dev\" ]; then\n                wlan_status=$(ifconfig \"$wlan_dev\" | awk '/status:/{print $NF}')\n                if [ \"$wlan_status\" = active ]; then\n                    # \u83b7\u53d6Wi-Fi SSID\n                    # local wlan_ssid=$(airport -I | awk '/ SSID/{print $2}')\n                    local wlan_ssid=''\n                    wlan_ssid=$(networksetup -getairportnetwork \"$wlan_dev\" | awk '{print $NF}')\n                    # \u83b7\u53d6 IPv4 \u5730\u5740\n                    wlan_inet=$(ifconfig \"$wlan_dev\" | awk '/inet /{print $2}')\n                    echo \"Wi-Fi $wlan_dev : status=$wlan_status, ssid=$wlan_ssid, inet=$wlan_inet\"\n                else\n                    echo \"Wi-Fi $wlan_dev : status=$wlan_status\"\n                fi\n            fi\n        fi\n\n        # \u6839\u636e\u7f51\u53e3\u6d3b\u8dc3\u72b6\u6001\uff0c\u4f18\u5148\u83b7\u53d6\u6709\u7ebf\u7f51\u7edc\n        # if eth not bootped, try get wlan\n        if [ $has_eth = true ] &amp;&amp; [ \"$eth_status\" = active ]; then\n            if [ -n \"$eth_inet\" ]; then\n                lan_ip=$eth_inet\n            elif [ $has_wlan = true ] &amp;&amp; [ \"$wlan_status\" = active ]; then\n                if [ -n \"$wlan_inet\" ]; then\n                    lan_ip=$wlan_inet\n                fi\n            fi\n        elif [ $has_wlan = true ] &amp;&amp; [ \"$wlan_status\" = active ]; then\n            if [ -n \"$wlan_inet\" ]; then\n                lan_ip=$wlan_inet\n            fi\n        fi\n    fi\n}\n</code></pre> <p>\u5728\u8be5\u811a\u672c\u4e2d\uff0c\u5148\u4f7f\u7528 <code>grep -q</code> \u9884\u5339\u914d\u5728\u5f79\u7f51\u53e3\u5217\u8868\uff0c\u4ee5\u5224\u65ad\u662f\u5426\u5b58\u5728\u6709\u7ebf\u7f51\u53e3\uff0c\u5b58\u5728\u518d\u83b7\u53d6\u6709\u7ebf\u7f51\u5361\u63a5\u53e3\u540d\u79f0\uff08eth_dev\uff09\u3002</p> <pre><code># get_lan_ip.sh\nget_lan_ip() {\n\n        # \u5224\u65ad\u662f\u5426\u5b58\u5728\u6709\u7ebf\u7f51\u53e3\n        local has_eth=false\n        networksetup -listallnetworkservices | grep -q 'Ethernet'\n        if [ $? -eq 0 ]; then\n            has_eth=true\n        fi\n\n        # \u83b7\u53d6\u6709\u7ebf\u7f51\u5361\u63a5\u53e3\u540d\u79f0\n\n}\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#udid","title":"udid","text":"<p><code>ios-deploy -c</code> \u6253\u5370\u8fde\u63a5\u7684 iOS \u8bbe\u5907\u4fe1\u606f\uff1a</p> <pre><code>$ ios_device=`ios-deploy -c`\n$ echo $ios_device\n[....] Waiting up to 5 seconds for iOS device to be connected\n[....] Found f45d8fa32cab22b136c86116f20d875f7e93ef52 (D10AP, iPhone 7, iphoneos, arm64) a.k.a. 'iPhone7Fan' connected through USB.\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#sed_5","title":"sed","text":"<p>\u57fa\u4e8e sed \u7684 n \u547d\u4ee4\uff0c\u63d0\u53d6\u7b2c\u4e8c\u884c\uff1a</p> <pre><code>$ second_line=`echo $ios_device| sed -n 'n;p'`\n$ echo $second_line\n[....] Found f45d8fa32cab22b136c86116f20d875f7e93ef52 (D10AP, iPhone 7, iphoneos, arm64) a.k.a. 'iPhone7Fan' connected through USB.\n</code></pre> <p>\u518d\u57fa\u4e8e sed \u5bf9\u7b2c2\u884c\u6390\u5934\u53bb\u5c3e\u63d0\u53d6:</p> <pre><code>$ udid=`echo $second_line | sed 's/.* Found //' | sed 's/ (.*//'`\n$ echo $udid\nf45d8fa32cab22b136c86116f20d875f7e93ef52\n$ echo ${#udid}\n40\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/sed-awk-demo/#awk_5","title":"awk","text":"<p>\u57fa\u4e8e awk \u5bf9\u7b2c2\u884c\u6307\u5b9a FS=<code>Found</code> \u5206\u5272\u63d0\u53d6\uff1a</p> <pre><code># sub \u66ff\u6362\u7a7a\u683c\u540e\u9762\u7684\u90e8\u5206\u4e3a\u7a7a\n$ udid=`echo $second_line | awk -F \"Found \" '{sub(/ .*/, \"\", $2);print$2}'`\n# \u91cd\u5b9a\u5411\u4e8c\u6b21\u57fa\u4e8e\u9ed8\u8ba4\u7684\u7a7a\u683c\u5206\u5272\u63d0\u53d6\n$ udid=`echo $second_line | awk -F \"Found \" '{print$2}' | awk '{print $1}'`\n</code></pre> <p>\u4ed4\u7ec6\u89c2\u5bdf\u53ef\u77e5\uff0c\u5305\u542b udid \u7684\u7b2c\u4e8c\u884c\u672c\u8eab\u5c31\u662f\u57fa\u4e8e\u7a7a\u683c\u6392\u7248\u7684\uff0c\u53ef\u8fdb\u4e00\u6b65\u7cbe\u7b80 awk \u8bed\u53e5\u3002 \u76f4\u63a5\u57fa\u4e8e awk \u6b63\u5219\u8fc7\u6ee4\u51fa\u5305\u542b <code>Found</code> \u7684\u7b2c2\u884c\uff0c\u518d\u6253\u5370\u5206\u5272\u57df field 3 \u5373\u53ef\u3002</p> <pre><code>$ udid=`ios-deploy -c | awk '/Found/{print $3}'`\n</code></pre>","tags":["sed","awk"]},{"location":"blog/20191105/awk-basic/","title":"Linux Command - awk basic","text":"<p>Linux \u4e0b\u7684 awk \u547d\u4ee4\u57fa\u672c\u77e5\u8bc6\u3002</p> <p>\u867d\u7136sed\u7f16\u8f91\u5668\u662f\u975e\u5e38\u65b9\u4fbf\u81ea\u52a8\u4fee\u6539\u6587\u672c\u6587\u4ef6\u7684\u5de5\u5177\uff0c\u4f46\u5176\u4e5f\u6709\u81ea\u8eab\u7684\u9650\u5236\u3002 \u5982\u679c\u8981\u683c\u5f0f\u5316\u62a5\u6587\u6216\u4ece\u4e00\u4e2a\u5927\u7684\u6587\u672c\u6587\u4ef6\u4e2d\u62bd\u53d6\u6570\u636e\u5305\uff0c\u90a3\u4e48 awk \u53ef\u4ee5\u5b8c\u6210\u8fd9\u4e9b\u4efb\u52a1\u3002</p> <p>awk \u63d0\u4f9b\u4e86\u4e00\u4e2a\u7c7b\u7f16\u7a0b\u73af\u5883\u6765\u4fee\u6539\u548c\u91cd\u65b0\u7ec4\u7ec7\u6587\u4ef6\u4e2d\u7684\u6570\u636e\uff0c\u662f\u4e00\u79cd\u6765\u5904\u7406\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u7684\u66f4\u9ad8\u7ea7\u5de5\u5177\u3002 awk \u662f\u4e00\u79cd\u81ea\u89e3\u91ca\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u4ee5\u53d1\u5c55\u8fd9\u79cd\u8bed\u8a00\u7684\u4eba <code>A</code>ho.<code>W</code>eninberger \u548c <code>K</code>ernigham \u547d\u540d\u3002 awk \u7ed3\u5408\u8bf8\u5982 grep \u548c sed \u7b49\u5176\u4ed6\u5de5\u5177\uff0c\u5c06\u4f1a\u4f7fshell\u7f16\u7a0b\u66f4\u52a0\u5f3a\u5927\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709 gawk\u3001nawk \u548c mawk \u7b49\u6269\u5c55\u53d8\u79cd\u3002  </p> <p>\u4e3a\u83b7\u5f97\u6240\u9700\u4fe1\u606f\uff0c\u6587\u672c\u6216\u5b57\u7b26\u4e32\u5fc5\u987b\u683c\u5f0f\u5316\uff0c\u610f\u5373\u7528 <code>\u57df\u5206\u5272\u7b26</code>\uff08Filed Separator\uff09\u5212\u5206\u62bd\u53d6\u57df\u3002 awk \u5728\u6587\u672c\u6587\u4ef6\u6216\u5b57\u7b26\u4e32\u4e2d\u57fa\u4e8e\u6307\u5b9a\u89c4\u5219\u6d4f\u89c8\u548c\u62bd\u53d6\u4fe1\u606f\uff0c\u7136\u540e\u518d\u6267\u884c\u5176\u4ed6\u547d\u4ee4\u3002</p> <p>\u53ef\u4ee5\u5229\u7528 awk \u7f16\u7a0b\u8bed\u8a00\u505a\u4e0b\u9762\u7684\u4e8b\u60c5\uff1a</p> <ul> <li>\u5b9a\u4e49\u53d8\u91cf\u6765\u4fdd\u5b58\u6570\u636e  </li> <li>\u4f7f\u7528\u7b97\u672f\u548c\u5b57\u7b26\u4e32\u64cd\u4f5c\u7b26\u6765\u5904\u7406\u6570\u636e  </li> <li>\u4f7f\u7528\u7ed3\u6784\u5316\u7f16\u7a0b\u6982\u5ff5\uff08\u6bd4\u5982if-then\u8bed\u53e5\u548c\u5faa\u73af\uff09\u6765\u4e3a\u6570\u636e\u5904\u7406\u589e\u52a0\u5904\u7406\u903b\u8f91  </li> <li>\u901a\u8fc7\u63d0\u53d6\u6570\u636e\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u5143\u7d20\uff0c\u5c06\u5176\u91cd\u65b0\u6392\u5217\u6216\u683c\u5f0f\u5316\uff0c\u751f\u6210\u683c\u5f0f\u5316\u62a5\u544a  </li> </ul> <p>awk \u7a0b\u5e8f\u7684\u62a5\u544a\u751f\u6210\u80fd\u529b\u901a\u5e38\u7528\u6765\u4ece\u5927\u6587\u672c\u6587\u4ef6\u4e2d\u63d0\u53d6\u6570\u636e\u5143\u7d20\uff0c\u5e76\u5c06\u5b83\u4eec\u683c\u5f0f\u5316\u6210\u53ef\u8bfb\u7684\u62a5\u544a\u3002\u5176\u4e2d\u6700\u5b8c\u7f8e\u7684\u4f8b\u5b50\u662f\u683c\u5f0f\u5316\u65e5\u5fd7\u6587\u4ef6\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#awk_\u8303\u5f0f","title":"awk \u8303\u5f0f","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cawk \u4f1a\u4ece\u8f93\u5165\u4e2d\u8bfb\u53d6\u4e00\u884c\u6587\u672c\uff0c\u7136\u540e\u9488\u5bf9\u8be5\u884c\u7684\u6570\u636e\u6267\u884c\u7a0b\u5e8f\u811a\u672c\u3002</p> <p>\u4e00\u4e2a\u5b8c\u6574\u7684 awk \u811a\u672c\u75313\u90e8\u5206\u7ec4\u6210\uff0c\u5f62\u5982\u5982\u4e0b\uff1a</p> <pre><code>awk 'BEGIN {begin} {body} END {end}' file\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#beginend","title":"BEGIN/END","text":"<p>awk \u811a\u672c\u5305\u542b\u4e24\u4e2a\u7279\u6b8a\u5b57\u6bb5 <code>BEGIN</code> \u548c <code>END</code>\u3002</p> <ul> <li><code>BEGIN</code> : \u5728\u5904\u7406\u6570\u636e\u524d\u8fd0\u884c\u811a\u672c\uff0c\u7528\u4e8e\u4e3a\u62a5\u544a\u521b\u5efa\u6807\u9898\u7b49\uff1b  </li> <li><code>END</code> : \u5728\u5904\u7406\u6570\u636e\u540e\u8fd0\u884c\u811a\u672c\uff0cawk \u4f1a\u5728\u8bfb\u5b8c\u6570\u636e\u540e\u6267\u884c\u5b83\uff1b  </li> </ul> <p><code>BEGIN</code> \u8bed\u53e5\u7528\u4e8e\u8bbe\u5b9a PreProcessing\uff0c\u7528\u4e8e\u8bbe\u7f6e\u8ba1\u6570\u548c\u6253\u5370\u5934\uff0c\u4f7f\u7528\u5728\u4efb\u4f55\u6587\u672c\u6d4f\u89c8\u52a8\u4f5c\u4e4b\u524d\u3002  </p> <p>\u901a\u5e38 awk \u63a7\u5236\u683c\u5f0f\u76f8\u5173\u7684\u4e00\u4e9b\u5185\u7f6e\u53d8\u91cf\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u53d8\u91cf\u653e\u5728 BEGIN \u90e8\u5206\uff0c\u4ee5\u4fbf\u5728\u8bfb\u53d6\u7b2c\u4e00\u884c\u4e4b\u524d\u5373\u521d\u59cb\u5316\u3002</p> <p><code>END</code> \u8bed\u53e5\u7528\u6765\u8bbe\u5b9a PostProcessing\uff0c\u7528\u4e8e\u5728\u5b8c\u6210\u6587\u672c\u6d4f\u89c8\u52a8\u4f5c\u540e\u6253\u5370\u8f93\u51fa\u6587\u672c\u603b\u6570\u548c\u7ed3\u5c3e\u72b6\u6001\u6807\u5fd7\u3002  </p> <p>BEGIN/END \u90e8\u5206\u901a\u5e38\u4e0d\u662f\u5fc5\u987b\u7684\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#\u6a21\u5f0f\u548c\u52a8\u4f5c","title":"\u6a21\u5f0f\u548c\u52a8\u4f5c","text":"<p>awk \u811a\u672c\u7684 body \u90e8\u5206\u53ef\u80fd\u5305\u542b\u591a\u6761\u8bed\u53e5\uff0c\u4efb\u4f55\u4e00\u6761 awk \u8bed\u53e5\u5219\u90fd\u7531 <code>\u6a21\u5f0f</code> \u548c <code>\u52a8\u4f5c</code> \u7ec4\u6210\u3002</p> <p>\u6a21\u5f0f\u90e8\u5206\u51b3\u5b9a\u52a8\u4f5c\u8bed\u53e5\u4f55\u65f6\u89e6\u53d1\u53ca\u89e6\u53d1\u4e8b\u4ef6\uff0c\u5904\u7406\u5373\u5bf9\u6570\u636e\u8fdb\u884c\u7684\u64cd\u4f5c\u3002 \u6a21\u5f0f\u53ef\u4ee5\u662f\u4efb\u4f55\u6761\u4ef6\u8bed\u53e5\u6216\u590d\u5408\u8bed\u53e5\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u3002</p> <pre><code>pattern { action }\n</code></pre> <p>\u5982\u679c\u4e0d\u7279\u522b\u6307\u660e\u6a21\u5f0f\uff0cawk \u603b\u662f\u5339\u914d\u6216\u6253\u5370\u884c\u6570\u3002\u5982\u679c\u7701\u7565\u6a21\u5f0f\u90e8\u5206\uff0c\u52a8\u4f5c\u5c06\u65f6\u523b\u4fdd\u6301\u6267\u884c\u72b6\u6001\u3002</p> <p>\u52a8\u4f5c \u5927\u591a\u6570\u7528\u6765\u6253\u5370\uff0c\u4f46\u662f\u53ef\u4ee5\u5728\u5927\u62ec\u53f7\uff08<code>{}</code>\uff09\u5185\u4e66\u5199\u66f4\u957f\u7684\u4ee3\u7801\u8bf8\u5982 if \u548c\u5faa\u73af\uff08looping\uff09\u8bed\u53e5\u53ca\u5faa\u73af\u9000\u51fa\u7ed3\u6784\u3002 \u5927\u62ec\u53f7\uff08<code>{}</code>\uff09\u5185\u591a\u884c\u8bed\u53e5\u4ee5\u5206\u53f7\uff08<code>;</code>\uff09\u76f8\u9694\uff0c\u8fd9\u4e00\u70b9\u548c sed\u3001C\u7b49\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u4e00\u81f4\u3002  </p> <p>\u5982\u679c\u4e0d\u6307\u660e\u91c7\u53d6\u52a8\u4f5c\uff0cawk \u5c06\u6253\u5370\u51fa\u6240\u6709\u6d4f\u89c8\u51fa\u6765\u7684\u8bb0\u5f55\u3002</p> <p>awk \u9ed8\u8ba4\u7684\u52a8\u4f5c\u662f\u9010\u6761\u904d\u5386\u6253\u5370\u8bb0\u5f55(foreach print)\uff0c\u6709\u4ee5\u4e0b\u51e0\u79cd\u6700\u7b80\u8303\u5f0f\uff1a</p> <ul> <li>\u9010\u884c\u6253\u5370\u6587\u6863\uff1a<code>awk 1{print $0} data.txt</code>\uff0c\u5176\u4e2d\u6a21\u5f0f1\u6052\u6210\u7acb\uff1b  </li> <li>\u8fdb\u4e00\u6b65\u7701\u7565\u9ed8\u8ba4\u53c2\u6570 $0\uff1a<code>awk 1{print} data.txt</code>\uff1b  </li> <li>\u8fdb\u4e00\u6b65\u7701\u7565\u9ed8\u8ba4\u52a8\u4f5c\uff1a<code>awk 1 data.txt</code>\u3002  </li> </ul> <p>\u9664\u4e86\u8f93\u51fa\u5b57\u6bb5\u5206\u5272\u7b26\uff08<code>OFS</code>\uff09\uff0cawk \u4e2d\u7684 print \u8bed\u53e5\u5728\u6570\u636e\u663e\u793a\u4e0a\u5e76\u672a\u63d0\u4f9b\u591a\u5c11\u63a7\u5236\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#\u5165\u95e8\u793a\u4f8b","title":"\u5165\u95e8\u793a\u4f8b","text":"<p>\u53ef\u4ee5\u53ea\u4e66\u5199 BEGIN \u90e8\u5206\u6d4b\u8bd5 awk \u8bed\u6cd5\uff0c\u7701\u7565 body \u548c END \u90e8\u5206\uff0c\u4ee5\u53ca file \u53c2\u6570\u3002</p> <pre><code>$ awk 'BEGIN {print \"Hello, AWK!\"}'\nHello, AWK!\n</code></pre> <p>\u6587\u672c\u6587\u4ef6 data1 \u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>$ cat data1\nP.Bunny # 02/99 # 48   # Yellow\nJ.Troll # 07/99 # 4842 # Brown-3\n</code></pre> <p>\u5728 awk \u7ed3\u5c3e\u90e8\u5206\uff0c\u901a\u8fc7 END \u6253\u5370\u5904\u7406\u7684\u8bb0\u5f55\u6570\uff1a</p> <pre><code>$ awk 'END {print \"end-of-record, NR=\"NR}' data1\nend-of-record, NR=2\n</code></pre> <p>\u6587\u672c\u6587\u4ef6 data2.txt \u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>$ cat data2.txt\nOne line of test text.\nTwo lines of test text.\nThree lines of test text.\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u6bb5\u5b8c\u6574\u7684\u8303\u5f0f\u793a\u4f8b\uff1a</p> <pre><code>$ awk 'BEGIN {print \"The data2 File Contents:\"; print \"==========\"}\n    {print $0}\n    END {print \"==========\"; print \"End of File\"}' data2.txt\nThe data2 File Contents:\n==========\nOne line of test text.\nTwo lines of test text.\nThree lines of test text.\n==========\nEnd of File\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#\u8bb0\u5f55\u548c\u57df","title":"\u8bb0\u5f55\u548c\u57df","text":"","tags":["awk"]},{"location":"blog/20191105/awk-basic/#\u8bb0\u5f55record","title":"\u8bb0\u5f55\uff08Record\uff09","text":"<p>\u8ddf sed \u4e00\u6837\uff0cawk \u9ed8\u8ba4\u9010\u884c\u626b\u63cf\u6587\u672c\uff0c\u5e76\u6267\u884c\u7a0b\u5e8f\u5bf9\u6bcf\u4e00\u884c\u8fdb\u884c\u5206\u6790\u5904\u7406\u3002 \u8fd9\u91cc\u7684\u201c\u4e00\u884c\u201d\u5373\u4e3a\u4e00\u6761\u8bb0\u5f55\uff08Record\uff09\uff0c\u662f awk \u5c06\u8fdb\u884c\u6570\u636e\u5206\u6790\u5904\u7406\u7684\u57fa\u672c\u5355\u4f4d\u3002</p> <p>awk \u626b\u63cf\u6587\u672c\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u6839\u636e\u8bb0\u5f55\u5206\u5272\u7b26 <code>RS</code>\uff08Record Seperator\uff09\u6765\u754c\u5b9a\u4e00\u6761\u8bb0\u5f55\u7684\u3002 \u5f53\u53d1\u73b0 RS \u65f6\uff0cawk \u83b7\u6089\u8bfb\u53d6\u5230\u4e86\u4e00\u6761\u8bb0\u5f55\uff0c\u8fdb\u884c\u6a21\u5f0f\u5339\u914d\uff08\u5206\u6790\uff09\u5e76\u6267\u884c\u52a8\u4f5c\uff08\u5904\u7406\uff09\u3002 \u5206\u6790\u5b8c\u4e00\u6761\u8bb0\u5f55\u540e\uff0c\u7ee7\u7eed\u79fb\u52a8\u6307\u9488\u5411\u540e\u626b\u63cf\uff0c\u76f4\u5230\u53d1\u73b0\u4e0b\u4e00\u4e2a RS\uff0c\u5904\u7406\u65b0\u7684\u8bb0\u5f55\u3002 \u8bfb\u53d6\u8fdb\u7a0b\u5982\u6b64\u5f80\u590d\uff0c\u6301\u7eed\u5230\u6587\u4ef6\u7ed3\u5c3e\uff08EOF\uff09\u6216\u6587\u4ef6\u4e0d\u518d\u5b58\u5728\u7ed3\u675f\u3002</p> <p>\u4ee5\u4e0b\u5728 BEGIN \u4e2d\u6253\u5370\u5f53\u524d RS\uff0c\u9ed8\u8ba4\u4e3a\u6362\u884c\u7b26 <code>\\n</code>\uff1a</p> <pre><code>$ awk 'BEGIN { printf \"RS=\\\"%s\\\"\\n\", RS }'\nRS=\"\n\"\n</code></pre> <p>\u5173\u4e8e RS \u53d8\u91cf\u7684\u8bbe\u7f6e\u548c\u5b9e\u8df5\uff0c\u53c2\u8003 awk-vars \u4e00\u8282\u3002</p> <p><code>awk '1 {print $0}' data2.txt</code> \u4e2d\u7684\u6a21\u5f0f\u6c38\u771f\uff0c\u5b9e\u9645\u6548\u679c\u4e3a\u9010\u6761\u6253\u5370\u3002</p> <p>\u7531\u4e8e print \u4e3a\u7f3a\u7701\u52a8\u4f5c\uff0c\u56e0\u6b64\u53ef\u8fdb\u4e00\u6b65\u7b80\u5199\u4e3a <code>awk 1 data2.txt</code>\u3002</p> <pre><code>$ awk '1 {print}' data2.txt\nOne line of test text.\nTwo lines of test text.\nThree lines of test text.\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#\u57dffield","title":"\u57df\uff08Field\uff09","text":"<p>awk \u5728\u5904\u7406\u4e00\u6761\u8bb0\u5f55\u65f6\uff0c\u4f1a\u7528\u9884\u5b9a\u4e49\u7684\u5206\u5272\u7b26\uff0c\u5c06\u8fd9\u6761\u8bb0\u5f55\u5212\u5206\u4e3a\u591a\u4e2a\u57df\uff08\u5b57\u6bb5\uff0cField\uff09\u3002</p> <p>\u53ef\u7c7b\u6bd4excel\u8868\u683c\u6570\u636e\uff1a\u5c06\u8bb0\u5f55\u7c7b\u6bd4\u8868\u683c\u7684\u884c\uff08row\uff09\uff0c\u57df\u7c7b\u6bd4\u4e3a\u8868\u683c\u7684\u5217\uff08column\uff09\u3002</p> <p>awk \u626b\u63cf\u8bb0\u5f55\u65f6\uff0c\u5f53\u53d1\u73b0\u57df\u5206\u5272\u7b26 <code>FS</code>\uff08Field Seperator\uff09\uff0c\u5219\u5c06\u5176\u5f53\u505a\u4e00\u4e2a\u5b57\u6bb5\u3002</p> <p>awk \u4e2d\u9ed8\u8ba4\u7684\u5b57\u6bb5\u5206\u5272\u7b26\u662f\u4efb\u610f\u7684\u7a7a\u767d\u5b57\u7b26\uff08\u4f8b\u5982\u7a7a\u683c\u6216\u5236\u8868\u7b26\uff09\u3002</p> <p>\u4ee5\u4e0b\u5728 BEGIN \u4e2d\u6253\u5370\u5f53\u524d FS\uff1a</p> <pre><code>$ awk 'BEGIN { printf \"FS=\\\"%s\\\"\\n\", FS }'\nFS=\" \"\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#-f_\u6307\u5b9a\u57df\u5206\u5272\u7b26","title":"-F \u6307\u5b9a\u57df\u5206\u5272\u7b26","text":"<p>\u9ed8\u8ba4 <code>FS</code> \u975e\u9876\u683c\u7a7a\u683c\u6216\u5236\u8868\u7b26\uff0c\u4e5f\u53ef\u4ee5\u81ea\u884c\u6307\u5b9a\u5176\u4ed6\u5b57\u7b26\uff08\u4e32\uff09\u4f5c\u4e3a\u57df\u5206\u5272\u7b26\u3002 \u9664\u6b64\u4e4b\u5916\uff0c\u4e5f\u53ef\u5728\u6267\u884c awk \u547d\u4ee4\u65f6\u901a\u8fc7 <code>-F</code> \u9009\u9879\u6765\u6307\u5b9a\u57df\u5206\u5272\u7b26\u3002</p> <p><code>-F</code> \u4e4b\u540e\u7684 fs \u4e4b\u95f4\u53ef\u4ee5\u6ca1\u6709\u7a7a\u683c\uff1b<code>fs</code> \u5982\u679c\u662f\u5355\u4e2a\u5b57\u7b26\u53ef\u4ee5\u4e0d\u52a0\uff08\u53cc\uff09\u5f15\u53f7\uff1b\u5982\u679c\u662f\u591a\u4e2a\u5b57\u7b26\u6216\u5305\u542b\u7a7a\u683c\uff0c\u5efa\u8bae\u6dfb\u52a0\u5f15\u53f7\u3002</p> <p>\u643a\u5e26 <code>-F</code> \u9009\u9879\u7684\u5178\u578b\u8c03\u7528\u8303\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>awk -F: 'commands' input-file\n</code></pre> <p>\u6267\u884c awk \u547d\u4ee4\uff0c<code>-F</code> \u6307\u5b9a\u6309 <code>#</code> \u5206\u5272\u57df\uff0c\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>$ awk -F '#' '{print $1,$2,$3,$4}' data1\nP.Bunny   02/99   48     Yellow\nJ.Troll   07/99   4842   Brown-3\n</code></pre> <p>\u53c2\u7167\u4e0b\u8868\uff0cawk \u6bcf\u6b21\u8bfb\u53d6\u4e00\u6761\u8bb0\u5f55\uff0c\u5728\u5206\u6790\u8bb0\u5f55\u65f6\uff0c\u9047\u5230\u57df\u5206\u5272\u7b26\uff08<code>#</code>\uff09\uff0c\u6807\u8bc6\u5176\u4e3a\u57df $n\uff0c\u76f4\u81f3\u9047\u5230\u8bb0\u5f55\u5206\u5272\u7b26 <code>RS</code> \u7ed3\u675f\u3002 \u7136\u540e\uff0c\u7ee7\u7eed\u626b\u63cf\u4e0b\u4e00\u6761\u8bb0\u5f55\uff0c\u5206\u6790\u5176\u4e2d\u7684\u57df\uff08\u5b57\u6bb5\uff09\uff0c\u5982\u6b64\u5f80\u590d\u3002</p> \u57df1 \u5206\u5272\u7b26 \u57df2 \u5206\u5272\u7b26 \u57df3 \u5206\u5272\u7b26 \u57df4 RS P.Bunny # 02/99 # 48 # Yellow \\n J.Troll # 07/99 # 4842 # Brown-3 \\n <p>awk \u7684 <code>-F</code> \u9009\u9879\u53ef\u6307\u5b9a\u4efb\u4f55\u5408\u6cd5\u7684\u5b57\u7b26\u4e32\u4f5c\u4e3a\u57df\u5206\u5272\u7b26\uff0c\u4ee5\u4fbf\u5bf9\u6570\u636e\u8bb0\u5f55\u8fdb\u884c\u5207\u5272\u63d0\u53d6\u5206\u6790\u3002 \u5178\u578b\u4f7f\u7528\u573a\u666f\u662f\u5229\u7528 grep \u6216 sed \u4ece\u6587\u672c\u4e2d\u7b5b\u9009\u51fa\u5339\u914d\u6307\u5b9a\u6a21\u5f0f\u7684\u884c\uff0c\u518d\u901a\u8fc7\u7ba1\u9053\u91cd\u5b9a\u5411\u7ed9 awk \u8fdb\u884c\u5207\u5272\u63d0\u53d6\u6307\u5b9a\u57df\u3002  </p> <p>sed-awk-demo \u4e2d\u6709\u5927\u91cf sed \u4e0e awk \u7ed3\u5408\u4f7f\u7528\u7684\u573a\u666f\u793a\u4f8b\u3002 </p> <p>awk - 10 examples to insert / remove / update fields of a CSV file </p> <p>\u5173\u4e8e\u4f7f\u7528shell\u5728\u6587\u4ef6\u4e2d\u67e5\u627e\u4e00\u6bb5\u5b57\u7b26\u4e32\u7684\u95ee\u9898</p> <p>\u6307\u5b9a FS=AAA\uff0c\u57fa\u4e8e AAA \u5206\u5272\u524d\u534a\u90e8\u5206\uff1a</p> <pre><code>$ echo \"12312312343242AAAdfasdfasdfasdfasdfadAAAfsdgfsdfgfgfgdfgasdfg\" | awk -F \"AAA\" '{print $1}'\n12312312343242\n</code></pre> <p>\u6307\u5b9a FS=AAA\uff0c\u57fa\u4e8e AAA \u5206\u5272\u540e\u534a\u90e8\u5206\uff1a</p> <pre><code>$ echo \"12312312343242AAAdfasdfasdfasdfasdfadAAAfsdgfsdfgfgfgdfgasdfg\" | awk -F \"AAA\" '{print $2}'\ndfasdfasdfasdfasdfad\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#\u57df\u6807\u8bc6\u53ca\u5f15\u7528","title":"\u57df\u6807\u8bc6\u53ca\u5f15\u7528","text":"<p>awk \u5c06\u5206\u5272\u51fa\u6765\u7684\u57df\u4f9d\u6b21\u6807\u8bb0\u4e3a <code>$1</code>,<code>$2</code>,...,<code>$n</code>\uff0c\u5b83\u4eec\u79f0\u4e3a \u57df\u6807\u8bc6\u3002</p> <ul> <li><code>$0</code> : \u4ee3\u8868\u6574\u4e2a\u6587\u672c\u884c\uff08\u6574\u6761\u8bb0\u5f55\uff09  </li> <li><code>$1</code> : \u4ee3\u8868\u6587\u672c\u884c\u4e2d\u7684\u7b2c1\u4e2a\u6570\u636e\u5b57\u6bb5  </li> <li><code>$2</code> : \u4ee3\u8868\u6587\u672c\u884c\u4e2d\u7684\u7b2c2\u4e2a\u6570\u636e\u5b57\u6bb5  </li> <li><code>$n</code> : \u4ee3\u8868\u6587\u672c\u884c\u4e2d\u7684\u7b2cn\u4e2a\u6570\u636e\u5b57\u6bb5  </li> </ul> <p>\u811a\u672c\u4e2d\u53ef\u5f15\u7528\u57df\u6807\u8bc6\u5bf9\u57df\u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\u3002 \u4f7f\u7528 <code>$1,$3</code> \u8868\u793a\u5f15\u7528\u7b2c1\u548c\u7b2c3\u57df\uff0c\u6ce8\u610f\u8fd9\u91cc\u7528\u9017\u53f7\u505a\u57df\u5206\u5272\u3002 \u5982\u679c\u5e0c\u671b\u6253\u5370\u67095\u4e2a\u57df\u7684\u8bb0\u5f55\u7684\u6240\u6709\u57df\uff0c\u4e0d\u5fc5\u6307\u660e <code>$1,$2,$3,$4,$5</code>\uff0c\u53ef\u4f7f\u7528 <code>$0</code>\uff0c\u610f\u5373\u6574\u6761\u8bb0\u5f55\u7684\u6240\u6709\u57df\u3002 awk \u6d4f\u89c8\u6570\u636e\u5230\u8fbe\u4e00\u65b0\u884c\u65f6\uff0c\u5373\u5047\u5b9a\u5230\u8fbe\u5305\u542b\u57df\u7684\u8bb0\u5f55\u672b\u5c3e\uff0c\u7136\u540e\u5f00\u59cb\u4e0b\u4e00\u884c\u65b0\u8bb0\u5f55\u7684\u8bfb\u52a8\u4f5c\uff0c\u5e76\u91cd\u65b0\u8bbe\u7f6e\u57df\u5206\u5272\u7b26\u3002  </p> <p>\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0cawk \u8bfb\u53d6\u6587\u672c\u6587\u4ef6\uff0c\u6bcf\u884c\u53ea\u663e\u793a\u7b2c1\u4e2a\u5b57\u6bb5\u3002</p> <pre><code>$ awk '{print $1}' data2.txt\nOne\nTwo\nThree\n</code></pre> <p>\u4ee5\u4e0b\u547d\u4ee4\u6458\u53d6\u6253\u5370\u6bcf\u6761\u8bb0\u5f55\u7684\u7b2c1\u30013\u30016\u4e09\u4e2a\u5b57\u6bb5\uff1a</p> <pre><code>$ awk '{print $1,$3,$6}' grade.txt\nM.Tansley 48311 40\nJ.Lulu 48317 24\nP.Bunny 48 35\nJ.Troll 4842 26\nL.Tansley 4712 30\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0cawk \u5f15\u7528\u57df\u56db\u5e76\u5bf9\u5176\u8fdb\u884c\u8d4b\u503c\u4fee\u6539\uff1a</p> <pre><code>$ awk '{$4=\"awk\";print$0}' data2.txt\nOne line of awk text.\nTwo lines of awk text.\nThree lines of awk text.\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#\u5178\u578b\u8303\u5f0f","title":"\u5178\u578b\u8303\u5f0f","text":"<p>Manual Pages \u4e2d\u7684 SYNOPSIS \u5982\u4e0b\uff1a</p> <pre><code>       awk [ -F fs ] [ -v var=value ] [ 'prog' | -f progfile ] [ file ...  ]\n\n       awk [\u2212F sepstring] [\u2212v assignment]... program [argument...]\n\n       awk [\u2212F sepstring] \u2212f progfile [\u2212f progfile]... [\u2212v assignment]...\n            [argument...]\n</code></pre> <p>\u7701\u7565\u6a21\u5f0f\u90e8\u5206\u7684\u5178\u578b awk \u8c03\u7528\u8303\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>awk options 'commands' input-file\n</code></pre> <p>\u4e5f\u53ef\u5c06\u6240\u6709\u7684 awk \u547d\u4ee4\u4fdd\u5b58\u5230\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\u4e2d\uff0c\u7136\u540e\u8c03\u7528 awk \u65f6\u7528 <code>-f</code> \u9009\u9879\u6307\u5b9a\u547d\u4ee4\u811a\u672c\uff1a</p> <pre><code>awk -f awk-script-file input-file(s)\n</code></pre> <ul> <li><code>-f</code> \u9009\u9879\u6307\u660e\u5728\u6587\u4ef6 awk_script_file \u4e2d\u7684 awk \u811a\u672c\uff1b  </li> <li><code>input-file(s)</code> \u662f\u4f7f\u7528 awk \u8fdb\u884c\u6d4f\u89c8\u7684\u6587\u4ef6\u540d\u3002  </li> </ul>","tags":["awk"]},{"location":"blog/20191105/awk-basic/#options","title":"options","text":"<p>awk \u5e38\u7528\u547d\u4ee4\u9009\u9879\u5982\u4e0b\u8868\uff1a</p> \u9009\u9879 \u63cf\u8ff0 <code>-F fs</code> \u6307\u5b9a\u884c\u4e2d\u5212\u5206\u6570\u636e\u5b57\u6bb5\u7684\u5b57\u6bb5\u5206\u5272\u7b26 <code>-f file</code> \u4ece\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\u8bfb\u53d6\u811a\u672c\u7a0b\u5e8f <code>-v var=value</code> \u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\u53ca\u5176\u9ed8\u8ba4\u503c <code>-mf N</code> \u6307\u5b9a\u8981\u5904\u7406\u7684\u6570\u636e\u6587\u4ef6\u4e2d\u7684\u6700\u5927\u5b57\u6bb5\u6570 <code>-mr N</code> \u6307\u5b9a\u6570\u636e\u6587\u4ef6\u4e2d\u7684\u6700\u5927\u6570\u636e\u884c\u6570","tags":["awk"]},{"location":"blog/20191105/awk-basic/#input_from_stdin","title":"input from STDIN","text":"<p>\u82e5\u6ca1\u6709\u5728\u547d\u4ee4\u884c\u4e0a\u6307\u5b9a\u6587\u4ef6\uff08input-file\uff09\uff0c\u5219 awk \u5c06\u4f1a\u7b49\u5f85\u4ece STDIN \u63a5\u53d7\u8f93\u5165\u53c2\u6570\u4f5c\u4e3a\u5f85\u5904\u7406\u6570\u636e\u3002</p> <p>\u8f93\u5165\u4e00\u884c\u6587\u672c\u5e76\u6309\u4e0b\u56de\u8f66\u952e\uff0cawk \u4f1a\u5bf9\u8fd9\u884c\u6587\u672c\u8fd0\u884c\u4e00\u904d\u7a0b\u5e8f\u811a\u672c\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b <code>awk '{print \"Hello, AWK!\"}'</code> \u603b\u662f\u6253\u5370\u4e00\u884c\u56fa\u5b9a\u7684\u6587\u672c\u5b57\u7b26\u4e32\uff0c\u56e0\u6b64\u4e0d\u7ba1\u4f60\u5728\u6570\u636e\u6d41\u4e2d\u8f93\u5165\u4ec0\u4e48\u6587\u672c\uff0c\u90fd\u4f1a\u5f97\u5230\u540c\u6837\u7684\u6587\u672c\u8f93\u51fa\u3002</p> <pre><code>$ awk '{print \"Hello, AWK!\"}'\nstdin line 1 for awk!\nHello, AWK!\nstdin line 2 for awk!\nHello, AWK!\n</code></pre> <p>\u7a0d\u4f5c\u4fee\u6539\u4e3a <code>awk '{print $2}'</code>\uff0c\u5219\u6253\u5370\u8f93\u5165\u6587\u672c\u7a7a\u683c\u5206\u5272\u7684\u7b2c2\u4e2a\u5b57\u6bb5\uff1a</p> <pre><code>$ awk '{print $2}'\nHello World\nWorld\nHey Jude\nJude\n</code></pre> <p>\u6309\u4e0b <code>&lt;C-C&gt;</code> \u6216 <code>&lt;C-D&gt;</code>\uff08EOF\uff09\u9000\u51fa\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-control/","title":"Linux Command - awk control","text":"<p>Linux \u4e0b\u7684 awk \u547d\u4ee4\u4e2d\u7684\u6d41\u7a0b\u63a7\u5236\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-control/#\u7ed3\u6784\u5316\u6d41\u7a0b\u63a7\u5236","title":"\u7ed3\u6784\u5316\u6d41\u7a0b\u63a7\u5236","text":"<p>awk \u7f16\u7a0b\u8bed\u8a00\u652f\u6301\u5e38\u89c1\u7684\u7ed3\u6784\u5316\u6d41\u7a0b\u63a7\u5236\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-control/#if","title":"if","text":"<p>\u5047\u5982\u60f3\u770b\u770b\u54ea\u4e9b\u5b66\u751f\u53ef\u4ee5\u83b7\u5f97\u5347\u6bb5\u673a\u4f1a\uff0c\u9700\u8981\u5224\u65ad\u76ee\u524d\u7ea7\u522b\u5206 field-6 \u662f\u5426\u5c0f\u4e8e\uff08<code>&lt;</code>\uff09\u6700\u9ad8\u5206 field-7\u3002</p> <pre><code>#\u4e0d\u6307\u5b9a\u52a8\u4f5c\u65f6\uff0c\u9ed8\u8ba4\u6253\u5370\u5339\u914d\u884c\u3002\n$ awk '$6&lt;$7' grade.txt\nM.Tansley   05/99   48311   Green       8   40  44\nJ.Lulu      06/99   48317   green       9   24  26\n</code></pre> <p>\u4ee5\u4e0a\u547d\u4ee4\u7b49\u6548\u7684 <code>pattern { action }</code> \u7b80\u7ea6\u683c\u5f0f\u4e3a <code>awk '$6&lt;$7 {print $0}' grade.txt</code>\u3002</p> <p>\u5728 body \u90e8\u5206\uff0c\u7528 if \u6761\u4ef6\u5224\u65ad\u7684\u5b8c\u6574\u683c\u5f0f\u4e3a\uff1a</p> <pre><code>awk '{if($6&lt;$7) print $0}' grade.txt\n</code></pre> <ul> <li>\u7b5b\u9009 field-6 \u5c0f\u4e8e 27 \u7684\u6761\u76ee: <code>awk '$6&lt;27' grade.txt</code>\uff1b  </li> <li>\u5224\u65ad\u5c0f\u4e8e\u7b49\u4e8e\uff08<code>&lt;=</code>\uff09\uff1a<code>awk '$6&lt;=$7 {print $1}' grade.txt</code>\uff1b  </li> <li>\u5224\u65ad\u5927\u4e8e\uff08<code>&gt;</code>\uff09\uff1a<code>awk '$6&gt;$7 {print $1}' grade.txt</code>\uff1b  </li> </ul> <p>\u4ee5\u4e0b\u7b5b\u9009\u51fa\u4f4e\u4e8e\u5e73\u5747\u6210\u7ee9\u7684\u8bb0\u5f55\uff0c\u5e76\u8f93\u51fa\u4e00\u53e5\u9f13\u52b1\u7684\u8bdd\uff1a</p> <pre><code># pattern { action } \u683c\u5f0f\n$ awk '$6&lt;$7 {print $1, \"Try better at the next comp\"}' grade.txt\nM.Tansley Try better at the next comp\nJ.Lulu Try better at the next comp\n</code></pre> <p>\u5728 body \u90e8\u5206\uff0c\u7528 if \u6761\u4ef6\u5224\u65ad\u7684\u5b8c\u6574\u683c\u5f0f\u4e3a\uff1a</p> <pre><code>awk '{if($6&lt;$7) print $1, \"Try better at the next comp\"}' grade.txt\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-control/#\u4fee\u6539\u57df\u503c","title":"\u4fee\u6539\u57df\u503c","text":"<p>\u4ee5\u4e0a awk \u8bed\u53e5\u9488\u5bf9 M.Tansley \u4fee\u6539\u5176\u6210\u7ee9\u5e76 print\uff0c\u5176\u4ed6\u4eba\u76f4\u63a5 print \u7b2c1\u30016\u30017\u5217\u3002 \u4fee\u6539\u57df\u503c\u52a8\u4f5c\u53d7\u6761\u4ef6\u9650\u5236\uff0cprint \u52a8\u4f5c\u4e0d\u53d7\u6761\u4ef6\u9650\u5236\u3002</p> <pre><code>$ #awk '{if($1==\"M.Tansley\") $6=$6-1; print $1,$6,$7}' grade.txt\n$ awk '$1==\"M.Tansley\" {$6=$6-1} {print $1,$6,$7}' grade.txt\nM.Tansley 39 44\nJ.Lulu 24 26\nP.Bunny 35 28\nJ.Troll 26 26\nL.Tansley 30 28\n</code></pre> <p>\u5982\u679c\u53ea\u60f3\u6253\u5370\u4fee\u6539\u7684\u6761\u76ee\uff0c\u53ef\u5c06 print \u7ea6\u675f\u5230\u6761\u4ef6\u5224\u65ad\u624d\u6267\u884c\uff1a</p> <pre><code># #awk '{if($1==\"M.Tansley\") {$6=$6-1; print $1,$6,$7}}' grade.txt\n$ awk '$1==\"M.Tansley\"{$6=$6-1; print $1,$6,$7}' grade.txt\nM.Tansley 39 44\n</code></pre> <p>\u4fee\u6539\u6587\u672c\u57df\u5373\u5bf9\u5176\u91cd\u65b0\u8d4b\u503c\uff0c\u9700\u8981\u505a\u7684\u5c31\u662f\u8d4b\u7ed9\u4e00\u4e2a\u65b0\u7684\u5b57\u7b26\u4e32\u3002 \u5728 J.Troll \u4e2d\u52a0\u5165\u5b57\u6bcd\uff0c\u4f7f\u5176\u6210\u4e3a J.L.Troll\uff0c\u8868\u8fbe\u5f0f\u4e3a <code>$1=\"J.L.Troll\"</code>\uff0c\u8bb0\u4f4f\u5b57\u7b26\u4e32\u8981\u4f7f\u7528\u53cc\u5f15\u53f7\uff08<code>\"\"</code>\uff09\uff0c\u5e76\u7528\u5706\u62ec\u53f7\uff08<code>()</code>\uff09\u62ec\u8d77\u6574\u4e2a\u8d4b\u503c\u8bed\u53e5\u3002</p> <pre><code>$ #awk '{if($1==\"J.Troll\") ($1=\"J.L.Troll\"); print $1}' grade.txt\n$ awk '$1==\"J.Troll\" { ($1=\"J.L.Troll\") } { print $1}' grade.txt\nM.Tansley\nJ.Lulu\nP.Bunny\nJ.L.Troll\nL.Tansley\n</code></pre> <p>\u4fee\u6539\u4e00\u4e0b\uff0c\u53ea\u6253\u5370\u4fee\u6539\u90e8\u5206\uff1a</p> <pre><code>$ #awk '{if($1==\"J.Troll\") { ($1=\"J.L.Troll\"); print $1 } }' grade.txt\n$ awk '$1==\"J.Troll\" { ($1=\"J.L.Troll\"); print $1 }' grade.txt\nJ.L.Troll\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-control/#\u521b\u5efa\u65b0\u57df","title":"\u521b\u5efa\u65b0\u57df","text":"<p>\u5728 awk \u4e2d\u5904\u7406\u6570\u636e\u65f6\uff0c\u57fa\u4e8e\u5404\u57df\u8fdb\u884c\u8ba1\u7b97\u65f6\u521b\u5efa\u65b0\u57df\u662f\u4e00\u79cd\u597d\u4e60\u60ef\u3002 \u521b\u5efa\u65b0\u57df\u8981\u901a\u8fc7\u5176\u4ed6\u57df\u8d4b\u4e88\u65b0\u57df\u6807\u8bc6\u7b26\uff0c\u5982\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8e\u5176\u4ed6\u57df\u7684\u52a0\u6cd5\u65b0\u57df <code>{$4=$2+$3}</code>\uff0c\u8fd9\u91cc\u5047\u5b9a\u8bb0\u5f55\u5305\u542b3\u4e2a\u57df\uff0c\u5219\u57df4\u4e3a\u65b0\u5efa\u57df\uff0c\u4fdd\u5b58\u57df2\u548c\u57df3\u76f8\u52a0\u7ed3\u679c\u3002 \u4ee5\u4e0b\u793a\u4f8b\uff0c\u5728\u6587\u4ef6 grade.txt \u4e2d\u521b\u5efa\u65b0\u57df8\u4fdd\u5b58\u57df\u76ee\u524d\u7ea7\u522b\u5206\u4e0e\u57df\u6700\u9ad8\u7ea7\u522b\u5206\u7684\u51cf\u6cd5\u503c\uff0c\u8868\u8fbe\u5f0f\u4e3a <code>{$8=$7-$6}</code>\u3002</p> <pre><code>$ #awk 'BEGIN{print \"Name\\t Difference\"} {if($6&lt;$7){$8=$7-$6; print $1,$8}}' grade.txt\n$ awk 'BEGIN{print \"Name\\t   Difference\"} $6&lt;$7 {$8=$7-$6; printf \"%-10s %s\\n\",$1,$8}' grade.txt\nName       Difference\nM.Tansley  4\nJ.Lulu     2\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-control/#for","title":"for","text":"<p>for \u8bed\u53e5\u662f\u8bb8\u591a\u7f16\u7a0b\u8bed\u8a00\u6267\u884c\u5faa\u73af\u7684\u5e38\u89c1\u65b9\u6cd5\u3002 awk\u7f16\u7a0b\u8bed\u8a00\u652f\u6301C\u98ce\u683c\u7684for\u5faa\u73af\u3002</p> <pre><code>for( variable assignment; condition; iteration process)\n</code></pre> <p>\u5c06\u591a\u4e2a\u529f\u80fd\u5408\u5e76\u5230\u4e00\u4e2a\u8bed\u53e5\u6709\u52a9\u4e8e\u7b80\u5316\u5faa\u73af\u3002</p> <p>\u793a\u4f8b1\uff1afor \u5faa\u73af\u6570\u7ec4\u5143\u7d20</p> <pre><code>$ awk 'BEGIN{\n    var[\"a\"] = 1\n    var[\"g\"] = 2\n    var[\"m\"] = 3\n    var[\"u\"] = 4\n    for (test in var)\n    {\n        print \"Index:\",test,\" - Value:\",var[test]\n    }\n}'\n</code></pre> <p>\u793a\u4f8b2: for \u5faa\u73af\u7edf\u8ba1\u6bcf\u6761\u8bb0\u5f55\u57df5\u548c\u57df6\u5e73\u5747\u503c\u3002</p> <pre><code>awk '{\n    total = 0\n    for (i=5; i&lt;7; i++)\n    {\n        total += $i\n    }\n    avg = total / 2\n    print \"Average:\",avg\n}' grade.txt\nAverage: 24\nAverage: 16.5\nAverage: 23.5\nAverage: 19\nAverage: 21\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-control/#while","title":"while","text":"<p>while \u8bed\u53e5\u4e3a awk \u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u57fa\u672c\u7684\u5faa\u73af\u529f\u80fd\u3002\u4e0b\u9762\u662fwhile\u8bed\u53e5\u7684\u683c\u5f0f\u3002</p> <pre><code>while (condition) { statements }\n</code></pre> <p>while \u5faa\u73af\u5141\u8bb8\u904d\u5386\u4e00\u7ec4\u6570\u636e\uff0c\u5e76\u68c0\u67e5\u8fed\u4ee3\u7684\u7ed3\u675f\u6761\u4ef6\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u7edf\u8ba1\u6bcf\u4e00\u6761\u8bb0\u5f55\u4e2d\u5404\u4e2a\u57df\u52a0\u548c\u5e73\u5747\u503c\uff1a</p> <pre><code>$ cat data5\n130 120 135\n160 113 140\n145 170 215\n\n$ awk '{\n    total = 0\n    i = 1\n    while (i &lt;= NF)\n    {\n        total += $i\n        i++\n    }\n    avg = total / 3\n    print \"Average:\",avg\n}' data5\nAverage: 128.333\nAverage: 137.667\nAverage: 176.667\n</code></pre> <p>awk \u7f16\u7a0b\u8bed\u8a00\u652f\u6301\u5728 while \u5faa\u73af\u4e2d\u4f7f\u7528 <code>break</code> \u8bed\u53e5\u548c <code>continue</code> \u8bed\u53e5\uff0c\u5141\u8bb8\u4ece\u5faa\u73af\u4e2d\u8df3\u51fa\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-control/#do-while","title":"do-while","text":"<p>do-while \u8bed\u53e5\u7c7b\u4f3c\u4e8e while \u8bed\u53e5\uff0c\u4f46\u4f1a\u5728\u68c0\u67e5\u6761\u4ef6\u8bed\u53e5\u4e4b\u524d\u6267\u884c\u547d\u4ee4\u3002</p> <p>\u4e0b\u9762\u662f do-while \u8bed\u53e5\u7684\u683c\u5f0f\u3002</p> <pre><code>do {\n    statements\n} while (condition)\n</code></pre> <p>\u8fd9\u79cd\u683c\u5f0f\u4fdd\u8bc1\u4e86\u8bed\u53e5\u4f1a\u5728\u6761\u4ef6\u88ab\u6c42\u503c\u4e4b\u524d\u81f3\u5c11\u6267\u884c\u4e00\u6b21\u3002 \u5f53\u9700\u8981\u5728\u6c42\u503c\u6761\u4ef6\u524d\u6267\u884c\u8bed\u53e5\u65f6\uff0c\u8fd9\u4e2a\u7279\u6027\u975e\u5e38\u65b9\u4fbf\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-control/#\u683c\u5f0f\u5316\u8f93\u51fa\u63a7\u5236","title":"\u683c\u5f0f\u5316\u8f93\u51fa\u63a7\u5236","text":"<p>gawk Examples Using printf How can I format the output of a bash command in neat columns </p> <p>print \u6253\u5370\u8bed\u53e5\u7684\u591a\u4e2a\u90e8\u5206\uff08\u5e38\u91cf\u548c\u53d8\u91cf\uff09\u4e4b\u95f4\u8981\u7528\u9017\u53f7\u5206\u9694\uff0c\u9017\u53f7\u524d\u540e\u4f1a\u81ea\u52a8\u6dfb\u52a0\u7a7a\u884c\uff1a</p> <pre><code>$ awk '{if($6&lt;$7) print $1, \"Try better at the next comp\"}' grade.txt\nM.Tansley Try better at the next comp\nJ.Lulu Try better at the next comp\n</code></pre> <p>\u4ee5\u4e0a\u5982\u679c\u4e0d\u52a0\u9017\u53f7\uff0cTry \u548c\u524d\u9762\u7684\u540d\u79f0\u4f1a\u8fde\u5728\u4e00\u8d77\u3002</p> <p>\u4ee5\u4e0b <code>\"NR=\"NR</code>\uff0c\u5e38\u91cf\u4e32\u548c\u53d8\u91cf\uff08\u4e0d\u7528$\u7b26\u53f7\u5f15\u7528\uff09\u53ef\u4ee5\u8fde\u5728\u4e00\u8d77\u4e0d\u7528\u63d2\u5165\u9017\u53f7\u3002</p> <pre><code>$ awk 'BEGIN{FS=\",\"} {print $1,\"FNR=\"FNR,\"NR=\"NR}' data1 data1\n</code></pre> <p>for \u5faa\u73af\u793a\u4f8b\u4e2d\u7684 <code>print \"Index:\",test,\" - Value:\",var[test]</code> \u4e2d\u95f4\u90a3\u4e2a\u7a7a\u884c\u53ef\u4ee5\u7701\u6389\u3002</p> <p>\u8c03\u7528 print \u6253\u5370\u591a\u884c\u65f6\uff0c\u6bcf\u6761 print \u8bed\u53e5\u4ee5\u5206\u53f7\u6307\u793a\u7ed3\u675f\uff1a</p> <pre><code>$ awk 'BEGIN {print \"The data2 File Contents:\"; print \"==========\"}\n$ awk 'END {print \"end-of-record, NR=\"NR}' data1\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-control/#\u683c\u5f0f\u5316\u8f93\u51faprintf","title":"\u683c\u5f0f\u5316\u8f93\u51fa\uff08printf\uff09","text":"<p>\u5982\u679c\u8981\u521b\u5efa\u8be6\u5c3d\u7684\u62a5\u8868\uff0c\u53ef\u4ee5\u4f7f\u7528\u683c\u5f0f\u5316\u6253\u5370\u547d\u4ee4 <code>printf</code>\uff0c\u4e3a\u6570\u636e\u9009\u62e9\u7279\u5b9a\u7684\u683c\u5f0f\u548c\u4f4d\u7f6e\u8fdb\u884c\u8f93\u51fa\u3002 \u5982\u679c\u4f60\u719f\u6089C\u8bed\u8a00\u7f16\u7a0b\u7684\u8bdd\uff0cawk \u4e2d\u7684 printf \u547d\u4ee4\u7528\u6cd5\u4e5f\u662f\u4e00\u6837\uff0c\u5141\u8bb8\u6307\u5b9a\u5177\u4f53\u5982\u4f55\u663e\u793a\u6570\u636e\u7684\u6307\u4ee4\u3002  </p> <pre><code>    print [ expression-list ] [ &gt; expression ]\n    printf format [ , expression-list ] [ &gt; expression ]\n</code></pre> <p><code>printf</code> \u547d\u4ee4\u683c\u5f0f\uff1a</p> <pre><code>    printf \"format string\", var1, var2, ...\n</code></pre> <p><code>format string</code> \u662f\u683c\u5f0f\u5316\u8f93\u51fa\u7684\u5173\u952e\uff0c\u5b83\u4f1a\u7528\u6587\u672c\u5143\u7d20\u548c\u683c\u5f0f\u5316\u6307\u5b9a\u7b26\u6765\u5177\u4f53\u6307\u5b9a\u5982\u4f55\u5448\u73b0\u683c\u5f0f\u5316\u8f93\u51fa\u3002  </p> <p>\u683c\u5f0f\u5316\u6307\u5b9a\u7b26\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u4ee3\u7801\uff0c\u4f1a\u6307\u660e\u663e\u793a\u4ec0\u4e48\u7c7b\u578b\u7684\u53d8\u91cf\u4ee5\u53ca\u5982\u4f55\u663e\u793a\u3002 awk \u7a0b\u5e8f\u4f1a\u5c06\u6bcf\u4e2a\u683c\u5f0f\u5316\u6307\u5b9a\u7b26\u4f5c\u4e3a\u5360\u4f4d\u7b26\uff0c\u4f9b\u547d\u4ee4\u4e2d\u7684\u53d8\u91cf\u4f7f\u7528\u3002\u7b2c\u4e00\u4e2a\u683c\u5f0f\u5316\u6307\u5b9a\u7b26\u5bf9\u5e94\u5217\u51fa\u7684\u7b2c\u4e00\u4e2a\u53d8\u91cf\uff0c\u7b2c\u4e8c\u4e2a\u5bf9\u5e94\u7b2c\u4e8c\u4e2a\u53d8\u91cf\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002</p> <p><code>\u683c\u5f0f\u5316\u6307\u5b9a\u7b26</code> \u91c7\u7528\u5982\u4e0b\u683c\u5f0f\uff1a</p> <pre><code>%[modifier]control-letter\n</code></pre> <p>\u4ee5\u4e0b\u7528\u79d1\u5b66\u8ba1\u6570\u6cd5\u8f93\u51fa <code>10*100</code> \u7684\u8ba1\u7b97\u7ed3\u679c\uff1a</p> <pre><code>$ awk 'BEGIN{\n  x = 10 * 100;\n  printf \"The answer is: %e\\n\", x\n}'\nThe answer is: 1.000000e+03\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u5f3a\u5236\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u8f93\u51fa\u5bbd\u5ea6\u4e3a16\u4e2a\u5b57\u7b26\uff0c\u5e76\u4e14\u5de6\u5bf9\u9f50\u3002</p> <pre><code>$ awk 'BEGIN{FS=\"\\n\"; RS=\"\"} {printf \"%-16s %s\\n\", $1, $4}' data2\nRiley Mullen     (312)555-1234\nFrank Williams   (317)555-9876\nHaley Snell      (313)555-4938\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-control/#\u683c\u5f0f\u5316\u5b57\u7b26\u4e32sprintf","title":"\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff08sprintf\uff09","text":"<p><code>sprintf</code> \u51fd\u6570\u7528\u63d0\u4f9b\u7684 format \u548c variables \u8fd4\u56de\u4e00\u4e2a\u7c7b\u4f3c\u4e8e printf \u683c\u5f0f\u8f93\u51fa\u7684\u5b57\u7b26\u4e32\u3002</p> <pre><code>    sprintf(fmt, expr, ... )\n        the string resulting from formatting expr ...  according to the printf(3) format fmt\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-functions/","title":"Linux Command - awk functions","text":"<p>Linux \u4e0b\u7684 awk \u547d\u4ee4\u4e2d\u7684\u51fd\u6570\u8fd0\u7528\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#arith","title":"Arith","text":"","tags":["awk"]},{"location":"blog/20191105/awk-functions/#string","title":"String","text":"<p><code>asort</code>\u3001<code>asorti</code> \u548c <code>gensub</code> \u4e3a gawk \u7279\u6709\u51fd\u6570\uff0cmacOS awk \u4e0d\u652f\u6301\u3002</p> <p>\u76f8\u5173\u51fd\u6570\u68b3\u7406\u5982\u4e0b\uff1a</p> <p><code>gsub()</code> \u51fd\u6570\u6709\u70b9\u7c7b\u4f3c\u4e8e sed \u67e5\u627e\u548c\u66ff\u6362\u3002\u5b83\u5141\u8bb8\u66ff\u6362\u4e00\u4e2a\u5b57\u7b26\u4e32\u6216\u5b57\u7b26\u4e3a\u53e6\u4e00\u4e2a\u5b57\u7b26\u4e32\u6216\u5b57\u7b26\uff0c\u5e76\u4ee5\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5f62\u5f0f\u6267\u884c\u3002  </p> <p>\u7b2c\u4e00\u4e2a\u51fd\u6570\u4f5c\u7528\u4e8e\u8bb0\u5f55 <code>$0</code>\uff1b \u7b2c\u4e8c\u4e2a\u51fd\u6570\u5141\u8bb8\u6307\u5b9a\u76ee\u6807\uff0c\u82e5\u672a\u6307\u5b9a\u76ee\u6807\uff0c\u7f3a\u7701\u4e3a <code>$0</code>\u3002  </p> <p><code>index(s,t)</code> \u51fd\u6570\u8fd4\u56de\u76ee\u6807\u5b57\u7b26\u4e32 s \u4e2d\u67e5\u8be2\u5b57\u7b26\u4e32 t \u7684\u9996\u4f4d\u7f6e\u3002 <code>length(s)</code> \u51fd\u6570\u8fd4\u56de\u5b57\u7b26\u4e32 s \u7684\u5b57\u7b26\u957f\u5ea6\u3002 <code>match(s,r)</code> \u51fd\u6570\u6d4b\u8bd5\u5b57\u7b26\u4e32 s \u662f\u5426\u5305\u542b\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f r \u5b9a\u4e49\u7684\u5339\u914d\u3002 <code>split(s,a,fs)</code> \u4f7f\u7528\u57df\u5206\u9694\u7b26 fs \u5c06\u5b57\u7b26\u4e32s\u5212\u5206\u4e3a\u6307\u5b9a\u5e8f\u5217a\u3002 <code>sprintf(fmt,exp)</code> \u51fd\u6570\u7c7b\u4f3c\u4e8e printf \u51fd\u6570\uff0c\u8fd4\u56de\u57fa\u672c\u8f93\u51fa\u683c\u5f0f fmt \u7684\u7ed3\u679c\u5b57\u7b26\u4e32 exp\u3002 <code>sub(r,s)</code> \u51fd\u6570\u5c06\u7528 s \u66ff\u4ee3 <code>$0</code> \u4e2d\u6700\u5de6\u8fb9\u6700\u957f\u7684\u5b50\u4e32\uff0c\u8be5\u5b50\u4e32\u88ab\uff08r\uff09\u5339\u914d\u3002 <code>substr(s,p)</code> \u8fd4\u56de\u5b57\u7b26\u4e32 s \u5728\u4f4d\u7f6e p \u540e\u7684\u540e\u7f00\u3002 <code>substr(s,p,n)</code> \u540c\u4e0a\uff0c\u5e76\u6307\u5b9a\u5b50\u4e32\u957f\u5ea6\u4e3a n\u3002  </p>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#length","title":"length","text":"<p>\u8fd4\u56de\u6240\u9700\u5b57\u7b26\u4e32\u957f\u5ea6\u3002</p> <p>\u4ee5\u4e0b\u8fd4\u56de\u5e38\u91cf\u5b57\u7b26\u4e32\u957f\u5ea6\uff1a</p> <pre><code>$ awk 'BEGIN{print length(\"A FEW GOOD MEN\")}'\n14\n</code></pre> <p>\u4ee5\u4e0b\u68c0\u9a8c\u5b57\u7b26\u4e32 J.Troll \u8fd4\u56de\u540d\u5b57\u53ca\u5176\u957f\u5ea6\uff0c\u5373\u4eba\u540d\u6784\u6210\u7684\u5b57\u7b26\u4e2a\u6570\u3002</p> <pre><code>$ awk '$1==\"J.Troll\"{print length($1),$1}' grade.txt\n7 J.Troll\n\n$ awk '$1==\"J.Troll\"{print \"length(\",$1,\") =\",length($1)}' grade.txt\nlength( J.Troll ) = 7\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#index","title":"index","text":"<p>\u67e5\u8be2\u5b57\u7b26\u4e32s\u4e2dt\u51fa\u73b0\u7684\u7b2c\u4e00\u4f4d\u7f6e\uff0c\u5fc5\u987b\u7528\u53cc\u5f15\u53f7\u5c06\u5b57\u7b26\u4e32\u62ec\u8d77\u6765\u3002</p> <pre><code>$ awk 'BEGIN{print index(\"Bunny\",\"ny\")}'\n4\n</code></pre> <p>\u6ce8\u610f\uff1a\u7d22\u5f15\u4ece1\u5f00\u59cb\u3002</p> <p>shell \u67e5\u627e\u5b57\u7b26\u4e32\u4e2d\u5b57\u7b26\u51fa\u73b0\u7684\u4f4d\u7f6e</p> <pre><code>$ test=\"cat\"\n$ sentence=\"The cat sat on the mat\"\n$ index=`awk -v a=\"$sentence\" -v b=\"$test\" 'BEGIN{print index(a,b)}'`\n$ echo $index\n5\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#match","title":"match","text":"<p>match \u6d4b\u8bd5\u76ee\u6807\u5b57\u7b26\u4e32\u662f\u5426\u5305\u542b\u67e5\u627e\u5b57\u7b26\u7684\u4e00\u90e8\u5206\u3002 \u53ef\u4ee5\u5bf9\u67e5\u627e\u90e8\u5206\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u503c\u4e3a\u6210\u529f\u51fa\u73b0\u7684\u5b57\u7b26\uff08\u5b50\u4e32\uff09\u7d22\u5f15\u4f4d\u7f6e\u3002\u5982\u679c\u672a\u627e\u5230\uff0c\u5219\u8fd4\u56de 0\u3002</p> <pre><code># \u5728 ANCD \u4e2d\u67e5\u627e d\n$ awk 'BEGIN{print match(\"ANCD\", /d/)}'\n0\n\n# \u5728 ANCD \u4e2d\u67e5\u627e C\n$ awk 'BEGIN{print match(\"ANCD\", /C/)}'\n3\n\n# \u5728\u5b66\u751f J.Lulu \u4e2d\u67e5\u627e\u5b50\u4e32 u\n$ awk '$1==\"J.Lulu\"{print match($1, \"u\")}' grade.txt\n4\n\n# \u5728\u5b66\u751f J.Lulu \u4e2d\u67e5\u627e\u5b50\u4e32 lu\n$ awk '$1==\"J.Lulu\"{print match($1, \"lu\")}' grade.txt\n5\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#\u591a\u884c\u5212\u5206\u533a\u5757\u5220\u9664","title":"\u591a\u884c\u5212\u5206\u533a\u5757\u5220\u9664","text":"<p>\u5728 awk-pattern \u4e2d\u7684 \u591a\u884c\u5212\u5206\u533a\u5757 \u793a\u4f8b\u4e2d\uff0c\u57fa\u4e8e <code>- path:</code> \u5212\u5206\u533a\u5757\u3002</p> <pre><code>$ awk 'BEGIN {RS=\"- path: \"; FS=\"\\n\"; ORS=\"\"} $1~/\\/Classes\\/ui\\/DeviceMgr\\//' bak.code.yml\n</code></pre> <p>\u7559\u4e0b\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u4f55\u8fdb\u4e00\u6b65\u57fa\u4e8e awk \u547d\u4ee4\u79fb\u9664\u8fd9\u4e9b\u5339\u914d\u7684 CR \u89c4\u5219\u533a\u5757\u8bb0\u5f55\u5462\uff1f</p> <p>sed \u5929\u7136\u9002\u5408\u7528\u6765\u6267\u884c\u6b64\u7c7b\u533a\u5757\u5339\u914d\u53ca\u5220\u9664\u64cd\u4f5c\uff1a</p> <pre><code># \u6307\u5b9a\u5907\u4efd\u6269\u5c55\u540d\u4e3a\u7a7a\uff0c\u5373\u4e0d\u5907\u4efd\nsed -i '' '/- path: \\/Classes\\/ui\\/DeviceMgr\\//,/owner_rule/d' bak.code.yml\n</code></pre> <p>\u7531\u4e8e awk \u6ca1\u6709\u76f4\u63a5\u7684\u5220\u9664\u547d\u4ee4\uff0c\u56e0\u6b64\u65e0\u6cd5\u6a21\u5f0f\u5339\u914d\u5220\u9664\uff0c\u76f8\u5e94\u7684\u7b49\u6548\u5b9e\u73b0\u7a0d\u663e\u590d\u6742\u3002 \u53ea\u80fd\u53cd\u5411\u5339\u914d\u5269\u4f59\u7684\u8bb0\u5f55\uff0c\u7531\u4e8e\u533a\u5757\u8bb0\u5f55\u5206\u9694\u7b26\u81ea\u8eab\u4e0d\u5728\u5339\u914d\u8bb0\u5f55\u4e2d\uff0c\u9700\u8981\u60f3\u529e\u6cd5\u8865\u9f50\u5206\u5272\u6389\u7684 RS \u524d\u7f00\u3002</p> <ol> <li>\u9996\u5148\u4f7f\u7528\u57df\u6a21\u5f0f\u7684\u5426\u5b9a\u5339\u914d\uff0c\u8fc7\u6ee4\u51fa\u6240\u6709\u4e0d\u5305\u542b <code>/Classes/ui/DeviceMgr/</code> \u7684\u76ee\u5f55\uff0c\u5373\u9700\u8981\u4fdd\u7559\u7684\uff1b  </li> <li>\u7531\u4e8e .code.yml \u6587\u4ef6\u5f00\u5934\u6709\u4e00\u5927\u6bb5\u89c4\u5219\u63cf\u8ff0\uff0c\u6545\u5ffd\u7565\u6389\u7b2c1\u4e2a <code>- path:</code> \u4e4b\u524d\u7684\u7b2c1\u6761\u8bb0\u5f55\uff0c\u76f8\u5f53\u4e8e <code>if (NR==1) next;</code> \u76f4\u63a5\u6253\u5370\u7b2c1\u6761\u8bb0\u5f55\uff1b  </li> <li>\u5982\u679c\u8bb0\u5f55\u5757\u7684\u7b2c1\u884c\u4ee5 <code>/</code> \u5f00\u5934\uff08\u5408\u8d77\u6765\u5c31\u662f <code>- path: /xxx</code>\uff09\uff0c\u6216\u7b2c2\u884c\u5305\u542b <code>owners:</code>\uff08\u7b2c1\u884c\u8def\u5f84\u53ef\u80fd\u975e\u659c\u6760\u5f00\u5934\uff0c\u4e5f\u53ef\u80fd\u662f\u884c\u53f7\uff09\uff0c\u5219\u8865\u9f50\u5207\u5272\u6389\u7684 RS \u524d\u7f00\uff08<code>- path:</code>\uff09\uff0c\u5e76\u4e14\u6253\u5370\u8be5\u6761\u8bb0\u5f55\uff1b\u4e0d\u5339\u914d\u7684\u5219\u76f4\u63a5\u6253\u5370\u8be5\u8bb0\u5f55\u5757\u3002  </li> </ol> <pre><code># \u8c03\u8bd5\nawk 'BEGIN {RS=\"- path: \"; FS=\"\\n\"; ORS=\"\"; OFS=\"\\n\"}\n    $1 !~ /\\/Classes\\/ui\\/DeviceMgr\\// {\n        if (NR &gt; 1 &amp;&amp; (index($1, \"/\")==1 || index($2, \"owners:\")))\n            $1=\"- path: \"$1;\n        print $0\n    }' bak.code.yml | more\n</code></pre> <p>\u8c03\u8bd5OK\u540e\uff0c\u53ef\u5c06\u79fb\u9664\u5339\u914d\u533a\u5757\u540e\u7684\u5185\u5bb9\u91cd\u5b9a\u5411\u8f93\u51fa\u5230\u65b0\u7684\u6587\u4ef6\uff1a</p> <pre><code>awk 'BEGIN {RS=\"- path: \"; FS=\"\\n\"; ORS=\"\"; OFS=\"\\n\"}\n    $1 !~ /\\/Classes\\/ui\\/DeviceMgr\\// {\n        if (NR &gt; 1 &amp;&amp; (index($1, \"/\")==1 || index($2, \"owners:\")))\n            $1=\"- path: \"$1;\n        print $0\n    }' bak.code.yml &gt; rm.code.yml\n</code></pre> <p>\u6267\u884c <code>diff bak.code.yml rm.code.yml</code> \u6216 <code>code --diff bak.code.yml rm.code.yml</code> \u5bf9\u6bd4\uff0c\u6821\u9a8c\u79fb\u9664\u662f\u5426\u7b26\u5408\u9884\u671f\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#substr","title":"substr","text":"<p>\u8fd4\u56de\u5e38\u91cf\u5b57\u7b26\u4e32\u4ece\u6307\u5b9a\u7d22\u5f15\u5f00\u59cb\u7684\u540e\u7f00\uff1a</p> <pre><code>awk 'BEGIN{STR=\"A FEW GOOD MEN\"; print substr(STR,7)}'\nGOOD MEN\n</code></pre> <p>\u4ee5\u4e0b\u4e3a index \u548c substr \u7efc\u5408\u793a\u4f8b\uff1a</p> <pre><code># a \u5728\u53e5\u5b50\u4e2d\u7684\u7d22\u5f15\u4f4d\u7f6e\n$ echo 'This is a test' | awk '{print index($0,$3)}'\n9\n\n# \u4ece a \u7d22\u5f15\u5f00\u59cb\u81f3\u672b\u5c3e\u7684\u5b50\u4e32\n$ echo 'This is a test' | awk '{print substr($0, index($0,$3))}'\na test\n\n# \u4ece a \u7d22\u5f15\u5f00\u59cb\u957f\u5ea6\u4e3a4\u7684\u5b50\u4e32\necho 'This is a test' | awk '{print substr($0, index($0,$3), 4)}'\na te\n</code></pre> <p>\u8fd4\u56de\u4ece1\u5f00\u59cb\u957f\u5ea6\u4e3a5\u7684\u5b50\u4e32\uff1a</p> <pre><code>$ awk '$1==\"L.Tansley\"{print substr($1,1,5)}' grade.txt\nL.Tan\n</code></pre> <p>substr \u7684\u53e6\u4e00\u79cd\u5f62\u5f0f\u662f\u8fd4\u56de\u5b57\u7b26\u4e32\u540e\u7f00\u6216\u6307\u5b9a\u4f4d\u7f6e\u540e\u9762\u5b57\u7b26\u3002</p> <pre><code>$ awk '{print substr($1, 3)}' grade.txt\nTansley\nLulu\nBunny\nTroll\nTansley\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#pipe","title":"pipe","text":"<pre><code>$ echo \"Stand-by\" | awk '{print length($0)}'\n8\n$ STR=\"mydoc.txt\"\n$ echo $STR | awk '{print substr($0,1,5)}'\nmydoc\n$ echo $STR | awk '{print substr($0,7)}'\ntxt\n</code></pre> <p>\u4ee5\u4e0b\u4e3a index \u548c substr \u7efc\u5408\u793a\u4f8b\uff0c\u57fa\u4e8e\u6587\u4ef6\u540d\u5206\u9694\u7b26\u5207\u5206\u6587\u4ef6\u540d\u548c\u540e\u7f00\uff1a</p> <pre><code>echo $STR | awk '{\n    l=length($0)\n    i=index($0,\".\")\n    prefix=substr($0,1,i-1)\n    suffix=substr($0,i+1)\n    print \"prefix=\"prefix,\"suffix=\"suffix\n}'\nprefix=mydoc suffix=txt\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#split","title":"split","text":"<p>\u4f7f\u7528 split \u8fd4\u56de\u5b57\u7b26\u4e32\u6570\u7ec4\u5143\u7d20\u4e2a\u6570\u3002</p> <p>\u5de5\u4f5c\u65b9\u5f0f\u5982\u4e0b\uff1a\u5982\u679c\u6709\u4e00\u5b57\u7b26\u4e32\uff0c\u5305\u542b\u4e00\u6307\u5b9a\u5206\u9694\u7b26 <code>-</code>\uff0c\u4f8b\u5982 <code>AD2-KP9-JU2-LP-1</code>\uff0c\u5c06\u4e4b\u5212\u5206\u6210\u4e00\u4e2a\u6570\u7ec4\u3002 \u4f7f\u7528 split\uff0c\u6307\u5b9a\u5206\u9694\u7b26\u53ca\u6570\u7ec4\u540d\uff0c\u8fd4\u56de\u6570\u7ec4\u4e0b\u6807\u6570\uff0c\u8fd9\u91cc\u7ed3\u679c\u4e3a4\u3002</p> <pre><code>$ awk 'BEGIN{print split(\"123#456#789\",myarray,\"#\")}'\n3\n$ awk 'BEGIN{print split(\"AD2-KP9-JU2-LP-1\",parts_array,\"-\")}'\n5\n</code></pre> <p>for \u5faa\u73af\u904d\u5386\u6570\u7ec4\uff1a</p> <pre><code>awk 'BEGIN{\n    print split(\"AD2-KP9-JU2-LP-1\",parts_array,\"-\")\n    for (i in parts_array)\n    {\n        print \"Index:\",i,\"- Value:\",parts_array[i]\n    }\n}'\n5\nIndex: 2 - Value: KP9\nIndex: 3 - Value: JU2\nIndex: 4 - Value: LP\nIndex: 5 - Value: 1\nIndex: 1 - Value: AD2\n</code></pre> <p>\u63a5\u4e0a\u8ff0\u57fa\u4e8e pipe \u4eceshell\u4e2d\u5411awk\u4f20\u5165\u5b57\u7b26\u4e32\u7684\u4f8b\u5b50\uff0c\u57fa\u4e8e <code>split</code> \u51fd\u6570\u5206\u5272\u6587\u4ef6\u540d\u548c\u540e\u7f00\uff1a</p> <pre><code>echo $STR | awk '{\n    print split($0,components,\".\")\n    print \"prefix=\"components[\"1\"],\"suffix=\"components[\"2\"]\n}'\n2\nprefix=mydoc suffix=txt\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#sub","title":"sub","text":"<p>\u4f7f\u7528 sub \u53d1\u73b0\u5e76\u66ff\u6362\u6a21\u5f0f\u7684 \u7b2c\u4e00\u6b21 \u51fa\u73b0\u4f4d\u7f6e\u3002</p> <pre><code># \u6a21\u5f0f op \u7b2c\u4e00\u6b21\u51fa\u73b0\u65f6\uff0c\u8fdb\u884c\u66ff\u6362\n$ awk 'BEGIN{STR=\"poped popo pill\"; sub(/op/,\"OP\",STR); print STR}'\npOPed popo pill\n</code></pre> <p>\u5339\u914d\u8bb0\u5f55\uff08<code>$0</code>\uff09\u4e2d\u7b2c\u4e00\u5904\u51fa\u73b0\u7684\u6a21\u5f0f <code>4842</code>\uff0c\u8fdb\u884c\u66ff\u6362</p> <pre><code>$ awk 'sub(/4842/,4899)' grade.txt\nJ.Troll     07/99   4899    Brown-3     12  26  26\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#gsub","title":"gsub","text":"<p>gsub \u76f8\u5bf9 sub\uff0c\u591a\u4e86\u4e2a g \u6807\u5fd7\uff0c\u53d1\u73b0\u5e76\u66ff\u6362\u8bb0\u5f55\u4e2d\u6240\u6709\u5339\u914d\u6a21\u5f0f\u7684\u5730\u65b9\u3002</p> <pre><code># \u6a21\u5f0f op \u6240\u6709\u51fa\u73b0\u7684\u5730\u65b9\uff0c\u90fd\u8fdb\u884c\u66ff\u6362\n$ awk 'BEGIN{STR=\"poped popo pill\"; gsub(/op/,\"OP\",STR); print STR}'\npOPed pOPo pill\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-functions/#user-defined","title":"user-defined","text":"<p>\u51fd\u6570\u5b9a\u4e49\u4f5c\u4e3a\u72ec\u7acb\u90e8\u5206\uff0c\u72ec\u7acb\u4e8e begin\u3001body\u3001end \u90e8\u5206\uff1a</p> <pre><code>$ awk '\n    function myprint()\n    {\n        printf \"%-16s - %s\\n\", $1, $4\n    }\n    BEGIN{FS=\"\\n\"; RS=\"\"}\n    {\n        myprint()\n    }' data2\nRiley Mullen     - (312)555-1234\nFrank Williams   - (317)555-9876\nHaley Snell      - (313)555-4938\n</code></pre> <p>\u53ef\u4ee5\u53c2\u8003 awk trim \u51fd\u6570\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/","title":"Linux Command - awk pattern","text":"<p>Linux \u4e0b\u7684 awk \u547d\u4ee4\u4e2d\u7684\u6a21\u5f0f\u5339\u914d\u3002</p> <pre><code>pattern { action }\n</code></pre> <p><code>pattern</code> \u53ef\u4e3a\u903b\u8f91\u8fd0\u7b97\u8868\u8fbe\u5f0f\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u3002</p> <pre><code>$ cat grade.txt\nM.Tansley   05/99   48311   Green       8   40  44\nJ.Lulu      06/99   48317   green       9   24  26\nP.Bunny     02/99   48      Yellow      12  35  28\nJ.Troll     07/99   4842    Brown-3     12  26  26\nL.Tansley   05/99   4712    Brown-2     12  30  28\n</code></pre> <p></p>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u57df\u5339\u914d","title":"\u57df\u5339\u914d","text":"<p>\u4e3a\u4f7f\u4e00\u57df\u53f7\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u4f7f\u7528\u7b26\u53f7 <code>~</code> \u540e\u7d27\u8ddf\u6b63\u5219\u8868\u8fbe\u5f0f\u3002 \u4e5f\u53ef\u4ee5\u7528 if \u8bed\u53e5\uff0cif \u540e\u9762\u7684\u6761\u4ef6\u7528 <code>()</code> \u62ec\u8d77\u6765\u3002</p> <pre><code>$ awk '{if($4~/Brown/) print $0}' grade.txt\nJ.Troll     07/99   4842    Brown-3     12  26  26\nL.Tansley   05/99   4712    Brown-2     12  30  28\n</code></pre> <p>\u6839\u636e <code>pattern { action }</code> \u7684\u8bed\u6cd5\uff0c\u53ef\u4ee5\u6539\u5199\u4e3a\u6807\u51c6\u8303\u5f0f\uff1a</p> <pre><code>awk '$4~/Brown/{print $0}' grade.txt\n</code></pre> <p>\u7f3a\u7701\u60c5\u51b5\u4e0b\uff0cawk \u5c06\u6253\u5370\u6240\u6709\u5339\u914d\u8bb0\u5f55\uff0c\u53ef\u4ee5\u7701\u7565\u52a8\u4f5c\u90e8\u5206\uff0c\u8fdb\u4e00\u6b65\u7b80\u5199\u5982\u4e0b\uff1a</p> <pre><code>awk '$4~/Brown/' grade.txt\n</code></pre> <p>\u5047\u5b9a\u8981\u4f7f\u5b57\u7b26\u4e32\u7cbe\u786e\u5339\u914d\uff0c\u6bd4\u5982\u8bf4\u67e5\u770b\u5b66\u751f\u5e8f\u53f7 48\uff0c\u6587\u4ef6\u4e2d\u6709\u8bb8\u591a\u5b66\u751f\u5e8f\u53f7\u5305\u542b 48\u3002 \u5982\u679c\u5728 field-3 \u4e2d\u67e5\u8be2\u5e8f\u53f748\uff0cawk \u5c06\u8fd4\u56de\u6240\u6709\u5e8f\u53f7\u5e2648\u7684\u8bb0\u5f55\uff1a</p> <pre><code># awk '{if($3~/48/) print $0}' grade.txt\n# awk '$3~/48/{print $0}' grade.txt\n$ awk '$3~/48/' grade.txt\nM.Tansley   05/99   48311   Green       8   40  44\nJ.Lulu      06/99   48317   green       9   24  26\nP.Bunny     02/99   48      Yellow      12  35  28\nJ.Troll     07/99   4842    Brown-3     12  26  26\n</code></pre> <p>\u4e3a\u4e86\u7cbe\u786e\u5339\u914d\uff0c\u9700\u8981\u4f7f\u7528 <code>==</code> \u5224\u65ad\uff1a</p> <pre><code># awk '{if($3==\"48\") print $0}' grade.txt\n# awk '$3==\"48\"{print $0}' grade.txt\n$ awk '$3==\"48\"' grade.txt\nP.Bunny     02/99   48      Yellow      12  35  28\n</code></pre> <p>\u6709\u65f6\u8981\u6d4f\u89c8\u4fe1\u606f\u5e76\u62bd\u53d6\u4e0d\u5339\u914d\u64cd\u4f5c\u7684\u8bb0\u5f55\uff0c\u4e0e <code>~</code> \u76f8\u53cd\u7684\u7b26\u53f7\u662f <code>!~</code>\uff0c \u610f\u5373\u4e0d\u5339\u914d\u3002  </p> <p>\u53ea\u5bf9 field-4 \u8fdb\u884c\u4e0d\u5339\u914d\u64cd\u4f5c\uff0c\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>$ awk '$4!~/Brown/' grade.txt\n</code></pre> <p>\u5982\u679c\u60f3\u8981\u67e5\u8be2\u975e Brown-2 \u7684\u8170\u5e26\u7ea7\u522b\uff0c\u53ef\u4f7f\u7528  <code>!=</code> \u5224\u65ad\uff1a</p> <pre><code>$ awk '$4!=\"Brown-2\"' grade.txt\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u591a\u884c\u5212\u5206\u533a\u5757","title":"\u591a\u884c\u5212\u5206\u533a\u5757","text":"<p>\u8003\u8651\u5de5\u7a0b\u6839\u76ee\u5f55\u4e0b\u6709\u4ee5\u4e0b code owner \u7684 CR \u914d\u7f6e\u6587\u4ef6 <code>bak.code.yml</code>\uff1a</p> <pre><code>- path: /Classes/ui/DeviceMgr/PrinterTableView.h\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n- path: /Classes/ui/DeviceMgr/PrinterTableView.m\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n- path: /Classes/ui/DeviceMgr/PrinterDeviceCell.h\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n- path: /Classes/ui/DeviceMgr/PrinterDeviceCell.m\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n</code></pre> <p>\u6267\u884c\u4ee5\u4e0b sed \u8bed\u53e5\u53ef\u4ee5\u754c\u5b9a\u76ee\u5f55 <code>/Classes/ui/DeviceMgr/</code> \u7684 CR \u5339\u914d\u89c4\u5219\u5757\u8bb0\u5f55\uff1a</p> <pre><code>$ sed -n '/- path: \\/Classes\\/ui\\/DeviceMgr\\//,/owner_rule/p' bak.code.yml\n</code></pre> <p>\u8003\u8651\u7528 awk \u7b49\u6548\u5b9e\u73b0\uff0c\u53ef\u4ee5\u4ee5 <code>- path:</code> \u4f5c\u4e3a\u8bb0\u5f55\u5206\u5272\u7b26\uff0c\u4ee5 <code>\\n</code> \u4f5c\u4e3a\u5b57\u6bb5\u5206\u5272\u7b26\uff0c\u5339\u914d\u6253\u5370\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>$ awk 'BEGIN {RS=\"- path: \"; FS=\"\\n\"; ORS=\"\"} $1~/\\/Classes\\/ui\\/DeviceMgr\\//' bak.code.yml\n/Classes/ui/DeviceMgr/PrinterTableView.h\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n/Classes/ui/DeviceMgr/PrinterTableView.m\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n/Classes/ui/DeviceMgr/PrinterDeviceCell.h\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n/Classes/ui/DeviceMgr/PrinterDeviceCell.m\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n</code></pre> <p>\u9ed8\u8ba4\u7684\u8f93\u51fa\u8bb0\u5f55\u5206\u5272\u7b26\u4e3a\u6362\u884c\u7b26\uff0c\u8f93\u51fa\u8bb0\u5f55\u4e4b\u95f4\u6709\u7a7a\u884c\u3002\u8bbe\u7f6e\u4e86 <code>ORS=\"\"</code> \u540e\uff0c\u8f93\u51fa\u8bb0\u5f55\u4e4b\u95f4\u65e0\u7a7a\u884c\u3002</p> <p>\u4ee5\u4e0a\u8f93\u51fa\u53ef\u4ee5\u770b\u5230\uff0c\u5757\u8bb0\u5f55\u7684\u7b2c1\u884c\u7f3a\u5c11\u5206\u9694\u7b26 RS \u524d\u7f00\uff0c\u8003\u8651\u8865\u4e0a\uff1a</p> <pre><code>awk 'BEGIN {RS=\"- path: \"; FS=\"\\n\"; ORS=\"\"; OFS=\"\\n\"}\n    $1~/\\/Classes\\/ui\\/DeviceMgr\\//{\n        $1=\"- path: \"$1;\n        print $0\n    }' bak.code.yml\n</code></pre> <p>\u601d\u8003\uff1a\u5982\u4f55\u8fdb\u4e00\u6b65\u57fa\u4e8e awk \u547d\u4ee4\u79fb\u9664\u8fd9\u4e9b\u5339\u914d\u7684 CR \u89c4\u5219\u533a\u5757\u8bb0\u5f55\u5462\uff1f</p>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u8bb0\u5f55\u5339\u914d","title":"\u8bb0\u5f55\u5339\u914d","text":"<p>\u8868\u8fbe\u5f0f <code>$0 ~/Brown/</code>\uff0c\u610f\u5373\u67e5\u8be2\u5305\u542b\u6a21\u5f0f Brown \u8170\u5e26\u7ea7\u522b\u7684\u8bb0\u5f55\u5e76\u6253\u5370\u5b83\uff1b \u8868\u8fbe\u5f0f <code>$0 !~/Brown/</code>\uff0c\u610f\u5373\u67e5\u8be2\u4e0d\u5305\u542b\u6a21\u5f0f Brown \u8170\u5e26\u7ea7\u522b\u7684\u8bb0\u5f55\u5e76\u6253\u5370\u5b83\uff1b  </p> <pre><code>$ awk '$0~/Brown/' grade.txt\nJ.Troll     07/99   4842    Brown-3     12  26  26\nL.Tansley   05/99   4712    Brown-2     12  30  28\n\n$ awk '$0!~/Brown/' grade.txt\nM.Tansley   05/99   48311   Green       8   40  44\nJ.Lulu      06/99   48317   green       9   24  26\nP.Bunny     02/99   48      Yellow      12  35  28\n</code></pre> <p>\u5bf9\u4e8e\u6574\u6761\u8bb0\u5f55\u800c\u975e\u67d0\u4e2a\u57df\u5b57\u6bb5\u8fdb\u884c\u5339\u914d\u65f6\uff0c\u53ef\u4ee5\u7701\u7565 <code>$0</code> \u4e0d\u5199\u3002</p> <ol> <li>\u5339\u914d\u8bb0\u5f55\uff1a<code>awk '/Brown/' grade.txt</code> </li> <li>\u4e0d\u5339\u914d\u8bb0\u5f55\uff1a<code>awk '!/Brown/' grade.txt</code> </li> </ol>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u6a21\u5f0f\u5339\u914d\u533a\u95f4","title":"\u6a21\u5f0f\u5339\u914d\u533a\u95f4","text":"<p>\u8981\u6253\u5370\u5904\u4e8e start_pattern \u4e0e end_pattern \u4e4b\u95f4\u7684\u6587\u672c\uff0c\u53ef\u4f7f\u7528\u4e0b\u9762\u7684\u8bed\u6cd5\uff1a</p> <pre><code>$ awk '/start_pattern/, /end _pattern/' filename\n</code></pre> <p>\u4f8b\u5982\uff0c\u7b5b\u9009\u6253\u5370 .code.yml \u4e2d\u76ee\u5f55 <code>/Classes/ui/DeviceMgr/</code> \u7684 CR \u5339\u914d\u89c4\u5219\u5757\u8bb0\u5f55\uff1a</p> <pre><code>$ awk '/- path: \\/Classes\\/ui\\/DeviceMgr\\//,/owner_rule/' bak.code.yml\n</code></pre> <p>\u7b49\u4ef7\u7684 sed \u8868\u8fbe\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>$ sed -n '/- path: \\/Classes\\/ui\\/DeviceMgr\\//,/owner_rule/p' bak.code.yml\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u5339\u914d\u548c\u4e0d\u5339\u914d","title":"\u5339\u914d\u548c\u4e0d\u5339\u914d","text":"<p>Negative matching using grep (match lines that do not contain foo)</p> <p>\u4ece\u6587\u4ef6 file \u4e2d\u8fc7\u6ee4\u51fa\u5305\u542b foo \u7684\u884c\uff1a</p> <pre><code>awk '!/foo/' file\n</code></pre> <p>\u4ece\u6587\u4ef6 file \u4e2d\u8fc7\u6ee4\u51fa\u65e2\u4e0d\u5305\u542b foo\uff0c\u4e5f\u4e0d\u5305\u542b bar \u7684\u884c\uff1a</p> <pre><code>awk '!/foo/ &amp;&amp; !/bar/' file\n</code></pre> <p>\u4ece\u6587\u4ef6 file \u4e2d\u8fc7\u6ee4\u51fa\u65e2\u4e0d\u5305\u542b foo\uff0c\u4e5f\u4e0d\u5305\u542b bar\uff0c\u4f46\u5305\u542b foo2 \u6216 bar2 \u7684\u884c\uff1a</p> <pre><code>awk '!/foo/ &amp;&amp; !/bar/ &amp;&amp; (/foo2/ || /bar2/)'\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u5339\u914d\u89c4\u5219","title":"\u5339\u914d\u89c4\u5219","text":"","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u4efb\u610f\u5b57\u7b26","title":"\u4efb\u610f\u5b57\u7b26","text":"<p>\u62bd\u53d6\u540d\u5b57\uff0c\u5176\u8bb0\u5f55\u7b2c\u4e00\u57df\u7684\u7b2c\u56db\u4e2a\u5b57\u7b26\u662f a\uff0c\u4f7f\u7528\u53e5\u70b9 <code>.</code> \u8868\u793a\u4efb\u610f\u5b57\u7b26\u3002 \u8868\u8fbe\u5f0f <code>/^...a/</code> \u610f\u4e3a\u884c\u9996\u524d\u4e09\u4e2a\u5b57\u7b26\u4efb\u610f\uff0c\u7b2c\u56db\u4e2a\u662fa\uff0c\u5c16\u89d2\u7b26\u53f7\u4ee3\u8868\u884c\u9996\u3002  </p> <pre><code>$ awk '$1 ~/^...a/' grade.txt\nM.Tansley   05/99   48311   Green       8   40  44\nL.Tansley   05/99   4712    Brown-2     12  30  28\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u5019\u9009\u5b57\u7b26","title":"\u5019\u9009\u5b57\u7b26","text":"<p>\u5728\u6d4b\u8bd5\u6b63\u5219\u8868\u8fbe\u5f0f\u65f6\u63d0\u5230\u53ef\u5339\u914d <code>[]</code> \u5185\u4efb\u610f\u5b57\u7b26\u6216\u5355\u8bcd\uff0c\u56e0\u6b64\u82e5\u67e5\u8be2\u6587\u4ef6\u4e2d\u7ea7\u522b\u4e3a green\u7684\u6240\u6709\u8bb0\u5f55\uff0c\u4e0d\u8bba\u5176\u5927\u5c0f\u5199\uff0c\u8868\u8fbe\u5f0f\u5e94\u4e3a <code>/[Gg]reen/</code>\u3002</p> <pre><code>$ awk '/[Gg]reen/' grade.txt\nM.Tansley   05/99   48311   Green       8   40  44\nJ.Lulu      06/99   48317   green       9   24  26\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u5339\u914d\u6570\u5b57","title":"\u5339\u914d\u6570\u5b57","text":"<p>How to use regular expressions in awk</p> <pre><code># \u65e0\u6cd5\u4f7f\u7528 \\d \uff1f\n$ networksetup -listnetworkserviceorder | awk '/\\(\\d\\) Wi-Fi/'\n# \u6539\u7528\u5176\u4ed6\u7b49\u6548\u65b9\u5f0f\n$ networksetup -listnetworkserviceorder | awk '/\\(.\\) Wi-Fi/'\n(1) Wi-Fi\n$ networksetup -listnetworkserviceorder | awk '/\\([1-9]\\) Wi-Fi/'\n(1) Wi-Fi\n$ networksetup -listnetworkserviceorder | awk '/\\([[:digit:]]\\) Wi-Fi/'\n(1) Wi-Fi\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u6216\u5173\u7cfb\u5339\u914d","title":"\u6216\u5173\u7cfb\u5339\u914d","text":"<p>\u4e3a\u62bd\u53d6\u7ea7\u522b\u4e3a Yellow \u6216 Brown \u7684\u8bb0\u5f55\uff0c\u4f7f\u7528\u7ad6\u7ebf\u7b26\uff08<code>|</code>\uff09\uff0c\u610f\u4e3a\u5339\u914d <code>|</code> \u4e24\u8fb9\u6a21\u5f0f\u4e4b\u4e00\u3002 \u6ce8\u610f\uff1a\u4f7f\u7528\u7ad6\u7ebf\u7b26\u65f6\uff0c\u8bed\u53e5\u5fc5\u987b\u7528\u5706\u62ec\u53f7\u62ec\u8d77\u6765\u3002</p> <pre><code>$ awk '/(Yellow|Brown)/' grade.txt\nP.Bunny     02/99   48      Yellow      12  35  28\nJ.Troll     07/99   4842    Brown-3     12  26  26\nL.Tansley   05/99   4712    Brown-2     12  30  28\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#\u4e0e\u6216\u6761\u4ef6","title":"\u4e0e\u6216\u6761\u4ef6","text":"<p>\u4e0e\u6761\u4ef6\u5173\u7cfb\uff1a</p> <pre><code># awk '{if($1==\"P.Bunny\" &amp;&amp; $4==\"Yellow\") print $0}' grade.txt\n# awk '$1==\"P.Bunny\" &amp;&amp; $4==\"Yellow\" {print $0}' grade.txt\n$ awk '$1==\"P.Bunny\" &amp;&amp; $4==\"Yellow\"' grade.txt\nP.Bunny     02/99   48      Yellow      12  35  28\n</code></pre> <p>\u6216\u6761\u4ef6\u5173\u7cfb\uff1a</p> <pre><code># awk '{if($4==\"Yellow\" || $4~/Brown/) print $0}' grade.txt\n# awk '$4==\"Yellow\" || $4~/Brown/ {print $0}' grade.txt\n$ awk '$4==\"Yellow\" || $4~/Brown/' grade.txt\nP.Bunny     02/99   48      Yellow      12  35  28\nJ.Troll     07/99   4842    Brown-3     12  26  26\nL.Tansley   05/99   4712    Brown-2     12  30  28\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-pattern/#csv_\u5339\u914d\u793a\u4f8b","title":"CSV \u5339\u914d\u793a\u4f8b","text":"<p>\u5047\u8bbe\u4ee3\u7801\u626b\u63cf\u5206\u6790\u5e73\u53f0\u5bfc\u51fa\u7684 LineTooLong \u8b66\u544a\u95ee\u9898\u6e05\u5355\u4e3a issue_data-LineTooLong.csv\u3002 \u5176\u8868\u5934\u5982\u4e0b\uff1a</p> <pre><code>$ awk 'FNR==1' issue_data-LineTooLong.csv\n\u95ee\u9898ID,\u6587\u4ef6,\u89c4\u5219\u540d,\u89c4\u5219realname,\u51fa\u9519\u4fe1\u606f,\u72b6\u6001,\u5904\u7406\u65b9\u6cd5,\u8d1f\u8d23\u4eba,\u4e25\u91cd\u7ea7\u522b,\u7248\u672c\u53f7,\u9879\u76eeID,\u53d1\u73b0\u7248\u672c\u65f6\u95f4,\u626b\u63cfID,\u662f\u5426\u63d0\u5355,\u94fe\u63a5\n</code></pre> <p>\u82e5\u60f3\u8fc7\u6ee4\u51fa\u95ee\u9898\u6587\u4ef6\u5217\u8868\uff0c\u53ef\u6267\u884c\u8bb0\u5f55\u5339\u914d\u6216\u57df\u5339\u914d\uff1a</p> <pre><code>$ awk -F ',' '/File\\/NearFile/{print $2}' issue_data-LineTooLong.csv\n$ # or\n$ awk -F ',' '$2~/File\\/NearFile/{print $2}' issue_data-LineTooLong.csv\n</code></pre> <p>\u4ee5\u4e0b\u5bf9\u6240\u6709\u7684\u95ee\u9898\u6587\u4ef6\uff08<code>$2</code>\uff09\u6267\u884c <code>clang-format</code> \u683c\u5f0f\u5316\u547d\u4ee4\uff1a</p> <pre><code>awk -F ',' '{cmd=\"clang-format --verbose -style=file -i \"$2;system(cmd)}' issue_data-LineTooLong.csv\n</code></pre> <p>\u4ee5\u4e0b\u5bf9\u5339\u914d\u8def\u5f84\u7684\u95ee\u9898\u6587\u4ef6\uff08<code>$2</code>\uff09\u6267\u884c <code>clang-format</code> \u683c\u5f0f\u5316\u547d\u4ee4\uff1a</p> <pre><code>awk -F ',' '$2~/File\\/NearFile\\//{cmd=\"clang-format --verbose -style=file -i \"$2;system(cmd)}' issue_data-LineTooLong.csv\n</code></pre> <p>\u8003\u8651\u5c06\u5339\u914d\u8def\u5f84\u7684\u95ee\u9898\u6587\u4ef6\u540d\u9010\u884c\u5bfc\u51fa\u5230txt\u6587\u4ef6\uff1a</p> <pre><code>awk -F ',' '$2~/File\\/NearFile\\//{print $2}' issue_data-LineTooLong.csv | tee issue-file-list.txt\n</code></pre> <p>\u7136\u540e\u6309\u884c\u8bfb\u53d6\u4e3a\u6570\u7ec4\uff0c\u518d\u6267\u884cfor\u5faa\u73af\u683c\u5f0f\u5316\uff1a</p> <pre><code>array=($(cat issue-file-list.txt)) # array=($(awk 1 issue-file-list.txt))\necho ${#array[*]}\n\nfor file in ${array[@]}; do\n    clang-format --verbose -style=file -i $file\ndone\n</code></pre> <p>\u5982\u679c\u8981\u901a\u8fc7\u624b\u5de5\u6536\u96c6\u5c11\u91cf\u7684\u95ee\u9898\u6587\u4ef6\u8fdb\u884c\u6279\u5904\u7406\u683c\u5f0f\u5316\uff0c\u53ef\u5c06\u9700\u8981\u683c\u5f0f\u5316\u7684\u6587\u4ef6\u540d\uff08\u76f8\u5bf9 .clang-format \u9690\u85cf\u6587\u4ef6\u6240\u5728\u9879\u76ee\u6839\u76ee\u5f55\u7684\u8def\u5f84\uff09\u9010\u884c\u586b\u5199\u5230 txt \u6587\u4ef6\uff0c\u518d\u6267\u884c\u4ee5\u4e0a\u811a\u672c\u3002</p> <p>\u5982\u679c\u8981\u9488\u5bf9\u6307\u5b9a\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e0b\u7684\u6240\u6709iOS\u4ee3\u7801\u6587\u4ef6\u6267\u884c\u683c\u5f0f\u5316\uff0c\u53ef\u8003\u8651\u4ee5\u4e0b\u66f4\u52a0\u7b80\u6d01\u7684\u96c6\u6210\u5316\u811a\u672c\uff1a</p> <pre><code>find $subdir -type f \\( -iname \"*.h\" -iname \"*.hpp\" -iname \"*.c\" -o -iname \"*.cpp\" -o -iname \"*.m\" -o -iname \"*.mm\" \\) | xargs clang-format --verbose -style=file -i\n</code></pre> <p>subdir \u4e3a\u9700\u8981\u683c\u5f0f\u5316\u7684\u76ee\u5f55\u8def\u5f84\uff0c\u76f8\u5bf9 .clang-format \u9690\u85cf\u6587\u4ef6\u6240\u5728\u9879\u76ee\u6839\u76ee\u5f55\u7684\u8def\u5f84\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-vars/","title":"Linux Command - awk vars","text":"<p>Linux \u4e0b\u7684 awk \u547d\u4ee4\u4e2d\u7684\u53d8\u91cf\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#fsofsrs","title":"FS/OFS/RS","text":"<p>\u4ee5\u4e0b\u662f\u63a7\u5236\u683c\u5f0f\u76f8\u5173\u7684\u4e00\u4e9b\u5185\u7f6e\u53d8\u91cf\uff1a</p> \u53d8\u91cf \u63cf\u8ff0 FIELDWIDTHS \u7531\u7a7a\u683c\u5206\u9694\u7684\u4e00\u5217\u6570\u5b57\uff0c\u5b9a\u4e49\u4e86\u6bcf\u4e2a\u6570\u636e\u5b57\u6bb5\u786e\u5207\u5bbd\u5ea6 RS \u8f93\u5165\u8bb0\u5f55\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u6362\u884c\u7b26 FS \u8f93\u5165\u5b57\u6bb5\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u767d\u5b57\u7b26 ORS \u8f93\u51fa\u8bb0\u5f55\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u6362\u884c\u7b26 OFS \u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u683c <p>\u4ee5\u4e0b\u6253\u5370 awk \u9ed8\u8ba4\u7684\u8f93\u5165\u8bb0\u5f55/\u5b57\u6bb5\u5206\u5272\u7b26\u3001\u8f93\u51fa\u8bb0\u5f55/\u5b57\u6bb5\u5206\u5272\u7b26\uff1a</p> <pre><code>$ awk 'BEGIN { printf \"RS=\\\"%s\\\"\\nFS=\\\"%s\\\"\\nORS=\\\"%s\\\"\\nOFS=\\\"%s\\\"\\n\", RS, FS, ORS, OFS }'\nRS=\"\n\"\nFS=\" \"\nORS=\"\n\"\nOFS=\" \"\n</code></pre> <p>Linux \u4e2d awk \u540e\u9762\u7684 RS, ORS, FS, OFS \u7528\u6cd5 Explanation about awk command using ORS, NR, FS, RS 8 Powerful Awk Built-in Variables \u2013 FS, OFS, RS, ORS, NR, NF, FILENAME, FNR </p>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#fs","title":"FS","text":"<p>\u5728 awk-basic \u4e2d\u8bb2\u8fc7\uff0c\u53ef\u5728\u6267\u884c awk \u547d\u4ee4\u65f6\u901a\u8fc7 <code>-F</code> \u9009\u9879\u6765\u6307\u5b9a\u57df\u5206\u5272\u7b26\u3002</p> <p>\u9ed8\u8ba4 <code>FS</code> \u975e\u9876\u683c\u7a7a\u683c\u6216\u5236\u8868\u7b26\uff0c\u4e5f\u53ef\u4ee5\u81ea\u884c\u6307\u5b9a\u5176\u4ed6\u5b57\u7b26\uff08\u4e32\uff09\u4f5c\u4e3a\u57df\u5206\u5272\u7b26\u3002</p> <p>\u4e00\u822c\u5728 BEGIN \u4e2d\u6307\u5b9a FS\uff0c\u5b9e\u9645\u4e0a <code>-F</code> \u548c <code>FS</code> \u652f\u6301\u6307\u5b9a\u591a\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u5206\u5272\u70b9\u3002</p> <p>\u4f8b\u5982 <code>-F '[()]'</code> \u6216 <code>FS='[()]'</code> \u8868\u793a\u4ee5\u5de6\u62ec\u53f7\u548c\u53f3\u62ec\u53f7\u4f5c\u4e3a\u5206\u5272\u7b26\u3002</p> <p>macOS \u4e0b\u901a\u8fc7 <code>networksetup -listnetworkserviceorder</code> \u547d\u4ee4\u53ef\u67e5\u770b\u7f51\u7edc\u670d\u52a1\u63a5\u53e3\uff1a</p> <pre><code>$ networksetup -listnetworkserviceorder\nAn asterisk (*) denotes that a network service is disabled.\n(1) Wi-Fi\n(Hardware Port: Wi-Fi, Device: en0)\n\n(2) Bluetooth PAN\n(Hardware Port: Bluetooth PAN, Device: en3)\n\n(3) Thunderbolt Bridge\n(Hardware Port: Thunderbolt Bridge, Device: bridge0)\n</code></pre> <p>\u5982\u679c\u63d0\u53d6\u65e0\u7ebf\u7f51\u5361\uff08Wi-Fi\uff09\u7684\u63a5\u53e3\u540d\u79f0\uff08en0\uff09\u5462\uff1f</p> <ol> <li>\u5b9a\u4f4d\u8d77\u59cb\u8fb9\u754c\u6807\u9898\u884c <code>(1) Wi-Fi</code>\uff0c\u8bfb\u53d6\u4e0b\u4e00\u884c\uff1b  </li> <li>\u62ec\u53f7\u5185\u6309\u9017\u53f7\u5206\u5272\uff0c\u8bfb\u53d6\u7b2c\u4e8c\u90e8\u5206 <code>Device: en0</code>\uff1b  </li> <li>\u5bf9 <code>Device: en0</code> \u63d0\u53d6\u540e\u9762\u7684\u540d\u79f0\u90e8\u5206\u3002  </li> </ol> <p>\u6267\u884c\u8fc7\u7a0b\u5206\u6790\u5982\u4e0b\uff1a</p> <ul> <li>\u7ba1\u4f20\u7b2c1\u4e2aawk\uff1a\u754c\u5b9a\u7ed3\u6784\u5316\u5185\u5bb9\u7684\u8d77\u59cb\u8fb9\u754c\u884c\uff08\u6807\u9898\u5305\u542b\u5e8f\u53f7\u548c\u63a5\u53e3\u540d\uff09\uff1b  </li> <li>\u7ba1\u4f20\u7b2c2\u4e2aawk\uff1a\u6307\u5b9a\u4e09\u4e2a\u5206\u5272\u7b26 <code>(</code>\u3001<code>,</code>\u3001<code>)</code>\uff0c\u8fdb\u884c\u591a\u70b9\u5207\u5272\uff1b  </li> <li>\u7ba1\u4f20\u7b2c3\u4e2aawk\uff1a\u9ed8\u8ba4\u6309\u7a7a\u683c\u5206\u5272\uff0c\u63d0\u53d6\u7b2c\u4e8c\u90e8\u5206\u7684\u8bbe\u5907\u540d\u3002  </li> </ul> <pre><code># networksetup -listnetworkserviceorder | awk '/\\([[:digit:]]+\\) Wi-Fi/{getline; print}' | awk -F '[(,)]' '{print $3}' | awk '{print $2}'\n$ networksetup -listnetworkserviceorder | awk '/\\([[:digit:]]+\\) Wi-Fi/{getline; print}' | awk 'BEGIN {FS=\"[(,)]\"} {print $3}' | awk '{print $NF}'\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#ofs","title":"OFS","text":"<p>\u53d8\u91cf FS \u548c OFS \u5b9a\u4e49\u4e86 awk \u5982\u4f55\u5904\u7406\u6570\u636e\u6d41\u4e2d\u7684\u6570\u636e\u5b57\u6bb5\u3002</p> <ul> <li>\u53d8\u91cf <code>FS</code> \u7528\u6765\u5b9a\u4e49\u8bb0\u5f55\u5904\u7406\u65f6\u7684\u5b57\u6bb5\u5206\u5272\u7b26\uff1b  </li> <li>\u53d8\u91cf <code>OFS</code> \u7528\u4e8e\u5b9a\u4e49 <code>print</code> \u6253\u5370\u5b57\u6bb5\u7684\u5206\u9694\u7b26\u3002  </li> </ul> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cawk \u5c06 <code>OFS</code> \u8bbe\u6210\u4e00\u4e2a\u7a7a\u683c\uff0c\u6253\u5370\u5404\u5b57\u6bb5\u4ee5\u7a7a\u683c\u5206\u9694\u3002 \u6267\u884c\u547d\u4ee4 <code>print $1,$2,$3</code>\uff0c\u4f1a\u770b\u5230\u8f93\u51fa <code>field1 field2 field3</code>\u3002</p> <pre><code>$ awk '{print $1, $2}' data2.txt\nOne line\nTwo lines\nThree lines\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7 BEGIN \u6a21\u5757\u5728 body \u5904\u7406\u524d\u9884\u8bbe OFS\uff1a</p> <pre><code>$ awk 'BEGIN {OFS=\", \"} {print $1, $2}' awk-data2.txt\nOne, line\nTwo, lines\nThree, lines\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#fieldwidth","title":"FIELDWIDTH","text":"<p>\u5728\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u6570\u636e\u5e76\u6ca1\u6709\u4f7f\u7528\u5b57\u6bb5\u5206\u9694\u7b26\uff0c\u800c\u662f\u88ab\u653e\u7f6e\u5728\u4e86\u8bb0\u5f55\u4e2d\u7684\u7279\u5b9a\u5217\u3002 \u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5fc5\u987b\u8bbe\u5b9a <code>FIELDWIDTHS</code> \u53d8\u91cf\u6765\u5339\u914d\u6570\u636e\u5728\u8bb0\u5f55\u4e2d\u7684 \u4f4d\u7f6e\uff0c\u6309\u7167\u5217\u5bbd\u6765\u5206\u5272\u5404\u4e2a\u57df\u3002</p> <p>\u4e00\u65e6\u8bbe\u7f6e\u4e86 FIELDWIDTH \u53d8\u91cf\uff0cawk \u5c31\u4f1a\u5ffd\u7565 FS \u53d8\u91cf\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#rs","title":"RS","text":"<p>\u53d8\u91cf RS \u548c ORS \u5b9a\u4e49\u4e86 awk \u7a0b\u5e8f\u5982\u4f55\u5206\u5272/\u5206\u9694\u6570\u636e\u6d41\u4e2d\u7684\u8bb0\u5f55\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cawk \u5c06 RS \u548c ORS \u8bbe\u4e3a\u6362\u884c\u7b26\uff08<code>\\n</code>\uff09\uff0c\u5373\u4ee5\u884c\u4f5c\u4e3a\u8bb0\u5f55\u88c1\u51b3\u5355\u4f4d\u3002</p> <p>\u66f4\u591a\u7684\u65f6\u5019\uff0c\u4f60\u4f1a\u5728\u6570\u636e\u6d41\u4e2d\u78b0\u5230\u5360\u636e\u591a\u884c\u7684\u7ed3\u6784\u5316\u4fe1\u606f\u3002 \u5178\u578b\u7684\u4f8b\u5b50\u662f\u5305\u542b\u5730\u5740\u548c\u7535\u8bdd\u53f7\u7801\u7684\u6570\u636e\uff0c\u5176\u4e2d\u5730\u5740\u548c\u7535\u8bdd\u53f7\u7801\u5404\u5360\u4e00\u884c\u3002</p> <pre><code>Riley Mullen\n123 Main Street\nChicago, IL 60601\n(312)555-1234\n</code></pre> <p>\u5982\u679c\u7528\u9ed8\u8ba4\u7684 FS \u548c RS \u53d8\u91cf\u503c\u6765\u8bfb\u53d6\u8fd9\u7ec4\u6570\u636e\uff0cawk \u5c31\u4f1a\u628a\u6bcf\u884c\u4f5c\u4e3a\u4e00\u6761\u5355\u72ec\u7684\u8bb0\u5f55\u6765\u8bfb\u53d6\uff0c\u5e76\u5c06\u8bb0\u5f55\u4e2d\u7684\u7a7a\u683c\u5f53\u4f5c\u5b57\u6bb5\u5206\u9694\u7b26\u3002 \u4f46\u7b26\u5408\u5b9e\u9645\u9884\u671f\u7684\u89e3\u8bfb\u662f\uff0c\u6bcf\u56db\u884c\u7ec4\u6210\u7684\u7ed3\u6784\u5316\u533a\u5757\u4e3a\u4e00\u6761\u5b8c\u6574\u7684\u8bb0\u5f55\uff0c\u6bcf\u6761\u8bb0\u5f55\u4e2d\u7684\u6bcf\u4e00\u884c\u5bf9\u5e94\u4e00\u4e2a\u5b57\u6bb5\u57df\u3002</p> <p>\u7ed3\u6784\u5316\u7684\u8bb0\u5f55\u4e4b\u95f4\u7559\u4e00\u4e2a\u7a7a\u767d\u884c\u76f8\u95f4\uff0c\u53ef\u4ee5\u5c06 <code>RS</code> \u53d8\u91cf\u8bbe\u7f6e\u6210\u7a7a\u5b57\u7b26\u4e32\uff0c\u5c06 <code>FS</code> \u8bbe\u7f6e\u4e3a\u6362\u884c\u7b26\uff08<code>\\n</code>\uff09\u3002 \u7136\u540e awk \u4f1a\u628a\u6bcf\u4e2a\u7a7a\u767d\u884c\u5f53\u4f5c\u4e00\u4e2a\u8bb0\u5f55\u5206\u9694\u7b26\uff0c\u628a\u6587\u4ef6\u4e2d\u7684\u6bcf\u884c\u5f53\u6210\u4e00\u4e2a\u5b57\u6bb5\u3002</p> <p>data2 \u4e2d\u6709\u4e09\u6761\u8bb0\u5f55\uff1a</p> <pre><code>$ cat data2\nRiley Mullen\n123 Main Street\nChicago, IL 60601\n(312)555-1234\n\nFrank Williams\n456 Oak Street\nIndianapolis, IN 46201\n(317)555-9876\n\nHaley Snell\n4231 Elm Street\nDetroit, MI 48201\n(313)555-4938\n</code></pre> <p>awk \u63d0\u53d6\u59d3\u540d\u548c\u7535\u8bdd\u53f7\u7801\u6253\u5370\u8f93\u51fa\uff1a</p> <pre><code>$ awk 'BEGIN {RS=\"\"; FS=\"\\n\"; OFS=\": \" } {print $1,$4}' data2\nRiley Mullen: (312)555-1234\nFrank Williams: (317)555-9876\nHaley Snell: (313)555-4938\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#demo","title":"demo","text":"<p>\u6709\u65f6\u4f1a\u9047\u5230\u8f83\u957f\u7684\u5355\u884c\u6587\u672c\uff0c\u4f46\u5305\u542b\u56fa\u5b9a\u7684\u5206\u9694\u7b26\u3002</p> <p>\u4f8b1\uff1a\u6309\u884c\u6253\u5370\u8f93\u51fa <code>ifconfig -l</code> \u4e2d\u7684\u63a5\u53e3\u3002</p> <ol> <li>\u8f93\u5165\u5b57\u6bb5\u5206\u5272\u7b26FS\u9ed8\u8ba4\u4e3a\u7a7a\u767d\u5b57\u7b26\uff0c\u7136\u540e\u5728BEGIN\u4e2d\u6307\u5b9a\u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26OFS\u4e3a\u6362\u884c\uff0cBODY\u90e8\u5206for\u5faa\u73af\u6253\u5370\u5404\u4e2a\u5b57\u6bb5\uff0c\u5373\u5b9e\u73b0\u4e86\u6309\u884c\u6253\u5370\u8bb0\u5f55\u3002</li> </ol> <pre><code>ifconfig -l | awk 'BEGIN{OFS=\"\\n\"} { for (i=1; i&lt;=NF; i++) print $i}'\n</code></pre> <ol> <li>\u66f4\u7b80\u5355\u7684\u65b9\u6848\uff1a\u6307\u5b9a\u8bb0\u5f55\u5206\u5272\u7b26RS\u4e3a\u7a7a\u683c\uff0c\u5c06\u63a5\u53e3\u5217\u8868\u6309\u7a7a\u683c\u5206\u5272\u6210\u591a\u6761\u8bb0\u5f55\uff0c\u518d\u6309\u884c\u6253\u5370\u8bb0\u5f55\uff08ORS\u9ed8\u8ba4\u5373\u4e3a\u6362\u884c\uff09\uff1a</li> </ol> <pre><code># \u9ed8\u8ba4\u52a8\u4f5cprint\u53ef\u7701\nifconfig -l | awk 'BEGIN{RS=\" \"} {print}'\n</code></pre> <p>\u4f8b2\uff1a\u6309\u884c\u6253\u5370\u8f93\u51fa <code>PATH</code> \u4e2d\u7684\u73af\u5883\u53d8\u91cf\uff08<code>print -l $PATH</code>\uff09\u3002</p> <ol> <li><code>-F</code> \u6307\u5b9a\u4ee5 <code>:</code> \u4f5c\u4e3a\u5b57\u6bb5\u5206\u5272\u7b26\uff08FS\uff09\uff0c\u7136\u540e\u5728BEGIN\u4e2d\u6307\u5b9a\u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26OFS\u4e3a\u6362\u884c\uff0cBODY\u90e8\u5206for\u5faa\u73af\u6253\u5370\u5404\u4e2a\u5b57\u6bb5\uff0c\u5373\u5b9e\u73b0\u4e86\u6309\u884c\u6253\u5370\u8bb0\u5f55\u3002</li> </ol> <pre><code>echo $PATH | awk -F ':' 'BEGIN{OFS=\"\\n\"} { for (i=1; i&lt;=NF; i++) print $i}'\n</code></pre> <ol> <li>\u66f4\u7b80\u5355\u7684\u65b9\u6848\uff1a\u6307\u5b9a\u8f93\u5165\u8bb0\u5f55\u5206\u9694\u7b26RS\u4e3a <code>:</code>\uff0c\u5c06 PATH \u73af\u5883\u53d8\u91cf\u6309\u5192\u53f7\u5206\u5272\u6210\u591a\u6761\u8bb0\u5f55\uff0c\u518d\u6309\u884c\u6253\u5370\u8bb0\u5f55\uff08ORS\u9ed8\u8ba4\u5373\u4e3a\u6362\u884c\uff09\uff1a</li> </ol> <pre><code># \u9ed8\u8ba4\u52a8\u4f5cprint\u53ef\u7701\necho $PATH | awk 'BEGIN{RS=\":\"} {print}'\n</code></pre> <p>\u4f8b3\uff1a\u6309\u884c\u6253\u5370\u8f93\u51fa\u7528\u6237\u8eab\u4efd id \u548c\u6240\u5c5e\u7528\u6237\u7ec4 groups\u3002</p> <pre><code># \u9ed8\u8ba4\u52a8\u4f5cprint\u53ef\u7701\ngroups | awk 'BEGIN {RS=\" \";} {print}'\ngroups `whoami` | awk 'BEGIN {RS=\" \";} {print}'\nid | awk 'BEGIN {RS=\" \";} {print}'\nid `whoami` | awk 'BEGIN {RS=\" \";} {print}'\n</code></pre> <p>\u4f8b4\uff1a\u5c40\u57df\u7f51\u5185\u7684\u67d0\u53f0\u670d\u52a1\u5668\uff08raspi-ubuntu\uff09\u7531\u4e8e\u91c7\u7528\u4e86DHCP\uff0c\u5982\u4f55\u67e5\u627e\u5b83\u7684IP\u5730\u5740\uff0c\u4ee5\u4fbf\u8fdb\u884cSSH\u8fde\u63a5\u5462\uff1f</p> <p>\u5047\u8bbe\u6211\u4eec\u77e5\u9053\u8bbe\u5907wifi\u63a5\u53e3\uff08wlan0\uff09\u7684MAC\u5730\u5740\u662f\u4ee5 <code>dc:a6:32</code> \u5f00\u5934\uff0c\u90a3\u4e48\u5728 SSH \u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u901a\u8fc7 arp \u67e5\u8be2\u8be5 MAC \u5730\u5740\u5bf9\u5e94\u7684 IP\u3002</p> <pre><code>$ arp -a | grep \"dc:a6:32\"\n? (192.168.0.114) at dc:a6:32:**:**:** on en0 ifscope [ethernet]\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0carp \u547d\u4ee4\u8f93\u51fa\u7684 ARP \u62a5\u6587\u683c\u5f0f\u662f\u56fa\u5b9a\u7684\uff0c\u62ec\u53f7\u4e2d\u5373\u4e3a\u5bf9\u5e94\u8bbe\u5907\u5206\u914d\u5360\u7528\u7684 IP \u5730\u5740\u3002 \u90a3\u4e48\uff0c\u5982\u4f55\u63d0\u53d6\u8fd9\u4e2aIP\u5730\u5740\u5462\uff1f</p> <p>\u53ef\u4ee5\u57fa\u4e8eawk\u5148\u57fa\u4e8e\u5de6\u62ec\u53f7\u8fdb\u884c\u5207\u5272\uff0c\u7136\u540e\u518d\u79fb\u9664\u53f3\u62ec\u53f7\u53ca\u5176\u540e\u7684\u5185\u5bb9\uff1a</p> <pre><code># awk\u5148\u5206\u5272\u5de6\u62ec\u53f7\uff0c\u518d\u66ff\u6362\u53f3\u62ec\u53f7\u540e\u9762\u4e3a\u7a7a\n$ arp -na | grep \"dc:a6:32\" | awk -F '(' '{sub(/\\).*/, \"\", $2);print$2}'\n</code></pre> <p>\u66f4\u7b80\u6d01\u7684\u601d\u8def\u662f\uff0c\u57fa\u4e8e\u5de6\u53f3\u62ec\u53f7\u4e24\u70b9\u5207\u5272\uff0c\u7136\u540e\u57df $2 \u5373\u662f\u4e2d\u95f4\u7684IP\u5730\u5740\u90e8\u5206\uff1a</p> <pre><code># awk -F \u6307\u5b9a\u4e24\u4e2a\u5206\u5272\u7b26\n$ arp -na | grep \"dc:a6:32\" | awk -F '[()]' '{print$2}'\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#nfnrfnr","title":"NF/NR/FNR","text":"<p>\u5f53\u8981\u5728 awk \u7a0b\u5e8f\u4e2d\u8ddf\u8e2a\u6570\u636e\u5b57\u6bb5\u548c\u8bb0\u5f55\u65f6\uff0c\u53d8\u91cf FNR\u3001NF \u548c NR \u7528\u8d77\u6765\u5c31\u975e\u5e38\u65b9\u4fbf\u3002</p> \u53d8\u91cf \u63cf\u8ff0 <code>NF</code> number of fields in the current record <code>NR</code> ordinal number of the current record <code>FNR</code> ordinal number of the current record in the current file","tags":["awk"]},{"location":"blog/20191105/awk-vars/#nf","title":"NF","text":"<p>\u6709\u65f6\u5e76\u4e0d\u77e5\u9053\u8bb0\u5f55\u4e2d\u5230\u5e95\u6709\u591a\u5c11\u4e2a\u6570\u636e\u5b57\u6bb5\uff0cNF \u53d8\u91cf\u5b58\u50a8\u4e86\u8bb0\u5f55\u4e2d\u57df\uff08\u5b57\u6bb5\uff09\u7684\u4e2a\u6570\u3002 \u53ef\u4ee5 <code>$NF</code> \u5f62\u5f0f\u5f15\u7528\u8bb0\u5f55\u4e2d\u6700\u540e\u4e00\u4e2a\u5b57\u6bb5\uff0cRS \u4f8b\u7a0b\u4e2d\u7684\u7535\u8bdd\u53f7\u7801\u5b57\u6bb5\uff08<code>$4</code>\uff09\u4e5f\u53ef\u4ee5 <code>$NF</code> \u5f62\u5f0f\u5f15\u7528\u3002</p> <p>How to select only the first 10 rows in my AWK script</p> <p>\u4e0a\u8282\u793a\u4f8b\u4e2d\uff0cBODY\u4e2d\u7684for\u5faa\u73af\uff0c\u91c7\u7528NF\u4f5c\u4e3a\u7d22\u5f15\u4e0a\u9650\uff0c\u6253\u5370\u5404\u4e2a\u5b57\u6bb5\uff1a</p> <pre><code>ifconfig -l | awk 'BEGIN{OFS=\"\\n\"} { for (i=1; i&lt;=NF; i++) print $i}'\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#fnr","title":"FNR","text":"<p>FNR \u548c NR \u53d8\u91cf\u867d\u7136\u7c7b\u4f3c\uff0c\u4f46\u53c8\u7565\u6709\u4e0d\u540c\u3002</p> <ul> <li>FNR \u53d8\u91cf\u8bb0\u5f55\u4e86\u5f53\u524d\u6587\u4ef6\u4e2d\u5df2\u5904\u7406\u8fc7\u7684\u8bb0\u5f55\u6761\u6570\uff1b  </li> <li>NR \u53d8\u91cf\u5219\u8bb0\u5f55\u7740\u6240\u6709\u6587\u4ef6\u7d2f\u8ba1\u5df2\u5904\u7406\u8fc7\u7684\u8bb0\u5f55\u6761\u6570\u3002  </li> </ul> <p>\u7531\u4e8e\u9ed8\u8ba4 <code>RS</code>=\"\\n\"\uff0c\u6bcf\u6761\u8bb0\u5f55\u4e3a\u81ea\u7136\u884c\uff0c\u8bb0\u5f55\u6570 <code>FNR</code> \u4e5f\u5373\u5f53\u524d\u6587\u4ef6\u6e38\u6807\u6240\u5728\u7684\u884c\u6570\uff08\u4ece1\u5f00\u59cb\u8ba1\u6570\uff09\u3002</p> <p>\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0cawk \u6307\u5b9a\u8f93\u5165\u4e86\u4e24\u4e2a\u76f8\u540c\u7684\u6587\u4ef6\uff0c\u811a\u672c\u6253\u5370\u7b2c\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5e76\u8f93\u51fa FNR \u53d8\u91cf\u503c\uff0c\u8ffd\u8e2a FNR \u7684\u52a8\u6001\u53d8\u5316\u3002</p> <pre><code>$ cat data1\ndata11,data12,data13,data14,data15\ndata21,data22,data23,data24,data25\ndata31,data32,data33,data34,data35\n\n$ awk 'BEGIN{FS=\",\"} {print $1,\"FNR=\"FNR}' data1 data1\ndata11 FNR=1\ndata21 FNR=2\ndata31 FNR=3\ndata11 FNR=1\ndata21 FNR=2\ndata31 FNR=3\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <ol> <li>\u76f4\u63a5\u5f15\u7528 FNR \u53d8\u91cf\uff0c\u4e0d\u9700\u8981\u52a0 <code>$</code> \u5f15\u7528\u3002  </li> <li>\u5f53 awk \u7a0b\u5e8f\u5904\u7406\u7b2c\u4e8c\u4e2a\u6587\u4ef6\u65f6\uff0c<code>FNR</code> \u503c\u88ab\u8bbe\u56de\u4e861\u3002  </li> </ol>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#nr","title":"NR","text":"<p>\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u52a0\u4e0a <code>NR</code> \u53d8\u91cf\u770b\u770b\u4f1a\u8f93\u51fa\u4ec0\u4e48\u3002</p> <pre><code>$ awk 'BEGIN{FS=\",\"} {print $1,\"FNR=\"FNR,\"NR=\"NR}' data1 data1\ndata11 FNR=1 NR=1\ndata21 FNR=2 NR=2\ndata31 FNR=3 NR=3\ndata11 FNR=1 NR=4\ndata21 FNR=2 NR=5\ndata31 FNR=3 NR=6\n</code></pre> <p>FNR \u53d8\u91cf\u5728 awk \u5904\u7406\u7b2c\u4e8c\u4e2a\u6587\u4ef6\u65f6\u88ab\u91cd\u7f6e\u4e86\uff0c\u800c NR \u53d8\u91cf\u5219\u5728\u5904\u7406\u7b2c\u4e8c\u4e2a\u6570\u636e\u6587\u4ef6\u65f6\u7ee7\u7eed\u8ba1\u6570\u3002</p> <ol> <li>\u5982\u679c\u53ea\u8f93\u5165\u4e00\u4e2a\u6587\u4ef6\u65f6\uff0cFNR \u548c NR \u7684\u503c\u662f\u76f8\u540c\u7684\uff1b  </li> <li>\u5982\u679c\u8f93\u5165\u591a\u4e2a\u6587\u4ef6\u8fdb\u884c\u5904\u7406\uff0cFNR \u4f1a\u5728\u5904\u7406\u5b8c\u5f53\u524d\u6587\u4ef6\u65f6\u91cd\u7f6e\u590d\u4f4d\uff1b\u800c NR \u5219\u4f1a\u7ee7\u7eed\u7d2f\u8ba1\uff0c\u76f4\u5230\u5904\u7406\u5b8c\u6240\u6709\u7684\u6587\u4ef6\u3002  </li> </ol> <p>\u5728\u5904\u7406\u5355\u6587\u4ef6\u6216\u4e0d\u9700\u8981\u591a\u6587\u4ef6\u7d2f\u8ba1\u8bb0\u5f55\u6570\u65f6\uff0c\u5efa\u8bae\u4f7f\u7528 FNR\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#line-range","title":"line-range","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u6253\u5370\u9664\u7b2c\u4e00\u884c\u4e4b\u5916\u7684\u6240\u6709\u884c\uff08\u8bb0\u5f55\uff09\uff1a</p> <pre><code># \u65b9\u6cd5\u4e00\uff1a\u524d\u7f6e\u4e0d\u7b26\u5408\u6761\u4ef6\u7565\u8fc7\n$ awk 'NR==1 { next; } {print $0}' data2.txt\n# \u65b9\u6cd5\u4e8c\uff1a\u524d\u7f6e\u6761\u4ef6\u7ea6\u675f\uff08\u7701\u7565\u9ed8\u8ba4\u52a8\u4f5c\uff09\n$ awk 'NR&gt;1' data2.txt\nTwo lines of test text.\nThree lines of test text.\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u53ea\u6253\u5370\u524d\u4e24\u6761\u8bb0\u5f55\uff1a</p> <pre><code># \u65b9\u6cd5\u4e00\uff1a\u524d\u7f6e\u6761\u4ef6\u7ea6\u675f\uff0c\u9ed8\u8ba4\u52a8\u4f5cprint\u53ef\u7701\n$ id `whoami` | awk 'BEGIN {RS=\" \";} FNR&lt;=2 {print}'\n\n# \u65b9\u6cd5\u4e8c\uff1a\u540e\u7f6e\u8fb9\u754c\u9000\u51fa\n$ id `whoami` | awk 'BEGIN {RS=\" \";} {print} FNR==2{exit}'\n</code></pre> <p>\u8981\u6253\u5370\u51fa\u4ece M \u884c\u5230 N \u884c\u8fd9\u4e2a\u8303\u56f4\u5185\u7684\u6587\u672c\u5185\u5bb9\uff0c\u53ef\u4f7f\u7528\u4e0b\u9762\u7684\u8bed\u6cd5\uff1a</p> <pre><code>$ awk 'FNR==M, FNR==N' filename\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u7528stdin\u4f5c\u4e3a\u8f93\u5165\uff1a</p> <pre><code>$ cat filename | awk 'FNR==M, FNR==N'\n</code></pre> <p>\u53ea\u6253\u5370\u524d\u4e24\u884c\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a FNR \u884c\u53f7\u533a\u95f4\u5b9e\u73b0\uff1a</p> <pre><code># \u65b9\u6cd5\u4e09\uff1a\u524d\u7f6e\u7ea6\u675f\uff0c\u9650\u5b9aNR\u533a\u95f4\uff0c\u9ed8\u8ba4\u52a8\u4f5cprint\u53ef\u7701\n$ id `whoami` | awk 'BEGIN {RS=\" \";} FNR==1, FNR==2 {print}'\n</code></pre> <p>\u4ee5\u4e0b\u7b5b\u9009\u6253\u5370\u6587\u4ef6 grade.txt \u7684\u7b2c2~4\u884c\uff1a</p> <pre><code>$ awk 'FNR==2, FNR==4' grade.txt\nJ.Lulu      06/99   48317   green       9   24  26\nP.Bunny     02/99   48      Yellow      12  35  28\nJ.Troll     07/99   4842    Brown-3     12  26  26\n</code></pre> <p>\u6253\u5370 CSV \u6587\u4ef6\u7b2c2\u52304\u884c\u7684\u7b2c2\u4e2a\u5b57\u6bb5\uff1a</p> <pre><code>awk -F ',' 'FNR==2, FNR==4 {print $2}' issue_data-LineTooLong.csv\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#csv-analyze","title":"csv-analyze","text":"<p>CSV\uff08Comma-Separated Values\uff09\u5373\u9017\u53f7\u5206\u5272\u503c\uff0c\u6709\u65f6\u4e5f\u79f0\u4e3a\u5b57\u7b26\u5206\u5272\u503c\u3002 \u56e0\u4e3a\u5206\u5272\u5b57\u7b26\u4e5f\u53ef\u4ee5\u4e0d\u662f\u9017\u53f7\uff0c\u5176\u6587\u4ef6\u4ee5\u7eaf\u6587\u672c\u5f62\u5f0f\u5b58\u50a8\u8868\u683c\u6570\u636e\uff08\u6570\u5b57\u548c\u6587\u672c\uff09\u3002</p> <p>\u5728 CSV \u6587\u672c\u6587\u4ef6\u4e2d\uff0c\u6bcf\u6761\u8bb0\u5f55\u5360\u4e00\u884c\uff0c\u6bcf\u4e00\u884c\u4ee5\u9017\u53f7\u4f5c\u4e3a\u4e3a\u5206\u5272\u7b26\uff0c\u9017\u53f7\u524d\u540e\u7684\u7a7a\u683c\u4f1a\u88ab\u5ffd\u7565\u3002</p> <p>linux awk\u89e3\u6790csv\u6587\u4ef6 </p> <p>\u8bfb\u53d6CSV\u7b2c1\u884c\u5373\u8868\u5934\uff1a</p> <pre><code>$ awk 'FNR==1' dependence.csv\nSubModule,Header,Class,Method,Macro\n</code></pre> <p>\u8bfb\u53d6\u6240\u6709\u8bb0\u5f55\u7684\u7b2c1\u5217\uff1a</p> <pre><code>awk -F ',' 'FNR&gt;1{print $1}' dependence.csv\n</code></pre> <p>\u5bf9\u7b2c1\u5217\u8fdb\u884c\u53bb\u91cd\u8f93\u51fa\uff1a</p> <pre><code>awk -F ',' 'FNR&gt;1{print $1}' dependence.csv | uniq\n</code></pre> <p>\u5bf9\u7b2c1\u5217\u8fdb\u884c\u5408\u5e76\u7edf\u8ba1\u548c\u53bb\u91cd\u7edf\u8ba1\uff1a</p> <pre><code>awk -F ',' 'FNR&gt;1{print $1}' dependence.csv | uniq -c\nawk -F ',' 'FNR&gt;1{print $1}' dependence.csv | uniq | wc -l\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#user-defined","title":"user-defined","text":"<p>\u8ddf\u5176\u4ed6\u5178\u578b\u7684\u7f16\u7a0b\u8bed\u8a00\u4e00\u6837\uff0cawk \u5141\u8bb8\u81ea\u5b9a\u4e49\u53d8\u91cf\u5728\u7a0b\u5e8f\u4ee3\u7801\u4e2d\u4f7f\u7528\u3002 awk \u81ea\u5b9a\u4e49\u53d8\u91cf\u540d\u53ef\u4ee5\u662f\u4efb\u610f\u6570\u76ee\u7684\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\uff0c\u4f46\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934\uff0c\u4e14\u533a\u5206\u5927\u5c0f\u5199\u3002  </p>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#assign_var","title":"assign var","text":"<p>\u5728 awk \u4e2d\u76f4\u63a5\u5f15\u7528 shell \u4e0a\u4e0b\u6587\u7684\u53d8\u91cf\u62a5\u9519\uff1a</p> <pre><code>$ test=\"cat\"\n$ sentence=\"The cat sat on the mat\"\n$ awk 'BEGIN {print index($sentence, $test)}'\nawk: illegal field $(), name \"sentence\"\n source line number 1\n</code></pre> <p>\u53ef\u901a\u8fc7 <code>-v</code> \u9009\u9879\u5c06 shell \u53d8\u91cf\u8d4b\u503c\u7ed9 awk \u5185\u90e8\u53d8\u91cf\uff0c\u518d\u5f15\u7528\u3002</p> <pre><code>$ index=`awk -v a=\"$sentence\" -v b=\"$test\" 'BEGIN{print index(a,b)}'`\n$ echo $index\n5\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#local_var","title":"local var","text":"<p>\u5728 awk \u7a0b\u5e8f\u811a\u672c\u4e2d\u7ed9\u53d8\u91cf\u8d4b\u503c\u548c\u5728 shell \u811a\u672c\u4e2d\u8d4b\u503c\u7c7b\u4f3c\uff0c\u90fd\u7528\u8d4b\u503c\u8bed\u53e5\u3002</p> <pre><code>$ awk 'BEGIN{testing=\"This is a test\"; print testing}'\nThis is a test\n\n$ awk 'BEGIN{x=4; x= x * 2 + 3; print x}'\n11\n</code></pre> <p>awk \u5f15\u7528\u5185\u90e8\u53d8\u91cf\u548c C \u8bed\u8a00\u76f8\u4f3c\uff0c\u4e0d\u7528 <code>$</code> \u7b26\u53f7\u3002</p> <p>\u4e5f\u53ef\u4ee5\u7528 awk \u547d\u4ee4\u884c\u6765\u7ed9\u7a0b\u5e8f\u4e2d\u7684\u53d8\u91cf\u8d4b\u503c\uff0c\u8fd9\u5141\u8bb8\u4f60\u5728\u6b63\u5e38\u7684\u4ee3\u7801\u4e4b\u5916\u8d4b\u503c\uff0c\u5373\u65f6\u6539\u53d8\u53d8\u91cf\u7684\u503c\u3002</p>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#cmd_var","title":"cmd var","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528\u547d\u4ee4\u884c\u53d8\u91cf\u4f20\u53c2\uff0c\u6765\u663e\u793a\u6587\u4ef6\u4e2d\u7279\u5b9a\u6570\u636e\u5b57\u6bb5\u3002</p> <pre><code>$ cat script1.awk\nBEGIN{FS=\",\"}\n{print $n}\n\n$ awk -f script1.awk n=2 data1\ndata12\ndata22\ndata32\n\n$ awk -f script1.awk n=3 data1\ndata13\ndata23\ndata33\n</code></pre> <p>\u4f46\u662f\uff0c\u4f7f\u7528\u547d\u4ee4\u884c\u53c2\u6570\u6765\u5b9a\u4e49\u53d8\u91cf\u503c\u4f1a\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u547d\u4ee4\u884c\u4f20\u53c2\u5176\u503c\u5728 BEGIN \u90e8\u5206\u4e0d\u53ef\u7528\u3002</p> <pre><code>$ cat script2.awk\nBEGIN{print \"The starting value is\",n; FS=\",\"}\n{print $n}\n\n$ awk -f script2.awk n=3 data1\nThe starting value is\ndata13\ndata23\ndata33\n</code></pre> <p>\u53ef\u4ee5\u7528 <code>-v</code> \u547d\u4ee4\u884c\u53c2\u6570\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u5b83\u5141\u8bb8\u5728 BEGIN \u4ee3\u7801\u4e4b\u524d\u8bbe\u5b9a\u53d8\u91cf\u3002 \u5728\u547d\u4ee4\u884c\u4e0a\uff0c<code>-v</code> \u547d\u4ee4\u884c\u53c2\u6570\u5fc5\u987b\u653e\u5728\u811a\u672c\u4ee3\u7801\u4e4b\u524d\u3002</p> <pre><code>$ awk -v n=3 -f script2.awk data1\nThe starting value is 3\ndata13\ndata23\ndata33\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#array","title":"array","text":"<p>for \u8bed\u53e5\u4f1a\u5728\u6bcf\u6b21\u5faa\u73af\u65f6\u5c06\u5173\u8054\u6570\u7ec4array\u7684\u4e0b\u4e00\u4e2a\u7d22\u5f15\u503c\u8d4b\u7ed9\u53d8\u91cfvar\uff0c\u7136\u540e\u6267\u884c\u4e00\u904dstatements\u3002</p> <p>\u6ce8\u610f\uff1a</p> <ol> <li>\u8fd9\u4e2a\u53d8\u91cf\u4e2d\u5b58\u50a8\u7684\u662f \u7d22\u5f15\u503c \u800c\u4e0d\u662f\u6570\u7ec4\u5143\u7d20\u503c\uff1b  </li> <li>\u7d22\u5f15\u503c\u4e0d\u4f1a\u6309\u4efb\u4f55\u7279\u5b9a\u987a\u5e8f\u8fd4\u56de\uff0c\u53ea\u80fd\u4fdd\u8bc1\u7d22\u5f15\u503c\u548c\u6570\u636e\u503c\u7684\u5bf9\u5e94\u5173\u7cfb\uff1b  </li> </ol> <pre><code>$ awk 'BEGIN{\n    var[\"a\"] = 1\n    var[\"g\"] = 2\n    var[\"m\"] = 3\n    var[\"u\"] = 4\n    for (test in var)\n    {\n        print \"Index:\",test,\" - Value:\",var[test]\n    }\n}'\nIndex: g  - Value: 2\nIndex: m  - Value: 3\nIndex: u  - Value: 4\nIndex: a  - Value: 1\n</code></pre> <p>\u8fd9\u91cc\u7684\u201c\u6570\u7ec4\u201d\uff0c\u66f4\u50cf\u662f\u201c\u5b57\u5178\u201d\u7684\u6982\u5ff5\u3002\u7d22\u5f15\u4e3a\u5b57\u7b26\u4e32\uff0c\u5e76\u975e\u6574\u6570\u3002</p> <pre><code>$ awk 'BEGIN{\n    STR=\"mydoc.txt\"\n    print split(STR,components,\".\")\n    print \"prefix=\"components[\"1\"]\n    print \"suffix=\"components[\"2\"]\n}'\n2\nprefix=mydoc\nsuffix=txt\n</code></pre>","tags":["awk"]},{"location":"blog/20191105/awk-vars/#delete","title":"delete","text":"<p>\u4ece\u5173\u8054\u6570\u7ec4\u4e2d\u5220\u9664\u6570\u7ec4\u7d22\u5f15\u8981\u7528\u4e00\u4e2a\u7279\u6b8a\u7684\u547d\u4ee4\u3002</p> <pre><code>delete array[index]\n</code></pre> <p>\u5220\u9664\u547d\u4ee4\u4f1a\u4ece\u6570\u7ec4\u4e2d\u5220\u9664\u5173\u8054\u7d22\u5f15\u503c\u548c\u76f8\u5173\u7684\u6570\u636e\u5143\u7d20\u503c\u3002</p> <pre><code>$ awk 'BEGIN{\n    var[\"a\"] = 1\n    var[\"g\"] = 2\n    var[\"m\"] = 3\n    var[\"u\"] = 4\n    for (test in var)\n    {\n        print \"Index:\",test,\" - Value:\",var[test]\n    }\n\n    delete var[\"g\"]\n\n    print \"---\"\n    for (test in var)\n    {\n        print \"Index:\",test,\" - Value:\",var[test]\n    }\n}'\nIndex: g  - Value: 2\nIndex: m  - Value: 3\nIndex: u  - Value: 4\nIndex: a  - Value: 1\n---\nIndex: m  - Value: 3\nIndex: u  - Value: 4\nIndex: a  - Value: 1\n</code></pre>","tags":["awk"]},{"location":"blog/20191104/sed-NDP/","title":"Linux Command - sed NDP","text":"<p>Linux \u4e0b\u7684 sed \u547d\u4ee4\u8fdb\u9636\u64cd\u4f5c \u2014\u2014 NDP\u3002</p>","tags":["sed"]},{"location":"blog/20191104/sed-NDP/#next","title":"next","text":"","tags":["sed"]},{"location":"blog/20191104/sed-NDP/#n","title":"n","text":"<p><code>n</code> \u547d\u4ee4\u8ba9 sed \u7f16\u8f91\u5668\u79fb\u52a8\u5230\u6307\u5b9a\u884c\u6216\u6a21\u5f0f\u5339\u914d\u884c\u7684\u4e0b\u4e00\u884c\uff08\u76f8\u5f53\u4e8e\u7565\u8fc7\u4e00\u884c\uff09\uff0c\u518d\u6267\u884c\u64cd\u4f5c\u3002</p> <p>\u5bf9\u7167 awk \u4e2d\u7684 <code>getline</code> \u51fd\u6570\u3002</p> <pre><code>$ cat data2.txt\nThis is the header line.\nThis is the first data line.\nThis is the second data line.\nThis is the last line.\n\n# sed '/header/{n ; d}' data2.txt\n$ sed '/header/{n;d\nquote&gt; }' data2.txt\nThis is the header line.\nThis is the second data line.\nThis is the last line.\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-NDP/#n_1","title":"N","text":"<p>\u5355\u884c next \u547d\u4ee4\u4f1a\u5c06\u6570\u636e\u6d41\u4e2d\u7684\u4e0b\u4e00\u6587\u672c\u884c\u79fb\u52a8\u5230 sed \u7f16\u8f91\u5668\u7684\u5de5\u4f5c\u7a7a\u95f4\uff08\u79f0\u4e3a <code>\u6a21\u5f0f\u7a7a\u95f4</code>\uff09\u3002</p> <p>\u591a\u884c\u7248\u7684 next \u547d\u4ee4\uff08N\uff09\u4f1a\u5c06\u4e0b\u4e00\u6587\u672c\u884c\u6dfb\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u5df2\u6709\u7684\u6587\u672c\u540e\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0csed \u7f16\u8f91\u5668\u811a\u672c\u67e5\u627e\u5305\u542b\u5355\u8bcd <code>first</code> \u7684\u884c\uff0c\u7136\u540e\u5c06\u4e0b\u4e00\u884c\u5408\u5e76\u5230\u540c\u4e00\u6a21\u5f0f\u7a7a\u95f4\u4e2d\uff0c\u6267\u884c\u66ff\u6362\u64cd\u4f5c\u3002 \u5c06\u6362\u884c\u7b26\u66ff\u6362\u4e3a\u7a7a\u683c\uff0c\u5b9e\u73b0\u5408\u5e76\u884c\u7684\u6548\u679c\u3002</p> <pre><code>$ sed '/first/{ N ; s/\\n/ / }' data2.txt\nsed: 1: \"/first/{ N ; s/\\n/ / }\": bad flag in substitute command: '}'\n\n$ sed '/first/{N ; s/\\n/ /\nquote&gt; }' data2.txt\nThis is the header line.\nThis is the first data line. This is the second data line.\nThis is the last line.\n</code></pre> <p>\u4ee5\u4e0b\u547d\u4ee4\uff0c\u67e5\u627e\u7279\u5b9a\u53cc\u8bcd\u77ed\u8bed <code>System Administrator</code> \u5e76\u6267\u884c\u66ff\u6362\u3002</p> <pre><code>$ cat data3.txt\nOn Tuesday, the Linux System\nAdministrator's group meeting will be held.\nAll System Administrators should attend.\nThank you for your attendance.\n\n$ sed 's/System Administrator/Desktop User/' data3.txt\nOn Tuesday, the Linux System\nAdministrator's group meeting will be held.\nAll Desktop Users should attend.\nThank you for your attendance.\n</code></pre> <p>\u4f46\u5bf9\u4e8e\u53cc\u8bcd\u77ed\u8bed\u5206\u6563\u5728\u4e24\u884c\u7684\u60c5\u5f62\uff0c\u66ff\u6362\u547d\u4ee4\u5c31\u65e0\u6cd5\u8bc6\u522b\u5339\u914d\u7684\u6a21\u5f0f\u4e86\u3002 \u8fd9\u65f6\uff0c<code>N</code> \u547d\u4ee4\u5c31\u6d3e\u4e0a\u7528\u573a\u4e86\u3002</p> <p>sed \u7f16\u8f91\u5668\u53d1\u73b0\u7b2c\u4e00\u4e2a\u5355\u8bcd\u7684\u90a3\u884c\u548c\u4e0b\u4e00\u884c\u5408\u5e76\u540e\uff0c\u5373\u4f7f\u77ed\u8bed\u5185\u51fa\u73b0\u4e86\u6362\u884c\uff0c\u4ecd\u7136\u53ef\u4ee5\u627e\u5230\u5b83\u3002 \u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u66ff\u6362\u547d\u4ee4\u5728 System \u548c Administrator \u4e4b\u95f4\u7528\u4e86\u901a\u914d\u7b26\uff08<code>.</code>\uff09\uff0c\u53ef\u5339\u914d\u7a7a\u683c\u548c\u6362\u884c\u7b26\u8fd9\u4e24\u79cd\u60c5\u51b5\uff0c\u4ece\u800c\u5b9e\u73b0\u8de8\u884c\u5339\u914d\u66ff\u6362\u3002</p> <pre><code>$ sed 'N ; s/System.Administrator/Desktop User/' data3.txt\nOn Tuesday, the Linux Desktop User's group meeting will be held.\nAll Desktop Users should attend.\nThank you for your attendance.\n</code></pre> <p>\u4f46\u662f\uff0c\u6709\u4e2a\u975e\u9884\u671f\u6548\u679c\uff1a\u5339\u914d\u5230\u6362\u884c\u7b26\u65f6\uff0c\u4ece\u5b57\u7b26\u4e32\u4e2d\u5220\u6389\u4e86\u6362\u884c\u7b26\uff0c\u5bfc\u81f4\u4e24\u884c\u5408\u5e76\u4e3a\u4e00\u884c\u3002 \u8981\u89e3\u51b3\u4ee5\u4e0a\u95ee\u9898\uff0c\u53ef\u4ee5\u5728 sed \u7f16\u8f91\u5668\u811a\u672c\u4e2d\u75282\u6761\u66ff\u6362\u547d\u4ee4\uff0c\u5206\u522b\u5339\u914d\u77ed\u8bed\u51fa\u73b0\u5728\u591a\u884c/\u5355\u884c\u4e2d\u7684\u60c5\u51b5\u3002</p> <pre><code># macOS\n$ sed 'N\nquote&gt; s/System\\nAdministrator/Desktop\\nUser/\nquote&gt; s/System Administrator/Desktop User/\nquote&gt; ' data3.txt\nOn Tuesday, the Linux DesktopnUser's group meeting will be held.\nAll Desktop Users should attend.\nThank you for your attendance.\n\n# raspberrypi\n$ sed 'N\nquote&gt; s/System\\nAdministrator/Desktop\\nUser/\nquote&gt; s/System Administrator/Desktop User/\nquote&gt; ' data3.txt\nOn Tuesday, the Linux Desktop\nUser's group meeting will be held.\nAll Desktop Users should attend.\nThank you for your attendance.\n</code></pre> <p>macOS \u4e0b\u4f9d\u7136\u4e0d\u884c\uff01\uff1f</p> <p>\u4ee5\u4e0a\u4ecd\u6709\u4e00\u4e2a\u5c0f\u95ee\u9898\uff0c\u603b\u662f\u5728\u6267\u884c sed \u7f16\u8f91\u5668\u547d\u4ee4\u524d\u5c06\u4e0b\u4e00\u884c\u6587\u672c\u8bfb\u5165\u5230\u6a21\u5f0f\u7a7a\u95f4\u3002 \u5f53\u5b83\u5230\u4e86\u6700\u540e\u4e00\u884c\u6587\u672c\u65f6\uff0c\u5c31\u6ca1\u6709\u4e0b\u4e00\u884c\u53ef\u8bfb\u4e86\uff0c\u4ece\u800c\u505c\u6b62\u6267\u884c\u3002 \u5982\u679c\u8981\u5339\u914d\u7684\u6587\u672c\u521a\u597d\u5728\u6700\u540e\u4e00\u884c\uff0c\u5219N\u547d\u4ee4\u4f1a\u9519\u8fc7\u3002</p> <pre><code>$ cat data4.txt\nOn Tuesday, the Linux System\nAdministrator's group meeting will be held.\nAll System Administrators should attend.\n</code></pre> <pre><code># raspberrypi\n$ sed 'N\nquote&gt; s/System\\nAdministrator/Desktop\\nUser/\nquote&gt; s/System Administrator/Desktop User/\nquote&gt; ' data4.txt\nOn Tuesday, the Linux Desktop\nUser's group meeting will be held.\nAll System Administrators should attend.\n</code></pre> <p>\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u5c06\u5355\u884c\u547d\u4ee4\u653e\u5230N\u547d\u4ee4\u524d\u9762\u6765\u89e3\u51b3\u3002</p> <pre><code># raspberrypi\n$ sed '\nquote&gt; s/System Administrator/Desktop User/\nquote&gt; N\nquote&gt; s/System\\nAdministrator/Desktop\\nUser/\nquote&gt; ' data4.txt\nOn Tuesday, the Linux Desktop\nUser's group meeting will be held.\nAll Desktop Users should attend.\n</code></pre> <p>\u73b0\u5728\uff0c\u67e5\u627e\u5355\u884c\u4e2d\u77ed\u8bed\u7684\u66ff\u6362\u547d\u4ee4\u5728\u6570\u636e\u6d41\u7684\u6700\u540e\u4e00\u884c\u4e5f\u80fd\u6b63\u5e38\u5de5\u4f5c\u4e86\u3002</p>","tags":["sed"]},{"location":"blog/20191104/sed-NDP/#d","title":"D","text":"<p>sed \u7f16\u8f91\u5668\u7528 <code>d</code> \u547d\u4ee4\u6765\u6267\u884c\u5355\u884c\u5220\u9664\u3002 \u4f46\u5f53 d \u547d\u4ee4\u548c N \u547d\u4ee4\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u53ef\u80fd\u975e\u9884\u671f\u5730\u5220\u9664\u6a21\u5f0f\u7a7a\u95f4\u7684\u8de8\u4e24\u884c\u3002  </p> <pre><code># raspberrypi\n$ sed 'N ; /System\\nAdministrator/d' data4.txt\nAll System Administrators should attend.\n</code></pre> <p>\u5982\u679c\u53ea\u60f3\u5220\u9664\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u7b2c\u4e00\u884c\uff0c\u53ef\u4f7f\u7528\u591a\u884c\u5220\u9664\u547d\u4ee4 <code>D</code>\u3002  </p> <pre><code>$ sed 'N ; /System\\nAdministrator/D' data4.txt\nAdministrator's group meeting will be held.\nAll System Administrators should attend.\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u5bf9\u4e8e\u7a7a\u884c\u53ca\u5176\u4e0b\u4e00\u884c\u7ec4\u6210\u7684\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u5339\u914d\u5230 header\uff0c\u5220\u9664\u7a7a\u884c\u3002</p> <pre><code># raspberrypi\n\n$ cat data5.txt\n\nThis is the header line.\nThis is a data line.\n\nThis is the last line.\n\n$ sed '/^$/{N ; /header/D}' data5.txt\nThis is the header line.\nThis is a data line.\n\nThis is the last line.\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-NDP/#p","title":"P","text":"<p>sed \u7f16\u8f91\u5668\u7528 <code>p</code> \u547d\u4ee4\u6765\u6267\u884c\u5355\u884c\u6253\u5370\u3002 \u4f46\u5f53 p \u547d\u4ee4\u548c N \u547d\u4ee4\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u53ef\u80fd\u975e\u9884\u671f\u5730\u6253\u5370\u6a21\u5f0f\u7a7a\u95f4\u7684\u8de8\u4e24\u884c\u3002  </p> <pre><code>$ sed -n 'N ; /System\\nAdministrator/p' data3.txt\nOn Tuesday, the Linux System\nAdministrator's group meeting will be held.\n</code></pre> <p>\u5982\u679c\u53ea\u60f3\u6253\u5370\u591a\u884c\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u7b2c\u4e00\u884c\uff0c\u53ef\u4ee5\u9009\u7528 <code>P</code> \u547d\u4ee4\u3002</p> <pre><code>$ sed -n 'N ; /System\\nAdministrator/P' data3.txt\nOn Tuesday, the Linux System\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-NDP/#hg","title":"hg","text":"<p>\u6a21\u5f0f\u7a7a\u95f4\uff08pattern space\uff09\u662f\u4e00\u5757\u6d3b\u8dc3\u7684\u7f13\u51b2\u533a\uff0c\u5728sed\u7f16\u8f91\u5668\u6267\u884c\u547d\u4ee4\u65f6\uff0c\u5b83\u4f1a\u4fdd\u5b58\u5f85\u68c0\u67e5\u7684\u6587\u672c\u3002</p> <p>sed\u7f16\u8f91\u5668\u8fd8\u63d0\u4f9b\u53e6\u4e00\u5757\u79f0\u505a \u4fdd\u6301\u7a7a\u95f4\uff08hold space\uff09\u7684\u7f13\u5b58\u533a\uff0c\u5728\u5904\u7406\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u67d0\u4e9b\u884c\u65f6\uff0c\u53ef\u4ee5\u7528\u4fdd\u6301\u7a7a\u95f4\u6765\u4e34\u65f6\u4fdd\u5b58\u4e00\u4e9b\u884c\u3002</p> <p>\u6709\u4ee5\u4e0b5\u6761\u547d\u4ee4\uff0c\u7531\u4e8e\u5728\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4\u4e4b\u95f4\u4ea4\u6362\uff1a</p> \u547d\u4ee4 \u63cf\u8ff0 <code>h</code> \u5c06\u6a21\u5f0f\u7a7a\u95f4\u590d\u5236\u5230\u4fdd\u6301\u7a7a\u95f4 <code>H</code> \u5c06\u6a21\u5f0f\u7a7a\u95f4\u9644\u52a0\u5230\u4fdd\u6301\u7a7a\u95f4 <code>g</code> \u5c06\u4fdd\u6301\u7a7a\u95f4\u590d\u5236\u5230\u6a21\u5f0f\u7a7a\u95f4 <code>G</code> \u5c06\u4fdd\u6301\u7a7a\u95f4\u9644\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4 <code>x</code> \u4ea4\u6362\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4\u7684\u5185\u5bb9 <pre><code>$ sed -n '/first/{h;p;n;p;g;p}' data2.txt\nsed: 1: \"/first/{h;p;n;p;g;p}\": extra characters at the end of p command\n\n$ sed -n '/first/{h;p;n;p;g;p\nquote&gt; }' data2.txt\nThis is the first data line.\nThis is the second data line.\nThis is the first data line.\n</code></pre> <ul> <li><code>h;p</code> : copy first to hold  </li> <li><code>n;p</code> : next line(second)  </li> <li><code>g;p</code> : restore from hold  </li> </ul> <p>\u901a\u8fc7\u4f7f\u7528\u4fdd\u6301\u7a7a\u95f4\u79fb\u52a8\u884c\u6765\u8f97\u8f6c\u817e\u632a\uff0c\u53ef\u4ee5\u6ee1\u8db3\u4e00\u4e9b\u7279\u6b8a\u7684\u7f16\u8f91\u9700\u6c42\u3002 \u53ef\u4ee5\u5f3a\u5236\u8f93\u51fa\u4e2d\u7684\u7b2c\u4e00\u4e2a\u6570\u636e\u884c\u51fa\u73b0\u5728\u7b2c\u4e8c\u4e2a\u6570\u636e\u884c\u540e\u9762\u3002 \u53bb\u6389\u7b2c\u4e00\u4e2ap\u547d\u4ee4\uff0c\u53ef\u4ee5\u5b9e\u73b0\u76f8\u53cd\u7684\u987a\u5e8f\u8f93\u51fa\u8fd9\u4e24\u884c\u3002</p> <pre><code>$ sed -n '/first/{h;n;p;g;p}' data2.txt\nsed: 1: \"/first/{h;n;p;g;p}\": extra characters at the end of p command\n\nsed -n '/first/{h;n;p;g;p\nquote&gt; }' data2.txt\nThis is the second data line.\nThis is the first data line.\n</code></pre> <ul> <li><code>h</code>   : copy first to hold  </li> <li><code>n;p</code> : next line(second)  </li> <li><code>g;p</code> : restore from hold  </li> </ul> <p>\u4f60\u751a\u81f3\u53ef\u4ee5\u7ed3\u5408\u8fd9\u4e9b\u65b9\u6cd5\u5b9e\u73b0\u5c06\u6574\u4e2a\u6587\u4ef6\u7684\u6587\u672c\u884c\u53cd\u8f6c\uff08Permute Lines: Reverse\uff09\u3002</p>","tags":["sed"]},{"location":"blog/20191104/sed-NDP/#_1","title":"!","text":"<p>\u611f\u53f9\u53f7\u547d\u4ee4\uff08<code>!</code>\uff09\u7528\u6765\u6392\u9664\uff08negate\uff09\u547d\u4ee4\uff0c\u4e5f\u5c31\u662f\u8ba9\u539f\u672c\u4f1a\u8d77\u4f5c\u7528\u7684\u547d\u4ee4\u4e0d\u8d77\u4f5c\u7528\u3002</p> <p>\u52a0\u4e86\u611f\u53f9\u53f7\u4e4b\u540e\uff0c\u5339\u914d\u7684\u90e8\u5206\u4e0d\u6267\u884cp\u547d\u4ee4\uff0c\u4e0d\u5339\u914d\u7684\u90e8\u5206\u6267\u884cp\u547d\u4ee4\u6253\u5370\u3002</p> <pre><code>$ sed -n '/header/!p' data2.txt\nThis is the first data line.\nThis is the second data line.\nThis is the last line.\n</code></pre> <p>\u5728N\u547d\u4ee4\u6346\u7ed1\u4e0b\u4e00\u884c\u5230\u6a21\u5f0f\u7a7a\u95f4\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u8981\u5339\u914d\u7684\u6587\u672c\u521a\u597d\u5728\u6700\u540e\u4e00\u884c\uff0c\u5219N\u547d\u4ee4\u4f1a\u9519\u8fc7\u3002 \u9664\u4e86\u4e0a\u9762\u7ed9\u51fa\u7684\u5148\u5339\u914d\u5355\u884c\u7684\u65b9\u6848\u5916\uff0c\u4e5f\u53ef\u4ee5\u7528\u611f\u53f9\u53f7\u6392\u9664\u6700\u540e\u4e00\u884c\u6346\u7ed1\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <pre><code># raspberrypi\n$ sed '$!N\nquote&gt; s/System\\nAdministrator/Desktop\\nUser/\nquote&gt; s/System Administrator/Desktop User/\nquote&gt; ' data4.txt\nOn Tuesday, the Linux Desktop\nUser's group meeting will be held.\nAll Desktop Users should attend.\n</code></pre> <p>\u5bf9\u6700\u540e\u4e00\u884c\uff0c\u4e0d\u6267\u884cN\u547d\u4ee4\uff0c\u9488\u5bf9\u5355\u884c\u64cd\u4f5c\u3002</p>","tags":["sed"]},{"location":"blog/20191104/sed-NDP/#tac","title":"tac","text":"<p>\u4e0b\u9762\uff0c\u6211\u4eec\u6765\u5bf9\u6587\u672c\u5b9e\u73b0\u884c\u9006\u8f6c\uff08linux \u4e2d\u7684 tac) \u529f\u80fd\u3002</p> <pre><code>$ cat data2.txt\nThis is the header line.\nThis is the first data line.\nThis is the second data line.\nThis is the last line.\n\n$ tac data2.txt\nThis is the last line.\nThis is the second data line.\nThis is the first data line.\nThis is the header line.\n</code></pre> <p>\u4ee5\u4e0b\u4e3a\u57fa\u4e8e sed \u7684 tac \u7b49\u6548\u5b9e\u73b0\uff1a</p> <pre><code>$ sed -n '{1!G; h; $p}' data2.txt\nThis is the last line.\nThis is the second data line.\nThis is the first data line.\nThis is the header line.\n</code></pre> <ol> <li>\u7b2c1\u884c\u4e0d\u6267\u884c <code>G</code> \u547d\u4ee4\uff0c\u6267\u884c <code>h</code> \u5c06\u6a21\u5f0f\u7a7a\u95f4\u590d\u5236\u5230\u4fdd\u6301\u7a7a\u95f4\uff1b  </li> <li>\u7b2c2\u884c\u81f3\u6700\u540e\u4e00\u884c\u6267\u884c <code>G</code> \u6307\u4ee4\uff0c\u5c06\u4fdd\u6301\u7a7a\u95f4\u9644\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4\uff08\u5f53\u524d\u884c\uff09\uff0c\u5f62\u6210\u9006\u5e8f\uff1b\u518d\u6267\u884c <code>h</code> \u6307\u4ee4\uff1b  </li> <li>\u6267\u884c\u5230\u6700\u540e\u4e00\u884c\uff0c\u5c06\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u6574\u4e2a\u6570\u636e\u6d41\u90fd\u6309\u884c\u53cd\u8f6c\u4e86\u4e4b\u540e\uff0c\u5f53\u8fbe\u5230\u6570\u636e\u6d41\u4e2d\u7684\u6700\u540e\u4e00\u884c\u65f6\uff0c\u6253\u5370\u6a21\u5f0f\u7a7a\u95f4\u6574\u4e2a\u6570\u636e\u6d41\u3002  </li> </ol>","tags":["sed"]},{"location":"blog/20191104/sed-NDP/#refs","title":"refs","text":"<p>How to use the Linux sed command - \u4f7f\u7528 sed \u547d\u4ee4\u8fdb\u884c\u590d\u5236\u3001\u526a\u5207\u548c\u7c98\u8d34</p>","tags":["sed"]},{"location":"blog/20191104/sed-basic/","title":"Linux Command - sed basic","text":"<p>Linux \u4e0b\u7684 sed \u547d\u4ee4\u57fa\u672c\u77e5\u8bc6\u3002</p> <p>shell \u811a\u672c\u6700\u5e38\u89c1\u7684\u4e00\u4e2a\u7528\u9014\u5c31\u662f\u5904\u7406\u6587\u672c\u6587\u4ef6\u3002\u68c0\u67e5\u65e5\u5fd7\u6587\u4ef6\u3001\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u3001\u5904\u7406\u6570\u636e\u5143\u7d20\uff0cshell \u811a\u672c\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5c06\u6587\u672c\u6587\u4ef6\u4e2d\u7684\u5404\u79cd\u6570\u636e\u7684\u65e5\u5e38\u5904\u7406\u4efb\u52a1\u81ea\u52a8\u5316\u3002</p> <p>\u5bf9\u4e8e\u65e5\u5e38\u5de5\u4f5c\u4e2d\u7684\u6587\u672c\u7f16\u8f91\u9700\u6c42\uff0c\u53ef\u4ee5\u9009\u62e9 vscode \u8fd9\u79cd GUI \u5ba2\u6237\u7aef\u6216 vim \u8fd9\u79cd CUI \u5ba2\u6237\u7aef\u8fdb\u884c\u64cd\u4f5c\uff0cvscode \u548c vim \u8fd9\u4e24\u79cd\u7f16\u8f91\u5668\u90fd\u652f\u6301\u901a\u8fc7\u9f20\u6807\u6216\u952e\u76d8\u6765\u5b8c\u6210\u4ea4\u4e92\u5f0f\u7f16\u8f91\u5de5\u4f5c\u3002</p> <p>\u6709\u65f6\u5019\u9700\u8981\u81ea\u52a8\u5904\u7406\uff08\u7f16\u8f91\uff09\u6587\u672c\u6587\u4ef6\uff0c\u4f46\u662f\u53c8\u4e0d\u60f3\u52a8\u7528\u5168\u526f\u6b66\u88c5\u7684\u4ea4\u4e92\u5f0f\u6587\u672c\u7f16\u8f91\u5668\u3002\u6b64\u65f6\uff0c\u9700\u8981\u4e00\u4e2a\u80fd\u591f\u5b9e\u73b0\u81ea\u52a8\u683c\u5f0f\u5316\u3001\u63d2\u5165\u3001\u4fee\u6539\u6216\u5220\u9664\u6587\u672c\u5143\u7d20\u7684\u7b80\u5355\u975e\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u7f16\u8f91\u5668\u3002</p> <p>Unix/Linux \u4e16\u754c\uff0c\u63d0\u4f9b\u4e86\u4e24\u4e2a\u5e7f\u6cdb\u4f7f\u7528\u7684\u547d\u4ee4\u884c\u7f16\u8f91\u5668\uff1a<code>sed</code> \u548c <code>awk</code>\u3002</p>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#sed","title":"sed","text":"<p>sed\uff08<code>s</code>tream <code>ed</code>itor\uff09\u610f\u5373\u6d41\u5f0f\u7f16\u8f91\u5668\uff0c\u548c\u666e\u901a\u7684\u4ea4\u4e92\u5f0f\u6587\u672c\u7f16\u8f91\u5668\u6070\u597d\u76f8\u53cd\u3002 \u6d41\u5f0f\u7f16\u8f91\u5668\u57fa\u4e8e\u9884\u5148\u63d0\u4f9b\u7684\u4e00\u7ec4\u89c4\u5219\u547d\u4ee4\u6765\u64cd\u4f5c\u6570\u636e\u6d41\uff0c\u5b9e\u73b0\u65e0\u4ea4\u4e92\u9759\u9ed8\u7f16\u8f91\u3002</p> <ol> <li>\u6d41 \u53ef\u4ee5\u662f\u7ba1\u9053\u91cd\u5b9a\u5411\u7684 STDIN\uff0c\u4e5f\u53ef\u4ee5\u662f\u6587\u4ef6\u3002  </li> <li>\u89c4\u5219 \u8981\u4e48\u4ece\u547d\u4ee4\u884c\u4e2d\u8f93\u5165\uff0c\u8981\u4e48\u5b58\u50a8\u5728\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\u4e2d\u3002  </li> </ol> <p>sed \u6d41\u7f16\u8f91\u5668\u7684\u57fa\u672c\u5904\u7406\u5355\u4f4d\u662f \u884c\uff0c\u5373\u6309\u987a\u5e8f\u9010\u884c\u5904\u7406\u3002\u5728\u6d41\u7f16\u8f91\u5668\u5c06\u6240\u6709\u547d\u4ee4\u4e0e\u4e00\u884c\u6570\u636e\u5339\u914d\u5b8c\u6bd5\u540e\uff0c\u4f1a\u8bfb\u53d6\u4e0b\u4e00\u884c\u6570\u636e\u5e76\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u76f4\u81f3\u5904\u7406\u5b8c\u6d41\u4e2d\u7684\u6240\u6709\u6570\u636e\u884c\u3002  </p> <p>sed \u7f16\u8f91\u5668\u4e00\u822c\u4f1a\u6267\u884c\u4e0b\u5217\u64cd\u4f5c\uff1a</p> <ol> <li>\u4e00\u6b21\u4ece\u8f93\u5165\u4e2d\u8bfb\u53d6\u4e00\u884c\u6570\u636e\uff1b  </li> <li>\u6839\u636e\u6240\u63d0\u4f9b\u7684\u7f16\u8f91\u5668\u547d\u4ee4\u5339\u914d\u6570\u636e\uff1b  </li> <li>\u6309\u7167\u547d\u4ee4\u4fee\u6539\uff08\u7f16\u8f91\uff09\u6d41\u4e2d\u7684\u6570\u636e\uff1b  </li> <li>\u5c06\u7f16\u8f91\u540e\u7684\u65b0\u7684\u6570\u636e\u8f93\u51fa\u5230 STDOUT\u3002  </li> </ol> <p>\u9700\u8981\u660e\u767d\u7684\u662f\uff0csed \u7f16\u8f91\u5668\u5e76\u4e0d\u4f1a\u4fee\u6539\u539f\u59cb\u6587\u672c\u6587\u4ef6\u7684\u5185\u5bb9\u3002\u5b83\u53ea\u662f\u5c06\u4fee\u6539\u540e\u7684\u6570\u636e\u53d1\u9001\u5230 STDOUT\uff0c\u539f\u59cb\u6587\u672c\u6587\u4ef6\u4f9d\u7136\u4fdd\u7559\u7740\u539f\u59cb\u6570\u636e\u3002 \u6216\u8005\u8bf4\uff0csed \u7f16\u8f91\u5668\u5e76\u4e0d\u4e0e\u521d\u59cb\u5316\u6587\u4ef6\u6253\u4ea4\u9053\uff0c\u5b83\u64cd\u4f5c\u7684\u53ea\u662f\u4e00\u4e2a\u62f7\u8d1d\uff0c\u7136\u540e\u6240\u6709\u7684\u6539\u52a8\u5982\u679c\u6ca1\u6709\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c06\u8f93\u51fa\u5230\u5c4f\u5e55\u3002  </p>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#format","title":"format","text":"<p>sed \u547d\u4ee4\u7684\u4e00\u822c\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>sed options command-script input-file\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#options","title":"options","text":"<p>sed \u4e3b\u8981\u67095\u4e2a\u5e38\u7528\u547d\u4ee4\u9009\u9879\uff1a</p> \u9009\u9879 \u63cf\u8ff0 <code>-n</code> \u6309\u884c\u8bfb\u53d6\u8f93\u5165\u65f6\uff0c\u4e0d\u9010\u884c\u56de\u663e\uff0c\u53ef\u4f7f\u7528 print \u547d\u4ee4\u8f93\u51fa\u6307\u5b9a\u884c <code>-e script</code> \u5728\u5904\u7406\u8f93\u5165\u4e2d\uff0c\u5c06 script \u4e2d\u6307\u5b9a\u7684\u547d\u4ee4\u6dfb\u52a0\u5230\u5df2\u6709\u7684\u547d\u4ee4\u4e2d <code>-f file</code> \u5728\u5904\u7406\u8f93\u5165\u4e2d\uff0c\u5c06 file \u4e2d\u6307\u5b9a\u7684\u547d\u4ee4\u6dfb\u52a0\u5230\u5df2\u6709\u7684\u547d\u4ee4\u4e2d <code>-E</code>(<code>-r</code>) \u652f\u6301\u6269\u5c55\u578b\u6b63\u5219\u8868\u8fbe\u5f0f\uff08ERE\uff09 <code>-i</code> \u7f16\u8f91\u5b8c\u56de\u5199\uff08Edit in-place\uff09 <p>\u5176\u4e2d <code>script</code> \u53c2\u6570\u6307\u5b9a\u4e86\u5e94\u7528\u4e8e\u6d41\u6570\u636e\u4e0a\u7684\u5355\u4e2a\u547d\u4ee4\u3002</p>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#-n","title":"-n","text":"<p>sed \u5728\u9010\u884c\u8bfb\u53d6\u5904\u7406\u8f93\u5165\u6587\u672c\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u5c06\u8bfb\u53d6\u5230\u7684\u6bcf\u4e00\u884c\u56de\u663e\u5230\u6807\u51c6\u63a7\u5236\u53f0\uff0c\u518d\u6267\u884c\u5904\u7406\u3002</p> <p><code>-n</code> \u9009\u9879\u5c06\u7981\u6b62 sed \u9ed8\u8ba4\u7684\u9010\u884c\u8bfb\u53d6\u56de\u663e\uff0c\u4f46\u6a21\u5f0f\u5339\u914d\u540e\u7684 <code>p</code> \u6807\u8bb0\u53ef\u6307\u5b9a\u8f93\u51fa\uff0c\u4e8c\u8005\u914d\u5408\u7684\u6548\u679c\u662f\u53ea\u8f93\u51fa\u5339\u914d\u5b9a\u4f4d\u7684\u884c\u3002</p> <pre><code># macOS/FreeBSD/Darwin\n    -n       By default, each line of input is echoed to the standard output\n         after all of the commands have been applied to it.  The -n option\n         suppresses this behavior.\n\n# unix/POSIX\n    -n\n    Suppress the default output (in which each line, after it is examined for editing, is written to standard output). Only lines explicitly selected for output are written.\n\n# linux\n       -n, --quiet, --silent\n\n              suppress automatic printing of pattern space\n</code></pre> <p>\u4ee5\u4e0b\u5728\u7b2c\u4e8c\u884c\u4e4b\u540e\u8ffd\u52a0\u4e00\u884c\uff0c\u9ed8\u8ba4\u4f1a\u6253\u5370\u6240\u6709\u884c\uff1a</p> <pre><code># macOS\n$ sed '2 a\\\nquote&gt; append one line after second line\nquote&gt; ' data.txt\n\nOne line of test text.\nTwo lines of test text.\nappend one line after second line\nThree lines of test text.\n</code></pre> <p>\u4ee5\u4e0b\u811a\u672c\u539f\u610f\u662f\u6253\u5370\u7b2c\u4e8c\u884c\uff0c\u4f46\u662f\u5374\u6253\u5370\u4e86\u6240\u6709\u884c\uff0c\u5916\u52a0\u6253\u5370\u7b2c\u4e8c\u884c\u3002</p> <pre><code>$ cat data.txt\nOne line of test text.\nTwo lines of test text.\nThree lines of test text.\n\n$ sed '2p' data.txt\nOne line of test text.\nTwo lines of test text.\nTwo lines of test text.\nThree lines of test text.\n</code></pre> <p>\u52a0\u4e0a <code>-n</code> \u4e4b\u540e\uff0c\u4e0d\u56de\u663e\u8bfb\u53d6\u7684\u884c\uff0c\u53ea\u6267\u884cp(rint)\u6253\u5370\u7b2c\u4e8c\u884c\uff0c\u7b26\u5408\u9884\u671f\u3002</p> <pre><code>$ sed -n '2p' data.txt\nTwo lines of test text.\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#-i","title":"-i","text":"<p><code>-i</code> \u9009\u9879\u652f\u6301\u5c06\u7f16\u8f91\u64cd\u4f5c\u7684\u7ed3\u679c\u56de\u5199\u5230\u6e90\u6587\u4ef6\u3002</p> <pre><code># macOS/FreeBSD/Darwin\n     -i extension\n         Edit files in-place similarly to -I, but treat each file indepen-\n         dently from other files.  In particular, line numbers in each\n         file start at 1, the \"$\" address matches the last line of the\n         current file, and address ranges are limited to the current file.\n         (See Sed Addresses.)  The net result is as though each file were\n         edited by a separate sed instance.\n\n     -I extension\n             Edit files in-place, saving backups with the specified extension.  If a zero-length extension\n             is given, no backup will be saved.  It is not recommended to give a zero-length extension when\n             in-place editing files, as you risk corruption or partial content in situations where disk\n             space is exhausted, etc.\n\n# linux\n\n       -i[SUFFIX], --in-place[=SUFFIX]\n\n              edit files in place (makes backup if SUFFIX supplied)\n</code></pre> <p><code>-i</code> \u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u5907\u4efd\u6587\u4ef6\u7684\u540e\u7f00\u3002</p> <p>\u5f53\u53ea\u56de\u5199\u800c\u4e0d\u9700\u8981\u5907\u4efd\u65f6\uff0cLinux/Unix \u5e73\u53f0\u53ef\u7701\u7565 -i extension \u53c2\u6570\u3002</p> <pre><code># macOS\u3001Linux\uff0c\u4fee\u6539\u56de\u5199\u4e4b\u524d\uff0c\u5148\u5907\u4efd Test.txt.bak\nsed -i '.bak' 's/main/fun/g' 'Test.txt'\n</code></pre> <p>\u6ce8\u610f\uff1a\u5728 macOS \u5e73\u53f0\u4e0a\uff0c\u5373\u4f7f\u4e0d\u9700\u8981\u5907\u4efd\uff0c\u4e5f\u5fc5\u987b\u6307\u5b9a -i extension \u53c2\u6570\u3002</p> <p>\u6b64\u65f6\uff0c\u53ef\u6307\u5b9a\u957f\u5ea6\u4e3a0\u7684\u7a7a\u5b57\u7b26\u4e32\uff1a</p> <pre><code># macOS\nsed -i '' 's/main/fun/g' 'Test.txt'\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#match","title":"match","text":"<p>\u56e0\u4e3a sed \u662f\u4e00\u4e2a\u975e\u4ea4\u4e92\u6027\u7f16\u8f91\u5668\uff0c\u5fc5\u987b\u901a\u8fc7\u884c\u53f7\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u6307\u5b9a\u8981\u64cd\u4f5c\u7684\u6587\u672c\u884c\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728 sed \u7f16\u8f91\u5668\u4e2d\u4f7f\u7528\u7684\u547d\u4ee4\u4f1a\u4f5c\u7528\u4e8e\u6587\u672c\u6570\u636e\u7684\u6240\u6709\u884c\u3002\u5982\u679c\u53ea\u60f3\u5c06\u547d\u4ee4\u4f5c\u7528\u4e8e\u7279\u5b9a\u884c\u6216\u67d0\u4e9b\u884c\uff0c\u5219\u5fc5\u987b\u8fdb\u884c\u884c\u5bfb\u5740\uff08line addressing\uff09\u6216\u6a21\u5f0f\u5339\u914d\u3002</p> <p>\u53ef\u89c1\uff0csed \u5b9a\u4f4d\u8981\u7f16\u8f91\u7684\u5bf9\u8c61\uff08\u6587\u672c\u884c\uff09\u7684\u65b9\u5f0f\u6709\u4e24\u79cd\uff1a</p> <ol> <li>\u4ee5\u6570\u5b57\u5f62\u5f0f\u6807\u793a\u884c\uff08\u533a\u95f4\uff09\uff1b  </li> <li>\u4f7f\u7528\u6587\u672c\u6a21\u5f0f\u6765\u8fc7\u6ee4\u51fa\u884c\uff1b  </li> </ol> <p></p> <p>\u884c\u53f7\u548c\u6a21\u5f0f\u53ef\u4ee5\u6df7\u5408\u754c\u5b9a\u533a\u95f4\uff1a</p> <ul> <li><code>/pattern/, line_number</code>: \u5339\u914d\u6a21\u5f0f\u5230\u6307\u5b9a\u884c\u533a\u95f4\uff1b  </li> <li><code>line_number, /pattern/</code>: \u6307\u5b9a\u884c\u5230\u5339\u914d\u6a21\u5f0f\u533a\u95f4\uff1b  </li> </ul>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#edit","title":"edit","text":"<p>sed \u63d0\u4f9b\u4e86\u4ee5\u4e0b\u7f16\u8f91\u547d\u4ee4\uff1a</p> <p></p>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#basic","title":"basic","text":"<p>\u4e0d\u6307\u5b9a input-file \u7684\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0csed \u7f16\u8f91\u5668\u4f1a\u5c06\u6307\u5b9a\u7684\u547d\u4ee4\u5e94\u7528\u5230 STDIN \u8f93\u5165\u6d41\u4e0a\u3002 \u8fd9\u6837\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06\u6570\u636e\u901a\u8fc7\u7ba1\u9053\u8f93\u5165 sed \u7f16\u8f91\u5668\u5904\u7406\u3002  </p>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#\u5728\u547d\u4ee4\u884c\u5b9a\u4e49\u7f16\u8f91\u5668\u547d\u4ee4","title":"\u5728\u547d\u4ee4\u884c\u5b9a\u4e49\u7f16\u8f91\u5668\u547d\u4ee4","text":"<p>\u5728\u547d\u4ee4\u884c\u4f7f\u7528 sed \u547d\u4ee4\u65f6\uff0c\u8981\u52a0\u5355\u5f15\u53f7\uff0c\u4e5f\u5141\u8bb8\u52a0\u53cc\u5f15\u53f7\u3002</p> <p>\u4ee5\u4e0b\u901a\u8fc7sed\u547d\u4ee4\u8fc7\u6ee4\u663e\u793a\u6587\u4ef6\u4e2d\u6307\u5b9a\u884c\u53f7\u5bf9\u5e94\u7684\u884c\uff1a</p> <pre><code># \u6253\u5370\u7b2c1\u884c\n$ sed -n '1p' file.txt\n\n# \u6253\u5370\u7b2c2\u884c\n$ sed -n '2p' file.txt\n\n# \u6253\u5370\u524d3\u884c\uff0c\u7136\u540e\u9000\u51fa\nsed '3 q' file.txt\n\n# \u6253\u5370\u7b2c4~8\u884c\nsed -n '4,8p' file.txt\n\n# \u6253\u5370\u672b\u5c3e\u884c\n$ sed -n '$p' file.txt\n\n# \u6253\u5370\u6574\u4e2a\u6587\u4ef6\n$ sed -n '1,$p' file.txt\n</code></pre> <p>\u4ee5\u4e0b\u901a\u8fc7sed\u547d\u4ee4\u8fc7\u6ee4\u4e0d\u663e\u793a\u6587\u4ef6\u4e2d\u6307\u5b9a\u884c\u53f7\u5bf9\u5e94\u7684\u884c\uff1a</p> <pre><code># \u6253\u5370\u9664\u7b2c3\u884c\u5916\u7684\u6240\u6709\u5176\u4ed6\u884c\nsed -n '3!p' file.txt\n\n# \u6253\u5370\u9664\u524d3\u884c\u5916\u7684\u6240\u6709\u5176\u4ed6\u884c\nsed -n '1,3!p' file.txt\n\n# \u6253\u5370\u9664\u7b2c2~4\u884c\u5916\u7684\u6240\u6709\u5176\u4ed6\u884c\nsed -n '2,4!p' file.txt\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#\u8f93\u51fa\u5230\u6587\u4ef6","title":"\u8f93\u51fa\u5230\u6587\u4ef6","text":"<p>\u7531\u4e8e\u4e0d\u4e0e\u6e90\u6587\u4ef6\u76f4\u63a5\u4ea4\u4e92\uff0c\u5982\u679c\u60f3\u8981\u4fdd\u5b58\u6539\u52a8\u7684\u5185\u5bb9\uff0c\u5c06\u6240\u6709\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u6587\u4ef6\u5373\u53ef\u3002</p> <p>\u4f8b\u5982\uff1a\u8fc7\u6ee4\u51fa input-file.txt \u6587\u4ef6\u4e2d\u6307\u5b9a\u8303\u56f4\u7684\u884c\u5230 output-file.txt \u6587\u4ef6\u3002</p> <pre><code>$ sed -n '100,199p' input-file.txt &gt; output-file.txt\n</code></pre> <p>\u6216\u4f7f\u7528 <code>w</code> \u5199\u5165\u547d\u4ee4\uff1a</p> <pre><code>$ sed -n '100,199 w output-file.txt' input-file.txt\n$ sed -n '100,199w output-file.txt' input-file.txt\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#\u6a21\u5f0f\u5339\u914d\u793a\u4f8b","title":"\u6a21\u5f0f\u5339\u914d\u793a\u4f8b","text":"<p>\u793a\u4f8b1\uff1a\u4ece bak.code.yml \u6587\u4ef6\u4e2d\u5339\u914d\u51fa CR owner \u89c4\u5219\u533a\u5757\uff0c<code>-n</code> \u6307\u5b9a\u53ea\u8f93\u51fa\u5339\u914d\u7ed3\u679c\uff1a</p> <pre><code>sed -n '/- path: \\/Classes\\/ui\\/DeviceMgr\\//,/owner_rule/p' bak.code.yml\n</code></pre> <p>\u793a\u4f8b2\uff1a\u8fc7\u6ee4\u6253\u5370 git \u51b2\u7a81\u6587\u4ef6\u4e2d ours \u90e8\u5206\uff1a</p> <pre><code>$ sed -n '/^&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD$/,/^=======$/p' git-Conflict-File.h\n</code></pre> <p>\u793a\u4f8b3\uff1a\u8fc7\u6ee4\u6253\u5370 git \u51b2\u7a81\u6587\u4ef6\u4e2d theirs incoming \u7ed3\u5c3e\u5206\u9694\u884c\uff08\u5f62\u5982 <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt; origin/master</code>\uff09\uff1a</p> <pre><code>$ sed -n '/^&gt;&gt;&gt;&gt;&gt;&gt;&gt; /p' git-Conflict-File.h\n</code></pre> <p>\u793a\u4f8b4\uff1a\u8fc7\u6ee4\u6253\u5370 git \u51b2\u7a81\u6587\u4ef6\u4e2d theirs \u90e8\u5206\uff1a</p> <pre><code>$ sed -n '/^=======$/,/^&gt;&gt;&gt;&gt;&gt;&gt;&gt; /p' git-Conflict-File.h\n</code></pre> <p><code>svn log -v | sed -n '/fan/,/-----$/ p'</code></p>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#\u5728\u547d\u4ee4\u884c\u4f7f\u7528\u591a\u4e2a\u7f16\u8f91\u5668\u547d\u4ee4","title":"\u5728\u547d\u4ee4\u884c\u4f7f\u7528\u591a\u4e2a\u7f16\u8f91\u5668\u547d\u4ee4","text":"<p>\u547d\u4ee4\u4e4b\u95f4\u5fc5\u987b\u7528\u5206\u53f7\uff08<code>;</code>\uff09\u9694\u5f00\uff0c\u5e76\u4e14\u5728\u547d\u4ee4\u672b\u5c3e\u548c\u5206\u53f7\u4e4b\u95f4\u4e0d\u80fd\u6709\u7a7a\u683c\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u6253\u5370\u7b2c2\u884c\u7684\u884c\u53f7\uff0c\u7136\u540e\u6253\u5370\u7b2c2\u884c\u7684\u5185\u5bb9\uff1a</p> <pre><code>$ sed -n '2=; 2p' detail.txt\n</code></pre> <p>\u4e5f\u53ef\u50cf grep \u90a3\u6837\uff0c\u901a\u8fc7 <code>-e</code> \u6307\u5b9a\u591a\u6761\u547d\u4ee4\uff1a</p> <pre><code>$ sed -n -e '2=' -e '2p' detail.txt\n</code></pre> <p>\u4ee5\u4e0b\u4e24\u53e5 sed \u547d\u4ee4\u7b49\u4ef7\uff0c\u90fd\u662f\u6253\u5370\u5339\u914d\u884c\u53f7\u548c\u884c\u5185\u5bb9\uff1a</p> <pre><code>sed -n -e '/ID:50/=; /ID:50/p' ss.txt\nsed -n -e '/ID:50/=' -e '/ID:50/p' ss.txt\n</code></pre> <p>\u5728\u5355\u884c\u4e0a\u6267\u884c\u591a\u6761\u547d\u4ee4\uff0c\u8fd8\u53ef\u4ee5\u7528\u82b1\u62ec\u53f7\uff08<code>{}</code>\uff09\u5c06\u591a\u6761\u547d\u4ee4\u7ec4\u5408\u5728\u4e00\u8d77\uff1a</p> <pre><code>sed -n '2{=;p}' detail.txt\nsed -n '/ID:50/{=;p}' ss.txt\n</code></pre> <p>\u4f46\u662f macOS \u4e0a\u4e0d\u652f\u6301\u8fd9\u79cd\u533a\u5757\u4ee3\u7801\u5728\u4e00\u884c\u6267\u884c\uff1a</p> <pre><code>$ sed -n '2{=;p}' detail.txt\nsed: 1: \"2{=;p}\": extra characters at the end of p command\n</code></pre> <p>\u9700\u8981\u5728 p \u547d\u4ee4\u5904\u6362\u884c\uff1a\u6362\u884c\u540e\u4f1a\u51fa\u73b0 \u6b21\u63d0\u793a\u7b26\uff08<code>qoute&gt;</code>\uff09 \uff0c\u8f93\u5165\u5c06\u95ed\u5408\u5927\u62ec\u53f7\u53ca\u5c01\u5c3e\u5355\u5f15\u53f7\uff0c\u6700\u540e\u8f93\u5165\u5904\u7406\u6587\u4ef6\u53c2\u6570\uff0c\u6362\u884c\u6267\u884c\u3002</p> <pre><code>$ sed -n '2{=;p\nquote&gt; }' detail.txt\n\n# \u6216\u8005\u8fd9\u6837\u5199\n\n$ sed -n '2{\nquote&gt; =\nquote&gt; p\nquote&gt; }' detail.txt\n</code></pre> <p>\u5fc5\u987b\u8981\u8bb0\u4f4f\uff0c\u8981\u5728\u5c01\u5c3e\u5355\u5f15\u53f7\u6240\u5728\u884c\u7ed3\u675f\u547d\u4ee4\u3002 bash shell \u547d\u4ee4\u4e00\u65e6\u53d1\u73b0\u4e86\u5c01\u5c3e\u7684\u5355\u5f15\u53f7\uff0c\u5c31\u4f1a\u6267\u884c\u547d\u4ee4\u3002 \u5f00\u59cb\u6267\u884c\u540e\uff0csed \u547d\u4ee4\u5c31\u4f1a\u5c06\u4f60\u6307\u5b9a\u7684\u6bcf\u6761\u547d\u4ee4\u5e94\u7528\u5230\u6587\u672c\u6587\u4ef6\u7684\u6bcf\u4e00\u884c\u4e0a\u3002</p> <p>\u4e5f\u53ef\u76f4\u63a5\u5c06\u5199\u597d\u7684\u8de8\u884c\u4ee3\u7801\u5757\u6574\u4f53\u590d\u5236\u7c98\u8d34\u5230\u547d\u4ee4\u884c\u6267\u884c\uff0c\u4e0d\u7528\u5728\u547d\u4ee4\u884c\u9010\u884c\u8f93\u5165\uff1a</p> <pre><code>sed -n '2{=;p\n    }' detail.txt\n\n# \u6216\u8005\u8fd9\u6837\u5199\n\nsed -n '2{\n    =\n    p\n}' detail.txt\n</code></pre> <p>\u5982\u679c\u4e0d\u6307\u5b9a\u884c\uff0c\u9ed8\u8ba4\u5bf9\u6570\u636e\u6d41\u9010\u884c\u5904\u7406\u3002\u4ee5\u4e0b\u9010\u884c\u6253\u5370\u884c\u53f7\u548c\u5185\u5bb9\uff1a</p> <pre><code>$ sed -n '{\n    =\n    p\n}' detail.txt\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#\u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7f16\u8f91\u5668\u547d\u4ee4","title":"\u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7f16\u8f91\u5668\u547d\u4ee4","text":"<p>\u5982\u679c\u6709\u5927\u91cf\u8981\u5904\u7406\u7684 sed \u547d\u4ee4\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u5b83\u4eec\u653e\u8fdb\u4e00\u4e2a\u5355\u72ec\u7684\u811a\u672c\u6587\u4ef6\u4e2d\u3002 sed \u547d\u4ee4\u901a\u8fc7 <code>-f</code> \u9009\u9879\u6765\u6307\u5b9a\u4ece\u811a\u672c\u6587\u4ef6\u8bfb\u53d6\u547d\u4ee4\u6267\u884c\u3002</p> <pre><code>$ cat script1.sed\ns/brown/green/\ns/fox/elephant/\ns/dog/cat/\n\n$ sed -f script1.sed detail.txt\nThe quick green elephant jumps over the lazy cat.\nThe quick green elephant jumps over the lazy cat.\nThe quick green elephant jumps over the lazy cat.\nThe quick green elephant jumps over the lazy cat.\n</code></pre> <p>\u5728\u811a\u672c\u6587\u4ef6\u4e2d\uff0c\u4e0d\u5fc5\u5728\u6bcf\u6761\u547d\u4ee4\u540e\u9762\u6dfb\u52a0\u4e00\u4e2a\u5206\u53f7\uff0csed \u7f16\u8f91\u5668\u77e5\u9053\u6bcf\u884c\u90fd\u662f\u4e00\u6761\u72ec\u7acb\u7684\u547d\u4ee4\u3002</p>","tags":["sed"]},{"location":"blog/20191104/sed-basic/#shebang","title":"shebang","text":"<p>\u4e5f\u53ef\u8003\u8651\u5728 sed \u811a\u672c\u5f00\u5934\u6dfb\u52a0 Shebang \u6807\u793a\u811a\u672c\u8bed\u8a00\u6267\u884c\u547d\u4ee4\u3002</p> <p>macOS: <code>#!/usr/bin/sed -f</code> linux: <code>#!/bin/sed -f</code> </p> <p>\u5177\u4f53\u6267\u884c <code>which sed</code> \u67e5\u770b sed \u547d\u4ee4\u4f4d\u7f6e\u3002</p> <p>\u8fd9\u6837\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u50cf\u6267\u884c shell \u811a\u672c\u4e00\u6837\uff0c\u8fd9\u6837\u4e66\u5199\uff1a</p> <pre><code>$ chmod u+x script1.sed\n\n$ ./script1.sed detail.txt\nThe quick green elephant jumps over the lazy cat.\nThe quick green elephant jumps over the lazy cat.\nThe quick green elephant jumps over the lazy cat.\nThe quick green elephant jumps over the lazy cat.\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/","title":"Linux Command - sed iacds","text":"<p>Linux \u4e0b\u7684 sed \u547d\u4ee4\u57fa\u672c\u64cd\u4f5c\u3002</p> <ul> <li>i: insert before;  </li> <li>a: append after;  </li> <li>c: change line;  </li> <li>d: delete line;  </li> <li>s: substitute;  </li> </ul>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#insert","title":"i(nsert)","text":"<p>\u63d2\u5165\u547d\u4ee4\uff08insert\uff09\u5728\u6307\u5b9a\u884c\u4e4b\u524d\u63d2\u5165\u65b0\u884c\u3002 \u63d2\u5165\u6587\u672c\u65f6\uff0c\u4e0d\u80fd\u6307\u5b9a\u8303\u56f4\uff0c\u53ea\u5141\u8bb8\u901a\u8fc7\u4e00\u4e2a\u5730\u5740\u6a21\u5f0f\u6307\u5b9a\u63d2\u5165\u4f4d\u7f6e\u3002  </p> <p>debian/raspberrypi \u4e0b\u53ef\u5355\u884c\u8f93\u5165\uff1a</p> <pre><code># raspberrypi\n$ echo \"Test Line 2\" | sed 'i Test Line 1'\nTest Line 1\nTest Line 2\n\n$ echo \"Test Line 2\" | sed 'i\\Test Line 1'\nTest Line 1\nTest Line 2\n</code></pre> <p>macOS \u4e0b\u5355\u884c\u6267\u884c\uff0c\u63d0\u793a\u547d\u4ee4 i \u540e\u9762\u9884\u671f\u8ddf\u4e00\u4e2a <code>\\</code>\uff1a</p> <pre><code># macOS\n$ echo \"Test Line 2\" | sed 'i Test Line 1'\nsed: 1: \"i Test Line 1\": command i expects \\ followed by text\n</code></pre> <p>i \u540e\u9762\u6dfb\u52a0\u53cd\u659c\u6760 <code>\\</code>\uff0c\u53c8\u63d0\u793a <code>\\</code> \u540e\u4e0d\u80fd\u6709\u5185\u5bb9\uff1a</p> <pre><code># macOS\n$ echo \"Test Line 2\" | sed 'i\\Test Line 1'\nsed: 1: \"i\\Test Line 1\": extra characters after \\ at the end of i command\nFAIL: 1\n</code></pre> <p>\u9700\u8981\u5728 <code>\\</code> \u5904\u6362\u884c\uff0c\u8de8\u884c\u6298\u884c\u8f93\u5165\uff1a</p> <pre><code># macOS\n$ echo \"Test Line 2\" | sed 'i\\\npipe quote&gt; Test Line 1'\nTest Line 1Test Line 2\n\n# \u9700\u8981\u663e\u5f0f\u6362\u884c\n\n$ echo \"Test Line 2\" | sed 'i\\\npipe quote&gt; Test Line 1\npipe quote&gt; '\nTest Line 1\nTest Line 2\n</code></pre> <p>\u4e0b\u9762\u793a\u4f8b\u63d2\u5165\u65b0\u884c\u5230\u6587\u4ef6\u7684\u7b2c\u4e09\u884c\u524d\uff1a</p> <pre><code>$ cat data6.txt\nThis is line number 1.\nThis is line number 2.\nThis is line number 3.\nThis is line number 4.\n</code></pre> <pre><code># macOS \u9700\u8981\u663e\u5f0f\u6362\u884c\n$ sed '3i\\\nquote&gt; This is an inserted line.\nquote&gt; ' data6.txt\nThis is line number 1.\nThis is line number 2.\nThis is an inserted line.\nThis is line number 3.\nThis is line number 4.\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#\u63d2\u5165\u591a\u884c","title":"\u63d2\u5165\u591a\u884c","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\u5728\u6240\u6709find\u67e5\u627e\u5230\u7684cpp\u6587\u4ef6\u5934\u90e8\u8865\u63d2\u4e00\u6761\u6807\u51c6\u7684\u7248\u6743\u58f0\u660e\uff1a</p> <pre><code># macOS\n$ find . -name \"*.cpp\" -print0 | xargs -I file -0 sed -i '' '1i\\\n// Tencent is pleased to support the open source community by making Mars available.\\\n// Copyright (C) 2016 THL A29 Limited, a Tencent company. All rights reserved.\\\n\n' file\n</code></pre> <p>\u6ce8\u610f\uff1a\u4e2d\u95f4\u591a\u884c\u672b\u5c3e\u9700\u8981\u6dfb\u52a0\u53cd\u659c\u6760\u7eed\u884c\uff01</p>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#append","title":"a(ppend)","text":"<p>\u8ffd\u52a0\u547d\u4ee4\uff08append\uff09\u5728\u6307\u5b9a\u884c\u4e4b\u540e\u6dfb\u52a0\u65b0\u884c\u3002 \u9644\u52a0\u6587\u672c\u65f6\uff0c\u4e0d\u80fd\u6307\u5b9a\u8303\u56f4\uff0c\u53ea\u5141\u8bb8\u901a\u8fc7\u4e00\u4e2a\u5730\u5740\u6a21\u5f0f\u6307\u5b9a\u9644\u52a0\u4f4d\u7f6e\u3002  </p> <p>debian/raspberrypi \u4e0b\u53ef\u5355\u884c\u8f93\u5165\uff1bmacOS \u4e0b\u9700\u6298\u884c\u8f93\u5165\uff1a</p> <pre><code># raspberrypi \u4e0b\u5355\u884c\u8f93\u5165\n$ echo \"Test Line 2\" | sed 'a Test Line 1'\n# macOS \u9700\u8981\u663e\u5f0f\u6362\u884c\n$ echo \"Test Line 2\" | sed 'a\\\npipe quote&gt; Test Line 1\npipe quote&gt; '\nTest Line 2\nTest Line 1\n</code></pre> <p>\u4e0b\u9762\u793a\u4f8b\u6dfb\u52a0\u65b0\u884c\u5230\u6587\u4ef6\u7684\u7b2c\u4e09\u884c\u540e\uff1a</p> <pre><code># raspberrypi \u4e0b\u5355\u884c\u8f93\u5165\n## \u884c\u53f7\u548c\u547d\u4ee4\u4e4b\u95f4\u7684\u7a7a\u683c\u53ef\u6709\u53ef\u65e0\n$ sed '3 a This is an appened line.' data6.txt\n## \u547d\u4ee4\u548c\u8ffd\u52a0\u6587\u672c\u4e4b\u95f4\u9700\u8981\u7a7a\u683c\u6216\u53cd\u659c\u6760\n$ sed '3a This is an appened line.' data6.txt\n$ sed '3a\\This is an appened line.' data6.txt\n\n# macOS \u9700\u8981\u663e\u5f0f\u6362\u884c\n$ sed '3 a\\\nquote&gt; This is an appened line.\nquote&gt; ' data6.txt\nThis is line number 1.\nThis is line number 2.\nThis is line number 3.\nThis is an appened line.\nThis is line number 4.\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#\u8ffd\u52a0\u591a\u884c","title":"\u8ffd\u52a0\u591a\u884c","text":"<p>\u4ee5\u4e0b\u5728\u7b2c\u4e09\u884c\u540e\u8ffd\u52a0\u4e24\u884c\uff0c\u6ce8\u610f\u6dfb\u52a0\u5fc5\u8981\u7684\u53cd\u659c\u6760\u7eed\u884c\u7b26\uff1a</p> <pre><code># raspberrypi \u4e0b\u5355\u884c\u8f93\u5165\n$ sed '3a append line 1\\nappend line 2' data6.txt\n# \u4ee5\u4e0b\u6362\u884c\u5199\u6cd5\uff0cappend line 1\u540e\u9700\u6dfb\u52a0\u7eed\u884c\u7b26\uff0c\u5426\u5219 append line 2 \u88ab\u89e3\u8bfb\u6210 a(ppend line 2)\n# \u7b2c3\u884c\u540e\u8ffd\u52a0 append line 1\uff0c\u5176\u4ed6\u884c\u540e\u90fd\u975e\u9884\u671f\u8ffd\u52a0\u4e86 ppend line 2\u3002\n$ sed '3 a append line 1\nappend line 2' data6.txt\nThis is line number 1.\nppend line 2\nThis is line number 2.\nppend line 2\nThis is line number 3.\nappend line 1\nppend line 2\nThis is line number 4.\nppend line 2\n\n# macOS \u9700\u8981a\u540e\u9762\u663e\u793a\u6362\u884c\uff0cappend line 2 \u540e\u9762\u7684\u7eed\u884c\u7b26\u53ef\u9009\n$ sed '3 a\\\nquote&gt; append line 1\\\nquote&gt; append line 2\nquote&gt; ' data6.txt\nThis is line number 1.\nThis is line number 2.\nThis is line number 3.\nappend line 1\nappend line 2\nThis is line number 4.\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#change","title":"c(hange)","text":"<p>\u4fee\u6539\u547d\u4ee4\uff08change\uff09\u5141\u8bb8\u4fee\u6539\u6570\u636e\u6d41\u4e2d\u6574\u884c\u6587\u672c\u7684\u5185\u5bb9\u3002 \u5b83\u548c\u63d2\u5165\u3001\u9644\u52a0\u547d\u4ee4\u7684\u5de5\u4f5c\u673a\u5236\u4e00\u6837\uff0c\u4f60\u5fc5\u987b\u5728 sed \u547d\u4ee4\u4e2d\u5355\u72ec\u6307\u5b9a\u65b0\u884c\u3002</p> <p>debian/raspberrypi \u4e0b\u53ef\u5355\u884c\u8f93\u5165\uff1bmacOS \u4e0b\u9700\u6298\u884c\u8f93\u5165\uff1a</p> <pre><code># raspberrypi\n$ sed '3 c This is a changed line.' data6.txt\n$ sed '3c This is a changed line.' data6.txt\n$ sed '3c\\This is a changed line.' data6.txt\n# macOS\u9700\u8981\u663e\u5f0f\u6362\u884c\n$ sed '3c\\\nquote&gt; This is a changed line.\nquote&gt; ' data6.txt\nThis is line number 1.\nThis is line number 2.\nThis is an changed line.\nThis is line number 4.\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#delete","title":"d(elete)","text":"<p>\u5220\u9664\u547d\u4ee4\uff08delete\uff09\u53ef\u4ee5\u5220\u9664\u6587\u672c\u6d41\u4e2d\u7684\u7279\u5b9a\uff08\u5339\u914d\uff09\u884c\u3002</p> <pre><code>$ sed '3d' data6.txt\nThis is line number 1.\nThis is line number 2.\nThis is line number 4.\n</code></pre> <ul> <li><code>sed '2,3d' data6.txt</code> : \u5220\u9664\u7279\u5b9a\u884c\u533a\u95f4\uff1b  </li> <li><code>sed '3,$d' data6.txt</code> : \u5220\u9664\u7279\u5b9a\u884c\u81f3\u6587\u672b\uff1b  </li> <li><code>sed '/number 1/d' data6.txt</code> : \u5220\u9664\u6a21\u5f0f\u5339\u914d\u884c\uff1b  </li> <li><code>sed '/^$/d' data6.txt</code> : \u5220\u9664\u6a21\u5f0f\u5339\u914d\uff08\u7a7a\u767d\uff09\u884c\uff1b  </li> </ul>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#pattern_range","title":"pattern range","text":"<p><code>sed '/1/,/3/d' data6.txt</code> : \u5220\u9664\u4e24\u4e2a\u6a21\u5f0f\u5339\u914d\u533a\u95f4\u7684\u884c\uff1b  </p> <p>\u5bf9\u4e8e\u5220\u9664\u6a21\u5f0f\u5339\u914d\u533a\u95f4\u884c\uff0c\u7b2c1\u4e2a\u6a21\u5f0f\u4f1a \u6253\u5f00 \u884c\u5220\u9664\u529f\u80fd\uff0c\u7b2c2\u4e2a\u6a21\u5f0f\u4f1a \u5173\u95ed \u884c\u5220\u9664\u529f\u80fd\u3002 sed \u7f16\u8f91\u5668\u4f1a\u5220\u9664\u4e24\u4e2a\u6307\u5b9a\u884c\u4e4b\u95f4\u7684\u6240\u6709\u884c\uff08\u5305\u62ec\u6307\u5b9a\u7684\u884c\uff09\u3002</p> <p>\u9700\u8981\u7279\u522b\u6ce8\u610f\u7684\u662f\uff0c\u53ea\u8981\u5339\u914d\u5230\u4e86\u5f00\u59cb\u6a21\u5f0f\uff0c\u5220\u9664\u529f\u80fd\u5c31\u4f1a\u6253\u5f00\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u610f\u5916\u7684\u7ed3\u679c\u3002 \u5982\u679c\u5f00\u59cb\u6a21\u5f0f\u89e6\u53d1\u4e86\u5220\u9664\uff0c\u4f46\u662f\u6ca1\u6709\u627e\u5230\u505c\u6b62\u6a21\u5f0f\uff0c\u90a3\u4e48\u4f1a\u5c06\u6570\u636e\u6d41\u5269\u4f59\u884c\u5168\u90e8\u5220\u9664\u3002</p> <p>\u4f8b\u5982\u4ee5\u4e0b\u547d\u4ee4\u53ef\u4ee5\u8fc7\u6ee4\u6253\u5370 git \u51b2\u7a81\u6587\u4ef6\u4e2d ours \u90e8\u5206\uff1a</p> <pre><code>$ sed -n '/^&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD$/,/^=======$/p' Git-Conflict.h\n</code></pre> <p>\u4f46\u662f\u5c06 p \u66ff\u6362\u4e3a d \u547d\u4ee4\uff0c\u5c1d\u8bd5\u5220\u9664 ours \u90e8\u5206\uff1f\u672a\u80fd\u5982\u613f\uff0c\u5220\u9664\u5168\u6587\uff0c\u8f93\u51fa\u4e3a\u7a7a\u3002</p> <p>Sed \u2013 Deleting Multiline Patterns</p> <p>\u8003\u8651\u5de5\u7a0b\u6839\u76ee\u5f55\u4e0b\u6709\u4ee5\u4e0b code owner \u7684 CR \u914d\u7f6e\u6587\u4ef6 <code>bak.code.yml</code>\uff1a</p> <pre><code>- path: /Classes/ui/DeviceMgr/PrinterTableView.h\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n- path: /Classes/ui/DeviceMgr/PrinterTableView.m\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n- path: /Classes/ui/DeviceMgr/PrinterDeviceCell.h\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n- path: /Classes/ui/DeviceMgr/PrinterDeviceCell.m\n  owners:\n  - zhangsan\n  - lisi\n  - wangwu\n  owner_rule: 1\n</code></pre> <p>\u4ee5\u4e0b sed \u8bed\u53e5\u4ece bak.code.yml \u4e2d\u67e5\u627e\u5339\u914d\u76ee\u5f55 <code>/Classes/ui/DeviceMgr/</code> \u5bf9\u5e94\u7684 CR \u89c4\u5219\u533a\u5757\uff1a</p> <pre><code>sed -n '/- path: \\/Classes\\/ui\\/DeviceMgr\\//,/owner_rule/p' bak.code.yml\n</code></pre> <p>\u79fb\u9664\u4ee5\u4e0a\u5339\u914d\u7684 CR owner \u89c4\u5219\u533a\u5757\uff0c\u5e76\u76f4\u63a5\u56de\u5199\u5230\u539f\u6587\u4ef6\uff1a</p> <pre><code># \u56de\u5199\u4e4b\u524d\uff0c\u5907\u4efd\u5230 bak.code.yml.bak\nsed -i '.bak' '/- path: \\/Classes\\/ui\\/DeviceMgr\\//,/owner_rule/d' bak.code.yml\n\n# \u6307\u5b9a\u5907\u4efd\u6269\u5c55\u540d\u4e3a\u7a7a\uff0c\u5373\u4e0d\u5907\u4efd\nsed -i '' '/- path: \\/Classes\\/ui\\/DeviceMgr\\//,/owner_rule/d' bak.code.yml\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#substitue","title":"s(ubstitue)","text":"<p>\u5728 string \u63d0\u5230 bash \u652f\u6301\u5185\u7f6e\u7684\u6a21\u5f0f\u5339\u914d\u66ff\u6362\uff08<code>${parameter/pattern/string}</code>\uff09\uff0c\u8be6\u60c5\u53c2\u8003 man bash \u4e2d\u7684 Parameter Expansion \u4e00\u8282\u3002</p> <p>sed\u652f\u6301s\u547d\u4ee4\uff08substitue\uff09\uff0c\u5bf9\u6587\u672c\u884c\u6267\u884c\u6a21\u5f0f\u5339\u914d\u548c\u66ff\u6362\u3002</p> <pre><code>s/pattern/replacement/flags\n\n[address[\uff0caddress]] s/pattern-to-find/replacement-pattern/[n g p w]\n</code></pre> <p>\u67094\u79cd\u53ef\u7528\u7684\u66ff\u6362\u6807\u8bb0\uff1a</p> <ul> <li><code>n</code>\uff1a\u8868\u660e\u65b0\u6587\u672c\u5c06\u66ff\u6362\u7b2cn\u5904\u6a21\u5f0f\u5339\u914d\u7684\u5730\u65b9\uff0c\u6807\u8bb0\u53ef\u6307\u5b9a\u66ff\u6362\u6bcf\u884c\u4e2d\u51fa\u73b0\u7684\u7b2cn\u5904\uff1b  </li> <li><code>g</code>\uff1a\u8868\u660e\u65b0\u6587\u672c\u5c06\u66ff\u6362\u6240\u6709\u6a21\u5f0f\u5339\u914d\u7684\u5730\u65b9\uff0c\u6807\u8bb0\u6307\u5b9a\u66ff\u6362\u6bcf\u884c\u4e2d\u5339\u914d\u7684\u6240\u6709\u5730\u65b9\uff1b  </li> <li><code>p</code>\uff1a\u8868\u660e\u539f\u5148\u884c\u7684\u5185\u5bb9\u8981\u6253\u5370\u51fa\u6765\uff0c\u4e00\u822c\u642d\u914d <code>-n</code> \u4f7f\u7528\uff1b  </li> <li><code>w</code>\uff1afile\uff0c\u5c06\u5339\u914d\u66ff\u6362\u7684\u7ed3\u679c\u5199\u5230\u6587\u4ef6\u4e2d\u3002  </li> </ul> <p>\u4e0d\u6307\u5b9a flags \u65f6\uff0c\u9ed8\u8ba4\u53ea\u66ff\u6362\u6bcf\u884c\u4e2d\u51fa\u73b0\u7684\u7b2c\u4e00\u5904\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u7528 <code>s</code> \u547d\u4ee4\u5b9e\u73b0\u5b57\u7b26\u4e32\u66ff\u6362\uff1a</p> <pre><code>$ echo \"This is a test\" | sed 's/test/big test/'\nThis is a big test\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u5c06\u6587\u4ef6\u4e2d\u7684 <code>dog</code> \u66ff\u6362\u4e3a <code>cat</code>\u3002</p> <pre><code>$ cat detail.txt\nThe quick brown fox jumps over the lazy dog.\nThe quick brown fox jumps over the lazy dog.\nThe quick brown fox jumps over the lazy dog.\nThe quick brown fox jumps over the lazy dog.\n</code></pre> <p>\u57fa\u4e8ebash\u5b57\u7b26\u4e32\u6a21\u5f0f\u5339\u914d\u66ff\u6362\u7684\u5199\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>$ sentence=\"The quick brown fox jumps over the lazy dog\"\n$ echo $sentence\nThe quick brown fox jumps over the lazy dog\n\n$ echo ${sentence/dog/cat}\nThe quick brown fox jumps over the lazy cat\n</code></pre> <p>\u57fa\u4e8e sed \u7684\u66ff\u6362\u547d\u4ee4\u5199\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>$ sed 's/dog/cat/' detail.txt\nThe quick brown fox jumps over the lazy cat.\nThe quick brown fox jumps over the lazy cat.\nThe quick brown fox jumps over the lazy cat.\nThe quick brown fox jumps over the lazy cat.\n</code></pre> <p>\u5f53 replacement \u4e3a\u7a7a\u65f6\uff0c\u76f8\u5f53\u4e8e\u5220\u9664\u6548\u679c\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u5c06 AAA \u66ff\u6362\u4e3a\u7a7a\uff0c\u76f8\u5f53\u4e8e\u79fb\u9664\uff1a</p> <pre><code># \u57fa\u4e8ebash\u5b57\u7b26\u4e32\u6a21\u5f0f\u5339\u914d\u66ff\u6362\n$ test_text=\"12312312343242AAAdfasdfasdfasdfasdfadAAAfsdgfsdfgfgfgdfgasdfg\"\n$ echo ${test_text//AAA/}\n12312312343242dfasdfasdfasdfasdfadfsdgfsdfgfgfgdfgasdfg\n\n# \u57fa\u4e8e sed \u66ff\u6362\u7684\u5199\u6cd5\u5982\u4e0b\n$ echo \"12312312343242AAAdfasdfasdfasdfasdfadAAAfsdgfsdfgfgfgdfgasdfg\" | sed 's/AAA//g'\n12312312343242dfasdfasdfasdfasdfadfsdgfsdfgfgfgdfgasdfg\n</code></pre> <p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5178\u578b\u7684 s \u547d\u4ee4\u67e5\u627e\u5220\u9664\u793a\u4f8b\uff1a</p> <ul> <li><code>sed 's/^.//g docs.txt'</code>\uff1a\u5220\u9664\u884c\u9996\u7684\u4e00\u4e2a\u5b57\u7b26\uff1b  </li> <li><code>sed 's/^[0-9]//g docs.txt'</code>\uff1a\u5220\u9664\u884c\u9996\u7684\u4e00\u4e2a\u6570\u5b57\uff1b  </li> <li><code>sed 's/^0*//g docs.txt'</code>\uff1a\u5220\u9664\u884c\u9996\u7684\u6240\u67090\uff1b  </li> <li><code>sed 's/\\.$//g' docs.txt</code>\uff1a\u5220\u9664\u884c\u5c3e\u7684\u53e5\u70b9\uff1b  </li> <li><code>sed 's/##*//g' dos.txt</code>\uff1a\u5220\u9664\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u7684 <code>#</code> \u53f7\uff1b  </li> <li><code>sed 's/-*//g docs.txt'</code>\uff1a\u5220\u9664\u6240\u6709\u7684\u6a2a\u7ebf-\uff1b  </li> </ul>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#\u591a\u91cd\u66ff\u6362\u6a21\u5f0f","title":"\u591a\u91cd\u66ff\u6362\u6a21\u5f0f","text":"<p>\u5f53\u9700\u8981\u540c\u65f6\u5339\u914d\u591a\u4e2a\u6a21\u5f0f\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fde\u7eed\u91cd\u5b9a\u5411\u7ba1\u9053\u4f20\u9012\uff1a</p> <pre><code>$ cat detail.txt | sed 's/brown/green/' | sed 's/dog/cat/'\n</code></pre> <p>\u6267\u884c\u4e24\u6b21 s \u66ff\u6362\u547d\u4ee4\uff0c\u591a\u6761\u547d\u4ee4\u4e4b\u95f4\u7528\u5206\u53f7\uff08<code>;</code>\uff09\u9694\u5f00\uff1a</p> <pre><code>$ sed 's/brown/green/; s/dog/cat/' detail.txt\nThe quick green fox jumps over the lazy cat.\nThe quick green fox jumps over the lazy cat.\nThe quick green fox jumps over the lazy cat.\nThe quick green fox jumps over the lazy cat.\n</code></pre> <p>\u4e5f\u53ef\u57fa\u4e8e\u6b21\u63d0\u793a\u7b26\u6765\u8de8\u884c\u8f93\u5165\uff0c\u6bcf\u4e00\u884c\u662f\u4e00\u6761\u72ec\u7acb\u547d\u4ee4\uff0c\u884c\u5c3e\u4e0d\u7528\u8f93\u5165\u5206\u53f7\u3002</p> <pre><code>$ sed '\nquote&gt; s/brown/green/\nquote&gt; s/fox/elephant/\nquote&gt; s/dog/cat/' detail.txt\nThe quick green elephant jumps over the lazy cat.\nThe quick green elephant jumps over the lazy cat.\nThe quick green elephant jumps over the lazy cat.\nThe quick green elephant jumps over the lazy cat.\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>-e</code> \u9009\u9879\uff1a</p> <pre><code>$ sed -e 's/brown/green/' -e 's/fox/elephant/' -e 's/dog/cat/' detail.txt\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#\u66ff\u6362\u6a21\u5f0f\u5206\u9694\u7b26","title":"\u66ff\u6362\u6a21\u5f0f\u5206\u9694\u7b26","text":"<p>\u6709\u65f6\u4f60\u4f1a\u5728\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u9047\u5230\u4e00\u4e9b\u4e0d\u592a\u65b9\u4fbf\u5728\u66ff\u6362\u6a21\u5f0f\u4e2d\u4f7f\u7528\u7684\u5b57\u7b26\u3002 \u66ff\u6362\u6587\u4ef6\u4e2d\u7684\u8def\u5f84\u540d\u4f1a\u6bd4\u8f83\u9ebb\u70e6\u3002\u4f8b\u5982\uff0c\u7528 csh \u66ff\u6362 /etc/passwd \u6587\u4ef6\u4e2d\u7684 bash\uff1a</p> <pre><code>sed 's/\\/bin\\/bash/\\/bin\\/csh/' /etc/passwd\n</code></pre> <p>\u7531\u4e8e\u6b63\u659c\u7ebf\uff08<code>/</code>\uff09\u901a\u5e38\u7528\u4f5c\u8def\u5f84\u5206\u9694\u7b26\uff0c\u56e0\u800c\u5982\u679c\u5b83\u51fa\u73b0\u5728\u4e86\u6a21\u5f0f\u6587\u672c\u4e2d\u7684\u8bdd\uff0c\u5fc5\u987b\u7528\u53cd\u659c\u7ebf\u6765\u8f6c\u4e49\u3002 sed \u7f16\u8f91\u5668\u5141\u8bb8\u6307\u5b9a\u5176\u4ed6\u5b57\u7b26\u4f5c\u4e3a\u66ff\u6362\u5206\u9694\u6807\u8bb0\u7b26\uff1a</p> <pre><code>sed 's!/bin/bash!/bin/csh!' /etc/passwd\n</code></pre> <p>\u4e0a\u8ff0\u793a\u4f8b\u4e2d\uff0c\u611f\u53f9\u53f7 <code>!</code> \u88ab\u7528\u4f5cs\u547d\u4ee4\u5206\u9694\u7b26\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>#</code> \u53f7\u3002</p>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#\u5339\u914d\u6a21\u5f0f\u6574\u4f53\u5f15\u7528","title":"\u5339\u914d\u6a21\u5f0f\u6574\u4f53\u5f15\u7528","text":"<p>\u5982\u679c\u60f3\u5f15\u7528\u66ff\u6362\u547d\u4ee4\u4e2d\u5339\u914d\u7684\u6a21\u5f0f\u90e8\u5206\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>&amp;</code> \u7b26\u53f7\u5f15\u7528\u3002 <code>&amp;</code> \u547d\u4ee4\u4fdd\u5b58\u53d1\u73b0\u6a21\u5f0f\u4ee5\u4fbf\u5728\u66ff\u6362\u6a21\u5f0f\u4e2d\u5f15\u7528\u3002</p> <p>\u57fa\u4e8e <code>&amp;</code> \u7b26\u53f7\u5f15\u7528\uff0c\u53ef\u652f\u6301\u5728\u5339\u914d\u7684\u6a21\u5f0f\u524d\u540e\u9644\u52a0\u5185\u5bb9\u3002 \u5178\u578b\u7684\u4f8b\u5b50\u662f\uff0c\u5bf9\u5339\u914d\u7684\u6587\u672c\u6dfb\u52a0\u62ec\u53f7\u3001\u5f15\u53f7\u7b49\u5bf9\u79f0\u5c01\u95ed\u6807\u7b7e\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u7ed9\u5355\u8bcd c(h)at \u6dfb\u52a0\u53cc\u5f15\u53f7\uff1a</p> <pre><code>$ echo \"The cat sleeps in his hat.\" | sed 's/.at/\"&amp;\"/g'\nThe \"cat\" sleeps in his \"hat\".\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#before","title":"before","text":"<p>\u5728\u5339\u914d\u90e8\u5206\u7684\u524d\u9762\u63d2\u5165\u5185\u5bb9\uff1a</p> <pre><code>$ sed 's/line number/head &amp;/g' data6.txt\nThis is head line number 1.\nThis is head line number 2.\nThis is head line number 3.\nThis is head line number 4.\n</code></pre> <p>\u5982\u679c\u60f3\u5728\u884c\u9996\u63d2\u5165\uff0c\u5219\u8981\u8fd9\u4e48\u5199\uff1a</p> <pre><code>$ sed 's/.*line number/head &amp;/g' data6.txt\n# \u6216\n$ sed 's/.*line number.*/head &amp;/g' data6.txt\nhead This is line number 1.\nhead This is line number 2.\nhead This is line number 3.\nhead This is line number 4.\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#after","title":"after","text":"<p>\u5728\u5339\u914d\u90e8\u5206\u7684\u540e\u9762\u63d2\u5165\u5185\u5bb9\uff1a</p> <pre><code>$ sed 's/line number/&amp; tail/g' data6.txt\nThis is line number tail 1.\nThis is line number tail 2.\nThis is line number tail 3.\nThis is line number tail 4.\n</code></pre> <p>\u5728\u884c\u5c3e\u540e\u9762\u63d2\u5165\u5185\u5bb9\uff1a</p> <pre><code>$ sed 's/line number.*/&amp; tail/g' data6.txt\nThis is line number 1. tail\nThis is line number 2. tail\nThis is line number 3. tail\nThis is line number 4. tail\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#\u5206\u7ec4\u5b50\u6a21\u5f0f\u524d\u5411\u5f15\u7528","title":"\u5206\u7ec4\u5b50\u6a21\u5f0f\u524d\u5411\u5f15\u7528","text":"<p><code>&amp;</code> \u547d\u4ee4\u4f1a\u63d0\u53d6\u5339\u914d\u66ff\u6362\u547d\u4ee4\u4e2d\u6307\u5b9a\u6a21\u5f0f\u7684\u6574\u4e2a\u5b57\u7b26\u4e32\uff0c\u4f46\u6709\u65f6\u5019\u53ef\u80fd\u53ea\u60f3\u63d0\u53d6\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684\u4e00\u90e8\u5206\u3002</p> <p>sed \u7f16\u8f91\u5668\u7528\u5706\u62ec\u53f7\u6765\u5b9a\u4e49\u66ff\u6362\u6a21\u5f0f\u4e2d\u7684\u5b50\u6a21\u5f0f\uff0c\u66ff\u4ee3\u8868\u8fbe\u5f0f\u4e2d\u7528\u53cd\u659c\u6760\u548c\u6570\u5b57\u8868\u660e\u5b50\u6a21\u5f0f\u4f4d\u7f6e\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u5c06 System Administrator \u66ff\u6362\u4e3a System User\uff1a</p> <pre><code>$ echo \"The System Administrator manual\" | sed 's/\\(System\\) Administrator/\\1 User/'\nThe System User manual\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u5c06 c(h)at \u524d\u9762\u7684 furry \u79fb\u9664\uff1a</p> <pre><code>$ echo \"That furry cat is pretty\" | sed 's/furry \\(.at\\)/\\1/'\nThat cat is pretty\n\n$ echo \"That furry hat is pretty\" | sed 's/furry \\(.at\\)/\\1/'\nThat hat is pretty\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#insert_1","title":"insert","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\u901a\u8fc7 sed \u7684\u6b63\u5219\u5faa\u73af\u5339\u914d\uff0c\u5728\u6570\u5b57\u4e4b\u95f4\u6dfb\u52a0\u5343\u4f4d\u5206\u9694\u7b26\uff08Thousands Separators\uff09\u3002</p> <p>Thousands-Separators</p> <pre><code>$ echo \"12345678\" | sed '{\npipe quote&gt; :start\npipe quote&gt; s/\\(.*[0-9]\\)\\([0-9]\\{3\\}\\)/\\1,\\2/\npipe quote&gt; t start\npipe quote&gt; }'\n12,345,678\n</code></pre> <p>\u4ee5\u4e0a\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u4e24\u4e2a\u5b50\u6a21\u5f0f\uff1a</p> <ol> <li>\u7b2c\u4e00\u4e2a\u5b50\u6a21\u5f0f\u662f\u4ee5\u6570\u5b57\u7ed3\u5c3e\u7684\u4efb\u610f\u957f\u5ea6\u5b57\u7b26\uff1b  </li> <li>\u7b2c\u4e8c\u4e2a\u5b50\u6a21\u5f0f\u662f\u4e09\u4f4d\u6570\u5b57\uff1b  </li> </ol> <p>\u5982\u679c\u8fd9\u4e24\u79cd\u6a21\u5f0f\u5339\u914d\u627e\u5230\u4e86\uff0c\u5219\u5728\u5b83\u4eec\u4e4b\u95f4\u6dfb\u52a0\u4e00\u4e2a\u9017\u53f7\uff1a<code>12345,678</code> - <code>12,345,678</code>\u3002</p> <p>\u8fd9\u91cc\u7528\u5230\u4e86\u8df3\u8f6c\u6807\u7b7e\u548c\u6d4b\u8bd5\u547d\u4ee4\uff1a</p> <ol> <li>\u5982\u679c\u5339\u914d\u6210\u7acb\uff0c\u6ee1\u8db3 t \u6d4b\u8bd5\u6761\u4ef6\uff0c\u5219\u56de\u8df3\u5230\u6807\u7b7e start \u5904\u5faa\u73af\u6267\u884c\u4e0b\u4e00\u6b21\u5339\u914d\u3002  </li> <li>\u76f4\u5230\u6700\u540e\u4e00\u6b21\uff0c\u672a\u5339\u914d\u4e0a\u4e0d\u6ee1\u8db3 t \u6d4b\u8bd5\u6761\u4ef6\uff0c\u8fd0\u884c\u81f3\u5927\u62ec\u53f7\u7ed3\u675f\u3002  </li> </ol>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#extract","title":"extract","text":"<p>index.html \u4e2d base href \u7684\u683c\u5f0f\u4e3a <code>&lt;base href=\"/baseUrl/\"&gt;</code>\uff0c\u5982\u4f55\u63d0\u53d6 href \u7684\u503c <code>/baseUrl/</code> \uff1f</p> <p>\u5206\u6790\uff1a\u5de6\u4fa7\u4e3a\u56fa\u5b9a\u7684\u8d77\u59cb\u8fb9\u754c <code>&lt;base href=\"</code>\uff0c\u53f3\u4fa7\u4e3a\u56fa\u5b9a\u7ed3\u675f\u8fb9\u754c <code>\"&gt;</code>\uff0c\u4e2d\u95f4\u662f\u9700\u8981\u63d0\u53d6\u7684 <code>/baseUrl/</code> \u90e8\u5206\u3002</p> <p>\u5c06\u4e2d\u95f4\u9700\u8981\u63d0\u53d6\u7684\u90e8\u5206\u89c6\u4f5c\u4e00\u4e2a\u5206\u7ec4\u5b50\u6a21\u5f0f\uff0c\u7136\u540e\u5c06\u6574\u884c\u66ff\u6362\u4e3a\u4e2d\u95f4\u7684\u90e8\u5206\uff0c\u5373\u5b9e\u73b0\u4e86\u5b50\u6a21\u5f0f\u63d0\u53d6\u3002</p> <p>\u6ce8\u610f\uff1a\u9700\u8981\u8003\u8651\u5f00\u5934\u548c\u7ed3\u5c3e\u7684\u7a7a\u767d\u5b57\u7b26\u3002</p> <pre><code>$ sed 's/^.*&lt;base href=\"\\(.*\\)\"&gt;.*$/\\1/' index.html\n# \u6a21\u62df\u6d4b\u8bd5\u7528\u4f8b\n$ echo '&lt;base href=\"/\"&gt;' | sed 's/^.*&lt;base href=\"\\(.*\\)\"&gt;.*$/\\1/'\n$ echo '&lt;base href=\"/an:tgit/\"&gt;' | sed 's/^.*&lt;base href=\"\\(.*\\)\"&gt;.*$/\\1/'\n</code></pre> <p>\u601d\u8003\uff1abaseUrl \u4e24\u8fb9\u53ef\u80fd\u4f7f\u7528\u7684\u662f\u5355\u5f15\u53f7\uff0c\u5982\u4f55\u6539\u8fdb\u4ee5\u540c\u65f6\u9002\u914d\u5355\u3001\u53cc\u5f15\u53f7\u7684\u60c5\u51b5\uff1f</p> <p>\u8003\u8651\u8fd9\u6837\u4e00\u79cd\u573a\u666f\uff1a\u5c40\u57df\u7f51\u5185\u7684\u67d0\u53f0\u670d\u52a1\u5668\uff08raspi-ubuntu\uff09\u7531\u4e8e\u91c7\u7528\u4e86DHCP\uff0c\u5982\u4f55\u67e5\u627e\u5b83\u7684IP\u5730\u5740\uff0c\u4ee5\u4fbf\u8fdb\u884cSSH\u8fde\u63a5\u5462\uff1f</p> <p>\u5047\u8bbe\u6211\u4eec\u77e5\u9053\u8bbe\u5907wifi\u63a5\u53e3\uff08wlan0\uff09\u7684MAC\u5730\u5740\u662f\u4ee5 <code>dc:a6:32</code> \u5f00\u5934\uff0c\u90a3\u4e48\u5728 SSH \u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u901a\u8fc7 arp \u67e5\u8be2\u8be5 MAC \u5730\u5740\u5bf9\u5e94\u7684 IP\u3002</p> <pre><code>$ arp -a | grep \"dc:a6:32\"\n? (192.168.0.114) at dc:a6:32:**:**:** on en0 ifscope [ethernet]\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0carp \u547d\u4ee4\u8f93\u51fa\u7684 ARP \u62a5\u6587\u683c\u5f0f\u662f\u56fa\u5b9a\u7684\uff0c\u62ec\u53f7\u4e2d\u5373\u4e3a\u5bf9\u5e94\u8bbe\u5907\u5206\u914d\u5360\u7528\u7684 IP \u5730\u5740\u3002 \u90a3\u4e48\uff0c\u5982\u4f55\u63d0\u53d6\u8fd9\u4e2aIP\u5730\u5740\u5462\uff1f</p> <p>\u601d\u8def\u540c\u4e0a\uff0c\u5c06\u62ec\u53f7\u4e2d\u9700\u8981\u63d0\u53d6\u7684\u90e8\u5206\u89c6\u4f5c\u4e00\u4e2a\u5206\u7ec4\u5b50\u6a21\u5f0f\uff0c\u7136\u540e\u5c06\u6574\u884c\u66ff\u6362\u4e3a\u4e2d\u95f4\u7684\u90e8\u5206\uff0c\u5373\u5b9e\u73b0\u4e86\u5b50\u6a21\u5f0f\u63d0\u53d6\u3002</p> <ul> <li>\u754c\u5b9a\u5de6\u4fa7\u8fb9\u754c\uff1a<code>.*(</code>\uff1b  </li> <li>\u754c\u5b9a\u53f3\u4fa7\u8fb9\u754c\uff1a<code>).*</code>\uff1b  </li> <li>\u4e2d\u95f4\u90e8\u5206\u62ec\u53f7\u5f15\u7528\u4e3a\u5b50\u6a21\u5f0f  </li> </ul> <pre><code># sed\u524d\u5411\u5f15\u7528\uff0c\u66ff\u6362\u63d0\u53d6\u6307\u5b9a\u5b50\u6a21\u5f0f\n$ arp -na | grep \"dc:a6:32\" | sed 's/.*(\\(.*\\)).*/\\1/'\n</code></pre>","tags":["sed"]},{"location":"blog/20191104/sed-iacds/#replace","title":"replace","text":"<p>index.html \u4e2d base href \u7684\u683c\u5f0f\u4e3a <code>&lt;base href=\"/baseUrl/\"&gt;</code>\uff0c\u5982\u4f55\u5c06 href \u7684\u503c\u66ff\u6362\u4e3a <code>/an:coding/</code> \uff1f</p> <p>\u5206\u6790\uff1a</p> <ol> <li>\u5de6\u4fa7\u8d77\u59cb\u90e8\u5206\uff0c\u53ef\u5206\u7ec4\u5f15\u7528\u4e3a\u5b50\u6a21\u5f0f \\1 = <code>&lt;base href=\"</code>\uff1b  </li> <li>\u53f3\u4fa7\u7ed3\u675f\u90e8\u5206\uff0c\u53ef\u5206\u7ec4\u5f15\u7528\u4e3a\u5b50\u6a21\u5f0f \\2 = <code>\"&gt;</code>\uff1b  </li> <li>\u4e2d\u95f4\u53ef\u6807\u8bb0\u4e3a <code>.*</code>\uff0c\u5339\u914d href \u503c\u90e8\u5206\uff1b  </li> </ol> <p>\u57fa\u4e8e\u5b50\u6a21\u5f0f\u5206\u7ec4\u5f15\u7528\u5360\u4f4d\u9996\u5c3e\u8fb9\u754c\uff0c\u62fc\u63a5\u4e2d\u95f4\u90e8\u5206\u66ff\u6362\u4e3a\u65b0\u7684 href \u503c\uff08<code>/an:coding/</code>\uff09\uff0c\u5373\u8fbe\u76ee\u7684\u3002</p> <pre><code>$ sed 's/\\(&lt;base href=\"\\).*\\(\"&gt;\\)/\\1\\/an:coding\\/\\2/' index.html\n# \u6a21\u62df\u6d4b\u8bd5\u7528\u4f8b\n$ echo '&lt;base href=\"/\"&gt;' | sed 's/\\(&lt;base href=\"\\).*\\(\"&gt;\\)/\\1\\/an:coding\\/\\2/'\n$ echo '&lt;base href=\"/an:tgit/\"&gt;' | sed 's/\\(&lt;base href=\"\\).*\\(\"&gt;\\)/\\1\\/an:coding\\/\\2/'\n</code></pre> <p>\u601d\u8003\uff1abaseUrl \u4e24\u8fb9\u53ef\u80fd\u4f7f\u7528\u7684\u662f\u5355\u5f15\u53f7\uff0c\u5982\u4f55\u6539\u8fdb\u4ee5\u540c\u65f6\u9002\u914d\u5355\u3001\u53cc\u5f15\u53f7\u7684\u60c5\u51b5\uff1f</p>","tags":["sed"]},{"location":"blog/20191030/linux-7z/","title":"Linux Command - 7z","text":"<p>linux \u4e0b\u7684 \u538b\u7f29/\u89e3\u538b\u7f29 \u547d\u4ee4 \u2014\u2014 7z\u3002</p> <p>7-Zip P7ZIP </p> <p>\u6267\u884c <code>brew install p7zip</code> \u5b89\u88c5 7z \u547d\u4ee4\u884c\u5de5\u5177\uff1a</p>","tags":["7z"]},{"location":"blog/20191030/linux-7z/#7z","title":"7z","text":"<pre><code>faner@FAN-MB1 ~$ 7z\u21b5\n\n7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\np7zip Version 16.02 (locale=utf8,Utf16=on,HugeFiles=on,64 bits,8 CPUs x64)\n\nUsage: 7z &lt;command&gt; [&lt;switches&gt;...] &lt;archive_name&gt; [&lt;file_names&gt;...]\n       [&lt;@listfiles...&gt;]\n\n&lt;Commands&gt;\n  a : Add files to archive\n  b : Benchmark\n  d : Delete files from archive\n  e : Extract files from archive (without using directory names)\n  h : Calculate hash values for files\n  i : Show information about supported formats\n  l : List contents of archive\n  rn : Rename files in archive\n  t : Test integrity of archive\n  u : Update files to archive\n  x : eXtract files with full paths\n</code></pre>","tags":["7z"]},{"location":"blog/20191030/linux-7z/#man","title":"man","text":"<p><code>man 7z</code> \u67e5\u770b manual\uff1a</p>","tags":["7z"]},{"location":"blog/20191030/linux-7z/#synopsis","title":"SYNOPSIS","text":"<pre><code>NAME\n       7z - A file archiver with highest compression ratio\n\nSYNOPSIS\n       7z [adeltux] [-] [SWITCH] &lt;ARCHIVE_NAME&gt; &lt;ARGUMENTS&gt;...\n</code></pre>","tags":["7z"]},{"location":"blog/20191030/linux-7z/#description","title":"DESCRIPTION","text":"<pre><code>DESCRIPTION\n       7-Zip  is  a file archiver with the highest compression ratio. The program supports\n       7z (that implements LZMA compression algorithm), ZIP, CAB, ARJ, GZIP,  BZIP2,  TAR,\n       CPIO,  RPM and DEB formats. Compression ratio in the new 7z format is 30-50% better\n       than ratio in ZIP format.\n\n       7z uses plugins to handle archives.\n\n\nFUNCTION LETTERS\n       a      Add\n\n       d      Delete\n\n       e      Extract\n\n       l      List\n\n       t      Test\n\n       u      Update\n\n       x      eXtract with full paths\n\nSWITCHES\n\n       -t{Type}\n              Type of archive (7z, zip, gzip, bzip2 or tar. 7z format is default)\n\nSEE ALSO\n       7za(1), 7zr(1), bzip2(1), gzip(1), zip(1)\n</code></pre>","tags":["7z"]},{"location":"blog/20191030/linux-7z/#refs","title":"refs","text":"<ul> <li>7z\u547d\u4ee4\u884c\u4e0b\u7684\u6700\u5feb\u538b\u7f29\u548c\u89e3\u538b\u7f29\u8bf4\u660e </li> <li>\u7528\u547d\u4ee4\u884c\u7684\u65b9\u5f0f\u6765\u6267\u884c7z\u538b\u7f29\u548c\u89e3\u538b\u7f29 </li> </ul>","tags":["7z"]},{"location":"blog/20191030/linux-7z/#demo","title":"demo","text":"","tags":["7z"]},{"location":"blog/20191030/linux-7z/#add","title":"add","text":"<p><code>7z a avg_speed.7z files</code> :</p> <pre><code>FAN-MB1:zip $ 7z a avg_speed.7z ~/Downloads/Logs/*-avg_speed.log\n\n7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\np7zip Version 16.02 (locale=utf8,Utf16=on,HugeFiles=on,64 bits,8 CPUs x64)\n\nScanning the drive:\n4 files, 6856 bytes (7 KiB)\n\nCreating archive: avg_speed.7z\n\nItems to compress: 4\n\n\nFiles read from disk: 4\nArchive size: 1594 bytes (2 KiB)\nEverything is Ok\n</code></pre> <p><code>7z a map_image.7z</code> \uff1a</p> <pre><code>FAN-MB1:zip $ 7z a map_image.7z ~/Downloads/Images/map-*.png\n\n7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\np7zip Version 16.02 (locale=utf8,Utf16=on,HugeFiles=on,64 bits,8 CPUs x64)\n\nScanning the drive:\n3 files, 8099973 bytes (7911 KiB)\n\nCreating archive: map_image.7z\n\nItems to compress: 3\n\n\nFiles read from disk: 3\nArchive size: 8004351 bytes (7817 KiB)\nEverything is Ok\n</code></pre>","tags":["7z"]},{"location":"blog/20191030/linux-7z/#list","title":"list","text":"<p>\u793a\u4f8b1: <code>7z l avg_speed.7z</code> \uff1a</p> <pre><code>faner@FAN-MB1:~/Downloads/zip\n&gt; file avg_speed.7z\navg_speed.7z: 7-zip archive data, version 0.4\nfaner@FAN-MB1:~/Downloads/zip\n&gt; file -bI avg_speed.7z\napplication/x-7z-compressed; charset=binary\n</code></pre> <pre><code>FAN-MB1:zip $ 7z l avg_speed.7z\n\n7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\np7zip Version 16.02 (locale=utf8,Utf16=on,HugeFiles=on,64 bits,8 CPUs x64)\n\nScanning the drive for archives:\n1 file, 1594 bytes (2 KiB)\n\nListing archive: avg_speed.7z\n\n--\nPath = avg_speed.7z\nType = 7z\nPhysical Size = 1594\nHeaders Size = 231\nMethod = LZMA2:13\nSolid = +\nBlocks = 1\n\n   Date      Time    Attr         Size   Compressed  Name\n------------------- ----- ------------ ------------  ------------------------\n2019-12-01 16:54:37 ....A         2394         1363  2019-12-01-10-avg_speed.log\n2019-12-01 16:55:40 ....A         1638               2019-12-01-11-avg_speed.log\n2019-12-01 17:00:15 ....A         1640               2019-12-01-15-avg_speed.log\n2019-12-01 21:38:03 ....A         1184               2019-12-01-21-avg_speed.log\n------------------- ----- ------------ ------------  ------------------------\n2019-12-01 21:38:03               6856         1363  4 files\n</code></pre> <p>\u793a\u4f8b2: <code>7z l Audio.Hijack.v3.3.7.rar</code> \u9884\u89c8 rar \u6587\u4ef6\uff1a</p> <pre><code>faner@FAN-MB1:~/Downloads/zip\n&gt; file Audio.Hijack.v3.3.7.rar\nAudio.Hijack.v3.3.7.rar: RAR archive data, v5\nfaner@FAN-MB1:~/Downloads/zip\n&gt; file -bI Audio.Hijack.v3.3.7.rar\napplication/x-rar; charset=binary\n</code></pre> <pre><code>FAN-MB1:zip $ 7z l Audio.Hijack.v3.3.7.rar\n\n7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\np7zip Version 16.02 (locale=utf8,Utf16=on,HugeFiles=on,64 bits,8 CPUs x64)\n\nScanning the drive for archives:\n1 file, 17370173 bytes (17 MiB)\n\nListing archive: Audio.Hijack.v3.3.7.rar\n\n--\nPath = Audio.Hijack.v3.3.7.rar\nType = Rar5\nPhysical Size = 17370173\nCharacteristics = Recovery Lock\nSolid = -\nBlocks = 1\nEncrypted = -\nMultivolume = -\nVolumes = 1\nComment =\n   0daydown.com\n\n   Date      Time    Attr         Size   Compressed  Name\n------------------- ----- ------------ ------------  ------------------------\n2018-04-12 08:14:39 ....A     16511034     16511034  Audio.Hijack.v3.3.7.dmg\n------------------- ----- ------------ ------------  ------------------------\n2018-04-12 08:14:39           16511034     16511034  1 files\n</code></pre>","tags":["7z"]},{"location":"blog/20191030/linux-7z/#extract","title":"extract","text":"<p><code>7z e *.7z</code> \u9ed8\u8ba4\u89e3\u538b\u5230\u5f53\u524d\u76ee\u5f55\uff0c\u89e3\u538b\u51fa\u6765\u7684\u6587\u4ef6\u5e73\u94fa\u5728\u5f53\u524d\u76ee\u5f55\uff0c\u4e22\u5931\u4e86\u539f\u6709\u6253\u5305\u524d\u7684\u76ee\u5f55\u7ed3\u6784\u3002</p> <p>\u82e5\u60f3\u89e3\u538b\u540e\uff0c\u4fdd\u6301 <code>7z l</code> \u4e2d\u5c55\u793a\u7684\u6253\u5305\u524d\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u53ef\u4f7f\u7528 <code>x</code> \u66ff\u6362 <code>e</code> \u5b50\u547d\u4ee4\u3002</p> <p>\u5efa\u8bae\u901a\u8fc7 <code>-o</code> \u53c2\u6570\u6307\u5b9a\u89e3\u538b\u76ee\u5f55\uff1a<code>7z e avg_speed.7z -o./avg_speed</code>\u3002</p> <p>\u4ee5\u4e0b\u793a\u8303 macOS \u4e0b\u5229\u7528 7z \u89e3\u538b rar \u6587\u4ef6\uff1a</p> <pre><code>faner@MBP-FAN:~/Downloads/zip\n&gt; 7z e Audio.Hijack.v3.3.7.rar -o./Audio.Hijack.v3.3.7\n\n7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21\np7zip Version 16.02 (locale=utf8,Utf16=on,HugeFiles=on,64 bits,8 CPUs x64)\n\nScanning the drive for archives:\n1 file, 17370173 bytes (17 MiB)\n\nExtracting archive: Audio.Hijack.v3.3.7.rar\n--\nPath = Audio.Hijack.v3.3.7.rar\nType = Rar5\nPhysical Size = 17370173\nCharacteristics = Recovery Lock\nSolid = -\nBlocks = 1\nEncrypted = -\nMultivolume = -\nVolumes = 1\nComment =\n   0daydown.com\n\nEverything is Ok\n\nSize:       16511034\nCompressed: 17370173\n</code></pre>","tags":["7z"]},{"location":"blog/20191030/linux-tar/","title":"Linux Command - tar/bzip2","text":"<p>linux \u4e0b\u7684 \u538b\u7f29/\u89e3\u538b\u7f29\uff08tar\uff09\u547d\u4ee4\u3002</p>","tags":["tar"]},{"location":"blog/20191030/linux-tar/#targz","title":".tar.gz","text":"","tags":["tar"]},{"location":"blog/20191030/linux-tar/#create","title":"create","text":"<p>tar \u5229\u7528 gzip\uff08<code>-z</code>\uff09 \u538b\u7f29\u6253\u5305\uff08<code>-c</code>\uff09log\u3001image \u6587\u4ef6\uff1a</p> <pre><code>FAN-MB1:zip $ tar -czv -f avg_speed.tar.gz ~/Downloads/Logs/*-avg_speed.log\na Users/faner/Downloads/Logs/2019-12-01-10-avg_speed.log\na Users/faner/Downloads/Logs/2019-12-01-11-avg_speed.log\na Users/faner/Downloads/Logs/2019-12-01-15-avg_speed.log\na Users/faner/Downloads/Logs/2019-12-01-21-avg_speed.log\n\nFAN-MB1:zip $ tar -czv -f map_image.tar.gz ~/Downloads/Images/map-*.png\ntar: Removing leading '/' from member names\na Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u4e1c\u6e56\u516c\u56ed.png\na Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u68a7\u6850\u5c71\u68ee\u6797\u516c\u56ed.png\na Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u6c11\u4e2d\u5fc3\u5468\u8fb9\u516c\u56ed.png\n</code></pre>","tags":["tar"]},{"location":"blog/20191030/linux-tar/#listpreview","title":"list(preview)","text":"<p>file \u547d\u4ee4\u67e5\u770b\u6587\u4ef6\u5c5e\u6027\uff1a</p> <pre><code>faner@FAN-MB1:~/Downloads/zip\n&gt; file avg_speed.tar.gz\navg_speed.tar.gz: gzip compressed data, last modified: Sun Dec 15 02:08:21 2019, from Unix, original size modulo 2^32 19456\nfaner@FAN-MB1:~/Downloads/zip\n&gt; file -bI avg_speed.tar.gz\napplication/gzip; charset=binary\n</code></pre> <p><code>tar -tzvf</code> \u7528 gzip\uff08<code>-z</code>\uff09 \u67e5\u770b\u6253\u5305\uff08<code>-t</code>\uff09 \u6587\u4ef6\uff1a</p> <pre><code>FAN-MB1:zip $ tar -tzv -f avg_speed.tar.gz\n-rw-r--r--  0 faner  staff    2394 Dec  1 16:54 Users/faner/Downloads/Logs/2019-12-01-10-avg_speed.log\n-rw-r--r--  0 faner  staff    1638 Dec  1 16:55 Users/faner/Downloads/Logs/2019-12-01-11-avg_speed.log\n-rw-r--r--  0 faner  staff    1640 Dec  1 17:00 Users/faner/Downloads/Logs/2019-12-01-15-avg_speed.log\n-rw-r--r--  0 faner  staff    1184 Dec  1 21:38 Users/faner/Downloads/Logs/2019-12-01-21-avg_speed.log\n\nFAN-MB1:zip $ tar -tzv -f map_image.tar.gz\n-rw-r--r--  0 faner  staff 2619042 Dec  2  2018 Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u4e1c\u6e56\u516c\u56ed.png\n-rw-r--r--  0 faner  staff 2592064 Dec  2  2018 Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u68a7\u6850\u5c71\u68ee\u6797\u516c\u56ed.png\n-rw-r--r--  0 faner  staff 2888867 Dec  2  2018 Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u6c11\u4e2d\u5fc3\u5468\u8fb9\u516c\u56ed.png\n</code></pre>","tags":["tar"]},{"location":"blog/20191030/linux-tar/#extract","title":"extract","text":"<p>\u5982\u679c\u4e0d\u901a\u8fc7 <code>-C</code> \u6307\u5b9a\u89e3\u538b\u76ee\u5f55\uff0c\u5219\u9ed8\u8ba4\u89e3\u538b\u5230\u5f53\u524d\u76ee\u5f55\uff01\uff01\uff01</p> <pre><code>faner@MBP-FAN:~/Downloads/zip\n&gt; mkdir avg_speed.tar\n\nfaner@MBP-FAN:~/Downloads/zip\n&gt; tar -xzv -f avg_speed.tar.gz -C ./avg_speed.tar\nx 2019-12-01-10-avg_speed.log\nx 2019-12-01-11-avg_speed.log\nx 2019-12-01-15-avg_speed.log\nx 2019-12-01-21-avg_speed.log\n</code></pre>","tags":["tar"]},{"location":"blog/20191030/linux-tar/#tarbz2","title":".tar.bz2","text":"","tags":["tar"]},{"location":"blog/20191030/linux-tar/#create_1","title":"create","text":"<p>tar \u5229\u7528 bzip2\uff08<code>-j</code>\uff09 \u538b\u7f29\u6253\u5305\uff08<code>-c</code>\uff09log\u3001image \u6587\u4ef6\uff1a</p> <pre><code>FAN-MB1:zip $ tar -cjv -f avg_speed.tar.bz2 ~/Downloads/Logs/*-avg_speed.log\na Users/faner/Downloads/Logs/2019-12-01-10-avg_speed.log\na Users/faner/Downloads/Logs/2019-12-01-11-avg_speed.log\na Users/faner/Downloads/Logs/2019-12-01-15-avg_speed.log\na Users/faner/Downloads/Logs/2019-12-01-21-avg_speed.log\n\nFAN-MB1:zip $ tar -cjv -f map_image.tar.bz2 ~/Downloads/Images/map-*.png\ntar: Removing leading '/' from member names\na Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u4e1c\u6e56\u516c\u56ed.png\na Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u68a7\u6850\u5c71\u68ee\u6797\u516c\u56ed.png\na Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u6c11\u4e2d\u5fc3\u5468\u8fb9\u516c\u56ed.png\n</code></pre>","tags":["tar"]},{"location":"blog/20191030/linux-tar/#listpreview_1","title":"list(preview)","text":"<p>file \u547d\u4ee4\u67e5\u770b\u6587\u4ef6\u5c5e\u6027\uff1a</p> <pre><code>faner@FAN-MB1:~/Downloads/zip\n&gt; file avg_speed.tar.bz2\navg_speed.tar.bz2: bzip2 compressed data, block size = 900k\nfaner@FAN-MB1:~/Downloads/zip\n&gt; file -bI avg_speed.tar.bz2\napplication/x-bzip2; charset=binary\n</code></pre> <p><code>tar -tjvf</code> \u7528 bzip2\uff08<code>-j</code>\uff09 \u67e5\u770b\u6253\u5305\uff08<code>-t</code>\uff09 \u6587\u4ef6\uff1a\u9884\u89c8\u538b\u7f29\u5305\u5185\u5bb9\uff1a</p> <pre><code>FAN-MB1:zip $ tar -tjv -f avg_speed.tar.bz2\n-rw-r--r--  0 faner  staff    2394 Dec  1 16:54 Users/faner/Downloads/Logs/2019-12-01-10-avg_speed.log\n-rw-r--r--  0 faner  staff    1638 Dec  1 16:55 Users/faner/Downloads/Logs/2019-12-01-11-avg_speed.log\n-rw-r--r--  0 faner  staff    1640 Dec  1 17:00 Users/faner/Downloads/Logs/2019-12-01-15-avg_speed.log\n-rw-r--r--  0 faner  staff    1184 Dec  1 21:38 Users/faner/Downloads/Logs/2019-12-01-21-avg_speed.log\n\nFAN-MB1:zip $ tar -tjv -f map_image.tar.bz2\n-rw-r--r--  0 faner  staff 2619042 Dec  2  2018 Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u4e1c\u6e56\u516c\u56ed.png\n-rw-r--r--  0 faner  staff 2592064 Dec  2  2018 Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u68a7\u6850\u5c71\u68ee\u6797\u516c\u56ed.png\n-rw-r--r--  0 faner  staff 2888867 Dec  2  2018 Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u6c11\u4e2d\u5fc3\u5468\u8fb9\u516c\u56ed.png\n</code></pre>","tags":["tar"]},{"location":"blog/20191030/linux-tar/#extract_1","title":"extract","text":"<p>\u5982\u679c\u4e0d\u901a\u8fc7 <code>-C</code> \u6307\u5b9a\u89e3\u538b\u76ee\u5f55\uff0c\u5219\u9ed8\u8ba4\u89e3\u538b\u5230\u5f53\u524d\u76ee\u5f55\uff01\uff01\uff01</p> <pre><code>faner@FAN-MB1:~/Downloads/zip\n&gt; mkdir avg_speed.tar\n\nfaner@FAN-MB1:~/Downloads/zip\n&gt; tar -xjv -f avg_speed.tar.bz2 -C ./avg_speed.tar\nx 2019-12-01-10-avg_speed.log\nx 2019-12-01-11-avg_speed.log\nx 2019-12-01-15-avg_speed.log\nx 2019-12-01-21-avg_speed.log\n</code></pre>","tags":["tar"]},{"location":"blog/20191030/linux-zip-unzip/","title":"Linux Command - zip/unzip","text":"<p>linux \u4e0b\u7684 \u538b\u7f29/\u89e3\u538b\u7f29\uff08zip/unzip\uff09\u547d\u4ee4\u3002</p> <p>macOS \u4e4b zip unzip \u547d\u4ee4 </p> <p>\u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\uff0c\u9664\u4e86 <code>donotinclude.h</code>\u3001<code>orthis.h</code> \u4e4b\u5916\u7684\u6240\u6709 <code>.h</code> \u548c <code>.c</code> \u6587\u4ef6\u538b\u7f29\u6253\u5305\u6210 archive\uff1a</p> <pre><code>zip archive \"*.h\" \"*.c\" -x donotinclude.h orthis.h &gt; tofile\n</code></pre>","tags":["zip","unzip"]},{"location":"blog/20191030/linux-zip-unzip/#archive","title":"archive","text":"<p>zip \u6253\u5305\u5f53\u524d\u76ee\u5f55\uff1a</p> <pre><code>zip -r archive.zip .\nzip -r archive.zip ./*\n</code></pre> <p>zip \u6253\u5305 log \u6587\u4ef6\uff1a</p> <pre><code>FAN-MB1:zip $ zip -v avg_speed ~/Downloads/Logs/*-avg_speed.log\n  adding: ~/Downloads/Logs/2019-12-01-10-avg_speed.log  (in=2394) (out=795) (deflated 67%)\n  adding: ~/Downloads/Logs/2019-12-01-11-avg_speed.log  (in=1638) (out=642) (deflated 61%)\n  adding: ~/Downloads/Logs/2019-12-01-15-avg_speed.log  (in=1640) (out=656) (deflated 60%)\n  adding: ~/Downloads/Logs/2019-12-01-21-avg_speed.log  (in=1184) (out=472) (deflated 60%)\ntotal bytes=6856, compressed=2565 -&gt; 63% savings\n\nFAN-MB1:zip $ zip -v map_image ~/Downloads/Images/map-*.png\n  adding: Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u4e1c\u6e56\u516c\u56ed.png  (in=2619042) (out=2597184) (deflated 1%)\n  adding: Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u68a7\u6850\u5c71\u68ee\u6797\u516c\u56ed.png   (in=2592064) (out=2567088) (deflated 1%)\n  adding: Users/faner/Downloads/Images/map-\u6df1\u5733\u5e02\u6c11\u4e2d\u5fc3\u5468\u8fb9\u516c\u56ed.png   (in=2888867) (out=2877121) (deflated 0%)\ntotal bytes=8099973, compressed=8041393 -&gt; 1% savings\n</code></pre>","tags":["zip","unzip"]},{"location":"blog/20191030/linux-zip-unzip/#exclude","title":"exclude","text":"<pre><code>zip -r archive.zip . -x .DS_Store\nzip -r archive.zip . -x __MACOSX/\\*\n\nzip -r archive.zip . -x \\*/.DS_Store \\*/__MACOSX/\\*\n</code></pre>","tags":["zip","unzip"]},{"location":"blog/20191030/linux-zip-unzip/#append","title":"append","text":"<p>Linux zip\u8ffd\u52a0\u6587\u4ef6 </p> <p>\u5411\u5df2\u5b58\u5728\u7684 <code>exist.zip</code> \u4e2d\u8ffd\u52a0\u6253\u5305 <code>extra.txt</code> \u6587\u4ef6\u3002</p> <pre><code>zip exist.zip extra.txt\n</code></pre>","tags":["zip","unzip"]},{"location":"blog/20191030/linux-zip-unzip/#zip\u5206\u5377\u538b\u7f29","title":"zip\u5206\u5377\u538b\u7f29","text":"<p>zip\u5206\u5377\u538b\u7f29</p> <ol> <li>\u9996\u5148\u5c06\u5176\u538b\u7f29\u6210\u4e00\u4e2a\u5927\u7684zip\u538b\u7f29\u5305\u4e4b\u540e\u518d\u5206\u5377</li> </ol> <pre><code>zip -r a.zip dir\n</code></pre> <ol> <li>\u5c06\u538b\u7f29\u5b8c\u7684\u5927\u538b\u7f29\u5305zip\u5206\u5377</li> </ol> <pre><code>zip -s 100M a.zip --out b.zip\n</code></pre> <p>\u547d\u4ee4\u6267\u884c\u5b8c\u4f1a\u5728\u6587\u4ef6\u5939\u4e0b\u751f\u6210 b.zip\u3001b.z01\u3001b.z02 ...\u7b49\u3002</p>","tags":["zip","unzip"]},{"location":"blog/20191030/linux-zip-unzip/#preview","title":"preview","text":"<p>Preview an archive contents without extracting it </p> <ul> <li>zip: <code>unzip -l FILE.zip</code>\uff0c\u6216 <code>-v</code> </li> <li>tar.gz: <code>tar -tzvf FILE.tar.gz</code> </li> <li>tar.bz2: <code>tar -tjvf FILE.tar.bz2</code> \u6216 <code>bunzip2 -c FILE.tar.bz2 | tar tvf -</code> </li> <li>.7z: <code>7z l FILE.7z</code> </li> </ul> <p>\u5176\u4ed6\uff1a</p> <pre><code>uncompress -c filename.Z\nzcat filename.Z\n</code></pre> <p><code>file</code> \u547d\u4ee4\u67e5\u770b\u6587\u4ef6\u5c5e\u6027\uff1a</p> <pre><code>faner@FAN-MB1:~/Downloads/zip\n&gt; file avg_speed.zip\navg_speed.zip: Zip archive data, at least v2.0 to extract\nfaner@FAN-MB1:~/Downloads/zip\n&gt; file -bI avg_speed.zip\napplication/zip; charset=binary\n</code></pre> <p><code>unzip -l</code> \u9884\u89c8\u538b\u7f29\u5305\u5185\u5bb9\uff1a</p> <pre><code>FAN-MB1:zip $ unzip -l avg_speed.zip\nArchive:  avg_speed.zip\n  Length      Date    Time    Name\n---------  ---------- -----   ----\n     2394  12-01-2019 16:54   Users/faner/Downloads/Logs/2019-12-01-10-avg_speed.log\n     1638  12-01-2019 16:55   Users/faner/Downloads/Logs/2019-12-01-11-avg_speed.log\n     1640  12-01-2019 17:00   Users/faner/Downloads/Logs/2019-12-01-15-avg_speed.log\n     1184  12-01-2019 21:38   Users/faner/Downloads/Logs/2019-12-01-21-avg_speed.log\n---------                     -------\n     6856                     4 files\n\nFAN-MB1:zip $ unzip -l map_image.zip\nArchive:  map_image.zip\n  Length      Date    Time    Name\n---------  ---------- -----   ----\n  2619042  12-02-2018 10:37   Users/faner/Downloads/Images/map-\u6df1\ufffd?\ufffd\ufffd?\ufffd?\ufffd?\ufffd?\ufffd\ufffd?\ufffd.png\n  2592064  12-02-2018 10:38   Users/faner/Downloads/Images/map-\u6df1\ufffd?\ufffd\ufffd?\u68a7\ufffd?\u5c71\u68ee\ufffd??\ufffd?\ufffd\ufffd?\ufffd.png\n  2888867  12-02-2018 10:33   Users/faner/Downloads/Images/map-\u6df1\ufffd?\ufffd\ufffd?\ufffd?\u4e2d\ufffd?\ufffd?\ufffd\u8fb9\ufffd?\ufffd\ufffd?\ufffd.png\n---------                     -------\n  8099973                     3 files\n</code></pre>","tags":["zip","unzip"]},{"location":"blog/20191030/linux-zip-unzip/#delete_hidden_items","title":"delete hidden items","text":"<p>\u7528 macOS Archive Utility.app \u6253\u5305\u751f\u6210\u7684 zip \u6587\u4ef6\u4e2d\uff0c\u901a\u5e38\u5305\u542b <code>.DS_Store</code> \u6587\u4ef6\u3002 \u5982\u4f55\u5220\u9664 macOS \u538b\u7f29\u5305\u4e2d\u7684\u9690\u85cf\u6587\u4ef6\uff1f</p> <p><code>zip -d</code>\uff08<code>--delete</code>\uff09: Remove (delete) entries from a zip archive.</p> <p>\u5220\u9664 macOS \u4e0b\u6253\u5305\u8fdb\u53bb\u7684 <code>.DS_Store</code>\uff1a</p> <pre><code>zip -d test.zip .DS_Store\n</code></pre> <pre><code>zip -d foo foo/tom/junk foo/harry/\\* \\*.o\nzip -d foo foo/tom/junk \"foo/harry/*\" \"*.o\"\n</code></pre> <p>\u7528 macOS Archive Utility.app \u6253\u5305\u751f\u6210\u7684 zip \u6587\u4ef6\u4e2d\uff0c\u901a\u5e38\u5305\u542b <code>__MACOSX/</code> \u76ee\u5f55\u3002</p> <pre><code>FAN-MB1:zip $ unzip -l map_image-arch.zip\nArchive:  map_image-arch.zip\n  Length      Date    Time    Name\n---------  ---------- -----   ----\n  2619042  12-02-2018 10:37   map-\u6df1\ufffd?\ufffd\ufffd?\ufffd?\ufffd?\ufffd?\ufffd\ufffd?\ufffd.png\n      575  12-02-2018 10:37   __MACOSX/._map-\u6df1\ufffd?\ufffd\ufffd?\ufffd?\ufffd?\ufffd?\ufffd\ufffd?\ufffd.png\n  2592064  12-02-2018 10:38   map-\u6df1\ufffd?\ufffd\ufffd?\u68a7\ufffd?\u5c71\u68ee\ufffd??\ufffd?\ufffd\ufffd?\ufffd.png\n      575  12-02-2018 10:38   __MACOSX/._map-\u6df1\ufffd?\ufffd\ufffd?\u68a7\ufffd?\u5c71\u68ee\ufffd??\ufffd?\ufffd\ufffd?\ufffd.png\n  2888867  12-02-2018 10:33   map-\u6df1\ufffd?\ufffd\ufffd?\ufffd?\u4e2d\ufffd?\ufffd?\ufffd\u8fb9\ufffd?\ufffd\ufffd?\ufffd.png\n      575  12-02-2018 10:33   __MACOSX/._map-\u6df1\ufffd?\ufffd\ufffd?\ufffd?\u4e2d\ufffd?\ufffd?\ufffd\u8fb9\ufffd?\ufffd\ufffd?\ufffd.png\n---------                     -------\n  8101698                     6 files\n</code></pre> <p>\u6267\u884c <code>zip -d</code> \u5220\u9664 <code>__MACOSX/</code> \u76ee\u5f55\u4e0b\u7684\u5185\u5bb9\uff1a</p> <pre><code>FAN-MB1:zip $ zip -d map_image-arch.zip __MACOSX/\\*\ndeleting: __MACOSX/._map-\u6df1\u5733\u5e02\u4e1c\u6e56\u516c\u56ed.png\ndeleting: __MACOSX/._map-\u6df1\u5733\u5e02\u68a7\u6850\u5c71\u68ee\u6797\u516c\u56ed.png\ndeleting: __MACOSX/._map-\u6df1\u5733\u5e02\u6c11\u4e2d\u5fc3\u5468\u8fb9\u516c\u56ed.png\n\nFAN-MB1:zip $ unzip -l map_image-arch.zip\nArchive:  map_image-arch.zip\n  Length      Date    Time    Name\n---------  ---------- -----   ----\n  2619042  12-02-2018 10:37   map-\u6df1\ufffd?\ufffd\ufffd?\ufffd?\ufffd?\ufffd?\ufffd\ufffd?\ufffd.png\n  2592064  12-02-2018 10:38   map-\u6df1\ufffd?\ufffd\ufffd?\u68a7\ufffd?\u5c71\u68ee\ufffd??\ufffd?\ufffd\ufffd?\ufffd.png\n  2888867  12-02-2018 10:33   map-\u6df1\ufffd?\ufffd\ufffd?\ufffd?\u4e2d\ufffd?\ufffd?\ufffd\u8fb9\ufffd?\ufffd\ufffd?\ufffd.png\n---------                     -------\n  8099973                     3 files\n</code></pre> <p>\u5982\u679c\u60f3\u4fdd\u7559\u539f\u59cb\u538b\u7f29\u5305\uff0c\u53ef\u901a\u8fc7 <code>-O output-file</code> \u6307\u5b9a\u4fdd\u5b58\u64cd\u4f5c\u540e\u7684\u7ed3\u679c\u3002</p> <p>\u540c\u65f6\u5220\u9664\u6253\u5305\u8fdb\u53bb\u7684\u9690\u85cf\u6587\u4ef6\u548c\u6587\u4ef6\u5939\uff1a<code>zip -d file.zip .DS_Store __MACOSX/\\*</code></p>","tags":["zip","unzip"]},{"location":"blog/20191030/linux-zip-unzip/#extract","title":"extract","text":"<p>\u5229\u7528 unzip \u547d\u4ee4\u89e3\u538b zip \u5230\u540c\u540d\u5b50\u76ee\u5f55\uff08<code>-d</code> \u6307\u5b9a\uff09\uff1a</p> <pre><code>faner@FAN-MB1:~/Downloads/zip\n&gt; unzip avg_speed-arch.zip -d avg_speed-arch\nArchive:  avg_speed-arch.zip\n  inflating: avg_speed-arch/2019-12-01-10-avg_speed.log\n  inflating: avg_speed-arch/__MACOSX/._2019-12-01-10-avg_speed.log\n  inflating: avg_speed-arch/2019-12-01-11-avg_speed.log\n  inflating: avg_speed-arch/__MACOSX/._2019-12-01-11-avg_speed.log\n  inflating: avg_speed-arch/2019-12-01-15-avg_speed.log\n  inflating: avg_speed-arch/__MACOSX/._2019-12-01-15-avg_speed.log\n  inflating: avg_speed-arch/2019-12-01-21-avg_speed.log\n  inflating: avg_speed-arch/__MACOSX/._2019-12-01-21-avg_speed.log\n</code></pre> <p>\u53ea\u89e3\u538b\u5176\u4e2d\u7684\u67d0\u4e00\u4e2a\u6587\u4ef6\u5230\u5f53\u524d\u76ee\u5f55\uff1a</p> <pre><code>faner@FAN-MB1:~/Downloads/zip\n&gt; unzip avg_speed-arch.zip 2019-12-01-10-avg_speed.log\nArchive:  avg_speed-arch.zip\n  inflating: 2019-12-01-10-avg_speed.log\n</code></pre>","tags":["zip","unzip"]},{"location":"blog/20191030/linux-zip-unzip/#gui","title":"GUI","text":"<p>macOS \u539f\u751f\u81ea\u5e26\u4e86 Archive Utility.app \u8f6f\u4ef6\uff1a</p> <p></p> <ol> <li>After expanding \u53ef\u9009\u62e9\u5728\u89e3\u538b\u540e\u4fdd\u7559\u6216\u79fb\u9664\u538b\u7f29\u5305\uff1a</li> </ol> <ul> <li> leave archive alone  </li> <li> move archive to Trash  </li> <li> delete archive  </li> </ul> <ol> <li>Use archive format \u53ef\u4ee5\u4ece Compressed archive \u4fee\u6539\u4e3a Zip archive\u3002</li> </ol> <p>How to Open and Browse ZIP Files on macOS Without Unarchiving Them</p> <ol> <li><code>Dr. Unarchiver</code>: Straightforward ZIP, RAR, and Other Archive Management  </li> <li><code>Zipster</code>: Mount ZIP Files in the Finder (and Only ZIP Files)  </li> </ol> <p>Mac \u4e0a\u6700\u65b9\u4fbf\u7684\u538b\u7f29\u4e0e\u89e3\u538b\u7f29\u8f6f\u4ef6\u662f\u4ec0\u4e48\uff1f </p> <p>Keka The Unarchiver </p> <p>ezip https://apps.apple.com/cn/app/id1127253508?mt=12</p> <p>BetterZip Bandizip </p>","tags":["zip","unzip"]},{"location":"blog/20191027/zsh-installation/","title":"macOS\u5207\u6362\u4f7f\u7528zsh\u5e76\u5b89\u88c5ohmyzsh","text":"<p>macOS\u4e0b\u5207\u6362 zsh \u4e3a\u9ed8\u8ba4 shell\uff0c\u5e76\u5b89\u88c5 oh-my-zsh\u3002</p>"},{"location":"blog/20191027/zsh-installation/#\u67e5\u770b\u7cfb\u7edf\u652f\u6301\u7684_shells","title":"\u67e5\u770b\u7cfb\u7edf\u652f\u6301\u7684 Shells","text":"<p>\u7ec8\u7aef\u6267\u884c <code>cat /etc/shells</code> \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u652f\u6301\u51e0\u79cd Shells\uff1b</p> <pre><code>\u279c  ~ cat /etc/shells\n# List of acceptable shells for chpass(1).\n# Ftpd will not allow users to connect who are not using\n# one of these shells.\n\n/bin/bash\n/bin/csh\n/bin/ksh\n/bin/sh\n/bin/tcsh\n/bin/zsh\n</code></pre> <p>macOS \u9884\u88c5\u4e86 zsh\u3002</p>"},{"location":"blog/20191027/zsh-installation/#\u67e5\u770b\u7cfb\u7edf\u5f53\u524d\u4f7f\u7528\u7684_shell","title":"\u67e5\u770b\u7cfb\u7edf\u5f53\u524d\u4f7f\u7528\u7684 Shell","text":"<p>\u7ec8\u7aef\u6267\u884c <code>echo $SHELL</code> \u547d\u4ee4\u53ef\u4ee5\u67e5\u770b macOS \u7cfb\u7edf\u5f53\u524d\u8d26\u6237\u4f7f\u7528\u7684\u9ed8\u8ba4 Shell\uff1a</p> <pre><code>\u279c  ~ echo $SHELL\n/bin/zsh\n</code></pre>"},{"location":"blog/20191027/zsh-installation/#\u5207\u6362\u5f53\u524d_shell_\u4e3a_zsh","title":"\u5207\u6362\u5f53\u524d Shell \u4e3a zsh","text":"<p>\u7ec8\u7aef\u6267\u884c <code>chsh -s /bin/zsh</code> \u547d\u4ee4\u53ef\u4ee5\u5207\u6362\u9ed8\u8ba4 Shell \u4e3a\u66f4\u6ce8\u91cd\u7528\u6237\u4f53\u9a8c\u548c\u4ea4\u4e92\u7684 zsh\u3002</p>"},{"location":"blog/20191027/zsh-installation/#zsh_\u914d\u7f6e_profile","title":"zsh \u914d\u7f6e profile","text":""},{"location":"blog/20191027/zsh-installation/#man","title":"man","text":"<p>\u5173\u4e8e zsh \u7684\u52a0\u8f7d\u3001\u542f\u52a8\u548c\u8fd0\u4f5c\u673a\u5236\uff0c\u5efa\u8bae\u901a\u8fc7 <code>man zsh</code> \u624b\u518c\u3002</p> <p>\u53ef\u4ee5\u9605\u8bfb INVOCATION\u3001COMPATIBILITY\u3001RESTRICTED SHELL \u76f8\u5173\u7ae0\u8282\u5185\u5bb9\u3002</p>"},{"location":"blog/20191027/zsh-installation/#files","title":"FILES","text":"<p>\u53c2\u8003 man bash \u76f8\u5173\u914d\u7f6e bash-FILES\u3001macOS Env PATH \u7684\u8ba8\u8bba\u3002</p> <p>\u5173\u4e8e zsh \u7684\u542f\u52a8\u52a0\u8f7d\u914d\u7f6e\u6d41\u7a0b\u673a\u5236\uff0c\u53ef\u4ee5\u9605\u8bfb <code>man zsh</code> \u624b\u518c\u4e2d\u7684 STARTUP/SHUTDOWN FILES\u3001FILES \u7b49\u7ae0\u8282\u3002</p> <pre><code>$ man zsh\n\nFILES\n       $ZDOTDIR/.zshenv\n       $ZDOTDIR/.zprofile\n       $ZDOTDIR/.zshrc\n       $ZDOTDIR/.zlogin\n       $ZDOTDIR/.zlogout\n       ${TMPPREFIX}*   (default is /tmp/zsh*)\n       /etc/zshenv\n       /etc/zprofile\n       /etc/zshrc\n       /etc/zlogin\n       /etc/zlogout    (installation-specific - /etc is the default)\n</code></pre> <p>If <code>ZDOTDIR</code> is unset, <code>HOME</code> is used instead. Files listed above as being in <code>/etc</code> may be in another direc- tory, depending on the installation.</p> <p>\u672a\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf ZDOTDIR\uff0c\u9ed8\u8ba4\u5c31\u662f HOME \u76ee\u5f55\u3002</p> <p>\u7cfb\u7edf\u7ea7\u914d\u7f6e\u6587\u4ef6 <code>/etc/zprofile</code> \u548c <code>/etc/zshrc</code> \u4e2d\u6709\u5185\u5bb9\u3002</p>"},{"location":"blog/20191027/zsh-installation/#startup","title":"startup","text":"<p>Customizing the bash shell and its startup files</p> <p>ohmyzsh/plugins/profiles/ allows you to create separate configuration files for zsh based on your long hostname (including the domain).</p>"},{"location":"blog/20191027/zsh-installation/#\u5b89\u88c5_omzoh_my_zsh","title":"\u5b89\u88c5 OMZ\uff08Oh My ZSH\uff09","text":"<p>\u7ec8\u7aef\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u53ef\u901a\u8fc7 curl\uff08\u6216 wget\u3001httpie\uff09\u4ece github \u4e0b\u8f7d\u5b89\u88c5\u6d41\u884c\u7684 Zsh \u914d\u7f6e Oh My ZSH\uff1a</p> <pre><code># curl\n$ sh -c \"$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)\"\n## \u6216\u8005\n$ curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | zsh\n\n# wget\n$ sh -c \"$(wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)\"\n## \u6216\u8005\n$ wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | zsh\n\n# httpie\uff08\u6709\u5f85\u9a8c\u8bc1\uff09\n$ http --download https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | sh -c\n## \u6216\u8005\nhttp --download https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | zsh\n</code></pre>"},{"location":"blog/20191027/zsh-installation/#\u5378\u8f7d_omz","title":"\u5378\u8f7d OMZ","text":"<p>\u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c <code>uninstall_oh_my_zsh</code> \u547d\u4ee4\u53ef\u4ee5\u5378\u8f7d OMZ\u3002</p>"},{"location":"blog/20191027/zsh-installation/#color_themes","title":"Color Themes","text":"<p>robbyrussell/oh-my-zsh</p> <p>https://github.com/robbyrussell/oh-my-zsh/wiki/themes</p> <p>A list of Themes that don't come bundled with oh-my-zsh</p> <p>https://github.com/robbyrussell/oh-my-zsh/wiki/External-themes</p> <p>OMZ \u63d0\u4f9b\u4e86\u6570\u767e\u79cd\u4e3b\u9898\uff0c\u76f8\u5173\u6587\u4ef6\u5728 <code>~/.oh-my-zsh/themes</code> \u76ee\u5f55\u4e0b\u3002</p> <p>Themes are located in a themes folder and must end with .zsh-theme. The basename of the file is the name of the theme.</p> <pre><code>    zsh_custom\n    \u2514\u2500\u2500 themes\n        \u2514\u2500\u2500 my_awesome_theme.zsh-theme\n</code></pre> <p>Then edit your <code>.zshrc</code> to use that theme.</p> <pre><code>    ZSH_THEME=\"my_awesome_theme\"\n</code></pre> <p>\u5728 <code>.zshrc</code> \u91cc\u901a\u8fc7 <code>ZSH_THEME</code> \u952e\u6765\u8bbe\u7f6e\u4e3b\u9898\uff0c\u9ed8\u8ba4\u4e3b\u9898\u662f\uff1a</p> <pre><code>    ZSH_THEME=\u201drobbyrussell\u201d\n</code></pre>"},{"location":"blog/20191027/zsh-installation/#\u63a8\u8350\u4e3b\u9898","title":"\u63a8\u8350\u4e3b\u9898","text":"<ul> <li>pygmalion (\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\ufe0f\u2b50\ufe0f\u2b50\ufe0f\ufe0f)  </li> <li>bira (\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\ufe0f\u2b50\ufe0f\ufe0f)  </li> <li>bureau  </li> <li>agnoster  </li> <li><code>random</code> </li> </ul>"},{"location":"blog/20191027/zsh-installation/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>\u7ec8\u6781 Shell \u4e3a\u4ec0\u4e48\u8bf4 zsh \u662f shell \u4e2d\u7684\u6781\u54c1\uff1f </p> <p>Terminal &amp; zsh &amp; oh-my-zsh \u914d\u7f6e bash \u8f49\u79fb zsh (oh-my-zsh) \u8a2d\u5b9a\u5fc3\u5f97 </p> <p>\u5229\u7528 Oh-My-Zsh \u6253\u9020\u4f60\u7684\u8d85\u7ea7\u7ec8\u7aef @CSDN oh-my-zsh,\u8ba9\u4f60\u7684\u7ec8\u7aef\u4ece\u672a\u8fd9\u4e48\u723d\u8fc7 iTerm2 + zsh + oh-my-zsh The Most Power Full of Terminal on macOS </p> <p>zsh \u7b80\u5355\u8bbe\u7f6e macOS/Linux \u5b89\u88c5 zsh &amp; OMZ oh-my-zsh \u914d\u7f6e\u4f60\u7684 zsh \u63d0\u9ad8 shell \u903c\u683c\u7ec8\u6781\u9009\u62e9 </p>"},{"location":"blog/20191027/zsh-plugins/","title":"macOS\u4e0bzsh\u5b89\u88c5\u4f7f\u7528\u63d2\u4ef6","text":"<p>zsh \u63d2\u4ef6\u7684\u914d\u7f6e\u548c\u4f7f\u7528\u8bb0\u5f55\u3002</p> <p>oh-my-zsh\u63d2\u4ef6\u63a8\u8350 \u4e00\u4e9b\u5b9e\u7528\u5e38\u7528\u63d2\u4ef6\u63a8\u8350 for zsh\uff08oh-my-zsh\uff09 awesome-zsh-plugins </p>"},{"location":"blog/20191027/zsh-plugins/#builtin","title":"builtin","text":"<p><code>~/.zshrc</code> \u4e2d\u5b9a\u4e49\u4e86 ZSH \u53d8\u91cf\uff1a</p> <pre><code>$ head -10 ~/.zshrc\n# Path to your oh-my-zsh installation.\nexport ZSH=~/.oh-my-zsh\n</code></pre> <p>oh-my-zsh \u5185\u7f6e\u63d2\u4ef6\u5b58\u653e\u5728 <code>$ZSH/plugins</code> \u76ee\u5f55\u3002</p> <ul> <li>https://github.com/ohmyzsh/ohmyzsh/wiki/Plugins  </li> <li>https://github.com/robbyrussell/oh-my-zsh/tree/master/plugins  </li> </ul> <p>\u53ef\u5728 <code>~/.zshrc</code> \u4e2d\u7684 plugins \u62ec\u53f7\u6570\u7ec4\u4e2d\u6dfb\u52a0\u542f\u7528\u63d2\u4ef6\uff0c\u591a\u4e2a\u63d2\u4ef6\u4ee5\u7a7a\u683c\u6216\u6362\u884c\u5206\u9694\u3002</p>"},{"location":"blog/20191027/zsh-plugins/#macos","title":"macos","text":"<p>ohmyzsh/plugins/macos/</p> <p>This plugin provides a few utilities to make it more enjoyable on macOS (previously named OSX).</p> Command Description <code>tab</code> Open the current directory in a new tab <code>split_tab</code> Split the current terminal tab horizontally <code>vsplit_tab</code> Split the current terminal tab vertically <code>ofd</code> Open the current directory in a Finder window <code>pfd</code> Return the path of the frontmost Finder window <code>pfs</code> Return the current Finder selection <code>cdf</code> <code>cd</code> to the current Finder directory <code>pushdf</code> <code>pushd</code> to the current Finder directory <code>quick-look</code> Quick-Look a specified file <code>man-preview</code> Open a specified man page in Preview app <code>showfiles</code> Show hidden files in Finder <code>hidefiles</code> Hide the hidden files in Finder <code>itunes</code> DEPRECATED. Use <code>music</code> from macOS Catalina on <code>music</code> Control Apple Music. Use <code>music -h</code> for usage details <code>spotify</code> Control Spotify and search by artist, album, track and etc. <code>rmdsstore</code> Remove .DS_Store files recursively in a directory <code>btrestart</code> Restart the Bluetooth daemon <code>freespace</code> Erases purgeable disk space with 0s on the selected disk <p>\u51e0\u4e2a\u6709\u7528\u7684\u547d\u4ee4\uff1a</p> <ul> <li><code>tab</code>\uff1aTerminal.app - Preferences - General - New tabs open with <code>Same Working Directory</code>\uff0c<code>\u2318T</code> \u6253\u5f00\u65b0 tab \u9ed8\u8ba4\u6253\u5f00\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u3002  </li> <li><code>ofd</code>\uff1a\u5728 Finder \u4e2d\u5b9a\u4f4d\u5230\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\uff08reveal in finder\uff09\uff0c\u7b49\u6548\u4e8e\u6267\u884c <code>open .</code> \u547d\u4ee4\u3002  </li> <li><code>man-preview zsh</code>\uff1a\u7b49\u6548\u4e8e <code>man -t zsh | open -fa \"Preview\"</code>\uff0c\u7528 Preview.app \u4ee5 PDF \u683c\u5f0f\u6253\u5f00 zsh \u7684 man page\u3002  </li> <li><code>showfiles</code>/<code>hidefiles</code>\uff1a\u5b9a\u4f4d\u5230 Finder \u4e2d \u663e\u793a/\u9690\u85cf \u9690\u85cf\u6587\u4ef6\uff08Show/Hide hidden files\uff09\u3002  </li> </ul> <p>\u5176\u4ed6macOS\u5e73\u53f0\u76f8\u5173\u63d2\u4ef6\uff1a</p> <ol> <li>brew: adds several aliases for common brew commands.</li> </ol> <p>Homebrew \u9ed8\u8ba4\u5df2\u7ecf\u63d0\u4f9b\u4e86\u9488\u5bf9 zsh \u7684\u667a\u80fd\u5b8c\u6210\u63d0\u793a\uff0c\u6545 brew \u63d2\u4ef6\u4e86\u4e3b\u8981\u63d0\u4f9b\u4e86\u90e8\u5206 aliases\u3002</p> <ol> <li> <p>pod: adds completion for CocoaPods</p> </li> <li> <p>xcode: provides a few utilities that can help you on your daily use of Xcode and iOS development.</p> </li> <li> <p>iterm2</p> </li> </ol> <ul> <li>zsh-tab-colors - Automatically changes iTerm tab color based on the current working directory.  </li> <li>iterm-touchbar - Display iTerm2 feedback in the MacbookPro TouchBar (Current directory, git branch &amp; status).  </li> <li>iterm2colors - Manage your iterm2's color scheme from the command line.  </li> <li>iterm2-tabs - Set colors and titles of iTerm2 tabs. \u5b89\u88c5\u4f7f\u80fd\u53c2\u8003 <code>vimman.zsh</code>\u3002  </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#nav","title":"nav","text":"<p>macOS \u7684 Bash Shell \u5185\u7f6e\u4e86 pushd\u3001popd\u3001dirs -v \u7b49\u7ba1\u7406cd\u5bfc\u822a\u5806\u6808\u7684\u547d\u4ee4\u3002</p>"},{"location":"blog/20191027/zsh-plugins/#dircycle","title":"dircycle","text":"<p>dircycle: Plugin for cycling through the directory stack</p> <p>This plugin enables directory navigation similar to using back and forward on browsers or common file explorers like Finder or Nautilus. It uses a small zle trick that lets you cycle through your directory stack left or right using <code>Ctrl</code> + <code>Shift</code> + <code>Left</code> / <code>Right</code> . This is useful when moving back and forth between directories in development environments, and can be thought of as kind of a nondestructive pushd/popd/dirs -v.</p> <p>\u5feb\u6377\u952e\uff1a<code>^\u21e7\u2190</code> / <code>\u2192</code>\u3002</p> <p>\u76f8\u5173\u63d2\u4ef6\uff1a</p> <ol> <li> <p>last-working-dir</p> <ul> <li>Also adds a <code>lwd</code> function to jump to the last working directory.</li> </ul> </li> <li> <p>dirhistory: \u63d0\u4f9b\u4e86\u51e0\u4e2a\u7c7b\u4f3c\u8d44\u6e90\u7ba1\u7406\u5668\u4e2d\u7684\u5bfc\u822a\u5feb\u6377\u952e\u3002</p> </li> </ol> Command Description Shortcut Description Alt + Left  / \u2325\u2190 Go to previous directory Alt + Right / \u2325\u2192 Go to next directory Alt + Up    / \u2325\u2191 Move into the parent directory Alt + Down  / \u2325\u2193 Move into the first child directory by alphabetical order <ol> <li> <p>per-directory-history</p> <ul> <li>This plugin adds per-directory history for zsh, as well as a global history, and the ability to toggle between them with a keyboard shortcut.</li> <li>Press <code>^G</code> (the Control and G keys simultaneously) to toggle between local and global histories.</li> </ul> </li> </ol>"},{"location":"blog/20191027/zsh-plugins/#z__j","title":"z &amp; j","text":"<ul> <li>z </li> <li>autojump </li> </ul> <p>\u53ef\u542f\u7528\u5185\u7f6e\u7684 <code>z</code> \u547d\u4ee4\uff08jump around\uff09\uff0c\u548c <code>j</code> \u547d\u4ee4\uff08<code>autojump</code>\uff09\u9664\u4e86\u540d\u5b57\u4e0d\u4e00\u6837\uff0c\u529f\u80fd\u57fa\u672c\u96f7\u540c\u3002</p> <p>\u8bed\u6cd5\uff08SYNOPSIS\uff09\uff1a<code>z [-chlrtx] [regex1 regex2 ... regexn]</code> </p> <pre><code>Tracks your most used directories, based on 'frecency'.\n\nAfter a short learning phase, z will take you to the most 'frecent' directory that matches ALL of the regexes given on the command line, in order.  \nFor example, z foo bar would match /foo/bar but not /bar/foo.  \n</code></pre> <p>\u9009\u9879\u53c2\u6570\uff08OPTIONS\uff09\uff1a</p> <ul> <li><code>-c</code>: restrict matches to subdirectories of the current directory  </li> <li><code>-h</code>: show a brief help message  </li> <li><code>-l</code>: list only  </li> <li><code>-r</code>: match by rank only  </li> <li><code>-t</code>: match by recent access only  </li> <li><code>-x</code>: remove the current directory from the datafile  </li> </ul> <p>\u793a\u4f8b\uff08EXAMPLES\uff09\uff1a</p> <ul> <li><code>z foo</code>: cd to most frecent dir matching foo  </li> <li><code>z foo bar</code>: cd to most frecent dir matching foo, then bar  </li> <li><code>z -r foo</code>: cd to highest ranked dir matching foo  </li> <li><code>z -t foo</code>: cd to most recently accessed dir matching foo  </li> <li><code>z -l foo</code>: list all dirs matching foo (by frecency)  </li> </ul> <p>\u8f93\u5165 <code>z -h</code> \u67e5\u770b\u547d\u4ee4\u53c2\u6570\uff1a</p> <pre><code>[MBP-FAN:~]\n[faner]% z -h\nz [-cehlrtx] args\n</code></pre> <p>\u8f93\u5165 <code>z -l</code> \u67e5\u770b\u6700\u8fd1\u8bbf\u95ee\u7684\u9ad8\u9891\u6587\u4ef6\u5939\u5217\u8868\uff1a</p> <pre><code>[MBP-FAN:~] # \u7c7b\u4f3c dirs -v\n[faner]% z -l\n0.5        /Users/faner/.oh-my-zsh/plugins\n1.5        /Users/faner/.oh-my-zsh/plugins/colorize\n3          /Users/faner/Downloads\n4          /Users/faner/Projects/git\n14         /Users/faner/Projects/git/Utilities&amp;Usages/SCM\n20         /Users/faner/.oh-my-zsh/custom\n20         /Users/faner/.oh-my-zsh/custom/plugins\n28         /Users/faner/Projects/git/softwareConfig\n36         /Users/faner/.oh-my-zsh/custom/scripts\n42         /Users/faner/Projects/git/web\n236        /Users/faner/.oh-my-zsh\n</code></pre>"},{"location":"blog/20191027/zsh-plugins/#jump","title":"jump","text":"<p>The jump plugin allows to easily jump around the file system by manually adding marks. Those marks are stored as symbolic links in the directory <code>$MARKPATH</code> (default <code>$HOME/.marks</code>)</p> <ul> <li><code>jump FOO</code>: jump to a mark named FOO  </li> <li><code>mark FOO</code>: create a mark named FOO  </li> <li><code>unmark FOO</code>: delete a mark  </li> <li><code>marks</code>: lists all marks  </li> </ul> Command Description <code>jump &lt;mark-name&gt;</code> Jump to the given mark <code>mark [mark-name]</code> Create a mark with the given name or with the name of the current directory if none is provided <code>unmark &lt;mark-name&gt;</code> Remove the given mark <code>marks</code> List the existing marks and the directories they point to <p>\u76f8\u5173\u63d2\u4ef6\uff1a</p> <ol> <li>scd\uff1asmart change of directory\u3002</li> </ol> <p>Define <code>scd</code> shell function for changing to any directory with a few keystrokes.</p> <p><code>scd</code> keeps history of the visited directories, which serves as an index of the known paths. The directory index is updated after every <code>cd</code> command in the shell and can be also filled manually by running <code>scd -a</code>.</p> <ol> <li>pj\uff1aSet <code>$PROJECT_PATHS</code> in your <code>~/.zshrc</code>\u3002</li> </ol> <p>The <code>pj</code> plugin (short for Project Jump) allows you to define several folders where you store your projects, so that you can jump there directly by just using the name of the project directory.</p>"},{"location":"blog/20191027/zsh-plugins/#wd","title":"wd","text":"<p>wd (warp directory) lets you jump to custom directories in zsh, without using <code>cd</code>. Why? Because <code>cd</code> seems inefficient when the folder is frequently visited or has a long path.</p> <p>warp point \u7c7b\u4f3c scd directory index\u3001jump mark\uff0c\u4f46 wd \u652f\u6301\u66f4\u5f3a\u5927\u7684\u8df3\u8f6c\u70b9\u652f\u6301\u3002</p> <p>\u67e5\u770b wd \u7248\u672c\uff1a</p> <pre><code>@MBP-FAN \u279c ~  wd -v\nwd version 0.4.6\n</code></pre> <p>\u67e5\u770b wd \u547d\u4ee4\u5e2e\u52a9\uff1a</p> <pre><code>@MBP-FAN \u279c ~  wd help\nUsage: wd [command] [point]\n\nCommands:\n    &lt;point&gt;         Warps to the directory specified by the warp point\n    &lt;point&gt; &lt;path&gt;  Warps to the directory specified by the warp point with path appended\n    add &lt;point&gt;     Adds the current working directory to your warp points\n    add             Adds the current working directory to your warp points with current directory's name\n    rm &lt;point&gt;      Removes the given warp point\n    rm              Removes the given warp point with current directory's name\n    show &lt;point&gt;    Print path to given warp point\n    show            Print warp points to current directory\n    list            Print all stored warp points\n    ls  &lt;point&gt;     Show files from given warp point (ls)\n    path &lt;point&gt;    Show the path to given warp point (pwd)\n    clean           Remove points warping to nonexistent directories (will prompt unless --force is used)\n\n    -v | --version  Print version\n    -d | --debug    Exit after execution with exit codes (for testing)\n    -c | --config   Specify config file (default ~/.warprc)\n    -q | --quiet    Suppress all output\n    -f | --force    Allows overwriting without warning (for add &amp; clean)\n\n    help            Show this extremely helpful text\n</code></pre> <p>\u5e38\u7528\u547d\u4ee4\uff1a</p> <ul> <li> <p><code>wd add foo</code>: Add warp point to current working directory  </p> <p>If a warp point with the same name exists, use <code>add!</code> to overwrite it. You can omit point name to use the current directory's name instead.  </p> </li> <li> <p><code>wd foo</code>: warp to <code>foo</code> from an other directory (not necessarily)  </p> </li> <li><code>wd ..</code>/<code>wd ...</code>: warp back to previous directory with dot syntax, and so on.  </li> <li> <p><code>wd rm foo</code>: Remove warp point test point.  </p> <p>You can omit point name to use the current directory's name instead.</p> </li> <li> <p><code>wd list</code>: List all warp points (stored in <code>$HOME/.warprc</code>).  </p> </li> <li><code>wd ls foo</code>: List files in given warp point.  </li> <li><code>wd path foo</code> Show path of given warp point.  </li> <li><code>wd show</code>: List warp points to current directory, or optionally, path to given warp point.  </li> <li><code>wd clean</code>: Remove warp points to non-existent directories.  </li> </ul> <p>\u76f8\u5173\u63d2\u4ef6\uff1afasd</p> <ul> <li>Fasd (pronounced similar to \"fast\") is a command-line productivity booster. Fasd offers quick access to files and directories for POSIX shells.</li> </ul>"},{"location":"blog/20191027/zsh-plugins/#navigation-tools","title":"navigation-tools","text":"<p>ohmyzsh/plugins/zsh-navigation-tools/</p> <p>Set of tools like <code>n-history</code> \u2013 multi-word history searcher, <code>n-cd</code> \u2013 directory bookmark manager, <code>n-kill</code> \u2013 <code>htop</code> like kill utility, and more. Based on <code>n-list</code>, a tool generating selectable curses-based list of elements that has access to current <code>Zsh</code> session, i.e. has broad capabilities to work together with it. </p>"},{"location":"blog/20191027/zsh-plugins/#system","title":"system","text":""},{"location":"blog/20191027/zsh-plugins/#man","title":"man","text":"<p>The man plugin adds a shortcut to insert man before the previous command.</p>"},{"location":"blog/20191027/zsh-plugins/#aliases","title":"aliases","text":"<p>With lots of 3rd-party amazing aliases installed, this plugin helps list the shortcuts that are currently available based on the plugins you have enabled.</p> <p>Usage:</p> <ul> <li><code>acs</code>: show all aliases by group.  </li> <li><code>acs &lt;keyword&gt;</code>: filter aliases by <code>&lt;keyword&gt;</code> and highlight.  </li> </ul> <p>\u8fd8\u6709\u4e00\u4e2a\u7c7b\u4f3c\u63d2\u4ef6 alias-finder\u3002</p> <p>zsh \u9ed8\u8ba4\u5b9a\u4e49\u4e86\u4ee5\u4e0b alias\uff1a</p> <ul> <li>alias go=\"git-open\"  </li> <li>alias cp=\"cp -i\"  </li> <li>alias rm=\"trash\" # rmtrash  </li> </ul> <p>\u4ee5\u4e0b\u63d2\u4ef6\u5b9a\u4e49\u4e86\u4e00\u4e9b\u5e38\u7528\u7684 alias \u66ff\u8eab\u547d\u4ee4\uff0c\u53ef\u4f9b\u53c2\u8003\u3002</p> <ul> <li>lol </li> <li>brew </li> <li>singlechar </li> <li>common-aliases </li> <li>systemadmin </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#history","title":"history","text":"<p>history: Provides a couple of convenient aliases for using the <code>history</code> command to examine your command line history.</p> Alias Description <code>h</code> history   Prints your command history <code>hs</code> history <code>hsi</code> history <p>\u76f8\u5173\u63d2\u4ef6\uff1ahistory-substring-search</p> <p>This is a clean-room implementation of the Fish shell's history search feature, where you can type in any part of any previously entered command and press the UP and DOWN arrow keys to cycle through the matching commands. You can also use K and J in VI mode or <code>^P</code> and <code>^N</code> in EMACS mode for the same.</p> <p>\u7c7b\u4f3c\u7b2c\u4e09\u65b9\u63d2\u4ef6\uff1azsh-history-substring-search: ZSH port of Fish history search (up arrow)</p>"},{"location":"blog/20191027/zsh-plugins/#colorized","title":"colorized","text":"<p>colorize/: Plugin for <code>highlighting file content</code></p> <p>With this plugin you can syntax-highlight file contents of over 300 supported languages and other text formats.</p> <p>Colorize will highlight the content based on the filename extension. If it can't find a syntax-highlighting method for a given extension, it will try to find one by looking at the file contents. If no highlight method is found it will just cat the file normally, without syntax highlighting.</p> <p>\u57fa\u4e8e <code>pygmentize</code>\uff0c\u9700\u8981\u6267\u884c <code>pip3 search Pygments</code> \u5b89\u88c5 Pygments \u63d2\u4ef6\u3002</p> <p>\u76f8\u5173\u63d2\u4ef6\uff1acolored-man-pages</p> <p><code>colored-man-pages</code>\uff1aman page \u9875\u9762\u5f69\u8272\u5316\uff08adds colors to man pages\uff09\u3002</p> <ul> <li>Manpages \u5f69\u8272\u7248 </li> <li>\u8ba9bash\u7684man\u770b\u4e0a\u53bb\u591a\u59ff\u591a\u5f69 </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#fancy-ctrl-z","title":"fancy-ctrl-z","text":"<p>ohmyzsh/plugins/fancy-ctrl-z/</p> <p>Use Ctrl-Z to switch back to Vim</p> <p>I frequently need to execute random commands in my shell. To achieve it I pause Vim by pressing <code>Ctrl-z</code>, type command and press <code>fg</code> to switch back to Vim. The <code>fg</code> part really hurts me. I just wanted to hit <code>Ctrl-z</code> once again to get back to Vim. I could not find a solution, so I developed one on my own that works wonderfully with ZSH.</p>"},{"location":"blog/20191027/zsh-plugins/#command-not-found","title":"command-not-found","text":"<p>This plugin uses the command-not-found package for zsh to provide suggested packages to be installed if a command cannot be found.</p> <p>\u7c7b\u4f3c ubuntu bash shell \u4e0b\u6267\u884c\u672a\u77e5\u547d\u4ee4\u7684\u4ee5\u4e0b\u63d0\u793a\uff1a</p> <pre><code>pifan@rpi4b-ubuntu:~$ ifconfig\nCommand 'ifconfig' not found, but can be installed with:\nsudo apt install net-tools\n</code></pre>"},{"location":"blog/20191027/zsh-plugins/#thefuck","title":"thefuck","text":"<p>The Fuck plugin \u2014 magnificent app which corrects your previous console command.</p> <p>\u9996\u5148\u9700\u8981\u6267\u884c <code>pip install thefuck</code> \u6216 <code>brew install thefuck</code> \u5b89\u88c5 <code>thefuck</code> \u6821\u51c6\u5de5\u5177\u3002 \u542f\u7528\u8be5\u63d2\u4ef6\u540e\uff0c\u8f93\u5165 <code>fuck</code> \u6216\u8fde\u6309\u4e24\u6b21 <code>ESC</code> \u53ef\u7ea0\u6b63\u4e0a\u6b21\u63a7\u5236\u53f0\u8f93\u5165\u7684\u9519\u8bef\u5e76\u6267\u884c\u3002</p> <ul> <li>Usage: Press <code>ESC</code> twice to correct previous console command.  </li> <li>Notes: <code>Esc-Esc</code> key binding conflicts with sudo plugin.  </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#systemadmin","title":"systemadmin","text":"<p>The systemadmin plugin adds a series of aliases and functions which make a System Administrator's life easier.</p> <p>\u5176\u4ed6\u76f8\u5173\u63d2\u4ef6\uff1a</p> <ul> <li>shell-proxy: a pure user-space program, shell-proxy setter, written in Python3 and Zsh.  </li> <li>ssh-agent: starts automatically <code>ssh-agent</code> to set up and load whichever credentials you want for ssh connections.  </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#utilities","title":"utilities","text":""},{"location":"blog/20191027/zsh-plugins/#copypath","title":"copypath","text":"<p>copypath: Copies the path of given directory or file to the system clipboard.</p> <ul> <li><code>copypath</code>: copies the absolute path of the current directory.</li> <li><code>copypath &lt;file_or_directory&gt;</code>: copies the absolute path of the given file.</li> </ul> <p>\u76f8\u5173\u63d2\u4ef6\uff1acopyfile: Puts the contents of a file in your system clipboard so you can paste it anywhere.</p> <p>run the command <code>copyfile &lt;filename&gt;</code> to copy the file named filename.</p>"},{"location":"blog/20191027/zsh-plugins/#extractx","title":"extract(x)","text":"<p>The extract plugin defines a function called <code>extract</code> that extracts the archive file you pass it, and it supports a wide variety of archive filetypes.</p> <p>This way you don't have to know what specific command extracts a file, you just do <code>extract &lt;filename&gt;</code> and the function takes care of the rest.</p> <p><code>extract</code> \u662f\u4e07\u80fd\u89e3\u538b\u547d\u4ee4\u63d2\u4ef6\uff0c\u4e00\u6761 extract \u547d\u4ee4\u641e\u5b9a\u5e38\u89c1\u683c\u5f0f\u538b\u7f29\u5305\u7684\u89e3\u538b\uff0c\u65e0\u9700\u8bb0\u5fc6 tar \u7b49\u547d\u4ee4\u7684\u590d\u6742\u89e3\u538b\u53c2\u6570\u3002</p> <pre><code>$ x\nUsage: extract [-option] [file ...]\n\nOptions:\n    -r, --remove    Remove archive after unpacking.\n</code></pre>"},{"location":"blog/20191027/zsh-plugins/#encode64","title":"encode64","text":"<p>encode64: Alias plugin for encoding or decoding using base64 command.</p> Function Alias Description encode64 <code>e64</code> Encodes given data to base64 decode64 <code>d64</code> Decodes given data from base64 <p>Base64 \u7f16\u89e3\u7801\u5feb\u6377\u547d\u4ee4\uff1a</p> <ul> <li>alias e64=encode64  </li> <li>alias d64=decode64  </li> </ul> <p>\u76f8\u5173\u63d2\u4ef6\uff1aurltools: provides two aliases to URL-encode and URL-decode strings.</p> Command Description <code>urlencode</code> URL-encodes the given string <code>urldecode</code> URL-decodes the given string"},{"location":"blog/20191027/zsh-plugins/#jsontools","title":"jsontools","text":"<p>jsontools: Handy command line tools for dealing with json data.</p> <ul> <li>pp_json - pretty prints json  </li> <li>is_json - returns true if valid json; false otherwise  </li> <li>urlencode_json - returns a url encoded string for the given json  </li> <li>urldecode_json - returns decoded json for the given url encoded string  </li> </ul> <p>Usage is simple...just take your json data and pipe it into the appropriate jsontool.</p> <pre><code>&lt;json data&gt; | &lt;jsontools tool&gt;\n</code></pre>"},{"location":"blog/20191027/zsh-plugins/#web-search","title":"web-search","text":"<p>The web-search plugin adds aliases for searching with Google, Wiki, Bing, YouTube and other popular services.</p> <p>web_search from terminal\uff1a\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u53d1\u8d77\u641c\u7d22\u3002</p> <ul> <li>alias bing='web_search bing'</li> <li>alias google='web_search google'</li> <li>alias yahoo='web_search yahoo'</li> <li>alias ddg='web_search duckduckgo'</li> <li>alias sp='web_search startpage'</li> <li>alias yandex='web_search yandex'</li> <li>alias github='web_search github'</li> <li>alias baidu='web_search baidu'</li> <li>alias ecosia='web_search ecosia'</li> <li>alias goodreads='web_search goodreads'</li> <li>alias qwant='web_search qwant'</li> </ul> <p>\u641c\u7d22\u793a\u4f8b\uff1a<code>google oh-my-zsh</code>\u3001 <code>bing zsh plugins</code>\u3001 <code>baidu zsh \u63d2\u4ef6</code></p>"},{"location":"blog/20191027/zsh-plugins/#editor","title":"editor","text":""},{"location":"blog/20191027/zsh-plugins/#sublime","title":"sublime","text":"<p>sublime: Plugin for Sublime Text, a cross platform text and code editor, available for Linux, macOS, and Windows.</p> <ul> <li><code>st</code>: launch Sublime Text  </li> <li><code>stt</code>: equivalent to <code>st .</code>, opening the current folder in Sublime Text  </li> <li><code>sst</code>: like <code>sudo st</code>, opening the file or folder in Sublime Text. Useful for editing system protected files.  </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#vscode","title":"vscode","text":"<p>The vscode plugin provides useful aliases to simplify the interaction between the command line and VS Code or VSCodium editor.</p> <p>Common aliases</p> Alias Command Description vsc code . Open the current folder in VS code vsca <code>dir</code> code --add <code>dir</code> Add folder(s) to the last active window vscd <code>file</code> <code>file</code> code --diff <code>file</code> <code>file</code> Compare two files with each other. vscg <code>file:line[:char]</code> code --goto <code>file:line[:char]</code> Open a file at the path on the specified line and character position. vscn code --new-window Force to open a new window. vscr code --reuse-window Force to open a file or folder in the last active window. vscw code --wait Wait for the files to be closed before returning. vscu <code>dir</code> code --user-data-dir <code>dir</code> Specifies the directory that user data is kept in. Can be used to open multiple distinct instances of Code. <ul> <li><code>vsc</code>\uff1a\u76f8\u5f53\u4e8e <code>code .</code>\uff0c\u65b0\u5f00 vscode \u7a97\u53e3\u6253\u5f00\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u3002  </li> <li><code>vscn</code>\uff1a\u76f8\u5f53\u4e8e <code>code -n</code>\uff0c\u65b0\u5f00 vscode \u7a97\u53e3\uff0c\u5176\u540e\u53ef\u63a5 <code>.</code>\u3001<code>file</code> \u6216 <code>folder</code>\u3002  </li> <li><code>vscr</code>\uff1a\u76f8\u5f53\u4e8e <code>code -r</code>\uff0c\u590d\u7528\uff08\u8986\u76d6\uff09\u6700\u540e\u4e00\u4e2a\u6d3b\u8dc3\u7a97\u53e3\uff0c\u5176\u540e\u53ef\u63a5 <code>.</code>\u3001<code>file</code> \u6216 <code>folder</code>\u3002  </li> <li><code>vscd</code>\uff1a\u76f8\u5f53\u4e8e <code>code -d</code>\uff0c\u5728\u6700\u540e\u4e00\u4e2a\u6d3b\u8dc3\u7a97\u53e3\u6253\u5f00\u6587\u4ef6\u5bf9\u6bd4\u3002  </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#marked2","title":"marked2","text":"<p>marked2: Plugin for Marked 2, a previewer for Markdown files on Mac OS X </p> <ul> <li>If <code>marked</code> is called without an argument, open Marked  </li> <li>If <code>marked</code> is passed a file, open it in Marked  </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#develop","title":"develop","text":""},{"location":"blog/20191027/zsh-plugins/#git","title":"git","text":"<p>The git plugin provides many aliases and a few useful functions.</p> <p>See the wiki for a list of aliases and functions provided by the plugin.</p> <p><code>git</code> \u63d2\u4ef6\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u7684\u547d\u4ee4\u5feb\u6377\u7f29\u5199\u5173\u8054\uff08Alias for Commands\uff09\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e\uff0c\u9700\u8981\u65f6\u53ef\u67e5\u8be2\u5728\u7ebf wiki\u3002</p> <p>\u8fd9\u91cc\u4ec5\u5217\u51fa\u4e00\u4e9b Functions\uff1a</p> Command Description <code>grename &lt;old&gt; &lt;new&gt;</code> Rename old branch to new, including in origin remote <code>current_branch</code> Return the name of the current branch <code>git_current_user_name</code> Returns the user.name config value <code>git_current_user_email</code> Returns the user.email config value <code>git_main_branch</code> Returns the name of the main branch: main if it exists, master otherwise <code>git_develop_branch</code> Returns the name of the develop branch: dev, devel, development if they exist, develop otherwise <p>\u5176\u4ed6\u76f8\u5173\u63d2\u4ef6\uff1a</p> <ul> <li>repo </li> <li>gitignore </li> <li>git-prompt </li> <li>git-lfs </li> <li>git-flow </li> <li>git-flow-avh </li> <li>github </li> <li>git-hubflow </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#adb","title":"adb","text":"<p>ohmyzsh/plugins/adb/</p> <ul> <li>Adds autocomplete options for all adb commands.  </li> <li>Add autocomplete for <code>adb -s</code> </li> </ul> <p>\u76f8\u5173\u63d2\u4ef6\uff1aant\u3002</p>"},{"location":"blog/20191027/zsh-plugins/#httpie","title":"httpie","text":"<p>The httpie plugin adds completion for HTTPie, which is a command line HTTP client, a user-friendly cURL replacement.</p>"},{"location":"blog/20191027/zsh-plugins/#nvm","title":"nvm","text":"<p>The nvm plugin adds autocompletions for nvm \u2014 a Node.js version manager. It also automatically sources nvm, so you don't need to do it manually in your <code>.zshrc</code>.</p> <p>The node plugin adds <code>node-docs</code> function that opens specific section in Node.js documentation (depending on the installed version).</p> <p><code>node-docs</code> \u547d\u4ee4\u5feb\u901f\u6253\u5f00\u5f53\u524d\u7248\u672c\u7684 Node \u5e2e\u52a9\u6587\u6863\u4e3b\u9875 \u2014\u2014 Node.js v10.9.0 Documentation\u3002</p> <p>The npm plugin provides completion as well as adding many useful aliases.</p> <p>\u5176\u4ed6\u76f8\u5173\u63d2\u4ef6\uff1a</p> <ul> <li>fnm </li> <li>deno </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#python","title":"python","text":"<ul> <li>autoenv </li> <li>autopep8 </li> <li>pep8 </li> <li>pyenv </li> <li>pylint </li> <li>virtualenv </li> <li>virtualenvwrapper </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#flutter","title":"flutter","text":"<p>The flutter plugin provides completion and useful aliases.</p>"},{"location":"blog/20191027/zsh-plugins/#custom","title":"custom","text":"<p>\u7b2c\u4e09\u65b9 <code>plugin.zsh</code> \u63d2\u4ef6\u7684 \u5b89\u88c5\u3001\u542f\u7528/\u7981\u7528\u3001\u5378\u8f7d \u53ef\u53c2\u8003 <code>git-open</code>\u3002</p> <ul> <li><code>git clone https://github.com/paulirish/git-open.git $ZSH_CUSTOM/plugins/git-open</code> </li> <li><code>cd $ZSH_CUSTOM/plugins &amp;&amp; git clone https://github.com/paulirish/git-open.git</code> </li> </ul> <p>\u7b2c\u4e09\u65b9 <code>zsh</code> \u63d2\u4ef6\u7684 \u5b89\u88c5\u3001\u542f\u7528/\u7981\u7528\u3001\u5378\u8f7d \u53ef\u53c2\u8003 <code>vimman</code>\u3002</p> <ol> <li> <p>\u514b\u9686 git repo \u5230\u672c\u5730\u76ee\u5f55\uff08<code>$ZSH_CUSTOM/scripts/</code>\uff09\uff1a</p> <ul> <li><code>git clone https://github.com/yonchu/vimman.git $ZSH_CUSTOM/scripts/vimman</code></li> </ul> </li> <li> <p>\u7136\u540e\u518d\u5728 <code>~/.zshrc</code> \u4e2d source \u811a\u672c\uff0c\u91cd\u542f zsh \u751f\u6548\uff1a</p> <ul> <li><code>source ~/.oh-my-zsh/custom/scripts/vimman/vimman.zsh</code></li> </ul> </li> </ol>"},{"location":"blog/20191027/zsh-plugins/#ls","title":"ls","text":"<p>ls: It improves the output of ls, and adds the following aliases:</p> <ul> <li><code>l</code> - similar to ls  </li> <li><code>la</code> - similar to ls, but show all files  </li> <li><code>lsd</code> - show only directories  </li> <li><code>ll</code> - show files line by line  </li> </ul>"},{"location":"blog/20191027/zsh-plugins/#vimman","title":"vimman","text":"<p>vimman - View vim plugin manuals (help) like man in zsh</p> <p>vimehelp makes opening the vim help quickly in zsh.</p> <p>git clone \u5230 <code>$ZSH_CUSTOM/scripts/vimman</code> \u540e\uff0c\u5728 <code>~/.zshrc</code> \u4e2d source \u8be5 zsh \u811a\u672c\u91cd\u542f\u751f\u6548\u3002</p> <p>\u793a\u4f8b\uff1a<code>vimman number</code> \u67e5\u770b <code>number</code> \u76f8\u5173\u5e2e\u52a9\u4e3b\u9898\uff1a</p> <pre><code>MBP-FAN ~ \u00bb vimman number\n:help number\n</code></pre>"},{"location":"blog/20191027/zsh-plugins/#git-open","title":"git-open","text":"<p>git-open: Type <code>git open</code> to open the repo website (GitHub, GitLab, Bitbucket) in your browser.</p> <p>\u8fdb\u5165 git \u5206\u652f\u76ee\u5f55\uff0c\u6267\u884c <code>git open</code> \u6216 <code>git-open</code> \u5373\u53ef\u8c03\u8d77\u6d4f\u89c8\u5668\u6253\u5f00 remote \u4ed3\u5e93\u3002</p> <p>\u5c06\u63d2\u4ef6\u4ece git clone \u5230 <code>$ZSH_CUSTOM/plugins/git-open</code> \u5373\u53ef\u5b8c\u6210\u5b89\u88c5\uff1a</p> <pre><code>faner on MBP-FAN in ~\n$ git clone https://github.com/paulirish/git-open.git $ZSH_CUSTOM/plugins/git-open\nCloning into '/Users/faner/.oh-my-zsh/custom/plugins/git-open'...\nremote: Counting objects: 651, done.\nremote: Compressing objects: 100% (13/13), done.\nremote: Total 651 (delta 5), reused 10 (delta 3), pack-reused 635\nReceiving objects: 100% (651/651), 151.67 KiB | 72.00 KiB/s, done.\nResolving deltas: 100% (310/310), done.\nChecking connectivity... done.\n</code></pre> <p>\u4e0b\u8f7d\u5b89\u88c5\u540e\u914d\u7f6e\u5230 <code>~/.zshrc</code> \u7684 plugins \u4e2d\uff0c\u518d\u6267\u884c <code>source .zshrc</code> \u5373\u53ef\u751f\u6548\u3002 \u5728 <code>~/.zshrc</code> \u7684 plugins \u4e2d\u79fb\u9664\u8be5\u63d2\u4ef6\u5373\u53ef\u7981\u7528\uff0c\u5f53\u7136\u4e5f\u53ef\u6267\u884c <code>rm -rf $ZSH_CUSTOM/plugins/git-open</code> \u79fb\u9664\u5378\u8f7d\u3002</p>"},{"location":"blog/20191027/zsh-plugins/#zsh-256color","title":"zsh-256color","text":"<p>zsh-256color: This ZSH plugin enhances the terminal environment with 256 colors.</p> <p>It looks at the chosen <code>TERM</code> environment variable and sees if there is respective (n-)curses' termcap/terminfo descriptors for 256 colors available. The result is a multicolor terminal, if available.  </p>"},{"location":"blog/20191027/zsh-plugins/#zsh-autosuggestions","title":"zsh-autosuggestions","text":"<p>zsh-autosuggestions: Fish-like fast/unobtrusive autosuggestions for zsh.</p> <p>It suggests commands as you type based on history and completions.</p> <p>\u5728 zsh \u4e2d\uff0c\u8f93\u5165\u90e8\u5206\u5355\u8bcd\uff0c\u8f93\u5165 tab \u81ea\u52a8\u8865\u9f50\u6216\u5217\u4e3e\u6240\u6709\u53ef\u80fd\u9009\u9879\uff1a</p> <pre><code># git \u7a7a\u683c tab \u5217\u4e3e\u5efa\u8bae\u9009\u9879\nfaner on MBP-FAN in ~\n$ git\nzsh: do you wish to see all 148 possibilities (148 lines)?\n</code></pre> <p>\u901a\u8fc7\u4e0a\u7bad\u5934 \u2191 \u53ef\u56de\u6eaf\u5386\u53f2\u5339\u914d\u547d\u4ee4\uff0c\u6709\u70b9\u7c7b\u4f3c bash completion \u7684 reverse-search-history (C-r\uff1a<code>^r</code>)\u3002</p> <p><code>zsh-autosuggestions</code> \u63d2\u4ef6\u57fa\u4e8e\u5386\u53f2\u8f93\u5165\u547d\u4ee4\u63d0\u4f9b\u667a\u80fd\u5339\u914d\u5efa\u8bae\u3002</p> <p>Fish-like fast/unobtrusive autosuggestions for zsh. It suggests commands as you type, based on command history.  </p> <p>\u6267\u884c git clone \u547d\u4ee4\u5c06\u63d2\u4ef6\u4e0b\u8f7d\u5230 <code>$ZSH_CUSTOM/plugins/zsh-autosuggestions</code> \u76ee\u5f55\u4e2d\uff0c\u518d\u5728 <code>~/.zshrc</code> \u4e2d\u914d\u7f6e\u542f\u7528\u3002</p> <p>\u901a\u8fc7\u53f3\u7bad\u5934 \u2192 \u53ef\u9009\u4e2d\u5f53\u524d\u5efa\u8bae\u5339\u914d\uff0c\u518d\u6309\u56de\u8f66\u952e\u6216 C-j\uff08<code>^j</code>\uff09\u6267\u884c\uff0c\u6216\u6309 C-g\uff08<code>^g</code>\uff09\u653e\u5f03\u3002</p> <p>\u53e6\u5916\uff0c\u540c\u7c7b\u63d2\u4ef6\u63a8\u8350 Incremental completion on zsh\u3002</p>"},{"location":"blog/20191027/zsh-plugins/#zsh-syntax-highlighting","title":"zsh-syntax-highlighting","text":"<p>zsh-syntax-highlighting: Fish shell-like syntax highlighting for Zsh.</p> <ul> <li>This package provides syntax highlighting for the shell zsh.  </li> <li>It enables highlighting of commands whilst they are typed at a zsh prompt into an interactive terminal.  </li> <li>This helps in reviewing commands before running them, particularly in catching syntax errors.  </li> </ul> <p>\u6267\u884c git clone \u547d\u4ee4\u5c06\u63d2\u4ef6\u4e0b\u8f7d\u5230 <code>$ZSH_CUSTOM/plugins/zsh-syntax-highlighting</code> \u76ee\u5f55\u4e2d\uff0c\u518d\u6dfb\u52a0\u5230 <code>~/.zshrc</code> \u4e2d\u7684 plugins \u4e2d\u542f\u7528\u3002</p> <p>\u76f8\u5173\uff1azsh-url-highlighter </p>"},{"location":"blog/20191027/zsh-plugins/#plugins","title":"plugins","text":"<p>\u4ee5\u4e0b\u662f macOS zsh \u914d\u7f6e\u6587\u4ef6 <code>~/.zshrc</code> \u4e2d\u542f\u7528\u7684 plugins \u63d2\u4ef6\u5907\u5fd8\uff1a</p> <pre><code>plugins=(\n    #---------macOS\n    macos\n    brew\n    pod\n    xcode\n    #---------nav\n    # zsh-interactive-cd # requires fzf\n    # last-working-dir # lwd\n    # dirhistory\n    dircycle # ^\u21e7\u2190/\u2192\n    z\n    wd\n    #---------sys\n    # man # Esc + man: man prev command\n    aliases # acs command\n    colored-man-pages\n    # sudo # esc twice to exec prev command with sudo\n    # vi-mode # increase vi-like zsh functionality\n    # timer # perf display command's execution time\n    fancy-ctrl-z # Ctrl-Z to switch back to Vim\n    command-not-found # provide suggested packages\n    thefuck # esc twice to correct prev command\n    # systemadmin # a series of aliases and functions\n    # shell-proxy # shell-proxy setter\n    ssh-agent\n    #---------utility\n    copypath\n    copyfile\n    extract # x command\n    encode64\n    urltools # urlencode, urldecode\n    jsontools\n    web-search\n    #---------git\n    git\n    gitignore\n    git-prompt\n    #---------develop\n    adb\n    vscode\n    # marked2\n    nvm # adds autocompletions for nvm\n    fnm # Fast Node Manager, alternative for nvm\n    node # node-docs\n    npm # npm aliases\n    # yarn # yarnpkg.com, alternative for npm\n    jenv # Java version manager\n    python # python aliases\n    # flutter # provides completion and useful aliases\n    #---------custom \n    # ls # improves the output, adds several aliases\n    git-open\n    iterm2colors    # manage iterm2\u2019s color scheme\n    zsh-tab-colors  # automatically changes iTerm tab color\n    zsh-256color\n    zsh-autosuggestions\n    zsh-syntax-highlighting)\n</code></pre>"},{"location":"blog/20191027/zsh-plugins/#manager","title":"manager","text":"<p>ohmyzsh/plugins/wd/ Setup \u63d0\u4f9b\u4e86\u51e0\u79cd\u5e38\u89c1 zsh \u63d2\u4ef6\u7ba1\u7406\u5668\u4e2d\u7684\u5b89\u88c5\u65b9\u5f0f\u3002 zpm-zsh / ls: How to install \u63d0\u4f9b\u4e86\u51e0\u79cd\u5e38\u89c1 zsh \u63d2\u4ef6\u7ba1\u7406\u5668\u4e2d\u7684\u5b89\u88c5\u65b9\u5f0f\u3002  </p> <p>\u9664\u4e86 oh-my-zsh \u81ea\u5e26\u7684\u63d2\u4ef6\u4e0b\u8f7d\u542f\u7528\u673a\u5236\uff0c\u8fd8\u6709\u4ee5\u4e0b\u51e0\u79cd\u53ef\u9009 zsh plugin manager\uff1a</p> <ul> <li>Antigen </li> <li>Antibody </li> <li>prezto </li> <li>zplug </li> <li>zpm </li> </ul>"},{"location":"blog/20191027/zsh-usages/","title":"macOS\u4e0bzsh\u7684\u4f7f\u7528\u914d\u7f6e","text":"<p>zsh \u5e2e\u52a9\u3001\u73af\u5883\u53d8\u91cf\u548c\u914d\u7f6e\u76f8\u5173\u7684\u4f7f\u7528\u8bb0\u5f55\u3002</p>"},{"location":"blog/20191027/zsh-usages/#zsh_\u7248\u672c","title":"zsh \u7248\u672c","text":"<p>\u6267\u884c <code>zsh --version</code> \u6216 <code>echo $ZSH_VERSION</code> \u53ef\u67e5\u770b zsh \u7248\u672c\uff1a</p> <pre><code># \u67e5\u770b zsh \u7248\u672c\n\nfaner@MBP-FAN:~|\u21d2  zsh --version\nzsh 5.3 (x86_64-apple-darwin17.0)\n\nfaner@MBP-FAN:~|\u21d2  echo $ZSH_VERSION\n5.3\n</code></pre>"},{"location":"blog/20191027/zsh-usages/#zsh_\u5e2e\u52a9","title":"zsh \u5e2e\u52a9","text":"<p>\u6267\u884c <code>man zsh</code> \u53ef\u67e5\u770b zsh \u5e2e\u52a9\u624b\u518c\uff1a</p> <pre><code>################################################################################\n# man zsh\n################################################################################\n\nfaner@MBP-FAN:~/.oh-my-zsh/custom|master\nZSH(1)                                                                                     ZSH(1)\n\n\n\nNAME\n       zsh - the Z shell\n\nOVERVIEW\n       Because  zsh  contains  many features, the zsh manual has been split into a number of sec-\n       tions:\n\n       zsh          Zsh overview (this section)\n       zshroadmap   Informal introduction to the manual\n       zshmisc      Anything not fitting into the other sections\n       zshexpn      Zsh command and parameter expansion\n       zshparam     Zsh parameters\n       zshoptions   Zsh options\n       zshbuiltins  Zsh built-in functions\n       zshzle       Zsh command line editing\n       zshcompwid   Zsh completion widgets\n       zshcompsys   Zsh completion system\n       zshcompctl   Zsh completion control\n       zshmodules   Zsh loadable modules\n       zshtcpsys    Zsh built-in TCP functions\n       zshzftpsys   Zsh built-in FTP client\n       zshcontrib   Additional zsh functions and utilities\n       zshall       Meta-man page containing all of the above\n</code></pre> <p>\u53ef man \u67e5\u770b\u5404\u4e2a\u5b50\u4e3b\u9898\uff0c\u6216 <code>man zshall</code> \u67e5\u770b\u5b8c\u6574\u6587\u6863\u3002</p>"},{"location":"blog/20191027/zsh-usages/#zsh_\u73af\u5883\u53d8\u91cf","title":"ZSH \u73af\u5883\u53d8\u91cf","text":"<p>\u8f93\u5165 <code>echo $ZSH</code> \u518d\u6309 tab \u952e\u53ef\u5217\u4e3e\u6240\u6709\u4ee5 ZSH \u5f00\u5934\u7684\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>################################################################################\n# ZSH envirment variables\n################################################################################\n\nfaner@MBP-FAN:~|\u21d2  echo $ZSH\nZSH                            ZSH_NAME                       ZSH_THEME_GIT_PROMPT_PREFIX\nZSH_ARGZERO                    ZSH_PATCHLEVEL                 ZSH_THEME_GIT_PROMPT_SUFFIX\nZSH_CACHE_DIR                  ZSH_SPECTRUM_TEXT              ZSH_THEME_TERM_TAB_TITLE_IDLE\nZSH_COMPDUMP                   ZSH_SUBSHELL                   ZSH_THEME_TERM_TITLE_IDLE\nZSH_CUSTOM                     ZSH_THEME                      ZSH_VERSION\nZSH_DISABLE_COMPFIX            ZSH_THEME_GIT_PROMPT_CLEAN     zsh_eval_context\nZSH_EVAL_CONTEXT               ZSH_THEME_GIT_PROMPT_DIRTY     zsh_scheduled_events\n</code></pre>"},{"location":"blog/20191027/zsh-usages/#zsh_\u76ee\u5f55","title":"ZSH \u76ee\u5f55","text":"<pre><code>################################################################################\n# ZSH DIR\n################################################################################\n\nfaner@MBP-FAN:~|\u21d2  echo $ZSH\n/Users/faner/.oh-my-zsh\n\nfaner@MBP-FAN:~|\u21d2  cd $ZSH\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_CACHE_DIR\n/Users/faner/.oh-my-zsh/cache\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_COMPDUMP\n/Users/faner/.zcompdump-MBP-FAN-5.3\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_CUSTOM\n/Users/faner/.oh-my-zsh/custom\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_DISABLE_COMPFIX\ntrue\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_EVAL_CONTEXT\ntoplevel\n</code></pre>"},{"location":"blog/20191027/zsh-usages/#git_\u4ed3\u5e93","title":"git \u4ed3\u5e93","text":"<pre><code>faner@MBP-FAN:~/.oh-my-zsh|master \u21d2  git remote -v\norigin  https://github.com/robbyrussell/oh-my-zsh.git (fetch)\norigin  https://github.com/robbyrussell/oh-my-zsh.git (push)\n</code></pre>"},{"location":"blog/20191027/zsh-usages/#\u5b50\u76ee\u5f55","title":"\u5b50\u76ee\u5f55","text":"<pre><code>faner@MBP-FAN:~/.oh-my-zsh|master \u21d2  ls -1\nCONTRIBUTING.md\nLICENSE.txt\nREADME.md\ncache\ncustom\nlib\nlog\noh-my-zsh.sh\nplugins\ntemplates\nthemes\ntools\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  tree -L 1\n.\n\u251c\u2500\u2500 CONTRIBUTING.md\n\u251c\u2500\u2500 LICENSE.txt\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 cache\n\u251c\u2500\u2500 custom\n\u251c\u2500\u2500 lib\n\u251c\u2500\u2500 log\n\u251c\u2500\u2500 oh-my-zsh.sh\n\u251c\u2500\u2500 plugins\n\u251c\u2500\u2500 templates\n\u251c\u2500\u2500 themes\n\u2514\u2500\u2500 tools\n\n8 directories, 4 files\n</code></pre> <ul> <li><code>cache</code>\uff1a\u7f13\u5b58\uff1b  </li> <li><code>custom</code>\uff1a\u4e2a\u6027\u5316\u914d\u7f6e\u76ee\u5f55\uff0c\u81ea\u5b89\u88c5\u7684\u63d2\u4ef6\u548c\u4e3b\u9898\u53ef\u653e\u8fd9\u91cc\uff1b  </li> <li><code>lib</code>\uff1a\u63d0\u4f9b\u4e86\u6838\u5fc3\u529f\u80fd\u7684\u811a\u672c\u5e93\uff1b  </li> <li><code>log</code>\uff1a\u65e5\u5fd7\uff1b  </li> <li><code>plugins</code>\uff1a\u81ea\u5e26\u63d2\u4ef6\u7684\u5b58\u5728\u653e\u4f4d\u7f6e;  </li> <li><code>templates</code>\uff1a\u81ea\u5e26\u6a21\u677f\u7684\u5b58\u5728\u653e\u4f4d\u7f6e;  </li> <li><code>themes</code>\uff1a\u81ea\u5e26\u4e3b\u9898\u6587\u4ef6\u7684\u5b58\u5728\u653e\u4f4d\u7f6e;  </li> <li><code>tools</code>\uff1a\u63d0\u4f9b\u5b89\u88c5\u3001\u5347\u7ea7\u7b49\u529f\u80fd\u7684\u5feb\u6377\u5de5\u5177;  </li> </ul>"},{"location":"blog/20191027/zsh-usages/#zsh_\u540d\u79f0","title":"ZSH \u540d\u79f0","text":"<pre><code>################################################################################\n# ZSH_NAME\n################################################################################\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_NAME\nzsh\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_PATCHLEVEL\nzsh-5.3-0-g4cfdbdb\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_SPECTRUM_TEXT\nArma virumque cano Troiae qui primus ab oris\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_SUBSHELL\n0\n</code></pre>"},{"location":"blog/20191027/zsh-usages/#zsh_\u4e3b\u9898","title":"ZSH \u4e3b\u9898","text":"<pre><code>################################################################################\n# ZSH_THEME\n################################################################################\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_THEME\npygmalion\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_THEME_GIT_PROMPT_CLEAN\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_THEME_GIT_PROMPT_DIRTY\n%{%}\u26a1%{%}\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_THEME_GIT_PROMPT_PREFIX\n%{%}%{%}\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_THEME_GIT_PROMPT_SUFFIX\n%{%}\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_THEME_TERM_TAB_TITLE_IDLE\n%15&lt;..&lt;%~%&lt;&lt;\n\nfaner@MBP-FAN:~/.oh-my-zsh|master \u21d2  echo $ZSH_THEME_TERM_TITLE_IDLE\n%n@%m: %~\n</code></pre> <p>zsh \u9ed8\u8ba4\u4e3b\u9898\u662f <code>robbyrussell</code>\uff0c\u53ef\u5728 <code>~/.zshrc</code> \u4e2d\u4fee\u6539\u4e3a <code>pygmalion</code>\uff1a</p> <pre><code>ZSH_THEME=\"pygmalion\" #\"robbyrussell\"\n</code></pre> <p>\u53ef\u5c06\u4e3b\u9898\u8bbe\u7f6e\u4e3a\u968f\u673a\uff08<code>random</code>\uff09\uff0c\u8fd9\u6837\u6bcf\u6b21\u542f\u52a8\u65b0 zsh \u547d\u4ee4\u884c\u7a97\u53e3\u65f6\uff0c\u4f1a\u968f\u673a\u4ece\u9ed8\u8ba4\u4e3b\u9898\u4e2d\u9009\u62e9\u4e00\u4e2a\u3002  </p> <p>\u6839\u636e\u63d0\u793a\u53ef\u77e5\u5f53\u524d\u52a0\u8f7d\u7684\u4e3b\u9898\u540d\u79f0\uff1a</p> <pre><code>[oh-my-zsh] Random theme '/Users/faner/.oh-my-zsh/themes/duellj.zsh-theme' loaded...\n</code></pre> <p>\u5f53\u89c9\u5f97\u5f53\u524d\u4e3b\u9898\u6bd4\u8f83\u4e2d\u610f\u65f6\uff0c\u53ef\u914d\u7f6e\u5230 <code>~/.zshrc</code> \u4f5c\u4e3a ZSH_THEME\u3002  </p> <ul> <li>https://github.com/robbyrussell/oh-my-zsh/wiki/Themes  </li> <li>https://github.com/robbyrussell/oh-my-zsh/wiki/External-themes  </li> <li>https://github.com/unixorn/awesome-zsh-plugins#themes  </li> </ul>"},{"location":"blog/20191027/zsh-usages/#zsh_\u914d\u7f6e","title":"ZSH \u914d\u7f6e","text":"<p><code>~/.zshrc</code></p> <p>zshrc\u914d\u7f6e</p> <p>man zsh \u53ef\u77e5\uff0czsh \u7684\u914d\u7f6e\u6587\u4ef6\u5982\u4e0b\uff1a</p> <pre><code># man zsh on macOS\n\nFILES\n       $ZDOTDIR/.zshenv\n       $ZDOTDIR/.zprofile\n       $ZDOTDIR/.zshrc\n       $ZDOTDIR/.zlogin\n       $ZDOTDIR/.zlogout\n       ${TMPPREFIX}*   (default is /tmp/zsh*)\n       /etc/zshenv\n       /etc/zprofile\n       /etc/zshrc\n       /etc/zlogin\n       /etc/zlogout    (installation-specific - /etc is the default)\n</code></pre>"},{"location":"blog/20191027/zsh-usages/#omz_\u63d2\u4ef6","title":"omz \u63d2\u4ef6","text":"<p>Oh My Zsh \u9ed8\u8ba4\u81ea\u5e26\u7684\u63d2\u4ef6\u5b58\u653e\u5728 <code>~/.oh-my-zsh/plugins</code> \u76ee\u5f55\u4e2d\uff0c\u53ef\u4ee5 cd \u8fdb\u5165\u67e5\u770b\u3002</p> <p>Oh My Zsh \u9ed8\u8ba4\u53ea\u542f\u7528\u4e86 git \u63d2\u4ef6\uff1a</p> <pre><code># ~/.zshrc\nplugins=(git)\n</code></pre> <p>\u53ef\u8fdb\u5165 git \u63d2\u4ef6\u76ee\u5f55\uff0c\u6267\u884c <code>git remote -v</code> \u67e5\u770b\u63d2\u4ef6\u8fdc\u7aef\u4ed3\u5e93\uff1b \u6253\u5f00 <code>README.md</code> \u6587\u6863\u53ef\u67e5\u770b\u63d2\u4ef6\u8bf4\u660e\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  cd $ZSH/plugins\ncd $ZSH/plugins\n\nfaner@MBP-FAN:~/.oh-my-zsh/plugins/git|master\n\u21d2  git remote -v\ngit remote -v\norigin  https://github.com/robbyrussell/oh-my-zsh.git (fetch)\norigin  https://github.com/robbyrussell/oh-my-zsh.git (push)\n\nfaner@MBP-FAN:~/.oh-my-zsh/plugins/git|master\n\u21d2  open README.md\n</code></pre> <p>The git plugin provides many aliases and a few useful functions. See the wiki for a list of aliases and functions provided by the plugin.  </p> <p>\u5982\u9700\u542f\u7528\u66f4\u591a\u63d2\u4ef6\uff0c\u53ef\u5728\u62ec\u53f7\u4e2d\u4ee5\u7a7a\u683c\u76f8\u9694\u52a0\u5165\u6240\u9700\u63d2\u4ef6\uff1a</p> <pre><code>plugins=(git svn history)\n</code></pre> <p>\u66f4\u591a\u63d2\u4ef6\u53ef\u53c2\u8003\uff1a</p> <p>https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins https://github.com/unixorn/awesome-zsh-plugins https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins-Overview  </p>"},{"location":"blog/20191027/zsh-usages/#omz_\u66f4\u65b0","title":"omz \u66f4\u65b0","text":"<p>\u5f53 Oh-My-Zsh \u6709\u66f4\u65b0\u65f6\uff0c\u9ed8\u8ba4\u63d0\u793a\u786e\u8ba4\u662f\u5426\u5347\u7ea7\u3002 \u53ef\u5728 <code>~/.zshrc</code> \u4e2d\u6dfb\u52a0 <code>DISABLE_UPDATE_PROMPT=true</code> \u7981\u7528\u63d0\u793a\u81ea\u52a8\u66f4\u65b0\u3002  </p> <p>\u6216\u6267\u884c <code>upgrade_oh_my_zsh</code> \u547d\u4ee4\u624b\u52a8\u66f4\u65b0\uff1a</p> <pre><code>faner@MBP-FAN:~/.oh-my-zsh|master \u21d2  upgrade_oh_my_zsh\nUpdating Oh My Zsh\nremote: Counting objects: 1671, done.\nremote: Compressing objects: 100% (845/845), done.\nremote: Total 1671 (delta 887), reused 1482 (delta 723), pack-reused 0\nReceiving objects: 100% (1671/1671), 378.39 KiB | 43.00 KiB/s, done.\nResolving deltas: 100% (887/887), completed with 183 local objects.\nFrom https://github.com/robbyrussell/oh-my-zsh\n * branch            master     -&gt; FETCH_HEAD\n   4cb7307..0853b74  master     -&gt; origin/master\n LICENSE.txt                                             |    2 +-\n README.md                                               |   38 +-\n\n 260 files changed, 7672 insertions(+), 2508 deletions(-)\n\n create mode 100644 custom/themes/example.zsh-theme\n\n mode change 100644 =&gt; 100755 themes/trapd00r.zsh-theme\n\nFirst, rewinding head to replay your work on top of it...\nFast-forwarded master to 0853b74fef0fa3a05af7487ff9b15a7f714bb037.\n         __                                     __\n  ____  / /_     ____ ___  __  __   ____  _____/ /_\n / __ \\/ __ \\   / __ `__ \\/ / / /  /_  / / ___/ __ \\\n/ /_/ / / / /  / / / / / / /_/ /    / /_(__  ) / / /\n\\____/_/ /_/  /_/ /_/ /_/\\__, /    /___/____/_/ /_/\n                        /____/\nHooray! Oh My Zsh has been updated and/or is at the current version.\nTo keep up on the latest news and updates, follow us on twitter: https://twitter.com/ohmyzsh\nGet your Oh My Zsh swag at:  https://shop.planetargon.com/\n</code></pre> <p>\u6700\u65b0\u63d0\u793a\uff1aNote: <code>upgrade_oh_my_zsh</code> is deprecated. Use <code>omz update</code> instead.</p> <p>\u6267\u884c <code>omz help</code> \u67e5\u770b\u5e2e\u52a9\uff1a</p> <pre><code>$ omz help\nUsage: omz &lt;command&gt; [options]\n\nAvailable commands:\n\n  help                Print this help message\n  changelog           Print the changelog\n  plugin &lt;command&gt;    Manage plugins\n  pr     &lt;command&gt;    Manage Oh My Zsh Pull Requests\n  reload              Reload the current zsh session\n  theme  &lt;command&gt;    Manage themes\n  update              Update Oh My Zsh\n  version             Show the version\n</code></pre> <p>\u6267\u884c omz \u66f4\u65b0\uff0c\u4f1a\u81ea\u52a8\u66f4\u65b0\u5185\u7f6e\u63d2\u4ef6\uff08\u5b58\u653e\u5728 <code>$ZSH/plugins</code> \u76ee\u5f55\uff09\u3002</p>"},{"location":"blog/20191027/zsh-usages/#\u66f4\u65b0_custom_\u63d2\u4ef6","title":"\u66f4\u65b0 custom \u63d2\u4ef6","text":"<p>oh my zsh - How to auto-update custom plugins in Oh My Zsh? - Unix &amp; Linux Stack Exchange</p> <p>Oh My Zsh upgrades are handled by the <code>$ZSH/tools/upgrade.sh</code> script. To update any custom plugins (assuming those are Git clones), you can add these lines to the end of the script before the exit command:</p> <pre><code>cd $ZSH_CUSTOM\nprintf \"\\n${BLUE}%s${RESET}\\n\" \"Updating custom plugins, scripts and themes\"\n\nfor plugin in ./*/*; do\n  if [ -d \"$plugin/.git\" ]; then\n     printf \"${YELLOW}%s${RESET}\\n\" \"${plugin%/}\"\n     # git -C \"$plugin\" pull\n  fi\ndone\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4e0b\u8f7d\u4f7f\u7528 autoupdate \u63d2\u4ef6\u3002</p> <p>oh-my-zsh plugin for auto updating of git-repositories in <code>$ZSH_CUSTOM</code> folder.</p>"},{"location":"blog/20151102/1-Markdown-Syntax/","title":"Markdown Syntax","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 Markdown \u57fa\u672c\u7528\u6cd5\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u6ce8\u91cacomment","title":"\u6ce8\u91ca\uff08Comment\uff09","text":"<p>\u6ce8\u91ca\u662f\u5199\u4f5c\u8005\u81ea\u5df1\u7684\u6807\u6ce8\u8bb0\u5f55\uff0c\u4e0d\u88ab\u6d4f\u89c8\u5668\u89e3\u6790\u6e32\u67d3\u3002 HTML \u4ee5 <code>&lt;!--</code> \u5f00\u5934\uff0c\u4ee5 <code>--&gt;</code> \u7ed3\u5c3e\u7684\u95ed\u5305\u5b9a\u4e49\u6ce8\u91ca\uff08\u652f\u6301\u8de8\u884c\uff09\uff0c\u4e0d\u5728\u6b63\u6587\u4e2d\u663e\u793a\u3002 Markdown \u6cbf\u7528 HTML Comment \u6ce8\u91ca\u683c\u5f0f\uff1a <code>&lt;!-- This text will not appear in the browser window. --&gt;</code></p> <p>\u6ce8\u91ca\u9002\u7528\u573a\u666f\u793a\u4f8b\uff1a</p> <ol> <li> <p>CSDN \u535a\u5ba2\u9ed8\u8ba4\u4f1a\u5728\u7f51\u9875\u751f\u6210TOC\uff0c\u800c GitHub \u4ecd\u4e0d\u652f\u6301<code>[TOC]</code>\uff0c\u56e0\u6b64\u5728\u53d1\u5e03 Markdown \u535a\u5ba2\u65f6\u53ef\u6ce8\u91ca\u6389\u5f00\u5934\u7684 [TOC] \u6807\u7b7e\uff0c\u5728\u9700\u8981\u67e5\u770b OUTLINE \u65f6\u518d\u6253\u5f00\u3002 <code>&lt;!--[TOC]--&gt;</code></p> </li> <li> <p>\u5728\u535a\u5ba2 Markdown \u6e90\u7801\u5f00\u5934\uff0c\u672c\u4eba\u901a\u5e38\u4f7f\u7528\u6ce8\u91ca\u6765\u5907\u6ce8 git commit-hash-id \u548c commit-date \u4fe1\u606f\uff08git log -p \uff09\uff0c\u4ee5\u4fbf\u4fee\u8ba2\u53d8\u66f4\u65f6\u56de\u6eaf\u3002 <code>&lt;!--commit 5326f29752b7ee3472aa00b40574bd585e3ef25b--&gt;</code> <code>&lt;!--Mon Nov 2 00:36:40 2015 +0800--&gt;</code></p> </li> <li> <p>\u5728\u4f7f\u7528 Markdown \u5199\u4f5c\u535a\u5ba2\u65f6\uff0c\u672c\u4eba\u559c\u6b22\u91c7\u7528\u53c2\u8003\u5f0f\u94fe\u63a5\uff0c\u7136\u540e\u5728\u6587\u672b\u4e13\u95e8\u5f00\u8f9f\u4e00\u8282\u7528\u4e8e\u5b9a\u4e49\u6587\u4e2d\u7528\u5230\u7684\u6240\u6709\u811a\u6ce8\u548c\u53c2\u8003\u94fe\u63a5\u3002\u501f\u52a9 Haroopad/FoldingText/Marked2 \u7684\u6298\u53e0\u7279\u6027\uff0c\u672c\u4eba\u4e60\u60ef\u5728\u672b\u5c3e\u6dfb\u52a0\u4e00\u884c Comment Heading\uff0c\u7528\u4e8e\u5728\u9605\u8bfb Markdown \u6e90\u7801\u65f6\u6298\u53e0\u9690\u85cf\u6587\u672b\u7684\u53c2\u8003\u533a\u3002 <code>##&lt;!--\u4ee5\u4e0b\u662f\u672c\u6587\u7684\u811a\u6ce8\u548c\u8d85\u94fe\u63a5--&gt;</code></p> </li> </ol>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u6807\u9898header","title":"\u6807\u9898\uff08Header\uff09<sup>1</sup>","text":"<p>\u6807\u9898\u7528\u4e8e\u5448\u73b0\u6587\u6863\u7ec4\u7ec7\u7ed3\u6784\uff0c\u5f88\u591a Markdown \u89e3\u6790\u5668\u90fd\u63d0\u4f9b\u57fa\u4e8e Heading Levels \u6765\u751f\u6210\u6587\u6863\u5927\u7eb2\u7684 <code>[TOC]</code>\uff08Table of Contents\uff09\u6807\u7b7e\uff0c\u641c\u7d22\u5f15\u64ce\u5219\u4f7f\u7528\u6807\u9898\u4e3a\u7f51\u9875\u7684\u7ed3\u6784\u548c\u5185\u5bb9\u7f16\u5236\u7d22\u5f15\u3002 \u4e00\u822c\u8bba\u6587\u6216\u535a\u5ba2\u6587\u6863\u7ed3\u6784\u52303\u52304\u7ea7\u5373\u53ef\uff0c\u53ef\u53c2\u8003\u300a\u6bd5\u4e1a\u8bba\u6587\u7684\u56fd\u5bb6\u6807\u51c6\u683c\u5f0f\u4e0e\u901a\u7528\u683c\u5f0f\u300b\u3001\u300a\u53d1\u8868\u8bba\u6587\u901a\u7528\u683c\u5f0f\u300b\u548c\u300a\u671f\u520a\u8bba\u6587\u683c\u5f0f\u300b\u3002</p> <p>Markdown \u652f\u6301\u4e24\u79cd\u6807\u9898\u7684\u8bed\u6cd5\uff0c\u7c7b Setext \u548c\u7c7b atx \u5f62\u5f0f\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#setext_heading_format2_level","title":"Setext Heading Format\uff082 level\uff09","text":"<p>\u7c7b Setext \u5f62\u5f0f\u662f\u7528\u5e95\u7ebf\u7684\u5f62\u5f0f\uff0c\u4f7f\u7528\u4e09\u4e2a\u6216\u4ee5\u4e0a\u8fde\u7eed =\uff08equal signs\uff09\u5e95\u7ebf\u6807\u8bb0\u6700\u9ad8\u9636\u6807\u9898\uff0c\u4f7f\u7528\u4e09\u4e2a\u6216\u4ee5\u4e0a\u8fde\u7eed -\uff08dashes\uff09\u5e95\u7ebf\u6807\u8bb0\u7b2c\u4e8c\u9636\u6807\u9898\u3002\u4f8b\u5982\uff1a</p> <ol> <li>equal signs for first-level headers:</li> </ol> <pre><code>    This is an H1\n    ===\n</code></pre> <ol> <li>dashes for second-level headers:</li> </ol> <pre><code>    This is an H2\n    ----\n</code></pre>"},{"location":"blog/20151102/1-Markdown-Syntax/#atx_heading_format6_level","title":"Atx Heading Format\uff086 level\uff09","text":"<p>\u7c7b Atx \u5f62\u5f0f\u5219\u662f\u5728\u884c\u9996\u63d2\u5165 1 \u5230 6 \u4e2a # \uff08hash character\uff09\uff0c\u5bf9\u5e94 6 \u9636\u6807\u9898\uff08\u5bf9\u5e94 HTML \u4e2d\u7684 <code>&lt;h1&gt;</code> - <code>&lt;h6&gt;</code> \u6807\u7b7e\uff09\u3002\u4f8b\u5982\uff1a</p> <pre><code># \u8fd9\u662f\u4e00\u7ea7\u6807\u9898\uff08H1\uff0c\u901a\u5e38\u7528\u4e8e\u6587\u6863\u6807\u9898\uff09  \n## \u8fd9\u662f\u4e8c\u7ea7\u6807\u9898\uff08H2\uff0c\u6709\u4e9b\u6e32\u67d3\u5668\u4f1a\u4e3a\u4e8c\u7ea7\u6807\u9898\u6dfb\u52a0 hr \u5e95\u7ebf\uff09  \n### \u8fd9\u662f\u4e09\u7ea7\u6807\u9898\uff08H3\uff09  \n#### \u8fd9\u662f\u56db\u7ea7\u6807\u9898\uff08H4\uff09  \n##### \u8fd9\u662f\u4e94\u7ea7\u6807\u9898\uff08H5\uff09#####  \n###### \u8fd9\u662f\u516d\u7ea7\u6807\u9898\uff08H6\uff09######\n</code></pre> <p>\u884c\u9996\u7684 <code>#</code> \u53f7\u4e2a\u6570\u51b3\u5b9a\u6807\u9898\u9636\u6570\uff0c\u4e3a\u517c\u5bb9\u548c\u9605\u611f\u8d77\u89c1\uff0c\u5efa\u8bae\u6700\u540e\u4e00\u4e2a <code>#</code> \u53f7\u548c\u6807\u9898\u6587\u5b57\u4e4b\u95f4\u52a0\u63d2\u4e00\u4e2a\u7a7a\u683c\u3002 \u884c\u4e2d\uff08\u672b\uff09\u7684 <code>#</code> \u53f7\u5219\u88ab\u89c6\u4f5c\u666e\u901a\u5b57\u7b26\u3002\u4e3a\u7f8e\u89c2\u8d77\u89c1\uff0c\u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u6027\u5730\u300c\u95ed\u5408\u300d\u7c7b atx \u6837\u5f0f\u7684\u6807\u9898\uff0c\u5728\u884c\u5c3e\u52a0\u4e0a\u5bf9\u5e94\u6216\u4e0d\u9650\u6570\u91cf\u7684 # \u53f7\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u53e5\u6bb5sentence__paragraph","title":"\u53e5\u6bb5\uff08Sentence / Paragraph\uff09","text":""},{"location":"blog/20151102/1-Markdown-Syntax/#\u6362\u884c","title":"\u6362\u884c","text":"<p>\u6807\u51c6 Markdown \u4e0d\u652f\u6301\u81ea\u7136\u6362\u884c\uff08literal new line\uff09\uff0c\u6709\u4e9b\u6e32\u67d3\u5668\u6269\u5c55\u652f\u6301\u81ea\u7136\u6362\u884c\u3002 <code>#</code> \u53f7\u6807\u8bc6\u7684 Heading\uff08H1-H6\uff09 \u4f1a\u81ea\u7136\u6362\u884c\uff0c\u666e\u901a\u53e5\u6bb5\u4e4b\u95f4\u82e5\u8981\u5f3a\u5236\u6362\u884c\uff08Manual Line Break\uff09\uff0c\u53ef\u4ee5\u5728\u81ea\u7136\u6362\u884c\u884c\u5c3e\u8ffd\u52a0\u4e24\u4e2a\uff08\u6216\u4ee5\u4e0a\uff09\u7a7a\u683c\u6765\u5b9e\u73b0\u3002 \u7531\u4e8e\u4e0d\u540c\u7684 Markdown Editor \u7684\u6e32\u67d3\u6548\u679c\u4e0d\u4e00\uff0c\u5efa\u8bae\u6309\u7167\u6807\u51c6 Markdown \u4e66\u5199\uff0c\u8fd9\u6837\u53d1\u5e03\u5230\u4e0d\u540c\u7684\u6e32\u67d3\u5f15\u64ce\u4e0b\u624d\u80fd\u53d6\u5f97\u6700\u4f18\u7684\u517c\u5bb9\u6027\u3002\u4f8b\u5982\uff1a\u4f60\u53ef\u80fd\u9700\u8981\u5728\u4e24\u884c\u8fde\u7eed\u7684\u4ee5 <code>&gt;</code> \u5f00\u5934\u7684\u5f15\u7528\u4e4b\u95f4\u52a0\u5165\u4e24\u4e2a\u7a7a\u683c\u786c\u6362\u884c\u6765\u907f\u514d\u7c98\u8fde\uff1b\u5728\u67d0\u4e9b Markdown Editor \u4e2d\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u5728 bullet list item \u884c\u5c3e\u8ffd\u52a0\u4e24\u4e2a\u7a7a\u683c\u786c\u6362\u884c\u6765\u7eed\u63a5\u540e\u9762\u7684\u6df7\u5408\u7f16\u6392\u3002</p> <p>\u9002\u65f6\u5185\u5d4c HTML \u7684 <code>&lt;br&gt;</code> \u63a7\u5236\u6362\u884c</p> <p>\u7531\u4e8e\u7a7a\u683c\u5728 Markdown \u4e2d\u4e3b\u8981\u662f\u8d77\u7740\u63a7\u5236\u6392\u7248\u7684\u4f5c\u7528\uff0c\u56e0\u6b64\u5728\u67d0\u4e9b\u590d\u6742\u7684\u533a\u5757\u5143\u7d20\u4e2d\uff0c\u4f8b\u5982\u4e0b\u6587\u63d0\u5230\u7684 Table \u8868\u683c\u4e2d\u7684 td \u5143\u7d20\u4e2d\uff0c\u53ea\u80fd\u901a\u8fc7\u5185\u5d4c HTML \u7684<code>&lt;br&gt;</code>\uff08XHTML \u81ea\u95ed\u5408\u5199\u4f5c <code>&lt;br /&gt;</code>\uff09\u6807\u7b7e\u6765\u5b9e\u73b0\u5c40\u90e8\u6362\u884c\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u5206\u6bb5","title":"\u5206\u6bb5","text":"<p>\u6bb5\u843d\u662f\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u8fde\u7eed\u7684\u6587\u672c\u884c\u7ec4\u6210\uff0c\u5b83\u7684\u524d\u540e\u5f80\u5f80\u9700\u8981\u7a7a\u884c\u4e88\u4ee5\u660e\u793a\u5206\u9694\u3002</p> <p>\u5728\u663e\u793a\u4e0a\u770b\u8d77\u6765\u50cf\u662f\u7a7a\u7684\uff0c\u4f8b\u5982\u53ea\u5305\u542b\u7a7a\u683c\u6216\uff08\u548c\uff09\u5236\u8868\u7b26\uff08tab\uff09\u7684\u884c\uff0c\u4fbf\u4f1a\u88ab\u89c6\u4e3a\u7a7a\u884c\u3002</p> <p>\u7a7a\u884c\u9002\u7528\u573a\u666f\u8bf4\u660e\uff1a</p> <ol> <li>\u7a7a\u884c\u7684\u4e0a\u4e00\u53e5\u672b\u65e0\u9700\u518d\u6dfb\u52a0\u4e24\u4e2a\u7a7a\u683c\u6216 <code>&lt;br/&gt;</code> \u6362\u884c\u4e86\u3002  </li> <li>\u53e5\u6bb5\u4e4b\u95f4\u5f15\u5165\u7a7a\u884c\uff0c\u76f8\u5f53\u4e8e\u95f4\u9694\u6210\u6bb5\u843d\uff08\u5bf9\u5e94 HTML \u7684 <code>&lt;p&gt;</code> \u6807\u7b7e\uff09\u3002  </li> <li>\u5c3d\u7ba1 Markdown Render \u4f1a\u5bf9\u5404\u9636 Heading\uff08H1-H6\uff09\u6709\u7279\u6b8a\u7684\u683c\u5f0f\u6e32\u67d3\u6765\u51f8\u663e\u5c42\u7ea7\uff0c\u4f46\u8fd8\u662f\u5efa\u8bae\u5728\u7ae0\u8282\uff08Section/Chapter\uff09\u672b\u5c3e\u9002\u65f6\u63d2\u5165\u7a7a\u884c\uff0c\u4ee5\u793a\u884c\u6587\u5206\u5272\u4e14\u65b9\u4fbf\u9605\u8bfb\u3002  </li> <li>\u4e3a\u4e86\u66f4\u4f18\u7684 \u9605\u8bfb\u611f \u548c \u517c\u5bb9\u6027\uff0c\u5efa\u8bae\u5728\u5206\u5272\u7ebf\uff08Horizontal Rules\uff09\u7684\u4e0a\u9762\u7559\u4e00\u7a7a\u884c\uff0c\u5757\u5f15\u7528\uff08Blockquote\uff09\u3001\u9884\u683c\u5f0f\u5316\uff08Preformatted Code Block\uff09\u3001\u5217\u8868\uff08List\uff09\u3001\u8868\u683c\uff08Table\uff09\u7b49\u533a\u5757\u5143\u7d20\u7684\u4e0a\u4e0b\u5404\u63d2\u5165\u7a7a\u884c\u3002</li> </ol>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u7b26\u53f7punctuation_characters","title":"\u7b26\u53f7\uff08Punctuation Characters\uff09","text":""},{"location":"blog/20151102/1-Markdown-Syntax/#\u8f6c\u4e49\u5b57\u7b26","title":"\u8f6c\u4e49\u5b57\u7b26","text":"<p>Markdown \u7cbe\u6311\u7ec6\u9009\u4e86\u4e00\u4e9b\u7b26\u53f7\u7ec4\u6210\u4e86\u4e00\u5957\u57fa\u4e8e\u6587\u672c\u7684\u6807\u8bb0\u8bed\u6cd5\u3002\u6bd4\u5982\uff1a</p> <ul> <li>\u5728\u6587\u5b57\u4e24\u65c1\u52a0\u4e0a * \u53f7\uff0c\u770b\u8d77\u6765\u5c31\u50cf*\u5f3a\u8c03*\u3002</li> <li>\u591a\u884c\u884c\u9996\u6dfb\u52a0 +\uff08\u6216 - \u6216 *\uff09\uff0c\u770b\u8d77\u6765\u5c31\u662f\u5217\u8868\u3002</li> <li>\u53e5\u6bb5\u884c\u9996\u6dfb\u52a0 &gt; \u53f7\u6765\u5f15\u7528\u533a\u5757\uff0c\u5c31\u50cf\u4f60\u66fe\u5728\u7535\u5b50\u90ae\u4ef6\u4e2d\u89c1\u8fc7\u7684\u90a3\u6837\u3002</li> </ul> <p>\u53ef\u4ee5\u4f7f\u7528\u53cd\u659c\u6760\uff08\\\uff0cbackslash\uff09\u8f6c\u4e49\u8f93\u5165 Markdown \u6807\u8bb0\u7b26\u53f7\u7684\u539f\u4e49\u5b57\u7b26\u3002  </p> <p>#\uff1a\u884c\u9996\u7684 #\uff08\u6b64\u5904\u4f7f\u7528 kbd \u95ed\u5305\u663e\u793a\u6309\u952e\u5b57\u5e55\uff09\u53f7\u9ed8\u8ba4\u4e3aH1\uff0c\u8fd9\u91cc\u4f7f\u7528\u53cd\u659c\u6760\u8f6c\u4e49\u663e\u793a\u539f\u4e49\u5b57\u7b26\u3002  </p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u5b57\u7b26\u5b9e\u4f53","title":"\u5b57\u7b26\u5b9e\u4f53","text":"<p>\u5728 Markdown \u4e2d\uff0c\u7a7a\u683c\u548c tab \u5f80\u5f80\u7528\u4e8e\u683c\u5f0f\u63a7\u5236\uff0c\u4f8b\u5982\uff1a</p> <ul> <li>\u884c\u9996\u63d2\u5165 tab \u6216 \u56db\u4e2a\u7a7a\u683c \u7f29\u8fdb\u8868\u793a <code>&lt;pre&gt;</code> \u9884\u683c\u5f0f\u5316\uff1b</li> <li>\u5f15\u7528\u3001\u5217\u8868\u7684 bullet \u6807\u8bb0\u7b26\u524d\u7684 tab \u6216 \u7a7a\u683c \u7528\u4e8e\u7f29\u8fdb\u5d4c\u5957\u5c42\u7ea7\uff1b</li> <li>...</li> </ul> <p>\u666e\u901a\u6bb5\u843d\u4e00\u822c\u90fd\u662f\u9876\u683c\u5f00\u59cb\uff0c\u65e0\u6cd5\u4f7f\u7528 \u7a7a\u683c \u6216 tab \u6765\u7f29\u8fdb\uff0c\u5305\u62ec\u5f15\u7528\u6807\u8bb0\u7b26\uff08&gt;\uff09\u3001\u5217\u8868\u6807\u8bb0\u7b26\uff08bullet list indicator\uff09\u540e\u9762\u7684\u7a7a\u683c\u90fd\u65e0\u6cd5\u5b9e\u73b0\u7f29\u8fdb\u3002 \u5982\u679c\u786c\u8981\u8f93\u5165\u7a7a\u683c\u663e\u793a\u5360\u4f4d\u7f29\u8fdb\u6548\u679c\uff0c\u53ef\u4ee5\u5d4c\u5165\u7a7a\u683c\u5bf9\u5e94\u7684 HTML Entity \u5b9e\u4f53\u7801\u3002HTML \u8f6c\u4e49\u5b57\u7b26\u4e32\uff08Escape Sequence\uff09\uff0c\u5373\u5b57\u7b26\u5b9e\u4f53\uff08Character Entity\uff09\u3002\u5b57\u7b26\u5b9e\u4f53\u7531\u4e09\u90e8\u5206\u6784\u6210\uff1a</p> <ol> <li>\u7b2c\u4e00\u90e8\u5206\u662f\u4e00\u4e2a <code>&amp;</code> \uff08ampersand\uff09\u7b26\u53f7\uff1b</li> <li>\u7b2c\u4e8c\u90e8\u5206\u662f\u5b9e\u4f53\uff08Entity\uff09\u540d\u5b57\uff1b\u6216\u8005 <code>#</code> \u52a0\u4e0a\u5b9e\u4f53\u7f16\u53f7\uff08Entity Code\uff09\uff1b</li> <li>\u7b2c\u4e09\u90e8\u5206\u662f\u4e00\u4e2a\u5206\u53f7 <code>;</code> \uff08semicolon\uff09\u3002</li> </ol> <p>HTML\u63d0\u4f9b\u4e865\u79cd\u7a7a\u683c\u5b9e\u4f53\uff08space entity\uff09\uff0c\u5b83\u4eec\u62e5\u6709\u4e0d\u540c\u7684\u5bbd\u5ea6\uff0c\u975e\u65ad\u884c\u7a7a\u683c\uff08<code>&amp;nbsp;</code>\uff09\u662f\u5e38\u89c4\u7a7a\u683c\u7684\u5bbd\u5ea6\uff0c\u53ef\u8fd0\u884c\u4e8e\u6240\u6709\u4e3b\u6d41\u6d4f\u89c8\u5668\u3002\u5176\u4ed6\u51e0\u79cd\u7a7a\u683c\uff08 <code>&amp;ensp;</code>\u3001<code>&amp;emsp;</code>\u3001<code>&amp;thinsp;</code>\u3001<code>&amp;zwnj;</code>\u3001<code>&amp;zwj;</code>\uff09\u5728\u4e0d\u540c\u6d4f\u89c8\u5668\u4e2d\u5bbd\u5ea6\u5404\u5f02\u3002</p> entity code full-name width <code>&amp;nbsp;</code> <code>&amp;#160;</code> no-break space \u952e\u76d8\u7a7a\u683c\uff08space bar\uff09 <code>&amp;ensp;</code> <code>&amp;#8194;</code> en space \u534a\u89d2\u7a7a\u683c\uff08half-width\uff09 <code>&amp;emsp;</code> <code>&amp;#8195;</code> em space \u5168\u89d2\u7a7a\u683c\uff08full-width\uff09 <ol> <li>\u5728HTML\u4e2d\uff0c\u4f7f\u7528<code>&amp;nbsp;</code>\u4ea7\u751f\u7684\u7a7a\u683c\u662f\u4e0d\u4f1a\u7d2f\u52a0\u7684\uff08\u53ea\u7b971\u4e2a\uff09\uff1b\u8981\u4f7f\u7528html\u5b9e\u4f53\u8868\u793a\u624d\u53ef\u7d2f\u52a0\u3002  </li> <li><code>&amp;ensp;</code>\u4e2d\u7684en\u662f\u5b57\u4f53\u6392\u5370\u5b66\u7684\u8ba1\u91cf\u5355\u4f4d\uff0c\u4e3aem\u5bbd\u5ea6\u7684\u4e00\u534a\uff0c\u540d\u4e49\u4e0a\u662f\u5c0f\u5199\u5b57\u6bcdn\u7684\u5bbd\u5ea6\u3002\u6b64\u7a7a\u683c\u4f20\u627f\u7a7a\u683c\u5bb6\u65cf\u4e00\u8d2f\u7684\u7279\u6027\uff1a\u900f\u660e\u7684\uff01\u6b64\u7a7a\u683c\u6709\u4e2a\u76f8\u5f53\u7a33\u5065\u7684\u7279\u6027\uff0c\u5c31\u662f\u5176\u5360\u636e\u7684\u5bbd\u5ea6\u6b63\u597d\u662f1/2\u4e2a\u4e2d\u6587\u5bbd\u5ea6\uff0c\u800c\u4e14\u57fa\u672c\u4e0a\u4e0d\u53d7\u5b57\u4f53\u5f71\u54cd\u3002  </li> <li><code>&amp;emsp;</code>\u4e2d\u7684em\u662f\u5b57\u4f53\u6392\u5370\u5b66\u7684\u8ba1\u91cf\u5355\u4f4d\uff0c\u76f8\u5f53\u4e8e\u5f53\u524d\u6307\u5b9a\u7684\u70b9\u6570\u3002\u6b64\u7a7a\u683c\u4e5f\u4f20\u627f\u7a7a\u683c\u5bb6\u65cf\u4e00\u8d2f\u7684\u7279\u6027\uff1a\u900f\u660e\u7684\uff01\u6b64\u7a7a\u683c\u4e5f\u6709\u4e2a\u76f8\u5f53\u7a33\u5065\u7684\u7279\u6027\uff0c\u5c31\u662f\u5176\u5360\u636e\u7684\u5bbd\u5ea6\u6b63\u597d\u662f1\u4e2a\u4e2d\u6587\u5bbd\u5ea6\uff0c\u800c\u4e14\u57fa\u672c\u4e0a\u4e0d\u53d7\u5b57\u4f53\u5f71\u54cd\u3002  </li> </ol> <p>\u666e\u901a\u81ea\u7136\u884c\u884c\u9996\u65722\u4e2a\u7a7a\u683c\u65e0\u5360\u4f4d\u7f29\u8fdb\u6548\u679c\u3002 \u00a0\u00a0\u00a0\u00a0\u8be5\u884c\u884c\u9996\u6dfb\u52a0\u4e864\u4e2a<code>&amp;nbsp;</code>\u3002 \u2002\u2002\u2002\u2002\u8be5\u884c\u884c\u9996\u6dfb\u52a0\u4e864\u4e2a<code>&amp;ensp;</code>\u3002 \u2003\u2003\u2003\u2003\u8be5\u884c\u884c\u9996\u6dfb\u52a0\u4e864\u4e2a<code>&amp;emsp;</code>\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u5206\u9694\u7ebfhorizontal_rules","title":"\u5206\u9694\u7ebf\uff08Horizontal Rules\uff09","text":"<p>\u4f60\u53ef\u4ee5\u5728\u4e00\u884c\u4e2d\u7528\u4e09\u4e2a\u4ee5\u4e0a\u7684\u661f\u53f7\uff08asterisks\uff1a*\uff09\u6216\u51cf\u53f7\uff08hyphens\uff1a-\uff09\u6216\u5e95\u7ebf\uff08underscores\uff1a_\uff09\u6765\u5efa\u7acb\u4e00\u4e2a\u6c34\u5e73\u5206\u9694\u7ebf\uff0c\u5bf9\u5e94 HTML \u4e2d\u7684 <code>&lt;hr&gt;</code> \u6807\u7b7e\uff0c\u7528\u4e8eSentence/Section/Page Break\u3002 \u884c\u5185\u4e0d\u80fd\u6709\u5176\u4ed6\u4e1c\u897f\uff0c\u4f46\u4f60\u53ef\u4ee5\u5728\u661f\u53f7\u6216\u662f\u51cf\u53f7\u4e2d\u95f4\u63d2\u5165\u7a7a\u683c\u3002 \u4e0b\u9762\u6bcf\u79cd\u5199\u6cd5\u90fd\u53ef\u4ee5\u5efa\u7acb\u8d77\u5206\u9694\u7ebf\uff1a</p> <pre><code>    ---\n    - - -\n    -----\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <p>\u91c7\u7528\u51cf\u53f7\uff08-\uff09\u5206\u5272\u65f6\uff0c\u6700\u597d\u7a7a\u683c\u9694\u5f00\u6216\u4e0a\u9762\u7a7a\u4e00\u884c\uff0c\u4e0d\u7136\u4e09\u4e2a\u4ee5\u4e0a\u8fde\u7eed\u7684\u51cf\u53f7\u4f1a\u8bef\u5c06\u4e0a\u4e00\u884c\u6587\u5b57\u5347\u7ea7\u4e3a\u4e8c\u7ea7\u6807\u9898\uff01</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u6587\u672c\u683c\u5f0ftext_styling","title":"\u6587\u672c\u683c\u5f0f\uff08Text Styling\uff09","text":"<p>\u6587\u672c\u683c\u5f0f\u5305\u62ec\u5f3a\u8c03\u3001\u52a0\u7c97\u3001\u7a81\u51fa\u3001\u4e0b\u5212\u7ebf\u3001\u5220\u9664\u7ebf\u3001\u811a\u6807\u7b49\u589e\u5f3a\u4fee\u9970\u548c\u4e30\u5bcc\u8868\u73b0\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u5f3a\u8c03italicemphasize","title":"\u5f3a\u8c03\uff08Italic/Emphasize\uff09","text":"<p>\u8bf4\u660e\uff1a \u661f\u53f7\uff08*\uff09\u6216\u4e0b\u5212\u7ebf\uff08_\uff09\u5305\u56f4\u7684\u6587\u5b57\u5c06\u4f1a\u663e\u793a\u659c\u4f53\uff0c\u5bf9\u5e94 HTML \u4e2d\u7684 <code>&lt;i&gt;</code> / <code>&lt;em&gt;</code> \u6807\u7b7e\u3002</p> <p>\u8bed\u6cd5\uff1a</p> <pre><code>Some of these words *are emphasized*.\nSome of these words _are emphasized also_.\n</code></pre> <p>\u793a\u4f8b\uff1a Some of these words are emphasized. Some of these words are emphasized also.</p> <p>GFM\uff08Github Flavored Markdown\uff09\u5efa\u8bae\uff1a</p> <p>\u9274\u4e8eC\u8bed\u8a00\u7b49\u6e90\u7801\u4e2d\uff0c\u901a\u5e38\u91c7\u7528\u4e0b\u5212\u7ebf\u5b9a\u4e49\u53d8\u91cf\uff0c\u56e0\u6b64 GFM \u5ffd\u7565\u5355\u8bcd\u5185\u7684\u4e0b\u5212\u7ebf\uff0c\u540c\u65f6\u5efa\u8bae\u4f7f\u7528\u661f\u53f7\uff08*\uff09\u6765\u5305\u88f9\u659c\u4f53\u3002</p> <p>\u4e0b\u5212\u7ebf\u95ed\u5305\u5355\u8bcd\u659c\u4f53\uff1awow great stuff (\u6e90\u7801\uff1a<code>wow _great_ stuff</code>) GFM \u5ffd\u7565\u5355\u8bcd\u5185\u7684\u4e0b\u5212\u7ebf\uff1awow_great_stuff</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u52a0\u7c97boldstrong","title":"\u52a0\u7c97\uff08Bold/Strong\uff09","text":"<p>\u8bf4\u660e\uff1a \u4e24\u4e2a\u661f\u53f7\uff08**\uff09\u6216\u4e0b\u5212\u7ebf\uff08__\uff09\u5305\u56f4\u7684\u9700\u8981\u7279\u522b\u5f3a\u8c03\u7684\u6587\u5b57\u5c06\u4f1a\u52a0\u7c97\u663e\u793a\uff0c\u5bf9\u5e94 HTML \u4e2d\u7684 <code>&lt;b&gt;</code> / <code>&lt;strong&gt;</code> \u6807\u7b7e\u3002</p> <p>\u8bed\u6cd5\uff1a</p> <pre><code>Use two asterisks for **strong emphasis**.\nOr, if you prefer, __use two underscores instead__.\nA ***section surrounded with three asterisks*** will be  specially emphasized.\n</code></pre> <p>\u793a\u4f8b\uff1a Use two asterisks for strong emphasis. Or, if you prefer, use two underscores instead. A section surrounded with three asterisks will be  specially emphasized.</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u7a81\u51famarkhighlight","title":"\u7a81\u51fa\uff08Mark/Highlight\uff09","text":"<p>\u8bf4\u660e\uff1a \u5728 HTML \u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>&lt;mark&gt;</code> \u6807\u7b7e\u6765\u9ad8\u4eae\u663e\u793a\u6587\u5b57\uff0c\u4ee5\u8fbe\u5230\u9192\u76ee\u7684\u76ee\u7684\u3002 \u6807\u51c6 markdown \u6ca1\u6709\u63d0\u4f9b\u5bf9\u5e94\u7684\u6807\u7b7e\u652f\u6301\uff0cMacdown \u548c Haroopad \u5747\u4f7f\u7528\u4e24\u4e2a\u7b49\u53f7\uff08equal signs\uff1a=\uff09\u5305\u56f4\u6765\u7a81\u51fa\u9ad8\u4eae\u663e\u793a\u3002</p> <p>\u8bed\u6cd5\uff1a Macdown \u548c Haroopad\uff1a<code>==Highlight==</code> CriticMarkup\u8bed\u6cd5\uff1a<code>Highlight</code></p> <p>\u793a\u4f8b\uff1a Macdown \u548c Haroopad\uff1aHighlight</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u4e0b\u5212\u7ebfunderline","title":"\u4e0b\u5212\u7ebf\uff08Underline\uff09","text":"<p>\u8bf4\u660e\uff1a \u5728 HTML \u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>&lt;u&gt;</code> \u6807\u7b7e\u6765\u4e3a\u6587\u672c\u6dfb\u52a0\u4e0b\u5212\u7ebf\u3002 \u6807\u51c6 markdown \u6ca1\u6709\u63d0\u4f9b\u5bf9\u5e94\u7684\u6807\u7b7e\u652f\u6301\uff0cMMD\uff08MultiMarkdown\uff09\u63d0\u4f9b\u4e86\u6269\u5c55\u652f\u6301\u3002 Macdown \u4f7f\u7528\u661f\u53f7\u8868\u793a\u5f3a\u8c03\uff0c\u4f7f\u7528\u4e0b\u5212\u7ebf\u8868\u793a\u4e0b\u5212\u7ebf\u539f\u4e49\uff1bHaroopad \u5219\u4f7f\u7528\u4e24\u4e2a\u52a0\u53f7\uff08plus sign\uff1a+\uff09\u6765\u6807\u8bb0\u4e0b\u5212\u7ebf\u3002</p> <p>\u8bed\u6cd5\uff1a Macdown\uff1a<code>_underline_</code> Haroopad\uff1a<code>++underline++</code></p> <p>\u793a\u4f8b\uff1a Macdown\uff1aunderline Haroopad\uff1a++underline++</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u5220\u9664\u7ebfstrikethrough","title":"\u5220\u9664\u7ebf\uff08Strikethrough\uff09","text":"<p>\u8bf4\u660e\uff1a \u5728 HTML \u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>&lt;del&gt;</code> \u6807\u7b7e\u6765\u5b9a\u4e49\u6587\u6863\u4e2d\u5df2\u88ab\u5220\u9664\u7684\u6587\u672c\uff08\u914d\u5408 <code>&lt;ins&gt;</code> \u6807\u7b7e\u6765\u63cf\u8ff0\u6587\u6863\u4e2d\u7684\u66f4\u65b0\u548c\u4fee\u6b63\uff09\u3002 \u6807\u51c6 markdown \u6ca1\u6709\u63d0\u4f9b\u5bf9\u5e94\u7684\u6807\u7b7e\u652f\u6301\uff0cGFM \u63d0\u4f9b\u4e86\u6269\u5c55\u652f\u6301\uff0c\u4f7f\u7528\u4e24\u4e2a\u6ce2\u6d6a\u7b26\u53f7\uff08two wavy line:~~\uff09\u5305\u56f4\u6765\u7ed9\u6587\u672c\u6dfb\u52a0\u5220\u9664\u7ebf\u3002</p> <p>\u8bed\u6cd5\uff1a</p> <pre><code>~~Strikethrough~~\n</code></pre> <p>\u793a\u4f8b\uff1a Strikethrough</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u811a\u6807script","title":"\u811a\u6807\uff08Script\uff09","text":"<p>\u6807\u51c6 Markdown \u4e0d\u652f\u6301\u811a\u6807\uff0c\u53ea\u80fd\u901a\u8fc7\u5185\u5d4c HTML \u7684<code>&lt;sup&gt;</code>\u548c<code>&lt;sub&gt;</code>\u6807\u7b7e\u6765\u5b9e\u73b0\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u4e0a\u811a\u6807","title":"\u4e0a\u811a\u6807\uff1a","text":"<p>Haroopad \u8bed\u6cd5\uff08Caret\uff09\uff1a<code>^Superscript^</code> HTML \u8bed\u6cd5\uff1a<code>&lt;sup&gt;superscript&lt;/sup&gt;</code></p> <p>\u793a\u4f8b\uff1a <code>2^10^</code> = 2<sup>10</sup> = 1024;</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u4e0b\u811a\u6807","title":"\u4e0b\u811a\u6807\uff1a","text":"<p>Haroopad \u8bed\u6cd5\uff1a<code>~Subscript~</code> HTML \u8bed\u6cd5\uff1a<code>&lt;sub&gt;subscript&lt;/sub&gt;</code></p> <p>\u793a\u4f8b\uff1a <code>H~2~O</code> = H<sub>2</sub>O is a liquid.</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u94fe\u63a5hyperlink","title":"\u94fe\u63a5\uff08Hyperlink\uff09","text":""},{"location":"blog/20151102/1-Markdown-Syntax/#\u81ea\u52a8\u94fe\u63a5autolink","title":"\u81ea\u52a8\u94fe\u63a5\uff08Autolink\uff09","text":"<p>\u5f53\u6211\u4eec\u5728\u4e66\u5199\u4e00\u4e2a\u7f51\u5740\u65f6\uff0c\u6709\u4e9b Markdown Render \u80fd\u81ea\u52a8\u751f\u6210\u6807\u9898\uff08title\uff09\u4e0e\u7f51\u5740\uff08href URL\uff09\u4e00\u81f4\u7684\u94fe\u63a5\uff0c\u8fd9\u79cd\u94fe\u63a5\u4e5f\u5373\u81ea\u52a8\u94fe\u63a5\u3002 Markdown \u652f\u6301\u4ee5\u6bd4\u8f83\u7b80\u77ed\u7684\u81ea\u52a8\u94fe\u63a5\u5f62\u5f0f\u6765\u5904\u7406\u7f51\u5740\u548c\u7535\u5b50\u90ae\u4ef6\u4fe1\u7bb1\uff0c\u53ea\u8981\u7528\u5c16\u62ec\u53f7\u5305\u8d77\u6765\u7684\u6587\u5b57\uff0c Markdown \u5c31\u4f1a\u81ea\u52a8\u8bc6\u522b\u8f6c\u5316\u6210\u94fe\u63a5\u3002 \u5bf9\u4e8e HTTP(s) \u534f\u8bae\u5f00\u5934\u7684\u8d85\u94fe\u63a5\u5730\u5740\uff0c\u751a\u81f3\u65e0\u9700\u6dfb\u52a0\u5c16\u62ec\u53f7\u660e\u793a\uff0c\u4e5f\u4f1a\u751f\u6210\u81ea\u52a8\u94fe\u63a5\u3002  </p> <p>http://daringfireball.net/projects/markdown/</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u6587\u5b57text_href","title":"\u6587\u5b57\uff08text href\uff09","text":"<p>Markdown \u652f\u6301\u4e24\u79cd\u5f62\u5f0f\u7684\u8d85\u6587\u672c\u94fe\u63a5\u8bed\u6cd5\u683c\u5f0f\uff1a \u884c\u5185\u5f0f\uff08Inline\uff09\u548c\u53c2\u8003\u5f0f\uff08Reference\uff09\u4e24\u79cd\u5f62\u5f0f\u3002 \u4e0d\u7ba1\u662f\u54ea\u4e00\u79cd\uff0c\u94fe\u63a5\u6587\u5b57\u90fd\u662f\u7528\u65b9\u62ec\u53f7\uff08square brackets\uff1a[]\uff09\u6765\u6807\u8bb0\u3002  </p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u884c\u5185\u5f0finline","title":"\u884c\u5185\u5f0f\uff08Inline\uff09","text":"<p>\u53ea\u8981\u5728\u65b9\u5757\u62ec\u53f7\u540e\u9762\u7d27\u63a5\u7740\u5706\u62ec\u53f7\uff08parenthesis or round brackets\uff09\u5e76\u63d2\u5165\u94fe\u63a5\u7f51\u5740\u5373\u53ef\u5728\u4e00\u884c\u5185\u6784\u5efa\u94fe\u63a5\uff0c\u5176\u8bed\u6cd5\u683c\u5f0f\u4e3a<code>[text](url)</code>\uff0cHTML \u7b49\u6548\u6e90\u7801\u4e3a <code>&lt;a href=\"url\"&gt;text&lt;/a&gt;</code>\u3002 \u5982\u679c\u662f\u8981\u94fe\u63a5\u5230\u672c\u673a\u8d44\u6e90\uff0c\u53ef\u4ee5\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\uff08./path/to/your/resource\uff09\u3002</p> <p>\u4ee5\u4e0b\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6307\u5411 Daring Fireball Markdown \u9996\u9875\u7684\u8d85\u94fe\u63a5\uff1a</p> <p><code>[Daring Fireball Markdown](http://daringfireball.net/projects/markdown/)</code> Daring Fireball Markdown</p> <p>\u5982\u679c\u4f60\u8fd8\u60f3\u8981\u52a0\u4e0a\u94fe\u63a5\u7684 title \uff0c\u53ea\u8981\u5728\u7f51\u5740\u540e\u9762\u7528\u53cc\u5f15\u53f7\u628a title \u6587\u5b57\u5305\u8d77\u6765\u5373\u53ef\u3002</p> <p><code>[Daring Fireball Markdown](http://daringfireball.net/projects/markdown/ \"Markdown Official Website\")</code> Daring Fireball Markdown</p> <p>\u5f53\u9f20\u6807\u60ac\u505c\u5728\u8d85\u94fe\u63a5\u6587\u672c\u4e0a\u65f6\uff0c\u5c06\u4f1a\u63d0\u793a \u201cMarkdown Official Website\u201d\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u53c2\u8003\u5f0freference","title":"\u53c2\u8003\u5f0f\uff08Reference\uff09","text":"<p>\u53c2\u8003\u5f0f\u7684\u94fe\u63a5\u662f\u5728\u94fe\u63a5\u6587\u5b57\u7684\u62ec\u53f7\u540e\u9762\u518d\u63a5\u4e0a\u53e6\u4e00\u4e2a\u65b9\u62ec\u53f7\uff0c\u5728\u7b2c\u4e8c\u4e2a\u65b9\u62ec\u53f7\u91cc\u9762\u586b\u5165\u7528\u4ee5\u8fa8\u8bc6\u94fe\u63a5\u7684\u6807\u8bb0id\uff0c\u7136\u540e\u5728\u5176\u4ed6\u5730\u65b9\u7ed9\u51fa\u8be5\u6807\u8bb0id\u771f\u6b63\u7684\u94fe\u63a5\u5730\u5740\u3002</p> <ol> <li>\u5148\u5b9a\u4e49\u53c2\u8003refid\uff1a<code>[text][refid]</code> </li> <li>\u518d\u5b9a\u4e49refid\u6240\u6307\uff1a<code>[refid]:URL</code></li> </ol> <p>\u4ee5\u4e0b\u53c2\u8003\u95f4\u63a5\u5b9a\u4e49\u6307\u5411 Daring Fireball Markdown \u9996\u9875\u7684\u8d85\u94fe\u63a5\uff1a</p> <ol> <li>\u5148\u5b9a\u4e49\u53c2\u8003id\u4e3amarkdown_homepage_refid\uff1a <code>[Daring Fireball Markdown][markdown_homepage_refid]</code> </li> <li>\u518d\u5728\u5176\u4ed6\u5730\u65b9\u5b9a\u4e49markdown_homepage_refid\u6307\u5411\u7684URL\uff1a <code>[markdown_homepage_refid]:http://daringfireball.net/projects/markdown/</code> </li> <li>\u6700\u7ec8\u6548\u679c\u540c\u884c\u5185\u5f0f\uff1a Daring Fireball Markdown </li> </ol> <p>\u8bf4\u660e\uff1a</p> <ol> <li>\u4e5f\u53ef\u9009\u62e9\u6027\u5730\u5728\u4e24\u4e2a\u65b9\u62ec\u53f7\u4e2d\u95f4\u52a0\u4e0a\u4e00\u4e2a\u7a7a\u683c\uff1a<code>[text] [refid]</code>\u3002\u7531\u4e8e Markdown \u4e0d\u652f\u6301\u81ea\u7136\u6362\u884c\uff0c\u5c06\u4e24\u4e2a\u65b9\u62ec\u53f7\u5728\u8fde\u7eed\u4e24\u884c\u4e66\u5199\u4e5f\u662f\u6ca1\u95ee\u9898\u7684\u3002\u4e2d\u95f4\u7528\u7a7a\u884c\u9694\u5f00\uff0c\u5219\u88ab\u8ba4\u4e3a\u662f\u4e24\u6761\u7cbe\u7b80\u683c\u5f0f\u7684\u53c2\u8003\u94fe\u63a5\u3002  </li> <li>refid \u53ef\u4ee5\u4e0e text \u4e00\u81f4\uff0c\u4ece\u800c\u8fdb\u4e00\u6b65\u7cbe\u7b80\u53c2\u8003\u94fe\u63a5\u7684\u4e66\u5199\u683c\u5f0f\uff1a    <ul> <li>\u6b64\u65f6 <code>[refid]</code> \u4e2d\u7684 refid \u53ef\u4ee5\u7701\u7565\u7f6e\u7a7a\u4e3a <code>[]</code> \uff1a\u5148\u5b9a\u4e49 <code>[text][]</code> \uff0c\u518d\u5b9a\u4e49 <code>[text]:URL</code> \u3002</li> <li>\u4f60\u751a\u81f3\u53ef\u4ee5\u5c06 <code>[text][]</code> \u4e2d\u7684\u7a7a\u4e2d\u62ec\u53f7\u4e5f\u7701\u6389\u4e0d\u5199\uff0c\u8fdb\u4e00\u6b65\u7b80\u5199\u4e3a <code>[text]</code> \uff0c\u540e\u9762\u518d\u5b9a\u4e49 <code>[text]:URL</code> \u3002  </li> </ul> </li> <li>refid \u6240\u6307 href URL \u5728\u6587\u4ef6\u4efb\u610f\u5904\u7ed9\u51fa\u5b9a\u4e49\u5373\u53ef\u3002<code>[refid]:URL</code> \u7684 URL \u540e\u9762\u53ef\u4ee5\u9009\u62e9\u6027\u5730\u7528\u5355\u5f15\u53f7\u3001\u53cc\u5f15\u53f7\u6216\u662f\u62ec\u5f27\u95ed\u5305\u8d77\u6765\u6807\u8bb0 title\u3002     \u4e0b\u9762\u8fd9\u4e09\u79cd\u94fe\u63a5\u7684\u5b9a\u4e49\u90fd\u662f\u76f8\u540c\u7684\uff1a <code>[foo]: http://example.com/  \"Optional Title Here\"</code> <code>[foo]: http://example.com/  'Optional Title Here'</code> <code>[foo]: http://example.com/  (Optional Title Here)</code></li> </ol>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u56fe\u7247image_href","title":"\u56fe\u7247\uff08image href\uff09","text":""},{"location":"blog/20151102/1-Markdown-Syntax/#\u63d2\u5165\u56fe\u7247","title":"\u63d2\u5165\u56fe\u7247","text":"<p>Markdown \u4f7f\u7528\u4e00\u79cd\u548c\u6587\u672c\u94fe\u63a5\u5f88\u76f8\u4f3c\u7684\u8bed\u6cd5\u6765\u63d2\u5165\u56fe\u7247\uff0c\u540c\u6837\u4e5f\u5141\u8bb8\u4e24\u79cd\u6837\u5f0f\uff1a \u884c\u5185\u5f0f\u548c\u53c2\u8003\u5f0f\u3002 \u4e0d\u540c\u7684\u662f\uff0c\u9700\u8981\u5728\u94fe\u63a5\u6587\u5b57\u65b9\u62ec\u53f7\u4e4b\u524d\u6dfb\u52a0\u4e00\u4e2a\u611f\u53f9\u53f7\uff08exclamation mark\uff1a!\uff09\uff0c\u5176\u8bed\u6cd5\u683c\u5f0f\u4e3a <code>![alt_text](url)</code>\uff0cHTML \u7b49\u6548\u6e90\u7801\u4e3a <code>&lt;img src=\"url\" alt=\"text\" /&gt;</code>\uff0c\u5176\u4e2dalt_text\u53ef\u4ee5\u7f6e\u7a7a\u3002  </p> <p>daringfirefall logo: <code>![daringfirefall](http://daringfireball.net/graphics/logos/)</code> </p> <p>\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u50cf\u6587\u5b57\u94fe\u63a5\u90a3\u6837\u6dfb\u52a0 title \u4ee5\u4f9b\u9f20\u6807\u60ac\u505c\u63d0\u793a\u3002</p> <p>\u8bf4\u660e\uff1a Markdown \u4e2d\u7684\u6bb5\u843d\uff08\u5305\u62ec\u56fe\u7247\uff09\u9ed8\u8ba4\u9876\u683c\u5de6\u5bf9\u9f50\uff0c\u82e5\u8981\u5c06\u56fe\u7247\u5c45\u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u5185\u5d4c HTML \u7684 <code>&lt;img&gt;</code> \u6807\u7b7e\uff0c\u8bbe\u7f6e<code>align=\"middle\"</code>\u3002\u5982\u679c\u8fd8\u4e0d\u884c\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5c01\u88f9\u4e00\u5c42 div \u8bbe\u7f6e <code>style=\"text-align:center\"</code> \u5b9e\u73b0\uff1a</p> <pre><code>&lt;div style=\"text-align:center\"&gt;&lt;img src=\"http://pad.haroopress.com/assets/images/logo-small.png\" align=\"middle\"  alt=\"\u7a0b\u5e8f\u733f-\u5f26\u82e6\" /&gt;&lt;/div&gt;\n</code></pre>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u56fe\u7247\u94fe\u63a5","title":"\u56fe\u7247\u94fe\u63a5","text":"<p>\u5982\u679c\u62f7\u8d1d\u4e86\u522b\u4eba\u7684\u56fe\u7247\u63d2\u5165\u5230\u81ea\u5df1\u7684\u535a\u5ba2\u4e2d\uff0c\u6700\u597d\u5728\u56fe\u7247\u4e0a\u7ed9\u51fa\u4e00\u4e2a\u8d85\u94fe\u63a5\u6307\u5411\u6e90\u5934\uff0c\u65b9\u4fbf\u8ffd\u6eaf\u51fa\u5904\u3002 \u6211\u4eec\u5728 Markdown \u56fe\u7247\u6807\u8bb0<code>![]()</code>\u5916\u9762\u518d\u5d4c\u5957\u4e00\u5c42<code>[]()</code>\u5373\u53ef\u5efa\u7acb\u56fe\u7247\u8d85\u94fe\u63a5\uff0c\u70b9\u51fb\u56fe\u7247\u5373\u53ef\u8df3\u8f6c\u5230\u94fe\u63a5\u6e90\u5730\u5740\u3002 \u56fe\u7247\u94fe\u63a5\u7684\u683c\u5f0f\u770b\u8d77\u6765\u5927\u6982\u662f\u8fd9\u6837\u7684: <code>[![](img_url)](ref_url)</code></p> <p>\u5b9a\u4e49 haroopad logo \u6307\u5411\u9996\u9875\uff1a <code>[![](http://pad.haroopress.com/assets/images/logo-small.png \"haroopad\")](http://pad.haroopress.com/)</code></p> <p></p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u951a\u70b9inner_link","title":"\u951a\u70b9\uff08inner link\uff09","text":""},{"location":"blog/20151102/1-Markdown-Syntax/#\u4e66\u7b7ebookmark","title":"\u4e66\u7b7e\uff08Bookmark\uff09","text":"<p>HTML \u4e2d\u7684 <code>&lt;a&gt;</code> \u6807\u7b7e\u6700\u91cd\u8981\u7684\u5c5e\u6027\u662f href \uff0c\u5b83\u6307\u793a\u7684\u94fe\u63a5\u76ee\u6807\uff0c\u65e2\u53ef\u4ee5\u662f\u5916\u90e8\u7ad9\u70b9\uff0c\u4e5f\u53ef\u4ee5\u662f\u9875\u5185\u951a\u70b9\u3002\u9875\u5185\u951a\u70b9\u53ef\u4ee5\u5b9e\u73b0\u7c7b\u4f3c\u4e66\u7b7e\u8df3\u8f6c\u7684\u529f\u80fd\uff0c\u6700\u5178\u578b\u7684\u5c31\u662f\u70b9\u51fb TOC \u4e2d\u7684\u76ee\u5f55\u4e66\u7b7e\u8df3\u8f6c\u5230\u6307\u5b9a\u7ae0\u8282\u9605\u8bfb\u3002 \u6784\u5efa\u9875\u5185\u951a\u70b9\u7684\u8bed\u6cd5\uff0c\u7c7b\u4f3c\u53c2\u8003\u5f0f\u94fe\u63a5\uff1a</p> <ol> <li>\u5148\u5b9a\u4e49\u951a\u70b9id\uff1a<code>&lt;a href=\"#auchor_id\"&gt;bookmark_text&lt;/a&gt;</code> </li> <li>\u518d\u5b9a\u4e49\u4e00\u4e2aid\u4e3aauchor_id\u7684\u5bf9\u8c61\uff08\u8fd9\u91cc\u4ee5<code>&lt;p&gt;</code>\u4e3a\u4f8b\uff09\uff1a<code>&lt;p id=\"auchor_id\"&gt;auchor_text&lt;/p&gt;</code></li> </ol> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u5728\u6587\u672b\u5b9a\u4e49\u4e86id\u4e3aend\u7684 EOF\uff08End Of File\uff09\uff1a<code>&lt;p id=\"end\"&gt;The end\uff01&lt;/p&gt;</code>\uff0c\u7136\u540e\u901a\u8fc7<code>&lt;a href=\"#end\"&gt;Goto the End!&lt;/a&gt;</code>\u6307\u5b9a\u4e66\u7b7e\u201cGoto the End!\u201d\u8df3\u8f6c\u5230\u6587\u672b\u201cThe End!\u201d\u5904\uff1a</p> <p>Goto the End!</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u811a\u6ce8footnote","title":"\u811a\u6ce8\uff08Footnote\uff09","text":"<p>\u4e0a\u9762\u6211\u4eec\u5b9a\u4e49\u4e86\u4e66\u7b7e <code>Goto the End!</code> \uff0c\u70b9\u51fb\u8be5\u4e66\u7b7e\u5c06\u8df3\u8f6c\u5230\u6587\u672b id \u4e3a <code>#end</code> \u7684\u951a\u70b9\uff0c\u4f7f\u5f97\u6211\u4eec\u80fd\u5feb\u901f\u7ffb\u5230\u6587\u672b\u3002\u90a3\u600e\u4e48\u518d\u8df3\u8f6c\u56de\u521a\u624d\u4e66\u7b7e\u6240\u5728\u7684\u9605\u8bfb\u70b9\u5462\uff1f\u4e0b\u9762\u6765\u4ecb\u7ecd\u4e00\u4e0b\u5177\u5907\u56de\u73af\u8df3\u8f6c\u6548\u679c\u7684\u811a\u6ce8\u3002</p> <p>\u811a\u6ce8\u7528\u4e8e\u4e3a\u6b63\u6587\u4e2d\u7684\u67d0\u4e2a\u6761\u76ee\u6dfb\u52a0\u8865\u5145\u6ce8\u91ca\uff0c\u5bf9\u8bcd\u6761\u7684\u5f15\u6587\u51fa\u5904\u8fdb\u884c\u6807\u6ce8\u6216\u5bf9\u4e13\u4e1a\u672f\u8bed\u4e88\u4ee5\u89e3\u91ca\uff0c\u8ddf\u53c2\u8003\u6587\u732e\u4e00\u6837\u3002\u811a\u6ce8\u4e00\u822c\u4f4d\u4e8e\u6587\u6863\u7684\u672b\u5c3e\uff0c\u6587\u5185\u5219\u4ee5\u6570\u5b57\u6807\u6ce8\u3002</p> <p>\u811a\u6ce8\u7684\u5199\u6cd5\u548c\u6781\u7b80\u53c2\u8003\u5f0f\u94fe\u63a5\u4e66\u5199\u683c\u5f0f\u6bd4\u8f83\u7c7b\u4f3c\uff1a</p> <ol> <li>\u5148\u5728\u9700\u8981\u811a\u6ce8\u7684\u5355\u8bcd\uff08terminology\uff09\u540e\u9762\u6dfb\u52a0 <code>[^Footnote]</code> \uff1a <code>terminology[^Footnote]</code></li> <li>\u518d\u5728\u6587\u672b glossary \u533a\u57df\u5b9a\u4e49\u811a\u6ce8\uff08\u6dfb\u52a0\u6ce8\u89e3\uff09\uff1a <code>[^Footnote]\uff1aexplanatory notes</code></li> </ol> <p>\u4ee5\u4e0b\u662f\u672c\u6587\u9488\u5bf9\u7b2c\u4e8c\u7ae0\u6807\u9898 \u201c\u6807\u9898\uff08Header\uff09\u201d\u7684\u7740\u8272\u6dfb\u52a0\u7684\u811a\u6ce8\uff1a</p> <pre><code>## &lt;font color='red'&gt;\u6807\u9898\uff08Header\uff09&lt;/font&gt;[^Header]\n\n[^Header]:\u8fd9\u91cc\u7684\u6e90\u7801\u4e3a`&lt;font color='red'&gt;\u6807\u9898\uff08Header\uff09&lt;/font&gt;`\uff0c\u5c1d\u8bd5\u4f7f\u7528 font.color \u7740\u8272\u3002\n</code></pre> <p>\u8bf4\u660e\uff1a</p> <ol> <li>\u88ab\u6dfb\u52a0\u811a\u6ce8\u7684\u8bcd\u6761\u540e\u9762\u4f1a\u51fa\u73b0\u4e00\u4e2a\u8d85\u94fe\u63a5\u6570\u5b57\uff08\u6709\u7684\u6e32\u67d3\u4e3a\u4e0a\u6807\u683c\u5f0f\uff09\uff0c\u70b9\u51fb\u6570\u5b57\u8df3\u8f6c\u5230\u6587\u672b glossary \u533a\u57df\u8be5\u811a\u6ce8\u7684\u5b9a\u4e49\u5904\u3002  </li> <li>\u6587\u672b glossary \u533a\u57df\u8be5\u811a\u6ce8\u5b9a\u4e49\u7684\u884c\u5c3e\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u56de\u8f66\u7b26\u53f7\uff08\u21b5\uff09\uff0c\u70b9\u51fb\u53ef\u56de\u5230\u88ab\u6807\u6ce8\u7684\u811a\u6ce8\u70b9\u3002</li> </ol>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u5f15\u7528blockquote","title":"\u5f15\u7528\uff08Blockquote\uff09","text":"<p>HTML \u4e2d\u7684 <code>&lt;blockquote&gt;</code> \u6807\u7b7e\u5b9a\u4e49\u6458\u81ea\u53e6\u4e00\u4e2a\u6e90\u7684\u5757\u5f15\u7528\u3002 <code>&lt;blockquote&gt;</code> \u4e0e <code>&lt;/blockquote&gt;</code> \u4e4b\u95f4\u7684\u6240\u6709\u6587\u672c\u90fd\u4f1a\u4ece\u5e38\u89c4\u6587\u672c\u4e2d\u5206\u79bb\u51fa\u6765\uff0c\u7ecf\u5e38\u4f1a\u5728\u5de6\u53f3\u4e24\u8fb9\u8fdb\u884c\u7f29\u8fdb\uff0c\u800c\u4e14\u6709\u65f6\u4f1a\u4f7f\u7528\u659c\u4f53\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5757\u5f15\u7528\u62e5\u6709\u5b83\u4eec\u81ea\u5df1\u7684\u7a7a\u95f4\u3002\u672c\u6587\u5927\u91cf\u4f7f\u7528\u5f15\u7528\uff08\u590d\u5408\u5217\u8868\uff09\u6765\u6807\u8bc6\u7279\u6b8a\u8bf4\u660e\u6216\u6ce8\u610f\u4e8b\u9879\u3002</p> <p>Markdown \u6807\u8bb0\u533a\u5757\u5f15\u7528\u662f\u4f7f\u7528\u7c7b\u4f3c email \u7684\u5f15\u7528\u65b9\u5f0f\uff0c\u5728\u65ad\u597d\u7684\u884c\u524d\u52a0\u4e0a <code>&gt;</code> \uff08more than or greater than sign\uff09\uff1a</p> <pre><code>&gt; \u7231\u4e0a\u4e00\u4e2a\u4eba  \n&gt; \u604b\u4e0a\u4e00\u5ea7\u57ce\n</code></pre> <p>\u7231\u4e0a\u4e00\u4e2a\u4eba \u604b\u4e0a\u4e00\u5ea7\u57ce</p> <p>\u884c\u9996\u7684\u591a\u91cd\u5f15\u7528\u6807\u8bb0\u53ef\u4ee5\u5b9e\u73b0\u5d4c\u5957\u7f29\u8fdb\u6548\u679c\uff08\u6ce8\u610f\u89e3\u68a6\u65f6\u9700\u8981\u7a7a\u884c\u51fa\u68a6\uff09\uff1a</p> <pre><code>&gt; \u68a6\n&gt;&gt; \u68a6\u4e2d\u68a6\n&gt;&gt;&gt; \u76d7\u68a6\u7a7a\u95f4\n&gt;\n&gt;&gt; \u68a6\u4e2d\u68a6\n\n&gt; \u68a6\n</code></pre> <p>\u68a6</p> <p>\u68a6\u4e2d\u68a6</p> <p>\u76d7\u68a6\u7a7a\u95f4</p> <p>\u68a6\u4e2d\u68a6</p> <p>\u68a6</p> <p>\u8bf4\u660e\uff1a</p> <ol> <li>\u82e5\u4f7f\u7528\u5f15\u7528\u683c\u5f0f\u63d2\u5165\u4ee3\u7801\uff0c\u884c\u9996\u7684\u7f29\u8fdb\u683c\u5f0f\u4e22\u5931\uff0c\u9700\u8981\u81ea\u884c\u8865\u5145\u7a7a\u683c\u5360\u4f4d\u7b26\u3002  </li> <li>\u4e00\u822c\u4e0d\u5efa\u8bae\u4f7f\u7528 blockquote\uff08<code>&gt;</code>\uff09\u683c\u5f0f\u5f15\u7528\u6e90\u4ee3\u7801\uff0c\u5e94\u91c7\u7528 pre \u683c\u5f0f\u5f15\u7528\u4ee3\u7801\u3002  </li> <li>\u5d4c\u5957\u6df1\u5165\u6d45\u51fa\u65f6\uff0c\u9700\u8981\u6dfb\u52a0\u7a7a\u884c\uff08blank line\uff09\u6216\u8005\u7a7a\u5f15\u7528\u884c\uff08additional levels of &gt;\uff09\u3002</li> </ol>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u4ee3\u7801code","title":"\u4ee3\u7801\uff08Code\uff09","text":"<p>\u5982\u679c\u8981\u6807\u8bb0\u884c\u5185\u4ee3\u7801\u7247\u6bb5\uff0c\u53ef\u4ee5\u7528\u53cd\u5f15\u53f7\uff08backtick quotes\uff09\u95ed\u5305\uff1b\u5982\u679c\u8981\u63d2\u5165\u8de8\u884c\u7247\u6bb5\u6216\u5757\uff0c\u53ef\u4f7f\u7528\u9884\u683c\u5f0f\u5316\u8bed\u6cd5\u3002 \u672c\u6587\u5728\u793a\u8303 Markdown \u8bed\u6cd5\u6e90\u7801\u65f6\uff0c\u72ec\u884c\u5355\u53e5\u91c7\u7528\u4e86\u884c\u5185\u4ee3\u7801\u683c\u5f0f\uff0c\u8de8\u884c\u4ee3\u7801\u7247\u6bb5\u5219\u91c7\u7528\u4e86\u4ee3\u7801\u5757\u683c\u5f0f\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u884c\u5185\u4ee3\u7801inline_code","title":"\u884c\u5185\u4ee3\u7801\uff08Inline Code\uff09","text":"<p>\u8bf4\u660e\uff1a</p> <p>\u5982\u679c\u8981\u6807\u8bb0\u884c\u5185\u4ee3\u7801\u7247\u6bb5\uff0c\u53ef\u4ee5\u7528\u53cd\u5f15\u53f7\uff08backtick quotes\uff09\u5305\u88f9\uff0c\u5bf9\u5e94 HTML \u4e2d\u7684 <code>&lt;code&gt;</code> \u6807\u7b7e\uff08\u628a\u6587\u672c\u53d8\u6210\u7b49\u5bbd\u5b57\u4f53\uff0c\u6697\u793a\u662f\u6e90\u7a0b\u5e8f\u4ee3\u7801\uff09\u3002 \u5982\u679c\u8981\u5728\u4ee3\u7801\u533a\u6bb5\u5185\u63d2\u5165\u53cd\u5f15\u53f7\uff0c\u53ef\u4ee5\u7528\u591a\u4e2a\u53cd\u5f15\u53f7\u6765\u5f00\u542f\u548c\u7ed3\u675f\u4ee3\u7801\u533a\u6bb5\u3002  </p> <p>\u8bed\u6cd5\uff1a</p> <p>Use the `printf()` function.(\u6b64\u5904\u4f7f\u7528\u4e86\u53cd\u659c\u6760\u8f6c\u4e49)</p> <p>\u793a\u4f8b\uff1a</p> <p>Use the <code>printf()</code> function.(`printf()`) Use the<code>`printf()`</code>function.(`` `printf()` ```)</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u4ee3\u7801\u5757code_blocks","title":"\u4ee3\u7801\u5757\uff08Code Blocks\uff09","text":"<p>\u8bf4\u660e\uff1a</p> <ul> <li>Preformatted Code Block     \u5982\u679c\u8981\u63d2\u5165\u8de8\u884c\u7247\u6bb5\u6216\u5757\uff0c\u4e14\u8981\u4fdd\u6301\u6392\u7248\u6837\u5f0f\uff08\u5305\u62ec\u7a7a\u683c\u3001\u6362\u884c\u7b26\u548c\u7f29\u8fdb\uff09\uff0c\u53ef\u4f7f\u7528\u9884\u683c\u5f0f\u5316\u5f15\u7528\u8bed\u6cd5\u683c\u5f0f\u3002\u5bf9\u5e94 HTML \u4e2d\u7684 <code>&lt;pre&gt;</code> \u6807\u7b7e\u3002  </li> <li>Fenced Code Block     \u5982\u679c\u8981\u652f\u6301\u7f16\u7a0b\u8bed\u8a00\u8bed\u6cd5\u9ad8\u4eae\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 GFM \u6269\u5c55\u7684\u57fa\u4e8e YAML<sup>2</sup> \u6807\u8bb0\u8bed\u8a00\u7684 Fenced Code Block \u5f15\u7528\u8bed\u6cd5\u683c\u5f0f\u3002</li> </ul> <p>\u8bed\u6cd5\uff1a</p> <ul> <li>Preformatted Code Block     \u5728\u53e5\u6bb5\u7684\u884c\u9996\u63d2\u51651\u4e2atab \u6216 4\u4e2a\u7a7a\u683c\uff0c\u5219\u8868\u793a\u4ee3\u7801\u5757\u3002  </li> <li>[Fenced Code Block]     \u5728\u53e5\u6bb5\u884c\u9996\u548c\u884c\u672b\u7528\u4e09\u4e2a\u53cd\u5f15\u53f7\u6362\u884c\u95ed\u5305\uff0c\u5e76\u5728\u884c\u9996\u4e09\u4e2a\u53cd\u5f15\u53f7\u540e\u6dfb\u52a0 YAML \u8bed\u8a00\u6807\u8bc6\u3002</li> </ul> language aliases <code>Markdown</code> \u65e0\u522b\u540d\uff0c\u6ce8\u610f\u533a\u5206\u5927\u5c0f\u5199 <code>HTML</code> <code>xhtml</code> <code>JavaScript</code> <code>js</code>\u3001<code>node</code> <code>C</code> \u65e0\u522b\u540d\uff0c\u6ce8\u610f\u533a\u5206\u5927\u5c0f\u5199 <code>C++</code> <code>cpp</code> <code>Objective-C</code> <code>obj-c</code>\u3001<code>objc</code>\u3001<code>objectivec</code> <code>VimL</code> <code>vim</code>\u3001<code>nvim</code> <p>\u793a\u4f8b\uff1a</p> <p>1.Preformatted Code Block</p> <p>\u5c06\u4e00\u6bb5\u4ee3\u7801\u5757\u6574\u4f53\u5411\u53f3\u7f29\u8fdb\uff08\u2318 + ]\uff09\u5373\u53ef\u6d4b\u8bd5\u3002</p> <p>\uff081\uff09\u4ee5tab\u5f00\u5934\uff1a</p> <pre><code>these lines begin with tab will be shown as pre code block.\nthese lines begin with tab will be shown as pre code block.\nthese lines begin with tab will be shown as pre code block.\n</code></pre> <p>\uff082\uff09\u4ee54\u4e2a\u7a7a\u683c\u5f00\u5934\uff1a</p> <pre><code>these lines begin with 4 spaces will also be shown as pre code block.\nthese lines begin with 4 spaces will also be shown as pre code block.\nthese lines begin with 4 spaces will also be shown as pre code block.\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <p>pre \u683c\u5f0f\u5b58\u5728\u4ee5\u4e0b\u7f3a\u9677\uff1a</p> <ul> <li>\u5bf9\u591atab\u53ca\u7a7a\u683c\u7684\u7f29\u8fdb\u652f\u6301\u4e0d\u5b8c\u5584\uff01</li> <li>\u5c06\u5b8f\u7b26\u53f7#\uff08#include\u3001#import\uff09\u8bef\u89e3\u4e3aH1\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u89e3\u6790\u5668\u7684TOC\uff01</li> <li>\u5c06\u9876\u683c\u7a7a\u767d\u884c\uff08\u5305\u62ec\u884c\u9996\u5e26tab\uff09\u8bef\u8ba4\u4e3aParagraph Break\uff0c\u800c\u5272\u65ad\u4ee3\u7801\u5757\u6210\u7247\u6bb5\uff01</li> </ul> <p>2.Fenced Code Block</p> <p>Fenced Code Block \u4ee5\u4e09\u4e2a\u53cd\u5f15\u53f7\uff08backtick quotes\uff1a`\uff0c\u6709\u7684\u652f\u6301\u6ce2\u6d6a\u7ebf~\uff09\u5305\u88f9\uff0c\u7b2c\u4e00\u884c\u7684\u4e09\u4e2a\u53cd\u5f15\u53f7\u4e4b\u540e\u53ef\u4ee5\u51a0\u4e0a\u7f16\u7a0b\u8bed\u8a00\u7684 YAML \u6807\u8bb0\u8bc6\u522b\u8bed\u6cd5\u9ad8\u4eae\u3002</p> <ul> <li>\u4ee5\u4e0b\u6f14\u793a\u63d2\u5165\u4e00\u53e5 python \u4ee3\u7801\uff1a</li> </ul> <p>\u9996\u884c\uff08\u4e09\u4e2a\u53cd\u5f15\u53f7\u5f00\u5934\uff09\uff1a```python \u4e2d\u95f4\uff1aprint('Hello world!') \u672b\u884c\uff08\u4e09\u4e2a\u53cd\u5f15\u53f7\u7ed3\u5c3e\uff09\uff1a```</p> <pre><code>print('Hello world!')\n</code></pre> <ul> <li>\u4ee5\u4e0b\u6f14\u793a\u63d2\u5165\u4e00\u6bb5 Objective-C \u4ee3\u7801\uff1a</li> </ul> <p>\u9996\u884c\uff1a```obj-c \u4e2d\u95f4\uff1aObjective-C Code Block \u672b\u884c\uff1a```</p> <pre><code>//\n//  main.m\n//  EmptyApplication\n//\n//  Created by faner on 15/9/5.\n//  Copyright \u00a9 2015\u5e74 faner. All rights reserved.\n//\n\n#import &lt;UIKit/UIKit.h&gt;\n#import \"AppDelegate.h\"\n\nint main(int argc, char * argv[]) {\n    @autoreleasepool {\n        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));\n    }\n}\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <ol> <li>Haroopad \u7f16\u8f91\u5668\u5c06\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u7684<code>#import</code>\u7684\u7b2c\u4e00\u4e2a\u6709\u6548\u5b57\u7b26<code>#</code>\u8bef\u89e3\u4e3a H1\uff0c\u5bfc\u81f4 TOC \u9519\u4e71\u6216  Heading Focus Folding \u5931\u6548\u3002\u6b64\u65f6\uff0c\u53ef\u5c1d\u8bd5\u5728 Fenced Code Block \u884c\u9996\u6dfb\u52a0\u7a7a\u683c\u6216 tab \u7f29\u8fdb\u3002</li> <li>\u5173\u4e8e GitHub \u914d\u7f6e Fenced Code Block \u8bed\u6cd5\u9ad8\u4eae\u6240\u4f7f\u7528\u7684 YAML \u6807\u8bb0 \uff0c\u53ef\u53c2\u8003 \u521d\u63a2YAML\u3001YAML\u5b66\u4e60\u3001YAML\u5b66\u4e60\u603b\u7ed3\u3001YAML--\u60f3\u8981\u7231\u4f60\u5f88\u5bb9\u6613\u3002</li> </ol>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u5217\u8868list","title":"\u5217\u8868\uff08List\uff09","text":"<p>GFM \u7b49 Markdown \u6269\u5c55\u652f\u6301\u548c\u65e0\u5e8f\u5217\u8868\u3001\u6709\u5e8f\u5217\u8868\u548c\u4efb\u52a1\u5217\u8868\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u65e0\u5e8f\u5217\u8868unordered_list","title":"\u65e0\u5e8f\u5217\u8868\uff08Unordered List\uff09","text":"<p>\u65e0\u5e8f\u5217\u8868\uff08unordered, bulleted\uff09\u9879\u76ee\u7684\u884c\u9996\u4f7f\u7528\u661f\u53f7\uff08\u6216\u52a0\u53f7\uff0c\u6216\u51cf\u53f7\uff09\u52a0\u7a7a\u683c\u4f5c\u4e3a\u5217\u8868\u6807\u8bb0\uff08list markers\uff09\uff1a</p> <pre><code>- bullet list item 1 begin with a hyphens '-'\n+ bullet list item 2 begin with a pluses '+'\n* bullet list item 3 begin with an asterisks '*'\n</code></pre> <p>\u793a\u4f8b\u6548\u679c\uff1a</p> <ul> <li>bullet list item 1 begin with a '-'</li> <li>bullet list item 2 begin with a '+'</li> <li>bullet list item 3 begin with a '*'</li> </ul> <p>\u901a\u8fc7\u5728\u5217\u8868\u6807\u8bb0\u524d\u9762\u589e\u52a0 tab \u9636\u6b21\u6765\u5b9e\u73b0\u5d4c\u5957\u6548\u679c\uff08nested list\uff09\u3002 \u4ee5\u4e0b\u662f\u9488\u5bf9\u672c\u6587 TOC \u4e2d\u3010\u94fe\u63a5\u3011\u8fd9\u4e00\u7ae0\u8282\u7684\u76ee\u5f55\uff1a</p> <pre><code>- \u94fe\u63a5\uff08Hyperlink\uff09\n    - \u81ea\u52a8\u94fe\u63a5\uff08Autolink\uff09 &lt;!--\u884c\u9996\u7f29\u8fdb1\u4e2atab--&gt;\n    - \u6587\u5b57\uff08text href\uff09\n        - \u884c\u5185\u5f0f\uff08Inline\uff09 &lt;!--\u884c\u9996\u7f29\u8fdb2\u4e2atab--&gt;\n        - \u53c2\u8003\u5f0f\uff08Reference\uff09\n    - \u56fe\u7247\uff08image href\uff09\n        - \u63d2\u5165\u56fe\u7247\n        - \u56fe\u7247\u94fe\u63a5\n    - \u951a\u70b9\uff08inner link\uff09\n        - \u4e66\u7b7e\uff08Bookmark\uff09\n        - \u811a\u6ce8\uff08Footnote\uff09\n- \u5f15\u7528\uff08Blockquote\uff09\n</code></pre> <ul> <li>\u94fe\u63a5\uff08Hyperlink\uff09<ul> <li>\u81ea\u52a8\u94fe\u63a5\uff08Autolink\uff09</li> <li>\u6587\u5b57\uff08text href\uff09<ul> <li>\u884c\u5185\u5f0f\uff08Inline\uff09</li> <li>\u53c2\u8003\u5f0f\uff08Reference\uff09</li> </ul> </li> <li>\u56fe\u7247\uff08image href\uff09<ul> <li>\u63d2\u5165\u56fe\u7247</li> <li>\u56fe\u7247\u94fe\u63a5</li> </ul> </li> <li>\u951a\u70b9\uff08inner link\uff09<ul> <li>\u4e66\u7b7e\uff08Bookmark\uff09</li> <li>\u811a\u6ce8\uff08Footnote\uff09</li> </ul> </li> </ul> </li> <li>\u5f15\u7528\uff08Blockquote\uff09</li> </ul> <p>\u7f29\u8fdb\u63a7\u5236\u7b26\uff1a\u7a7a\u683c or TAB\uff1f</p> <ol> <li>\u5728\u5217\u8868\u6807\u8bb0\u524d\u9762\u63d2\u5165\u7a7a\u683c\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u7f29\u8fdb\u63a7\u5236\u5d4c\u5957\u6548\u679c\uff0c\u4f46\u4e0d\u540c\u7684 Markdown Render \u5bf9\u63a7\u5236\u5c42\u7ea7\u7684\u7a7a\u683c\u4e2a\u6570\u8981\u6c42\u4e0d\u4e00\u3002  </li> <li>\u4e3a\u4e86\u53d6\u5f97\u6700\u4f73\u7684\u517c\u5bb9\u6027\uff0c\u5efa\u8bae\u4f7f\u7528 tab \u6765\u63a7\u5236\u5d4c\u5957\u5c42\u7ea7\uff08nested hierarchy\uff09\uff0c\u4ee5\u671f\u5728\u4e0d\u540c\u7684\u6e32\u67d3\u5f15\u64ce\u4e0b\u90fd\u80fd\u8fbe\u5230\u9884\u671f\u7684\u663e\u793a\u6548\u679c\u3002\u5f53\u7136\uff0c\u524d\u63d0\u662f\u4f7f\u7528 hard tabs\uff08tab characters\uff09\uff0c\u800c\u975e soft tabs\uff08spaces\uff09\u3002</li> </ol>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u6709\u5e8f\u5217\u8868ordered_list","title":"\u6709\u5e8f\u5217\u8868\uff08Ordered List\uff09","text":"<p>\u6709\u5e8f\u5217\u8868\uff08ordered / numbered\uff09\u9879\u76ee\u7684\u884c\u9996\u5219\u4f7f\u7528\u6570\u5b57\u63a5\u4e00\u4e2a\u82f1\u6587\u53e5\u70b9\u6807\u8bb0\uff08use numbers followed by periods\uff09\uff1a</p> <pre><code>1. GETTING STARTED  \n    Choosing Blogging Platform (WordPress)\n2. GETTING YOUR BLOG ONLINE  \n    Choosing Domain Name &amp; Web Hosting\n3. DESIGNING AND TWEAKING YOUR BLOG  \n    Quick and easy ways to get your blog look the way you want\n4. WRITING BLOG POSTS AND PAGES  \n    Adding new content for your Blog (Posts, Pages, Images etc\u2026)\n</code></pre> <p>Step-by-step walkthrough for starting a blog:</p> <ol> <li>GETTING STARTED     Choosing Blogging Platform (WordPress)</li> <li>GETTING YOUR BLOG ONLINE     Choosing Domain Name &amp; Web Hosting</li> <li>DESIGNING AND TWEAKING YOUR BLOG     Quick and easy ways to get your blog look the way you want</li> <li>WRITING BLOG POSTS AND PAGES     Adding new content for your Blog (Posts, Pages, Images etc\u2026)</li> </ol> <p>\u6709\u5e8f\u5217\u8868\u548c\u65e0\u5e8f\u5217\u8868\u53ef\u4ee5\u5b9e\u73b0\u6df7\u5408\u5d4c\u5957\u7f16\u6392\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u4efb\u52a1\u5217\u8868task_lit","title":"\u4efb\u52a1\u5217\u8868\uff08Task Lit\uff09","text":"<p>GFM \u6269\u5c55\u652f\u6301\u628a\u5217\u8868\u53d8\u6210\u5e26\u52fe\u9009\u6846\u7684\u4efb\u52a1\u5217\u8868\uff0c\u53ea\u9700\u8981\u5728\u5217\u8868\u6807\u8bb0\u540e\u6dfb\u52a0<code>[ ]</code>\u6807\u8bb0\u2610\u8868\u793aunchecked\uff0c\u5728\u4e2d\u62ec\u53f7\u4e2d\u586b\u5199x\uff08<code>[x]</code>\uff09\u6807\u8bb0\u2611\ufe0e\u8868\u793achecked\uff08filled\uff09\u3002</p> <pre><code>- [ ] task1 to do\n- [x] task2 done\n1. [ ] task3 to do\n2. [x] task4 done\n</code></pre> <ul> <li> task1 to do</li> <li> task2 done 1. [ ] task3 to do 2. [x] task4 done</li> </ul>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u8868\u683ctable","title":"\u8868\u683c\uff08Table\uff09","text":"<p>You can create tables by assembling a list of words and dividing them with hyphens <code>-</code> (for the first row), and then separating each column with a pipe <code>|</code> (vertical bar):</p> First Header Second Header Content Cell Content Cell Content Cell Content Cell <p>For aesthetic purposes, you can also add extra pipes on the ends:</p> First Header Second Header Content Cell Content Cell Content Cell Content Cell <p>Note that the dashes at the top don't need to match the length of the header text exactly:</p> Name Description Help Display the help window. Close Closes a window <p>You can also include inline Markdown such as links, bold, italics, or strikethrough:</p> Name Description Help Display the help window. Close Closes a window <p>Finally, by including colons <code>:</code> within the header row, you can define text to be left-aligned, right-aligned, or center-aligned:</p> Left-Aligned Center Aligned Right Aligned col 3 is some wordy text $1600 col 2 is centered $12 zebra stripes are neat $1 <p>A colon on the left-most side indicates a left-aligned column; a colon on the right-most side indicates a right-aligned column; a colon on both sides indicates a center-aligned column.</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#\u6570\u5b66\u516c\u5f0f","title":"\u6570\u5b66\u516c\u5f0f","text":"<p>You can render LaTeX<sup>3</sup> mathematical expressions using MathJax<sup>4</sup>, as on math.stackexchange.com: The Gamma function satisfying \\(\\Gamma(n) = (n-1)!\\quad\\forall n\\in\\mathbb N\\) is via the Euler integral</p> \\[ \\Gamma(z) = \\int_0^\\infty t^{z-1}e^{-t}dt\\,. \\] <p>\u4e66\u5199\u4e00\u4e2a\u8d28\u80fd\u5b88\u6052\u516c\u5f0f</p> \\[E=mc^2\\] <p>\u53ef\u53c2\u8003 Mathjax\u4e0eLaTex\u516c\u5f0f\u7b80\u4ecb\u3002</p>"},{"location":"blog/20151102/1-Markdown-Syntax/#_1","title":"Markdown Syntax","text":"<p>The end\uff01</p> <ol> <li> <p>\u8fd9\u91cc\u7684\u6e90\u7801\u4e3a<code>&lt;font color='red'&gt;\u6807\u9898\uff08Header\uff09&lt;/font&gt;</code>\uff0c\u5c1d\u8bd5\u4f7f\u7528 font.color \u7740\u8272\u3002\u00a0\u21a9</p> </li> <li> <p>YAML\u662f\"YAML Ain't a Markup Language\"\uff08YAML\u4e0d\u662f\u4e00\u79cd\u7f6e\u6807\u8bed\u8a00\uff09\u7684\u9012\u5f52\u7f29\u5199\uff0c\u65e9\u5148YAML\u7684\u610f\u601d\u5176\u5b9e\u662f\uff1a\"Yet Another Markup Language\"\uff08\u53e6\u5916\u4e00\u79cd\u7f6e\u6807\u8bed\u8a00\uff09\u3002\u00a0\u21a9</p> </li> <li> <p>LaTeX\u662f\u4e00\u79cd\u57fa\u4e8e \u03a4\u0395\u03a7\u7684\u6392\u7248\u7cfb\u7edf\uff0c\u5b83\u901a\u8fc7\\section\u548c\\paragraph\u7b49\u8bed\u53e5\uff0c\u89c4\u5b9a\u4e86\u6bcf\u4e00\u53e5\u8bdd\u5728\u6587\u7ae0\u4e2d\u6240\u4ece\u5c5e\u7684\u5c42\u6b21\uff0c\u4ece\u800c\u6781\u5927\u65b9\u4fbf\u4e86\u5bf9\u5404\u4e2a\u5c42\u6b21\u6279\u91cf\u5904\u7406\u3002\u53ef\u53c2\u8003 TeX \u4e0e LaTeX\u3001LaTeX \u5165\u95e8\u6587\u6863 \u548c LaTeX \u5165\u95e8\u6559\u7a0b\u3002\u00a0\u21a9</p> </li> <li> <p>MatchJax \u662f\u4e00\u4e2aJavaScript\u5f15\u64ce\uff0c\u7528\u6765\u663e\u793a\u7f51\u7edc\u4e0a\u7684\u6570\u5b66\u516c\u5f0f\u3002MathJax\u53ef\u4ee5\u89e3\u6790Latex\u3001MathML\u548cASCIIMathML\u7684\u6807\u8bb0\u8bed\u8a00\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"blog/20240326/10-material-appearance/","title":"\u5b9a\u5236Material\u5916\u89c2","text":"<p>Match your brand's colors, fonts, icons, logo, and more with a few lines of configuration \u2013 Material for MkDocs makes it easy to extend the basic configuration or alter the appearance.</p>"},{"location":"blog/20240326/10-material-appearance/#logo__icons","title":"Logo &amp; Icons","text":"<p>Changing the logo and icons</p> <p>\u652f\u6301\u4ee5\u4e0b\u56fe\u6807\uff1a</p> <ul> <li>Material Design</li> <li>FontAwesome</li> <li>Octicons</li> <li>github markdown</li> <li>github commit</li> </ul> <p>\u53ef\u4ee5\u901a\u8fc7\u5c06favicon\u53d8\u91cf\u8bbe\u7f6e\u4e3a.ico\u6216\u56fe\u50cf\u6587\u4ef6\u6765\u66f4\u6539\u9ed8\u8ba4\u56fe\u6807\u3002</p> <pre><code>theme:\n  name: material\n  favicon: 'assets/images/favicon.ico'\n</code></pre> <p>Logo \u5e94\u4e3a\u77e9\u5f62\uff0c\u6700\u5c0f\u5206\u8fa8\u7387\u4e3a128x128\uff0c\u7559\u51fa\u4e00\u5b9a\u7684\u8fb9\u7f18\u7a7a\u95f4\uff0c\u5e76\u5728\u900f\u660e\u5730\u9762\u4e0a\u7531\u9ad8\u5bf9\u6bd4\u5ea6\u533a\u57df\u7ec4\u6210\uff0c\u56e0\u4e3a\u5b83\u5c06\u653e\u7f6e\u5728\u5f69\u8272\u6807\u9898\u680f\u3002</p> <pre><code>theme:\n  name: material\n  logo: 'images/logo.svg'\n</code></pre> <p>\u6216\u8005\u4f7f\u7528 Material Design \u56fe\u6807\uff1a</p> <pre><code>theme:\n  name: material\n  icon:\n      logo: material/cloud\n</code></pre> <p>\u8fd9\u91cc favicon \u548c logo \u590d\u7528\u672c\u5730 356x356 \u89c4\u683c\u7684\u56fe\u7247\uff1a</p> <pre><code>  favicon: assets/hold_yourself.jpg\n  logo: assets/hold_yourself.jpg\n</code></pre>"},{"location":"blog/20240326/10-material-appearance/#colors","title":"Colors","text":"<p>Changing the colors</p> <p>\u652f\u6301\u8ddf\u968f\u7cfb\u7edf\u4e3b\u9898\u5207\u6362\uff1aSystem preference | Automatic light / dark mode\u3002</p> <p>\u91c7\u7528\u5b98\u65b9\u535a\u5ba2\u914d\u7f6e mkdocs.yml\uff1a</p> <pre><code>  palette:\n    - media: \"(prefers-color-scheme)\"\n      toggle:\n        icon: material/link\n        name: Switch to light mode\n    - media: \"(prefers-color-scheme: light)\"\n      scheme: default\n      primary: indigo\n      accent: indigo\n      toggle:\n        icon: material/toggle-switch\n        name: Switch to dark mode\n    - media: \"(prefers-color-scheme: dark)\"\n      scheme: slate\n      primary: black\n      accent: indigo\n      toggle:\n        icon: material/toggle-switch-off\n        name: Switch to system preference\n</code></pre>"},{"location":"blog/20240327/11-material-navigation/","title":"\u914d\u7f6eMaterial\u5bfc\u822a","text":"<p>Setting up navigation</p> <p>A clear and concise navigation structure is an important aspect of good project documentation. Material for MkDocs provides a multitude of options to configure the behavior of navigational elements, including <code>tabs</code> and <code>sections</code>, and one of its flagship features: <code>instant loading</code>.</p>"},{"location":"blog/20240327/11-material-navigation/#instant_loading","title":"instant loading","text":"<p>When instant loading is enabled, clicks on all internal links will be intercepted and dispatched via XHR without fully reloading the page. Add the following lines to mkdocs.yml:</p> <p>The <code>site_url</code> setting must be set.</p> <pre><code>theme:\n  features:\n    - navigation.instant\n</code></pre> <p><code>Instant prefetching</code>(sponsors only) is a new experimental feature that will start to fetch a page once the user hovers over a link. This will reduce the perceived loading time for the user, especially on slow connections, as the page will be available immediately upon navigation. Enable it with:</p> <pre><code>theme:\n  features:\n    - navigation.instant\n    - navigation.instant.prefetch\n</code></pre> <p><code>Progress indicator</code>: In order to provide a better user experience on slow connections when using instant navigation, a progress indicator can be enabled. It will be shown at the top of the page and will be hidden once the page has fully loaded. You can enable it in mkdocs.yml with:</p> <pre><code>theme:\n  features:\n    - navigation.instant\n    - navigation.instant.progress\n</code></pre> <p>The progress indicator will only show if the page hasn't finished loading after 400ms, so that fast connections will never show it for a better instant experience.</p>"},{"location":"blog/20240327/11-material-navigation/#anchor_tracking","title":"Anchor tracking","text":"<p>When anchor tracking is enabled, the URL in the address bar is automatically updated with the active anchor as highlighted in the table of contents. Add the following lines to mkdocs.yml:</p> <pre><code>theme:\n  features:\n    - navigation.tracking # \u5728url\u4e2d\u4f7f\u7528\u6807\u9898\u5b9a\u4f4d\u951a\u70b9\n</code></pre>"},{"location":"blog/20240327/11-material-navigation/#navigation_tabs","title":"Navigation tabs","text":"<p>When tabs are enabled, top-level sections are rendered in a menu layer below the header for viewports above 1220px, but remain as-is on mobile.1 Add the following lines to mkdocs.yml:</p> <pre><code>theme:\n  features:\n    - navigation.tabs\n</code></pre> <p>When sticky tabs are enabled, navigation tabs will lock below the header and always remain visible when scrolling down. Just add the following two feature flags to mkdocs.yml:</p> <pre><code>theme:\n  features:\n    - navigation.tabs # \u9876\u90e8\u663e\u793a\u5bfc\u822a\u9876\u5c42nav\uff08\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2a\u8282\u70b9\uff09\n    - navigation.tabs.sticky # \u6eda\u52a8\u65f6\u9690\u85cf\u9876\u90e8nav\uff0c\u9700\u8981\u914d\u5408navigation.tabs\u4f7f\u7528\n</code></pre>"},{"location":"blog/20240327/11-material-navigation/#table_of_contents","title":"Table of contents","text":"<p><code>Anchor following</code>: When anchor following for the table of contents is enabled, the sidebar is automatically scrolled so that the active anchor is always visible. Add the following lines to mkdocs.yml:</p> <pre><code>theme:\n  features:\n    - toc.follow\n</code></pre> <p><code>Navigation integration</code>: When navigation integration for the table of contents is enabled, it is always rendered as part of the navigation sidebar on the left. Add the following lines to mkdocs.yml:</p> <pre><code>theme:\n  features:\n    - toc.integrate # \u53f3\u4fa7 TOC \u96c6\u6210\u5230\u5de6\u4fa7 nav sidebar\n</code></pre>"},{"location":"blog/20240327/11-material-navigation/#hide_per_doc","title":"hide per doc","text":"<p>\u5728 Markdown \u6587\u6863\u5f00\u5934\u7684 meta-data \u4e2d\u53ef\u4ee5\u8bbe\u7f6e\u9690\u85cf\u5de6\u4fa7 nav \u548c\u53f3\u4fa7 toc \u4fa7\u8fb9\u680f\u3002</p> <p>The navigation and/or table of contents sidebars can be hidden for a document with the front matter hide property. Add the following lines at the top of a Markdown file:</p> <pre><code>---\nhide:\n  - navigation\n  - toc\n---\n\n# Page title\n...\n</code></pre>"},{"location":"blog/20240327/11-material-navigation/#back-to-top_button","title":"Back-to-top button","text":"<p>A back-to-top button can be shown when the user, after scrolling down, starts to scroll up again. It's rendered centered and just below the header. Add the following lines to mkdocs.yml:</p> <pre><code>theme:\n  features:\n    - navigation.top # \u5f00\u542f\u4e00\u952e\u56de\u5230\u9875\u9762\u9876\u90e8\u6309\u94ae\n</code></pre>"},{"location":"blog/20240327/11-material-navigation/#header_-_automatic_hiding","title":"Header - Automatic hiding","text":"<p>Setting up the header</p> <p>When autohiding is enabled, the header is automatically hidden when the user scrolls past a certain threshold, leaving more space for content. Add the following lines to mkdocs.yml:</p> <pre><code>theme:\n  features:\n    - header.autohide # \u5411\u4e0b\u6eda\u52a8\u65f6\u81ea\u52a8\u9690\u85cfheader\n</code></pre>"},{"location":"blog/20240327/11-material-navigation/#footer","title":"Footer","text":"<p>Setting up the footer</p> <p>The footer can include links to the previous and next page of the current page. If you wish to enable this behavior, add the following lines to mkdocs.yml:</p> <pre><code>theme:\n  features:\n    - navigation.footer # \u5f00\u542f\u5e95\u90e8\u4e0a\u4e00\u7bc7/\u4e0b\u4e00\u7bc7\u5bfc\u822a\n</code></pre>"},{"location":"blog/20240327/11-material-navigation/#hide_per_doc_1","title":"hide per doc","text":"<p>\u5728 Markdown \u6587\u6863\u5f00\u5934\u7684 meta-data \u4e2d\u53ef\u4ee5\u8bbe\u7f6e\u9690\u85cf\u5e95\u90e8\u4e0a\u4e00\u7bc7/\u4e0b\u4e00\u7bc7\u5bfc\u822a\u3002</p> <p>The footer navigation showing links to the previous and next page can be hidden with the front matter hide property. Add the following lines at the top of a Markdown file:</p> <pre><code>---\nhide:\n  - footer\n---\n\n# Page title\n...\n</code></pre>"},{"location":"blog/20240328/12-material-blog/","title":"\u5b89\u88c5Material\u535a\u5ba2(sidecar to mkdocs)","text":"<p>Setting up a blog</p> <p>Material for MkDocs makes it very easy to build a blog, either as a sidecar to your documentation or standalone. Focus on your content while the engine does all the heavy lifting, automatically generating archive and category indexes, post slugs, configurable pagination and more.</p> <p>Built-in blog plugin</p>"},{"location":"blog/20240328/12-material-blog/#blog_plugin","title":"blog plugin","text":"<p>The built-in blog plugin adds support for building a blog from a folder of posts, which are annotated with dates and other structured data. First, add the following lines to mkdocs.yml:</p> <pre><code>  plugins:\n    - blog\n</code></pre> <p>\u542f\u7528\u540e\uff0c\u9996\u6b21 serve \u6216 build\uff0c\u5728 docs \u76ee\u5f55\u4e0b\u4f1a\u521b\u5efa\u4e00\u4e2a blog \u6587\u4ef6\u5939\uff1a</p> <pre><code>$ tree -L 2 docs/blog\ndocs/blog\n\u251c\u2500\u2500 index.md\n\u2514\u2500\u2500 posts\n\n2 directories, 1 file\n</code></pre>"},{"location":"blog/20240328/12-material-blog/#blog_only","title":"Blog only","text":"<p>\u5982\u679c\u60f3\u628a mkdocs \u7ad9\u70b9\u5f53\u505a\u7eaf\u535a\u5ba2\uff0c\u53ef\u4ee5\u53bb\u6389 blog \u4e2d\u95f4\u5c42\u76ee\u5f55\uff0c\u76f4\u63a5\u5728 docs \u76ee\u5f55\u4e0b posts\u3002</p> <p>You might need to build a pure blog without any documentation. In this case, you can create a folder tree like this:</p> <pre><code>.\n\u251c\u2500 docs/\n\u2502  \u251c\u2500 posts/ \n\u2502  \u251c\u2500 .authors.yml\n\u2502  \u2514\u2500 index.md\n\u2514\u2500 mkdocs.yml\n</code></pre> <p>And add the following lines to mkdocs.yml:</p> <pre><code>plugins:\n  - blog:\n      blog_dir: . \n</code></pre> <p>With this configuration, the url of the blog post will be <code>/&lt;post_slug&gt;</code> instead of <code>/blog/&lt;post_slug&gt;</code>.</p>"},{"location":"blog/20240328/12-material-blog/#doc_with_blog","title":"doc with Blog","text":"<p>\u672c\u7ad9\u662f\u7b14\u8bb0\u6587\u6863+\u535a\u5ba2\uff0c\u5373 sidecar \u6a21\u5f0f\uff0c\u535a\u5ba2\u53ea\u662f\u5176\u4e2d\u4e00\u4e2a\u4e13\u9879\u5165\u53e3\u3002</p> <p>\u5728 blog/posts \u4e0b\u521b\u5efa\u4e00\u4e2a hello-world.md\uff1a</p> <pre><code>.\n\u251c\u2500 docs/\n\u2502  \u2514\u2500 blog/\n\u2502     \u251c\u2500 posts/\n\u2502     \u2502  \u2514\u2500 hello-world.md \n\u2502     \u2514\u2500 index.md\n\u2514\u2500 mkdocs.yml\n</code></pre> <p>Create a new file called hello-world.md and add the following lines:</p> <pre><code>---\ndraft: true \ndate: 2024-01-31 \ncategories:\n  - Hello\n  - World\n---\n\n# Hello world!\n\nHere is the content\n\n...\n</code></pre> <p>that <code>archive</code> and <code>category</code> indexes have been automatically generated for you.</p>"},{"location":"blog/20240328/12-material-blog/#how_it_works","title":"How it works","text":"<p>The plugin scans the configured posts directory for <code>.md</code> files from which paginated views are automatically generated. If not configured otherwise, the plugin expects that your project has the following directory layout, and will create any missing directories or files for you:</p> <pre><code>.\n\u251c\u2500 docs/\n\u2502  \u2514\u2500 blog/\n\u2502     \u251c\u2500 posts/\n\u2502     \u2514\u2500 index.md\n\u2514\u2500 mkdocs.yml\n</code></pre> <p>The <code>index.md</code> file in the blog directory is the entry point to your blog \u2013 a paginated view listing all posts in reverse chronological order. Besides that, the plugin supports automatically creating archive and category pages that list a subset of posts for a time interval or category.</p> <p>Post URLs are completely configurable, no matter if you want your URLs to include the post's date or not. Rendered dates always display in the locale of the site language of your project. Like in other static blog frameworks, posts can be annotated with a variety of metadata, allowing for easy integration with other built-in plugins, e.g., the social and tags plugin.</p> <p>Posts can be organized in nested folders with a directory layout that suits your specific needs, and can make use of all components and syntax that Material for MkDocs offers, including admonitions, annotations, code blocks, content tabs, diagrams, icons, math, and more.</p>"},{"location":"blog/20240328/12-material-blog/#config_blog","title":"config blog","text":"<ol> <li>\u914d\u7f6e blog.blog_dir</li> <li>\u914d\u7f6e post_date_format, post_url_date_format \u548c post_url_format</li> <li>nav \u5bfc\u822a\u52a0\u5165 blog \u5165\u53e3</li> </ol> <pre><code>plugins:\n  # enabled by default, but must be re-added when other plugins are used.\n  - search\n  # categorize any page with tags as part of the front matter of the page\n  - tags\n  - blog:\n      blog_dir: blog\n      # post_dir: posts\n      post_date_format: medium\n      post_url_date_format: yyyyMMdd\n      post_url_format: \"{date}/{file}\"\n      # pagination_per_page: 10 # default\n\n# \u9875\u9762\u5bfc\u822a\nnav:\n  - Blog: blog/index.md\n</code></pre> <p>nav.Blog: blog/index.md ?</p> <p>\u4e0a\u9762\u76f4\u63a5\u5728 Blog \u540e\u6307\u5b9a\u535a\u5ba2\u9996\u9875\u8def\u5f84\uff0c\u5f52\u6863\uff08archive\uff09\u548c\u5206\u7c7b\uff08categories\uff09\u5c06\u4e0d\u4f1a\u5c55\u793a\uff01 \u56e0\u4e3a\u4e00\u884c\u5c06 Blog \u8fd9\u4e2a\u5bfc\u822a section \u5360\u6ee1\uff0c\u4f1a\u6291\u5236\u65d7\u4e0b\u81ea\u52a8\u63d2\u5165 archive \u548c category\uff01</p> Blog \u5165\u53e3\u6b63\u786e\u7684\u914d\u7f6e\u59ff\u52bf<pre><code>nav:\n  - Blog:\n    - blog/index.md\n</code></pre>"},{"location":"blog/20240328/12-material-blog/#adding_an_excerpt","title":"Adding an excerpt","text":"<p>\u5185\u5bb9\u6458\u8981 + \u7ee7\u7eed\u9605\u8bfb</p> <p>blog \u9ed8\u8ba4\u7684\u6458\u8981\u548c\u6b63\u6587\u5185\u5bb9\u5206\u5272\u7b26\u4e3a\uff1a<code>post_excerpt_separator: &lt;!-- more --&gt;</code></p> <p>The blog index, as well as archive and category indexes can either list the entire content of each post, or excerpts of posts. An excerpt can be created by adding a  separator after the first few paragraphs of a post:</p> <pre><code># Hello world!\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod\nnulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor\nmassa, nec semper lorem quam in massa.\n\n&lt;!-- more --&gt;\n...\n</code></pre> <p>When the built-in blog plugin generates all indexes, the content before the excerpt separator is automatically extracted, allowing the user to start reading a post before deciding to jump in.</p> <p>By default, the plugin makes post excerpts optional. When a post doesn't define an excerpt, views include the entire post. This setting can be used to make post excerpts required:</p> OptionalRequired <pre><code>plugins:\n  - blog:\n      post_excerpt: optional\n</code></pre> <pre><code>plugins:\n  - blog:\n      post_excerpt: required\n</code></pre>"},{"location":"blog/20240328/12-material-blog/#meta-data","title":"meta-data","text":""},{"location":"blog/20240328/12-material-blog/#adding_categories","title":"Adding categories","text":"<p>blog \u9ed8\u8ba4\u542f\u7528\u4e86\u5206\u7c7b\u63d2\u4ef6\u3002</p> <p>Categories are an excellent way for grouping your posts thematically on dedicated index pages. This way, a user interested in a specific topic can explore all of your posts on this topic. Make sure categories are enabled and add them to the front matter categories property:</p> <pre><code>---\ndate: 2024-01-31\ncategories:\n  - Hello\n  - World\n---\n\n# Hello world!\n...\n</code></pre> <p>If you want to save yourself from typos when typing out categories, you can define your desired categories in mkdocs.yml as part of the <code>categories_allowed</code> configuration option. The built-in blog plugin will stop the build if a category is not found within the list.</p>"},{"location":"blog/20240328/12-material-blog/#adding_tags","title":"Adding tags","text":"<p>\u9700\u8981\u663e\u5f0f\u542f\u7528 tags \u63d2\u4ef6\u3002</p> <p>Besides categories, the built-in blog plugin also integrates with the built-in tags plugin. If you add tags in the front matter tags property as part of a post, the post is linked from the tags index:</p> <pre><code>---\ndate: 2024-01-31\ntags:\n  - Foo\n  - Bar\n---\n\n# Hello world!\n...\n</code></pre> <p>As usual, the tags are rendered above the main headline and posts are linked on the tags index page, if configured. Note that posts are, as pages, only linked with their titles.</p>"},{"location":"blog/20240328/12-material-blog/#changing_the_slug","title":"Changing the slug","text":"<p>\u5728\u6587\u7ae0\u5f00\u5934\u7684 meta \u4fe1\u606f\u4e2d\u53ef\u4ee5\u6307\u5b9a slug\u3002</p> <p>Slugs are the shortened description of your post used in the URL. They are automatically generated, but you can specify a custom slug for a page:</p> <pre><code>---\nslug: hello-world\n---\n\n# Hello there world!\n...\n</code></pre>"},{"location":"blog/20240328/12-material-blog/#setting_the_reading_time","title":"Setting the reading time","text":"<p>\u9700\u8981 x \u5206\u949f\u9605\u8bfb\u65f6\u95f4\u3002</p> <p>When enabled, the readtime package is used to compute the expected reading time of each post, which is rendered as part of the post and post excerpt. Nowadays, many blogs show reading times, which is why the built-in blog plugin offers this capability as well.</p> <p>Sometimes, however, the computed reading time might not feel accurate, or result in odd and unpleasant numbers. For this reason, reading time can be overridden and explicitly set with the front matter readtime property for a post:</p> <pre><code>---\ndate: 2024-01-31\nreadtime: 15\n---\n\n# Hello world!\n...\n</code></pre> <p>This will disable automatic reading time computation.</p>"},{"location":"blog/20240328/12-material-blog/#adding_pages","title":"Adding pages","text":"<p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u914d\u7f6e\u597d\u4e86 blog_dir/post_dir \u540e\uff0cmkdocs-material \u4f1a\u81ea\u52a8\u76d1\u6d4b\u626b\u63cf posts \u76ee\u5f55\u4e0b <code>.md</code> \u6587\u4ef6\uff0c\u5e76\u5c06\u535a\u5ba2\u5217\u8868\u6dfb\u52a0\u5230\u535a\u5ba2\u9996\u9875 index.md(index.html)\u3002</p> <p>\u5f53\u7136\uff0c\u9664\u4e86\u5728 nav \u4e2d\u914d\u7f6e blog \u5165\u53e3\uff0c\u4e5f\u53ef\u624b\u52a8\u5c06 blog \u4e0b\u7684\u5176\u4ed6\u6587\u4ef6\u52a0\u5165 nav \u5bfc\u822a\u3002</p> <p>Besides posts, it's also possible to add static pages to your blog by listing the pages in the <code>nav</code> section of mkdocs.yml. All generated indexes are included after the last specified page. For example, to add a page on the authors of the blog, add the following to mkdocs.yml:</p> mkdocs.yml<pre><code>nav:\n  - Blog:\n    - blog/index.md\n    - blog/authors.md\n      ...\n</code></pre>"},{"location":"blog/20240328/12-material-blog/#route_to_sub_path","title":"route to sub path","text":"<p>jia.je \u7684\u5bfc\u822a\u680f\u6709\u4e00\u4e2a\u5165\u53e3 <code>\u77e5\u8bc6\u5e93</code>\uff0c\u4e3b\u7ad9\u70b9 \u7684 mkdocs.yml \u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>nav:\n\n  - \u77e5\u8bc6\u5e93: \"/kb/\"\n</code></pre> <p>\u70b9\u51fb\u6253\u5f00\u94fe\u63a5 jia.je/kb/ \u6307\u5411\u53e6\u4e00\u4e2a\u72ec\u7acb\u7684 mkdocs \u77e5\u8bc6\u5e93 \u7ad9\u70b9\u3002</p> <p>\u5728\u670d\u52a1\u4e0a\u914d\u7f6e\u597d\u4e8c\u7ea7\u76ee\u5f55\u8def\u7531 <code>location /kb</code> \u5373\u53ef\u3002</p>"},{"location":"blog/20240328/12-material-blog/#refs","title":"refs","text":"<p>Material for Mkdocs: Blog @github</p> <ul> <li> <p> \u6770\u54e5\u7684{\u8fd0\u7ef4\uff0c\u7f16\u7a0b\uff0c\u8c03\u677f\u5b50}\u5c0f\u7b14\u8bb0</p> <p>Blog @github</p> </li> <li> <p> cuishuaiwen - Eureka!</p> <p>Blog @github</p> </li> <li> <p> \u683c\u83b1\u59c6 - shafish.cn</p> <p>Blog @github</p> </li> <li> <p> A code to remember</p> <p>Blog @github</p> </li> </ul> <ul> <li>\u674f\u5b50\u6251\u7c0c\u7c0c</li> <li>Jeremy Feng</li> <li>\u534e\u4e2d\u519c\u4e1a\u5927\u5b66\u4f5c\u91cd\u8ba1\u7b97\u5e73\u53f0\u7528\u6237\u624b\u518c</li> <li>Dr. Yonghao Leo Wang Webpage</li> <li>claassen.net</li> <li>Starfall Projects</li> <li>breadNET Documentation</li> </ul>"},{"location":"blog/20240329/13-github-giscus/","title":"\u4e3aMaterial\u535a\u5ba2\u914d\u7f6egiscus\u8bc4\u8bba\u63d2\u4ef6","text":"<p>\u672c\u6587\u7b80\u8981\u8bb0\u5f55\u4e86\u4e3a Mkdocs Material Blog \u6dfb\u52a0 GitHub giscus \u8bc4\u8bba\u63d2\u4ef6\u3002</p> <p>Adding a comment system: Material for MkDocs allows to easily add the third-party comment system of your choice to the footer of any page by using theme extension. As an example, we'll be integrating Giscus, which is Open Source, free, and uses GitHub discussions as a backend.</p>","tags":["giscus"]},{"location":"blog/20240329/13-github-giscus/#enable_giscus","title":"Enable giscus","text":"<p>\u70b9\u8fdb https://github.com/apps/giscus \u53f3\u4fa7\u70b9\u51fb Install\uff0c\u6388\u6743 Repository access\u3002</p> <p>\u518d\u8fdb\u5165 https://giscus.app/ Configuration</p> <p>language \u9009\u62e9 <code>\u7b80\u4f53\u4e2d\u6587</code>\uff08\u9ed8\u8ba4\u4e3a en\uff09\u3002</p> <p>Repository\uff1a</p> <p>The Discussions feature is turned on by enabling it for your repository.</p> <p>\u6309\u7167\u94fe\u63a5\u8bf4\u660e\uff0c\u70b9\u8fdb repo \u7684 Settings\uff0c\u4e0b\u6ed1\u5230 Features \u90e8\u5206\uff0c\u52fe\u9009 <code>Discussions</code>\u3002</p> <p>\u8fd4\u56de giscus.app \u91cd\u65b0\u586b\u5199 repo \u540d\u79f0 <code>fan2/mkdocs</code>\uff0c\u9a8c\u8bc1\u901a\u8fc7\u3002</p> <p>Discussion Category \u9009\u62e9 <code>Announcements</code>\u3002</p> <p>Features \u52fe\u9009\u4ee5\u4e0b\u9009\u9879\uff1a</p> <ul> <li> <code>Emit discussion metadata</code></li> <li> <code>Place the comment box above the comments</code></li> <li> <code>Load the comments lazily</code></li> </ul> <p>\u62f7\u8d1d\u751f\u6210\u7684 Enable giscus \u811a\u672c\u3002</p>","tags":["giscus"]},{"location":"blog/20240329/13-github-giscus/#config_comments","title":"config comments","text":"<p>\u518d\u6309\u7167 Material \u5b98\u65b9\u6559\u7a0b\uff0c\u5728 docs \u540c\u7ea7\u76ee\u5f55\u521b\u5efa\u76ee\u5f55 overrides/partials\uff0c\u521b\u5efa comments.html \u6587\u4ef6\uff0c\u63d2\u5165 Enable giscus \u811a\u672c\u3002</p> overrides/partials/comments.html <pre><code>{% if page.meta.comments %}\n  &lt;h2 id=\"__comments\"&gt;{{ lang.t(\"meta.comments\") }}&lt;/h2&gt;\n  &lt;!-- Insert generated snippet here --&gt;\n  &lt;script src=\"https://giscus.app/client.js\"\n    data-repo=\"fan2/mkdocs\"\n    data-repo-id=\"R_**********\"\n    data-category=\"Announcements\"\n    data-category-id=\"DIC_****************\"\n    data-mapping=\"pathname\"\n    data-strict=\"0\"\n    data-reactions-enabled=\"1\"\n    data-emit-metadata=\"1\"\n    data-input-position=\"top\"\n    data-theme=\"preferred_color_scheme\"\n    data-lang=\"zh-CN\"\n    data-loading=\"lazy\"\n    crossorigin=\"anonymous\"\n    async&gt;\n  &lt;/script&gt;\n\n  &lt;!-- Synchronize Giscus theme with palette --&gt;\n  &lt;script&gt;\n    var giscus = document.querySelector(\"script[src*=giscus]\")\n\n    // Set palette on initial load\n    var palette = __md_get(\"__palette\")\n    if (palette &amp;&amp; typeof palette.color === \"object\") {\n      var theme = palette.color.scheme === \"slate\"\n        ? \"transparent_dark\"\n        : \"light\"\n\n      // Instruct Giscus to set theme\n      giscus.setAttribute(\"data-theme\", theme) \n    }\n\n    // Register event handlers after documented loaded\n    document.addEventListener(\"DOMContentLoaded\", function() {\n      var ref = document.querySelector(\"[data-md-component=palette]\")\n      ref.addEventListener(\"change\", function() {\n        var palette = __md_get(\"__palette\")\n        if (palette &amp;&amp; typeof palette.color === \"object\") {\n          var theme = palette.color.scheme === \"slate\"\n            ? \"transparent_dark\"\n            : \"light\"\n\n          // Instruct Giscus to change theme\n          var frame = document.querySelector(\".giscus-frame\")\n          frame.contentWindow.postMessage(\n            { giscus: { setConfig: { theme } } },\n            \"https://giscus.app\"\n          )\n        }\n      })\n    })\n  &lt;/script&gt;\n{% endif %}\n</code></pre> <p>\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a custom_dir\uff1a</p> <pre><code>theme:\n  name: material\n  custom_dir: overrides\n</code></pre> <p>\u5728\u8981\u5f00\u542f\u8bc4\u8bba\u7684md\u6587\u7ae0\u5f00\u5934\u5143\u6570\u636e\u5f00\u542f\u8bc4\u8bba\uff1a</p> <pre><code>---\ncomments: true\n---\n\n# Page title\n...\n</code></pre> <p>Relevant background: Disqus integration is broken in latest releases</p> <p>Info</p> <p>The Disqus integration was removed in v8 in favor of theme customization. The new guide explains how to achieve the same result with some block overrides. Note that in the future we might throw that out too in favor of a leaner solution (maybe giscus), as Disqus free version has become too horrible to use.</p>","tags":["giscus"]},{"location":"blog/20240329/13-github-giscus/#refs","title":"refs","text":"<p>\u4e3aMkdocs\u7f51\u7ad9\u6dfb\u52a0\u8bc4\u8bba\u7cfb\u7edf\uff08\u4ee5giscus\u4e3a\u4f8b\uff09 \u57fa\u4e8e giscus \u4e3a\u7f51\u7ad9\u6dfb\u52a0\u8bc4\u8bba\u7cfb\u7edf</p>","tags":["giscus"]},{"location":"blog/20240329/14-google-analytics/","title":"\u4e3aMaterial\u535a\u5ba2\u6dfb\u52a0Google Analytics\u548cVercount\u8bbf\u95ee\u7edf\u8ba1","text":"<p>\u672c\u6587\u7b80\u8981\u8bb0\u5f55\u4e86\u4e3a Mkdocs Material Blog \u6dfb\u52a0 Google Analytics \u7edf\u8ba1\u5206\u6790\u670d\u52a1\u3002</p> <p>Setting up site analytics: As with any other service offered on the web, understanding how your project documentation is actually used can be an essential success factor. Material for MkDocs natively integrates with Google Analytics and offers a customizable cookie consent and a feedback widget.</p>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#google_analytics","title":"Google Analytics","text":"<p>Google Analytics - marketingplatform</p> <p>Google Analytics @zh-cn</p> <p>Analytics Help @zh-cn</p> <p>Google Analytics Guides @zh-cn</p> <p>Google Analytics 4</p> <p>Google Analytics\uff08\u5206\u6790\uff094 \u662f\u4e00\u9879\u5206\u6790\u670d\u52a1\uff0c\u7528\u4e8e\u8861\u91cf\u60a8\u7684\u7f51\u7ad9\u548c\u5e94\u7528\u4e2d\u7684\u6d41\u91cf\u548c\u4e92\u52a8\u60c5\u51b5\u3002\u672c\u6587\u6863\u63d0\u4f9b\u4e86\u9762\u5411\u5f00\u53d1\u8005\u7fa4\u4f53\u7684\u5b9e\u73b0\u8bf4\u660e\u548c\u53c2\u8003\u8d44\u6599\u3002</p> <p>\u53c2\u8003\uff1a\u5c06 Google Analytics\uff08\u5206\u6790\uff09\u4e0e Blogger \u7ed3\u5408\u4f7f\u7528\u3002</p>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#set_up_measurement","title":"Set up measurement","text":"<p>\u8fdb\u5165 Google Analytics\uff0c\u4f7f\u7528 google \u8d26\u53f7\u767b\u5f55\uff0c\u7136\u540e\u70b9\u51fb Set up measurement\uff0c\u6309\u7167\u63d0\u793a\u5f00\u59cb\u521b\u5efa\u8bc4\u4f30\u8d26\u53f7\u3002</p> <ol> <li>Account creation: \u586b\u5199\u540d\u79f0</li> <li>Property creation: \u586b\u5199\u540d\u79f0</li> <li>Business details: \u9009\u62e9 Internet &amp; Telecom, 1-10</li> <li>Business objectives: \u9009\u62e9 Get baseline reports</li> <li>Data collection: Web - Set up data stream</li> </ol> <p>\u586b\u5199 site_url &amp; site_name \u540e\uff0c\u83b7\u5f97 MEASUREMENT ID: <code>G-XXXXXXXXXX</code>\u3002</p> <p>\u5728 mkdocs.yml \u4e2d\u6dfb\u52a0\u914d\u7f6e\u5373\u53ef\uff1a</p> <pre><code>extra:\n  analytics:\n    provider: google\n    property: G-XXXXXXXXXX\n</code></pre>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#admin_reports","title":"Admin Reports","text":"<p>\u540e\u7eed\u767b\u5f55\u8fdb\u5165 Analytics | Home\uff0c\u5373\u53ef\u67e5\u770b\u5bf9\u5e94 Account | Property \u7684\u6d41\u91cf\u7edf\u8ba1\u5206\u6790\u6570\u636e\u3002</p> <p>\u70b9\u51fb\u5de6\u4fa7\u8fb9\u680f\u6700\u4e0b\u65b9\u7684 \u2699\ufe0f \u6309\u94ae\u8fdb\u5165 Admin \u7ba1\u7406\u9875\u9762\uff0c\u5728 Data streams \u4e2d\u70b9\u9009\u7ad9\u70b9\uff0c\u53ef\u4ee5\u770b\u5230 MEASUREMENT ID\uff0c\u9ed8\u8ba4\u5df2\u7ecf\u5f00\u542f Events | Enhanced Measurement\uff0c\u5305\u62ec <code>Page views</code> \u548c <code>Site search</code>\u3002</p> <p>\u70b9\u51fb\u5de6\u4fa7\u8fb9\u680f\u7684\u7b2c\u4e8c\u4e2a Reports \u6309\u94ae\uff0c\u8fdb\u5165\u9762\u677f\u53ef\u4ee5\u770b\u5230\u62a5\u544a\u5feb\u7167\uff08Reports snapshot\uff09\uff0c\u8fd8\u53ef\u67e5\u770b\u5176\u4ed6\u8be6\u7ec6\u6307\u6807\uff1a</p> <ol> <li><code>Acquisition</code>\uff08\u83b7\u5ba2\uff09: User acquisition\uff08\u7528\u6237\u83b7\u53d6\u60c5\u51b5\uff09\uff0cTraffic acquisition\uff08\u6d41\u91cf\u6765\u6e90\u60c5\u51b5\uff09\uff1b</li> <li><code>Engagement</code>\uff08\u53c2\u4e0e\u5ea6\uff09: pages and screens, WHICH PAGES AND SCREENS GET THE MOST VIEWS?</li> <li><code>Retention</code>\uff08\u7559\u5b58\uff09: HOW WELL DO YOU RETAIN YOUR USERS?</li> </ol>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#reporting_api","title":"Reporting API","text":"<p>\u53ef\u4ee5\u501f\u52a9 Google Analytics \u63d0\u4f9b\u7684 Reporting API \u5c06\u7ba1\u7406\u540e\u53f0\u7684\u6570\u636e\u62c9\u53d6\u5230\u7f51\u7ad9\u524d\u7aef\uff0c\u4ece\u800c\u5b9e\u73b0\u663e\u793a\u6587\u7ae0\u8bbf\u95ee\u3001\u9605\u8bfb\u6570\u91cf\u7b49\u529f\u80fd\u3002</p> <p>Measure pageviews \u00a0|\u00a0 Google Analytics \u00a0|\u00a0 Google for Developers</p> <p>GA4 - Set up Analytics for a website and/or app - Analytics Help - Set up data collection for websites</p> <p>Reporting API V4\uff0cAnalytics Reporting API v4 &amp; Samples</p> <ul> <li>\u81ea\u5df1\u5efa\u7f51\u7ad9\u600e\u4e48\u6dfb\u52a0Google Analytics\u7edf\u8ba1\u4ee3\u7801\u67e5\u770b\u6bcf\u65e5\u6d41\u91cf</li> <li>\u4f7f\u7528 Google Analytics API \u5b9e\u73b0\u535a\u5ba2\u9605\u8bfb\u91cf\u7edf\u8ba1 - PRIN BLOG</li> <li>\u7528 Google Analytics + Vercel Serverless \u4e3a\u6587\u7ae0\u6dfb\u52a0\u6d4f\u89c8\u91cf\u7edf\u8ba1</li> </ul>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#google_search","title":"Google Search","text":"<p>Google Search Console @zh-cn</p> <p>Search Console Help @zh-cn</p> <p>Google Search Central | Documentation @zh-cn</p> <p>Google Search Console</p> <p>Google Search Console \u662f\u4e00\u9879\u7531 Google \u63d0\u4f9b\u7684\u514d\u8d39\u670d\u52a1\uff0c\u53ef\u5e2e\u52a9\u60a8\u76d1\u63a7\u548c\u7ef4\u62a4\u60a8\u7684\u7f51\u7ad9\u5728 Google \u641c\u7d22\u7ed3\u679c\u4e2d\u7684\u5c55\u793a\u60c5\u51b5\u4ee5\u53ca\u6392\u67e5\u95ee\u9898\u3002\u5373\u4f7f\u6ca1\u6709\u6ce8\u518c Search Console\uff0c\u60a8\u7684\u7f51\u9875\u4e5f\u53ef\u80fd\u4f1a\u663e\u793a\u5728 Google \u641c\u7d22\u7ed3\u679c\u4e2d\uff0c\u4f46 Search Console \u53ef\u5e2e\u52a9\u60a8\u4e86\u89e3\u5e76\u6539\u8fdb Google \u5904\u7406\u60a8\u7f51\u7ad9\u7684\u65b9\u5f0f\u3002</p> <p>\u53c2\u8003\uff1a\u8ba9Google\u641c\u7d22\u5230\u81ea\u5df1\u7684\u535a\u5ba2\u3001Hexo \u4e2a\u4eba\u535a\u5ba2 SEO \u4f18\u5316\uff083\uff09\uff1a\u6539\u9020\u4f60\u7684\u535a\u5ba2\uff0c\u63d0\u5347\u641c\u7d22\u5f15\u64ce\u6392\u540d\u3002</p> <p>BTW: Bing Webmaster Tools: support import your sites from GSC</p>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#add_a_property","title":"Add a property","text":"<ol> <li>\u67e5\u770b\u7f51\u7ad9\u662f\u5426\u88ab\u6536\u5f55: \u641c\u7d22\u6846\u8f93\u5165 site:duetorun.com</li> <li>\u5728 Google Search Console \u63d0\u4ea4\u641c\u7d22\u8d44\u6e90\uff08Add a property\uff09\uff0c\u9009\u62e9\u7f51\u5740\u524d\u7f00\uff0c\u5c06\u751f\u6210\u7684 html \u6587\u4ef6\u4e0b\u8f7d\u653e\u5230\u7f51\u7ad9\u6839\u76ee\u5f55\uff0c\u70b9\u51fb \u9a8c\u8bc1\u7f51\u7ad9\u6240\u6709\u6743\u3002</li> </ol> <p>\u5176\u4ed6\u9a8c\u8bc1\u65b9\u6cd5</p> <ol> <li>HTML \u6807\u8bb0\uff1a\u5411\u60a8\u7f51\u7ad9\u7684\u9996\u9875\u6dfb\u52a0\u5143\u6807\u8bb0</li> <li>Google Analytics\uff08\u5206\u6790\uff09\uff1a\u4f7f\u7528\u60a8\u7684 Google Analytics\uff08\u5206\u6790\uff09\u8d26\u53f7\uff0c\u6d89\u53ca\u5230 analytics.js \u6216 gtag.js</li> <li>Google \u8ddf\u8e2a\u4ee3\u788d\u7ba1\u7406\u5668\uff1a\u4f7f\u7528\u60a8\u7684 Google \u8ddf\u8e2a\u4ee3\u7801\u7ba1\u7406\u5668\u8d26\u53f7</li> <li>\u57df\u540d\u63d0\u4f9b\u5546\uff1a\u5c06 DNS \u8bb0\u5f55\u4e0e Google \u5173\u8054</li> </ol>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#crawling_and_indexing","title":"Crawling and Indexing","text":"<p>Google Crawling and Indexing | Google Search Central</p> <p>1.\u63d0\u4ea4\u7ad9\u70b9\u5730\u56fe\uff1aSitemaps</p> <p>\u70b9\u51fb\u5de6\u4fa7\u83dc\u5355 \u7f16\u5236\u7d22\u5f15-\u7ad9\u70b9\u5730\u56fe\uff08Indexing - Sitemaps\uff09\uff0c\u5728 \u6dfb\u52a0\u65b0\u7684\u7ad9\u70b9\u5730\u56fe\uff08Add a new sitemap\uff09\u8f93\u5165\u7ad9\u70b9\u5730\u56fe\uff08Enter sitemap URL\uff09\u5e76\u70b9\u51fb SUBMIT \u63d0\u4ea4\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u7ad9\u70b9\u5730\u56fe sitemap.xml\uff0c\u53ef\u5230 xml-sitemaps \u8f93\u5165\u7f51\u5740\u751f\u6210\u3002</p> <p>2.\u624b\u52a8\u8bf7\u6c42\uff08\u91cd\u65b0\uff09\u7f16\u5165\u7d22\u5f15\uff1aAsk Google to Recrawl Your Website</p> <p>\u70b9\u51fb\u5de6\u4fa7\u83dc\u5355 \u7f51\u5740\u68c0\u67e5\uff08URL inspection\uff09\uff0c\u8f93\u5165\u535a\u5ba2\u7f51\u5740\uff0c\u7136\u540e\u70b9\u51fb \u6d4b\u8bd5\u5b9e\u9645\u7248\u672c\uff08TEST LIVE URL\uff09\uff0c\u8bf7\u6c42\u7f16\u5165\u7d22\u5f15\uff08REQUEST INDEXING\uff09\u3002</p> <p>\u7f16\u5236\u7d22\u5f15\uff1a\u6b63\u5728\u5904\u7406\u6570\u636e\uff0c\u8bf7\u8fc7 1 \u5929\u5de6\u53f3\u518d\u6765\u67e5\u770b Indexing - Pages : Processing data, please check again in a day or so</p> <p>3.\u624b\u52a8\u8bf7\u6c42\u79fb\u9664\u5931\u6548\u7684\u7d22\u5f15\uff1aRemove a page hosted on your site from Google</p> <ul> <li>Remove A URL From Google's Index | SEO Tips | Contensis</li> <li>Remove web results from Google Search - Google Search Help</li> <li>Requesting removal of content from our index \u00a0|\u00a0 Google Search Central Blog</li> </ul> <p>\u70b9\u51fb\u5de6\u4fa7 \u7f16\u5236\u7d22\u5f15-\u5220\u9664\uff08Indexing - Removals\uff09\uff0c\u70b9\u51fb tab \u6682\u65f6\u79fb\u9664\uff08TEMPORARY REMOVALS\uff09\uff0c\u70b9\u51fb \u65b0\u8981\u6c42\uff08NEW REQUEST\uff09\uff1a</p> <ol> <li>Remove this URL only: https://duetorun.com/About/about/</li> <li>Remove all URLs with this prefix: https://duetorun.com/Productivity/</li> </ol>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#link_account_to_analytics","title":"link account to analytics","text":"<p>\u56de\u5230 Analytics | Home\uff0c\u68c0\u6d4b\u5230\u672c Google \u8d26\u53f7\u6ce8\u518c\u4e86 Google Search Console\uff0c\u63a8\u8350\u5173\u8054\u8d26\u53f7\u3002</p> <p>RECOMMENDATION: Link Account</p> <p>Link your Search Console property \"https://duetorun.com/\" to analyze how search behavior relates to on-site behavior</p> <p>Recommended because you are a verified owner of your Search Console property and you have at least the editor role in Analytics</p> <p>\u70b9\u51fb Link Account \u94fe\u63a5\uff0c\u5c06\u6253\u5f00 Admin \u9762\u677f\uff0c\u5e76\u81ea\u52a8\u5b9a\u4f4d\u5230 Product links \u5e95\u4e0b\u65b0\u589e\u9879 <code>Search console links</code>\u3002</p> <p>\u70b9\u51fb\u53f3\u4fa7\u7684 Link \u94fe\u63a5\u6309\u94ae\uff0c\u5f00\u59cb Link setup \u6d41\u7a0b\u3002</p> <ol> <li> <p><code>Choose Search Console property</code>\uff1a\u70b9\u5f00 Choose accounts -- Link to a property I manage\uff0c\u52fe\u9009\u5217\u51fa\u7684 property\uff0c\u70b9\u51fb Confirm\u3002</p> </li> <li> <p>\u70b9\u51fb Next\uff0c<code>Select Web Stream</code>\uff1aChoose a data stream\uff0c\u52fe\u9009\u5217\u51fa\u7684 data stream\u3002</p> </li> <li> <p>\u70b9\u51fb Next\uff0c<code>Review and submit</code>\uff0c\u786e\u8ba4\u524d\u4e24\u6b65\u7684\u9009\u62e9\uff0c\u6ca1\u6709\u95ee\u9898\u70b9\u51fb Submit \u63d0\u4ea4\u3002</p> </li> <li> <p>Results \u663e\u793a LINK CREATED\u3002</p> </li> </ol> <p>\u8fd4\u56de\u5230 Search Console links\uff0c\u53ef\u4ee5\u770b\u5230\u5173\u8054\u7684\u7ed3\u679c\u3002</p>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#cloudflare_crawler_hints_indexnow","title":"Cloudflare Crawler Hints: IndexNow","text":"<p>Crawler Hints \u00b7 Cloudflare Cache (CDN) docs</p> <p>Crawler Hints</p> <p>Crawler Hints provide high quality data to search engines and other crawlers when sites using Cloudflare change their content. This allows crawlers to precisely time crawling, avoid wasteful crawls, and generally reduce resource consumption on origins and other Internet infrastructure.</p> <p>\u767b\u5f55\u8fdb\u5165 Cloudflare Dash\uff0c\u4eea\u8868\u76d8\u5b9a\u4f4d Websites\uff0c\u663e\u793a\u53ef\u7528\u57df\u540d\uff08\u7ad9\u70b9\uff09\uff0c\u70b9\u51fb\u5f53\u524d\u7ad9\u70b9\u57df\u540d\u3002 \u4eea\u8868\u76d8\u70b9\u51fb Caching - Configuration\uff0cCrawler Hints \u70b9\u51fb\u5f00\u542f\u3002</p> <ul> <li>Crawler Hints Update: Cloudflare Supports IndexNow and Announces General Availability</li> <li>60,000 websites using Cloudflare turned on IndexNow</li> </ul>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#meta_tag_robots_customize_indexing_policies","title":"meta tag robots: customize indexing policies","text":"<p>Using metadata in templates</p> <p>In order to add custom meta tags to your document, you can extend the theme and override the <code>extrahead</code> block, e.g. to add indexing policies for search engines via the <code>robots</code> property.</p> <p>\u590d\u5236 templates/main.html \u5230 overrides/main.html\uff0c\u5728\u5176\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> apply meta.robots if specified<pre><code>{% block extrahead %}\n  {% if page and page.meta and page.meta.robots %}\n    &lt;meta name=\"robots\" content=\"{{ page.meta.robots }}\" /&gt;\n  {% endif %}\n{% endblock %}\n</code></pre> <p>\u8fd9\u6837\uff0c\u901a\u8fc7\u5728\u9875\u9762\u5934\u90e8\u8bbe\u7f6e\u5143\u6570\u636e\u5373\u53ef\u5b9a\u5236robots\u6293\u6355\u7b56\u7565\u3002</p> <p>\u4f8b\u5982\u5728 about \u9875\u9762\u5934\u90e8\u6dfb\u52a0\u5143\u6570\u636e\u7981\u6b62\uff08Disallow\uff09\u641c\u7d22\u5f15\u64ce\u6293\u6355\uff1a</p> <pre><code>---\nrobots: noindex, nofollow\n---\n\n...\n</code></pre> <p>\u5176\u4ed6\u9875\u9762\u672a\u6307\u5b9arobots\u7b56\u7565\uff0c\u91c7\u53d6\u7684\u662f\u9ed8\u8ba4\u7684\u201c\u6cd5\u65e0\u7981\u6b62\u5373\u53ef\u4e3a\u201d\u7684\u5f00\u653e\uff08Allow\uff09\u6293\u53d6\u7b56\u7565\u3002</p> <p>Google Search Central</p> <ul> <li>Robots Meta Tags Specifications</li> <li>Robots.txt Introduction and Guide</li> <li>Create and Submit a robots.txt File</li> </ul>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#busuanzivercount_pageviews_counter","title":"busuanzi/vercount pageviews counter","text":"<p>\u767e\u5ea6\u7edf\u8ba1\uff0c\u8c37\u6b4c\u5206\u6790\u7b49\u7f51\u7ad9\u7edf\u8ba1\u5206\u6790\u5de5\u5177\uff0c\u867d\u7136\u6709\u4e0d\u9519\u7684\u7edf\u8ba1\u5206\u6790\u529f\u80fd\uff0c\u4f46\u662f\u90fd\u4e0d\u80fd\u76f4\u63a5\u5448\u73b0\u5728\u7f51\u7ad9\u4e0a\uff0c\u90fd\u9700\u8981\u8fdb\u5165\u76f8\u5e94\u7684\u540e\u53f0\u624d\u80fd\u67e5\u770b\u3002</p> <p>\u8fd9\u91cc\u5c1d\u8bd5\u4f7f\u7528 \u4e0d\u849c\u5b50 \u63d0\u4f9b\u7684\u7edf\u8ba1\u811a\u672c\uff0c\u5c06\u8bbf\u5ba2\u4eba\u6570\u3001\u8bbf\u95ee\u91cf\u7edf\u8ba1\u5448\u73b0\u5728\u81ea\u5df1\u7684\u7f51\u7ad9\u4e0a\u3002</p> <ul> <li>\u4e0d\u849c\u5b50\u5b9e\u73b0\u7f51\u7ad9\u8bbf\u95ee\u91cf\u8bbf\u5ba2\u6570\u7edf\u8ba1</li> <li>MkDocs\u5b9e\u73b0\u7f51\u7ad9\u8bbf\u95ee\u7edf\u8ba1(\u4e0d\u849c\u5b50)</li> </ul> <p>\u9996\u5148\u5728\u5f15\u5165\u811a\u672c\uff0c\u76f4\u63a5\u5728\u7ebf\u5d4c\u5165\u6216\u4e0b\u8f7d\u5230\u672c\u5730\uff1a</p> <pre><code>extra_javascript:\n  # busuanzi statistics\n  # //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\n  - javascripts/busuanzi.pure.mini.js\n</code></pre>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#\u9996\u9875\u7edf\u8ba1\u603b\u8bbf\u95ee\u91cf","title":"\u9996\u9875\u7edf\u8ba1\u603b\u8bbf\u95ee\u91cf","text":"<p>\u5728\u7ad9\u70b9\u9996\u9875 index.md \u672b\u5c3e\u6dfb\u52a0 <code>\u672c\u7ad9\u603b\u8bbf\u95ee\u91cf</code> \u548c <code>\u603b\u8bbf\u5ba2\u6570</code> \u7684\u7edf\u8ba1\uff1a</p> <pre><code>&lt;span id=\"busuanzi_container_site_pv\" style=\"font-size:0.8em;color=grey\"&gt;\u672c\u7ad9\u603b\u8bbf\u95ee\u91cf &lt;span id=\"busuanzi_value_site_pv\"&gt;pv&lt;/span&gt;&lt;/span&gt;\uff0c&lt;span id=\"busuanzi_container_site_uv\" style=\"font-size:0.8em;color=grey\"&gt;\u603b\u8bbf\u5ba2\u6570 &lt;span id=\"busuanzi_value_site_uv\"&gt;uv&lt;/span&gt;\u3002&lt;/span&gt;\n</code></pre> <p>\u672c\u5730\u8c03\u8bd5\u65f6\uff0c\u8fd9\u4e2a\u7edf\u8ba1\u8c8c\u4f3c\u9519\u4e71\uff0c\u4e0a\u7ebf\u786e\u8ba4 OK\u3002</p> <p>\u4e5f\u53ef\u8003\u8651\u5c06 templates/partials/copyright.html \u590d\u5236\u4e00\u4efd\u5230 overrides/partials/ \u4e0b\uff0c\u5c06\u7ad9\u70b9\u5168\u5c40\u8ba1\u6570\u663e\u793a\u5728\u5e95\u680f\u4e2d\u95f4\u90e8\u4f4d\u3002</p>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#\u535a\u5ba2\u6587\u7ae0\u9605\u8bfb\u91cf","title":"\u535a\u5ba2\u6587\u7ae0\u9605\u8bfb\u91cf","text":"<p>Overriding templates</p> <p>The following templates are added by the built-in blog plugin:</p> <ul> <li>blog.html \u2013 Template for blog, archive and category index</li> <li>blog-post.html \u2013 Template for blog post</li> </ul> <p>\u9996\u5148\u67e5\u770b\u5b89\u88c5 mkdocs-material \u7684 site-pacages \u76ee\u5f55\uff1a</p> <pre><code>$ mkdocs -V\nmkdocs, version 1.5.3 from /usr/local/lib/python3.10/site-packages/mkdocs (Python 3.10)\n</code></pre> <p>\u5728 site-packages \u76ee\u5f55\u4e0b\u627e\u5230 material\uff0c\u5176 templates \u76ee\u5f55\u4e0b\u5b58\u653e\u7740\u7f51\u9875\u6a21\u677f\u6587\u4ef6\uff1a</p> <pre><code>$ tree -L 1 /usr/local/lib/python3.10/site-packages/material/templates\n/usr/local/lib/python3.10/site-packages/material/templates\n\u251c\u2500\u2500 404.html\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 __pycache__\n\u251c\u2500\u2500 assets\n\u251c\u2500\u2500 base.html\n\u251c\u2500\u2500 blog-post.html\n\u251c\u2500\u2500 blog.html\n\u251c\u2500\u2500 main.html\n\u251c\u2500\u2500 mkdocs_theme.yml\n\u251c\u2500\u2500 partials\n\u2514\u2500\u2500 redirect.html\n\n4 directories, 8 files\n</code></pre> <p>\u590d\u5236 templates/blog-post.html \u5230 overrides/blog-post.html\uff0c\u5728 page.config.readtime\uff0c\u5373 \u3010\u9700\u8981 x \u5206\u949f\u9605\u8bfb\u65f6\u95f4\u3011\u540e\u9762\u6dfb\u52a0\u4e00\u884c\u3010\u9605\u8bfb\u91cf\uff1aN\u3011\uff1a</p> <pre><code>                    {% if page.config.readtime %}\n                      {% set time = page.config.readtime %}\n                      &lt;li class=\"md-nav__item\"&gt;\n                        &lt;div class=\"md-nav__link\"&gt;\n                          {% include \".icons/material/clock-outline.svg\" %}\n                          &lt;span class=\"md-ellipsis\"&gt;\n                            {% if time == 1 %}\n                              {{ lang.t(\"readtime.one\") }}\n                            {% else %}\n                              {{ lang.t(\"readtime.other\") | replace(\"#\", time) }}\n                            {% endif %}\n                          &lt;/span&gt;\n                        &lt;/div&gt;\n                      &lt;/li&gt;\n                    {% endif %}\n                    &lt;li class=\"md-nav__item\"&gt;\n                      &lt;div class=\"md-nav__link\"&gt;\n                        {% include \".icons/material/book-open-page-variant-outline.svg\" %}\n                        &lt;span class=\"md-ellipsis\" id=\"busuanzi_container_page_pv\"&gt;\n                          \u9605\u8bfb\u91cf\uff1a&lt;span id=\"busuanzi_value_page_pv\"&gt;N/A&lt;/span&gt;\n                        &lt;/span&gt;\n                      &lt;/div&gt;\n                    &lt;/li&gt;\n</code></pre> <p>\u4ece\u672c\u5730\u8c03\u8bd5\u6765\u770b\uff0c\u6587\u7ae0\u9605\u8bfb\u91cf\u8c8c\u4f3c\u6b63\u786e\uff0c\u4e0a\u7ebf\u786e\u8ba4\u684c\u9762 Chrome \u6ca1\u95ee\u9898\u3002 \u4f46\u662f iPhone/iPad Safari \u4e0d\u51c6\u786e\uff0c\u8c8c\u4f3c\u662f\u591a\u7bc7\u5168\u5c40\u7d2f\u8ba1\u3002</p> <p>\u6ce8\u610f\uff1amkdocs-material \u5305\u5347\u7ea7\u65f6\uff0c\u4f1a\u8986\u5199\u6389 blog-post.html\uff01</p>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20240329/14-google-analytics/#\u66ff\u6362\u4e3a_vercount","title":"\u66ff\u6362\u4e3a Vercount","text":"<ul> <li>\u89e3\u51b3\u4e0d\u849c\u5b50 (busuanzi) \u6587\u7ae0\u8ba1\u6570\u51fa\u9519\u95ee\u9898</li> <li>Vercount: \u4e00\u4e2a\u6bd4\u4e0d\u849c\u5b50\u66f4\u597d\u7684\u7f51\u7ad9\u8ba1\u6570\u5668</li> </ul> <p>\u4ece\u4e0d\u849c\u5b50\u5207\u6362\u5230 Vercount @github\uff0c\u53ea\u9700\u76f4\u63a5\u66ff\u6362\u4e0d\u849c\u5b50\u7684 script \u6807\u7b7e\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u4fee\u6539\u4efb\u4f55\u4ee3\u7801\u3002\u6570\u636e\u4f1a\u5728\u521d\u6b21\u8bbf\u95ee\u65f6\u81ea\u52a8\u4ece\u4e0d\u849c\u5b50\u540c\u6b65\u3002</p> \u6d77\u5916\u8bbf\u95ee\u4f18\u5316\u7248\u672c\u4e2d\u56fd\u8bbf\u95ee\u4f18\u5316\u7248\u672c <pre><code>&lt;script defer src=\"https://vercount.one/js\"&gt;&lt;/script&gt;\n</code></pre> <pre><code>&lt;script defer src=\"https://cn.vercount.one/js\"&gt;&lt;/script&gt;\n</code></pre> <p>\u5c06 mkdocs.yml \u4e2d\u7684 <code>extra_javascript</code> \u90e8\u5206\u66ff\u6362 busuanzi statistics \u811a\u672c\u4e3a https://vercount.one/js\u3002</p> <pre><code>extra_javascript:\n  # busuanzi statistics\n  - https://vercount.one/js\n</code></pre> <p>\u6dfb\u52a0\u4ee5\u4e0a\u811a\u672c\u4e4b\u540e\uff0c\u590d\u7528\u4e0d\u849c\u5b50\u7684 pv/uv id\uff0c\u5728 html \u4e2d\u63d2\u5165\u4ee5\u4e0b\u7edf\u8ba1\u6807\u7b7e\uff0c\u5373\u53ef\u5f00\u59cb\u4e3a\u4f60\u7684\u7f51\u7ad9\u7edf\u8ba1\u8bbf\u95ee\u91cf\u548c\u8bbf\u5ba2\u91cf\u3002</p> <pre><code>\u672c\u6587\u603b\u9605\u8bfb\u91cf &lt;span id=\"busuanzi_value_page_pv\"&gt;Loading&lt;/span&gt; \u6b21\n\u672c\u6587\u603b\u8bbf\u5ba2\u91cf &lt;span id=\"busuanzi_value_page_uv\"&gt;Loading&lt;/span&gt; \u4eba\n\u672c\u7ad9\u603b\u8bbf\u95ee\u91cf &lt;span id=\"busuanzi_value_site_pv\"&gt;Loading&lt;/span&gt; \u6b21\n\u672c\u7ad9\u603b\u8bbf\u5ba2\u6570 &lt;span id=\"busuanzi_value_site_uv\"&gt;Loading&lt;/span&gt; \u4eba\n</code></pre>","tags":["SEO","analytics","search","pageviews"]},{"location":"blog/20221212/2-Markdown-Formula/","title":"Markdown Formula","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 Markdown \u63d2\u5165\u6570\u5b66\u516c\u5f0f\u3002</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u6807\u8bc6","title":"\u6807\u8bc6","text":"<p>TeX and LaTeX math delimiters</p> <ul> <li>Inline math: <code>$...$</code>, will be rendered inline.</li> <li>Display (block) math: <code>$$...$$</code>, will be rendered in block.</li> </ul> <p>\u5728MathJax\u4e2d\uff0c\u9ed8\u8ba4\u7684displayed\u516c\u5f0f\u5206\u9694\u7b26\u6709 <code>$$...$$</code> \u548c <code>\\[...\\]</code> \uff0c\u800c\u9ed8\u8ba4\u7684inline\u516c\u5f0f\u5206\u9694\u7b26\u4e3a <code>\\(...\\)</code>\uff0c\u5f53\u7136\u8fd9\u4e9b\u90fd\u662f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7684\uff0c\u5177\u4f53\u914d\u7f6e\u8bf7\u53c2\u8003\u6587\u6863\u3002\u5728\u672c\u6587\u4e2d\uff0c\u4f7f\u7528 <code>$$...$$</code> \u4f5c\u4e3adisplayed\u5206\u9694\u7b26\uff0c<code>$...$</code> \u4f5c\u4e3ainline\u5206\u9694\u7b26\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cCSDN markdown\u3001vscode markdown\u5185\u7f6e\u9884\u89c8\u63d2\u4ef6\u7b49\u7f16\u8f91\u5668\u4e2d\uff0c\u884c\u5185\u6570\u5b66\u516c\u5f0f\u7684\u7f8e\u5143\u7b26\u53f7\u524d\u540e\u5747\u4e0d\u80fd\u6709\u7a7a\u683c\uff0c\u5426\u5219\u65e0\u6cd5\u6b63\u5e38\u6e32\u67d3\u3002</p> <p>\u5728 vscode markdown preview enhanced \u63d2\u4ef6\u548c jupyter notebook markdwn cell \u4e2d\uff0c\u884c\u5185\u6570\u5b66\u516c\u5f0f\u7684\u7f8e\u5143\u7b26\u53f7\u524d\u540e\u6709\u7a7a\u683c\u4e5f\u80fd\u6b63\u5e38\u6e32\u67d3\u3002</p> <ol> <li> <p>Inline math equations are wrapped in single dollar signs.</p> <ul> <li>For example, <code>$x^2$</code> becomes \\(x^2\\).</li> <li>Pythagorean Theorem: <code>$a^2 + b^2 = c^2$</code>: \\(a^2 + b^2 = c^2\\).</li> <li>Einstein\u2019s Theory of Special Relativity: <code>e=mc^2</code>: \\(e=mc^2\\).</li> </ul> </li> <li> <p>KaTeX blocks begin and end with two dollar signs:</p> <ul> <li><code>% comment</code> \u4e3a\u6ce8\u91ca\u884c\uff0c\u4e0d\u4f1a\u88ab\u6e32\u67d3\u5c55\u793a\u3002</li> <li>\u884c\u672b\u63d2\u5165 <code>\\\\</code> \u6216 <code>\\cr</code> \u6362\u884c\u3002</li> </ul> </li> </ol> <pre><code>$$\n% Pythagorean Theorem\na^2 + b^2 = c^2 \\\\\n\n% Einstein\u2019s Theory of Special Relativity\ne=mc^2\n$$\n</code></pre> \\[ % % Pythagorean Theorem a^2 + b^2 = c^2 \\\\ % Einstein\u2019s Theory of Special Relativity e=mc^2 \\]"},{"location":"blog/20221212/2-Markdown-Formula/#environments","title":"Environments","text":"<p>\u73af\u5883\u53d8\u91cf\u7684\u8d77\u59cb\u6807\u8bb0\u4e3a <code>\\begin{ENV}</code> \uff0c\u7ed3\u675f\u6807\u8bb0\u4e3a <code>\\end{ENV}</code>\u3002</p> <p>\u5e38\u7528\u7684\u73af\u5883\u53d8\u91cf\u5305\u62ec\u4ee5\u4e0b\uff1a</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u516c\u5f0f\u7b49\u5f0f","title":"\u516c\u5f0f/\u7b49\u5f0f","text":"<ol> <li>\u5355\u884c\u7b49\u5f0f\uff1a<code>equation</code>\uff0c\u4e0d\u652f\u6301 <code>\\\\</code> \u6362\u884c\u3002\u9700\u5185\u5d4c <code>split</code> \u5206\u884c\uff0c\u76f8\u5f53\u4e8e <code>$$ ... $$</code> \u52a0 <code>\\\\</code> \u6362\u884c\uff0c\u4f46 equation \u6307\u5b9a\u7684\u516c\u5f0f\u7ec4\u4f1a\u6dfb\u52a0\uff08\u4e00\u4e2a\uff09\u81ea\u52a8\u7f16\u53f7\u3002</li> <li> <p>\u5bf9\u9f50\u7b49\u5f0f\uff1a<code>align</code>\uff08<code>aligned</code>,<code>alignat</code>,<code>alignedat</code>\uff09\uff0c\u9ed8\u8ba4\u53f3\u5bf9\u9f50\uff0c\u53ef\u4f7f\u7528 <code>&amp;</code> \u6307\u5b9a\u5bf9\u9f50\u70b9\uff08\u4f4d\u7f6e\uff09\uff1b<code>gather</code>\uff08<code>gathered</code>\uff09\uff0c\u9ed8\u8ba4\u5c45\u4e2d\u5bf9\u9f50\uff0c\u4e0d\u652f\u6301\u6307\u5b9a\u5bf9\u9f50\u70b9\u3002</p> <ul> <li>align\u3001gather \u4f1a\u81ea\u52a8\u7ed9\u6bcf\u4e00\u884c\u7f16\u53f7\uff0cend \u540e\u53ef\u8ffd\u52a0 <code>\\tag{N}</code>\uff0c\u5ffd\u7565\u81ea\u52a8\u884c\u7f16\u53f7\uff0c\u6307\u5b9a\u516c\u5f0f\u7ec4\u7f16\u53f7\u3002</li> </ul> </li> <li> <p>\u6761\u4ef6\u7b49\u5f0f\uff1a<code>cases</code>\uff08<code>rcases</code>\uff09\uff0c\u4e0d\u4f1a\u81ea\u52a8\u6dfb\u52a0\u7f16\u53f7\uff0c\u652f\u6301\u4f7f\u7528 <code>&amp;</code> \u6307\u5b9a\u5bf9\u9f50\u70b9\u3002</p> </li> </ol>"},{"location":"blog/20221212/2-Markdown-Formula/#\u6570\u7ec4\u77e9\u9635","title":"\u6570\u7ec4/\u77e9\u9635","text":"<ol> <li>\u6570\u7ec4/\u884c\uff1a<code>array</code>\uff0cbegin\u524d\u9762\u53ef\u6dfb\u52a0 <code>\\def\\arraystretch{LINE-SPACE}</code> \u524d\u7f00\u6307\u5b9a\u884c\u95f4\u8ddd\u3002</li> <li>\u77e9\u9635\uff1a<code>matrix</code>\uff0c\u652f\u6301 <code>pmatrix</code>\u3001<code>bmatrix</code>\u3001<code>Bmatrix</code>\u3001<code>vmatrix</code>\u3001<code>Vmatrix</code> \u7b49\u6269\u5c55\u6807\u8bb0\u3002</li> </ol>"},{"location":"blog/20221212/2-Markdown-Formula/#\u683c\u5f0f\u63a7\u5236","title":"\u683c\u5f0f\u63a7\u5236","text":"<ol> <li><code>align</code>\u3001<code>alignat</code>\u3001<code>gather</code> \u53ea\u80fd\u7528\u4e8e Display \u5757\u6a21\u5f0f\uff08 <code>$$...$$</code> \uff09\uff0cInline \u884c\u5185\u6a21\u5f0f\uff08 <code>$...$</code> \uff09\u5f97\u4f7f\u7528 <code>aligned</code>\u3001<code>alignedat</code>\u3001<code>gathered</code> \u3002<ul> <li>To input a numerical LPP, use <code>alignat</code> instead of align to get better alignment between signs, variables and coefficients.</li> </ul> </li> <li>\u5bf9\u4e8e\u516c\u5f0f <code>equation</code>\u3001<code>align</code>\u3001<code>alignat</code>\u3001<code>gather</code> \u81ea\u52a8\u7f16\u53f7\uff0c\u53ef\u5728 ENV \u540d\u79f0\u6dfb\u52a0 <code>*</code> \u5ffd\u7565\u81ea\u52a8\u7f16\u53f7\uff0c\u4f8b\u5982 <code>equation*</code>\u3001<code>align*</code>\u3001<code>gather*</code>\u3002<ul> <li>\u4e5f\u53ef\u4ee5\u901a\u8fc7\u663e\u5f0f\u6307\u5b9a <code>\\nonumber</code> \u6216 <code>\\notag</code> \u6765\u5ffd\u7565\uff08\u67d0\u4e00\u884c\uff09\u81ea\u52a8\u7f16\u53f7\u3002</li> </ul> </li> <li>ENV\u5757\u7ed3\u5c3e\u6dfb\u52a0 <code>\\tag</code> \u6807\u7b7e\u652f\u6301\u8fdb\u884c\u5e8f\u53f7\u6807\u8bb0\u6216\u6587\u5b57\u6ce8\u91ca\uff0c\u5c06\u66ff\u6362\u8986\u76d6\u81ea\u52a8\uff08\u884c\uff09\u7f16\u53f7\u3002\u6ce8\u610f\uff1a\u884c\u5185\u516c\u5f0f\u4e0d\u652f\u6301\u8be5\u6807\u7b7e\uff01<ul> <li><code>align</code>, <code>alignat</code>, <code>gather</code> \u652f\u6301\u4e3a\u6bcf\u4e00\u884c\u81ea\u5b9a\u4e49 <code>\\tag</code>\u3002</li> </ul> </li> </ol>"},{"location":"blog/20221212/2-Markdown-Formula/#\u7a7a\u683c","title":"\u7a7a\u683c","text":"<p>CSDN markdown\u3001vscode markdown\u5185\u7f6e\u9884\u89c8\u63d2\u4ef6\u7b49\u7f16\u8f91\u5668\u4e2d\uff0c\u884c\u5185\u6570\u5b66\u516c\u5f0f\u7684\u7f8e\u5143\u7b26\u53f7\u524d\u540e\u5747\u4e0d\u80fd\u6709\u7a7a\u683c\uff0c\u5426\u5219\u4e0d\u80fd\u6b63\u5e38\u6e32\u67d3\u3002</p> <p>\u5355\u4e2a\u7f8e\u5143\u7b26\u53f7\u548c\u53cc\u7f8e\u5143\u7b26\u53f7\u8de8\u884c\u516c\u5f0f\u5757\u4e2d\u7684\u952e\u76d8\u7a7a\u683c\u5c06\u88ab\u5ffd\u7565\uff0c\u5982\u679c\u60f3\u5728\u516c\u5f0f\u4e2d\u63d2\u5165\u7a7a\u683c\uff0c\u9700\u91c7\u7528\u7279\u6b8a\u7b26\u53f7\u3002</p> <ol> <li>\u65e0\u7a7a\u683c <code>$a b$</code>\uff1a\\(ab\\)</li> <li>\u5c0f\u7a7a\u683c\uff0c\u7b26\u53f7<code>\\,</code>\uff0c\\(a\\,b\\)</li> <li>\u4e2d\u7a7a\u683c\uff0c\u7b26\u53f7 <code>\\:</code>\uff0c\\(a\\:b\\)</li> <li>\u5927\u7a7a\u683c\uff0c\u7b26\u53f7 <code>\\</code>\uff0c\\(a\\ b\\)</li> <li>\u56db\u7a7a\u683c <code>$a \\quad b$</code>\uff1a\\(a \\quad b\\)</li> <li>\u516b\u7a7a\u683c <code>$a \\qquad b$</code>\uff1a\\(a \\qquad b\\)</li> </ol>"},{"location":"blog/20221212/2-Markdown-Formula/#\u8fb9\u754c","title":"\u8fb9\u754c","text":"<p>\u70b9\u79ef\u7b26\u53f7\u4e3a <code>\\cdot</code>\uff0ca\u548cb\u7684\u70b9\u79ef\u5199\u6210 <code>$a\\cdotb$</code> \u5c06\u62a5\u9519\uff0c\u56e0\u4e3a\u53cd\u659c\u6760\u540e\u9762\u90fd\u5c06\u89c6\u4f5c\u7b26\u53f7\u800c\u89e3\u6790\u5931\u8d25\u3002 \u6b64\u65f6\uff0c\u53ef\u5728\u70b9\u79ef\u7b26\u53f7\u7ed3\u675f\u5904\u63d2\u5165\u7a7a\u683c <code>$a\\cdot b$</code>\uff1a\\(a\\cdot b\\)\u3002</p> <p>\u53e6\u5916\u4e00\u79cd\u601d\u8def\u662f\uff0c\u5c06\u53cd\u659c\u6760\u7b26\u53f7\u6574\u4f53\u52a0\u4e0a\u5927\u62ec\u53f7 <code>$a{\\cdot}b$</code> \u5219\u53ef\u6b63\u786e\u89e3\u6790\u4e3a \\(a{\\cdot}b\\)\uff08\u8c8c\u4f3c\u66f4\u7d27\u51d1\uff09\u3002</p> <p>\u5982\u679c\u8981\u7528\u591a\u4e2a\u5b57\u6bcd\u4f5c\u4e3a\u4e0a\u3001\u4e0b\u6807\uff08<code>^</code>\u3001<code>_</code>\uff09\uff0c\u5219\u53ef\u7528\u5927\u62ec\u53f7\u5c06\u591a\u4e2a\u5b57\u6bcd\u62ec\u8d77\u6765\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u811a\u6807\u4f7f\u7528\u3002</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u4fee\u9970","title":"\u4fee\u9970","text":"<ol> <li><code>\\boxed{...}</code> \u652f\u6301\u5c06\u516c\u5f0f\u6dfb\u52a0\u8fb9\u6846\uff1a<code>$\\boxed{e^{i\\pi}+1=0}$</code>\uff08\\(\\boxed{e^{i\\pi}+1=0}\\)\uff09\u3002</li> <li><code>\\color{color} formulae</code> \u652f\u6301\u6307\u5b9a\u540e\u7eed\u516c\u5f0f\u7684\u989c\u8272\uff1a<code>$\\color{blue} F=ma$</code>\uff08\\(\\color{blue} F=ma\\)\uff09\u3002</li> <li><code>\\textcolor{color} {formula}</code> \u652f\u6301\u6307\u5b9a\u540e\u7eed\u5927\u62ec\u53f7\u5185\u7684\u516c\u5f0f\u6587\u672c\u989c\u8272\uff1a<code>$\\textcolor{blue}{F=ma}$</code>\uff08\\(\\textcolor{blue}{F=ma}\\)\uff09\u3002</li> <li><code>\\colorbox{color} {formula}</code> \u652f\u6301\u4e3a\u540e\u7eed\u5927\u62ec\u53f7\u5185\u7684\u516c\u5f0f\u6dfb\u52a0\u80cc\u666f\u989c\u8272\uff1a<code>$\\colorbox{yellow}{F=ma}$</code>\uff08\\(\\colorbox{yellow}{F=ma}\\)\uff09\u3002</li> </ol>"},{"location":"blog/20221212/2-Markdown-Formula/#\u62ec\u53f7","title":"\u62ec\u53f7","text":"<ol> <li>\u4f7f\u7528\u539f\u59cb\u7684\u5c0f\u62ec\u53f7 <code>( )</code> \u3001\u4e2d\u62ec\u53f7 <code>[   ]</code> \u5f97\u5230\u7684\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\u3002</li> <li>\u7531\u4e8e\u5927\u62ec\u53f7 <code>{}</code> \u88ab\u7528\u4e8e\u5206\u7ec4\uff0c\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528 <code>\\lbrace</code> \u548c <code>\\rbrace</code> \u6765\u8868\u793a\u3002</li> <li>\u4f7f\u7528 <code>\\left(</code> \u6216 <code>\\right)</code> \u53ef\u4f7f\u62ec\u53f7\u5927\u5c0f\u4e0e\u5305\u88f9\u5176\u4e2d\u7684\u516c\u5f0f\u5217\u9ad8\u81ea\u52a8\u9002\u5e94\uff08\u9002\u7528\u4e8e\u6240\u6709\u62ec\u53f7\u7c7b\u578b\uff09\u3002</li> </ol> \u6807\u8bb0 \u542b\u4e49 \u793a\u4f8b \u7ad6\u7ebf <code>$\\vert$</code>\u3001<code>$\\mid$</code> \\(a \\vert b\\)\u3001\\(a \\mid b\\) \u95ed\u5408\u5355\u7ad6\u7ebf <code>$\\lvert abs \\rvert$</code> \\(\\lvert abs \\rvert\\) \u95ed\u5408\u53cc\u7ad6\u7ebf <code>$\\lVert v \\rVert$</code> \\(\\lVert v \\rVert\\) \u5c16\u62ec\u53f7 <code>$\\lang  \\rang$</code> \u6216 <code>$\\langle \\rangle$</code> \\(\\lang a \\vert b \\rang\\) \u6216 \\(\\langle a \\mid b \\rangle\\) \u5927\u62ec\u53f7 <code>$\\lbrace \\rbrace$</code> \\(\\lbrace 1,2,3,4,\\ldots \\rbrace\\)"},{"location":"blog/20221212/2-Markdown-Formula/#\u70b9\u53f7","title":"\u70b9\u53f7","text":"\u7b26\u53f7 \u610f\u4e49 \u793a\u4f8b <code>\\cdot</code> / <code>\\sdot</code> / <code>\\cdotp</code> \u4e2d\u70b9 \\(\\vec{c} = \\vec{a} \\cdot \\vec{b}\\) <code>\\ldots</code> / <code>\\dotsc</code> / <code>\\dotso</code> / <code>\\mathellipsis</code> \u5e95\u7aef\u5bf9\u9f50\u7684\u7701\u7565\u53f7 \\(1,2,\\ldots,n\\) <code>\\cdots</code> / <code>\\dots</code> / <code>\\dotsb</code> / <code>\\dotsi</code> / <code>\\dotsm</code> \u4e2d\u7ebf\u5bf9\u9f50\u7684\u7701\u7565\u53f7 \\(x_1^2 + x_2^2 + \\cdots + x_n^2\\) <code>\\vdots</code> \u7ad6\u76f4\u5bf9\u9f50\u7684\u7701\u7565\u53f7 \\(\\vdots\\) <code>\\ddots</code> \u659c\u5bf9\u9f50(\u5de6\u4e0a\u53f3\u4e0b)\u7684\u7701\u7565\u53f7 \\(\\ddots\\) <pre><code>$$f(x_1,x_2,\\underbrace{\\ldots}_{\\rm ldots} ,x_n) = x_1^2 + x_2^2 + \\underbrace{\\cdots}_{\\rm cdots} + x_n^2$$\n</code></pre> \\[f(x_1,x_2,\\underbrace{\\ldots}_{\\rm ldots} ,x_n) = x_1^2 + x_2^2 + \\underbrace{\\cdots}_{\\rm cdots} + x_n^2\\] <p>\u4e0b\u6587\u4e2d\u591a\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\u7684\u7cfb\u6570\u77e9\u9635\uff0c\u5373\u7efc\u5408\u8fd0\u7528\u4e86\u4e2d\u7701\u7565\u53f7\u3001\u7ad6\u7701\u7565\u53f7\u548c\u659c\u5bf9\u9f50\u7701\u7565\u53f7\u3002</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u811a\u6807","title":"\u811a\u6807","text":"<p>\u5bf9\u6570\uff1a<code>$\\log_xy$</code>\uff08\\(\\log_xy\\)\uff09\u3001<code>$\\log_216 = 4$</code>\uff08\\(\\log_216=4\\)\uff09 \u591a\u9879\u5f0f\u4e2dx\u7684\u5e42\uff1a<code>$x^2$</code>\uff08\\(x^2\\)\uff09\u3001<code>$x^{10}$</code>\uff08\\(x^{10}\\)\uff09\u3001<code>$E=mc^2$</code>\uff08\\(E=mc^2\\)\uff09 \u4e0b\u6807\u5e8f\u53f7\uff1a<code>$x_i$</code>\uff08\\(x_i\\)\uff09\u3001<code>$x_{i+1}$</code>\uff08\\(x_{i+1}\\)\uff09\u3001<code>$x_{ij}$</code>\uff08\\(x_{ij}\\)\uff09 \u540c\u65f6\u5b58\u5728\u4e0a\u4e0b\u6807\uff0c\u5148\u5199\u4e0a\u6807\uff08<code>$x^2_i$</code>\uff09\u6216\u5148\u5199\u4e0b\u6807\uff08<code>$x_i^2$</code>\uff09\uff0c\u7ed3\u679c\u90fd\u4e3a \\(x_i^2\\)\u3002</p> <ul> <li>\u6392\u5217\u7ec4\u5408\u6570\u53ef\u4ee5\u5199\u4e3a <code>$C{^k_n}$</code>\uff08\\(C{^k_n}\\)\uff09\u6216 <code>$C{k \\atop n}$</code>\uff08\\(C{k \\atop n}\\)\uff09</li> <li>inner product: <code>$\\lt x \\vert y \\gt = x^Ty$</code>\uff08\\(\\lt x \\vert y \\gt = x^Ty\\)\uff09</li> <li>outer product: <code>$\\lvert x \\gt \\lt y \\rvert =xy^T$</code>\uff08\\(\\lvert x \\gt \\lt y \\rvert =xy^T\\)\uff09</li> <li>\u5706\u9762\u79ef\uff1a<code>$S=\\pi{r^2}$</code>\uff08\\(S=\\pi{r^2}\\)\uff09\uff1b\u5706\u7403\u9762\u79ef\uff1a<code>$S=4\u03c0r^2$</code>\uff08\\(S=4\u03c0r^2\\)\uff09\uff1b\u5706\u7403\u4f53\u79ef\uff1a<code>$V_3\uff1d\\frac{4{\\pi}r^3}{3}$</code>\uff08\\(V_3\uff1d\\frac{4{\\pi}r^3}{3}\\)\uff09\u3002</li> <li>\u6b27\u62c9\u516c\u5f0f\uff1a<code>$e^{i\\theta} = \\cos\\theta + i\u00b7\\sin\\theta$</code>\uff08\\(e^{i\\theta} = \\cos\\theta + i\u00b7\\sin\\theta\\)\uff09\u3001<code>$e^{i\\pi}+1=0$</code>\uff08\\(e^{i\\pi}+1=0\\)\uff09\u3002</li> </ul> <p>\u6ce8\u610f\uff1a\u82e5\u8981\u7528\u591a\u4e2a\u5b57\u6bcd\u4f5c\u4e3a\u811a\u6807\uff0c\u5219\u9700\u8981\u7528\u5927\u62ec\u53f7\u5c06\u591a\u4e2a\u5b57\u6bcd\u62ec\u8d77\u6765\u4f5c\u4e3a\u6574\u4f53\u811a\u6807\u3002</p> <p>\u5982\u679c\u4e0d\u52a0\u5927\u62ec\u53f7\uff0c\u5219\u7b26\u53f7\uff08<code>^</code>\u3001<code>_</code>\uff09\u53ea\u4f1a\u5c06\u7d27\u90bb\u5176\u540e\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u89c6\u4f5c\u811a\u6807\uff0c\u540e\u7eed\u5b57\u6bcd\u5c06\u6e32\u67d3\u4e3a\u666e\u901a\u5b57\u6bcd\uff1a<code>$x^10$</code>\uff08\\(x^10\\)\uff09\u3001<code>$x_ij$</code>\uff08\\(x_ij\\)\uff09\u3002</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u5206\u6570","title":"\u5206\u6570","text":"<p><code>$\\frac md$</code> \u8868\u793a\u5206\u5f0f \\(\\frac md\\)\uff0c\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u662f\u5206\u5b50\uff0c\u7b2c\u4e8c\u4e2a\u5b57\u6bcd\u662f\u5206\u6bcd\u3002</p> <p>\u7528\u5927\u62ec\u53f7\u5c06\u590d\u5408\u5206\u5b50\u3001\u5206\u6bcd\u62ec\u8d77\u6765\uff1a<code>\\frac{5}{3\\times{5}}</code>\uff1a\\(\\frac{5}{3\\times{5}}\\)</p> <p>\u4e5f\u53ef\u4f7f\u7528\u5927\u62ec\u53f7\u5185\u7684 <code>\\over</code> \u5b9e\u73b0\uff1a<code>${a+1 \\over b+1}$</code>\uff1a\\({a+1 \\over b+1}\\)</p> <p>\u5206\u6570\u5e42\u53ca\u7b49\u6548\u7684\u5f00\u65b9\u8868\u793a\uff1a<code>$x^{\\frac 1n} = \\sqrt[n]{x}$</code>\uff08\\(x^{\\frac 1n} = \\sqrt[n]{x}\\)\uff09</p> <p>\u7ec4\u5408\u6570\uff1a<code>${n+1 \\choose 2k}$</code> \u6216 <code>$\\binom{n+1}{2k}$</code>\uff1a\\(C{^k_n} = {k \\choose n} = \\frac{n!}{k!(n-k)!}\\)</p> <p>TeX expr: <code>$C{^k_n} = {k \\choose n} = \\frac{n!}{k!(n-k)!}$</code></p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u6781\u9650","title":"\u6781\u9650","text":"<p><code>$\\lim_{x\\to 0}lnx$</code> \u663e\u793a\u4e3a \\(\\lim_{x\\to 0}lnx\\)\u3002</p> <p>\u81ea\u7136\u5e95\u6570 e \u7684\u5b9a\u4e49\u5f0f\uff1a\\(e = \\lim_{n\\rightarrow+\\infty}(1+\\frac{1}{n})^n = \\lim_{n\\rightarrow+\\infty}(1+\\frac{100\\%}{n})^n\\)</p> <p>TeX expr: <code>$e = \\lim_{n\\rightarrow+\\infty}(1+\\frac{1}{n})^n = \\lim_{n\\rightarrow+\\infty}(1+\\frac{100\\%}{n})^n$</code></p> <p>\u5047\u8bbe\u589e\u957f\u7387\u4e3a\u865a\u6570\u662f\u5426\u6210\u7acb\uff1a\\(e^i = \\lim_{n\\rightarrow+\\infty}(1+\\frac{100\\%\u00b7i}{n})^n\\) \uff1f</p> <p>TeX expr: <code>$e^i = \\lim_{n\\rightarrow+\\infty}(1+\\frac{100\\%\u00b7i}{n})^n$</code></p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u5e0c\u814a\u5b57\u6bcd","title":"\u5e0c\u814a\u5b57\u6bcd","text":"<p>\u5c0f\u5199\u5e0c\u814a\u5b57\u6bcd\uff1a\u4f8b\u5982 <code>$\\gamma$</code> \u663e\u793a\u4e3a \\(\\gamma\\)\uff0c<code>$\\phi$</code>\uff08\\(\\phi\\)\uff09\u3002 \u5927\u5199\u5e0c\u814a\u5b57\u6bcd\uff1a\u9996\u5b57\u6bcd\u5927\u5199\uff0c\u4f8b\u5982 <code>$\\Gamma$</code> \u663e\u793a\u4e3a \\(\\Gamma\\)\uff0c<code>$\\Phi$</code>\uff08\\(\\Phi\\)\uff09\u3002 \u659c\u4f53\u5e0c\u814a\u5b57\u6bcd\uff1a\u52a0\u4e0a <code>var</code> \u524d\u7f00\uff0c\u4f8b\u5982 <code>$\\varGamma$</code> \uff0c\u663e\u793a\u4e3a \\(\\varGamma\\)\uff0c<code>$\\varphi$</code>\uff08\\(\\varphi\\)\uff09\u3002</p> <p>\u53c2\u8003 \u5e0c\u814a\u5b57\u6bcd\u8bfb\u97f3 \u548c \u6570\u5b66\u7b26\u53f7\u53ca\u8bfb\u6cd5\u5927\u5168\u3002</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u9876\u90e8\u7b26\u53f7","title":"\u9876\u90e8\u7b26\u53f7","text":"<ol> <li>\u9876\u90e8\u70b9\uff1a<code>$\\dot x$</code>: \\(\\dot x\\)</li> <li>\u9876\u90e8\u4e24\u70b9\uff1a<code>$\\ddot x$</code>: \\(\\ddot x\\)</li> <li>\u9876\u90e8\u7ad6\u70b9\uff1a<code>$\\dot {\\dot x}$</code>: \\(\\dot {\\dot x}\\)</li> <li>\u9876\u90e8\u6a2a\u7ebf <code>$\\overline x$</code>: \\(\\overline x\\)\uff1b\u5e95\u90e8\u4e0b\u5212\u7ebf <code>$\\underline{x}$</code>\uff1a\\(\\underline{x}\\)</li> <li>\u7528 <code>\\vec{a}</code> \u8868\u793a\u77e2\u91cf a\uff1a<code>$\\vec{c} = \\vec{a} \\cdot \\vec{b}$</code>\uff1a\\(\\vec{c} = \\vec{a} \\cdot \\vec{b}\\)</li> <li>\u7528 <code>\\overrightarrow{a}</code> \u957f\u7bad\u5934\u8868\u793a\u5411\u91cf\uff1a<code>$\\overrightarrow{AB}$</code>\uff1a\\(\\overrightarrow{AB}\\)</li> <li>\u7528 <code>\\hat x</code> \u8868\u793a\u5c16\u5e3d\uff1a<code>$\\hat y=a\\hat x+b$</code>\uff1a\\(\\hat y=a\\hat x+b\\)</li> <li>\u591a\u5b57\u7b26\u53ef\u4ee5\u4f7f\u7528 <code>$\\widehat {xy}$</code>\uff1a\\(\\widehat {xy}\\)</li> <li>\u91c7\u7528\u591a\u4e2a\u7b49\u53f7\u8fde\u63a5\uff0c\u7528 <code>\\!</code> \u51cf\u5c0f\u5176\u95f4\u8ddd\u76f4\u81f3\u95f4\u9699\u6d88\u5931\uff0c\u5b9e\u73b0\u957f\u7b49\u53f7\uff08long equal\uff09\uff1a<code>A =\\!=\\!= B</code>\uff1a\\(A =\\!=\\!= B\\)\u3002</li> <li> <p>\u5728\u4e0a\u4e0b\u7f16\u8f91\u5185\u5bb9\u53ef\u4ee5\u4f7f\u7528 overset/underset \u6216 overunderset\uff1a</p> <ul> <li>\u4e0a\u4e0b\u5206\u5e03\uff1a<code>X\\overset{a}{\\underset{b}{\\to}}Y</code> / <code>X\\overunderset{a}{b}{\\to}Y</code>: \\(X\\overset{a}{\\underset{b}{\\to}}Y\\)</li> <li>\u957f\u7b49\u53f7\u4e0a\u9762\u5199\u5b57\uff08extpfeil - <code>\\xlongequal{n=8}</code>\uff09\uff1a<code>(2^{n-1}-1)-\\lvert X \\rvert \\overset{\\text{n=8}}{=\\!=\\!=} 127-\\lvert -89 \\rvert</code>: \\((2^{n-1}-1)-\\lvert X \\rvert \\overset{\\text{n=8}}{=\\!=\\!=} 127-\\lvert -89 \\rvert\\)</li> </ul> </li> </ol>"},{"location":"blog/20221212/2-Markdown-Formula/#\u5411\u91cf\u5939\u89d2","title":"\u5411\u91cf\u5939\u89d2","text":"<p>\u4e0b\u9762\u8fd9\u6bb5\u6587\u5b57\u9610\u8ff0\u4e86\u57fa\u4e8e\u5411\u91cf\u70b9\u79ef\u548c\u6a21\u63a8\u5bfc\u51fa\u5411\u91cf\u5939\u89d2\u7684\u8fc7\u7a0b\uff0c\u5176\u4e2d\u5305\u62ec\uff1a</p> <ol> <li>\u5e0c\u814a\u5b57\u6bcd\uff1a<code>\\theta</code>\uff08\u03b8\uff09\u3001<code>\\beta</code>\uff08\u03b2\uff09\u3001<code>\\alpha</code>\uff08\u03b1\uff09</li> <li>\u6b63\u4f59\u5f26\u4e09\u89d2\u51fd\u6570\u7b26\u53f7\uff1a<code>\\cos</code>\u3001<code>\\sin</code></li> <li>\u5411\u91cf\u7684\u6a21\uff1a\u53cc\u7ad6\u7ebf <code>{\\lVert}v{\\rVert}</code></li> <li>\u5206\u5f0f\uff1a<code>\\frac{m}{d}</code></li> </ol> <pre><code>\u5411\u91cf $v$ \u548c\u5411\u91cf $w$ \u7684\u5939\u89d2 $\\theta$ \u7684\u4f59\u5f26\u503c $\\cos\\theta = \\frac{v \\cdot w}{{\\lVert}v{\\rVert}{\\lVert}w{\\rVert}}$\n\n\u5bf9\u4e8e\u4e8c\u7ef4\u5411\u91cf\uff0c\u8bbe\u5411\u91cf $v$ \u4e0e x \u8f74\u7684\u5939\u89d2\u4e3a $\\beta$\uff0c\u5411\u91cf $w$ \u4e0e x \u8f74\u7684\u5939\u89d2\u4e3a $\\alpha$\u3002  \n\u540c\u65b9\u5411\u4e0a\u7684\u5355\u4f4d\u5411\u91cf $u_v = \\frac{v}{{\\lVert}v{\\rVert}} = (\\cos\\beta, \\sin\\beta)$, $u_w = \\frac{w}{{\\lVert}w{\\rVert}} =(\\cos\\alpha, \\sin\\alpha)$  \n\u7531\u4f59\u5f26\u5dee\u89d2\u516c\u5f0f\uff1a$\\cos\\theta = \\cos(\\beta-\\alpha)=\\cos\\beta\\cos\\alpha+\\sin\\beta\\sin\\alpha = u_v \\cdot u_w = \\frac{v \\cdot w}{{\\lVert}v{\\rVert}{\\lVert}w{\\rVert}}$\n</code></pre> <p>\u5411\u91cf \\(v\\) \u548c\u5411\u91cf \\(w\\) \u7684\u5939\u89d2 \\(\\theta\\) \u7684\u4f59\u5f26\u503c \\(\\cos\\theta = \\frac{v \\cdot w}{{\\lVert}v{\\rVert}{\\lVert}w{\\rVert}}\\)</p> <p>\u5bf9\u4e8e\u4e8c\u7ef4\u5411\u91cf\uff0c\u8bbe\u5411\u91cf \\(v\\) \u4e0e x \u8f74\u7684\u5939\u89d2\u4e3a \\(\\beta\\)\uff0c\u5411\u91cf \\(w\\) \u4e0e x \u8f74\u7684\u5939\u89d2\u4e3a \\(\\alpha\\)\u3002 \u540c\u65b9\u5411\u4e0a\u7684\u5355\u4f4d\u5411\u91cf \\(u_v = \\frac{v}{{\\lVert}v{\\rVert}} = (\\cos\\beta, \\sin\\beta)\\), \\(u_w = \\frac{w}{{\\lVert}w{\\rVert}} =(\\cos\\alpha, \\sin\\alpha)\\) \u7531\u4f59\u5f26\u5dee\u89d2\u516c\u5f0f\uff1a\\(\\cos\\theta = \\cos(\\beta-\\alpha)=\\cos\\beta\\cos\\alpha+\\sin\\beta\\sin\\alpha = u_v \\cdot u_w = \\frac{v \\cdot w}{{\\lVert}v{\\rVert}{\\lVert}w{\\rVert}}\\)</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u7ebf\u6027\u77e9\u9635","title":"\u7ebf\u6027\u77e9\u9635","text":"<p><code>{matrix}</code> \u6807\u8bc6\u65e0\u8fb9\u6846\u77e9\u9635\u7684\u5f00\u59cb\u548c\u7ed3\u675f\uff0c\u6bcf\u4e00\u884c\u4ee5 <code>\\\\</code> \u7ed3\u5c3e\uff0c\u884c\u95f4\u5143\u7d20\u4ee5 <code>&amp;</code> \u5206\u9694\u3002</p> <p>\u884c\u5185\u77e9\u9635\uff1a\\(\\begin{matrix} 1 &amp; 2 &amp; 3 \\\\ 4 &amp; 5 &amp; 6 \\\\ 7 &amp; 8 &amp; 9 \\end{matrix}\\)</p> <p>TeX expr: <code>$\\begin{matrix} 1 &amp; 2 &amp; 3 \\\\ 4 &amp; 5 &amp; 6 \\\\ 7 &amp; 8 &amp; 9 \\end{matrix}$</code></p> <p>\u8de8\u884c\u77e9\u9635\uff1a</p> <pre><code>$$\n  \\begin{matrix}\n   1 &amp; 2 &amp; 3 \\\\\n   4 &amp; 5 &amp; 6 \\\\\n   7 &amp; 8 &amp; 9\n  \\end{matrix} \\tag{\u65e0\u8fb9\u6846\u77e9\u9635}\n$$\n</code></pre> \\[   \\begin{matrix}    1 &amp; 2 &amp; 3 \\\\    4 &amp; 5 &amp; 6 \\\\    7 &amp; 8 &amp; 9   \\end{matrix} \\tag{\u65e0\u8fb9\u6846\u77e9\u9635} \\] <p>\u5f53\u6570\u5b57\u5bbd\u5ea6\u4e0d\u4e00\u81f4\u65f6\uff0c\u5217\u5411\u9ed8\u8ba4\u662f\u5c45\u4e2d\u5bf9\u9f50\uff0c\u4e5f\u53ef\u5728 <code>matrix</code>\u540e\u9762\u52a0 <code>*</code>\uff0c\u518d\u7528\u4e2d\u62ec\u53f7\u6307\u5b9a\u5217\u5bf9\u9f50\u65b9\u5f0f\uff08<code>[l]</code>\u3001<code>[c]</code>\u3001<code>[r]</code>\uff09\u3002</p> <pre><code>$$\n  \\begin{matrix*}[l]\n   1 &amp; 20 &amp; 300 \\\\\n   40 &amp; 500 &amp; 60 \\\\\n   700 &amp; 8 &amp; 9\n  \\end{matrix*}\n  \\tag{\u5217\u5de6\u5bf9\u9f50}\n$$\n</code></pre> \\[   \\begin{matrix*}[l]    1 &amp; 20 &amp; 300 \\\\    40 &amp; 500 &amp; 60 \\\\    700 &amp; 8 &amp; 9   \\end{matrix*}   \\tag{\u5217\u5de6\u5bf9\u9f50} \\]"},{"location":"blog/20221212/2-Markdown-Formula/#\u8fb9\u6846\u77e9\u9635","title":"\u8fb9\u6846\u77e9\u9635","text":"<p>\u6559\u79d1\u4e66\u4e0a\u4e00\u822c\u4e60\u60ef\u4e66\u5199\u5e26\u6709\u8fb9\u6846\u7684\u77e9\u9635\u3002</p> <ol> <li>\u4e2d\u62ec\u53f7\u5757\uff1a<code>\\left[</code>\u3001<code>\\right]</code></li> </ol> <pre><code>$$\n  \\left[\n  \\begin{matrix}\n   1 &amp; 2 &amp; 3 \\\\\n   4 &amp; 5 &amp; 6 \\\\\n   7 &amp; 8 &amp; 9\n  \\end{matrix}\n  \\right]\n  \\tag{\u4e2d\u62ec\u53f7\u77e9\u9635}\n$$\n</code></pre> \\[   \\left[   \\begin{matrix}    1 &amp; 2 &amp; 3 \\\\    4 &amp; 5 &amp; 6 \\\\    7 &amp; 8 &amp; 9   \\end{matrix}   \\right]   \\tag{\u4e2d\u62ec\u53f7\u77e9\u9635} \\] <ol> <li>\u5927\u62ec\u53f7\u5757\uff1a<code>\\left{</code>\u3001<code>\\right}</code></li> </ol> <pre><code>$$\n  \\left\\{\n  \\begin{matrix}\n   1 &amp; 2 &amp; 3 \\\\\n   4 &amp; 5 &amp; 6 \\\\\n   7 &amp; 8 &amp; 9\n  \\end{matrix}\n  \\right\\}\n  \\tag{\u5927\u62ec\u53f7\u77e9\u9635}\n$$\n</code></pre> \\[   \\left\\{   \\begin{matrix}    1 &amp; 2 &amp; 3 \\\\    4 &amp; 5 &amp; 6 \\\\    7 &amp; 8 &amp; 9   \\end{matrix}   \\right\\}   \\tag{\u5927\u62ec\u53f7\u77e9\u9635} \\]"},{"location":"blog/20221212/2-Markdown-Formula/#\u6269\u5c55\u6807\u8bb0","title":"\u6269\u5c55\u6807\u8bb0","text":"<p>\u4e5f\u53ef\u7528\u4e0b\u5217\u8bcd\u66ff\u6362 <code>matrix</code>\uff1a</p> \u6807\u8bb0 \u542b\u4e49 \u793a\u610f \u793a\u4f8b <code>pmatrix</code> \u5c0f\u62ec\u53f7\u8fb9\u6846 () \\(\\begin{pmatrix} 1 &amp; 2 &amp; 3 \\\\ 4 &amp; 5 &amp; 6 \\\\ 7 &amp; 8 &amp; 9 \\end{pmatrix}\\) <code>bmatrix</code> \u4e2d\u62ec\u53f7\u8fb9\u6846 [] \\(\\begin{bmatrix} 1 &amp; 2 &amp; 3 \\\\ 4 &amp; 5 &amp; 6 \\\\ 7 &amp; 8 &amp; 9 \\end{bmatrix}\\) <code>Bmatrix</code> \u5927\u62ec\u53f7\u8fb9\u6846 {} \\(\\begin{Bmatrix} 1 &amp; 2 &amp; 3 \\\\ 4 &amp; 5 &amp; 6 \\\\ 7 &amp; 8 &amp; 9 \\end{Bmatrix}\\) <code>vmatrix</code> \u5355\u7ad6\u7ebf\u8fb9\u6846 || \\(\\begin{vmatrix} 1 &amp; 2 &amp; 3 \\\\ 4 &amp; 5 &amp; 6 \\\\ 7 &amp; 8 &amp; 9 \\end{vmatrix}\\) <code>Vmatrix</code> \u53cc\u7ad6\u7ebf\u8fb9\u6846 \u2016\u2016 \\(\\begin{Vmatrix} 1 &amp; 2 &amp; 3 \\\\ 4 &amp; 5 &amp; 6 \\\\ 7 &amp; 8 &amp; 9 \\end{Vmatrix}\\)"},{"location":"blog/20221212/2-Markdown-Formula/#\u6570\u7ec4\u9635\u5217","title":"\u6570\u7ec4\u9635\u5217","text":"<p>\u9700\u8981\u501f\u52a9\u4ee5 <code>{array}</code> \u8d77\u59cb\u548c\u7ed3\u675f\u7684\u9635\u5217\u6807\u8bc6\u3002</p> <ul> <li>\u5bf9\u9f50\u65b9\u5f0f\uff1a\u5728 <code>{array}</code> \u540e\u7684 <code>{}</code> \u4e2d\u9010\u5217\u7edf\u4e00\u58f0\u660e</li> <li>\u5de6\u5bf9\u9f50\uff1a<code>l</code>\uff1b\u5c45\u4e2d\uff1a<code>c</code>\uff1b\u53f3\u5bf9\u9f50\uff1a<code>r</code></li> <li>\u7ad6\u76f4\u7ebf\uff1a\u5728\u58f0\u660e\u5bf9\u9f50\u65b9\u5f0f\u65f6\uff0c<code>|</code> \u8868\u793a\u5728\u5217\u4e4b\u95f4\u63d2\u5165\u7ad6\u76f4\u7ebf</li> <li>\u63d2\u5165\u6c34\u5e73\u7ebf\uff1a<code>\\hline</code></li> </ul> <p>\u793a\u4f8b1\uff1a\u589e\u5e7f\u77e9\u9635\uff08enlarged, Augmented\uff09</p> <p><code>cc|c</code> \u8868\u793a\u4e09\u5217\u5c45\u4e2d\u5bf9\u9f50\uff0c\u7b2c\u4e8c\u5217\u548c\u7b2c\u4e09\u5217\u4e4b\u95f4\u63d2\u5165\u7ad6\u7ebf\u5206\u5272\u3002</p> <pre><code>$$\n\\left[\n\\begin{array}  {c c | c} %\u4e09\u5217\u5c45\u4e2d\u5bf9\u9f50\uff0c\u7b2c\u4e8c\u5217\u548c\u7b2c\u4e09\u5217\u4e4b\u95f4\u63d2\u5165\u7ad6\u7ebf\u5206\u5272\n1 &amp; 2 &amp; 3 \\\\ % \u6362\u884c\n4 &amp; 5 &amp; 6\n\\end{array}\n\\right]\n$$\n</code></pre> \\[ \\left[ \\begin{array}  {c c | c} 1 &amp; 2 &amp; 3 \\\\ % \u6362\u884c 4 &amp; 5 &amp; 6 \\end{array} \\right] \\] <p>\u793a\u4f8b2\uff1a\u7b80\u6613\u8868\u683c1</p> <pre><code>$$\n\\begin{array}{c|lll}\n{\u2193}&amp;{a}&amp;{b}&amp;{c}\\\\\n\\hline\n{R_1}&amp;{d}&amp;{e}&amp;{f}\\\\\n{R_2}&amp;{h}&amp;{i}&amp;{j}\\\\\n\\end{array}\n$$\n</code></pre> \\[ \\begin{array}{c|lll} {\u2193}&amp;{a}&amp;{b}&amp;{c}\\\\ \\hline {R_1}&amp;{d}&amp;{e}&amp;{f}\\\\ {R_2}&amp;{h}&amp;{i}&amp;{j}\\\\ \\end{array} \\] <p>\u793a\u4f8b3\uff1a\u7b80\u6613\u8868\u683c2</p> <p><code>c|lcr</code>\u8868\u793a\u7b2c\u4e00\u5217\u5c45\u4e2d\u5bf9\u9f50\uff0c\u7136\u540e\u63d2\u5165\u7ad6\u7ebf\uff0c\u540e\u9762\u4e09\u5217\u5206\u522b\u5de6\u3001\u4e2d\u3001\u53f3\u5bf9\u9f50\u3002</p> <pre><code>$$\n\\begin{array}{c|lcr}\nn &amp; \\text{Left} &amp; \\text{Center} &amp; \\text{Right} \\\\\n\\hline\n1 &amp; 0.24 &amp; 1 &amp; 125 \\\\\n2 &amp; -1 &amp; 189 &amp; -8 \\\\\n3 &amp; -20 &amp; 2000 &amp; 1+10i \\\\\n\\end{array}\n$$\n</code></pre> \\[ \\begin{array}{c|lcr} n &amp; \\text{Left} &amp; \\text{Center} &amp; \\text{Right} \\\\ \\hline 1 &amp; 0.24 &amp; 1 &amp; 125 \\\\ 2 &amp; -1 &amp; 189 &amp; -8 \\\\ 3 &amp; -20 &amp; 2000 &amp; 1+10i \\\\ \\end{array} \\] <p>\u793a\u4f8b4\uff1a\u865a\u7ebf\u5206\u5272</p> <p>\u5c06\u5206\u9694\u7b26\u4ece\u7ad6\u7ebf\uff08<code>|</code>\uff09\u6362\u6210\u5192\u53f7\uff08<code>:</code>\uff09\uff0c\u5219\u7eb5\u5411\u5206\u5272\u7ebf\u53d8\u6210\u865a\u7ebf\uff1b \u6a2a\u5411\u5206\u5272\u7ebf <code>\\hline</code> \u4e3a\u5b9e\u7ebf\uff0c<code>\\hdashline</code> \u4e3a\u865a\u7ebf\u3002 \u5f00\u5934\u7684 <code>\\def\\arraystretch{1.5}</code> \u6307\u5b9a\u884c\u95f4\u8ddd\u3002</p> <pre><code>$$\n\\def\\arraystretch{1.5}\n   \\begin{array}{c:c:c}\n   a &amp; b &amp; c \\\\ \\hline\n   d &amp; e &amp; f \\\\\n   \\hdashline\n   g &amp; h &amp; i\n\\end{array}\n$$\n</code></pre> \\[ \\def\\arraystretch{1.5}    \\begin{array}{c:c:c}    a &amp; b &amp; c \\\\ \\hline    d &amp; e &amp; f \\\\    \\hdashline    g &amp; h &amp; i \\end{array} \\] <p>\u793a\u4f8b5\uff1a\u77e9\u9635\u5206\u5757</p> <p>shape \u4e3a (2,2,4) \u548c (2,4,2) \u76843D\u77e9\u9635\uff0c\u53ef\u4ee5\u75282D\u6570\u7ec4\u8868\u793a\uff0c\u5c06\u7eb5\u6df1\u7b2c\u4e09\u7ef4\u7528\u5206\u5757\u793a\u610f\u3002</p> <pre><code>$x(2,2,4) = \\left[ \\begin{array}{cccc:cccc} 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 \\\\ \\hdashline 8 &amp; 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15 \\\\ \\end{array} \\right] = \\begin{bmatrix} x_0 \\\\ x_1 \\\\ \\end{bmatrix} = \\begin{bmatrix} x_{00} &amp; x_{01} \\\\ x_{10} &amp; x_{11} \\\\ \\end{bmatrix}$\uff0c\u6bcf\u4e00\u5757 $x_{ij}$ \u4ee3\u8868\u7b2c\u4e09\u7ef4\u957f\u5ea6\u4e3a4\u7684\u5411\u91cf\u3002\n\n$y(2,4,2) = \\left[ \\begin{array}{cc:cc:cc:cc} 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 \\\\ \\hdashline 8 &amp; 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15 \\\\ \\end{array} \\right] = \\begin{bmatrix} y_0 \\\\ y_1 \\\\ \\end{bmatrix} = \\begin{bmatrix} y_{00} &amp; y_{01} &amp; y_{02} &amp; y_{03} \\\\ y_{10} &amp; y_{11} &amp; y_{12} &amp; y_{13} \\\\ \\end{bmatrix}$\uff0c\u6bcf\u4e00\u5757 $y_{ij}$ \u4ee3\u8868\u7b2c\u4e09\u7ef4\u957f\u5ea6\u4e3a2\u7684\u5411\u91cf\u3002\n</code></pre> <p>\\(x(2,2,4) = \\left[ \\begin{array}{cccc:cccc} 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 \\\\ \\hdashline 8 &amp; 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15 \\\\ \\end{array} \\right] = \\begin{bmatrix} x_0 \\\\ x_1 \\\\ \\end{bmatrix} = \\begin{bmatrix} x_{00} &amp; x_{01} \\\\ x_{10} &amp; x_{11} \\\\ \\end{bmatrix}\\)\uff0c\u6bcf\u4e00\u5757 \\(x_{ij}\\) \u4ee3\u8868\u7b2c\u4e09\u7ef4\u957f\u5ea6\u4e3a4\u7684\u5411\u91cf\u3002</p> <p>\\(y(2,4,2) = \\left[ \\begin{array}{cc:cc:cc:cc} 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 \\\\ \\hdashline 8 &amp; 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15 \\\\ \\end{array} \\right] = \\begin{bmatrix} y_0 \\\\ y_1 \\\\ \\end{bmatrix} = \\begin{bmatrix} y_{00} &amp; y_{01} &amp; y_{02} &amp; y_{03} \\\\ y_{10} &amp; y_{11} &amp; y_{12} &amp; y_{13} \\\\ \\end{bmatrix}\\)\uff0c\u6bcf\u4e00\u5757 \\(y_{ij}\\) \u4ee3\u8868\u7b2c\u4e09\u7ef4\u957f\u5ea6\u4e3a2\u7684\u5411\u91cf\u3002</p> <p>3D\u6570\u7ec4\uff08\u77e9\u9635\uff09\\(z_{333}\\) \u7684shape\u4e3a(3,3,3)\uff0c\u75282D\u6570\u7ec4\u793a\u610f\u5982\u4e0b\uff08\u5206\u5757\u4e3a\u7b2c\u4e09\u7ef4\u5e73\u94fa\uff09\uff0c\u8fd9\u6837\u65b9\u4fbf\u770b\u51fa\u5176\u5bf9\u89d2\u7ebf\u77e9\u9635\u3002</p> <pre><code>$ z_{333} = \\left[ \\begin{array}{ccc:ccc:ccc} 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 \\\\ \\hline 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15 &amp; 16 &amp; 17 \\\\ \\hline 18 &amp; 19 &amp; 20 &amp; 21 &amp; 22 &amp; 23 &amp; 24 &amp; 25 &amp; 26 \\\\ \\end{array} \\right] $\uff0cdiag = $ \\begin{bmatrix} 0 &amp; 12 &amp; 24 \\\\ 1 &amp; 13 &amp; 25 \\\\ 2 &amp; 14 &amp; 26 \\\\ \\end{bmatrix} $\n</code></pre> <p>\\(z_{333} = \\left[ \\begin{array}{ccc:ccc:ccc} 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 \\\\ \\hdashline 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15 &amp; 16 &amp; 17 \\\\ \\hdashline 18 &amp; 19 &amp; 20 &amp; 21 &amp; 22 &amp; 23 &amp; 24 &amp; 25 &amp; 26 \\\\ \\end{array} \\right]\\)\uff0cdiag = \\(\\begin{bmatrix} 0 &amp; 12 &amp; 24 \\\\ 1 &amp; 13 &amp; 25 \\\\ 2 &amp; 14 &amp; 26 \\\\ \\end{bmatrix}\\)</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u7ebf\u6027\u65b9\u7a0b\u7ec4","title":"\u7ebf\u6027\u65b9\u7a0b\u7ec4","text":"<p>\u8fd9\u91cc\u501f\u52a9\u5de6\u5927\u62ec\u53f7\u5757\u548c <code>{array}</code> \u5206\u7ec4\u8868\u8fbe\u5f0f\u6765\u4e66\u5199\u65b9\u7a0b\u7ec4\uff1a</p> <pre><code>$$\n\\left \\{\n\\begin{array}{c}\na_1x+b_1y+c_1z=d_1 \\\\ \na_2x+b_2y+c_2z=d_2 \\\\ \na_3x+b_3y+c_3z=d_3\n\\end{array}\n\\right.\n$$\n</code></pre> \\[ \\left \\{ \\begin{array}{c} a_1x+b_1y+c_1z=d_1 \\\\  a_2x+b_2y+c_2z=d_2 \\\\  a_3x+b_3y+c_3z=d_3 \\end{array} \\right. \\] <p>\u7ebf\u6027\u65b9\u7a0b\u7ec4\u5bf9\u5e94\u7684\u77e9\u9635\u8868\u8fbe\u5f0f\uff08Matrix equation\uff09\uff1a \\(Ax = b\\)</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4","title":"\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4","text":"<p>\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\uff1a\\(\\left\\{ \\begin{array}{c} x - 2y = 1 \\\\ 3x + 2y = 11 \\end{array} \\right.\\)</p> <p>TeX expr\uff1a<code>$\\left\\{ \\begin{array}{c} x - 2y = 1 \\\\ 3x + 2y = 11 \\end{array} \\right.$</code></p> <p>\u5411\u91cf\u7ebf\u6027\u7ec4\u5408\u7684\u5f62\u5f0f\u5982\u4e0b\uff08column picture\uff09\uff1a</p> <pre><code>$x \\begin{bmatrix} 1 \\\\ 3 \\\\ \\end{bmatrix}$ + $y \\begin{bmatrix} -2 \\\\ 2 \\\\ \\end{bmatrix}$ = $\\begin{bmatrix} 1 \\\\ 11 \\\\ \\end{bmatrix}$\n</code></pre> <p>\\(x \\begin{bmatrix} 1 \\\\ 3 \\\\ \\end{bmatrix}\\) + \\(y \\begin{bmatrix} -2 \\\\ 2 \\\\ \\end{bmatrix}\\) = \\(\\begin{bmatrix} 1 \\\\ 11 \\\\ \\end{bmatrix}\\)</p> <p>\u77e9\u9635\u4e58\u5411\u91cf\u7684\u5f62\u5f0f\u5982\u4e0b\uff08Matrix times Vector\uff09\uff1a</p> <pre><code>$\\begin{bmatrix} 1 &amp; -2 \\\\ 3 &amp; 2 \\\\ \\end{bmatrix}$ $\\begin{bmatrix} x \\\\ y \\\\ \\end{bmatrix}$ = $\\begin{bmatrix} 1 \\\\ 11 \\\\ \\end{bmatrix}$\n</code></pre> <p>\\(\\begin{bmatrix} 1 &amp; -2 \\\\ 3 &amp; 2 \\\\ \\end{bmatrix}\\) \\(\\begin{bmatrix} x \\\\ y \\\\ \\end{bmatrix}\\) = \\(\\begin{bmatrix} 1 \\\\ 11 \\\\ \\end{bmatrix}\\)</p> <p>\u7cfb\u6570\u77e9\u9635\uff08Coefficient matrix\uff09\\(A = \\begin{bmatrix} 1 &amp; -2 \\\\ 3 &amp; 2 \\\\ \\end{bmatrix}\\)\uff0c\u7ed3\u679c\u77e9\u9635 \\(b = \\begin{bmatrix} 1 \\\\ 11 \\\\ \\end{bmatrix}\\)\u3002</p> <ul> <li>\u6ce8\u610f\uff1a\u8fd9\u91cc\u7684 <code>b</code> \u9700\u8981\u8868\u793a\u6210\u6807\u51c6\u76842D column vector\u3002</li> </ul> <p>\u4f7f\u7528 numpy.linalg \u5305\u7684 solve \u51fd\u6570 <code>x = np.linalg.solve(A,b)</code> \u5373\u53ef\u6c42\u89e3\u51fa \\(x = \\begin{bmatrix} 3 \\\\ 1 \\\\ \\end{bmatrix}\\)\u3002</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u4e09\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4","title":"\u4e09\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4","text":"<p>\u4ee5 <code>{cases}</code> \u6807\u8bc6\u4e66\u5199\u65b9\u7a0b\u7ec4\uff08<code>&amp;=</code> \u8bbe\u7f6e = \u5bf9\u9f50\uff09\uff1a</p> <pre><code>$$\n\\begin{cases}\n2x+1y+(-2)z &amp;= -3\\\\\n3x+0y+1z &amp;= 5\\\\\n1x+1y+(-1)z &amp;= -2\\\\\n\\end{cases}\n$$\n</code></pre> \\[ \\begin{cases} 2x+1y+(-2)z &amp;=-3 \\\\ 3x+0y+1z &amp;=5 \\\\ 1x+1y+(-1)z &amp;= -2\\\\ \\end{cases} \\] <p>\u4e5f\u53ef\u4f7f\u7528 <code>alignat</code> \u5b9e\u73b0\u53d8\u91cf\u5bf9\u9f50\uff08<code>*</code>\u5ffd\u7565\u81ea\u52a8\u7f16\u53f7\uff09\u4e66\u5199\u65b9\u7a0b\u7ec4\uff1a</p> <pre><code>$$\n\\left\\{\n\\begin{alignat*}{3.5}\n2&amp;x+&amp;1&amp;y+&amp;(-2)&amp;z = &amp;-3 \\\\\n3&amp;x+&amp;0&amp;y+&amp;1&amp;z = &amp;5 \\\\\n1&amp;x+&amp;1&amp;y+&amp;(-1)&amp;z = &amp;-2\n\\end{alignat*} \n\\right.\n$$\n</code></pre> \\[ \\left\\{ \\begin{alignat*}{3.5} 2&amp;x+&amp;1&amp;y+&amp;(-2)&amp;z = &amp;-3 \\\\ 3&amp;x+&amp;0&amp;y+&amp;1&amp;z = &amp;5 \\\\ 1&amp;x+&amp;1&amp;y+&amp;(-1)&amp;z = &amp;-2 \\end{alignat*}  \\right. \\] <p>\u5411\u91cf\u7ebf\u6027\u7ec4\u5408\u7684\u5f62\u5f0f\u5982\u4e0b\uff08column picture\uff09\uff1a</p> <pre><code>$x \\begin{bmatrix} 2 \\\\ 3 \\\\ 1 \\\\ \\end{bmatrix}$ + $y \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\\\ \\end{bmatrix}$ + $z \\begin{bmatrix} -2 \\\\ 1 \\\\ -1 \\\\ \\end{bmatrix}$ = $\\begin{bmatrix} -3 \\\\ 5 \\\\ -2 \\\\ \\end{bmatrix}$\n</code></pre> <p>\\(x \\begin{bmatrix} 2 \\\\ 3 \\\\ 1 \\\\ \\end{bmatrix}\\) + \\(y \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\\\ \\end{bmatrix}\\) + \\(z \\begin{bmatrix} -2 \\\\ 1 \\\\ -1 \\\\ \\end{bmatrix}\\) = \\(\\begin{bmatrix} -3 \\\\ 5 \\\\ -2 \\\\ \\end{bmatrix}\\)</p> <p>\u77e9\u9635\u4e58\u5411\u91cf\u7684\u5f62\u5f0f\u5982\u4e0b\uff08Matrix times Vector\uff09\uff1a</p> <pre><code>$\\begin{bmatrix} 2 &amp; 1 &amp; -2 \\\\ 3 &amp; 0 &amp; 1 \\\\ 1 &amp; 1 &amp; -1 \\\\ \\end{bmatrix}$ $\\begin{bmatrix} x \\\\ y \\\\ z \\\\ \\end{bmatrix}$ = $\\begin{bmatrix} -3 \\\\ 5 \\\\ -2 \\\\ \\end{bmatrix}$\n</code></pre> <p>\\(\\begin{bmatrix} 2 &amp; 1 &amp; -2 \\\\ 3 &amp; 0 &amp; 1 \\\\ 1 &amp; 1 &amp; -1 \\\\ \\end{bmatrix}\\) \\(\\begin{bmatrix} x \\\\ y \\\\ z \\\\ \\end{bmatrix}\\) = \\(\\begin{bmatrix} -3 \\\\ 5 \\\\ -2 \\\\ \\end{bmatrix}\\)</p> <p>\u7cfb\u6570\u77e9\u9635\uff08Coefficient matrix\uff09\\(A = \\begin{bmatrix} 2 &amp; 1 &amp; -2 \\\\ 3 &amp; 0 &amp; 1 \\\\ 1 &amp; 1 &amp; -1 \\\\ \\end{bmatrix}\\)\uff0c\u7ed3\u679c\u77e9\u9635 \\(b = \\begin{bmatrix} -3 \\\\ 5 \\\\ -2 \\\\ \\end{bmatrix}\\)\u3002</p>"},{"location":"blog/20221212/2-Markdown-Formula/#\u6761\u4ef6\u8868\u8fbe\u5f0f","title":"\u6761\u4ef6\u8868\u8fbe\u5f0f","text":"<p>\u5728\u5b9a\u4e49\u5206\u6bb5\u51fd\u6570\u65f6\uff0c\u7ecf\u5e38\u9700\u8981\u5206\u60c5\u51b5\u7ed9\u51fa\u8868\u8fbe\u5f0f\uff0c\u6b64\u65f6\u53ef\u4f7f\u7528 <code>\\begin{cases}\u2026\\end{cases}</code>\u3002</p> <p>\u4f7f\u7528 <code>&amp;</code> \u6307\u793a\u9700\u8981\u5bf9\u9f50\u7684\u4f4d\u7f6e\u3002</p> <p>\u4ee5\u4e0b\u5b9a\u4e49\u4e86\u5206\u6bb5\u51fd\u6570\uff1a</p> <pre><code>$$\n% abs\nf(x)=\n\\begin{cases}\n        -x, &amp; x&lt;0 \\\\\n        x, &amp; x \\ge 0\n\\end{cases}\n$$\n\n$$\n% i^n\nf(n) = \n\\begin{cases}\n1, &amp;n=4k, k\\in\\mathbb{Z} \\\\\ni, &amp;n=4k+1, k\\in\\mathbb{Z} \\\\\n-1, &amp;n=4k+2, k\\in\\Bbb{Z} \\\\\n-i, &amp;n=4k+3, k\\in\\Bbb{Z}\n\\end{cases}\n$$\n</code></pre> \\[ % abs f(x)= \\begin{cases}         -x, &amp; x&lt;0 \\\\         x, &amp; x \\ge 0 \\end{cases} \\] \\[ % i^n f(n) =  \\begin{cases} 1, &amp;n=4k, \\forall k\\in\\mathbb{Z} \\\\ i, &amp;n=4k+1, \\forall k\\in\\mathbb{Z} \\\\ -1, &amp;n=4k+2, \\forall k\\in\\Bbb{Z} \\\\ -i, &amp;n=4k+3, \\forall k\\in\\Bbb{Z} \\end{cases} \\] <p>\u4e5f\u53ef\u57fa\u4e8e\u5206\u6bb5\u8868\u8fbe\u5f0f\u64b0\u5199\u65b9\u7a0b\u7ec4\uff1a</p> <pre><code>$$\n\\begin{cases}\na_{11}x_1+a_{12}x_2+\\ldots+a_{1n}x_n=0 \\\\\na_{21}x_1+a_{22}x_2+\\ldots+a_{2n}x_n=0 \\\\\n\\qquad \\qquad \\cdots \\qquad \\cdots \\qquad \\cdots \\\\\na_{m1}x_1+a_{m2}x_2+\\ldots+a_{mn}x_n=0 \\\\\n\\end{cases}\n$$\n</code></pre> \\[ \\begin{cases} a_{11}x_1+a_{12}x_2+\\ldots+a_{1n}x_n=0 \\\\ a_{21}x_1+a_{22}x_2+\\ldots+a_{2n}x_n=0 \\\\ \\qquad \\qquad \\vdots \\qquad  \\vdots \\qquad \\vdots \\\\ a_{m1}x_1+a_{m2}x_2+\\ldots+a_{mn}x_n=0 \\\\ \\end{cases} \\] <p>\u7cfb\u6570\u77e9\u9635\uff08Coefficient matrix\uff09\u8868\u793a\u5982\u4e0b\uff0c\u7efc\u5408\u8fd0\u7528\u4e86\u4e2d\u7701\u7565\u53f7\u3001\u7ad6\u7701\u7565\u53f7\u548c\u659c\u5bf9\u9f50\u7701\u7565\u53f7\u3002</p> <pre><code>$$\n\\left[\n\\begin{matrix}\na_{11} &amp; a_{12} &amp; \\cdots &amp; a_{1n} \\\\\na_{21} &amp; a_{22} &amp; \\cdots &amp; a_{2n} \\\\\n\\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\na_{m1} &amp; a_{m2} &amp; \\cdots &amp; a_{mn} \\\\\n\\end{matrix}\n\\right]\n$$\n</code></pre> \\[ \\left[ \\begin{matrix} a_{11} &amp; a_{12} &amp; \\cdots &amp; a_{1n} \\\\ a_{21} &amp; a_{22} &amp; \\cdots &amp; a_{2n} \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ a_{m1} &amp; a_{m2} &amp; \\cdots &amp; a_{mn} \\\\ \\end{matrix} \\right] \\]"},{"location":"blog/20221212/2-Markdown-Formula/#\u67e5\u770b\u516c\u5f0ftex\u547d\u4ee4","title":"\u67e5\u770b\u516c\u5f0fTeX\u547d\u4ee4","text":"<p>right-click on the expression and choose <code>Show Math As &gt; TeX Commands</code> to inspect the MathJax Equation/Original Source. When you do this, the math delimiters(<code>$</code> and <code>$$</code>) will not display.</p> <p>\u5728 stackexchage \u7f51\u9875\u53f3\u952e\u67e5\u770b\u6570\u5b66\u516c\u5f0f\u539f\u59cbKaTeX\u6307\u4ee4\uff1a</p> <p></p> <p>\u5728 CSDN \u535a\u5ba2\u53f3\u952e\u67e5\u770b\u6570\u5b66\u516c\u5f0f\u539f\u59cbKaTeX\u6307\u4ee4\uff1a</p> <p></p> <p>\u5728 github \u5728\u7ebf\u6e32\u67d3\u7684ipynb\u53f3\u952e\u67e5\u770b\u6570\u5b66\u516c\u5f0f\u539f\u59cbKaTeX\u6307\u4ee4\uff1a</p> <p></p>"},{"location":"blog/20221212/2-Markdown-Formula/#cheatsheet","title":"cheatsheet","text":"<p>KaTeX supported functions/symbols: sorted by type, sorted alphabetically.</p> <ul> <li>MathJax basic tutorial and quick reference</li> <li>Writing Mathematic Fomulars in Markdown</li> </ul>"},{"location":"blog/20221212/2-Markdown-Formula/#refs","title":"refs","text":"<p>vscode-markdown-math</p> <p>Markdown \u6570\u5b66\u516c\u5f0f\u4e00\u89c8 markdown\u6570\u5b66\u516c\u5f0f\uff08\u5e38\u7528\u7248\u4ecb\u7ecd\uff09 MathJax \u6570\u5b66\u7b26\u53f7\u4ee5\u53ca\u516c\u5f0f\u5728 Markdown \u4e2d\u7684\u8fd0\u7528 </p> <p>Markdown\u6570\u5b66\u516c\u5f0f\u8bed\u6cd5 markdown math \u6570\u5b66\u516c\u5f0f\u8bed\u6cd5 \u53f2\u4e0a\u6700\u5168Markdown\u7b26\u53f7\u516c\u5f0f\u603b\u7ed3 \u4f7f\u7528Markdown\u8f93\u51faLaTex\u6570\u5b66\u516c\u5f0f </p>"},{"location":"blog/20240319/3-first-glance/","title":"Mkdocs\u521d\u8bc6","text":"<p>MkDocs</p> <ul> <li>@pypi</li> <li>@github</li> </ul> <p>Project documentation with Markdown.</p> <p>MkDocs is a fast, simple and downright gorgeous static site generator that's geared towards building project documentation. Documentation source files are written in Markdown, and configured with a single YAML configuration file. Start by reading the introductory tutorial, then check the User Guide for more information.</p>"},{"location":"blog/20240319/3-first-glance/#pip_install_mkdocs","title":"pip install mkdocs","text":"<p>\u53c2\u8003 User Guide - MkDocs Installation\u3002</p> <p>\u4f7f\u7528 pip \u5b89\u88c5 mkdocs\uff1a</p> <pre><code>$ pip install mkdocs\n</code></pre> <p>\u6267\u884c <code>mkdocs -V</code> \u67e5\u770b\u7248\u672c\uff1a</p> <pre><code>$ mkdocs -V\nmkdocs, version 1.5.3 from /usr/local/lib/python3.10/site-packages/mkdocs (Python 3.10)\n Sites\n</code></pre> <p>\u6267\u884c <code>mkdocs --help</code> \u67e5\u770b\u5e2e\u52a9:</p> <pre><code>$ mkdocs --help\nUsage: mkdocs [OPTIONS] COMMAND [ARGS]...\n\n  MkDocs - Project documentation with Markdown.\n\nOptions:\n  -V, --version         Show the version and exit.\n  -q, --quiet           Silence warnings\n  -v, --verbose         Enable verbose output\n  --color / --no-color  Force enable or disable color and wrapping for the output.\n                        Default is auto-detect.\n  -h, --help            Show this message and exit.\n\nCommands:\n  build      Build the MkDocs documentation\n  get-deps   Show required PyPI packages inferred from plugins in mkdocs.yml\n  gh-deploy  Deploy your documentation to GitHub Pages\n  new        Create a new MkDocs project\n  serve      Run the builtin development server\n</code></pre> <p>\u8be6\u60c5\u53c2\u8003 User Guide - Command Line Interface\u3002</p> <p>If you are using Windows/ubuntu, some of the above commands may not work out-of-the-box.</p> <p>A quick solution may be to preface every Python command with <code>python -m</code> like this:</p> <pre><code>python -m pip install mkdocs\npython -m mkdocs\n</code></pre> <p>For a more permanent solution, you may need to edit your <code>PATH</code> environment variable to include the Scripts directory of your Python installation. Recent versions of Python include a script to do this for you.</p>"},{"location":"blog/20240319/3-first-glance/#mkdocs_new_\u65b0\u5efa\u5de5\u7a0b","title":"mkdocs new \u65b0\u5efa\u5de5\u7a0b","text":"<p>\u5728 ~/Sites \u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2a\u540d\u4e3a <code>mkdocs</code> \u5de5\u7a0b\uff1a</p> <pre><code>$ cd ~/Sites\n$ mkdocs new mkdocs\n</code></pre> <p>\u9ed8\u8ba4\u751f\u6210\u4e86\u6a21\u677f\u6587\u4ef6\uff0c\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>$ tree -L 2 mkdocs\nmkdocs\n\u251c\u2500\u2500 docs\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 index.md\n\u2514\u2500\u2500 mkdocs.yml\n\n2 directories, 2 files\n</code></pre> <ol> <li>docs \u4e0b\u5b58\u653e markdown \u6587\u6863\uff0cindex.md \u4e3a\u9996\u9875\u6846\u67b6\u63cf\u8ff0\uff0c\u53c2\u8003 Index pages\u3002</li> <li>mkdocs.yml \u4e3a\u7f51\u7ad9\u914d\u7f6e\u6587\u4ef6\uff0c\u9ed8\u8ba4\u53ea\u6709\u4e00\u884c\uff1a<code>site_name: My Docs</code>\u3002</li> </ol> <p>\u5173\u4e8e\u914d\u7f6e\u6587\u4ef6\uff0c\u53c2\u8003\u5b98\u7f51 User Guide - Configuration\u3002</p> <p>As a minimum, this configuration file must contain the <code>site_name</code>. All other settings are optional.</p>"},{"location":"blog/20240319/3-first-glance/#mkdocs_serve_\u542f\u52a8\u670d\u52a1","title":"mkdocs serve \u542f\u52a8\u670d\u52a1","text":"<p>\u8fdb\u5165\u65b0\u5efa\u7684\u5de5\u7a0b\u76ee\u5f55\uff1a</p> <pre><code>$ cd mkdocs\n</code></pre> <p>\u6267\u884c serve \u547d\u4ee4\u542f\u52a8\u672c\u5730 web \u670d\u52a1\u5668\uff1a</p> <pre><code>$ mkdocs serve\nINFO    -  Building documentation...\nINFO    -  Cleaning site directory\nINFO    -  Documentation built in 0.09 seconds\nINFO    -  [20:46:56] Watching paths for changes: 'docs', 'mkdocs.yml'\nINFO    -  [20:46:56] Serving on http://127.0.0.1:8000/\n</code></pre> <p>\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 http://localhost:8000\uff0c\u5c31\u53ef\u4ee5\u67e5\u770b\u65b0\u5efa\u7684 mkdocs \u5de5\u7a0b\u4e86\u3002</p>"},{"location":"blog/20240319/3-first-glance/#\u7f16\u5199_markdown_\u6587\u6863","title":"\u7f16\u5199 Markdown \u6587\u6863","text":"<p>\u53c2\u8003 User Guide - Writing your docs\u3002</p> <p>MkDocs pages must be authored in Markdown.</p> <p>Files and directories with names which begin with a dot (for example: .foo.md or .bar/baz.md) are ignored by MkDocs. This can be overridden with the <code>exclude_docs</code> config.</p> <p>Mkdocs \u4f7f\u7528 Markdown \u8bed\u6cd5\u7f16\u5199\u6587\u6863\uff0c\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55\u6587\u672c\u7f16\u8f91\u5668\u8fdb\u884c\u7f16\u8f91\u3002</p> <p>\u5728 docs \u6587\u4ef6\u5939\u4e0b\u65b0\u5efa\u6587\u6863 <code>mkdocs\u4ecb\u7ecd.md</code>\uff0c\u5728\u6d4f\u89c8\u5668\u4e2d\u67e5\u770b\u5b9e\u65f6\u6548\u679c\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\u65b0\u589e\u7684\u6587\u7ae0\u81ea\u52a8\u52a0\u5230\u9996\u9875 site_name \u53f3\u8fb9\uff0c\u6587\u7ae0\u6807\u9898\u9996\u5b57\u6bcd\u81ea\u52a8\u5927\u5199\u3002</p> <p>\u5982\u679c\u5728\u6587\u7ae0\u5f00\u5934\u6dfb\u52a0\u4e00\u7ea7\u6807\u9898 <code># title</code> \u5c06\u66ff\u4ee3\u6587\u7ae0\u6807\u9898\u663e\u793a\u5728\u7f51\u7ad9\u4e0a\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5728 docs \u4e0b\u65b0\u5efa mkdocs \u6587\u4ef6\u5939\uff0c\u5e76\u5c06 <code>mkdocs\u4ecb\u7ecd.md</code> \u79fb\u5165\u5176\u4e2d\u3002</p> <pre><code>$ tree -L 3 .\n.\n\u251c\u2500\u2500 docs\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 index.md\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 mkdocs\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 mkdocs\u4ecb\u7ecd.md\n\u2514\u2500\u2500 mkdocs.yml\n\n3 directories, 3 files\n</code></pre> <p>\u6b64\u65f6\uff0c\u7f51\u7ad9\u84dd\u8272\u5bfc\u822a\u680f\u591a\u4e86\u4e00\u4e2a Mkdocs \u83dc\u5355\u5165\u53e3\uff0c\u70b9\u51fb\u4e0b\u62c9\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7684\u6587\u7ae0\u5217\u8868\u3002</p> <ul> <li>Mkdocs \u5c06\u81ea\u52a8\u6309\u7167\u76ee\u5f55\u7ed3\u6784\uff0c\u751f\u6210\u76f8\u5e94\u7684\u5c42\u53e0\u83dc\u5355\u3002</li> </ul>"},{"location":"blog/20240319/3-first-glance/#refs","title":"refs","text":"<p>EdgeAI Lab</p> <p>Making docs with MkDocs</p> <p>\u4ece\u5934\u6559\u4f60\u7528mkdocs\u6784\u5efa\u4e2a\u4eba\u535a\u5ba2\u7cfb\u7edf</p>"},{"location":"blog/20240320/4-getting-started/","title":"Mkdocs\u4e0a\u624b","text":"<p>Getting Started</p> <p>Install mkdocs, get started with your first documentation project.</p>"},{"location":"blog/20240320/4-getting-started/#site_name__site_url","title":"site_name &amp; site_url","text":"<p>The <code>site_name</code> and <code>site_url</code> configuration options are the only two required options in your configuration file. When you create a new project, the <code>site_url</code> option is assigned the placeholder value: https://example.com. If the final location is known, you can change the setting now to point to it. Or you may choose to leave it alone for now. Just be sure to edit it before you deploy your site to a production server.</p> <p>\u4fee\u6539\u7ad9\u70b9\u540d\u79f0\uff0c\u5e76\u6307\u5b9a URL \u94fe\u63a5\uff1a</p> <pre><code>site_name: \u9003\u8dd1\u8ba1\u5212\nsite_url: https://duetorun.com/\n</code></pre>"},{"location":"blog/20240320/4-getting-started/#adding_pages_to_nav","title":"adding pages to nav","text":"<p>\u53c2\u8003 User Guide - Writing your docs - Configure Pages and Navigation:</p> <p>The <code>nav</code> configuration setting in your mkdocs.yml file defines which pages are included in the global site navigation menu as well as the structure of that menu. If not provided, the navigation will be automatically created by discovering all the Markdown files in the documentation directory. An automatically created navigation configuration will always be sorted alphanumerically by file name (except that index files will always be listed first within a sub-section). You will need to manually define your navigation configuration if you would like your navigation menu sorted differently.</p> <p>All paths in the navigation configuration must be relative to the <code>docs_dir</code> configuration option with default value <code>docs</code>.</p> <p>Any pages not listed in your navigation configuration will still be rendered and included with the built site, however, they will not be linked from the global navigation and will not be included in the previous and next links. Such pages will be \"hidden\" unless linked to directly.</p> <p>As our documentation site will include some navigation headers, you may want to edit the configuration file and add some information about the order, title, and nesting of each page in the navigation header by adding a <code>nav</code> setting.</p> <p>\u6dfb\u52a0 nav \u5bfc\u822a\uff0c\u5bfc\u822a\u680f\u4f9d\u6b21\u662f <code>\u9003\u8dd1\u8ba1\u5212</code>\u3001<code>Home</code>\u3001<code>About</code>\u3002</p> <pre><code>site_name: \u9003\u8dd1\u8ba1\u5212\nsite_url: https://duetorun.com/\n\n# \u9875\u9762\u5bfc\u822a\nnav:\n  - Home: index.md\n  - About: about.md\n</code></pre> <p>\u6dfb\u52a0\u9875\u9762 <code>mkdocs/mkdocs\u4ecb\u7ecd.md</code>\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230\u5bfc\u822a\uff1a</p> <pre><code># \u9875\u9762\u5bfc\u822a\nnav:\n  - Home: index.md\n  - Mkdocs: mkdocs/mkdocs\u4ecb\u7ecd.md\n  - About: about.md\n</code></pre> <p>\u4ee5\u4e0a\u914d\u7f6e\u540e\uff0c\u5728\u5bfc\u822a\u680f\u7684 <code>Home</code> \u548c <code>About</code> \u95f4\u63d2\u5165 <code>Mkdocs</code>\u3002</p> <p>\u5982\u679c\u60f3\u5bfc\u822a\u680f\u6309\u7167\u76ee\u5f55\u5c42\u6b21\u751f\u6210\u5c42\u7ea7\u83dc\u5355\uff0c\u53ef\u4ee5\u5728 nav \u4e2d\u914d\u7f6e\uff1a</p> <pre><code>- Mkdocs:\n  - mkdocs: mkdocs/mkdocs\u4ecb\u7ecd.md\n</code></pre> <p>\u4ee5\u4e0a\u914d\u7f6e\u4e2d\uff0c\u5bfc\u822a\u680f\u4e00\u7ea7\u5165\u53e3 <code>Mkdocs</code>\uff0c\u70b9\u51fb\u4e0b\u62c9\u7684\u6b21\u7ea7\u6587\u7ae0\u6807\u9898\u4e3a <code>mkdocs</code>\u3002 \u4e5f\u53ef\u4f9d\u6b64\u7ee7\u7eed\u914d\u7f6e\u4e09\u7ea7\u3001\u56db\u7ea7\u5c42\u53e0\u83dc\u5355\u3002</p> <p>Note that if a title is defined for a page in the navigation, that title will be used throughout the site for that page and will override any title defined within the page itself.</p> <p>\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6b21\u7ea7\u6807\u9898\uff0c\u9996\u9009\u6587\u9996\u7684\u4e00\u7ea7\u6807\u9898 <code># title</code>\uff0c\u5176\u6b21\u6587\u4ef6\u540d\uff08\u82f1\u6587\u9996\u5b57\u6bcd\u5927\u5199\uff09\u3002</p> <pre><code>  - Mkdocs:\n    - mkdocs/mkdocs\u4ecb\u7ecd.md\n</code></pre> <p>Titles inferred from the contents of the Markdown file or, if no title is defined within the file, of the file name. To override the title in the <code>nav</code> setting add a title right before the filename.</p> <p>Writing with Markdown - Meta-Data:</p> <p>MkDocs will attempt to determine the title of a document in the following ways, in order:</p> <ol> <li>A title defined in the <code>nav</code> configuration setting for a document.</li> <li>A title defined in the <code>title</code> meta-data key of a document.</li> <li>A <code>level 1</code> Markdown header on the first line of the document body.</li> <li>The <code>filename</code> of a document.</li> </ol>"},{"location":"blog/20240320/4-getting-started/#change_theme","title":"change theme","text":"<p>Now change the configuration file to alter how the documentation is displayed by changing the theme. Edit the mkdocs.yml file and add a <code>theme</code> setting:</p> <pre><code>theme: readthedocs\n</code></pre> <p>\u5173\u4e8e\u4e3b\u9898\uff0c\u8be6\u60c5\u53c2\u8003\u5b98\u7f51\u76f8\u5173\u8bf4\u660e\uff1a</p> <ol> <li> <p>Home | Features: Great themes available</p> <p>There's a stack of good looking themes available for MkDocs. Choose between the built in themes: <code>mkdocs</code> and <code>readthedocs</code>, select one of the third-party themes (on the MkDocs Themes wiki page as well as the MkDocs Catalog), or build your own.</p> </li> <li> <p>User Guide \u76f8\u5173\u4e13\u9898\uff1a</p> <ul> <li>Choosing your Theme</li> <li>Customizing Your Theme</li> <li>Localizing Your Theme</li> </ul> </li> </ol>"},{"location":"blog/20240320/4-getting-started/#change_favicon","title":"change Favicon","text":"<p>By default, MkDocs uses the MkDocs favicon icon. To use a different icon, create an <code>img</code> subdirectory in the <code>docs</code> directory and copy your custom <code>favicon.ico</code> file to that directory. MkDocs will automatically detect and use that file as your favicon icon.</p> <p>\u9ed8\u8ba4\u81ea\u52a8\u68c0\u6d4b docs/img/favicon.ico \u4f5c\u4e3a\u56fe\u6807\u3002\u53ef\u81ea\u5df1\u5236\u4f5c\u6216\u7f51\u4e0a\u641c\u7d22\u559c\u6b22\u7684ico\uff0c\u5b58\u653e\u4e3a docs/img/favicon.ico\u3002</p> <p>\u8fd9\u4e2a\u4e0d\u591f\u7075\u6d3b\uff0cmaterial \u4e3b\u9898\u652f\u6301\u6307\u5b9a\u4efb\u610f\u683c\u5f0f\u7684\u56fe\u7247\u6587\u4ef6\u4f5c\u4e3a theme|favicon\u3002</p>"},{"location":"blog/20240320/4-getting-started/#building_the_site","title":"Building the site","text":"<p>Execute <code>mkdocs build</code> to build the documentation. This will create a new directory, named <code>site</code>.</p> <p><code>site</code> \u76ee\u5f55\u5373\u662f mkdocs \u8fd9\u4e2a static site generator \u751f\u6210\uff08generate\uff09\u7684\u9759\u6001\u7f51\u9875\u3002</p> <p>\u53ef\u4ee5\u5c06\u5176\u90e8\u7f72\u5230\u670d\u52a1\u5668\uff0c\u4ee5\u4e0b\u4e3a ubuntu/nginx \u4e0b\u6700\u7b80\u5355\u7684\u672c\u5730\u90e8\u7f72\uff1a</p> <pre><code>$ sudo mv /usr/share/nginx/html/ /usr/share/nginx/html_bak/\n$ sudo ln -s /home/pifan/Sites/mkdocs/site/ /usr/share/nginx/html\n</code></pre>"},{"location":"blog/20240321/5-configuration/","title":"Mkdocs\u914d\u7f6e","text":"<p>User Guide - Configuration</p> <p>Project settings are configured by default using a YAML configuration file in the project directory named mkdocs.yml. You can specify another path for it by using the -f/--config-file option (see mkdocs build --help).</p> <p>As a minimum, this configuration file must contain the <code>site_name</code>. All other settings are optional.</p>"},{"location":"blog/20240321/5-configuration/#documentation_layout","title":"Documentation layout","text":""},{"location":"blog/20240321/5-configuration/#exclude_docs","title":"exclude_docs","text":"<p>New in version 1.5</p> <p>This config defines patterns of files (under\u00a0<code>docs_dir</code>) to not be picked up into the built site.</p> <p>Example:</p> <pre><code>exclude_docs: |\n  api-config.json    # A file with this name anywhere.\n  drafts/            # A \"drafts\" directory anywhere.\n  /requirements.txt  # Top-level \"docs/requirements.txt\".\n  *.py               # Any file with this extension anywhere.\n  !/foo/example.py   # But keep this particular file.\n</code></pre> <p>This follows the\u00a0.gitignore pattern format.</p> <p>Note that\u00a0<code>mkdocs serve</code>\u00a0does\u00a0not\u00a0follow this setting and instead displays excluded documents but with a \"DRAFT\" mark. To prevent this effect, you can run\u00a0<code>mkdocs serve --clean</code>.</p> <p>The following defaults are always implicitly prepended - to exclude dot-files (and directories) as well as the top-level\u00a0<code>templates</code>\u00a0directory:</p> <pre><code>exclude_docs: |\n  .*\n  /templates/\n</code></pre> <p>So, in order to really start this config fresh, you'd need to specify a negated version of these entries first.</p> <p>Otherwise you could for example opt only certain dot-files back into the site:</p> <pre><code>exclude_docs: |\n  !.assets  # Don't exclude '.assets' although all other '.*' are excluded\n</code></pre>"},{"location":"blog/20240321/5-configuration/#not_in_nav","title":"not_in_nav","text":"<p>New in version 1.5</p> <p>Note: This option does\u00a0not\u00a0actually exclude anything from the nav.</p> <p>If you want to include some docs into the site but intentionally exclude them from the nav, normally MkDocs warns about this.</p> <p>Adding such patterns of files (relative to\u00a0<code>docs_dir</code>) into the\u00a0<code>not_in_nav</code>\u00a0config will prevent such warnings.</p> <p>Example:</p> <pre><code>nav:\n  - Foo: foo.md\n  - Bar: bar.md\n\nnot_in_nav: |\n  /private.md\n</code></pre> <p>As the previous option, this follows the .gitignore pattern format.</p> <p>Note: Adding a given file to\u00a0<code>exclude_docs</code>\u00a0takes precedence over and implies\u00a0<code>not_in_nav</code>.</p>"},{"location":"blog/20240322/6-customizing-theme/","title":"Mkdocs\u5b9a\u5236\u4e3b\u9898","text":"<p>User Guide - Customizing Your Theme\u3002</p> <p>Altering a theme to suit your needs.</p> <p>If you would like to make a few tweaks to an existing theme, there is no need to create your own theme from scratch. For minor tweaks which only require some CSS and/or JavaScript, you can use the <code>docs_dir</code>. However, for more complex customizations, including overriding templates, you will need to use the theme <code>custom_dir</code> setting.</p>"},{"location":"blog/20240322/6-customizing-theme/#using_the_docs_dir","title":"Using the docs_dir","text":"<p>The <code>extra_css</code> and <code>extra_javascript</code> configuration options can be used to make tweaks and customizations to existing themes. To use these, you simply need to include either CSS or JavaScript files within your documentation directory.</p> <p>For example, to change the color of the headers in your documentation, create a file called (for example) style.css and place it next to the documentation Markdown. In that file add the following CSS.</p> <pre><code>h1 {\n  color: red;\n}\n</code></pre> <p>Then you need to add it to mkdocs.yml:</p> <pre><code>extra_css:\n  - style.css\n</code></pre> <p>Note: Any extra CSS or JavaScript files will be added to the generated HTML document after the page content. If you desire to include a JavaScript library, you may have better success including the library by using the theme <code>custom_dir</code>.</p>"},{"location":"blog/20240322/6-customizing-theme/#using_the_theme_custom_dir","title":"Using the theme custom_dir","text":"<p>The <code>theme.custom_dir</code> configuration option can be used to point to a directory of files which override the files in a parent theme. The parent theme would be the theme defined in the <code>theme.name</code> configuration option. Any file in the <code>custom_dir</code> with the same name as a file in the parent theme will replace the file of the same name in the parent theme. Any additional files in the <code>custom_dir</code> will be added to the parent theme. The contents of the <code>custom_dir</code> should mirror the directory structure of the parent theme. You may include templates, JavaScript files, CSS files, images, fonts, or any other media included in a theme.</p> <p>Note: For this to work, the <code>theme.name</code> setting must be set to a known installed theme. If the name setting is instead set to null (or not defined), then there is no theme to override and the contents of the <code>custom_dir</code> must be a complete, standalone theme. See the Theme Developer Guide for more information.</p> <p>For example, the mkdocs theme (browse source), contains the following directory structure (in part):</p> <pre><code>- css\\\n- fonts\\\n- img\\\n  - favicon.ico\n  - grid.png\n- js\\\n- 404.html\n- base.html\n- content.html\n- nav-sub.html\n- nav.html\n- toc.html\n</code></pre> <p>To override any of the files contained in that theme, create a new directory next to your <code>docs_dir</code>:</p> <pre><code>mkdir custom_theme\n</code></pre> <p>And then point your <code>mkdocs.yml</code> configuration file at the new directory:</p> <pre><code>theme:\n  name: mkdocs\n  custom_dir: custom_theme/\n</code></pre> <p>To override the 404 error page (\"file not found\"), add a new template file named 404.html to the <code>custom_theme</code> directory. For information on what can be included in a template, review the Theme Developer Guide.</p> <p>To override the favicon, you can add a new icon file at <code>custom_theme/img/favicon.ico</code>.</p> <p>To include a JavaScript library, copy the library to the <code>custom_theme/js/ directory</code>.</p> <p>Your directory structure should now look like this:</p> <pre><code>- docs/\n  - index.html\n- custom_theme/\n  - img/\n    - favicon.ico\n  - js/\n    - somelib.js\n  - 404.html\n- config.yml\n</code></pre> <p>Note: Any files included in the parent theme (defined in name) but not included in the <code>custom_dir</code> will still be utilized. The <code>custom_dir</code> will only override/replace files in the parent theme.</p>"},{"location":"blog/20240323/7-deployment/","title":"Mkdocs\u6784\u5efa\u90e8\u7f72","text":"<p>User Guide:</p> <ul> <li>Command Line Interface</li> <li>Deploying your docs</li> </ul> <p>\u672c\u6587\u68b3\u7406\u4e86 <code>build</code> \u6784\u5efa\u548c <code>gh-deploy</code> \u90e8\u7f72\u547d\u4ee4\u53ca\u90e8\u7f72\u5de5\u4f5c\u6d41\u3002</p>"},{"location":"blog/20240323/7-deployment/#get-deps","title":"get-deps","text":"<p>Show required PyPI packages inferred from plugins in mkdocs.yml</p> <p>Usage: <code>mkdocs get-deps [OPTIONS]</code></p> <p>\u68c0\u67e5\u5f53\u524d mkdocs.yml \u4e2d\u914d\u7f6e\u7684\u63d2\u4ef6\u4f9d\u8d56\u7684 PyPI \u5305\u3002</p> <pre><code>pifan@rpi4b-ubuntu~/Sites/mkdocs $ python3 -m mkdocs get-deps\nmarkdown-checklist\nmkdocs\nmkdocs-material\npymdown-extensions\n</code></pre>"},{"location":"blog/20240323/7-deployment/#serve","title":"serve","text":"<p>Run the builtin development server: <code>mkdocs serve [OPTIONS]</code></p> Name Type Description Default <code>-a</code>, --dev-addr text IP address and port to serve documentation locally (default: localhost:8000) None --no-livereload boolean Disable the live reloading in the development server. False --dirty text Only re-build files that have changed. False <code>-c</code>, --clean text Build the site without any effects of mkdocs serve - pure mkdocs build, then serve. False <code>-w</code>, --watch path A directory or file to watch for live reloading. Can be supplied multiple times. [] <code>-v</code>, --verbose boolean Enable verbose output False <ol> <li>\u9ed8\u8ba4\u7684 IP \u7aef\u53e3\u662f localhost:8000\uff0c\u53ef\u6307\u5b9a <code>-a 0.0.0.0:8000</code>\uff0c\u65b9\u4fbf\u5c40\u57df\u7f51\u8c03\u8bd5\u3002</li> <li>\u6307\u5b9a <code>--dirty</code> \u53ea\u589e\u91cf\u7f16\u8bd1\u6539\u52a8\u7684\u6587\u4ef6\uff0c\u6587\u6863\u89c4\u6a21\u589e\u5927\u540e\uff0c\u6b64\u9879\u53ef\u63d0\u9ad8\u8c03\u8bd5\u65f6\u7684\u5b9e\u65f6\u52a0\u8f7d\u53cd\u9988\u3002</li> </ol>"},{"location":"blog/20240323/7-deployment/#build","title":"build","text":"<p>Build the MkDocs documentation: <code>mkdocs build [OPTIONS]</code></p> Name Type Description Default <code>-c</code>, --clean / --dirty boolean Remove old files from the site_dir before building (the default). True <code>-f</code>, --config-file filename Provide a specific MkDocs config. This can be a file name, or '-' to read from stdin. None <code>-d</code>, --site-dir path The directory to output the result of the documentation build. None <code>-v</code>, --verbose boolean Enable verbose output False <p>\u5173\u4e8e build\u901f\u5ea6 \u95ee\u9898\uff1a</p> <p>mkdocs build \u9ed8\u8ba4\u4f7f\u7528\u4e86 <code>--clean</code> \u9009\u9879\uff0c\u5373\u4f1a\u5728build\u4e4b\u524d\u5220\u6389\u6240\u6709\u4e4b\u524dbuild\u65f6\u521b\u5efa\u7684\u9759\u6001\u6587\u4ef6\uff0c\u5982\u679c\u6587\u6863\u6570\u91cf\u8f83\u591a\uff0c\u6574\u4e2a\u8fc7\u7a0b\u901f\u5ea6\u4f1a\u6bd4\u8f83\u6162\uff0c\u5982\u672c\u7ad9build\u7684\u65f6\u95f4\u7ea6\u4e3a25\u79d2\uff0cbuild\u671f\u95f4\u7f51\u7ad9\u4e0d\u53ef\u4f7f\u7528\u3002\u5982\u679c\u4fee\u6539\u6bd4\u8f83\u9891\u7e41\uff0c\u5219\u6bd4\u8f83\u5f71\u54cd\u4f7f\u7528\u4f53\u9a8c\u3002</p> <p>\u56e0\u6b64\u5bf9\u5927\u578b\u6587\u6863\u7f51\u7ad9\uff0c\u53ea\u5bf9\u90e8\u5206\u9875\u9762\u8fdb\u884c\u4e86\u4fee\u6539\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>mkdocs build --dirty</code>\uff0c\u53eabuild\u4fee\u6539\u4e86\u9875\u9762\uff0c\u901f\u5ea6\u4f1a\u5feb\u5f88\u591a\uff0c\u5982\u672c\u7ad9\u4f7f\u7528 <code>mkdocs build --dirty</code> \u540ebuild\u7684\u65f6\u95f4\u7f29\u77ed\u4e3a\u4e0d\u52302\u79d2\u3002</p> <p>\u5b98\u65b9\u89e3\u91ca:</p> <p>For large sites the build time required to create the pages can become problematic, thus a \"dirty\" build mode was created. This mode simply compares the modified time of the generated HTML and source markdown. If the markdown has changed since the HTML then the page is re-constructed. Otherwise, the page remains as is. It is important to note that this method for building the pages is for development of content only, since the navigation and other links do not get updated on other pages.</p>"},{"location":"blog/20240323/7-deployment/#gh-deploy","title":"gh-deploy","text":"<p>Deploy your documentation to GitHub Pages: <code>mkdocs gh-deploy [OPTIONS]</code></p> Name Type Description Default <code>-c</code>, --clean / --dirty boolean Remove old files from the site_dir before building (the default). True <code>-m</code>, --message text A commit message to use when committing to the GitHub Pages remote branch. Commit {sha} and MkDocs {version} are available as expansions None <code>-b</code>, --remote-branch text The remote branch to commit to for GitHub Pages. This overrides the value specified in config None <code>-r</code>, --remote-name text The remote name to commit to for GitHub Pages. This overrides the value specified in config <code>--no-history</code> boolean Replace the whole Git history with one new commit. False <code>-d</code>, --site-dir path The directory to output the result of the documentation build. None <p>Behind the scenes, MkDocs will build your docs and use the <code>ghp-import</code> tool to commit them to the <code>gh-pages</code> branch and push the gh-pages</p> <p><code>gh-deploy</code> \u547d\u4ee4\u6267\u884c <code>mkdocs build</code>\uff0c\u7136\u540e\u5c06\u751f\u6210\u7684\u9759\u6001\u7f51\u9875 site \u63d0\u4ea4\u5230 <code>gh-pages</code> \u5206\u652f\uff08\u9ed8\u8ba4\u7684 remote-branch\uff09\u3002</p>"},{"location":"blog/20240323/7-deployment/#workflow","title":"workflow","text":"<p>\u5728\u4e3b\u5206\u652f master \u4fee\u6539\u4e86\u6e90\u7801 mkdocs.yml \u548c docs\uff0c\u672c\u5730 serve \u9a8c\u8bc1\u540e\uff0c\u81ea\u884c commit-push \u63d0\u4ea4\u3002</p> <p>build \u4f1a\u751f\u6210 site \u76ee\u5f55\uff0cgh-deploy \u4f1a\u4e0a\u4f20\u5176\u5185\u5bb9\u81f3 gh-pages\u3002 \u5728 .gitignore \u4e2d\u6dfb\u52a0 <code>site/</code>\uff0c\u4f7f master \u5206\u652f\u5ffd\u7565\u4e34\u65f6\u4ea7\u7269\u3002</p> <p>\u63d0\u4ea4\u6d41\u7a0b\uff1a\u5148\u63d0\u4ea4 master\uff0c\u518d\u6267\u884c <code>gh-deploy</code> \u63d0\u4ea4\u5230\u90e8\u7f72\u5206\u652f\u3002</p> <p>gh-deploy \u4f1a\u68c0\u6d4b mkdocs.yml \u914d\u7f6e\u6587\u4ef6\u3002</p> <ol> <li> <p>\u53ef\u91c7\u7528 <code>-m</code> \u81ea\u5b9a\u4e49\u672c\u6b21\u90e8\u7f72\u63d0\u4ea4</p> <ul> <li>\u9ed8\u8ba4\u65e5\u5fd7\u683c\u5f0f\u662f <code>Deployed &lt;master-last-commit-hash&gt; with MkDocs version: 1.5.3</code>\u3002</li> </ul> </li> <li> <p>\u53ef\u901a\u8fc7 <code>-b</code> \u6307\u5b9a\u672c\u6b21\u90e8\u7f72\u63d0\u4ea4\u5206\u652f\uff0c\u4e0b\u6b21\u4e0d\u6307\u5b9a\uff0c\u8fd8\u662f\u63d0\u4ea4\u5230\u9ed8\u8ba4\u5206\u652f <code>gh-pages</code>\u3002</p> </li> <li>\u53ef\u901a\u8fc7 <code>-r</code> \u6307\u5b9a\u672c\u6b21\u90e8\u7f72\u63d0\u4ea4\u4ed3\u5e93\uff0c\u9ed8\u8ba4\u4ed3\u5e93\u662f <code>origin</code>\uff0c\u53ef\u6307\u5b9a <code>upstream</code>\u3002</li> <li><code>--no-history</code> \u6e05\u9664\u90e8\u7f72\u5206\u652f\u65e7\u7684\u63d0\u4ea4\u8bb0\u5f55\uff0c\u4ee5\u6b64\u6b21\u63d0\u4ea4\u4f5c\u4e3a\u90e8\u7f72\u8d77\u70b9\u3002</li> </ol>"},{"location":"blog/20240323/7-deployment/#deploy_to_nginx","title":"deploy to nginx","text":"<p>\u521a\u597d\u4e4b\u524d\u5728 Raspberry Pi 4B/Ubuntu \u4e0a\u7528 nginx \u90e8\u7f72 WebDav \u670d\u52a1\uff0c81 \u7aef\u53e3\u670d\u52a1\u53ea\u4f7f\u7528\u4e86 /webdav \u4e8c\u7ea7\u8def\u7531\uff0c\u53ef\u4ee5\u8003\u8651\u5c06 mkdocs material blog \u6302\u8f7d\u5230\u6839\u8def\u7531\u3002</p> <p>\u5173\u4e8e nginx \u914d\u7f6e\uff0crpi4b-ubuntu\u5b89\u88c5nginx-extras\u5e76\u914d\u7f6eWebDav \u4e2d\u6709\u8be6\u7ec6\u9610\u8ff0\u3002</p> <p>ubuntu \u4e0b\u6267\u884c <code>nginx -V</code> \u53ef\u77e5 nginx \u7684\u9ed8\u8ba4\u5de5\u4f5c\u7a7a\u95f4\u4e3a --prefix=/usr/share/nginx\u3002</p> <p>\u5bf9\u4e8e\u81ea\u542f\u7684\u975e80\u670d\u52a1\uff08\u8fd9\u91cc\u76d1\u542c 81 \u7aef\u53e3\uff09\uff0c<code>location /</code> \u672a\u6307\u5b9a root \u65f6\uff0cDocroot \u9ed8\u8ba4\u4e3a /usr/share/nginx/html\u3002</p> <p>\u8fd9\u91cc\u61d2\u5f97\u4fee\u6539 webdav \u914d\u7f6e\u6587\u4ef6\u4e86\uff0c\u5047\u8bbe\u5de5\u7a0b\u5b58\u50a8\u5728 ~/Sites/mkdocs \u76ee\u5f55\uff0c\u6267\u884c <code>mkdocs build</code> \u751f\u6210\u7684\u9759\u6001\u7ad9\u70b9\u4ea7\u7269\u76ee\u5f55\u4e3a site\uff0c\u90a3\u4e48\u53ea\u9700\u5c06 site \u8f6f\u94fe\u4e3a /usr/share/nginx/html \u5373\u53ef\u5b8c\u6210\u90e8\u7f72\uff0c\u53c2\u8003 \u7528mkdocs+nginx\u642d\u5efa\u4e2a\u4eba\u7f51\u7ad9\u3002</p> <pre><code>$ sudo mv /usr/share/nginx/html/ /usr/share/nginx/html_bak/\n$ sudo ln -s /home/pifan/Sites/mkdocs/site/ /usr/share/nginx/html\n</code></pre> <p>\u5c40\u57df\u7f51\u5185\uff0c\u5728\u6d4f\u89c8\u5668\u8f93\u5165 http://rpi4b-ubuntu.local:81/\uff08\u6216\u4f7f\u7528 IP \u4ee3\u66ff host\uff09\uff0c\u5373\u53ef\u8bbf\u95ee\u535a\u5ba2\u7ad9\u70b9\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u53ef\u81ea\u884c\u8d2d\u4e70 VPS \u5c06\u7ad9\u70b9\u90e8\u7f72\u4e0a\u53bb\uff1b\u6216 \u5c06\u57df\u540d\u4ea4\u7531 cloudflare \u6258\u7ba1\uff0c\u7136\u540e\u521b\u5efa\u4e00\u6761 Cloudflare Zero Trust \u5185\u7f51\u7a7f\u900f\u96a7\u9053\uff08Cloudflare Tunnel\uff09\uff0c\u5c06\u5185\u7f51\u670d\u52a1\uff08blog+webdav\uff09\u66b4\u9732\u5230\u516c\u7f51\u3002</p> Cloudflare Zero TrustCloudflare Tunnelcloudflared <p>Cloudflare Zero Trust provides the power of Cloudflare\u2019s global network to your internal teams and infrastructure. It empowers users with secure, fast, and seamless access to any device on the Internet.</p> <p>Cloudflare Tunnel (formerly Argo Tunnel) establishes a secure outbound connection within your infrastructure to connect applications and machines to Cloudflare.</p> <p>cloudflared is the software powering Cloudflare Tunnel. It runs on origin servers to connect to Cloudflare\u2019s network and on client devices for non-HTTP traffic.</p> <p>Cloudflare Docs - Cloudflare Zero Trust docs - Create a locally-managed tunnel (CLI)</p>"},{"location":"blog/20240324/8-markdown-extensions/","title":"Python-Markdown\u6269\u5c55","text":"<p>User Guide - Writing your docs\u3002</p> <p>MkDocs pages must be authored in Markdown.</p> <p>MkDocs uses the Python-Markdown library to render Markdown documents to HTML.</p> <p>Material for MkDocs - Python Markdown</p>"},{"location":"blog/20240324/8-markdown-extensions/#markdown_extensions","title":"markdown_extensions","text":"<p>MkDocs includes support for extending the Markdown syntax with Python-Markdown extensions. See the MkDocs' markdown_extensions configuration setting for details on how to enable extensions.</p> <p>MkDocs includes some extensions by default, which are highlighted below.</p> <ol> <li>Internal links: <code>toc</code></li> <li>Meta-Data: <code>meta</code></li> <li>Tables: <code>tables</code></li> <li> <p>Fenced code blocks: <code>fenced_code</code></p> <ul> <li>\u8c8c\u4f3c\u9ed8\u8ba4\u4e3b\u9898\u5df2\u5e26\u4ee3\u7801\u9ad8\u4eae\uff0c\u53c2\u8003 Choosing your Theme - mkdocs\u3002</li> </ul> </li> </ol> <p>\u5efa\u8bae\u542f\u7528\u4ee5\u4e0b\u6269\u5c55\uff1a</p> <ol> <li><code>nl2br</code></li> <li><code>sane_lists</code></li> <li><code>footnotes</code></li> <li><code>codehilite</code>: \u9700\u8981\u5b89\u88c5 Pygments</li> </ol>"},{"location":"blog/20240324/8-markdown-extensions/#more_extensions","title":"More extensions","text":"<p>User Guide - Configuration</p> <p>Formatting options | markdown_extensions</p> <p>The Python-Markdown documentation provides a list of extensions which are available out-of-the-box. For a list of configuration options available for a given extension, see the documentation for that extension.</p> <p>You may also install and use various third party extensions (Python-Markdown wiki, MkDocs project catalog). Consult the documentation provided by those extensions for installation instructions and available configuration options.</p>"},{"location":"blog/20240324/8-markdown-extensions/#checklist","title":"checklist","text":"<p>checklist: Adds GitHub-style task lists with checkboxes</p> <p>\u6267\u884c <code>pip install markdown-checklist</code> \u5b89\u88c5\u6269\u5c55\u63d2\u4ef6\uff0c\u7136\u540e\u5728 mkdocs.yml \u4e2d\u5f15\u5165\uff1a</p> <pre><code>markdown_extensions:\n\n   - markdown_checklist.extension\n</code></pre> <ul> <li> undo1</li> <li> undo2</li> <li> done1</li> <li> done2</li> </ul>"},{"location":"blog/20240324/8-markdown-extensions/#yaml_style_meta-data","title":"YAML Style Meta-Data","text":"<p>YAML style meta-data consists of YAML key/value pairs wrapped in YAML style delimiters to mark the start and/or end of the meta-data. The first line of a document must be <code>---</code>. The meta-data ends at the first line containing an end deliminator (either <code>---</code> or <code>...</code>). The content between the delimiters is parsed as YAML.</p> <pre><code>---\ntitle: My Document\nsummary: A brief description of my document.\nauthors:\n    - Waylan Limberg\n    - Tom Christie\ndate: 2018-07-10\nsome_url: https://example.com\n---\nThis is the first paragraph of the document.\n</code></pre> <p>YAML is able to detect data types. Therefore, in the above example, the values of <code>title</code>, <code>summary</code> and <code>some_url</code> are strings, the value of <code>authors</code> is a list of strings and the value of <code>date</code> is a datetime.date object. Note that the YAML keys are case sensitive and MkDocs expects keys to be all lowercase. The top level of the YAML must be a collection of key/value pairs, which results in a Python dict being returned. If any other type is returned or the YAML parser encounters an error, then MkDocs does not recognize the section as meta-data, the page's meta attribute will be empty, and the section is not removed from the document.</p> <p>\u5173\u4e8e metadata \u7684\u6269\u5c55\u4f7f\u7528\u6848\u4f8b\uff0c\u53c2\u8003\uff1a</p> <ul> <li>Mkdocs Material\u4f7f\u7528\u8bb0\u5f55</li> <li>Material for MkDocs\u6539\u52a8\u7684\u51e0\u4e2a\u5730\u65b9</li> </ul>"},{"location":"blog/20240324/8-markdown-extensions/#material_extensions","title":"material extensions","text":"<p>Material for MkDocs - Python Markdown Extensions</p> <p>Material for MkDocs - Reference</p>"},{"location":"blog/20240324/8-markdown-extensions/#tasklist","title":"tasklist","text":"<p>Lists\u3002</p> <p>\u4e0d\u7528\u518d\u5b89\u88c5 <code>markdown-checklist</code>\uff0c\u91c7\u7528 <code>pymdownx.tasklist</code> \u5e73\u66ff\uff0c\u6548\u679c\u533a\u522b\u5982\u4e0b\uff1a</p> <ol> <li>\u524d\u9762\u6ca1\u6709\u65e0\u5e8f\u5217\u8868\u7684 bullet \u70b9\u53f7\uff1b</li> <li>custom_checkbox \u81ea\u5b9a\u4e49\u7eff\u8272\u5706\u5f62\u52fe\u9009\u56fe\u6807\u3002</li> </ol> <pre><code>markdown_extensions:\n  - def_list\n  - pymdownx.tasklist:\n      custom_checkbox: true\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#content_tabs","title":"Content Tabs","text":"<p>Content tabs</p> <p>Sometimes, it's desirable to group alternative content under different tabs, e.g. when describing how to access an API from different languages or environments. Material for MkDocs allows for beautiful and functional tabs, grouping code blocks and other content.</p> <ul> <li>\u8fd9\u91cc\u6d89\u53ca\u5230\u8bbe\u5b9a\u4ee3\u7801\u5757\u6807\u9898\uff1atitle=\"Content Tabs\"\u3002</li> <li>\u6ce8\u610f\u7f29\u8fdb\u3002</li> </ul> Content Tabs<pre><code>=== \"Unordered list\"\n\n    * Sed sagittis eleifend rutrum\n    * Donec vitae suscipit est\n    * Nulla tempor lobortis orci\n\n=== \"Ordered list\"\n\n    1. Sed sagittis eleifend rutrum\n    2. Donec vitae suscipit est\n    3. Nulla tempor lobortis orci\n</code></pre> Unordered listOrdered list <ul> <li>Sed sagittis eleifend rutrum</li> <li>Donec vitae suscipit est</li> <li>Nulla tempor lobortis orci</li> </ul> <ol> <li>Sed sagittis eleifend rutrum</li> <li>Donec vitae suscipit est</li> <li>Nulla tempor lobortis orci</li> </ol>"},{"location":"blog/20240324/8-markdown-extensions/#formatting","title":"Formatting","text":"<p>Formatting</p> <pre><code>markdown_extensions:\n  - pymdownx.critic\n  - pymdownx.caret\n  - pymdownx.mark\n  - pymdownx.tilde\n  - pymdownx.keys\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#critic_markup","title":"Critic Markup","text":"<p>The Critic extension allows for the usage of Critic Markup to highlight <code>added</code>, <code>deleted</code> or <code>updated</code> sections in a document, i.e. for tracking changes in Markdown syntax.</p> Critic DemoCritic Code <p>Text can be deleted and replacement text added. This can also be combined into onea single operation. Highlighting is also possible and comments can be added inline.</p> <p>Formatting can also be applied to blocks by putting the opening and closing tags on separate lines and adding new lines between the tags and the content.</p> <p></p>"},{"location":"blog/20240324/8-markdown-extensions/#highlighting","title":"Highlighting","text":"<p>The Caret, Mark &amp; Tilde extensions add the ability to highlight text and define sub- and superscript using a simple syntax.</p> Highlighting DemoHighlighting Code <ul> <li>This was marked</li> <li>This was inserted</li> <li>This was deleted</li> </ul> <pre><code>- ==This was marked==\n- ^^This was inserted^^\n- ~~This was deleted~~\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#sub__sup","title":"Sub &amp; Sup","text":"<p>When Caret &amp; Tilde are enabled, text can be sub- and superscripted with a simple syntax, which is more convenient than directly using the corresponding <code>sub</code> and <code>sup</code> HTML tags:</p> sub-sup Demosub-sup Code <ul> <li>6CO<sub>2</sub> + 6H<sub>2</sub>O -&gt; C<sub>6</sub>H<sub>12</sub>O<sub>6</sub>[(CH<sub>2</sub>O)<sub>n</sub>] + 6O<sub>2</sub></li> <li>A<sup>T</sup>A</li> </ul> <pre><code>6CO~2~ + 6H~2~O -&gt; C~6~H~12~O~6~[(CH~2~O)~n~] + 6O~2~\nA^T^A\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#keys","title":"Keys","text":"<p>The Keys extension adds a simple syntax to allow for the rendering of keyboard keys and combinations, e.g. Ctrl+Alt+Del. </p> Keys DemoKeys Code <p>Ctrl+Alt+Del \u2303\u2325 \u232b </p> <pre><code>++ctrl+alt+del++\n&lt;kbd&gt;\u2303&lt;/kbd&gt;&lt;kbd&gt;\u2325&lt;/kbd&gt;&lt;kbd&gt; \u232b &lt;/kbd&gt;\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#code_blocks","title":"Code Blocks","text":"<p>Code blocks and examples are an essential part of technical project documentation. Material for MkDocs provides different ways to set up syntax highlighting for code blocks, either during build time using Pygments or during runtime using a JavaScript syntax highlighter.</p> <p>\u5173\u4e8e GitHub \u914d\u7f6e Fenced Code Block \u8bed\u6cd5\u9ad8\u4eae\u6240\u4f7f\u7528\u7684 YAML \u6807\u8bb0 \uff0c\u53ef\u53c2\u8003 \u521d\u63a2YAML\u3001YAML\u5b66\u4e60\u3001YAML\u5b66\u4e60\u603b\u7ed3\u3001YAML--\u60f3\u8981\u7231\u4f60\u5f88\u5bb9\u6613\u3002</p> <p>\u8bed\u8a00\u7c7b\u578b\u6807\u8bb0\u53c2\u8003 linguist/languages.yml \u548c Languages \u2014 Pygments\u3002\u4ee5 Shell Script \u4e3a\u4f8b\uff0c\u8bed\u8a00\u7c7b\u578b\u6807\u8bb0\u53ef\u4ee5\u4e3a shell \u6216 bash\u3002</p> linguistPygments <pre><code>Shell:\n  type: programming\n  color: \"#89e051\"\n  aliases:\n  - sh\n  - shell-script\n  - bash\n  - zsh\n</code></pre> Name Extension(s) Short name(s) Bash .sh, .ksh, .bash, .ebuild, .eclass, .exheres-0, .exlib, .zsh, .bashrc, bashrc, .bash*, bash*, zshrc, .zshrc, .kshrc, kshrc, PKGBUILD bash, sh, ksh, zsh, shell, openrc <p>markdown_extensions \u4e2d\u5f15\u5165 pymdownx \u56db\u5927\u6269\u5c55\uff1a</p> <ul> <li>Highlight</li> <li>InlineHilite</li> <li>SuperFences</li> <li>Snippets</li> </ul> <pre><code>markdown_extensions:\n  - pymdownx.superfences # Supersede fenced_code\n  - pymdownx.highlight: # Supersede fenced_codecodehilite\n      anchor_linenums: true\n      line_spans: __span\n      pygments_lang_class: true\n  - pymdownx.inlinehilite\n  - pymdownx.snippets  # embed external files\n</code></pre> <p>\u5728 theme.features \u4e2d\u6dfb\u52a0\u4ee3\u7801\u590d\u5236\u3001\u884c\u9009\u62e9\u548c\u6298\u53e0\u6ce8\u91ca\u529f\u80fd\u652f\u6301\u3002</p> <pre><code>theme:\n  name: material\n  features:\n    # Code Blocks\n    - content.code.copy # Code Blocks \u4ee3\u7801\u590d\u5236\u6309\u94ae\n    - content.code.select # Code Block \u884c\u9009\u62e9\u6309\u94ae\n    - content.code.annotate # \u6298\u53e0\u6ce8\u91ca(\u9690\u85cf/\u5c55\u5f00)\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u7efc\u5408\u6f14\u793a\u4e86\u4ee3\u7801\u5757\u7684\u529f\u80fd\u652f\u6301\uff1a</p> <ul> <li>Adding a title</li> <li>Show line numbers</li> <li>Highlighting specific lines</li> <li>Adding annotations</li> </ul> Code Blocks DemoCode Blocks Code bubble_sort.py<pre><code>def bubble_sort(items):\n    for i in range(len(items)):\n        for j in range(len(items) - 1 - i):\n            if items[j] &gt; items[j + 1]: # (1)\n                items[j], items[j + 1] = items[j + 1], items[j]\n</code></pre> <ol> <li> I'm a code annotation! I can contain <code>code</code>, formatted     text, images, ... basically anything that can be written in Markdown.</li> </ol> <p>```py title=\"bubble_sort.py\" linenums=\"1\" hl_lines=\"2 3\" def bubble_sort(items): \u2002\u2002\u2002\u2002for i in range(len(items)): \u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002for j in range(len(items) - 1 - i): \u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002if items[j] &gt; items[j + 1]: # (1) \u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002\u2002items[j], items[j + 1] = items[j + 1], items[j] ```</p> <pre><code>1.  :man_raising_hand: I'm a code annotation! I can contain `code`, __formatted\n    text__, images, ... basically anything that can be written in Markdown.\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#mathjax","title":"MathJax","text":"<p>MathJax and KaTeX are two popular libraries for displaying mathematical content in browsers. Although both libraries offer similar functionality, they use different syntaxes and have different configuration options. This documentation site provides information on how to integrate them with Material for MkDocs easily.</p> <p>\u52a0\u5165\u4ee5\u4e0b\u914d\u7f6e\uff0c\u652f\u6301\u6e32\u67d3\u6570\u5b66\u516c\u5f0f\uff0c\u53c2\u8003 Markdown-Formula\u3002</p> <pre><code>markdown_extensions:\n  - pymdownx.arithmatex:\n      generic: true\n\nextra_javascript:\n  - javascripts/mathjax.js\n  - https://polyfill.io/v3/polyfill.min.js?features=es6\n  - https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\n</code></pre> <p>\u6ce8\u610f\uff1a\u8981\u5c06\u811a\u672c\u62f7\u8d1d\u5230\u672c\u5730 docs/javascripts/mathjax.js\u3002</p>"},{"location":"blog/20240324/8-markdown-extensions/#admonitions","title":"Admonitions","text":"<p>Admonitions, also known as call-outs, are an excellent choice for including side content without significantly interrupting the document flow. Material for MkDocs provides several different types of admonitions and allows for the inclusion and nesting of arbitrary content.</p> <pre><code>markdown_extensions:\n  - admonition\n  - pymdownx.details\n  - pymdownx.superfences\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#admonition_box","title":"Admonition Box","text":"<p>\u4ee5\u4e0b\u662f Admonition note \u793a\u4f8b\uff0c\u9ed8\u8ba4\u6807\u9898\u662f <code>Note</code>\u3002</p> <p>\u53ef\u4ee5\u5728 note \u540e\u6307\u5b9a\u81ea\u5b9a\u4e49\u6807\u9898: <code>!!! note \"Pay Attention\"</code> \u4e5f\u53ef\u4ee5\u6307\u5b9a\u6807\u9898\u4e3a\u7a7a\uff0c\u5373\u79fb\u9664\u6807\u9898\uff1a<code>!!! note \"\"</code></p> Admonition DemoAdmonition Code <p>Note</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> Admonition<pre><code>!!! note\n\n    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#collapsible_blocks","title":"Collapsible blocks","text":"<p>When Details is enabled and an admonition block is started with <code>???</code> instead of <code>!!!</code>, the admonition is rendered as a collapsible block with a small toggle on the right side.</p> <p>\u5c06 <code>!!!</code> \u66ff\u6362\u4e3a <code>???</code>\uff0c\u5219\u652f\u6301\u53ef\u6298\u53e0\u5757\uff0c\u70b9\u51fb\u5c55\u5f00\u3002</p> <p>\u5728 <code>???</code> \u540e\u52a0\u4e00\u4e2a <code>+</code>\uff0c\u5219\u9ed8\u8ba4\u5c55\u5f00\u3002</p> Collapsible blocks DemoCollapsible blocks Code Note <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> Collapsible blocks<pre><code>??? note\n\n    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#inline_blocks","title":"Inline blocks","text":"<p>Admonitions can also be rendered as inline blocks (e.g., for sidebars), placing them to the right using the <code>inline</code> + <code>end</code> modifiers, or to the left using only the <code>inline</code> modifier:</p> <p>\u6392\u7248\u633a\u96be\u63a7\u5236\u3002</p> <p>Lorem ipsum</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <pre><code>!!! info inline end \"Lorem ipsum\"\n\n    Lorem ipsum dolor sit amet, consectetur\n    adipiscing elit. Nulla et euismod nulla.\n    Curabitur feugiat, tortor non consequat\n    finibus, justo purus auctor massa, nec\n    semper lorem quam in massa.\n    inline end padding; inline end padding;\n    inline end padding; inline end padding;\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#supported_types","title":"Supported types","text":"<p>Admonitions \u9664\u4e86\u652f\u6301 <code>note</code> \u63d0\u793a\uff0c\u8fd8\u652f\u6301\u4ee5\u4e0b\u63d0\u793a\u7c7b\u578b\uff1a</p> <ul> <li><code>abstract</code>: \u603b\u7ed3</li> <li><code>info</code>\uff1a\u4fe1\u606f</li> <li><code>tip</code>\uff1a\u63d0\u793a</li> <li><code>success</code>\uff1a\u6210\u529f</li> <li><code>question</code>\uff1a\u7591\u95ee</li> <li><code>warning</code>\uff1a\u8b66\u544a</li> <li><code>failure</code>\uff1a\u5931\u8d25</li> <li><code>danger</code>\uff1a\u5371\u9669</li> <li><code>bug</code>\uff1a\u95ee\u9898</li> <li><code>example</code>\uff1a\u793a\u4f8b</li> <li><code>quote</code>\uff1a\u5f15\u7528</li> </ul> noteabstractinfotipsuccessquestionwarningfailuredangerbugexamplequote <p>Note</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Abstract</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Info</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Tip</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Success</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Question</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Warning</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Failure</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Danger</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Bug</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Example</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p> <p>Quote</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla et euismod nulla. Curabitur feugiat, tortor non consequat finibus, justo purus auctor massa, nec semper lorem quam in massa.</p>"},{"location":"blog/20240324/8-markdown-extensions/#grids","title":"Grids","text":"<p>Card grids wrap each grid item with a beautiful hover card that levitates on hover. They come in two slightly different syntaxes: list and block syntax, adding support for distinct use cases.</p> <p>The list syntax is essentially a shortcut for card grids, and consists of an unordered (or ordered) list wrapped by a <code>div</code> with both, the <code>grid</code> and <code>cards</code> classes:</p> Card grid<pre><code>&lt;div class=\"grid cards\" markdown&gt;\n\n- :fontawesome-brands-html5: __HTML__ for content and structure\n- :fontawesome-brands-js: __JavaScript__ for interactivity\n- :fontawesome-brands-css3: __CSS__ for text running out of boxes\n- :fontawesome-brands-internet-explorer: __Internet Explorer__ ... huh?\n\n&lt;/div&gt;\n</code></pre> <ul> <li> HTML for content and structure</li> <li> JavaScript for interactivity</li> <li> CSS for text running out of boxes</li> <li> Internet Explorer ... huh?</li> </ul> Card grid, complex example<pre><code>&lt;div class=\"grid cards\" markdown&gt;\n\n-   :material-clock-fast:{ .lg .middle } __Set up in 5 minutes__\n\n    ---\n\n    Install [`mkdocs-material`](#) with [`pip`](#) and get up\n    and running in minutes\n\n    [:octicons-arrow-right-24: Getting started](#)\n\n-   :fontawesome-brands-markdown:{ .lg .middle } __It's just Markdown__\n\n    ---\n\n    Focus on your content and generate a responsive and searchable static site\n\n    [:octicons-arrow-right-24: Reference](#)\n\n-   :material-format-font:{ .lg .middle } __Made to measure__\n\n    ---\n\n    Change the colors, fonts, language, icons, logo and more with a few lines\n\n    [:octicons-arrow-right-24: Customization](#)\n\n-   :material-scale-balance:{ .lg .middle } __Open Source, MIT__\n\n    ---\n\n    Material for MkDocs is licensed under MIT and available on [GitHub]\n\n    [:octicons-arrow-right-24: License](#)\n\n&lt;/div&gt;\n</code></pre> <ul> <li> <p> Set up in 5 minutes</p> <p>Install <code>mkdocs-material</code> with <code>pip</code> and get up and running in minutes</p> <p> Getting started</p> </li> <li> <p> It's just Markdown</p> <p>Focus on your content and generate a responsive and searchable static site</p> <p> Reference</p> </li> <li> <p> Made to measure</p> <p>Change the colors, fonts, language, icons, logo and more with a few lines</p> <p> Customization</p> </li> <li> <p> Open Source, MIT</p> <p>Material for MkDocs is licensed under MIT and available on [GitHub]</p> <p> License</p> </li> </ul> <p>The block syntax allows for arranging cards in grids together with other elements, as explained in the section on generic grids. Just add the <code>card</code> class to any block element inside a <code>grid</code>:</p> Card grid, blocks<pre><code>&lt;div class=\"grid\" markdown&gt;\n\n:fontawesome-brands-html5: __HTML__ for content and structure\n{ .card }\n\n:fontawesome-brands-js: __JavaScript__ for interactivity\n{ .card }\n\n:fontawesome-brands-css3: __CSS__ for text running out of boxes\n{ .card }\n\n&gt; :fontawesome-brands-internet-explorer: __Internet Explorer__ ... huh?\n\n&lt;/div&gt;\n</code></pre> <p> HTML for content and structure</p> <p> JavaScript for interactivity</p> <p> CSS for text running out of boxes</p> <p> Internet Explorer ... huh?</p> <p>Generic grids allow for arranging arbitrary block elements in a grid, including admonitions, code blocks, content tabs and more. Just wrap a set of blocks by using a <code>div</code> with the <code>grid</code> class:</p> Generic grid<pre><code>&lt;div class=\"grid\" markdown&gt;\n\n=== \"Unordered list\"\n\n    * Sed sagittis eleifend rutrum\n    * Donec vitae suscipit est\n    * Nulla tempor lobortis orci\n\n=== \"Ordered list\"\n\n    1. Sed sagittis eleifend rutrum\n    2. Donec vitae suscipit est\n    3. Nulla tempor lobortis orci\n\n\\`\\`\\` title=\"Content tabs\"\n=== \"Unordered list\"\n\n    * Sed sagittis eleifend rutrum\n    * Donec vitae suscipit est\n    * Nulla tempor lobortis orci\n\n=== \"Ordered list\"\n\n    1. Sed sagittis eleifend rutrum\n    2. Donec vitae suscipit est\n    3. Nulla tempor lobortis orci\n\\`\\`\\`\n\n&lt;/div&gt;\n</code></pre> Unordered listOrdered list <ul> <li>Sed sagittis eleifend rutrum</li> <li>Donec vitae suscipit est</li> <li>Nulla tempor lobortis orci</li> </ul> <ol> <li>Sed sagittis eleifend rutrum</li> <li>Donec vitae suscipit est</li> <li>Nulla tempor lobortis orci</li> </ol> Content tabs<pre><code>=== \"Unordered list\"\n\n    * Sed sagittis eleifend rutrum\n    * Donec vitae suscipit est\n    * Nulla tempor lobortis orci\n\n=== \"Ordered list\"\n\n    1. Sed sagittis eleifend rutrum\n    2. Donec vitae suscipit est\n    3. Nulla tempor lobortis orci\n</code></pre>"},{"location":"blog/20240324/8-markdown-extensions/#embed-pdf","title":"embed-pdf","text":"<p>\u524d\u7aef\u9884\u89c8PDF\u603b\u7ed3\uff1aiframe\u3001embed\u3001PDFObject\u3001PDF.js \u8fd9\u5c06\u662f\u4f60\u770b\u5230\u8fc7\u6700\u5168\u7684pdf\u9884\u89c8\u89e3\u51b3\u65b9\u6848 \u524d\u7aef\u5b9e\u73b0 PDF \u9884\u89c8\u7684\u5e38\u89c1\u65b9\u6848</p> <p>\u5728\u914d\u7f6e\u6587\u4ef6 mkdocs.yml \u7684 extra_javascript: \u90e8\u5206\u5bfc\u5165 javascripts/embed-pdf.js\uff0c\u7136\u540e\u5728 markdown \u6587\u4ef6\u4e2d\u5185\u5d4c iframe \u6807\u7b7e\uff1a</p> <pre><code>&lt;iframe src=\"./test.pdf\" height=\"900px;\" width=\"100%\"&gt;&lt;/iframe&gt;\n</code></pre>"},{"location":"blog/20240325/9-mkdocs-material-theme/","title":"\u91c7\u7528Material\u4e3b\u9898","text":"<p>Material for MkDocs</p> <p>Documentation that simply works</p> <p>Material for MkDocs is a powerful documentation framework on top of MkDocs, a static site generator for project documentation.</p>"},{"location":"blog/20240325/9-mkdocs-material-theme/#\u5b89\u88c5_mkdocs-material","title":"\u5b89\u88c5 mkdocs-material","text":"<p>Getting started - Installation</p> <pre><code>$ pip install mkdocs-material\n# or \n$ pip3 install mkdocs-material\n# or \n$ python3 -m pip install mkdocs-material\n</code></pre>"},{"location":"blog/20240325/9-mkdocs-material-theme/#\u8bbe\u7f6e\u4e3b\u9898\u4e3a_material","title":"\u8bbe\u7f6e\u4e3b\u9898\u4e3a material","text":"<p>Getting started - Creating your site - Configuration</p> <p>Minimal configuration\uff1a</p> <p>\u5728 mkdocs.yml \u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6307\u5b9a\u4e3b\u9898 material\uff0c\u66ff\u6362\u9ed8\u8ba4\u7684 mkdocs \u4e3b\u9898\uff1a</p> <pre><code># \u6307\u5b9a\u4e3b\u9898\ntheme:\n  name: material\n</code></pre>"},{"location":"blog/20240325/9-mkdocs-material-theme/#setup__customization","title":"Setup &amp; Customization","text":"<p>Advanced configuration: </p> <p>Material for MkDocs comes with many configuration options. The Setup section explains in great detail how to configure and customize colors, fonts, icons and much more</p> <ol> <li>Site structure</li> <li>Appearance</li> <li>Content</li> <li>Optimization</li> </ol> <p>Getting started - Customization</p> <ol> <li>Adding assets</li> <li>Extending the theme</li> <li>Theme development</li> </ol>"},{"location":"blog/20240325/9-mkdocs-material-theme/#\u53c2\u8003\u501f\u9274","title":"\u53c2\u8003\u501f\u9274","text":"<p>Stackoverflow - Questions tagged mkdocs-material</p> <p>Migrating my blog from Jekyll Minimal Mistakes to Mkdocs Material @github</p> <p>claassen.net - Blogging with mkdocs</p> <p>\u4f7f\u7528 MkDocs \u548c Material \u4e3b\u9898\u642d\u5efa\u6280\u672f\u535a\u5ba2 @github</p> <p>\u57fa\u4e8e Material for MkDocs \u642d\u5efa\u9759\u6001\u7f51\u9875 @github</p> <p>\u628a\u535a\u5ba2\u751f\u6210\u5668\u4ece Hugo \u8fc1\u79fb\u5230 Mkdocs @github</p> <p>Mkdocs Material\u4f7f\u7528\u8bb0\u5f55 - \u8be6\u5c3d\u8bb0\u5f55 @github</p> <p>\u5feb\u6765\u7f8e\u5316\u4f60\u7684MKDocs\u5427 - material \u914d\u7f6e</p> <p>Material for MkDocs\u6539\u52a8\u7684\u51e0\u4e2a\u5730\u65b9</p>"},{"location":"blog/20191205/python-argparse/","title":"python\u4e4b\u8fd0\u884c\u53c2\u6570\u89e3\u6790(argparse)","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 python \u811a\u672c\u8fd0\u884c\u53c2\u6570\u89e3\u6790\uff08argparse\uff09\u3002</p> <p>10.3. Command Line Arguments </p> <p>argparse \u2014 Parser for command-line options, arguments and sub-commands</p> <p>argparse Argparse Tutorial </p> <p>How to Build Command Line Interfaces in Python With argparse </p>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#argparse_vs_optparse","title":"argparse vs. optparse","text":"<p>Why use argparse rather than optparse?</p> <p>Python\u4e2doptparse(2.7\u7248\u672c\u540e\u5c06\u88ab\u79fb\u9664)\u8f6c\u5230argparse Python \u7684\u547d\u4ee4\u884c\u53c2\u6570\u5904\u7406 optparse-&gt;argparse </p>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#argparse-\u547d\u4ee4\u884c\u4e0e\u53c2\u6570\u89e3\u6790","title":"argparse-\u547d\u4ee4\u884c\u4e0e\u53c2\u6570\u89e3\u6790","text":"<p>argparse \u2014 \u547d\u4ee4\u884c\u9009\u9879\u3001\u53c2\u6570\u548c\u5b50\u547d\u4ee4\u7684\u89e3\u6790\u5668</p> <p>Python\u4e2d\u6700\u597d\u7528\u7684\u547d\u4ee4\u884c\u53c2\u6570\u89e3\u6790\u5de5\u5177 </p>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#argumentparser","title":"ArgumentParser","text":"<p>\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 ArgumentParser \u5bf9\u8c61\u3002\u6240\u6709\u7684\u53c2\u6570\u5e94\u8be5\u4ee5\u5173\u952e\u5b57\u53c2\u6570\u4f20\u9012\u3002 \u4e0b\u9762\u6709\u5bf9\u6bcf\u4e2a\u53c2\u6570\u5404\u81ea\u8be6\u7ec6\u7684\u63cf\u8ff0\uff0c\u4f46\u662f\u7b80\u77ed\u5730\u8bb2\u5b83\u4eec\u662f\uff1a</p> <ul> <li>prog - \u7a0b\u5e8f\u7684\u540d\u5b57\uff08\u9ed8\u8ba4\uff1asys.argv[0]\uff09  </li> <li>usage - \u63cf\u8ff0\u7a0b\u5e8f\u7528\u6cd5\u7684\u5b57\u7b26\u4e32\uff08\u9ed8\u8ba4\uff1a\u4ece\u89e3\u6790\u5668\u7684\u53c2\u6570\u751f\u6210\uff09  </li> <li>description - \u53c2\u6570\u5e2e\u52a9\u4fe1\u606f\u4e4b\u524d\u7684\u6587\u672c\uff08\u9ed8\u8ba4\uff1a\u7a7a\uff09  </li> <li>epilog - \u53c2\u6570\u5e2e\u52a9\u4fe1\u606f\u4e4b\u540e\u7684\u6587\u672c\uff08\u9ed8\u8ba4\uff1a\u7a7a\uff09  </li> <li>parents - ArgumentParser \u5bf9\u8c61\u7684\u4e00\u4e2a\u5217\u8868\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u7684\u53c2\u6570\u5e94\u8be5\u5305\u62ec\u8fdb\u53bb  </li> <li>formatter_class - \u5b9a\u5236\u5316\u5e2e\u52a9\u4fe1\u606f\u7684\u7c7b  </li> <li>prefix_chars - \u53ef\u9009\u53c2\u6570\u7684\u524d\u7f00\u5b57\u7b26\u96c6\uff08\u9ed8\u8ba4\uff1a\u2018-\u2018\uff09  </li> <li>fromfile_prefix_chars - \u989d\u5916\u7684\u53c2\u6570\u5e94\u8be5\u8bfb\u53d6\u7684\u6587\u4ef6\u7684\u524d\u7f00\u5b57\u7b26\u96c6\uff08\u9ed8\u8ba4\uff1aNone\uff09  </li> <li>argument_default - \u53c2\u6570\u7684\u5168\u5c40\u9ed8\u8ba4\u503c\uff08\u9ed8\u8ba4\uff1aNone\uff09  </li> <li>conflict_handler - \u89e3\u51b3\u51b2\u7a81\u7684\u53ef\u9009\u53c2\u6570\u7684\u7b56\u7565\uff08\u901a\u5e38\u6ca1\u6709\u5fc5\u8981\uff09  </li> <li>add_help - \u7ed9\u89e3\u6790\u5668\u6dfb\u52a0-h/\u2013help \u9009\u9879\uff08\u9ed8\u8ba4\uff1aTrue\uff09  </li> </ul> <p>\u9ed8\u8ba4 add_help = True\uff0c\u4f1a\u6dfb\u52a0\u4e00\u4e2a <code>-h/--help</code> \u9009\u9879\u3002</p> <p>\u6bd4\u8f83\u5e38\u7528\u7684\u662f description \u548c epilog\u3002</p>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#formatter_class","title":"formatter_class","text":"<p>Python argparse: How to insert newline in the help text?</p> <pre><code>formatter_class=argparse.RawTextHelpFormatter\n</code></pre>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#add_argument","title":"add_argument()","text":"<p>ArgumentParser.add_argument \u65b9\u6cd5\u5b9a\u4e49\u5e94\u8be5\u5982\u4f55\u89e3\u6790\u4e00\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\u3002</p> <p>\u4e0b\u9762\u6bcf\u4e2a\u53c2\u6570\u6709\u5b83\u4eec\u81ea\u5df1\u8be6\u7ec6\u7684\u63cf\u8ff0\uff0c\u7b80\u5355\u5730\u8bb2\u5b83\u4eec\u662f\uff1a</p> <ul> <li>name or flags - \u9009\u9879\u5b57\u7b26\u4e32\u7684\u540d\u5b57\u6216\u8005\u5217\u8868\uff0c\u4f8b\u5982 <code>foo</code> \u6216\u8005 <code>-f</code>, <code>--foo</code>\u3002  </li> <li>action - \u5728\u547d\u4ee4\u884c\u9047\u5230\u8be5\u53c2\u6570\u65f6\u91c7\u53d6\u7684\u57fa\u672c\u52a8\u4f5c\u7c7b\u578b\u3002  </li> <li>nargs - \u5e94\u8be5\u8bfb\u53d6\u7684\u547d\u4ee4\u884c\u53c2\u6570\u6570\u76ee\u3002  </li> <li>const - \u67d0\u4e9baction\u548cnargs\u9009\u9879\u8981\u6c42\u7684\u5e38\u6570\u503c\u3002  </li> <li>default - \u5982\u679c\u547d\u4ee4\u884c\u4e2d\u6ca1\u6709\u51fa\u73b0\u8be5\u53c2\u6570\u65f6\u7684\u9ed8\u8ba4\u503c\u3002  </li> <li>type - \u547d\u4ee4\u884c\u53c2\u6570\u5e94\u8be5\u88ab\u8f6c\u6362\u6210\u7684\u7c7b\u578b\u3002  </li> <li>choices - \u53c2\u6570\u53ef\u5141\u8bb8\u7684\u503c\u7684\u4e00\u4e2a\u5bb9\u5668\u3002  </li> <li>required - \u8be5\u547d\u4ee4\u884c\u9009\u9879\u662f\u5426\u53ef\u4ee5\u7701\u7565\uff08\u53ea\u9488\u5bf9\u53ef\u9009\u53c2\u6570\uff09\u3002  </li> <li>help - \u53c2\u6570\u7684\u7b80\u77ed\u63cf\u8ff0\u3002  </li> <li>metavar - \u53c2\u6570\u5728\u5e2e\u52a9\u4fe1\u606f\u4e2d\u7684\u540d\u5b57\u3002  </li> <li>dest - \u7ed9 parse_args() \u8fd4\u56de\u7684\u5bf9\u8c61\u8981\u6dfb\u52a0\u7684\u5c5e\u6027\u540d\u79f0\u3002  </li> </ul>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#version","title":"version","text":"<p>\u6700\u65b0\u7684 argparser \u4e0d\u652f\u6301\u76f4\u63a5\u8d4b\u503c <code>.version = '1.0'</code>\uff0c\u800c\u662f\u901a\u8fc7 <code>--version</code> \u6307\u5b9a\u3002</p> <p>Python's argparse to show program's version with prog and version string formatting</p> <p>\u4ee5\u4e0b\u662f\u5b98\u7f51\u793a\u4f8b\uff1a</p> <pre><code>import argparse\nparser = argparse.ArgumentParser(prog='PROG')\nparser.add_argument('--version', action='version', version='%(prog)s 2.0')\nparser.parse_args(['--version'])\nPROG 2.0\n</code></pre>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#name_or_flags","title":"Name or Flags","text":"<p>Setting the Name or Flags of the Arguments</p> <p>The first arguments passed to <code>add_argument()</code> must therefore be either a series of flags, or a simple argument name. </p> <p>For example, an optional argument could be created like:</p> <pre><code>parser.add_argument('-f', '--foo')\n</code></pre> <p>while a positional argument could be created like:</p> <pre><code>parser.add_argument('bar')\n</code></pre> <p>There are basically two different types of arguments that you can add to your command line interface:</p> <ol> <li>Positional arguments  </li> <li>Optional arguments  </li> </ol> <p>Positional arguments are the ones your command needs to operate. -- <code>required=True</code></p> <p>In the previous example, the argument <code>path</code> was a positional argument, and our program couldn\u2019t work without it. They are called positional because their position defines their function.</p> <p>For example, consider the cp command on Linux (or the copy command in Windows).  Here\u2019s the standard usage:</p> <pre><code>faner@FAN-MB1 (master)\u2717 [64] % cp -h\ncp: illegal option -- h\nusage: cp [-R [-H | -L | -P]] [-fi | -n] [-apvXc] source_file target_file\n       cp [-R [-H | -L | -P]] [-fi | -n] [-apvXc] source_file ... target_directory\n</code></pre> <p>The first positional argument after the <code>cp</code> command is the source of the file you\u2019re going to copy. The second one is the destination where you want to copy it.  </p> <p>Optional arguments are not mandatory, and when they are used they can modify the behavior of the command at runtime. In the <code>cp</code> example, an optional argument is, for example, the <code>-R</code> flag, which makes the command copy directories recursively.</p> <p>Syntactically, the difference between positional and optional arguments is that optional arguments start with <code>-</code> or <code>--</code>, while positional arguments don\u2019t.</p> <p>To add an optional argument, you just need to call <code>.add_argument()</code> again and name the new argument with a starting <code>-</code>.</p> <p>\u4f4d\u7f6e\u53c2\u6570\u4e00\u822c\u5728\u524d\uff0c\u4e3a\u666e\u901a\u5355\u8bcd\uff0c\u4e3a\u5fc5\u586b\uff1b\u53ef\u9009\u53c2\u6570\u4e00\u822c\u5728\u540e\uff0c\u77ed\u7ebf\u5b57\u6bcd\u6216\u53cc\u77ed\u7ebf\u5355\u8bcd\u683c\u5f0f\uff08-c, --count\uff09\uff0c\u53ef\u4e0d\u586b\u3002</p> <p>test_argparse.py \u4e2d\u7684 <code>logpath</code> \u4e3a\u4f4d\u7f6e\u53c2\u6570\uff1b <code>-p/--platform</code> \u4e3a\u53ef\u9009\u53c2\u6570\u3002</p> <pre><code>    argparser.add_argument('logpath', type=str, help='path of log file')\n    argparser.add_argument('-p', '--platform', type=int)\n</code></pre>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#action","title":"action","text":"<p>\u5f53\u8f93\u5165 <code>-v</code> \u5f00\u5173\u65f6\uff0c\u5c06\u6253\u5f00\u8c03\u8bd5\u5f00\u5173\uff0c\u7b49\u6548\u4e8e\u8d4b\u503c debug=true\uff08store true to dest var\uff09\u3002</p> <pre><code>    argparser.add_argument('-v', '--verbose', dest='debug',\n                           action='store_true', help='print debug verbose')\n</code></pre>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#argparsefiletype","title":"argparse.FileType","text":"<p>Python: Loading pathlib Paths with argparse</p> <p>File as command line argument for argparse - error message if argument is not valid</p> <p>Python argparse.FileType() Examples</p> <pre><code>    parser.add_argument('-f', '--file',\n                       type=argparse.FileType('r'),\n                       help='File to read text from.')\n\n    parser.add_argument('-o', '--output',\n                        action='store', nargs='?',\n                        help='Filename to output audio to',\n                        type=argparse.FileType('wb'), default='out.mp3')\n</code></pre> <p><code>type=argparse.FileType('r')</code> \u76f4\u63a5\u8c03\u7528\u5bf9 -f \u6307\u5b9a\u7684\u6587\u4ef6\u8fdb\u884c open\uff0c\u8fd4\u56de\u6587\u4ef6\u53e5\u67c4\u7c7b\u578b\uff08<code>_io.TextIOWrapper</code>\uff09\u3002</p>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#argparse\u7b80\u8981\u7528\u6cd5\u603b\u7ed3","title":"argparse\u7b80\u8981\u7528\u6cd5\u603b\u7ed3","text":"<p>nargs\uff1a\u8bbe\u7f6e\u53c2\u6570\u4e2a\u6570</p> <ul> <li>'?': 0\u62161\u4e2a\u53c2\u6570  </li> <li>'*': 0\u6216\u6240\u6709\u53c2\u6570  </li> <li>'+': \u6240\u6709\uff0c\u5e76\u4e14\u81f3\u5c11\u4e00\u4e2a\u53c2\u6570  </li> </ul>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#python_argparse_\u7528\u6cd5\u793a\u4f8b","title":"python argparse \u7528\u6cd5\u793a\u4f8b","text":"<p>Python-argparse-\u547d\u4ee4\u884c\u4e0e\u53c2\u6570\u89e3\u6790 </p> <pre><code>#!/usr/bin/env python3\n# encoding: utf-8\n\nimport argparse\n\nparser = argparse.ArgumentParser(description=\"calculate X to the power of Y\")\nparser.add_argument(\"square\", type=int,\n                    help=\"display a square of a given number\")\nparser.add_argument(\"-v\", \"--verbosity\", type=int, choices=[0, 1, 2], default=1,\n                    help=\"increase output verbosity\")\nargs = parser.parse_args()\nanswer = args.square**2\nif args.verbosity == 2:\n    print \"the square of {} equals {}\".format(args.square, answer)\nelif args.verbosity == 1:\n    print \"{}^2 == {}\".format(args.square, answer)\nelse:\n    print answer\n</code></pre>","tags":["argparse"]},{"location":"blog/20191205/python-argparse/#demo","title":"demo","text":"<p><code>test_argparse.py</code> \u5b9a\u4e49\u4e86\u4ee5\u4e0b4\u4e2a\u53c2\u6570\uff1a</p> <ol> <li><code>logpath</code>: \u5fc5\u586b\u4f4d\u7f6e\u53c2\u6570\uff1b  </li> <li><code>-V</code>\uff1a\u67e5\u770b\u8be5\u811a\u672c\u7248\u672c\u53f7\uff1b  </li> <li><code>-p/--platform</code>\uff1a\u6307\u5b9a\u65e5\u5fd7\u5e73\u53f0\uff0c\u53ef\u9009\u679a\u4e3e\u503c\u4e3a {0,1,2}\uff1b  </li> <li><code>-v/--verbose</code>\uff1a\u5f00\u542f\u8c03\u8bd5\u5f00\u5173\uff0c\u6253\u5370\u8be6\u7ec6\u8c03\u8bd5\u4fe1\u606f\u3002</li> </ol> <pre><code> $ python3 py/test_argparse.py\nusage: test_argparse.py [-h] [-V] [-p {0,1,2}] [-v] logpath\ntest_argparse.py: error: the following arguments are required: logpath\n</code></pre> <p><code>-h</code> \u67e5\u770b\u81ea\u52a8\u751f\u6210\u7684\u5e2e\u52a9\u4fe1\u606f\uff1a</p> <pre><code> $ python3 py/test_argparse.py -h\nusage: test_argparse.py [-h] [-V] [-p {0,1,2}] [-v] logpath\n\nMBR_Client log analyzer\n\npositional arguments:\n  logpath               path of log file\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -V, --version         show program's version number and exit\n  -p {0,1,2}, --platform {0,1,2}\n                        0 for ios,\n                        1 for android,\n                        2 for windows.\n                        &gt; guess from first line if miss.\n  -v, --verbose         print debug verbose\n\nfan@qq.com\n</code></pre>","tags":["argparse"]},{"location":"blog/20191202/python-expr/","title":"python expressions","text":"<p>python \u4e2d\u7684\u57fa\u7840\u8868\u8fbe\u5f0f\u4ecb\u7ecd\u3002</p> <p>reference - 6. Expressions \u8fd0\u7b97\u7b26\u76f8\u5173\uff1a6.16. Operator precedence </p> <pre><code>&gt;&gt;&gt; str1='1234567'\n&gt;&gt;&gt;\n&gt;&gt;&gt; range1=range(1,8)\n&gt;&gt;&gt; list(range1)\n[1, 2, 3, 4, 5, 6, 7]\n&gt;&gt;&gt;\n&gt;&gt;&gt; tuple1=tuple(range1)\n&gt;&gt;&gt; tuple1\n(1, 2, 3, 4, 5, 6, 7)\n&gt;&gt;&gt;\n&gt;&gt;&gt; list1=list(range1)\n&gt;&gt;&gt; list1\n[1, 2, 3, 4, 5, 6, 7]\n&gt;&gt;&gt;\n&gt;&gt;&gt; dict1=dict() # dict1={}\n&gt;&gt;&gt; for i in range1:\n...     k = 'k{}'.format(i) # 'k'+str(i)\n...     dict1[k]=i\n... \n&gt;&gt;&gt; dict1\n{'k1': 1, 'k2': 2, 'k3': 3, 'k4': 4, 'k5': 5, 'k6': 6, 'k7': 7}\n&gt;&gt;&gt;\n&gt;&gt;&gt; set1=set(range1)\n&gt;&gt;&gt; set1\n{1, 2, 3, 4, 5, 6, 7}\n&gt;&gt;&gt;\n</code></pre>"},{"location":"blog/20191202/python-expr/#none_not","title":"None, not","text":""},{"location":"blog/20191202/python-expr/#none","title":"None","text":"<p>\u5185\u7f6e\u7684 None \u5e38\u91cf\u7ecf\u5e38\u7528\u4f5c\u54e8\u7b26\u503c\uff0c\u6765\u4f5c\u4e3a\u9ed8\u8ba4\u503c\uff0c\u6216\u5224\u65ad\u67d0\u4e9b\u5b9e\u4f8b\u53d8\u91cf\u662f\u5426\u4e3a\u5c1a\u672a\u521d\u59cb\u5316\u7684\u7a7a\u5bf9\u8c61\u3002</p> <pre><code>&gt;&gt;&gt; help('None')\n\nHelp on NoneType object:\n\nclass NoneType(object)\n |  Methods defined here:\n |  \n |  __bool__(self, /)\n |      self != 0\n</code></pre> <pre><code>def repeater(value):\n    while True:\n        new = (yield value)\n        if new is not None: value = new\n</code></pre> <p>\u6df1\u5165\u7406\u89e3Python\u4e2d\u7684None python \u4e2dNone\uff0cis\u548c==\u7684\u6df1\u5165\u63a2\u8ba8 python - What is the difference between \"is None\" and \"== None\" </p>"},{"location":"blog/20191202/python-expr/#not","title":"not","text":"<pre><code>&gt;&gt;&gt; help('not')\n\nBoolean operations\n******************\n\n   or_test  ::= and_test | or_test \"or\" and_test\n   and_test ::= not_test | and_test \"and\" not_test\n   not_test ::= comparison | \"not\" not_test\n\nIn the context of Boolean operations, and also when expressions are\nused by control flow statements, the following values are interpreted\nas false: \"False\", \"None\", numeric zero of all types, and empty\nstrings and containers (including strings, tuples, lists,\ndictionaries, sets and frozensets).  All other values are interpreted\nas true.  User-defined objects can customize their truth value by\nproviding a \"__bool__()\" method.\n</code></pre> <p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u8282\u9009\u81ea string.py \u4e2d string.Template.substitute \u65b9\u6cd5\u7684\u5b9a\u4e49\uff0c\u82e5\u4f20\u5165\u7684\u5143\u7ec4 args \u4e3a\u7a7a\u5219\u629b\u51fa TypeError \u5f02\u5e38\uff1a</p> <pre><code>    def substitute(*args, **kws):\n        if not args:\n            raise TypeError(\"descriptor 'substitute' of 'Template' object \"\n                            \"needs an argument\")\n</code></pre> <pre><code>if not (filename and text and password):\n    print('Invalid parameters.')\n    sys.exit()\n</code></pre>"},{"location":"blog/20191202/python-expr/#lenobj","title":"len(obj)","text":"<ul> <li><code>len(s)</code>: Return the length of str(number of single character).  </li> </ul> <pre><code>&gt;&gt;&gt; help(len)\n\nHelp on built-in function len in module builtins:\n\nlen(obj, /)\n    Return the number of items in a container.\n</code></pre> <p>\u672c\u8d28\u4e0a\u662f\u8c03\u7528\u5bf9\u8c61\u7684 <code>__len__()</code> \u65b9\u6cd5\uff0c\u8fd4\u56de\u5e8f\u5217\uff08\u5305\u62ec\u5b57\u7b26\u4e32\uff09\u3001\u96c6\u5408\u6216\u5b57\u5178\u7b49\u5bb9\u5668\u6240\u5305\u542b\u5143\u7d20\u7684\u4e2a\u6570\u3002</p> <pre><code># \u7b49\u6548\u4e8e list1.__len__()\n&gt;&gt;&gt; len(list1)\n7\n</code></pre>"},{"location":"blog/20191202/python-expr/#in_not_in","title":"in, not in","text":"<ul> <li><code>x in s</code>: Test x for membership in s.  </li> <li><code>x not in s</code>: Test x for non-membership in s.  </li> </ul> <pre><code>&gt;&gt;&gt; help('in')\n\nRelated help topics: SEQUENCEMETHODS\n\nMembership test operations\n**************************\n\nThe operators \"in\" and \"not in\" test for membership.  \"x in s\"\nevaluates to \"True\" if *x* is a member of *s*, and \"False\" otherwise.\n\"x not in s\" returns the negation of \"x in s\".  All built-in sequences\nand set types support this as well as dictionary, for which \"in\" tests\nwhether the dictionary has a given key. For container types such as\nlist, tuple, set, frozenset, dict, or collections.deque, the\nexpression \"x in y\" is equivalent to \"any(x is e or x == e for e in\ny)\".\n\nFor the string and bytes types, \"x in y\" is \"True\" if and only if *x*\nis a substring of *y*.  An equivalent test is \"y.find(x) != -1\".\nEmpty strings are always considered to be a substring of any other\nstring, so \"\"\" in \"abc\"\" will return \"True\".\n\nFor user-defined classes which define the \"__contains__()\" method, \"x\nin y\" returns \"True\" if \"y.__contains__(x)\" returns a true value, and\n\"False\" otherwise.\n</code></pre> <ul> <li><code>x in s</code> \u6d4b\u8bd5 x \u662f\u5426\u4e3a s \u7684\u6210\u5458\uff0c\u6216\u8005\u8bf4 s \u662f\u5426\u5305\u542b x\u3002  </li> <li><code>x not in s</code> \u7b49\u6548\u4e8e <code>not x in s</code>\uff0c\u5bf9 <code>x in s</code> \u7ed3\u679c\u53d6\u53cd\u3002  </li> </ul> <p>\u5185\u7f6e\u5e8f\u5217\u53ca\u5bb9\u5668\u7c7b\u578b\uff0c\u5982\u5217\u8868\uff08list\uff09\u3001\u5143\u7ec4\uff08tuple\uff09\u3001\u533a\u95f4\uff08range\uff09\u3001\u96c6\u5408\uff08set\uff09\u3001\u53cc\u7aef\u961f\u5217\uff08collections.deque\uff09\u7b49\u7c7b\u578b\u5747\u652f\u6301\u5305\u542b\u5173\u7cfb\u6d4b\u8bd5\u7b26 in\u3002 </p> <p>\u5b57\u5178\uff08dict\uff09\u4e5f\u652f\u6301 in \u6d4b\u8bd5\u7b26\uff0c\u4f46\u662f\u662f\u57fa\u4e8e\u952e\u503c\uff08keys\uff09\u5224\u65ad\u3002</p> <pre><code>&gt;&gt;&gt; # \u7b49\u6548\u4e8e 'k3' in dict1.keys()\n&gt;&gt;&gt; 'k3' in dict1\nTrue\n&gt;&gt;&gt; 3 in dict1\nFalse\n</code></pre> <p>\u5b57\u7b26\u4e32\uff08str\uff09\u4ea6\u652f\u6301 in \u6d4b\u8bd5\u7b26\uff0c\u4e0d\u8fc7\u662f\u5224\u65ad\u5b50\u4e32\u5305\u542b\u5173\u7cfb\u3002<code>x in y</code> \u7b49\u6548\u4e8e <code>y.find(x) != -1</code>\u3002</p> <pre><code>&gt;&gt;&gt; '4' in str1\nTrue\n&gt;&gt;&gt; '567' in str1\nTrue\n</code></pre> <p>\u5bf9\u4e8e\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u7c7b\u578b\uff0c<code>x in y</code> \u7b49\u6548\u4e8e <code>y.__contains__(x)</code>\u3002</p> <p>\u7efc\u4e0a\uff0c<code>x in y</code> \u7b49\u6548\u4e8e <code>any(x is e or x == e for e in y)</code>.</p>"},{"location":"blog/20191202/python-expr/#for","title":"for","text":"<p>reference - 8.3. The for statement </p> <ul> <li><code>for e in s</code>: enumerate elements in s.</li> </ul> <p>The for statement is used to iterate over the elements of a sequence (such as a string, tuple or list) or other <code>iterable</code> object.</p> <pre><code>for_stmt ::=  \"for\" target_list \"in\" expression_list \":\" suite\n              [\"else\" \":\" suite]\n</code></pre> <p>The expression list is evaluated once; it should yield an iterable object. An iterator is created for the result of the <code>expression_list</code>. The suite is then executed once for each item provided by the iterator, in the order returned by the iterator.</p> <p><code>for e in s</code> \u904d\u5386 s \u4e2d\u7684\u5143\u7d20 e\uff0c\u5b83\u9488\u5bf9\u4efb\u4f55\u53ef\u8fed\u4ee3\uff08iterable\uff09\u7684\u5bf9\u8c61 s \u63d0\u4f9b\u4e86\u4e00\u79cd\u66f4\u7b80\u7ea6\u7684\u8fed\u4ee3\u8bed\u6cd5\u8868\u8fbe\u5f0f\u3002</p> <pre><code>&gt;&gt;&gt; for e in list1:\n...     print(e)\n... \n1\n2\n3\n4\n5\n6\n7\n</code></pre> <p><code>for ... in</code> \u8868\u8fbe\u5f0f\u80cc\u540e\u8fd8\u662f\u57fa\u4e8e\u8fed\u4ee3\u5668\uff08iterator\uff09\u5b9e\u73b0\u3002</p> <p>\u57fa\u4e8e\u7d22\u5f15\u904d\u5386\u8bbf\u95ee\u7684\u7b49\u6548\u5b9e\u73b0\u5982\u4e0b\uff1a</p> <pre><code>&gt;&gt;&gt; i = 0;\n&gt;&gt;&gt; while i &lt; len(list1):\n...     print(list1[i])\n...     i += 1\n... \n</code></pre> <p>\u6ce8\u610f\uff1a</p> <ul> <li><code>for k in dict1</code> \u904d\u5386\u5b57\u5178\u7684\u952e\u503c\uff0c\u7b49\u6548\u4e8e <code>for k in dict1.keys()</code>\uff1b  </li> <li><code>for c in str1</code> \u904d\u5386\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u7b26\uff08\u5355\u5b57\u7b26\u5b50\u4e32\uff09\u3002  </li> </ul>"},{"location":"blog/20191202/python-expr/#comprehension","title":"comprehension","text":"<p>list comprehension : A compact way to process all or part of the elements in a sequence and return a list with the results.</p> <p>\u5217\u8868\u89e3\u6790\u5f0f \u662f\u904d\u5386\u4e00\u4e2a\u5217\u8868\u4e2d\u7684\u5143\u7d20\uff0c\u8fc7\u6ee4\u7b5b\u9009\u51fa\u7b26\u5408\u4e00\u5b9a\u6761\u4ef6\u7684\u5143\u7d20\uff0c\u6267\u884c\u5fc5\u8981\u5730\u8f6c\u6362\u540e\u8ffd\u52a0\u5230\u53e6\u4e00\u4e2a\u5217\u8868\u5e76\u8fd4\u56de\u8fd9\u4e2a\u65b0\u7684\u5217\u8868\u7684\u8868\u8fbe\u5f0f\u3002  </p> <p>\u5217\u8868\u89e3\u6790\u5f0f\u5f62\u5982 <code>expression comp_for [comp_if]</code>\uff0c\u6216\u66f4\u6e05\u6670\u4e00\u70b9 <code>expr for iter_var in iterable [if cond_expr]</code>\uff0c\u5176\u4e2d\u7684\u6761\u4ef6\u8fc7\u6ee4\u5668 if \u8bed\u53e5\u662f\u53ef\u9009\u7684\u3002\u5982\u679c\u6ca1\u6709 if \u8fc7\u6ee4\uff0c\u5219\u9ed8\u8ba4\u904d\u5386\u6240\u6709\u5143\u7d20\u6267\u884c\u8f6c\u6362\u3002</p> <p>The if clause is optional. If omitted, all elements in comp_for are processed.</p> <p>\u4ee5\u4e0b\u793a\u4f8bfor\u5faa\u73af\u904d\u5386\u53ef\u679a\u4e3e\u5bf9\u8c61\uff0c\u904d\u5386\u5143\u7d20\u4e3avalue\uff0c\u8868\u8fbe\u5f0f value**2 \u8ba1\u7b97\u5e73\u65b9\uff0c\u6574\u4e2a\u5217\u8868\u89e3\u6790\u7528\u4e8e\u521b\u5efa1\u523010\u7684\u5e73\u65b9\u3002</p> <pre><code>&gt;&gt;&gt; squares = [value**2 for value in range(1,11)]\n&gt;&gt;&gt; print(squares)\n[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u9488\u5bf9 for \u5faa\u73af\u6dfb\u52a0\u8fc7\u6ee4\u6761\u4ef6\uff0c\u7b5b\u9009\u51fa\u7b26\u5408\u6761\u4ef6\u7684\u5143\u7d20\uff0c\u518d\u6267\u884c\u590d\u5408\u8ba1\u7b97\u3002</p> <pre><code># \u8fc7\u6ee4\u51fa list1 \u4e2d\u5927\u4e8e4\u7684\u5143\u7d20\uff0c\u8fd4\u56de\u65b0\u5217\u8868 list2\n&gt;&gt;&gt; [e for e in range(1,8) if e&gt;4]\n[5, 6, 7]\n</code></pre> <p>\u66f4\u591a\u53c2\u8003 builtins.list \u4e2d\u7684\u76f8\u5173\u8bf4\u660e\u548c\u4f8b\u7a0b\u3002</p>"},{"location":"blog/20191202/python-expr/#if","title":"if","text":"<p>reference - 8.1. The if statement</p> <p>if \u8868\u8fbe\u5f0f\u7528\u6765\u6267\u884c\u6761\u4ef6\u5206\u652f\uff0c\u53ef\u4f7f\u7528 if-elif-else \u7ed3\u6784\u6267\u884c\u591a\u6761\u4ef6\u5206\u652f\u3002</p> <pre><code>if_stmt ::=  \"if\" assignment_expression \":\" suite\n             (\"elif\" assignment_expression \":\" suite)*\n             [\"else\" \":\" suite]\n</code></pre>"},{"location":"blog/20191202/python-expr/#ternary_conditional","title":"ternary conditional","text":"<p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\uff0c\u7528\u4e8e\u5224\u65ad\u6574\u6570x\u7684\u5947\u5076\u6027\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u5230even\u53d8\u91cf\u3002</p> <pre><code>even = 0\nif x%2 == 0:\n    even = 1\nelse:\n    even = 0\n</code></pre> <p>\u5728C\u8bed\u8a00\u4e2d\uff0c\u5bf9\u8fd9\u79cdif-else\u975e\u6b64\u5373\u5f7c\u7684\u6761\u4ef6\u8d4b\u503c\uff0c\u53ef\u6539\u7528\u4e09\u76ee\u8fd0\u7b97\u7b26\u6765\u7b80\u5316\u4e66\u5199\uff1a</p> <p>even = x%2==0 ? 1 : 0;</p> <p>Python\u6ca1\u6709\u50cfC\u8bed\u8a00\u4e2d\u90a3\u6837\u7684\u4e09\u76ee\u8fd0\u7b97\u7b26\uff0c\u4f46\u63d0\u4f9b\u4e86\u57fa\u4e8eif\u7684\u4e09\u5143\u8868\u8fbe\u5f0f\u652f\u6301\u3002</p> <pre><code>#\u5982\u679c\u6761\u4ef6\u4e3a\u771f\uff0c\u8fd4\u56de exp1\uff0c\u5426\u5219\u8fd4\u56de exp2\nexp1 if contion else exp2\n</code></pre> <p>even = 1 if x%2==0 else 0</p> <p>\u53ef\u4ee5\u4f7f\u7528\u5d4c\u5957\u7684\u4e09\u5143\u8868\u8fbe\u5f0f\uff0c\u6784\u9020\u66f4\u52a0\u590d\u6742\u7684\u590d\u5408\u8868\u8fbe\u5f0f\u3002</p> <p>\u5728\u5d4c\u5957\u65f6\u9700\u8981\u6ce8\u610f if \u548c else \u7684\u914d\u5bf9\uff0c\u4f8b\u5982\uff1a</p> <pre><code>a if a&gt;b else c if c&gt;d else d\n</code></pre> <p>\u5e94\u8be5\u7406\u89e3\u4e3a\uff1a</p> <pre><code>a if a&gt;b else ( c if c&gt;d else d )\n</code></pre> <p>\u4ee5\u4e0b\u4ee3\u7801\u5224\u65ad\u5e74\u4efd\u662f\u5426\u7f6e\u95f0\uff1a</p> <pre><code>year=2024\nleap=True if (year%400==0 or (year%4==0 and year%100!=0)) else False\nprint('{} is leap: {}'.format(year, leap))\n</code></pre> <p>Does Python have a ternary conditional operator?</p> <pre><code>&gt;&gt;&gt; print('yes') if True else print('no')\nyes\n&gt;&gt;&gt; print('yes') if False else print('no')\nno\n</code></pre> <pre><code>def _cmp(x, y):\n    return 0 if x == y else 1 if x &gt; y else -1\n</code></pre>"},{"location":"blog/20191202/python-expr/#switchmatch","title":"switch(match)","text":"<p>Python \u4e2d\u672a\u63d0\u4f9b\u5176\u4ed6\u8bed\u8a00\u4e2d\u7684 switch \u5173\u952e\u5b57\uff0c\u53ef\u4f7f\u7528\u591a elif \u7b49\u6548\u5b9e\u73b0\u3002</p> <pre><code>def switch(lang):\n    if lang == \"JavaScript\":\n        return \"You can become a web developer.\"\n    elif lang == \"PHP\":\n        return \"You can become a backend developer.\"\n    elif lang == \"Python\":\n        return \"You can become a Data Scientist.\"\n    elif lang == \"Solidity\":\n        return \"You can become a Blockchain developer.\"\n    elif lang == \"Java\":\n        return \"You can become a mobile app developer.\"\n</code></pre> <p>\u5728\u6700\u65b0\u7684 Python 3.10 \u4e2d\uff0c\u53ef\u4f7f\u7528 match \u548c case \u5173\u952e\u5b57\u5b9e\u73b0 Switch \u6548\u679c\u3002</p> <pre><code>lang = 'JavaScript'\nmatch lang:\n    case \"JavaScript\":\n        print(\"You can become a web developer.\")\n    case \"PHP\":\n        print(\"You can become a backend developer.\")\n    case \"Python\":\n        print(\"You can become a Data Scientist.\")\n    case \"Solidity\":\n        print(\"You can become a Blockchain developer.\")\n    case \"Java\":\n        print(\"You can become a mobile app developer.\")\n    case _:\n        print(\"unknown language\")\n</code></pre>"},{"location":"blog/20191202/python-expr/#while","title":"while","text":"<p>reference - 8.2. The while statement</p> <pre><code>while_stmt ::=  \"while\" assignment_expression \":\" suite\n                [\"else\" \":\" suite]\n</code></pre> <p>for \u5faa\u73af\u7528\u4e8e\u9488\u5bf9\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u6267\u884c\u4e00\u4e2a\u4ee3\u7801\u5757\uff0c\u800c while \u5faa\u73af\u4e0d\u65ad\u5730\u8fd0\u884c\uff0c\u76f4\u5230\u6307\u5b9a\u7684\u6761\u4ef6\u4e0d\u6ee1\u8db3\u4e3a\u6b62\u3002</p> <p>\u5728\u8981\u6c42\u5f88\u591a\u6761\u4ef6\u90fd\u6ee1\u8db3\u624d\u7ee7\u7eed\u8fd0\u884c\u7684\u7a0b\u5e8f\u4e2d\uff0c\u53ef\u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\uff0c\u7528\u4e8e\u5224\u65ad\u6574\u4e2a\u7a0b\u5e8f\u662f\u5426\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u3002\u8fd9\u4e2a\u53d8\u91cf\u88ab\u79f0\u4e3a<code>\u6807\u5fd7</code>\uff0c\u5145\u5f53\u4e86\u7a0b\u5e8f\u7684\u4ea4\u901a\u4fe1\u53f7\u706f\u3002 \u4f60\u53ef\u8ba9\u7a0b\u5e8f\u5728\u6807\u5fd7\u4e3a <code>True</code> \u65f6\u7ee7\u7eed\u8fd0\u884c\uff0c\u5e76\u5728\u4efb\u4f55\u4e8b\u4ef6\u5bfc\u81f4\u6807\u5fd7\u7684\u503c\u4e3a <code>False</code> \u65f6\u8ba9\u7a0b\u5e8f\u505c\u6b62\u8fd0\u884c\u3002 \u8fd9\u6837\uff0c\u5728 while \u8bed\u53e5\u4e2d\u5c31\u53ea\u9700\u68c0\u67e5\u4e00\u4e2a\u6761\u4ef6\u2014\u2014\u6807\u5fd7\u7684\u5f53\u524d\u503c\u662f\u5426\u4e3aTrue\uff0c\u5e76\u5c06\u6240\u6709\u6d4b\u8bd5(\u662f\u5426\u53d1\u751f\u4e86\u5e94\u5c06\u6807\u5fd7\u8bbe\u7f6e\u4e3aFalse\u7684\u4e8b\u4ef6)\u90fd\u653e\u5728\u5176\u4ed6\u5730\u65b9\uff0c\u4ece\u800c\u8ba9\u7a0b\u5e8f\u53d8\u5f97\u66f4\u4e3a\u6574\u6d01\u3002  </p> <pre><code>    prompt = \"\\nTell me something, and I will repeat it back to you:\"\n    prompt += \"\\nEnter 'quit' to end the program.\"\n\n    active = True\n    while active:\n        message = input(prompt)\n\n        if message == 'quit':\n            active = False # break\n        else:\n            print(message)\n</code></pre>"},{"location":"blog/20191202/python-expr/#break","title":"break","text":"<p>A <code>break</code> statement executed in the first suite terminates the loop without executing the else clause\u2019s suite.  </p> <p>\u8981\u7acb\u5373\u9000\u51fawhile\u5faa\u73af\uff0c\u4e0d\u518d\u8fd0\u884c\u5faa\u73af\u4e2d\u4f59\u4e0b\u7684\u4ee3\u7801\uff0c\u4e5f\u4e0d\u7ba1\u6761\u4ef6\u6d4b\u8bd5\u7684\u7ed3\u679c\u5982\u4f55\uff0c\u53ef\u4f7f\u7528 <code>break</code> \u8bed\u53e5\u3002 break\u8bed\u53e5\u7528\u4e8e\u63a7\u5236\u7a0b\u5e8f\u6d41\u7a0b\uff0c\u53ef\u4f7f\u7528\u5b83\u6765\u63a7\u5236\u54ea\u4e9b\u4ee3\u7801\u884c\u5c06\u6267\u884c\uff0c\u54ea\u4e9b\u4ee3\u7801\u884c\u4e0d\u6267\u884c\uff0c\u4ece\u800c\u8ba9\u7a0b\u5e8f\u6309\u4f60\u7684\u8981\u6c42\u6267\u884c\u4f60\u8981\u6267\u884c\u7684\u4ee3\u7801\u3002  </p>"},{"location":"blog/20191202/python-expr/#continue","title":"continue","text":"<p>A <code>continue</code> statement executed in the first suite skips the rest of the suite and goes back to testing the expression.  </p> <p>\u8981\u8fd4\u56de\u5230\u5faa\u73af\u5f00\u5934\uff0c\u5e76\u6839\u636e\u6761\u4ef6\u6d4b\u8bd5\u7ed3\u679c\u51b3\u5b9a\u662f\u5426\u7ee7\u7eed\u6267\u884c\u5faa\u73af\uff0c\u53ef\u4f7f\u7528 <code>continue</code> \u8bed\u53e5\u3002 \u5b83\u4e0d\u50cfbreak\u8bed\u53e5\u90a3\u6837\u4e0d\u518d\u6267\u884c\u4f59\u4e0b\u7684\u4ee3\u7801\u5e76\u9000\u51fa\u6574\u4e2a\u5faa\u73af\uff0c\u800c\u662f\u7565\u8fc7\u5f53\u524d\u6761\u4ef6\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u8d9f\u5faa\u73af\u3002  </p>"},{"location":"blog/20191202/python-expr/#vs_for","title":"vs. for","text":"<p>\u4ee5\u4e0bC\u8bed\u8a00\u4ee3\u7801\u7247\u6bb5\u4e2d\uff0cfor\u5faa\u73af\u6700\u540e\u4e00\u8d9fi=9\u6ee1\u8db3\u6761\u4ef6\uff0c\u7136\u540ei++\u81ea\u589e\u4e3a10\u65f6\u4e0d\u518d\u6ee1\u8db3\u6761\u4ef6\uff0c\u7ed3\u675f\u9000\u51fa\u65f6i=10\u3002</p> <pre><code>    int i=0;\n    for (; i&lt;10; i++)\n        printf(\"%d \", i);\n    // \u81ea\u7136\u7ed3\u675f\u65f6\uff0ci=10\n</code></pre> <p>\u800c\u5728 Python \u4e2d\uff0cfor-in \u5faa\u73af\u4e2d\u6ca1\u6709\u5148\u81ea\u589e\u540e\u6bd4\u8f83\u7684\u64cd\u4f5c\uff0c\u800c\u662f\u904d\u5386\u5df2\u77e5\u679a\u4e3e\u4e2d\u7684\u5143\u7d20\uff0c\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u5373\u662f\u5faa\u73af\u53d8\u91cf\u6700\u7ec8\u7684\u503c\u3002</p> <pre><code>for i in range(0,10):\n    print(i)\n# \u81ea\u7136\u7ed3\u675f\u65f6\uff0ci=9\n</code></pre> <p>\u53ef\u6539\u7528while\u5b9e\u73b0C\u8bed\u8a00\u7c7b\u4f3c\u6548\u679c\uff0cwhile\u652f\u6301\u6761\u4ef6\u5224\u65ad\uff0c\u6ee1\u8db3\u6761\u4ef6\u5224\u65ad\u6267\u884c\u903b\u8f91\uff0c\u5e76\u81ea\u589ei\u7ee7\u7eed\u4e0b\u4e00\u8f6e\u5faa\u73af\u3002 \u56e0\u6b64\uff0ci\u6700\u7ec8\u7684\u503c\u662f\u81ea\u589e\u5230\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u8fb9\u754c\u503c10\u3002</p> <pre><code>i=0\nwhile i&lt;10:\n    print(i)\n    i += 1\n# \u81ea\u7136\u7ed3\u675f\u65f6\uff0ci=10\n</code></pre> <p>\u7b80\u5355\u5730\u8bf4\uff0cPython \u4e2d for \u5faa\u73af\u5e38\u7528\u4e8e\u4e0d\u5e26\u6761\u4ef6\u7684\u679a\u4e3e\uff0c\u56e0\u6b64\u7ed3\u675f\u65f6\u7684\u5faa\u73af\u53d8\u91cf\u4ecd\u7136\u662f\u5408\u6cd5\u503c\u3002 \u800c while \u662f\u5e26\u6761\u4ef6\u7684\u5faa\u73af\uff0c\u5faa\u73af\u7ed3\u675f\u65f6\u53d8\u91cf\u4e3a\u7b2c\u4e00\u4e2a\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u8fb9\u754c\u503c\u3002 \u660e\u786e\u4e86\u7136\u8fd9\u4e2a\u5fae\u5c0f\u533a\u522b\uff0c\u5bf9\u4e8e\u67d0\u4e9b\u7279\u5b9a\u573a\u666f\u81f3\u5173\u91cd\u8981\u3002</p>"},{"location":"blog/20191202/python-expr/#multiple_assignment","title":"multiple assignment","text":"<p>\u5728 python \u8bed\u8a00\u4e2d\uff0c\u652f\u6301 <code>expr3, expr4 = expr1, expr2</code> \u5f62\u5f0f\u7684\u591a\u91cd\u8d4b\u503c\u3002</p> <p>\u4ee5\u4e0b\u4e3a tutorial - 4.6. Defining Functions \u4e2d\u8ba1\u7b97\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u793a\u4f8b\u4ee3\u7801\uff1a </p> <pre><code>&gt;&gt;&gt; def fib2(n):  # return Fibonacci series up to n\n...     \"\"\"Return a list containing the Fibonacci series up to n.\"\"\"\n...     result = []\n...     a, b = 0, 1\n...     while a &lt; n:\n...         result.append(a)    # see below\n...         a, b = b, a+b\n...     return result\n... \n&gt;&gt;&gt; f100 = fib2(100)\n&gt;&gt;&gt; f100\n[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89]\n</code></pre> <p>\u6ce8\u610f\uff1a\u591a\u91cd\u8d4b\u503c\u662f\u9010\u4e2a\u8ba1\u7b97\u53f3\u503c\u8868\u8fbe\u5f0f\uff0c\u518d\u4f9d\u6b21\u8d4b\u7ed9\u5de6\u4fa7\u53d8\u91cf\u3002</p> <p>\u524d5\u8f6e\u5faa\u73af\u63a8\u6f14\u5982\u4e0b\uff1a</p> <pre><code>## loop 1\nresult.append(0)\na, b = 1, 1\n## loop 2\nresult.append(1)\na, b = 1, 2\n## loop 3\nresult.append(1)\na, b = 2, 3\n## loop 4\nresult.append(2)\na, b = 3, 5\n## loop 5\nresult.append(3)\na, b = 5, 8\n</code></pre> <p><code>expr3, expr4 = expr1, expr2</code>  \u5e76\u975e\u7b80\u5355\u7b49\u4ef7\u4e8e <code>expr3 = expr1;expr4 = expr2</code>\u3002 \u5047\u5982\u628a fib2 \u4e2d\u7684 <code>a, b = b, a+b</code> \u62c6\u5206\u6210 <code>a = b; b = a+b</code>\uff0c\u4f1a\u56e0\u903b\u8f91\u9519\u4f4d\u5173\u8054\u800c\u8fbe\u4e0d\u5230\u9884\u671f\u7ed3\u679c\u3002</p> <pre><code>## loop 1\nresult.append(0)\na = b = 1\nb = a+b = 1+1 = 2\n\n## loop 2\nresult.append(1)\na = b = 2\nb = a+b = 2+2 = 4\n\n## loop 3\nresult.append(2)\na = b = 4\nb = a+b = 4+4 = 8\n\n## loop 4\nresult.append(4)\na = b = 8\nb = a+b = 8+8 = 16\n\n## loop 5\nresult.append(8)\na = b = 16\nb = a+b = 16+16 = 32\n</code></pre> <p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u793a\u4f8b\u4e86\u5206\u6bb5\u622a\u53d6\u5e94\u7528\u573a\u666f\uff1a</p> <pre><code># \u7b49\u6548\u4e8e first, *rest = list1\n&gt;&gt;&gt; first, rest = list1[0], list1[1:]\n&gt;&gt;&gt; first, rest\n(1, [2, 3, 4, 5, 6, 7])\n&gt;&gt;&gt;\n# \u9488\u5bf9 list \u7684 iter, __next__\n&gt;&gt;&gt; it = iter(list1)\n&gt;&gt;&gt; first=it.__next__()\n&gt;&gt;&gt; rest=list(it)\n&gt;&gt;&gt; first, rest\n(1, [2, 3, 4, 5, 6, 7])\n&gt;&gt;&gt;\n# \u9488\u5bf9 dict \u7684 iter, __next__\n&gt;&gt;&gt; it=iter(dict1)\n&gt;&gt;&gt; first=next(it)  # it.__next__()\n&gt;&gt;&gt; rest=list(it)\n&gt;&gt;&gt; first, rest\n('k1', ['k2', 'k3', 'k4', 'k5', 'k6', 'k7'])\n&gt;&gt;&gt;\n# \u7b49\u6548\u4e8e head, *body, tail = list1\n&gt;&gt;&gt; head, body, tail = list1[0], list1[1:-1], list1[-1]\n&gt;&gt;&gt; head, body, tail\n(1, [2, 3, 4, 5, 6], 7)\n&gt;&gt;&gt;\n&gt;&gt;&gt; for first, *rest in [(1, 2, 3), (4, 5, 6, 7)]:\n...     print(first, rest)\n... \n1 [2, 3]\n4 [5, 6, 7]\n&gt;&gt;&gt; # \u6536\u96c6\u5c3e\u90e8\u503c\n&gt;&gt;&gt; a, b, *rest = [1, 2, 3, 4]\n&gt;&gt;&gt; rest\n[3, 4]\n&gt;&gt;&gt; # \u6536\u96c6\u4e2d\u90e8\u503c\n&gt;&gt;&gt; name = \"Albus Percival Wulfric Brian Dumbledore\"\n&gt;&gt;&gt; first, *middle, last = name.split()\n&gt;&gt;&gt; middle\n['Percival', 'Wulfric', 'Brian']\n</code></pre> <p>\u53ef\u53c2\u9605\u300aPython\u57fa\u7840\u6559\u7a0b\u300b5.2 \u8d4b\u503c\u9b54\u6cd5 \u7ae0\u8282\u76f8\u5173\u5185\u5bb9\u3002</p>"},{"location":"blog/20191202/python-expr/#starred_expression","title":"starred expression","text":"<p>PEP 448 -- Additional Unpacking Generalizations PEP 3132 -- Extended Iterable Unpacking </p> <p>reference - starred_expression reference - starred_list </p> <p>Python 3: starred expression to unpack a list Star * operator on left vs right side of an assignment statement </p> <p>An asterisk <code>*</code> denotes iterable unpacking. Its operand must be an iterable. The iterable is expanded into a sequence of items, which are included in the new tuple, list, or set, at the site of the unpacking.</p> <pre><code>&gt;&gt;&gt; '{0}, {1}, {2}'.format(*str1)\n'1, 2, 3'\n&gt;&gt;&gt; '{0}, {1}, {2}'.format(*range1)\n'1, 2, 3'\n&gt;&gt;&gt; '{0}, {1}, {2}'.format(*tuple1)\n'1, 2, 3'\n&gt;&gt;&gt; '{0}, {1}, {2}'.format(*list1)\n'1, 2, 3'\n&gt;&gt;&gt; '{0}, {1}, {2}'.format(*set1)\n'1, 2, 3'\n</code></pre> <p>\u5bf9\u4e8e\u5b57\u5178\uff08dict\uff09\u4e00\u4e2a\u661f\u53f7\u89e3\u6790</p> <pre><code># position\n&gt;&gt;&gt; '{0}, {1}, {2}'.format(*dict1)\n'k1, k2, k3'\n\n# name\n&gt;&gt;&gt; '{k1}, {k2}, {k3}'.format(**dict1)\n'1, 2, 3'\n</code></pre> <p><code>*elements, = iterable</code>: elements is always going to be a list containing all the items in the iterable. <code>elements = *iterable,</code>: expands the contents of the iterable it is attached to.  </p> <pre><code># *elements, = iterable \u751f\u6210\u5217\u8868\n# \u7b49\u6548\u4e8e parenth_form : list2 = [*set1]\n&gt;&gt;&gt; *list2, = set1\n&gt;&gt;&gt; list2\n[1, 2, 3, 4, 5, 6, 7]\n\n# elements = *iterable, \u751f\u6210 tuple\n&gt;&gt;&gt; tuple2 = *set1,\n&gt;&gt;&gt; tuple2\n(1, 2, 3, 4, 5, 6, 7)\n</code></pre>"},{"location":"blog/20191202/python-expr/#destructuring","title":"Destructuring","text":"<p>\u5728 ES6 \u4e2d\uff0c\u5141\u8bb8\u6309\u7167\u4e00\u5b9a\u6a21\u5f0f\u4ece\u6570\u7ec4\u548c\u5bf9\u8c61\u4e2d\u63d0\u53d6\u503c\uff0c\u7136\u540e\u5bf9\u53d8\u91cf\u8fdb\u884c\u8d4b\u503c\uff0c\u8fd9\u88ab\u79f0\u4e3a\u89e3\u6784\uff08Destructuring\uff09\u3002 \u5728 Python \u4e2d\uff0c\u901a\u8fc7\u661f\u53f7\u4e5f\u652f\u6301\u7c7b\u4f3c\u7684\u6309\u7167\u201c\u6a21\u5f0f\u5339\u914d\u201d\u8bfb\u53d6\u5339\u914d\u4f4d\u7f6e\u6a21\u5f0f\u7684\u503c\u3002</p> <p>\u4f8b\u5982\u5bf9\u4e8e\u4e8c\u5143tuple\uff0c\u53ef\u6309\u4f4d\u7f6e\u89e3\u6784\u51fa\u4e8c\u5143\u503c\u5bf9\u3002</p> <pre><code>&gt;&gt;&gt; tp = (1,6)\n&gt;&gt;&gt; t1,t2 = tp\n&gt;&gt;&gt; t1\n1\n&gt;&gt;&gt; t2\n6\n</code></pre> <p>for \u5faa\u73af\u679a\u4e3e\u51fa\u7684 tuple \u4e5f\u53ef\u7528\u89e3\u6784\u8d4b\u503c\u63a5\u6536\u503c\u5bf9\u3002</p> <pre><code>&gt;&gt;&gt; for index,value in enumerate(l):\n        print('e[{0}] = {1}'.format(index, value))\n\ne[0] = 1\ne[1] = 2\ne[2] = 3\ne[3] = 4\ne[4] = 5\ne[5] = 6\ne[6] = 7\n</code></pre> <p>\u4ee5\u4e0b\u5b57\u5178\u8fd4\u56de\u7684 items\uff0c\u4e5f\u53ef\u57fa\u4e8e\u4f4d\u7f6e\u89e3\u6784 tuple \u4e8c\u5143\u503c\u5bf9\u3002</p> <pre><code>&gt;&gt;&gt; for e in favorite_languages.items():\n        print(e)\n\n('jen', 'python')\n('sarah', 'c')\n('edward', 'ruby')\n('phil', 'python')\n\n&gt;&gt;&gt; for k,v in favorite_languages.items():\n        print('{}: {}'.format(k,v))\n\njen: python\nsarah: c\nedward: ruby\nphil: python\n</code></pre> <p>\u5bf9\u4e8e\u591a\u5143tuple\u6216\u591a\u4e8e\u4e24\u4e2a\u5143\u7d20\u7684list\uff0c\u5f53\u6211\u4eec\u53ea\u60f3\u6790\u53d6\u6307\u5b9a\u4f4d\u7f6e\u90e8\u5206\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u661f\u53f7\u5b9e\u73b0\u3002</p> <p>\u5bf9\u4e8e\u5217\u8868l\uff0c<code>a,*b,c = l</code> \u6307\u5b9aa\u3001c\u63a5\u6536\u9996\u5c3e\u5143\u7d20\uff0c\u4e2d\u95f4\u90e8\u5206\u7528\u661f\u53f7\u89e3\u6784\u63a5\u6536\u5230\u53d8\u91cfb\u3002</p> <pre><code>&gt;&gt;&gt; l=[*range(1,8)]\n&gt;&gt;&gt; a,*b,c = l\n&gt;&gt;&gt; a\n1\n&gt;&gt;&gt; b\n[2, 3, 4, 5, 6]\n&gt;&gt;&gt; c\n7\n</code></pre>"},{"location":"blog/20191202/python-expr/#with","title":"with","text":"<p>PEP 343 -- The \"with\" Statement reference - 8.5. The with statement library - 29.6. contextlib \u2014 Utilities for with-statement contexts </p> <p>with \u8bed\u53e5\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u975e\u5e38\u901a\u7528\u7684\u7ed3\u6784\uff0c\u5b83\u901a\u8fc7 \u4e0a\u4e0b\u6587\u7ba1\u7406\u5668 \u6267\u884c\u4e00\u4e9b\u8bbe\u7f6e\u548c\u6e05\u7406\u64cd\u4f5c\u3002</p> <p>with \u8bed\u53e5\u7684\u76ee\u7684\u662f\u7b80\u5316 try/finally \u6a21\u5f0f\u3002\u8fd9\u79cd\u6a21\u5f0f\u7528\u4e8e\u4fdd\u8bc1\u4e00\u6bb5\u4ee3\u7801\u8fd0\u884c\u5b8c\u6bd5\u540e\u6267\u884c\u67d0\u9879\u64cd\u4f5c\uff0c\u5373\u4fbf\u90a3\u6bb5\u4ee3\u7801\u7531\u4e8e\u5f02\u5e38\u3001return \u8bed\u53e5\u6216 sys.exit() \u8c03\u7528\u800c\u4e2d\u6b62\uff0c\u4e5f\u4f1a\u6267\u884c\u6307\u5b9a\u7684\u64cd\u4f5c\u3002finally \u5b50\u53e5\u4e2d\u7684\u4ee3\u7801\u901a\u5e38\u7528\u4e8e\u91ca\u653e\u91cd\u8981\u7684\u8d44\u6e90\uff0c\u6216\u8005\u8fd8\u539f\u4e34\u65f6\u53d8\u66f4\u7684\u72b6\u6001\u3002</p> <p>\u4ee5\u4e0b\u4f8b\u5b50\u6458\u81ea\u300a\u6d41\u7545\u7684 python\u300b\u7684 \u7b2c 8 \u7ae0 \u5bf9\u8c61\u5f15\u7528\u3001\u53ef\u53d8\u6027\u548c\u5783\u573e\u56de\u6536 - 8.9 \u5ef6\u4f38\u9605\u8bfb - \u6742\u8c08 - \u5bf9\u8c61\u6790\u6784\u548c\u5783\u573e\u56de\u6536\u3002</p> <pre><code>open('test.txt', 'wt', encoding='utf-8').write('1, 2, 3')\n</code></pre> <p>\u8fd9\u884c\u4ee3\u7801\u662f\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u6587\u4ef6\u5bf9\u8c61\u7684\u5f15\u7528\u6570\u91cf\u4f1a\u5728 write \u65b9\u6cd5\u8fd4\u56de\u540e\u5f52\u96f6\uff0cPython \u5728\u9500\u6bc1\u5185\u5b58\u4e2d\u8868\u793a\u6587\u4ef6\u7684\u5bf9\u8c61\u4e4b\u524d\uff0c\u4f1a\u7acb\u5373\u5173\u95ed \u6587\u4ef6\u3002\u7136\u800c\uff0c\u8fd9\u884c\u4ee3\u7801\u5728 Jython \u6216 IronPython \u4e2d\u5374\u4e0d\u5b89\u5168\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f7f\u7528\u7684\u662f\u5bbf\u4e3b\u8fd0\u884c\u65f6\uff08Java VM \u548c .NET CLR\uff09\u4e2d\u7684\u5783\u573e\u56de\u6536\u7a0b\u5e8f\uff0c\u90a3\u4e9b\u56de\u6536\u7a0b\u5e8f\u66f4\u590d\u6742\uff0c\u4f46\u662f\u4e0d\u4f9d\u9760\u5f15\u7528\u8ba1\u6570\uff0c\u800c\u4e14\u9500\u6bc1\u5bf9\u8c61\u548c\u5173\u95ed\u6587\u4ef6\u7684\u65f6\u95f4\u53ef\u80fd\u66f4\u957f\u3002</p> <p>\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c\u5305\u62ec CPython\uff0c\u6700\u597d\u663e\u5f0f\u5173\u95ed\u6587\u4ef6\uff1b\u800c\u5173\u95ed\u6587\u4ef6\u7684\u6700\u53ef\u9760\u65b9\u5f0f\u662f\u4f7f\u7528 with \u8bed\u53e5\uff0c\u5b83\u80fd\u4fdd\u8bc1\u6587\u4ef6\u4e00\u5b9a\u4f1a\u88ab\u5173\u95ed\uff0c\u5373\u4f7f\u6253\u5f00\u6587\u4ef6\u65f6\u629b\u51fa\u4e86\u5f02\u5e38\u4e5f\u65e0\u59a8\u3002</p> <p>\u4f7f\u7528 with\uff0c\u4e0a\u8ff0\u4ee3\u7801\u7247\u6bb5\u53d8\u6210\u4e86\uff1a</p> <pre><code>with open('test.txt', 'wt', encoding='utf-8') as fp:\n    fp.write('1, 2, 3')\n</code></pre> <p>\u5173\u4e8e with \u80cc\u540e\u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u673a\u5236\uff0c\u53c2\u8003\u300a\u6d41\u7545\u7684 python\u300b\u7684\u7b2c 15 \u7ae0 \u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u548c else \u5757\u3002</p> <p>with \u8bed\u53e5\u4f1a\u8bbe\u7f6e\u4e00\u4e2a\u4e34\u65f6\u7684\u4e0a\u4e0b\u6587\uff0c\u4ea4\u7ed9\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u5bf9\u8c61\u63a7\u5236\uff0c\u5e76\u4e14\u8d1f\u8d23\u6e05\u7406\u4e0a\u4e0b\u6587\u3002\u8fd9\u4e48\u505a\u80fd\u907f\u514d\u9519\u8bef\u5e76\u51cf\u5c11\u6837\u677f\u4ee3\u7801\uff0c\u56e0\u6b64 API \u66f4\u5b89\u5168\uff0c\u800c\u4e14\u66f4\u6613\u4e8e\u4f7f\u7528\u3002\u9664\u4e86\u81ea\u52a8\u5173\u95ed\u6587\u4ef6\u4e4b\u5916\uff0cwith \u5757\u8fd8\u6709\u5f88\u591a\u7528\u9014\u3002</p> <p>\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u662f\u652f\u6301\u4e24\u4e2a\u65b9\u6cd5\u7684\u5bf9\u8c61\uff1a<code>__enter__</code> \u548c <code>__exit__</code>\u3002 \u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u5bf9\u8c61\u5b58\u5728\u7684\u76ee\u7684\u662f\u7ba1\u7406 with \u8bed\u53e5\uff0c\u5c31\u50cf\u8fed\u4ee3\u5668\u7684\u5b58\u5728\u662f\u4e3a\u4e86\u7ba1\u7406 for \u8bed\u53e5\u4e00\u6837\u3002</p>"},{"location":"blog/20191202/python-function/","title":"python functions","text":"<p>python \u4e2d\u7684\u51fd\u6570\u7c7b\u578b\u4ecb\u7ecd\u3002</p> <p>4.7. Defining Functions 4.8. More on Defining Functions</p> <p>4.8.6. Lambda Expressions \u7ec6\u8bf4Python\u7684lambda\u51fd\u6570\u7528\u6cd5</p>"},{"location":"blog/20191202/python-function/#\u5982\u4f55\u5b9a\u4e49\u51fd\u6570","title":"\u5982\u4f55\u5b9a\u4e49\u51fd\u6570","text":"<p>\u51fd\u6570\u662f\u7ed3\u6784\u5316\u7f16\u7a0b\u7684\u6838\u5fc3\u3002 \u51fd\u6570\u662f\u82e5\u5e72\u4ee3\u7801\u8bed\u53e5\u7684\u7ec4\u5408\uff0c\u6267\u884c\u8bed\u53e5\u5e8f\u5217\u64cd\u4f5c\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u503c\u3002\u4e5f\u53ef\u662f\u65e0\u8fd4\u56de\u503c\uff08\u8fd4\u56deNone\uff09\u7684\u7eaf\u8fc7\u7a0b\u5904\u7406\u3002 \u51fd\u6570\u5f80\u5f80\u662f\u5c06\u4e00\u4e9b\u7279\u5b9a\u4efb\u52a1\u7684\u529f\u80fd\u64cd\u4f5c\u6253\u5305\u5c01\u88c5\u8d77\u6765\uff0c\u65b9\u4fbf\u540e\u7eed\u590d\u7528\uff0c\u51cf\u5c11\u91cd\u590d\u5de5\u4f5c\u91cf\u3002 \u51fd\u6570\u53ef\u7531\u7cfb\u7edf\u6216\u7b2c\u4e09\u65b9\u5de5\u5177\u5305\u63d0\u4f9b\uff0c\u5bf9\u8c03\u7528\u8005\u800c\u8a00\uff0c\u53ef\u89c6\u4f5c\u9ed1\u76d2\uff0c\u4e0d\u5173\u6ce8\u5185\u90e8\u5177\u4f53\u5b9e\u73b0\uff0c\u4ec5\u5173\u6ce8\u529f\u80fd\u548c\u63a5\u53e3\uff08\u8f93\u5165\u53c2\u6570\uff0c\u8f93\u51fa\u8fd4\u56de\u503c\uff09\u3002</p> <p>\u90a3\u4e48\uff0c\u5728 Python \u4e2d\uff0c\u5982\u4f55\u5b9a\u4e49\u51fd\u6570\u5462\uff1f\u4f7f\u7528 <code>def</code> \u8bed\u53e5\u5b9a\u4e49\u51fd\u6570\u3002</p> <p>\u5982\u4e0b\u5b9a\u4e49\u4e86\u51fd\u6570 function \u6846\u67b6\uff0c\u4f46\u662f\u8fd8\u6ca1\u5b9e\u73b0\uff0c\u5148\u7528 pass \u5360\u4f4d\u7b26\u6216return\uff08\u4ec0\u4e48\u4e5f\u4e0d\u8fd4\u56de\uff09\uff0c\u4f7f\u5176\u6709\u5185\u5bb9\u7f16\u8bd1\u901a\u8fc7\u3002 \u540e\u9762\u518d\u6162\u6162\u8865\u5145\u51fd\u6570\u7684\u5177\u4f53\u5b9e\u73b0\u3002</p> <pre><code>def function(args):\n    pass # a function that does nothing (yet)\n</code></pre> <p>\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a\u53c2\u6570\uff0c\u5e76\u4e14\u7ed9\u53c2\u6570\u6307\u5b9a\u6570\u636e\u7c7b\u578b\uff1a</p> <pre><code>def function(args: list):\n    pass\n\n# only procedure, no return value\ndef enroll(name: str, gender: int, age: int):\n    return\n</code></pre> <p>\u53ef\u4ee5\u6307\u5b9a\u8fd4\u56de\u503c\u6570\u636e\u7c7b\u578b\uff0c\u4f8b\u5982\u8f93\u5165\u59d3\u540d\u3001\u6027\u522b\u548c\u5e74\u9f84\uff0c\u8f93\u51fa\u767b\u8bb0\u5165\u4f0d\u662f\u5426\u6210\u529f\u3002 \u7531\u4e8e\u5f81\u5175\u6761\u4ef6\u82db\u523b\uff0c\u8fd9\u91cc\u9ed8\u8ba4\u5148\u8fd4\u56de False\uff0c\u5f85pass\u90e8\u5206\u5b9e\u73b0\u4e86\u5224\u65ad\u6d41\u7a0b\uff0c\u7b26\u5408\u6761\u4ef6\u7684\u624d\u51c6\u8bb8\u53c2\u519b\u3002</p> <pre><code>def enroll(name: str, gender: int, age: int) -&gt; bool:\n    pass # to be done\n    return False\n</code></pre>"},{"location":"blog/20191202/python-function/#\u5b9a\u4e49\u51fd\u6570\u5b57\u7b26\u4e32","title":"\u5b9a\u4e49\u51fd\u6570\u5b57\u7b26\u4e32","text":"<p>\u628a\u5728 def \u8bed\u53e5\u540e\u9762\uff08\u4ee5\u53ca\u6a21\u5757\u548c\u7c7b\u7684\u5f00\u5934\uff09\uff0c\u653e\u5728\u51fd\u6570\u5f00\u5934\u7684\u5b57\u7b26\u4e32\u79f0\u4e3a\u6587\u6863\u5b57\u7b26\u4e32\uff08docstring\uff09\uff0c\u5b83\u5c06\u4f5c\u4e3a\u51fd\u6570\u7684\u4e00\u90e8\u5206\u5b58\u50a8\u8d77\u6765\u3002</p> <pre><code>def enroll(name: str, gender: int, age: int) -&gt; bool:\n    'Determine whether a person is eligible for enlistment by profile.'\n    pass # to be done\n    return False\n</code></pre> <p>\u51fd\u6570\u7684docstring\u4fdd\u5b58\u5728 <code>__doc__</code> \u5c5e\u6027\u4e2d\uff0c\u53ef\u6267\u884c <code>enroll.__doc__</code> \u67e5\u770b\u51fd\u6570\u7684 docstring\u3002</p> <p>\u5c3d\u7ba1\u51fd\u6570\u8fd8\u6ca1\u5b9e\u73b0\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u6267\u884c <code>help(enroll)</code> \u67e5\u770b\u5e2e\u52a9\uff0c\u77e5\u6653\u5176\u9884\u8bbe\u521d\u5fc3\u3002</p>"},{"location":"blog/20191202/python-function/#\u51fd\u6570\u4e24\u79cd\u4f20\u53c2\u6a21\u5f0f","title":"\u51fd\u6570\u4e24\u79cd\u4f20\u53c2\u6a21\u5f0f","text":"<pre><code>def enroll(name: str, gender: int, age: int) -&gt; bool:\n    if gender == 0 and age &gt;= 18 and age &lt;= 28:\n        return True\n    return False\n</code></pre> <p>\u8c03\u7528\u51fd\u6570\u65f6\uff0c\u4e00\u822c\u6309\u7167\u53c2\u6570\u4f4d\u7f6e\u4f20\u9012\u53c2\u6570\uff08positional argument\uff09\uff0c\u4f4d\u7f6e\u81f3\u5173\u91cd\u8981\uff0c\u5fc5\u987b\u4e0e\u5b9a\u4e49\u7684\u53c2\u6570\u987a\u5e8f\u5bf9\u5e94\u3002</p> <pre><code>b=enroll('Cliff', 0, 18)\nprint(b)\n</code></pre> <p>\u6709\u65f6\u5019\uff0c\u53c2\u6570\u7684\u6392\u5217\u987a\u5e8f\u53ef\u80fd\u96be\u4ee5\u8bb0\u4f4f\uff0c\u5c24\u5176\u662f\u53c2\u6570\u5f88\u591a\u65f6\u3002\u4e3a\u4e86\u7b80\u5316\u8c03\u7528\u5de5\u4f5c\uff0c\u53ef\u6307\u5b9a\u53c2\u6570\u7684\u540d\u79f0\u3002</p> <pre><code>b=enroll(name='Harry', gender=0, age=48)\nprint(b)\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0c\u6307\u5b9a\u4e86\u53c2\u6570\u7684\u540d\u79f0\u65f6\uff0c\u53c2\u6570\u7684\u987a\u5e8f\u65e0\u5173\u7d27\u8981\u3002</p> <pre><code>b=enroll(gender=0, age=25, name='Jeff')\nprint(b)\n</code></pre> <p>\u50cf\u8fd9\u6837\u4f7f\u7528\u540d\u79f0\u6307\u5b9a\u7684\u53c2\u6570\u79f0\u4e3a\u5173\u952e\u5b57\u53c2\u6570\uff08keyword argument\uff09\uff0c\u4e3b\u8981\u4f18\u70b9\u662f\u6709\u52a9\u4e8e\u6f84\u6e05\u5404\u4e2a\u53c2\u6570\u7684\u4f5c\u7528\u3002</p> <p>\u4e5f\u53ef\u6df7\u5408\u4f7f\u7528\u4f4d\u7f6e\u53c2\u6570\u548c\u5173\u952e\u5b57\u53c2\u6570\uff0c\u524d\u9762\u51e0\u4e2a\u6309\u4f4d\u7f6e\u7ed9\u5b9a\u4e0d\u5177\u540d\u53c2\u6570\uff0c\u540e\u9762\u7684\u53c2\u6570\u53ef\u4f7f\u7528\u5173\u952e\u5b57\u53c2\u6570\uff08\u987a\u5e8f\u53ef\u4e71\uff09\u3002</p> <pre><code>b=enroll('James', gender=1, age=19)\nprint(b)\nb=enroll('John', age=24, gender=0)\nprint(b)\n</code></pre>"},{"location":"blog/20191202/python-function/#\u6307\u5b9a\u53c2\u6570\u9ed8\u8ba4\u503c","title":"\u6307\u5b9a\u53c2\u6570\u9ed8\u8ba4\u503c","text":"<p>\u5173\u952e\u5b57\u53c2\u6570\u6700\u5927\u7684\u4f18\u70b9\u5728\u4e8e\uff0c\u53ef\u4ee5\u6307\u5b9a\u9ed8\u8ba4\u503c\u3002\u50cf\u8fd9\u6837\u7ed9\u53c2\u6570\u6307\u5b9a\u9ed8\u8ba4\u503c\u540e\uff0c\u8c03\u7528\u51fd\u6570\u65f6\u53ef\u4e0d\u63d0\u4f9b\u5b83\uff01</p> <pre><code>def enroll(name: str = '', gender: int = 0, age: int = 0) -&gt; bool:\n</code></pre> <p>\u5982\u679c\u53ea\u60f3\u6307\u5b9a\u90e8\u5206\u53c2\u6570\u7684\u9ed8\u8ba4\u503c\uff0c\u5219\u8fd9\u4e9b\u53c2\u6570\u8981\u653e\u5728\u6700\u540e\u9762\u3002\u8fd9\u6837\u53ef\u4ee5\u517c\u987e\u4f4d\u7f6e\u6309\u9700\u4f20\u53c2\u3002</p> <pre><code>def enroll(gender: int, age: int, name : str = '') -&gt; bool:\ndef enroll(gender: int, age: int = 0, name : str = '') -&gt; bool:\n</code></pre>"},{"location":"blog/20191202/python-function/#\u51fd\u6570\u5f62\u53c2\u4f5c\u7528\u57df","title":"\u51fd\u6570\u5f62\u53c2\u4f5c\u7528\u57df","text":"<p>\u5b57\u7b26\u4e32\uff08\u4ee5\u53ca\u6570\u548c\u5143\u7ec4\uff09\u662f\u4e0d\u53ef\u53d8\u7684\uff08immutable\uff09\uff0c\u8fd9\u610f\u5473\u7740\u4f60\u4e0d\u80fd\u4fee\u6539\u5b83\u4eec\uff08\u5373\u53ea\u80fd\u66ff\u6362\u4e3a\u65b0\u503c\uff09\u3002 \u51fd\u6570\u53c2\u6570\u5b58\u50a8\u5728\u5c40\u90e8\u4f5c\u7528\u57df\u5185\uff0c\u5728\u51fd\u6570\u5185\u90e8\u7ed9\u5f62\u53c2\u8d4b\u503c\u5bf9\u5916\u90e8\u7684\u5b9e\u53c2\u6ca1\u6709\u4efb\u4f55\u5f71\u54cd\u3002 \u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u5f62\u53c2\u91cd\u65b0\u5173\u8054\uff0c\u53e6\u6709\u6240\u6307\uff0c\u4e0d\u5f71\u54cd\u5916\u90e8\u4f20\u5165\u7684\u5b9e\u53c2\u3002</p> <pre><code>def try_to_change_str(s):\n    s = 'Mr. Gumby'\n\nname = 'Mrs. Entity'\ntry_to_change_str(name)\nprint(name)\n\ndef try_to_change_tuple(t):\n    t = tuple(range(6))\n\nt = tuple(range(5))\ntry_to_change_tuple(t)\nprint(t)\n</code></pre> <p>\u8981\u60f3\u83b7\u53d6 try_to_change \u7cfb\u5217\u51fd\u6570\u5904\u7406\u540e\u7684\u7ed3\u679c\uff0c\u53ef\u8003\u8651 return \u8fd4\u56de\uff0c\u5916\u9762\u63a5\u6536\u8fd4\u56de\u503c\u3002</p> <p>\u5bf9\u4e8e immutable \u7684\u5b57\u7b26\u4e32\uff0c\u5b9e\u9645\u662f\u8d4b\u503c\uff08\u526f\u672c\uff09\u4f20\u53c2\uff0c\u5728\u5176\u5185\u90e8\u6267\u884c\u64cd\u4f5c\uff0c\u4e0d\u5f71\u54cd\u5916\u90e8\u7684\u5b9e\u53c2\u539f\u4ef6\u3002</p> <pre><code>def try_to_change_str(s):\n    s.replace('Mrs', 'Mr')\n\nname = 'Mrs. Entity'\ntry_to_change_str(name)\nprint(name)\n</code></pre> <p>\u4f46\u5217\u8868 list \u662f mutable sequence\uff0c\u5f53\u4f20\u9012\u5217\u8868\u4f5c\u4e3a\u53c2\u6570\u65f6\uff0c\u5f62\u53c2\u548c\u5b9e\u53c2\u5c06\u6307\u5411\u540c\u4e00\u4e2a\u539f\u59cb\u5217\u8868\u3002 \u76f8\u5f53\u4e8eC\u8bed\u8a00\u4e2d\u7684\u5f15\u7528\u6216\u6307\u9488\u4f20\u53c2\uff0c\u51fd\u6570\u5185\u90e8\u5bf9\u8be5\u53d8\u91cf\u7684\u64cd\u4f5c\u5c06\u76f4\u63a5\u5f71\u54cd\u539f\u59cb\u53d8\u91cf\u3002</p> <pre><code>def try_to_change_list1(l):\n    l = list(range(6)) # \u5f62\u53c2\u53e6\u6709\u6240\u6307\uff0c\u4e0e\u5b9e\u53c2\u5206\u79bb\uff0c\u4e0d\u5f71\u54cd\u539f\u4ef6\n\ndef try_to_change_list2(l):\n    l.append(6) # \u4fee\u6539\u5f62\u53c2\u6240\u6307\uff0c\u76f4\u63a5\u5f71\u54cd\u539f\u4ef6\n\nl = list(range(5))\ntry_to_change_list1(l)\nprint(l)\n\ntry_to_change_list2(l)\nprint(l)\n</code></pre> <p>\u5982\u679c\u4f20\u5165\u5217\u8868\uff0c\u53ea\u662f\u60f3\u770b\u770b\u51fd\u6570\u5904\u7406\u7684\u7ed3\u679c\uff0c\u800c\u4e0d\u5e0c\u671b\u5f71\u54cd\u5916\u9762\u7684\u539f\u59cb\u5217\u8868\uff0c\u53ef\u4ee5\u8003\u8651\u901a\u8fc7\u5168\u5207\u7247\u62f7\u8d1d\uff08[:] \u6216 copy\uff09\u4f20\u5165\u526f\u672c\u3002</p> <pre><code>def try_to_change_list(l):\n    l.append(6)\n\nl = list(range(5))\nm = l[:] # l.copy()\ntry_to_change_list(m)\nprint(l)\n</code></pre>"},{"location":"blog/20191202/python-function/#\u4f20\u9012\u4efb\u610f\u6570\u91cf\u7684\u5b9e\u53c2","title":"\u4f20\u9012\u4efb\u610f\u6570\u91cf\u7684\u5b9e\u53c2","text":"<p>\u300aPython\u7f16\u7a0b\u4ece\u5165\u95e8\u5230\u5b9e\u8df5\u300b\u4e2d\u7684 \u7b2c8\u7ae0 \u51fd\u6570 - 8.5 \u4f20\u9012\u4efb\u610f\u6570\u91cf\u7684\u5b9e\u53c2\uff0c\u6709\u70b9\u7c7b\u4f3cC\u8bed\u8a00\u4e2d\u7684\u53ef\u53d8\u53c2\u6570\uff08stdarg.h \u4e2d\u7684 va_list\uff09\u3002</p>"},{"location":"blog/20191202/python-function/#\u4f20\u9012\u4efb\u610f\u6570\u91cf\u7684\u4e0d\u8bb0\u540d\u5b9e\u53c2","title":"\u4f20\u9012\u4efb\u610f\u6570\u91cf\u7684\u4e0d\u8bb0\u540d\u5b9e\u53c2","text":"<p>\u4e0b\u9762\u7684\u51fd\u6570\u53ea\u6709\u4e00\u4e2a\u5f62\u53c2 <code>*toppings</code>\uff0c\u4e0d\u7ba1\u8c03\u7528\u8bed\u53e5\u63d0\u4f9b\u591a\u5c11\u5b9e\u53c2\uff0c\u8fd9\u4e2a\u5f62\u53c2\u90fd\u5c06\u5b83\u4eec\u7edf\u7edf\u6253\u5305\u5230\u5176\u4e2d\uff1a</p> <pre><code>def make_pizza(*toppings):\n    \"\"\"\u6253\u5370\u987e\u5ba2\u70b9\u7684\u6240\u6709\u914d\u6599\"\"\" \n    print(toppings)\n</code></pre> <p>\u5f62\u53c2\u540d <code>*toppings</code> \u4e2d\u7684\u661f\u53f7\u8ba9 Python \u521b\u5efa\u4e00\u4e2a\u540d\u4e3a toppings \u7684\u7a7a\u5143\u7ec4\uff08tuple()\uff09\uff0c\u5e76\u5c06\u6536\u5230\u7684\u6240\u6709\u503c\u90fd\u5c01\u88c5\u5230\u8fd9\u4e2a\u5143\u7ec4\u4e2d\u3002</p> <p>\u5177\u4f53\u53c2\u8003 Python \u661f\u53f7\u8868\u8fbe\u5f0f\uff08starred expression\uff09: </p> <p>An asterisk <code>*</code> denotes iterable unpacking. Its operand must be an iterable. The iterable is expanded into a sequence of items, which are included in the new tuple, list, or set, at the site of the unpacking.</p> <pre><code>def make_pizza(*toppings):\n    \"\"\"\u6253\u5370\u987e\u5ba2\u70b9\u7684\u6240\u6709\u914d\u6599\"\"\"\n    # print(type(toppings), len(toppings))\n    print(toppings)\n\nmake_pizza('pepperoni')\nmake_pizza('mushrooms', 'green peppers', 'extra cheese')\n</code></pre> <p>\u4f8b\u5982\uff0c\u4f20\u5165\u4efb\u610f\u4e2a\u6574\u6570\u8fdb\u884c\u6c42\u548c\uff1a</p> <p>\u6709\u70b9\u7c7b\u4f3c builtins.sum\uff0c\u652f\u6301\u5bf9\u4e0d\u5b9a\u957f\u6570\u503c\u5e8f\u5217\u8fdb\u884c\u8fed\u4ee3\u6c42\u548c\u3002</p> <pre><code>def add(*numbers):\n    r = 0\n    for e in numbers:\n        r += e\n    return r\n\nadd(1,3,5,7,9)\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u7ed3\u5408\u4f7f\u7528\u4f4d\u7f6e\u5b9e\u53c2\u548c\u4efb\u610f\u6570\u91cf\u5b9e\u53c2\u3002</p> <p>\u5982\u679c\u8981\u8ba9\u51fd\u6570\u63a5\u53d7\u4e0d\u540c\u7c7b\u578b\u7684\u5b9e\u53c2\uff0c\u5fc5\u987b\u5728\u51fd\u6570\u5b9a\u4e49\u4e2d\u5c06\u63a5\u7eb3\u4efb\u610f\u6570\u91cf\u5b9e\u53c2\u7684\u5f62\u53c2\u653e\u5728\u6700\u540e\u3002 Python\u5148\u5339\u914d\u4f4d\u7f6e\u5b9e\u53c2\u548c\u5173\u952e\u5b57\u5b9e\u53c2\uff0c\u518d\u5c06\u4f59\u4e0b\u7684\u5b9e\u53c2\u90fd\u6536\u96c6\u5230\u6700\u540e\u4e00\u4e2a\u5f62\u53c2\u4e2d\u3002 make_pizza \u6dfb\u52a0\u4e00\u4e2a\u53c2\u6570\uff0c\u5148\u4f20\u5165\u5c3a\u5bf8\uff0c\u518d\u4f20\u5165\u914d\u6599\u8868\u3002</p> <pre><code>def make_pizza(size, *toppings):\n    \"\"\"\u6982\u8ff0\u8981\u5236\u4f5c\u7684\u6bd4\u8428\"\"\"\n    print(\"\\nMaking a \" + str(size) + \"-inch pizza with the following toppings:\")\n    for topping in toppings:\n        print(\"- \" + topping)\n\nmake_pizza(16, 'pepperoni')\nmake_pizza(12, 'mushrooms', 'green peppers', 'extra cheese')\n</code></pre>"},{"location":"blog/20191202/python-function/#\u4f7f\u7528\u4efb\u610f\u6570\u91cf\u7684\u5173\u952e\u5b57\u5b9e\u53c2","title":"\u4f7f\u7528\u4efb\u610f\u6570\u91cf\u7684\u5173\u952e\u5b57\u5b9e\u53c2","text":"<p>\u6709\u65f6\u5019\uff0c\u9700\u8981\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u5b9e\u53c2\uff0c\u4f46\u9884\u5148\u4e0d\u77e5\u9053\u4f20\u9012\u7ed9\u51fd\u6570\u7684\u4f1a\u662f\u4ec0\u4e48\u6837\u7684\u4fe1\u606f\uff08\u5305\u62ec\u53c2\u6570\u540d\u548c\u53c2\u6570\u503c\uff09\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u5c06\u51fd\u6570\u7f16\u5199\u6210\u80fd\u591f\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\uff08\u53c2\u6570\u540d\u548c\u53c2\u6570\u503c\uff09\u2014\u2014\u8c03\u7528\u8bed\u53e5\u63d0\u4f9b\u4e86\u591a\u5c11\u5c31\u63a5\u53d7\u591a\u5c11\u3002</p> <pre><code>def build_profile(first, last, **user_info):\n    \"\"\"\u521b\u5efa\u4e00\u4e2a\u5b57\u5178\uff0c\u5176\u4e2d\u5305\u542b\u6211\u4eec\u77e5\u9053\u7684\u6709\u5173\u7528\u6237\u7684\u4e00\u5207\"\"\"\n    # print(type(user_info), len(user_info))\n    profile = {}\n    profile['first_name'] = first\n    profile['last_name'] = last\n    for key, value in user_info.items():\n        profile[key] = value\n    return profile\n\nuser_profile = build_profile('albert',\n                              'einstein',\n                              location='princeton',\n                              field='physics')\nprint(user_profile)\n</code></pre> <p>\u51fd\u6570 build_profile \u7684\u524d\u4e24\u4e2a\u53c2\u6570\u8981\u6c42\u63d0\u4f9b\u540d\u548c\u59d3\uff0c\u540c\u65f6\u5141\u8bb8\u7528\u6237\u6839\u636e\u9700\u8981\u63d0\u4f9b\u5176\u4ed6\u989d\u5916\u8865\u5145\u4fe1\u606f\uff08user_info\uff09\u3002 \u5f62\u53c2 <code>**user_info</code> \u4e2d\u7684\u4e24\u4e2a\u661f\u53f7\u8ba9 Python \u521b\u5efa\u4e00\u4e2a\u7a7a\u5b57\u5178\uff08dict()\uff09\uff0c\u5e76\u5c06\u6536\u5230\u7684\u6240\u6709\u53c2\u6570\u5bf9\u90fd\u5c01\u88c5\u5230\u8fd9\u4e2a\u5b57\u5178\u4e2d\u3002 \u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d\uff0c\u53ef\u4ee5\u50cf\u8bbf\u95ee\u5176\u4ed6\u5b57\u5178\u90a3\u6837\u8bbf\u95ee user_info \u4e2d\u7684\u53c2\u6570\u5bf9\u3002</p> <p>\u5177\u4f53\u53c2\u8003 help(dict) \u4e2d\u7684\u53cc\u661f\u6784\u9020\u6cd5\uff1a</p> <pre><code>dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs\n</code></pre>"},{"location":"blog/20191202/python-function/#\u7efc\u5408\u4f7f\u7528\u661f\u53f7\u548c\u53cc\u661f\u53f7\u6536\u96c6\u53d8\u53c2","title":"\u7efc\u5408\u4f7f\u7528\u661f\u53f7\u548c\u53cc\u661f\u53f7\u6536\u96c6\u53d8\u53c2","text":"<p>\u4ee5\u4e0b\u7efc\u5408\u793a\u4f8b\uff0c\u524d\u4e09\u4e2a\u662f\u4f4d\u7f6e\u53c2\u6570\uff0cpospar\u6536\u96c6\u4e2d\u95f4\u7684\u4e0d\u5b9a\u91cf\u53d8\u53c2\uff0ckeypar\u6536\u96c6\u5177\u540d\u5173\u952e\u5b57\u53c2\u6570\u3002</p> <pre><code>def print_params_4(x, y, z=3, *pospar, **keypar):\n    print(x, y, z) # first three\n    print(pospar)  # middle tuple\n    print(keypar)  # last dict\n\nprint_params_4(1, 2, 3, 5, 6, 7, foo=1, bar=2)\n</code></pre>"},{"location":"blog/20191202/python-function/#\u7efc\u5408\u4f7f\u7528\u661f\u53f7\u548c\u53cc\u661f\u53f7\u5206\u914d\u53c2\u6570","title":"\u7efc\u5408\u4f7f\u7528\u661f\u53f7\u548c\u53cc\u661f\u53f7\u5206\u914d\u53c2\u6570","text":"<p>\u524d\u9762\u4ecb\u7ecd\u4e86\u5982\u4f55\u5c06\u53c2\u6570\u6536\u96c6\u5230\u5143\u7ec4\u548c\u5b57\u5178\u4e2d\uff0c\u4f46\u7528\u540c\u6837\u7684\u4e24\u4e2a\u8fd0\u7b97\u7b26\uff08*\u548c**\uff09\u4e5f\u53ef\u6267\u884c\u76f8\u53cd\u7684\u64cd\u4f5c\u3002</p> <p>\u5047\u8bbe\u6709\u5982\u4e0b\u51fd\u6570\uff1a</p> <pre><code>def add(x, y):\n    return x + y\n</code></pre> <p>\u5047\u8bbe\u8fd8\u6709\u4e00\u4e2a\u5143\u7ec4\uff08\u6216\u5217\u8868\u3001\u96c6\u5408\uff09\uff0c\u5176\u4e2d\u5305\u542b\u4e24\u4e2a\u4f60\u8981\u76f8\u52a0\u7684\u6570\u3002</p> <ul> <li>pt = (1, 2)</li> <li>pl = [3, 4]</li> <li>ps = {5, 6}</li> </ul> <p>\u5728\u8c03\u7528\u51fd\u6570\uff08\u800c\u4e0d\u662f\u5b9a\u4e49\u51fd\u6570\uff09\u65f6\uff0c\u53ef\u4f7f\u7528\u8fd0\u7b97\u7b26 * \u53ef\u5bf9\u5e8f\u5217\u8fdb\u884c\u89e3\u5f15\u7528\uff08\u679a\u4e3e\u904d\u5386\uff09\uff0c\u6309\u4f4d\u7f6e\u5e8f\u53f7\u8fdb\u884c\u8fed\u4ee3\u5206\u914d\u3002 \u8fd9\u4e0e\u524d\u9762\u6267\u884c\u7684\u64cd\u4f5c\u5dee\u4e0d\u591a\u662f\u76f8\u53cd\u7684\uff1a\u4e0d\u662f\u6536\u96c6\u53c2\u6570\uff0c\u800c\u662f\u5206\u914d\u53c2\u6570\u3002</p> <pre><code>pt = (1, 2)\nadd(*pt)\n\npl = [3, 4]\nadd(*pl)\n\nps = {5, 6}\nadd(*ps)\n</code></pre> <p>\u6ce8\u610f\uff1a\u5e8f\u5217\u4e2d\u5143\u7d20\u7684\u4e2a\u6570\u5fc5\u987b\u548c\u51fd\u6570\u80fd\u63a5\u53d7\u7684\u53c2\u6570\u4e2a\u6570\u5339\u914d\uff0c\u5426\u5219\u62a5\u9519\uff01</p>"},{"location":"blog/20191205/python-try-except/","title":"python\u4e4b\u5f02\u5e38\u6355\u83b7(try...except)","text":"<p>\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86 python \u4e2d\u7684\u5f02\u5e38\u6355\u83b7\u3002</p> <p>Python try\u2026except \u5f02\u5e38\u5904\u7406\u6a21\u5757 Python \u5f02\u5e38\u5904\u7406 try...except\u3001raise python\u4e2d\u7684try/except/else/finally\u8bed\u53e5 </p>","tags":["try","except"]},{"location":"blog/20191205/python-try-except/#pep","title":"PEP","text":"<p>doc \u7f51\u7ad9 \u641c\u7d22 <code>except</code>\uff1a</p> <p>PEP 341 -- Unifying try-except and try-finally</p>","tags":["try","except"]},{"location":"blog/20191205/python-try-except/#abstract","title":"Abstract","text":"<pre><code>try:\n    &lt;do something&gt;\nexcept Exception:\n    &lt;handle the error&gt;\nfinally:\n    &lt;cleanup&gt;\n</code></pre>","tags":["try","except"]},{"location":"blog/20191205/python-try-except/#rationaleproposal","title":"Rationale/Proposal","text":"<pre><code>try:\n    &lt;suite 1&gt;\nexcept Ex1:\n    &lt;suite 2&gt;\n&lt;more except: clauses&gt;\nelse:\n    &lt;suite 3&gt;\nfinally:\n    &lt;suite 4&gt;\n</code></pre>","tags":["try","except"]},{"location":"blog/20191205/python-try-except/#reference","title":"Reference","text":"<p>\u63a7\u5236\u53f0\u6267\u884c <code>help('except')</code>\uff1a</p> <pre><code>Before an except clause\u2019s suite is executed, details about the\nexception are stored in the \"sys\" module and can be accessed via\n\"sys.exc_info()\". \"sys.exc_info()\" returns a 3-tuple consisting of the\nexception class, the exception instance and a traceback object (see\nsection The standard type hierarchy) identifying the point in the\nprogram where the exception occurred.  \"sys.exc_info()\" values are\nrestored to their previous values (before the call) when returning\nfrom a function that handled an exception.\n\nRelated help topics: EXCEPTIONS\n</code></pre> <p>\u63a7\u5236\u53f0\u6267\u884c <code>help('EXCEPTIONS')</code>\uff1a</p> <pre><code>Exceptions are a means of breaking out of the normal flow of control\nof a code block in order to handle errors or other exceptional\nconditions.  An exception is *raised* at the point where the error is\ndetected; it may be *handled* by the surrounding code block or by any\ncode block that directly or indirectly invoked the code block where\nthe error occurred.\n\nRelated help topics: try, except, finally, raise\n</code></pre> <p>\u6216\u5728 The Python Language Reference \u641c\u7d22 <code>Exceptions</code>\u3002</p>","tags":["try","except"]},{"location":"blog/20191205/python-try-except/#library","title":"Library","text":"<p>The Python Standard Library \u641c\u7d22 <code>Exceptions</code></p> <p>\u76f8\u5173\u5e93\u4ecb\u7ecd\uff1aBuilt-in Exceptions</p> <p>\u5176\u4e2d\u5217\u4e3e\u4e86\u5e38\u89c1\u5f02\u5e38\u7ee7\u627f\u4f53\u7cfb\uff1aException hierarchy\u3002</p> <p>\u6267\u884c <code>help(BaseException)</code> \u67e5\u770b\u57fa\u672c\u5143\u7d20\uff1a</p> <pre><code> |  ----------------------------------------------------------------------\n |  Data descriptors defined here:\n |\n |  __cause__\n |      exception cause\n |\n |  __context__\n |      exception context\n |\n |  __dict__\n |\n |  __suppress_context__\n |\n |  __traceback__\n |\n |  args\n</code></pre>","tags":["try","except"]},{"location":"blog/20191205/python-try-except/#tutorial","title":"Tutorial","text":"<p>\u5728 The Python Tutorial \u641c\u7d22 <code>Exceptions</code></p> <p>\u76f8\u5173\u6559\u7a0b\uff1aErrors and Exceptions</p>","tags":["try","except"]},{"location":"blog/20191205/python-try-except/#demos","title":"demos","text":"<pre><code>try:\n    mbr_log_file = open('nosuchfile.md')\nexcept Exception as exc:\n    print(exc)\nexcept:\n    print('A exception flew by!')\n    raise\nfinally:\n    # sys.exit()\n    print('finally')\n</code></pre> <p>\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e0b\u4e0d\u5b58\u5728\u6307\u5b9a\u6587\u4ef6\u65f6\uff0c\u6267\u884c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>[Errno 2] No such file or directory: 'nosuchfile.md'\nfinally\n</code></pre> <p>\u7b2c\u4e00\u4e2a except \u8bed\u53e5\u6355\u83b7\u901a\u7528\u7684 <code>Exception</code> \u5e76\u6253\u5370\u51fa\u6765\u3002 \u7b2c\u4e8c\u4e2a except \u8bed\u53e5\u6ca1\u6709\u6307\u5b9a\u5177\u4f53\u7684\u5f02\u5e38\u5bf9\u8c61\u7c7b\u578b\uff0c\u6309\u9ed8\u8ba4\u5f02\u5e38\u5904\u7406\u3002</p> <p>\u4ece BaseException \u7684\u7ee7\u627f\u4f53\u7cfb\u53ef\u77e5\uff0c\u53ef\u4ee5\u7528\u6269\u53f7\u6307\u5b9a\u5176\u4ed6\u4e09\u7c7b\u5f02\u5e38 tuple\uff0c\u5e76\u7edf\u79f0\u522b\u540d\u4e3a exc\uff1a</p> <pre><code>except (SystemExit, KeyboardInterrupt, GeneratorExit) as exc:\n</code></pre> <p>\u7b2c3\u4e2a except \u4e5f\u53ef\u4ee5\u6362\u6210 else \u58f0\u660e\uff0c\u6253\u5370\u4e00\u53e5 <code>A exception flew by!</code> \u540e\uff0c\u8c03\u7528 <code>raise</code> \u629b\u56de\u7ed9\u7cfb\u7edf\u6267\u884c\u9ed8\u8ba4\u5904\u7406\u3002</p>","tags":["try","except"]},{"location":"blog/20191205/python-try-except/#exc_info","title":"exc_info","text":"<p>\u5982\u679c except \u540e\u9762\u4e0d\u6307\u5b9a\u5177\u4f53\u7684\u5f02\u5e38\u7c7b\u578b\uff0c\u53ef\u4ee5\u6253\u5370 <code>sys.exc_info()</code> \u4e09\u5143\u7ec4\uff083-tuple\uff09\u83b7\u53d6\u76f8\u5173\u5f02\u5e38\u4fe1\u606f\uff1a</p> <pre><code>import sys\n\ntry:\n    mbr_log_file = open('nosuchfile.md')\nexcept:\n    print(sys.exc_info()[0]) # exception class\n    print(sys.exc_info()[1]) # exception instance\n    # print(sys.exc_info()[2]) # traceback object\nfinally:\n    # sys.exit()\n    print('finally')\n</code></pre> <p>\u6267\u884c\u7ed3\u679c\uff1a</p> <pre><code>&lt;class 'FileNotFoundError'&gt;\n[Errno 2] No such file or directory: 'nosuchfile.md'\nfinally\n</code></pre>","tags":["try","except"]},{"location":"blog/20191205/python-try-except/#unicodedecodeerror","title":"UnicodeDecodeError","text":"<p>As for guessing the encoding, then you can just loop through the encoding from most to least specific:</p> <pre><code>def decode(s):\n    for encoding in \"utf-8-sig\", \"utf-16\":\n        try:\n            return s.decode(encoding)\n        except UnicodeDecodeError:\n            continue\n    return s.decode(\"ISO-8859-1\") # fallback, will always work\n</code></pre> <p>An <code>UTF-16</code> encoded file wont decode as <code>UTF-8</code>, so we try with <code>UTF-8</code> first. If that fails, then we try with <code>UTF-16</code>.  Finally, we use <code>ISO-8859-1</code> \u2014 this will always work since all 256 bytes are legal values in <code>ISO-8859-1</code>.</p>","tags":["try","except"]},{"location":"blog/20191202/python-typeid/","title":"python type & id","text":"<p>python \u4e2d\u7684\u7c7b\u578b\u5224\u65ad\uff0c\u5305\u62ec type, id, is, isinstance, hasattr \u7b49\u5185\u5bb9\u3002</p> <p>The Python Standard Library</p>"},{"location":"blog/20191202/python-typeid/#type","title":"type","text":"<p>type \u4e3a\u5185\u5efa\u6a21\u5757\uff08builtins\uff09\u4e2d\u5b9a\u4e49\u7684\u57fa\u672c\u7c7b\u578b\u3002</p> <pre><code>&gt;&gt;&gt; help(type)\n\nHelp on class type in module builtins:\n\nclass type(object)\n |  type(object_or_name, bases, dict)\n |  type(object) -&gt; the object's type\n |  type(name, bases, dict) -&gt; a new type\n</code></pre> <p>\u6267\u884c <code>type(object)</code>  \u53ef\u67e5\u770b\u53d8\u91cf\u7684\u7c7b\u578b\uff1a</p> <pre><code>&gt;&gt;&gt; i=2018\n&gt;&gt;&gt; print(type(i))\n&lt;class 'int'&gt;\n\n&gt;&gt;&gt; str_1 = str()\n&gt;&gt;&gt; print(type(str_1))\n&lt;class 'str'&gt;\n</code></pre>"},{"location":"blog/20191202/python-typeid/#id","title":"id","text":"<p>\u6267\u884c <code>help(builtins)</code> \u53ef\u4ee5\u67e5\u770b\u5230\u5185\u7f6e\u51fd\u6570 <code>id()</code>\uff1a</p> <pre><code>&gt;&gt;&gt; help(builtins)\n\nHelp on built-in module builtins:\n\n    id(obj, /)\n        Return the identity of an object.\n</code></pre> <p><code>id(obj)</code> \u7528\u4e8e\u83b7\u53d6\u7c7b\u6216\u5bf9\u8c61\u7684\u7c7b\u578b ID\u3002</p> <pre><code># \u4e5f\u53ef\u6267\u884c print(id.__doc__)\n\n&gt;&gt;&gt; help(id)\n\nHelp on built-in function id in module builtins:\n\nid(obj, /)\n    Return the identity of an object.\n\n    This is guaranteed to be unique among simultaneously existing objects.\n    (CPython uses the object's memory address.)\n</code></pre> <p>\u4ee5\u4e0b\u6d4b\u8bd5\u6253\u5370\u7c7b str \u548c\u5b9e\u4f8b str1 \u548c str2 \u7684\u7c7b\u578b ID\uff1a</p> <pre><code>&gt;&gt;&gt; str1=str()\n&gt;&gt;&gt; str2='str2'\n&gt;&gt;&gt; id(str)\n4363629888\n&gt;&gt;&gt; id(str1)\n4364618416\n&gt;&gt;&gt; id(str2)\n4391268056\n</code></pre>"},{"location":"blog/20191202/python-typeid/#isinstance","title":"isinstance","text":"<pre><code>    isinstance(obj, class_or_tuple, /)\n        Return whether an object is an instance of a class or of a subclass thereof.\n</code></pre>"},{"location":"blog/20191202/python-typeid/#hasattrgetattrsetattrdelattr","title":"hasattr/getattr/setattr/delattr","text":"<ol> <li><code>hasattr</code>: \u5224\u65ad\u5bf9\u8c61 obj \u662f\u5426\u6709\u540d\u79f0\u4e3a name \u7684\u5c5e\u6027\uff0c\u8fd4\u56de bool \u7c7b\u578b\u3002</li> <li><code>getattr</code>: \u83b7\u53d6\u5bf9\u8c61 obj \u540d\u79f0\u4e3a name \u7684\u5c5e\u6027\uff0c\u652f\u6301\u6307\u5b9a\u9ed8\u8ba4\u503c default\u3002</li> <li><code>setattr</code>: \u5c06\u5bf9\u8c61 obj \u540d\u79f0\u4e3a name \u7684\u5c5e\u6027\u8bbe\u7f6e\u4e3a\u6307\u5b9a\u7684\u503c value\u3002</li> <li><code>delattr</code>: \u5220\u9664\u5bf9\u8c61 obj \u540d\u79f0\u4e3a name \u7684\u5c5e\u6027\u3002</li> </ol> <pre><code>hasattr(obj, name, /)\n    Return whether the object has an attribute with the given name.\n\n    This is done by calling getattr(obj, name) and catching AttributeError.\n\ngetattr(...)\n    getattr(object, name[, default]) -&gt; value\n\n    Get a named attribute from an object; getattr(x, 'y') is equivalent to x.y.\n    When a default argument is given, it is returned when the attribute doesn't\n    exist; without it, an exception is raised in that case.\n\nsetattr(obj, name, value, /)\n    Sets the named attribute on the given object to the specified value.\n\n    setattr(x, 'y', v) is equivalent to ``x.y = v``\n\ndelattr(obj, name, /)\n    Deletes the named attribute from the given object.\n\n    delattr(x, 'y') is equivalent to ``del x.y``\n</code></pre> <p>python - How to check if an object has an attribute? - Stack Overflow</p> <pre><code>if not hasattr(someObject, 'someProp'):\n    # Set someProp\n    setattr(someObject, 'someProp', var_or_method)\n    pass\n\nif hasattr(someObject, 'someProp'):\n    # Access someProp\n    # prop = someObject.someProp\n    # prop = getattr(someObject, 'someProp')\n    pass\n\ntry:\n    getattr(someObject, 'someProp')\nexcept AttributeError:\n    print \"someObject not hasattr someProp\"\nelse\n    print \"someObject hasattr someProp\"\n</code></pre> <p>\u5047\u5982\u8981\u8bbe\u8ba1\u4e00\u4e2a\u4e8c\u5206\u67e5\u627e\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u7cbe\u5fc3\u6311\u9009\u5e8f\u5217\u7684\u4e00\u4e9b\u6307\u5b9a\u7d22\u5f15\u5143\u7d20\u8fdb\u884c\u67e5\u627e\uff0c\u5224\u65ad\u67e5\u627e\u51fa\u7684\u7d22\u5f15\u662f\u5426\u7b26\u5408\u9884\u671f\u3002 \u4e3a\u4e86\u6d4b\u8bd5\u5faa\u73af\u548c\u9012\u5f52\u4e24\u79cd\u7b97\u6cd5\uff0c\u6211\u4eec\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u57fa\u7840\u7c7b TestBSearch\uff0c\u63d0\u4f9b\u63a5\u53e3 set_binary_search \u4f9b\u5b50\u7c7b\u8bbe\u5b9a\u8981\u6d4b\u8bd5\u7684\u76ee\u6807\u7b97\u6cd5\uff08\u51fd\u6570\uff09\u3002</p> <p>\u5b50\u7c7b\u7684 <code>__init__</code> \u6216 <code>setUp</code> \u4e2d\u8c03\u7528\u8be5\u63a5\u53e3\u8bbe\u5b9a\u76ee\u6807\u7b97\u6cd5\u51fd\u6570\u3002</p> <p>\u8fd9\u91cc\u628a\u4f20\u5165\u7684 binary_search \u6302\u63a5\u5230\u5c5e\u6027 bsearch \u4e0a\uff0c\u4ee5\u4f9b\u540e\u7eed test \u6d4b\u8bd5\u7528\u4f8b\u8c03\u7528\u3002 \u7531\u4e8e\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u6267\u884c\u65f6\u90fd\u4f1a\u8c03\u7528\u4e00\u904d <code>__init__</code> \u6216 <code>setUp</code>\uff0c\u8fd9\u91cc\u8fdb\u884c\u53bb\u91cd\u5224\u65ad\u3002 \u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u5c5e\u6027\u624d\u6302\u63a5\uff0c\u5426\u5219\u4e0d\u91cd\u590d\u6302\u63a5\u3002</p> <pre><code>class TestBSearch(unittest.TestCase):\n\n    # \u8bbe\u7f6e\u4e8c\u5206\u67e5\u627e\u641c\u7d22\u51fd\u6570\n    def set_binary_search(self, binary_search):\n        if not hasattr(self, 'bsearch'):\n            self.bsearch = binary_search\n</code></pre>"},{"location":"blog/20191202/python-typeid/#class_method","title":"class method","text":""},{"location":"blog/20191202/python-typeid/#base","title":"base","text":"<p>\u6267\u884c <code>obj.__base__()</code> \u6216 <code>obj.__bases__()</code> \u53ef\u4ee5\u67e5\u770b obj \u7684\u57fa\u7c7b\u3002</p> <pre><code># str \u7684\u57fa\u7c7b\u662f object\n&gt;&gt;&gt; print(str.__base__)\n&lt;class 'object'&gt;\n\n# bool \u7684\u57fa\u7c7b\u662f int\n&gt;&gt;&gt; print(bool.__base__)\n&lt;class 'int'&gt;\n&gt;&gt;&gt; print(bool.__bases__)\n(&lt;class 'int'&gt;,)\n\n# int \u7684\u57fa\u7c7b\u662f object\n&gt;&gt;&gt; print(int.__base__)\n&lt;class 'object'&gt;\n</code></pre>"},{"location":"blog/20191202/python-typeid/#subclasses","title":"subclasses","text":"<p>\u67d0\u4e9b\u7c7b\u522b\u63d0\u4f9b\u4e86 <code>__subclasscheck__()</code> \u65b9\u6cd5\uff0c\u7528\u4e8e\u68c0\u6d4b\u662f\u5426\u662f\u5176\u4ed6\u7c7b\u7684\u5b50\u7c7b\u3002</p> <pre><code> |  __subclasscheck__(...)\n |      __subclasscheck__() -&gt; bool\n |      check if a class is a subclass\n</code></pre> <p><code>__subclasses__()</code> \u65b9\u6cd5\u5219\u7528\u4e8e\u5217\u4e3e\u5b50\u7c7b\u3002</p> <pre><code> |  __subclasses__(...)\n |      __subclasses__() -&gt; list of immediate subclasses\n</code></pre> <p>\u6267\u884c <code>int.__subclasses__()</code> \u53ef\u5217\u4e3e\u67e5\u770b int \u7684\u5b50\u7c7b\uff1a</p> <pre><code>&gt;&gt;&gt; print(int.__subclasses__())\n[&lt;class 'bool'&gt;, &lt;enum 'IntEnum'&gt;, &lt;enum 'IntFlag'&gt;, &lt;class 'sre_constants._NamedIntConstant'&gt;]\n</code></pre> <p>\u7279\u4f8b\uff1a\u67e5\u770b object \u6240\u6709\u7684\u5b50\u7c7b\uff0c\u76f8\u5f53\u4e8e\u5217\u4e3e\u6240\u6709\u53ef\u7528\u7684\u7c7b\uff1a</p> <pre><code>&gt;&gt;&gt; print(object.__subclasses__())\n</code></pre> <pre><code>    issubclass(cls, class_or_tuple, /)\n        Return whether 'cls' is a derived from another class or is the same class.\n</code></pre>"},{"location":"blog/20191202/python-typeid/#is_is_not","title":"is, is not","text":"<p>reference - 6.10.3. Identity comparisons</p> <p>The operators <code>is</code> and <code>is not</code> test for object identity: <code>x is y</code> is true if and only if x and y are the same object. Object identity is determined using the <code>id()</code> function. x is not y yields the inverse truth value. </p> <pre><code>&gt;&gt;&gt; str1='str1'\n&gt;&gt;&gt; str2=str1\n&gt;&gt;&gt; str1 is str2\nTrue\n&gt;&gt;&gt;\n&gt;&gt;&gt; str2='str1'\n&gt;&gt;&gt; str1 is str2\nTrue\n&gt;&gt;&gt;\n&gt;&gt;&gt; str2='str2'\n&gt;&gt;&gt; str1 is str2\nFalse\n</code></pre>"},{"location":"blog/20191202/python-typeid/#inspect","title":"inspect","text":"<pre><code>&gt;&gt;&gt; import inspect\n&gt;&gt;&gt; help(inspect)\n\nHelp on module inspect:\n\nNAME\n    inspect - Get useful information from live Python objects.\n\n\n\n# \u5224\u65ad object \u662f\u5426\u4e3a\u6a21\u5757\ninspect.ismodule(object)\nReturn true if the object is a module.\n\n# \u5224\u65ad object \u662f\u5426\u4e3a\u7c7b\ninspect.isclass(object)\nReturn true if the object is a class, whether built-in or created in Python code.\n\n# \u5224\u65ad object \u662f\u5426\u4e3a\u7ed1\u5b9a\u65b9\u6cd5\ninspect.ismethod(object)\nReturn true if the object is a bound method written in Python.\n\n# \u5224\u65ad object \u662f\u5426\u4e3a\u51fd\u6570\ninspect.isfunction(object)\nReturn true if the object is a Python function, which includes functions created by a lambda expression.\n</code></pre>"},{"location":"blog/20191202/python-typeid/#demos","title":"demos","text":"<p>How to find out if a Python object is a string?</p> <pre><code>&gt;&gt;&gt; str1=str()\n&gt;&gt;&gt; str2='str2'\n\n&gt;&gt;&gt; type(str1)\n&lt;class 'str'&gt;\n&gt;&gt;&gt; type(str2)\n&lt;class 'str'&gt;\n\n&gt;&gt;&gt; type(str1) is str\nTrue\n&gt;&gt;&gt; type(str2) is str\nTrue\n\n&gt;&gt;&gt; isinstance(str1,str)\nTrue\n\n&gt;&gt;&gt; str(str2)==str2\nTrue\n</code></pre> <p>\u4ee5\u4e0b\u4e3a <code>inspect.is*</code> \u7cfb\u5217\u51fd\u6570\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; inspect.ismodule(str)\nFalse\n&gt;&gt;&gt; inspect.isclass(str)\nTrue\n&gt;&gt;&gt; inspect.ismodule(string)\nTrue\n&gt;&gt;&gt; inspect.isclass(string)\nFalse\n&gt;&gt;&gt; inspect.ismethod(string.capwords)\nFalse\n&gt;&gt;&gt; inspect.isfunction(string.capwords)\nTrue\n&gt;&gt;&gt; inspect.isclass(string.Template)\nTrue\n&gt;&gt;&gt; inspect.ismethod(string.Template.substitute)\nFalse\n&gt;&gt;&gt; inspect.isfunction(string.Template.substitute)\nTrue\n</code></pre>"},{"location":"blog/20191205/python-unittest-bsearch/","title":"python\u5355\u5143\u6d4b\u8bd5\u793a\u4f8b\u2014\u2014unittest for bsearch","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 python \u4e2d\u7684\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\u2014\u2014unittest\u3002</p> <p>\u6a21\u5757 bisect \u63d0\u4f9b\u4e86\u6807\u51c6\u7684\u4e8c\u5206\u67e5\u627e\u5b9e\u73b0\uff1a<code>bisect_left(a, x, lo=0, hi=None, *, key=None)</code>\u3002</p>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest-bsearch/#\u4e8c\u5206\u67e5\u627e\u7684\u5b9e\u73b0","title":"\u4e8c\u5206\u67e5\u627e\u7684\u5b9e\u73b0","text":"<p>\u4e0b\u9762\u6211\u4eec\u7528 while \u5faa\u73af\u548c\u9012\u5f52\u4e24\u79cd\u7b97\u6cd5\u5b9e\u73b0 binary_search\u3002</p> <pre><code>def binary_search_loop(A: list, e, l=0, r=None, debug=False):\n    assert(len(A) &gt; 1) # \u5217\u8868\u81f3\u5c11\u4e24\u4e2a\u5143\u7d20\n    if r is None:\n        r = len(A) - 1 # [l:r+1]\n    assert(r-l &gt; 0) # \u5207\u7247\u81f3\u5c11\u4e24\u4e2a\u5143\u7d20\n    assert(e in A[l:r+1]) # \u5143\u7d20\u5728\u5207\u7247\u4e2d\n\n    # \u4e2d\u95f4\u547d\u4e2d\u6216l(=r)\u547d\u4e2d\n    while l &lt;= r:\n        m = (l+r)//2\n        if debug:\n            print(f'binary_search_w: {e = }, A[{l}:{r}] = {A[l:r+1]}, A[{m=}] = {A[m]}')\n        if A[m] &lt; e:\n            l = m+1\n        elif A[m] &gt; e:\n            r = m-1\n        else:\n            return m\n\n    return -1\n\ndef binary_search_recursion(A: list, e, l=0, r=None, debug=False):\n    if e not in A:\n        return -1\n\n    if r is None:\n        r = len(A)-1\n\n    m = (l+r)//2\n    if debug:\n        print(f'binary_search_r: {e = }, A[{l}:{r}] = {A[l:r+1]}, A[{m=}] = {A[m]}')\n    if A[m] == e: # l=r\n        return m\n    else:\n        if A[m] &lt; e:\n            return binary_search_recursion(A, e, m+1, r, debug)\n        elif A[m] &gt; e:\n            return binary_search_recursion(A, e, l, m-1, debug)\n</code></pre>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest-bsearch/#\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1case_by_case","title":"\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1(case by case)","text":"<p>\u6bcf\u4e2a\u5355\u5143\u6d4b\u8bd5\u7528\u4e8e\u6838\u5b9e\u51fd\u6570\u7684\u67d0\u4e2a\u65b9\u9762\u6ca1\u6709\u95ee\u9898\u3002 \u6d4b\u8bd5\u7528\u4f8b\uff08\u4e00\u7ec4\u5355\u5143\u6d4b\u8bd5\uff09\uff0c\u7528\u4e8e\u6838\u5b9e\u4e00\u7cfb\u5217\u8f93\u5165\u90fd\u5c06\u5f97\u5230\u9884\u671f\u7684\u8f93\u51fa\u3002</p> <p>\u672c\u6848\u6d4b\u8bd5\u7528\u4f8b\u7684\u6574\u4f53\u8bbe\u8ba1\u8981\u70b9\u5982\u4e0b\uff1a</p> <ol> <li> <p>\u57fa\u4e8e <code>random</code> \u6a21\u5757\u751f\u6210\u968f\u673a\u5e8f\u5217 rList\uff0c\u5e76\u8c03\u7528 sorted \u6392\u597d\u5e8f\uff1b</p> <ul> <li>random.sample \u4ece\u5e8f\u5217 range(1,21) \u8fd920\u4e2a\u6570\u4e2d\u4e0d\u653e\u56de\u968f\u673a\u53d6\u683710\u4e2a\u6570\u3002</li> <li>\u53ef\u653e\u5927\u968f\u673a\u6570\u8303\u56f4\uff0c\u9002\u5f53\u589e\u5927\u6570\u636e\u8de8\u5ea6\uff1b\u53ef\u8c03\u6574\u5217\u8868\u957f\u5ea6\u4e3a\u5947\u5076\u6570\u8fdb\u884c\u6d4b\u8bd5\u3002</li> </ul> </li> <li> <p>\u9009\u53d6\u7279\u5b9a\u7d22\u5f15\uff0c\u5305\u62ec\u8fb9\u754c\u3001\u4e2d\u5fc3\u548c\u968f\u673a\u4f4d\u7f6e\uff0c\u8c03\u7528 <code>binary_search</code> \u67e5\u627e\u8be5\u5143\u7d20\uff0c\u7d22\u5f15\u5e94\u4e00\u81f4\u3002</p> <ul> <li>\u8bbe\u8ba16\u7ec4case\uff1a\u5de6\u8fb9\u754c, \u53f3\u8fb9\u754c, \u4e2d\u5fc3\u70b9, \u4e2d\u5fc3\u5de6\u79fb2\u4f4d, \u4e2d\u5fc3\u53f3\u79fb2\u4f4d, \u968f\u673a\u4f4d\u7f6e</li> <li>\u8c03\u7528 random.randrange(n) \u968f\u673a\u62bd\u53d6\u7d22\u5f15\uff0c\u4f46\u8981\u4e0e\u524d5\u7ec4case\u53bb\u91cd\u3002</li> </ul> </li> <li> <p>\u6d4b\u8bd5case\u90fd\u662f\u53d6\u7279\u5b9a\u7d22\u5f15\u7684\u5143\u7d20\uff0c\u4e8c\u5206\u67e5\u627e\u9a8c\u8bc1\u4f4d\u7f6e\uff0c\u9700\u8981\u51996\u7ec4assertEqual\u4f8b\u7a0b\u3002</p> </li> </ol> <p>\u6839\u636e\u5b9e\u9645\u60c5\u51b5\uff0c\u53ef\u9009\u62e9 unittest.main \u6216 unittest.TextTestRunner \u4f5c\u4e3a\u6d4b\u8bd5\u5165\u53e3\u70b9\u3002</p> <p>\u5bf9\u4e8e\u6d4b\u8bd5\u7528\u4f8b\uff0c6\u7ec4\u5355\u5143\u6d4b\u8bd5\u5c06\u7b2c\u4e00\u6b65\u4e2d\u51c6\u5907\u7684\u6570\u636e\u4f5c\u4e3a\u8f93\u5165\uff0c\u6d4b\u8bd5\u4e8c\u5206\u67e5\u627e\u51fd\u6570\u7684\u8f93\u51fa\u662f\u5426\u7b26\u5408\u9884\u671f\u3002 \u7b2c\u4e00\u6b65\u51c6\u5907\u7684\u6d4b\u8bd5\u6570\u636e\uff0c\u53ef\u4ee5\u653e\u5728 <code>__init__</code> \u6216 <code>setUp</code> \u4e2d\u521d\u59cb\u5316\uff0c\u6bcf\u4e2a\u5355\u5143\u6d4b\u8bd5\u6267\u884c\u524d\u90fd\u4f1a\u8c03\u7528\u3002 \u5982\u679c\u60f3\u6d4b\u8bd5\u6570\u636e\u53ea\u5168\u5c40\u521d\u59cb\u5316\u4e00\u6b21\uff0c\u5219\u53ef\u8003\u8651\u5728\u7c7b\u65b9\u6cd5 <code>setUpClass</code> \u4e2d\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u5728 <code>tearDownClass</code> \u4e2d\u6267\u884c\u5fc5\u8981\u7684\u6e05\u7406\u3002</p> <p>\u53ef\u8003\u8651\u52a0\u5f3a\u9a8c\u8bc1\u6d4b\u8bd5\uff1a</p> <ol> <li>binary_search_loop \u7b97\u6cd5\u8bd5\u9519\uff1a\u5c06 while l &lt;= r \u4e2d\u7684 = \u53bb\u6389\uff0c\u770b\u770b\u8fb9\u754ccase\u4e0d\u901a\u8fc7\u7684\u8f93\u51fa\u3002</li> <li>\u53ef\u57fa\u4e8erandom.choices\u66ff\u4ee3random.sample\uff0c\u8fdb\u884c\u653e\u56de\u53d6\u6837\uff0c\u9a8c\u8bc1\u6709\u91cd\u590d\u6570\u503c\u5e8f\u5217\u7684\u4e8c\u5206\u67e5\u627e\u9a8c\u8bc1\u3002</li> </ol> <p>\u4ee5\u4e0b\u5b9e\u73b0\u4e86\u5faa\u73af\u4e8c\u5206\u67e5\u627e binary_search_loop \u7684\u6d4b\u8bd5\u7528\u4f8b TestBSearchLoop\u3002 \u5982\u679c\u8981\u5b9e\u73b0\u9012\u5f52\u4e8c\u5206\u67e5\u627e binary_search_recursion \u7684\u6d4b\u8bd5\u7528\u4f8b TestBSearchRecursion\uff0c\u53ea\u9700\u5207\u6362\u6bcf\u4e2acase\u4e2d\u7684\u51fd\u6570\u540d\u5373\u53ef\u3002</p> <pre><code>import unittest\nimport random\n\nclass TestBSearchLoop(unittest.TestCase):\n    @classmethod\n    def setUpClass(cls):\n        # \u5728 [l,r] \u4e4b\u95f4\u968f\u673a\u6311\u9009n\u4e2a\u6570\n        l = 1; r = 40; n = 13\n        random.seed(r+1)\n        cls.count = n\n        cls.rList = sorted(random.sample(range(l,r+1), n))\n        print(40*'-')\n        print(f'test_bsearch: {n}, {cls.rList = }')\n\n    # 6\u4e2acase: \u5de6\u8fb9\u754c, \u53f3\u8fb9\u754c, \u4e2d\u5fc3\u70b9, \u4e2d\u5fc3\u5de6\u79fb2\u4f4d, \u4e2d\u5fc3\u53f3\u79fb2\u4f4d, \u968f\u673a\u4f4d\u7f6e\n\n    # case1: \u5de6\u8fb9\u754c\n    def test_bsearch_left(self):\n        # \u5f85\u641c\u5143\u7d20\n        i = 0\n        e = self.rList[i]\n        # \u67e5\u627e\u5230\u7684\u7d22\u5f15\n        ei = binary_search_loop(self.rList, e, debug=True)\n        # \u5e94\u4e0e\u9884\u671f\u7d22\u5f15\u5339\u914d\n        self.assertEqual(ei, i, msg=f'{e = }')\n\n    # case2: \u53f3\u8fb9\u754c\n    def test_bsearch_right(self):\n        # \u5f85\u641c\u5143\u7d20\n        i = self.count-1\n        e = self.rList[i]\n        # \u67e5\u627e\u5230\u7684\u7d22\u5f15\n        ei = binary_search_loop(self.rList, e, debug=True)\n        # \u5e94\u4e0e\u9884\u671f\u7d22\u5f15\u5339\u914d\n        self.assertEqual(ei, i, msg=f'{e = }')\n\n    # case3: \u4e2d\u5fc3\u70b9\n    def test_bsearch_middle(self):\n        # \u5f85\u641c\u5143\u7d20\n        i = self.count//2\n        e = self.rList[i]\n        # \u67e5\u627e\u5230\u7684\u7d22\u5f15\n        ei = binary_search_loop(self.rList, e, debug=True)\n        # \u5e94\u4e0e\u9884\u671f\u7d22\u5f15\u5339\u914d\n        self.assertEqual(ei, i, msg=f'{e = }')\n\n    # case4: \u4e2d\u5fc3\u5de6\u79fb2\u4f4d\n    def test_bsearch_middle_left(self):\n        # \u5f85\u641c\u5143\u7d20\n        i = self.count//2-2\n        e = self.rList[i]\n        # \u67e5\u627e\u5230\u7684\u7d22\u5f15\n        ei = binary_search_loop(self.rList, e, debug=True)\n        # \u5e94\u4e0e\u9884\u671f\u7d22\u5f15\u5339\u914d\n        self.assertEqual(ei, i, msg=f'{e = }')\n\n    # case5: \u4e2d\u5fc3\u53f3\u79fb2\u4f4d\n    def test_bsearch_middle_right(self):\n        # \u5f85\u641c\u5143\u7d20\n        i = self.count//2+2\n        e = self.rList[i]\n        # \u67e5\u627e\u5230\u7684\u7d22\u5f15\n        ei = binary_search_loop(self.rList, e, debug=True)\n        # \u5e94\u4e0e\u9884\u671f\u7d22\u5f15\u5339\u914d\n        self.assertEqual(ei, i, msg=f'{e = }')\n\n    # case6: \u968f\u673a\u4f4d\u7f6e\n    def test_bsearch_random(self):\n        # case 1~5\n        m = self.count//2\n        il = [0, self.count-1, m, m-2, m+2]\n        # \u5f85\u641c\u5143\u7d20\n        i = random.randrange(self.count)\n        while i in il: # \u53bb\u91cd\n            i = random.randrange(self.count)\n        e = self.rList[i]\n        # \u67e5\u627e\u5230\u7684\u7d22\u5f15\n        ei = binary_search_loop(self.rList, e, debug=True)\n        # \u5e94\u4e0e\u9884\u671f\u7d22\u5f15\u5339\u914d\n        self.assertEqual(ei, i, msg=f'{e = }')\n\n# \u4f1a\u542f\u52a8\u6267\u884c\u5f53\u524d\u6a21\u5757\u4e2d\u7684\u6240\u6709TestCase\u6d4b\u8bd5\u7528\u4f8b\n# if __name__ == '__main__':\n#     unittest.main(argv=[''], verbosity=2, exit=False)\n\n# TestSuite\u6309\u9700\u6dfb\u52a0\u8981\u6267\u884c\u7684TestCase\u6d4b\u8bd5\u7528\u4f8b\ndef suite():\n    suite = unittest.TestSuite()\n    suite.addTest(TestBSearchLoop('test_bsearch_left'))\n    suite.addTest(TestBSearchLoop('test_bsearch_right'))\n    suite.addTest(TestBSearchLoop('test_bsearch_middle'))\n    suite.addTest(TestBSearchLoop('test_bsearch_middle_left'))\n    suite.addTest(TestBSearchLoop('test_bsearch_middle_right'))\n    suite.addTest(TestBSearchLoop('test_bsearch_random'))\n    return suite\n\nif __name__ == '__main__':\n    runner = unittest.TextTestRunner(verbosity=2)\n    runner.run(suite())\n</code></pre>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest-bsearch/#\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1foreach_subtest","title":"\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1(foreach subTest)","text":"<p>\u4ee5\u4e0a\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1\u4e2d\uff0c\u6bcf\u4e2a\u5355\u5143\u6d4b\u8bd5\u7684\u5de5\u4f5c\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>\u6311\u9009\u7d22\u5f15\u53ca\u5f85\u641c\u5143\u7d20</li> <li>\u8c03\u7528\u5f85\u6d4b\u51fd\u6570\uff0c\u8fd4\u56de\u67e5\u627e\u5230\u7684\u7d22\u5f15</li> <li>\u6838\u5b9e\u67e5\u627e\u5230\u7684\u7d22\u5f15\u4e0e\u9884\u8bbe\u7d22\u5f15\u662f\u5426\u5339\u914d</li> </ol> <p>\u9664\u4e86\u7b2c1\u6b65\u7b5b\u9009\u51fa\u4e0d\u540c\u7684\u7d22\u5f15\u5916\uff0c\u540e\u7eed\u6b65\u9aa4\u57fa\u672c\u4e00\u6837\u3002 \u56e0\u6b64\uff0c\u4e3a\u4e86\u53ef\u8003\u8651\u5c06\u6d4b\u8bd5\u7528\u4f8b\u6536\u7f29\u5230\u4e00\u4e2a\u5355\u5143\u6d4b\u8bd5\u4e2d\uff0c\u539f\u5355\u5143\u6d4b\u8bd5\u53d8\u4e3a\u5b50\u6d4b\u8bd5\u3002 \u5177\u4f53\u505a\u6cd5\u662f\uff0c\u5c066\u7ec4\u7d22\u5f15\u63d0\u524d\u7ec4\u88c5\u6210\u5217\u8868\uff0c\u518d\u7528for\u5faa\u73af\u6267\u884csubTest\uff0c\u4e0d\u901a\u8fc7\u7684case\u4f1adump\u6307\u5b9a\u7684msg\u3002</p> <pre><code>import unittest\nimport random\n\nclass TestBSearchLoop(unittest.TestCase):\n    def test_bsearch(self):\n        \"\"\"\n        test: binary_search\n        \"\"\"\n        # \u5728 [l,r] \u4e4b\u95f4\u968f\u673a\u6311\u9009n\u4e2a\u6570\n        l = 1; r = 20; n = 13\n        random.seed(r+1)\n        rList = sorted(random.sample(range(l,r+1), n))\n        print(40*'-')\n        print(f'test_bsearch: {n}, {rList = }')\n\n        # 6\u4e2acase: \u5de6\u8fb9\u754c, \u53f3\u8fb9\u754c, \u4e2d\u5fc3\u70b9, \u4e2d\u5fc3\u5de6\u79fb2\u4f4d, \u4e2d\u5fc3\u53f3\u79fb2\u4f4d, \u968f\u673a\u4f4d\u7f6e\n        mi = n//2\n        il = [0, n-1, mi, mi-2, mi+2]\n        dl = ['left', 'right', 'middle', 'middle-left-2', 'middle-right+2']\n        ri = random.randrange(n)\n        while ri in il:\n            ri = random.randrange(n)\n        il.append(ri)\n        dl.append('random')\n        zl = list(zip(il, dl))\n\n        for t in zl:\n            with self.subTest(t=t):\n                # \u5f85\u641c\u5143\u7d20\n                e = rList[t[0]]\n                # \u67e5\u627e\u5230\u7684\u7d22\u5f15\n                ei = binary_search_loop(rList, e, debug=True)\n                # \u5e94\u4e0e\u9884\u671f\u7d22\u5f15\u5339\u914d\n                self.assertEqual(ei, t[0], msg=f'{rList[t[0]]}, {t[1]}')\n\n\nif __name__ == '__main__':\n    unittest.main(argv=[''], verbosity=2, exit=False)\n</code></pre>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest-bsearch/#\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1base_case","title":"\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1(base case)","text":"<p>\u65e0\u8bba\u662f case by case\uff0c\u8fd8\u662f foreach subTest\uff0c\u6d4b\u8bd5\u7528\u4f8b\u4e2d\uff0c\u6d4b\u8bd5\u7528\u4f8b TestBSearchRecursion \u76f8\u6bd4\u6d4b\u8bd5\u7528\u4f8b TestBSearchLoop \u53ea\u9700\u5207\u6362\u6bcf\u4e2acase\u4e2d\u7684\u4e8c\u5206\u67e5\u627e\u51fd\u6570\u540d\u5373\u53ef\uff0c\u5176\u4ed6\u6d4b\u8bd5\u53c2\u6570\u548c\u6d41\u7a0b\u4e00\u81f4\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u8003\u8651\u63d0\u53d6\u51fa\u4e00\u4e2a\u57fa\u7c7b TestBSearch\uff0c\u518d\u6d3e\u751f\u4e24\u4e2a\u5b50\u7c7b\uff0c\u9002\u5f53\u65f6\u673a\u8bbe\u5b9a\u5f85\u6d4b\u51fd\u6570\u5373\u53ef\u3002</p>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest-bsearch/#\u63d0\u53d6\u6d4b\u8bd5\u7528\u4f8b\u57fa\u7c7b","title":"\u63d0\u53d6\u6d4b\u8bd5\u7528\u4f8b\u57fa\u7c7b","text":"<p>\u62bd\u53d6\u57fa\u7c7b\uff1a<code>TestBSearch</code></p> <pre><code>class TestBSearch(unittest.TestCase):\n</code></pre>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest-bsearch/#\u63d0\u53d6\u8bbe\u7f6e\u6d4b\u8bd5\u51fd\u6570\u5165\u53e3","title":"\u63d0\u53d6\u8bbe\u7f6e\u6d4b\u8bd5\u51fd\u6570\u5165\u53e3","text":"<p>\u63d0\u53d6\u8bbe\u7f6e\u6d4b\u8bd5\u51fd\u6570\u5165\u53e3\uff1a<code>set_binary_search</code></p> <pre><code>    # \u8bbe\u7f6e\u4e8c\u5206\u67e5\u627e\u641c\u7d22\u51fd\u6570\n    def set_binary_search(self, binary_search):\n        if not hasattr(self, 'bsearch'):\n            self.bsearch = binary_search\n</code></pre> <p>\u5c066\u4e2acase\uff08test_bsearch_*\uff09\u4e2d\u7684 binary_search_loop \u66ff\u6362\u4e3a <code>self.bsearch</code>\u3002</p>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest-bsearch/#\u8bbe\u8ba1\u4e24\u4e2a\u6d3e\u751f\u7c7b\u521d\u59cb\u4f20\u5165\u6d4b\u8bd5\u51fd\u6570","title":"\u8bbe\u8ba1\u4e24\u4e2a\u6d3e\u751f\u7c7b\uff0c\u521d\u59cb\u4f20\u5165\u6d4b\u8bd5\u51fd\u6570","text":"<p>\u8bbe\u8ba1\u4e24\u4e2a TestBSearch \u7684\u6d3e\u751f\u7c7b TestBSearchLoop \u548c TestBSearchRecursion\u3002 \u5728\u6d3e\u751f\u7c7b\u7684 <code>__init__</code> \u6216 <code>setUp</code> \u4e2d\u8c03\u7528 set_binary_search \u8bbe\u7f6e\u8981\u6d4b\u8bd5\u7684\u4e8c\u5206\u67e5\u627e\u51fd\u6570\u3002</p> <p>\u6bcf\u4e2acase\uff08test_bsearch_*\uff09\u8c03\u7528\u4e4b\u524d\uff0c\u90fd\u4f1a\u8c03\u7528 <code>__init__</code> \u6216 <code>setUp</code>\u3002</p> <pre><code>class TestBSearchLoop(TestBSearch):\n    def __init__(self, methodName: str = \"runTest\") -&gt; None:\n        self.set_binary_search(binary_search_loop)\n        super().__init__(methodName)\n\n    # def setUp(self) -&gt; None:\n    #     self.set_binary_search(binary_search_loop)\n    #     return super().setUp()\n\nclass TestBSearchRecursion(TestBSearch):\n    def __init__(self, methodName: str = \"runTest\") -&gt; None:\n        print('TestBSearchRecursion.init')\n        self.set_binary_search(binary_search_recursion)\n        super().__init__(methodName)\n\n    # def setUp(self) -&gt; None:\n    #     self.set_binary_search(binary_search_recursion)\n    #     return super().setUp()\n</code></pre>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest-bsearch/#\u521b\u5efatestsuitetexttestrunner\u542f\u52a8\u6d4b\u8bd5","title":"\u521b\u5efaTestSuite\uff0cTextTestRunner\u542f\u52a8\u6d4b\u8bd5","text":"<p>\u521b\u5efa\u4e24\u4e2a TestSuite\uff0c\u5206\u522b\u6dfb\u52a0 TestBSearchLoop \u548c TestBSearchRecursion \u7684\u6d4b\u8bd5\u7528\u4f8b\u3002 \u518d\u7528 <code>unittest.TextTestRunner</code> \u52a0\u8f7d TestSuite\uff0c\u518d\u8c03\u7528 run \u542f\u52a8\u6d4b\u8bd5\u7528\u4f8b\u3002</p> <pre><code># \u4f1a\u542f\u52a8\u6267\u884c\u5f53\u524d\u6a21\u5757\u4e2d\u7684\u6240\u6709TestCase\u6d4b\u8bd5\u7528\u4f8b\n# if __name__ == '__main__':\n#     unittest.main(argv=[''], verbosity=2, exit=False)\n\n# TestSuite\u6309\u9700\u6dfb\u52a0\u8981\u6267\u884c\u7684TestCase\u6d4b\u8bd5\u7528\u4f8b\ndef suiteBSearchLoop():\n    suite = unittest.TestSuite()\n    suite.addTest(TestBSearchLoop('test_bsearch_left'))\n    suite.addTest(TestBSearchLoop('test_bsearch_right'))\n    suite.addTest(TestBSearchLoop('test_bsearch_middle'))\n    suite.addTest(TestBSearchLoop('test_bsearch_middle_left'))\n    suite.addTest(TestBSearchLoop('test_bsearch_middle_right'))\n    suite.addTest(TestBSearchLoop('test_bsearch_random'))\n    return suite\n\ndef suiteBSearchRecursion():\n    suite = unittest.TestSuite()\n    suite.addTest(TestBSearchRecursion('test_bsearch_left'))\n    suite.addTest(TestBSearchRecursion('test_bsearch_right'))\n    suite.addTest(TestBSearchRecursion('test_bsearch_middle'))\n    suite.addTest(TestBSearchRecursion('test_bsearch_middle_left'))\n    suite.addTest(TestBSearchRecursion('test_bsearch_middle_right'))\n    suite.addTest(TestBSearchRecursion('test_bsearch_random'))\n    return suite\n\ndef suiteBSearch():\n    suite = unittest.TestSuite()\n    suiteLoop = suiteBSearchLoop()\n    suiteRecursion = suiteBSearchRecursion()\n    suite.addTests(suiteLoop)\n    suite.addTests(suiteRecursion)\n    return suite\n\nif __name__ == '__main__':\n    runner = unittest.TextTestRunner(verbosity=2)\n    # runner.run(suiteBSearchLoop())\n    # runner.run(suiteBSearchRecursion())\n    runner.run(suiteBSearch())\n</code></pre>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest-bsearch/#\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1base_case_for_subtest","title":"\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1(base case for subTest)","text":"<p>\u57fa\u4e8e\u4ee5\u4e0a\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bbe\u8ba1\u601d\u8def\uff0c\u5c06subTest\u7684\u6d4b\u8bd5\u7528\u4f8b\u7a0d\u52a0\u6539\u9020\u5373\u53ef\u540c\u65f6\u652f\u6301\u6d4b\u8bd5\u4e24\u79cd\u76ee\u6807\u51fd\u6570\u3002</p> <pre><code>import unittest\nimport random\n\nclass TestBSearch(unittest.TestCase):\n\n    # \u8bbe\u7f6e\u4e8c\u5206\u67e5\u627e\u641c\u7d22\u51fd\u6570\n    def set_binary_search(self, binary_search):\n        if not hasattr(self, 'bsearch'):\n            self.bsearch = binary_search\n\n    def test_bsearch(self):\n        # \u5728 [l,r] \u4e4b\u95f4\u968f\u673a\u6311\u9009n\u4e2a\u6570\n        l = 1; r = 40; n = 13\n        random.seed(r+1)\n        rList = sorted(random.sample(range(l,r+1), n))\n        print(40*'-')\n        print(f'test_bsearch: {n}, {rList = }')\n\n        # 6\u4e2acase: \u5de6\u8fb9\u754c, \u53f3\u8fb9\u754c, \u4e2d\u5fc3\u70b9, \u4e2d\u5fc3\u5de6\u79fb2\u4f4d, \u4e2d\u5fc3\u53f3\u79fb2\u4f4d, \u968f\u673a\u4f4d\u7f6e\n        mi = n//2\n        il = [0, n-1, mi, mi-2, mi+2]\n        dl = ['left', 'right', 'middle', 'middle-left-2', 'middle-right+2']\n        ri = random.randrange(n)\n        while ri in il:\n            ri = random.randrange(n)\n        il.append(ri)\n        dl.append('random')\n        zl = list(zip(il, dl))\n\n        for t in zl:\n            with self.subTest(t=t):\n                # \u5f85\u641c\u5143\u7d20\n                e = rList[t[0]]\n                # \u67e5\u627e\u5230\u7684\u7d22\u5f15\n                ei = self.bsearch(rList, e, debug=True)\n                # \u5e94\u4e0e\u9884\u671f\u7d22\u5f15\u5339\u914d\n                self.assertEqual(ei, t[0], msg=f'{rList[t[0]]}, {t[1]}')\n\nclass TestBSearchLoop(TestBSearch):\n    def __init__(self, methodName: str = \"runTest\") -&gt; None:\n        self.set_binary_search(binary_search_loop)\n        super().__init__(methodName)\n\n    # def setUp(self) -&gt; None:\n    #     self.set_binary_search(binary_search_loop)\n    #     return super().setUp()\n\nclass TestBSearchRecursion(TestBSearch):\n    def __init__(self, methodName: str = \"runTest\") -&gt; None:\n        self.set_binary_search(binary_search_recursion)\n        super().__init__(methodName)\n\n    # def setUp(self) -&gt; None:\n    #     self.set_binary_search(binary_search_recursion)\n    #     return super().setUp()\n\n# \u4f1a\u542f\u52a8\u6267\u884c\u5f53\u524d\u6a21\u5757\u4e2d\u7684\u6240\u6709TestCase\u6d4b\u8bd5\u7528\u4f8b\n# if __name__ == '__main__':\n#     unittest.main(argv=[''], verbosity=2, exit=False)\n\n# TestSuite\u6309\u9700\u6dfb\u52a0\u8981\u6267\u884c\u7684TestCase\u6d4b\u8bd5\u7528\u4f8b\ndef suiteBSearch():\n    suite = unittest.TestSuite()\n    suite.addTest(TestBSearchLoop('test_bsearch'))\n    suite.addTest(TestBSearchRecursion('test_bsearch'))\n    return suite\n\nif __name__ == '__main__':\n    runner = unittest.TextTestRunner(verbosity=2)\n    runner.run(suiteBSearch())\n</code></pre>","tags":["unittest","bsearch"]},{"location":"blog/20191205/python-unittest/","title":"python\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\u2014\u2014unittest","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 python \u4e2d\u7684\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\u2014\u2014unittest\u3002</p> <p>\u53c2\u8003\uff1a</p> <ul> <li>\u300aPython\u57fa\u7840\u6559\u7a0b\u300b\u7b2c16\u7ae0\u300a\u6d4b\u8bd5\u57fa\u7840\u300b</li> <li>\u300aPython\u7f16\u7a0b\u4ece\u5165\u95e8\u5230\u5b9e\u8df5\u300b\u7b2c11\u7ae0\u300a\u6d4b\u8bd5\u4ee3\u7801\u300b</li> </ul> <p>\u6781\u9650\u7f16\u7a0b\u5148\u950b\u5f15\u5165\u4e86\u201c\u6d4b\u8bd5\u4e00\u70b9\u70b9\uff0c\u518d\u7f16\u5199\u4e00\u70b9\u70b9\u4ee3\u7801\u201d\u7684\u7406\u5ff5\u3002\u8fd9\u79cd\u7406\u5ff5\u4e0e\u76f4\u89c9\u4e0d\u592a\u76f8\u7b26\uff0c\u5374\u5f88\u7ba1\u7528\uff0c\u80dc\u8fc7\u4e0e\u76f4\u89c9\u4e00\u81f4\u7684\u201c\u7f16\u5199\u4e00\u70b9\u70b9\u4ee3\u7801\uff0c\u518d\u6d4b\u8bd5\u4e00\u70b9\u70b9\u201d\u7684\u505a\u6cd5\u3002 \u6362\u800c\u8a00\u4e4b\uff0c\u6d4b\u8bd5\u5728\u5148\uff0c\u7f16\u7801\u5728\u540e\u3002\u8fd9\u4e5f\u79f0\u4e3a\u6d4b\u8bd5\u9a71\u52a8\u7684\u7f16\u7a0b\u3002</p> <p>\u5f00\u53d1\u8f6f\u4ef6\u65f6\uff0c\u5fc5\u987b\u5148\u77e5\u9053\u8f6f\u4ef6\u8981\u89e3\u51b3\u4ec0\u4e48\u95ee\u9898\u2014\u2014\u8981\u5b9e\u73b0\u4ec0\u4e48\u6837\u7684\u76ee\u6807\u3002\u8981\u9610\u660e\u7a0b\u5e8f\u7684\u76ee\u6807\uff0c\u53ef\u7f16\u5199\u9700\u6c42\u8bf4\u660e\uff0c\u4e5f\u5c31\u662f\u63cf\u8ff0\u7a0b\u5e8f\u5fc5\u987b\u6ee1\u8db3\u4f55\u79cd\u9700\u6c42\u7684\u6587\u6863\u3002\u8fd9\u6837\u4ee5\u540e\u5c31\u5f88\u5bb9\u6613\u6838\u5b9e \u9700\u6c42\u662f\u5426\u786e\u5b9e\u5f97\u5230\u4e86\u6ee1\u8db3\u3002</p> <p>\u8fd9\u91cc\u7684\u7406\u5ff5\u662f\u5148\u7f16\u5199\u6d4b\u8bd5\uff0c\u518d\u7f16\u5199\u8ba9\u6d4b\u8bd5\u901a\u8fc7\u7684\u7a0b\u5e8f\u3002\u6d4b\u8bd5\u7a0b\u5e8f\u5c31\u662f\u9700\u6c42\u8bf4\u660e\uff0c\u53ef\u5e2e\u52a9\u786e\u4fdd\u7a0b\u5e8f\u5f00\u53d1\u8fc7\u7a0b\u7d27\u6263\u8fd9\u4e9b\u9700\u6c42\u3002</p> <p>\u5728\u6d4b\u8bd5\u9886\u57df\uff0c\u6709\u4e24\u4e2a\u91cd\u8981\u7684\u57fa\u7840\u6982\u5ff5\uff1a\u5355\u5143\u6d4b\u8bd5\u548c\u6d4b\u8bd5\u7528\u4f8b\u3002\u5355\u5143\u6d4b\u8bd5\u7528\u4e8e\u6838\u5b9e\u51fd\u6570\u7684\u67d0\u4e2a\u65b9\u9762\u6ca1\u6709\u95ee\u9898\uff1b\u6d4b\u8bd5\u7528\u4f8b\u662f\u4e00\u7ec4\u5355\u5143\u6d4b\u8bd5\uff0c\u8fd9\u4e9b\u5355\u5143\u6d4b\u8bd5\u4e00\u8d77\u6838\u5b9e\u51fd\u6570\u5728\u5404\u79cd\u60c5\u5f62\u4e0b\u7684\u884c\u4e3a\u90fd\u7b26\u5408\u8981\u6c42\u3002</p> <p>\u5168\u8986\u76d6\u5f0f\u6d4b\u8bd5\u7528\u4f8b\u5305\u542b\u4e00\u6574\u5957\u5355\u5143\u6d4b\u8bd5\uff0c\u6db5\u76d6\u4e86\u5404\u79cd\u53ef\u80fd\u7684\u51fd\u6570\u4f7f\u7528\u65b9\u5f0f\u3002 \u826f\u597d\u7684\u6d4b\u8bd5\u7528\u4f8b\u8003\u8651\u5230\u4e86\u51fd\u6570\u53ef\u80fd\u6536\u5230\u7684\u5404\u79cd\u8f93\u5165\uff0c\u5305\u542b\u9488\u5bf9\u6240\u6709\u8fd9\u4e9b\u60c5\u5f62\u7684\u6d4b\u8bd5\u3002 \u5bf9\u4e8e\u5927\u578b\u9879\u76ee\uff0c\u8981\u5b9e\u73b0\u5168\u8986\u76d6\u53ef\u80fd\u5f88\u96be\u3002\u901a\u5e38\uff0c\u6700\u521d\u53ea\u8981\u9488\u5bf9\u4ee3\u7801\u7684\u91cd\u8981\u884c\u4e3a\u7f16\u5199\u6d4b\u8bd5\u5373\u53ef\uff0c\u7b49\u9879\u76ee\u88ab\u5e7f\u6cdb\u4f7f\u7528\u65f6\u518d\u8003\u8651\u5168\u8986\u76d6\u3002</p> <p>\u8986\u76d6\u7387\uff08coverage\uff09\u662f\u4e00\u4e2a\u91cd\u8981\u7684\u6d4b\u8bd5\u6982\u5ff5\u3002 \u8fd0\u884c\u6d4b\u8bd5\u65f6\uff0c\u5f88\u53ef\u80fd\u8fbe\u4e0d\u5230\u8fd0\u884c\u6240\u6709\u4ee3\u7801\uff08\u5206\u652f\uff09\u7684\u7406\u60f3\u72b6\u6001\u3002 \u5b9e\u9645\u4e0a\uff0c\u6700\u7406\u60f3\u7684\u60c5\u51b5\u662f\uff0c\u4f7f\u7528\u5404\u79cd\u53ef\u80fd\u7684\u8f93\u5165\u68c0\u67e5\u6bcf\u79cd\u53ef\u80fd\u7684\u7a0b\u5e8f\u72b6\u6001\uff0c\u4f46\u8fd9\u6839\u672c\u4e0d\u53ef\u80fd\u505a\u5230\u3002 \u4f18\u79c0\u6d4b\u8bd5\u5957\u4ef6\u7684\u76ee\u6807\u4e4b\u4e00\u662f\u786e\u4fdd\u8f83\u9ad8\u7684\u8986\u76d6\u7387\uff0c\u4e3a\u6b64\u53ef\u4f7f\u7528\u8986\u76d6\u7387\u5de5\u5177\uff0c\u5b83\u4eec\u6d4b\u91cf\u6d4b\u8bd5\u671f\u95f4\u5b9e\u9645\u8fd0\u884c\u7684\u4ee3\u7801\u6240\u5360\u7684\u6bd4\u4f8b\u3002</p> <p>Python\u6807\u51c6\u5e93\u4e2d\u7684\u6a21\u5757unittest\u63d0\u4f9b\u4e86\u81ea\u52a8\u5316\u6d4b\u8bd5\u6846\u67b6\u5de5\u5177\u96c6\uff0c\u8ba9\u4f60\u80fd\u591f\u4ee5\u7ed3\u6784\u5316\u65b9\u5f0f\u7f16\u5199\u5e9e\u5927\u800c\u8be6\u5c3d\u7684\u6d4b\u8bd5\u96c6\uff08\u6d4b\u8bd5\u7528\u4f8b\uff09\u3002</p>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#unittest","title":"unittest","text":"<p>unittest \u2014 Unit testing framework \u2014 Python 3.12.2 documentation unittest --- \u5355\u5143\u6d4b\u8bd5\u6846\u67b6 \u2014 Python 3.12.2 \u6587\u6863</p> <p>The\u00a0unittest\u00a0unit testing framework was originally inspired by JUnit and has a similar flavor as major unit testing frameworks in other languages.</p> <p>The\u00a0unittest\u00a0module provides a rich set of tools for constructing and running tests.</p>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#testcase","title":"TestCase","text":"<p>In\u00a0unittest, test cases are represented by\u00a0<code>unittest.TestCase</code>\u00a0instances. To make your own test cases you must write subclasses of\u00a0<code>TestCase</code>\u00a0or use\u00a0FunctionTestCase.</p> <p>test case:</p> <p>A\u00a0test case\u00a0is the individual unit of testing. It checks for a specific response to a particular set of inputs.\u00a0 unittest\u00a0provides a base class,<code>TestCase</code>, which may be used to create new test cases. A testcase is created by subclassing\u00a0<code>unittest.TestCase</code>.\u00a0</p>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#testhelper","title":"test/helper","text":"<p>\u4ee5\u4e0a\u4ee3\u7801 class NameTestCase \u7ee7\u627f <code>unittest.TestCase</code> \u521b\u5efa\u4e86\u4e00\u4e2a\u6d4b\u8bd5\u6837\u4f8b\u3002</p> <p>\u6d4b\u8bd5\u65b9\u6cd5\u90fd\u4ee5 <code>test</code> \u5f00\u5934\u547d\u540d\uff0c\u8be5\u524d\u7f00\u544a\u8bc9\u6d4b\u8bd5\u6846\u67b6\u54ea\u4e9b\u65b9\u6cd5\u662f\u9700\u8981\u8fd0\u884c\u7684\u5355\u5143\u6d4b\u8bd5\u3002 unittest \u8fd0\u884c\u8d77\u6765\u540e\uff0c\u4f1a\u6267\u884c\u8be5\u6a21\u5757\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u5373\u6240\u6709\u4ee5 <code>test</code> \u5f00\u5934\u7684\u5355\u5143\u6d4b\u8bd5\u3002</p> <p>The three individual tests are defined with methods whose names start with the letters <code>test</code>. This naming convention informs the test runner about which methods represent tests.</p> <p>\u5982\u679c\u591a\u4e2a\u5355\u5143\u6d4b\u8bd5\uff0c\u6d4b\u8bd5\u6d41\u7a0b\u57fa\u672c\u76f8\u540c\uff0c\u4ec5\u4ec5\u662f\u90e8\u5206\u6d4b\u8bd5\u53c2\u6570\u5dee\u5f02\u3002\u6b64\u65f6\uff0c\u53ef\u8003\u8651\u5c06\u516c\u5171\u90e8\u5206\u63d0\u53d6\u4e3a\u8f85\u52a9\u51fd\u6570\u3002\u7136\u540e\uff0c\u6d4b\u8bd5\u7528\u4f8b\u90fd\u8c03\u7528\u8fd9\u4e2a\u8f85\u52a9\u51fd\u6570\u3002</p> <p>\u5982\u679c\u60f3\u8981\u5b9a\u4e49\u8f85\u52a9\u51fd\u6570\uff0c\u53ea\u8981\u547d\u540d\u4e0d\u4ee5 test \u5f00\u5934\u7684 Non-test methods \u5373\u53ef\u3002</p>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#setupteardown","title":"setUp/tearDown","text":"<p>\u901a\u8fc7 setUp() \u548c tearDown() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u6d4b\u8bd5\u5f00\u59cb\u524d\u4e0e\u5b8c\u6210\u540e\u9700\u8981\u6267\u884c\u7684\u6307\u4ee4\u3002</p> <p>\u8fd0\u884c\u6bcf\u4e2a\u4ee5 <code>test</code> \u5f00\u5934\u547d\u540d\u7684\u5355\u5143\u6d4b\u8bd5\uff0c\u90fd\u4f1a\u5148\u6267\u884c setUp()\uff1b\u7528\u4f8b\u6267\u884c\u5b8c\uff0c\u4f1a\u6267\u884c tearDown()\u3002</p> <ol> <li>Tests can be numerous, and their set-up can be repetitive. Luckily, we can factor out set-up code by implementing a method called <code>setUp</code>(), which the testing framework will automatically call for every single test we run.</li> <li>Similarly, we can provide a <code>tearDown</code>() method that tidies up after the test method has been run.</li> </ol> <p>Tests share setup and shutdown code: The <code>setUp</code>() and <code>tearDown</code>() methods allow you to define instructions that will be executed before and after each test method.</p> <p>\u53ef\u5728 <code>__init__</code> \u4e2d\u521d\u59cb\u5316\u6210\u5458\u53d8\u91cf\uff0c\u6302\u9760\u5230self\u4e0a\uff0c\u540e\u7eed\u6d4b\u8bd5\u7528\u4f8b\u901a\u8fc7 self.var \u5f62\u5f0f\u5f15\u7528\u8fd9\u4e9b\u6210\u5458\u53d8\u91cf\u3002 \u4f46 <code>__init__</code> \u4e0d\u6b62\u521d\u59cb\u5316\u4e00\u6b21\uff0c\u8c03\u7528\u6b21\u6570\u540c setUp/tearDown\uff0c\u5373\u8fd0\u884c\u6bcf\u4e2a\u5355\u5143\u6d4b\u8bd5\u524d\u90fd\u4f1a\u8fd0\u884c\u3002</p> <p>A new TestCase instance is created as a unique test fixture used to execute each individual test method. Thus <code>setUp</code>(), <code>tearDown</code>(), and <code>__init__</code>() will be called once per test.</p> <p>\u4f8b\u5982\u6240\u6709\u5355\u5143\u6d4b\u8bd5\u4e2d\u90fd\u4f1a\u7528\u5230\u7684\u76f8\u540c\u7684\u6d4b\u8bd5\u6570\u636e\uff0c\u53ef\u4ee5\u62bd\u53d6\u5230 <code>__init__</code> \u6216 <code>setUp</code> \u4e2d\u521d\u59cb\u5316\uff0c\u7136\u540e\u5b9a\u4e49\u4e3a\u5c5e\u6027(prop)\uff0c\u5728\u540e\u7eed\u6d4b\u8bd5\u7528\u4f8b\u4e2d\u5f15\u7528(self.prop)\u3002 \u8fd9\u6837\u505a\uff0c\u53ef\u4ee5\u907f\u514d\u6d4b\u8bd5\u7528\u4f8b\u4e2d\u5bf9\u4e00\u5957\u6d4b\u8bd5\u6570\u636e\u7684\u91cd\u590d\u4e66\u5199\uff08\u521d\u59cb\u5316\uff09\uff0c\u4f46\u662f\u8fd0\u884c\u671f\u6bcf\u6b21\u6267\u884c\u5355\u5143\u6d4b\u8bd5\u4e4b\u524d\u90fd\u4f1a\u8c03\u7528 <code>__init__</code> \u6216 <code>setUp</code> \u8fd8\u662f\u4f1a\u91cd\u590d\u521d\u59cb\u5316\u3002 \u5bf9\u4e8e\u7f51\u7edc\u8fde\u63a5\u8fd9\u7c7b\u91cd\u578b\u64cd\u4f5c\uff0c\u5982\u679c\u6bcf\u4e2a\u5355\u5143\u6d4b\u8bd5\u90fd\u521b\u5efa/\u9500\u6bc1\u4e00\u6761\u4e34\u65f6\u7f51\u7edc\u8fde\u63a5\uff0c\u52a8\u4f5c\u5e45\u5ea6\u548c\u8d44\u6e90\u6d88\u8017\u975e\u5e38\u5927\uff0c\u6700\u597d\u662f\u80fd\u5168\u5c40\u521d\u59cb\u5316\u53ea\u521b\u5efa\u4e00\u6b21\u3002 \u5728\u8fd9\u79cd\u573a\u666f\u4e0b\uff0c\u53ef\u8003\u8651\u8c03\u7528\u7c7b\u65b9\u6cd5 <code>setUpClass</code> \u521b\u5efa\u4e00\u6761\u516c\u7528\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u7136\u540e\u5728 <code>tearDownClass</code> \u4e2d\u5173\u95ed\u8fde\u63a5\uff08\u9500\u6bc1\u76f8\u5173\u8d44\u6e90\uff09\u3002</p> <pre><code>import unittest\n\nclass Test(unittest.TestCase):\n    @classmethod\n    def setUpClass(cls):\n        cls._connection = createExpensiveConnectionObject()\n\n    @classmethod\n    def tearDownClass(cls):\n        cls._connection.destroy()\n</code></pre> <p>\u5728\u6d4b\u8bd5\u7528\u4f8b\u4e2d\uff0c\u53ef\u901a\u8fc7 <code>self._connection</code> \u5f15\u7528\u8fd9\u4e2a\u6210\u5458\u53d8\u91cf\u3002</p>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#assert_methods","title":"assert methods","text":"<p>\u6bcf\u4e2a\u6d4b\u8bd5\u7684\u5173\u952e\u662f\u4f7f\u7528\u65ad\u8a00\u6765\u7ba1\u7406\u9884\u671f\uff1a</p> <ul> <li>\u8c03\u7528 assertEqual \u6216 assertNotEqual \u6765\u68c0\u67e5\u9884\u671f\u7684\u8f93\u51fa\uff08check for an expected result\uff09\uff1b</li> <li>\u8c03\u7528 assertTrue \u6216 assertFalse \u6765\u9a8c\u8bc1\u4e00\u4e2a\u6761\u4ef6\uff08verify a condition\uff09\uff1b</li> <li>\u8c03\u7528 assertIs \u6216 assertIsNot \u6765\u9a8c\u8bc1\u662f\u5426\u540c\u4e00\u5bf9\u8c61\uff1b</li> <li>\u8c03\u7528 assertIsNone \u6216 assertIsNotNone \u6765\u9a8c\u8bc1\u5bf9\u8c61\u662f\u5426\u6709\u6548\uff1b</li> <li>\u8c03\u7528 assertIn \u6216 assertNotIn \u6765\u9a8c\u8bc1\u5305\u542b\u60c5\u51b5\uff1b</li> <li>\u8c03\u7528 assertIsInstance \u6216 assertNotIsInstance \u6765\u9a8c\u8bc1\u5bf9\u8c61\u548c\u662f\u5426\u662f\u7c7b\u7684\u5b9e\u4f8b\uff1b</li> </ul> <p>\u8fd9\u4e9b\u65ad\u8a00\u65b9\u6cd5\u90fd\u652f\u6301 msg \u53c2\u6570\uff0c\u5982\u679c\u6307\u5b9a\u4e86\u8be5\u53c2\u6570\uff0c\u5b83\u5c06\u88ab\u7528\u4f5c\u6d4b\u8bd5\u5931\u8d25\u65f6\u7684\u9519\u8bef\u6d88\u606f\u3002</p> <p>\u4f7f\u7528\u8fd9\u4e9b\u65b9\u6cd5\u800c\u4e0d\u662f <code>assert</code> \u8bed\u53e5\u662f\u4e3a\u4e86\u8ba9\u6d4b\u8bd5\u8fd0\u884c\u8005\u80fd\u805a\u5408\u6240\u6709\u7684\u6d4b\u8bd5\u7ed3\u679c\u5e76\u4ea7\u751f\u7ed3\u679c\u62a5\u544a\u3002</p> <p>These methods are used instead of the assert statement so the test runner can accumulate all test results and produce a report.</p> <p>the list of assert methods:</p> \u65b9\u6cd5 \u68c0\u67e5\u5bf9\u8c61 \u5f15\u5165\u7248\u672c assertEqual(a, b) a == b assertNotEqual(a, b) a != b assertTrue(x) bool(x) is True assertFalse(x) bool(x) is False assertIs(a, b) a is b 3.1 assertIsNot(a, b) a is not b 3.1 assertIsNone(x) x is None 3.1 assertIsNotNone(x) x is not None 3.1 assertIn(a, b) a in b 3.1 assertNotIn(a, b) a not in b 3.1 assertIsInstance(a, b) isinstance(a, b) 3.2 assertNotIsInstance(a, b) not isinstance(a, b) 3.2 <p>\u8fd8\u6709 assertGreater/assertGreaterEqual\u3001assertLess/assertLessEqual\u3001assertRegex/assertNotRegex\u3001assertCountEqual \u7b49\u65ad\u8a00\u65b9\u6cd5\u3002</p> <p>\u8fd8\u53ef\u4ee5\u4f7f\u7528\u4e0b\u5217\u65b9\u6cd5\u6765\u68c0\u67e5\u5f02\u5e38\u3001\u8b66\u544a\u548c\u65e5\u5fd7\u6d88\u606f\u7684\u4ea7\u751f:</p> \u65b9\u6cd5 \u68c0\u67e5\u5bf9\u8c61 \u5f15\u5165\u7248\u672c assertRaises(exc, fun, args, *kwds) <code>fun(*args, **kwds)</code> \u5f15\u53d1\u4e86 exc assertRaisesRegex(exc, r, fun, args, *kwds) <code>fun(*args, **kwds)</code> \u5f15\u53d1\u4e86 exc \u5e76\u4e14\u6d88\u606f\u53ef\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f r \u76f8\u5339\u914d 3.1 assertWarns(warn, fun, args, *kwds) <code>fun(*args, **kwds)</code> \u5f15\u53d1\u4e86 warn 3.2 assertWarnsRegex(warn, r, fun, args, *kwds) <code>fun(*args, **kwds)</code> \u5f15\u53d1\u4e86 warn \u5e76\u4e14\u6d88\u606f\u53ef\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f r \u76f8\u5339\u914d 3.2 assertLogs(logger, level) <code>with</code> \u4ee3\u7801\u5757\u5728 logger \u4e0a\u4f7f\u7528\u4e86\u6700\u5c0f\u7684 level \u7ea7\u522b\u5199\u5165\u65e5\u5fd7 3.4 assertNoLogs(logger, level) <code>with</code> \u4ee3\u7801\u5757\u6ca1\u6709\u5728 logger \u4e0a\u4f7f\u7528\u6700\u5c0f\u7684 level \u7ea7\u522b\u5199\u5165\u65e5\u5fd7 3.10","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#entrypoint","title":"entrypoint","text":"<p>\u6d4b\u8bd5\u6a21\u5757\u4e00\u822c\u662f\u76f4\u63a5\u8fd0\u884c\u7684\uff0c\u5176\u4e2d\u7684\u5165\u53e3\u70b9\u89e6\u53d1\u6d4b\u8bd5\u7528\u4f8b\u7684\u8fd0\u884c\u3002 \u542f\u52a8\u8fd0\u884c\u540e\uff0c\u5c06\u5b9e\u4f8b\u5316\u6240\u6709\uff08\u6216\u6311\u9009\u7684\uff09\u7684TestCase\u5b50\u7c7b\uff0c\u5e76\u8fd0\u884c\u6240\u6709\uff08\u6216\u6311\u9009\u7684\uff09\u4ee5test\u6253\u5934\u7684\u65b9\u6cd5\uff08\u5355\u5143\u6d4b\u8bd5\uff09\u3002</p>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#main_run_testcase","title":"main run TestCase","text":"<pre><code>unittest.main(module='__main__', defaultTest=None, argv=None, testRunner=None, testLoader=unittest.defaultTestLoader, exit=True, verbosity=1, failfast=None, catchbreak=None, buffer=None, warnings=None)\n\nA command-line program that loads a set of tests from module and runs them; this is primarily for making test modules conveniently executable.\n</code></pre> <p>The simplest use for this function is to include the following line at the end of a test script:</p> <pre><code>if __name__ == '__main__':\n    unittest.main()\n</code></pre> <p>You can run tests with more detailed information by passing in the verbosity argument:</p> <pre><code>if __name__ == '__main__':\n    unittest.main(verbosity=2)\n</code></pre> <p>\u8003\u8651\u5728 vscode \u4e2d\u4f7f\u7528 Jupyter Notebook \u60c5\u666f\u3002</p> <p>\u5047\u8bbeCell 1\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a\u51fd\u6570\uff1a</p> <pre><code>def add(a, b):\n    return a + b\n</code></pre> <p>\u53ef\u5728Cell 2\u4e2d\u7f16\u5199\u6d4b\u8bd5Cell 1\u4e2dadd\u51fd\u6570\u7684\u5355\u6d4b\u7528\u4f8b\uff1a</p> <ul> <li>\u8fd0\u884cCell2\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u8fd0\u884cCell1\u4f7f\u4e4b\u52a0\u8f7d\u3002</li> </ul> <pre><code>import unittest\n\nclass TestNotebook(unittest.TestCase):\n\n    def test_add(self):\n        self.assertEqual(add(2, 3), 5)\n\nif __name__ == '__main__':\n    unittest.main(argv=[''], verbosity=2, exit=False)\n</code></pre> <p>\u6ce8\u610f\uff1a\u6d4b\u8bd5\u6846\u67b6\u5165\u53e3\u51fd\u6570 unittest.main() \u5728 ipykernel \u4e0b\u9700\u8981\u6307\u5b9a <code>argv</code> \u548c <code>exit</code> \u53c2\u6570\uff0c\u5426\u5219\u8fd0\u884c\u62a5\u9519\uff01</p> <p>\u7528\u5355\u5143\u6d4b\u8bd5\u8ba9\u4f60\u7684python\u4ee3\u7801\u66f4\u9760\u8c31\u6d4b\u8bd5\u51fd\u6570\u5355\u5143\u6d4b\u8bd5\u548c\u6d4b\u8bd5\u7528\u4f8b\u6d4b\u8bd5\u7c7b-\u817e\u8baf\u4e91\u5f00\u53d1\u8005\u793e\u533a-\u817e\u8baf\u4e91</p> <p>\u5047\u8bbe name_function.py \u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86 get_formatted_name \u51fd\u6570\uff1a</p> <pre><code>#!/usr/bin/env python3\n# -*- coding: UTF-8 -*-\n\ndef get_formatted_name(first, last, middle=''):\n    if middle:\n        full_name = first + ' ' + middle + ' ' + last\n    else:\n        full_name = first + ' ' + last\n    return full_name.title()\n</code></pre> <p>test_name_function.py \u5355\u6d4b name_function \u4e2d\u7684 get_formatted_name \u51fd\u6570\uff1a</p> <pre><code>#!/usr/bin/env python3\n# -*- coding: UTF-8 -*-\n\nimport unittest\nfrom name_function import get_formatted_name\n\n\nclass NameTestCase(unittest.TestCase):\n    def test_first_last_name(self):\n        formatted_name = get_formatted_name('janis', 'joplin')\n        self.assertEqual(formatted_name, 'Janis Joplin')\n\n    def test_first_last_middle_name(self):\n        formatted_name = get_formatted_name('wolfgang', 'mozart', 'amadeus')\n        self.assertEqual(formatted_name, 'Wolfgang Amadeus Mozart')\n\n\nunittest.main()\n</code></pre> <p>\u5728\u63a7\u5236\u53f0\u4e2d\u8fd0\u884c\u6d4b\u8bd5\u7528\u4f8b\u811a\u672c\uff1a</p> <pre><code>$ python3 test_name_function.py\n..\n----------------------------------------------------------------------\nRan 2 tests in 0.000s\n\nOK\n</code></pre> <p>\u6d4b\u8bd5\u6846\u67b6\u5165\u53e3\u51fd\u6570 unittest.main() \u9ed8\u8ba4 verbosity=1\uff0c\u53ef\u4fee\u6539\u4e3a2\uff0c\u4ee5\u4fbf\u6253\u5370\u66f4\u8be6\u7ec6\u7684\u5355\u6d4b\u8fc7\u7a0b\uff1a</p> <pre><code># unittest.main(verbosity=2)\n$ python3 test_name_function.py #or\n$ python -m unittest test_name_function.py #or\n$ python -m unittest -v test_name_function.py\n\ntest_first_last_middle_name (__main__.NameTestCase.test_first_last_middle_name) ... ok\ntest_first_last_name (__main__.NameTestCase.test_first_last_name) ... ok\n\n----------------------------------------------------------------------\nRan 2 tests in 0.000s\n\nOK\n</code></pre>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#texttestrunner_run_testsuite","title":"TextTestRunner run TestSuite","text":"<p>test suite</p> <p>A\u00a0test suite\u00a0is a collection of test cases, test suites, or both. It is used to aggregate tests that should be executed together.</p> <pre><code>class unittest.TextTestRunner(stream=None, descriptions=True, verbosity=1, failfast=False, buffer=False, resultclass=None, warnings=None, *, tb_locals=False, durations=None)\n\nA basic test runner implementation that outputs results to a stream. If stream is None, the default, sys.stderr is used as the output stream. This class has a few configurable parameters, but is essentially very simple. Graphical applications which run test suites should provide alternate implementations. Such implementations should accept **kwargs as the interface to construct runners changes when features are added to unittest.\n\nrun(test)\n    This method is the main public interface to the TextTestRunner. This method takes a TestSuite or TestCase instance.\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0cTestStringMethods \u5b9a\u4e49\u4e86\u4e09\u4e2a test \u7528\u4f8b\uff0cTestSuite addTest \u6dfb\u52a0\u4e24\u4e2a\u7528\u4f8b\uff0c\u7136\u540e\u8c03\u7528 unittest.TextTestRunner run TestSuite\u3002</p> <pre><code>import unittest\n\nclass TestStringMethods(unittest.TestCase):\n\n    def test_upper(self):\n        self.assertEqual('foo'.upper(), 'FOO')\n\n    def test_isupper(self):\n        self.assertTrue('FOO'.isupper())\n        self.assertFalse('Foo'.isupper())\n\n    def test_split(self):\n        s = 'hello world'\n        self.assertEqual(s.split(), ['hello', 'world'])\n        # check that s.split fails when the separator is not a string\n        with self.assertRaises(TypeError):\n            s.split(2)\n\n# if __name__ == '__main__':\n    # unittest.main(argv=[''], verbosity=2, exit=False)\n\ndef suite():\n    suite = unittest.TestSuite()\n    suite.addTest(TestStringMethods('test_upper'))\n    suite.addTest(TestStringMethods('test_isupper'))\n    return suite\n\nif __name__ == '__main__':\n    runner = unittest.TextTestRunner(verbosity=2)\n    runner.run(suite())\n</code></pre>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#main_or_texttestrunner","title":"main or TextTestRunner?","text":"<p>\u91c7\u7528 <code>unittest.main</code> \u4f5c\u4e3a\u6d4b\u8bd5\u5165\u53e3\u70b9\u65f6\uff0c\u4f1a\u542f\u52a8\u6267\u884c\u5f53\u524d\u6a21\u5757\uff08Python File\u6216Jupyter Notebook\uff09\u4e2d\u7684\u6240\u6709TestCase\u6d4b\u8bd5\u7528\u4f8b\u3002</p> <ol> <li>Python File \u5305\u542b\u591a\u4e2a TestCase</li> <li>Jupyter Code Cell \u4e2d\u5305\u542b\u591a\u4e2a TestCase</li> <li>Jupyter \u5305\u542b\u591a\u4e2a\u5305\u542b TestCase \u7684 Code Cell</li> </ol> <p>\u5982\u679c\u4e0d\u60f3\u6267\u884c\u6240\u6709\u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u6700\u597d\u5c06\u4e0d\u540c\u7684\u6d4b\u8bd5\u7528\u4f8b\u5206\u6563\u5230\u72ec\u7acb\u7684\u6a21\u5757\u4e2d\uff0c\u4fdd\u8bc1\u6bcf\u4e2aPython File\u6216\u8005Jupyter Notebook\u4e2d\u53ea\u6709\u4e00\u4e2aTestCase\u6d4b\u8bd5\u7528\u4f8b\u3002 \u4e5f\u53ef\u521b\u5efa TestSuite \u6309\u9700\u6dfb\u52a0\u6307\u5b9a TestCase \u7684\u6d4b\u8bd5\u7528\u4f8b\uff0c\u6539\u7528 <code>unittest.TextTestRunner</code> \u52a0\u8f7d TestSuite\uff0c\u518d\u8c03\u7528 run \u542f\u52a8\u6d4b\u8bd5\u7528\u4f8b\u3002</p>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#organization","title":"Organization","text":"","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#subtest","title":"subTest","text":"<p>Distinguishing test iterations using subtests</p> <p>When there are very small differences among your tests, for instance some parameters, unittest allows you to distinguish them inside the body of a test method using the <code>subTest</code>() context manager.</p> <p><code>self.subTest(msg=None, **params)</code> Return a context manager which executes the enclosed code block as a subtest.</p> <p>\u4e00\u822c\u7528\u5728for\u5faa\u73af\u4e0b\uff0c\u7ed3\u5408 with \u548c subTest \u5c06\u5faa\u73af\u4f53\u4ee3\u7801\u5757\u4f5c\u4e3a\u5b50\u6d4b\u8bd5\uff0c\u800c\u975e\u7b80\u5355\u7684\u4ee3\u7801\u8bed\u53e5\uff0c\u4ece\u800c\u62e5\u6709\u7c7b\u4f3c\u5355\u5143\u6d4b\u8bd5\u7684\u62a5\u9519\u673a\u5236\u3002 \u5bf9\u4e8e\u5927\u91cf\u903b\u8f91\u91cd\u590d\u7684\u5355\u5143\u6d4b\u8bd5\uff0c\u4ec5\u4ec5\u662f\u6d4b\u8bd5\u6570\u636e\u7d22\u5f15\u7ea7\u522b\u7684\u5dee\u5f02\uff0c\u53ef\u8003\u8651\u4f7f\u7528for\u5faa\u73af\u642d\u914dsubTest\u6539\u5199\u4e3a\u4e00\u4e2a\u5355\u5143\u6d4b\u8bd5\uff0c\u4f7f\u4ee3\u7801\u66f4\u7b80\u6d01\u3002</p> <pre><code>class NumbersTest(unittest.TestCase):\n\n    def test_even(self):\n        \"\"\"\n        Test that numbers between 0 and 5 are all even.\n        \"\"\"\n        for i in range(0, 6):\n            with self.subTest(i=i):\n                self.assertEqual(i % 2, 0)\n\nif __name__ == '__main__':\n    unittest.main(argv=[''], verbosity=2, exit=False)\n</code></pre> <p>Without using a subtest, execution would stop after the first failure, and the error would be less easy to diagnose because the value of <code>i</code> wouldn\u2019t be displayed.</p> <p>\u5bf9\u4e8e\u4ee5\u4e0a test_even \u7528\u4f8b\u4e2d\u7684 for \u5faa\u73af\uff0c\u5982\u679c\u4e0d\u6dfb\u52a0 subTest\uff0c\u90a3\u4e48i=1\u65f6\uff0c\u7528\u4f8b\u5373\u7acb\u5373\u5ba3\u544a\u5931\u8d25\u5e76\u9000\u51fa\u3002 \u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u5e0c\u671b\u8dd1\u5b8cfor\u5faa\u73af\uff0c\u5e76\u5c06\u5931\u8d25\u7684\u5faa\u73af\u53d8\u91cfi\u6253\u5370\u51fa\u6765\uff0c\u6dfb\u52a0 subTest \u53ef\u6ee1\u8db3\u8fd9\u79cd\u9700\u6c42\u3002</p>","tags":["unittest"]},{"location":"blog/20191205/python-unittest/#skip","title":"skip","text":"<p>Unittest supports skipping individual test methods and even whole classes of tests.</p> <p>Skipping a test is simply a matter of using the skip() decorator or one of its conditional variants:</p> <ul> <li>\u4ee5\u4e0b\u5728 python 3.10 \u4ee5\u4e0b\u8fd0\u884c\u65f6\uff0c\u5355\u5143\u6d4b\u8bd5 skipIf \u4f1a\u62a5 SyntaxError: invalid syntax \u9519\u8bef\uff0c\u56e0\u4e3a\u65e0\u6cd5\u8bc6\u522b match/case \u5173\u952e\u5b57\u3002</li> </ul> <pre><code>import sys, unittest\n\nclass MyTestCase(unittest.TestCase):\n\n    @unittest.skip(\"demonstrating skipping\")\n    def test_nothing(self):\n        self.fail(\"shouldn't happen\")\n\n    @unittest.skipUnless(sys.platform.startswith(\"win\"), \"requires Windows\")\n    def test_windows_support(self):\n        # windows specific testing code\n        pass\n\n    @unittest.skipIf(sys.version_info &lt; (3, 10),\n                     \"Python Version too low, upgrade to 3.10 or higher.\")\n    def test_match_case(self):\n        # Tests that work for Python &gt;= 3.10.\n        def http_error(status):\n            match status:\n                case 400:\n                    return \"Bad request\"\n                case 404:\n                    return \"Not found\"\n                case 418:\n                    return \"I'm a teapot\"\n                case _:\n                    return \"Something's wrong with the internet\"\n        self.assertEqual(http_error(404), \"Not found\")\n</code></pre> <p>Classes can be skipped just like methods:</p> <pre><code>@unittest.skip(\"MyTestCase\")\nclass MyTestCase(unittest.TestCase):\n    def test_not_run(self):\n        pass\n\n    def test_nothing(self):\n        self.fail(\"shouldn't happen\")\n</code></pre>","tags":["unittest"]},{"location":"blog/20191204/1-builtins/","title":"python\u5185\u7f6e\u6a21\u5757\u4e00\u89c8","text":"<p>Python\u5185\u7f6e\u6a21\u5757 builtins \u6982\u89c8\uff0cdir(builtins) \u5206\u7c7b\u68b3\u7406\u4e00\u89c8\u3002</p> <p>Built-in Functions</p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#id","title":"id","text":"<p>builtins.dir  </p> <p>builtins.id builtins.hash builtins.type  </p> <p>builtins.isinstance builtins.issubclass  </p> <p>builtins.hasattr builtins.getattr  </p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#vars","title":"vars","text":"<p>builtins.vars builtins.locals builtins.globals  </p> <p>argparse \u89e3\u6790\u53c2\u6570 <code>args = argparser.parse_args()</code>\uff0c\u8c03\u7528 print(args) \u6253\u5370\u51fa\u6765\u7684\u662f Namespace\uff1a</p> <pre><code>Namespace(debug=False, logpath='logs/19.09.30.14-MBR.log', platform=1)\n</code></pre> <p>\u8c03\u7528 print(vars(args)) \u4ee5\u5b57\u5178\u5f62\u5f0f\u6253\u5370 <code>object.__dict__</code>\uff1a</p> <pre><code>{'platform': 1, 'logpath': 'logs/19.09.30.14-MBR.log', 'debug': False}\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#types","title":"types","text":"","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#none","title":"None","text":"<p>builtins.None builtins.Ellipsis # \u7701\u7565\u53f7  </p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#bool","title":"bool","text":"<p>builtins.bool builtins.False builtins.True  </p> <p>builtins.any # \u4e00\u7ec4\u503c\u4e2d\u53ea\u8981\u6709\u4e00\u4e2a\u4e3a True\u3002</p> <ul> <li>bool(x) \u4f20\u5165\u6570\u503c 0 \u4e3a False\uff0c\u4f20\u5165\u975e 0 \u503c\u4e3a True\u3002  </li> <li>bool(x) \u4f20\u5165\u7a7a\u5bf9\u8c61 None \u4e3a False\uff0c\u4f20\u5165\u975e\u7a7a\u5bf9\u8c61\u4e3a True\u3002  </li> </ul>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#sequence_types","title":"Sequence Types","text":"<p>builtins.str - Text Sequence  </p> <p>builtins.list # array builtins.tuple builtins.range  </p> <p>builtins.slice  </p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#mapping_types","title":"Mapping Types","text":"<p>builtins.dict builtins.map  </p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#set_types","title":"Set Types","text":"<p>builtins.set builtins.frozenset  </p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#binary_sequence_types","title":"Binary Sequence Types","text":"<p>builtins.bytes builtins.bytearray builtins.memoryview  </p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#len__filter","title":"len &amp; filter","text":"<p>builtins.len # \u5bf9\u5b57\u7b26\u4e32\u3001\u5217\u8868\u7b49\u5e8f\u5217\u5316\u6570\u636e\u96c6\u5408\u6c42\u53d6\u957f\u5ea6\uff08size\uff09\u3002</p> <p>builtins.reversed builtins.filter builtins.sorted  </p> <p>builtins.zip  </p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#iterate","title":"iterate","text":"","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#enumerate","title":"enumerate","text":"<p>builtins.enumerate  </p> <p>help(enumerate) \u67e5\u770b\u76f8\u5173\u5e2e\u52a9\uff1a</p> <pre><code>class enumerate(object)\n |  enumerate(iterable, start=0)\n |\n |  Return an enumerate object.\n |\n |    iterable\n |      an object supporting iteration\n |\n |  The enumerate object yields pairs containing a count (from start, which\n |  defaults to zero) and a value yielded by the iterable argument.\n |\n |  enumerate is useful for obtaining an indexed list:\n |      (0, seq[0]), (1, seq[1]), (2, seq[2]), ...\n</code></pre> <p>\u679a\u4e3e\u5217\u8868\u7684\u7d22\u5f15\u4e0e\u503c\u3002</p> <p>\u5bf9 enumerate \u8fd4\u56de\u7684\u5bf9\u8c61\u8f6c\u6362\u4e3alist\uff0c\u53ef\u77e5\u5176\u5185\u4e3a (index, value) \u7684 tuple \u6570\u7ec4\u3002</p> <pre><code>&gt;&gt;&gt; l = [1,2,3,4]\n&gt;&gt;&gt; el = enumerate(l)\n&gt;&gt;&gt; list(el)\n[(0, 1), (1, 2), (2, 3), (3, 4)]\n</code></pre> <p>for \u5faa\u73af\u904d\u5386\u53d6 tuple \u4e8c\u7ef4\u5143\u7d20\u503c\uff1a</p> <pre><code>&gt;&gt;&gt; for i,e in enumerate(l):\n...     print('l[%d] = %d' % (i, e))\n...\nl[0] = 1\nl[1] = 2\nl[2] = 3\nl[3] = 4\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#iter__next","title":"iter &amp; next","text":"<p>builtins.iter builtins.next  </p> <pre><code>mytuple = (\"apple\", \"banana\", \"cherry\")\nmyit = iter(mytuple)\n\nprint(next(myit))\nprint(next(myit))\nprint(next(myit))\nprint(next(myit)) #StopIteration Exception!!!\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#open","title":"open","text":"<p>builtins.open  </p> <p>builtins.eval builtins.exec  </p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#warningerror","title":"warning/error","text":"<p>builtins.Warning builtins.UserWarning  </p> <p>builtins.IndexError builtins.FileExistsError builtins.FileNotFoundError  </p> <p>builtins.TypeError builtins.ValueError  </p> <p>Built-in Exceptions warnings \u2014 Warning control </p>","tags":["builtins"]},{"location":"blog/20191204/1-builtins/#refs","title":"refs","text":"<p>30\u6bb5\u6781\u7b80Python\u4ee3\u7801</p>","tags":["builtins"]},{"location":"blog/20191204/10-builtins.bytes/","title":"python\u5185\u7f6e\u6a21\u5757\u4e4b\u5b57\u8282(bytes,bytearray)","text":"<p>Python\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u5b57\u8282\u6d41\uff08bytes/bytearry\uff09\u7684\u57fa\u672c\u7528\u6cd5\u3002</p> <p>Binary Sequence Types \u2014 bytes, bytearray, memoryview</p> <ul> <li>Bytes Objects objects are immutable sequences of single bytes.  </li> <li>Bytearray Objects objects are a mutable counterpart to bytes objects.  </li> <li>Bytes and Bytearray Operations </li> </ul>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#bytes","title":"bytes","text":"<p>Bytes objects are immutable sequences of single bytes.</p> <p>class bytes \u6784\u9020\u58f0\u660e\u5982\u4e0b\uff1a</p> <pre><code>```Shell\n&gt;&gt;&gt; help(bytes)\n\nclass bytes(object)\n |  bytes(iterable_of_ints) -&gt; bytes\n |  bytes(string, encoding[, errors]) -&gt; bytes\n |  bytes(bytes_or_buffer) -&gt; immutable copy of bytes_or_buffer\n |  bytes(int) -&gt; bytes object of size given by the parameter initialized with null bytes\n |  bytes() -&gt; empty bytes object\n |\n |  Construct an immutable array of bytes from:\n |    - an iterable yielding integers in range(256)\n |    - a text string encoded using the specified encoding\n |    - any object implementing the buffer API.\n |    - an integer\n</code></pre> <p>\u6784\u9020\u65b9\u5f0f1\uff1a\u4f20\u5165\u6574\u6570\u6570\u7ec4\uff08\u503c\u5c0f\u4e8e256\uff09\uff0c\u5bf9\u5e94\u53ef\u663e\u793a\u7684ASCII\u7801\u3002</p> <pre><code>&gt;&gt;&gt; bytes([65, 66, 67, 68])\nb'ABCD'\n&gt;&gt;&gt; bytes([97, 98, 99, 100])\nb'abcd'\n</code></pre> <p>\u6784\u9020\u65b9\u5f0f2\uff1a</p> <pre><code>&gt;&gt;&gt; bytes('abcd', encoding='utf-8')\nb'abcd'\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#bytes_literals","title":"bytes literals","text":"<p>2.4.1. String and Bytes literals</p> <p>Bytes literals are always prefixed with 'b' or 'B'; they produce an instance of the <code>bytes</code> type instead of the <code>str</code> type. They may only contain ASCII characters; bytes with a numeric value of 128 or greater must be expressed with escapes.</p> <p>\u4ee5b\u5f00\u5934\u547d\u540d\u7684\u5b57\u7b26\u4e32\u4e3a\u5b57\u8282\u6d41\u4e32\uff1a</p> <pre><code>&gt;&gt;&gt; ba=b'\\xcf\\xc7'\n&gt;&gt;&gt; int.from_bytes(ba, byteorder='big')\n53191\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#fromhex","title":"fromhex","text":"<p>\u7c7b\u65b9\u6cd5 <code>fromhex</code> \u5c06\u4e00\u4e2a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5b57\u8282\u6d41\u3002</p> <pre><code> |  ----------------------------------------------------------------------\n |  Class methods defined here:\n |\n |  fromhex(string, /) from builtins.type\n |      Create a bytes object from a string of hexadecimal numbers.\n</code></pre> <p>The string must contain two hexadecimal digits per byte, with ASCII whitespace being ignored.</p> <pre><code>&gt;&gt;&gt; bytes.fromhex('B9 01EF')\nb'\\xb9\\x01\\xef'\n\n&gt;&gt;&gt; bytes.fromhex('2Ef0 F1f2  ')\nb'.\\xf0\\xf1\\xf2'\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#hexdump","title":"hexdump","text":"<p>hex \u65b9\u6cd5\u5c06 bytes \u5bf9\u8c61\u5b58\u50a8\u7684\u5b57\u8282\u4e32\u6309\u5341\u516d\u8fdb\u5236\u8f93\u51fa\uff0c\u7c7b\u4f3c hexdump \u6307\u4ee4\u3002</p> <pre><code> |  hex(...)\n |      Create a str of hexadecimal numbers from a bytes object.\n |\n |        sep\n |          An optional single character or byte to separate hex bytes.\n |        bytes_per_sep\n |          How many bytes between separators.  Positive values count from the\n |          right, negative values count from the left.\n</code></pre> <pre><code>&gt;&gt;&gt; b'\\xf0\\xf1\\xf2'.hex()\n'f0f1f2'\n\n&gt;&gt;&gt; b1=bytes([65, 66, 67, 68])\n&gt;&gt;&gt; b1.hex()\n'41424344'\n# \u5b57\u8282\u4e4b\u95f4\u4ee5:\u5206\u5272\n&gt;&gt;&gt; b1.hex(':')\n'41:42:43:44'\n# \u6bcf2\u4e2a\u5b57\u8282\u4e3a\u4e00\u7ec4\uff0c\u4ece\u53f3\u5f80\u5de6\n&gt;&gt;&gt; b2.hex(':', 2)\n'b9:01ef'\n# \u6bcf2\u4e2a\u5b57\u8282\u4e3a\u4e00\u7ec4\uff0c\u4ece\u5de6\u5f80\u53f3\n&gt;&gt;&gt; b2.hex(':', -2)\n'b901:ef'\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#bytearray","title":"bytearray","text":"<p>bytearray objects are a mutable counterpart to bytes objects.</p> <p>\u6784\u9020\u65b9\u6cd5\u57fa\u672c\u540c bytes \u7c7b\u3002</p> <pre><code>class bytearray(object)\n |  bytearray(iterable_of_ints) -&gt; bytearray\n |  bytearray(string, encoding[, errors]) -&gt; bytearray\n |  bytearray(bytes_or_buffer) -&gt; mutable copy of bytes_or_buffer\n |  bytearray(int) -&gt; bytes array of size given by the parameter initialized with null bytes\n |  bytearray() -&gt; empty bytes array\n |\n |  Construct a mutable bytearray object from:\n |    - an iterable yielding integers in range(256)\n |    - a text string encoded using the specified encoding\n |    - a bytes or a buffer object\n |    - any object implementing the buffer API.\n |    - an integer\n |\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#fromhex_1","title":"fromhex","text":"<pre><code>&gt;&gt;&gt; bytearray.fromhex('2Ef0 F1f2  ')\nbytearray(b'.\\xf0\\xf1\\xf2')\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#access_as_list","title":"access as list","text":"<p>Since bytearray objects are sequences of integers (akin to a list), for a bytearray object b, <code>b[0]</code> will be an integer, while <code>b[0:1]</code> will be a bytearray object of length 1.</p> <p>You can always convert a bytearray object into a list of integers using <code>list(b)</code>.</p> <p>\u53ef\u6309\u7d22\u5f15\u4f4d\u7f6e\u8bbf\u95ee\u5b57\u8282\uff1a</p> <pre><code>&gt;&gt;&gt; ba=bytearray.fromhex('cfc7')\n&gt;&gt;&gt; ba[0]\n207\n&gt;&gt;&gt; hex(ba[0])\n'0xcf'\n&gt;&gt;&gt; ba[1]\n199\n&gt;&gt;&gt; hex(ba[1])\n'0xc7'\n&gt;&gt;&gt; list(ba)\n[207, 199]\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#hexdump_1","title":"hexdump","text":"<p>\u540c bytes\uff0cbytearray \u4e5f\u652f\u6301 hex dump \u5341\u516d\u8fdb\u5236\u5b57\u8282\u6d41\uff1a</p> <pre><code>&gt;&gt;&gt; bytearray(b'\\xf0\\xf1\\xf2').hex()\n'f0f1f2'\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#int","title":"int","text":"","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#from_bytes","title":"from_bytes","text":"<p>\u7c7b\u65b9\u6cd5 <code>from_bytes()</code> \u5c06\u5b57\u8282\u4e32\uff08\u6570\u7ec4\uff09\uff0c\u6309\u7ed9\u5b9a\u7684\u5b57\u8282\u5e8f\u89e3\u6790\u6784\u9020\u6574\u6570\u3002</p> <pre><code>class int(object)\n\n |  Class methods defined here:\n |\n |  from_bytes(bytes, byteorder, *, signed=False) from builtins.type\n |      Return the integer represented by the given array of bytes.\n</code></pre> <pre><code>&gt;&gt;&gt; num1 = int.from_bytes(b'\\xff' * 2, byteorder = 'big')\n&gt;&gt;&gt; num2 = int.from_bytes(b'\\xff' * 4, byteorder = 'little')\n&gt;&gt;&gt; num1\n65535\n&gt;&gt;&gt; num2\n4294967295\n</code></pre> <p>\u5341\u516d\u8fdb\u5236 0xcfc7 \u7684\u5927\u7aef\u65e0\u7b26\u53f7\u6570\uff0c\u6700\u9ad8\u4f4d1\u7684\u4f4d\u6743\u4e3a <code>2**15</code>\uff1a</p> <pre><code># 2**15+20423(0x4fc7)\n&gt;&gt;&gt; int.from_bytes(b'\\xcf\\xc7', byteorder='big')\n53191\n</code></pre> <p>\u5341\u516d\u8fdb\u5236 0xcfc7 \u7684\u5927\u7aef\u6709\u7b26\u53f7\u6570\uff0c\u5728\u8865\u7801\u8868\u793a\u4e0b\uff0c\u6700\u9ad8\u4f4d1\u4e3a\u7b26\u53f7\u4f4d\uff0c\u4f4d\u6743\u4e3a <code>-2**15</code>\uff09\uff1a</p> <pre><code># -2**15+20423(0x4fc7)\n&gt;&gt;&gt; int.from_bytes(b'\\xcf\\xc7', byteorder='big', signed=True)\n-12345\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#to_bytes","title":"to_bytes","text":"<p>\u5b9e\u4f8b\u65b9\u6cd5 <code>to_bytes()</code> \u6253\u5370\u4e00\u4e2a\u6574\u6570\u5728\u5185\u5b58\u5b58\u50a8\u4e2d\u7684\u5b57\u8282\u6570\u7ec4\u8868\u793a\uff1a</p> <p>Converting int to bytes in Python 3</p> <pre><code>class int(object)\n\n |  to_bytes(self, /, length, byteorder, *, signed=False)\n |      Return an array of bytes representing an integer.\n</code></pre> <ul> <li>length\uff1a\u6309\u591a\u5c11\u4e2a\u5b57\u8282\u6570\u7ec4\u5b58\u50a8\uff08\u8f93\u51fa\uff09\u3002</li> <li>byteorder\uff1a\u4e3a\u65b9\u4fbf\u5206\u6790\u53ef\u5148\u586b big\uff0c\u4e5f\u53ef\u8bfb\u53d6\u5b9e\u9645\u7684 sys.byteorder\u3002</li> <li>signed\uff1a\u9ed8\u8ba4\u4e3aFalse\uff0c\u5373\u9ed8\u8ba4\u6309\u65e0\u7b26\u53f7\u6570\u5904\u7406\uff0c\u53ef\u6309\u9700\u7f6e True \u5c06\u6309\u6709\u7b26\u53f7\u6570\u5904\u7406\u3002</li> </ul> <p>\u65e0\u7b26\u53f7\u6570\uff08\u6b63\u6570\uff0953191\u7684unsigned short\u5927\u7aef\u5185\u5b58\u8868\u793a\u4e3a\uff1a</p> <pre><code>&gt;&gt;&gt; (53191).to_bytes(2, 'big')\nb'\\xcf\\xc7'\n</code></pre> <p>\u5c06length\u6269\u5927\u52304\uff0c\u5373\u5c06 unsigned short 16 \u6269\u5c55\u4e3a unsigned int 32\uff0c\u53ea\u9700\u8981\u5728\u9ad8\u4f4d\u88650\u5373\u53ef\u3002</p> <pre><code>&gt;&gt;&gt; (53191).to_bytes(4, 'big')\nb'\\x00\\x00\\xcf\\xc7'\n</code></pre> <p>\u6709\u7b26\u53f7\u6570\uff08\u8d1f\u6570\uff09-12345 \u5728\u5185\u5b58\u4e2d\u6309\u5927\u7aef\u5b57\u8282\u5e8f\u7684\u8865\u7801\u8868\u793a\uff1a</p> <pre><code>&gt;&gt;&gt; (-12345).to_bytes(2, 'big', signed=True)\nb'\\xcf\\xc7'\n</code></pre> <p>\u57fa\u4e8e\u8d1f\u6570\u7684\u8865\u7801\u8868\u793a\u673a\u5236\u63a8\u5bfc\u5982\u4e0b\uff1a</p> <p>short\u8d1f\u6570\uff082Byte-16bit\uff09s=-12345\uff0c\u6700\u9ad8\u7b2c15\u4f4d\u4e3a\u7b26\u53f7\u4f4d\u4e3a1\uff0c\u7b2c14~0\u4f4d\u7684\u5341\u8fdb\u5236\u503c\u4e3au\uff0c\u5219\uff1a</p> <p>s=<code>-2**15+u</code> =&gt; u=<code>2**15+s</code> =&gt; u=<code>2**15-12345</code>=20423 =&gt; hex(u)='0x4fc7'\uff0c \u6700\u9ad8\u7b2c15\u4f4d\u7b26\u53f7\u4f4d\u7f6e1\uff0c\u5219\u8d1f\u6570s\u7684\u5341\u516d\u8fdb\u5236\u8865\u7801\u8868\u793a\u662f0xcfc7\u3002</p> <p>\u5c06length\u6269\u5927\u52304\uff0c\u5373\u5c06 short 16 \u6269\u5c55\u4e3a int 32\uff0c\u53ea\u9700\u8981\u5728\u9ad8\u4f4d\u88651\u5373\u53ef\u3002</p> <pre><code>&gt;&gt;&gt; (-12345).to_bytes(4, 'big', signed=True)\nb'\\xff\\xff\\xcf\\xc7'\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#float","title":"float","text":"<pre><code>&gt;&gt;&gt; help(float)\n\n |  fromhex(string, /) from builtins.type\n |      Create a floating-point number from a hexadecimal string.\n</code></pre> <pre><code>&gt;&gt;&gt; float.fromhex('0x1.ffffp10')\n2047.984375\n&gt;&gt;&gt; float.fromhex('-0x1p-1074')\n-5e-324\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#struct","title":"struct","text":"<p>struct \u2014 Interpret bytes as packed binary data - struct --- \u5c06\u5b57\u8282\u4e32\u89e3\u8bfb\u4e3a\u6253\u5305\u7684\u4e8c\u8fdb\u5236\u6570\u636e</p> <p>\u6b64\u6a21\u5757\u53ef\u4ee5\u6267\u884c Python \u503c\u548c\u4ee5 Python bytes \u5bf9\u8c61\u8868\u793a\u7684 C \u7ed3\u6784\u4e4b\u95f4\u7684\u8f6c\u6362\u3002 \u8fd9\u53ef\u4ee5\u88ab\u7528\u6765\u5904\u7406\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\u6216\u662f\u4ece\u7f51\u7edc\u8fde\u63a5\u7b49\u5176\u4ed6\u6765\u6e90\u83b7\u53d6\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002 \u5b83\u4f7f\u7528 \u683c\u5f0f\u5b57\u7b26\u4e32 \u4f5c\u4e3a C \u7ed3\u6784\u5e03\u5c40\u7684\u7cbe\u7b80\u63cf\u8ff0\u4ee5\u53ca\u4e0e Python \u503c\u7684\u53cc\u5411\u8f6c\u6362\u3002</p> <ul> <li>struct \u2014 Binary Data Structures</li> <li>python\u4e4bstruct \u6a21\u5757\u8be6\u89e3</li> <li>Python\u4f7f\u7528struct\u5904\u7406\u4e8c\u8fdb\u5236</li> </ul>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#\u5b57\u8282\u987a\u5e8f\u5927\u5c0f\u548c\u5bf9\u9f50\u65b9\u5f0f","title":"\u5b57\u8282\u987a\u5e8f\uff0c\u5927\u5c0f\u548c\u5bf9\u9f50\u65b9\u5f0f","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cC\u7c7b\u578b\u4ee5\u673a\u5668\u7684\u672c\u673a\u683c\u5f0f\u548c\u5b57\u8282\u987a\u5e8f\u8868\u793a\uff0c\u5e76\u5728\u5fc5\u8981\u65f6\u901a\u8fc7\u8df3\u8fc7\u586b\u5145\u5b57\u8282\u8fdb\u884c\u6b63\u786e\u5bf9\u9f50\uff08\u6839\u636eC\u7f16\u8bd1\u5668\u4f7f\u7528\u7684\u89c4\u5219\uff09\u3002</p> <p>\u6216\u8005\u6839\u636e\u4e0b\u8868\u683c\u5f0f\u5b57\u7b26\u4e32\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\uff0c\u53ef\u7528\u4e8e\u6307\u793a\u6253\u5305\u6570\u636e\u7684\u5b57\u8282\u987a\u5e8f\u3001\u5927\u5c0f\u548c\u5bf9\u9f50\u65b9\u5f0f\uff1a</p> <p>\u7f3a\u7701\u4e3a <code>@</code>\u3002</p> \u5b57\u7b26 \u5b57\u8282\u987a\u5e8f \u5927\u5c0f \u5bf9\u9f50\u65b9\u5f0f <code>@</code> \u6309\u539f\u5b57\u8282 \u6309\u539f\u5b57\u8282 \u6309\u539f\u5b57\u8282 <code>=</code> \u6309\u539f\u5b57\u8282 \u6807\u51c6 \u65e0 <code>&lt;</code> \u5c0f\u7aef \u6807\u51c6 \u65e0 <code>&gt;</code> \u5927\u7aef \u6807\u51c6 \u65e0 <code>!</code> \u7f51\u7edc\uff08=\u5927\u7aef\uff09 \u6807\u51c6 \u65e0 <ol> <li> <p>\u53ef\u4f7f\u7528 <code>sys.byteorder</code> \u6765\u68c0\u67e5\u4f60\u7684\u7cfb\u7edf\u5b57\u8282\u987a\u5e8f\u3002</p> <ul> <li>\u5728 macOS \u4e0b\uff0c\u53ef\u901a\u8fc7 <code>system_profiler SPHardwareDataType</code>\u3001<code>system_profiler SPSoftwareDataType</code>\u3001<code>sw_vers</code> \u7b49\u547d\u4ee4\u67e5\u770b\u7cfb\u7edf\u8f6f\u786c\u4ef6\u4fe1\u606f\u3002</li> </ul> </li> <li> <p>\u672c\u673a\u5927\u5c0f\u548c\u5bf9\u9f50\u65b9\u5f0f\u662f\u4f7f\u7528 C \u7f16\u8bd1\u5668\u7684 <code>sizeof</code> \u8868\u8fbe\u5f0f\u6765\u786e\u5b9a\u7684\uff0c\u8fd9\u603b\u662f\u4f1a\u4e0e\u672c\u673a\u5b57\u8282\u987a\u5e8f\u76f8\u7ed1\u5b9a\u3002</p> </li> <li>\u6807\u51c6\u5927\u5c0f\u4ec5\u53d6\u51b3\u4e8e\u683c\u5f0f\u5b57\u7b26\uff1b\u8bf7\u53c2\u9605\u4e0b\u6587 \u683c\u5f0f\u5b57\u7b26 \u90e8\u5206\u4e2d\u7684\u8868\u683c\u3002</li> <li>\u8bf7\u6ce8\u610f '@' \u548c '=' \u4e4b\u95f4\u7684\u533a\u522b\uff1a\u4e24\u4e2a\u90fd\u4f7f\u7528\u672c\u673a\u5b57\u8282\u987a\u5e8f\uff0c\u4f46\u540e\u8005\u7684\u5927\u5c0f\u548c\u5bf9\u9f50\u65b9\u5f0f\u662f\u6807\u51c6\u5316\u7684\u3002</li> </ol> <p>\u6ce8\u91ca\uff1a</p> <ol> <li>\u586b\u5145\u53ea\u4f1a\u5728\u8fde\u7eed\u7ed3\u6784\u6210\u5458\u4e4b\u95f4\u81ea\u52a8\u6dfb\u52a0\u3002 \u586b\u5145\u4e0d\u4f1a\u6dfb\u52a0\u5230\u5df2\u7f16\u7801\u7ed3\u6784\u7684\u5f00\u5934\u548c\u672b\u5c3e\u3002</li> <li>\u5f53\u4f7f\u7528\u975e\u672c\u673a\u5927\u5c0f\u548c\u5bf9\u9f50\u65b9\u5f0f\u5373 '&lt;', '&gt;', '=', and '!' \u65f6\u4e0d\u4f1a\u6dfb\u52a0\u4efb\u4f55\u586b\u5145\u3002</li> <li>\u8981\u5c06\u7ed3\u6784\u7684\u672b\u5c3e\u5bf9\u9f50\u5230\u7b26\u5408\u7279\u5b9a\u7c7b\u578b\u7684\u5bf9\u9f50\u8981\u6c42\uff0c\u8bf7\u4ee5\u8be5\u7c7b\u578b\u4ee3\u7801\u52a0\u91cd\u590d\u8ba1\u6570\u7684\u96f6\u4f5c\u4e3a\u683c\u5f0f\u7ed3\u675f\u3002</li> </ol>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#\u683c\u5f0f\u5b57\u7b26","title":"\u683c\u5f0f\u5b57\u7b26","text":"\u683c\u5f0f C \u7c7b\u578b Python \u7c7b\u578b \u6807\u51c6\u5927\u5c0f \u5907\u6ce8 x \u586b\u5145\u5b57\u8282 \u65e0 N/A (7) c char \u957f\u5ea6\u4e3a 1 \u7684\u5b57\u8282\u4e32 1 N/A b signed \u6574\u6570 1 (1), (2) B unsigned \u6574\u6570 1 (2) ? _Bool bool 1 (1) h short \u6574\u6570 2 (2) H unsigned short \u6574\u6570 2 (2) i int \u6574\u6570 4 (2) I unsigned \u6574\u6570 4 (2) l long \u6574\u6570 4 (2) L unsigned \u6574\u6570 4 (2) q long \u6574\u6570 8 (2) Q unsigned \u6574\u6570 8 (2) n ssize_t \u6574\u6570 N/A (3) N size_t \u6574\u6570 N/A (3) e (6) float 2 (4) f float float 4 (4) d double float 8 (4) s char[] \u5b57\u8282\u4e32 N/A N/A p char[] \u5b57\u8282\u4e32 N/A N/A P void \u6574\u6570 N/A (5)","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#\u793a\u4f8b","title":"\u793a\u4f8b","text":"","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#hhi_-_hhq","title":"hhi -&gt; hhq","text":"<pre><code>#%%\nimport struct\nimport binascii\n\nprint(struct.calcsize('hhi'))\npacked = struct.pack('hhi', 1, 2, 3)\nprint(packed)\nprint(binascii.hexlify(packed))\n\nprint(struct.calcsize('&gt;hhi'))\npacked = struct.pack('&gt;hhi', 1, 2, 3)\nprint(packed)\nprint(binascii.hexlify(packed))\n</code></pre> <p>\u4ece\u8f93\u51fa\u7ed3\u679c\u770b\uff0c\u9ed8\u8ba4\u662f\u5c0f\u7aef\u5b57\u8282\u5e8f\uff1a</p> <pre><code>8\nb'\\x01\\x00\\x02\\x00\\x03\\x00\\x00\\x00'\nb'0100020003000000'\n8\nb'\\x00\\x01\\x00\\x02\\x00\\x00\\x00\\x03'\nb'0001000200000003'\n</code></pre> <p>\u5c06 <code>hhi</code> \u6362\u6210 <code>hhl</code>\uff1a</p> <ol> <li>\u5b57\u8282\u987a\u5e8f\u3001\u5927\u5c0f\u3001\u5bf9\u9f50\u65b9\u5f0f\u6309\u539f\u5b57\u8282\uff0cshort s1+short s2\u5171\u53604\u4e2a\u5b57\u8282\uff0c\u8865\u51454\u4e2a\u5b57\u8282\u586b0\u4e0e\u540e\u9762long l\u6309\u539f\u5b57\u8282\u662f8\u4e2a\u5b57\u8282\u5bf9\u9f50\uff0c\u7ed3\u6784\u4f53\u6574\u4f53size=16\u3002</li> <li>\u6307\u5b9a\u5927\u7aef\u5b57\u8282\u987a\u5e8f\uff0cshort s1+short s2\u5171\u53604\u4e2a\u5b57\u8282\uff0c\u65e0\u5bf9\u9f50\u6807\u51c6\u5927\u5c0f\uff0c\u7d27\u63a5\u7740l(long)\u4e5f\u53604\u4e2a\u5b57\u8282\uff0c\u7ed3\u6784\u4f53\u6574\u4f53size=8\u3002</li> </ol> <p>\u6ce8\u610f\uff1aq(long)\u624d\u53608\u4e2a\u5b57\u8282\uff01</p> <pre><code>16\nb'\\x01\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00'\nb'01000200000000000300000000000000'\n8\nb'\\x00\\x01\\x00\\x02\\x00\\x00\\x00\\x03'\nb'0001000200000003'\n</code></pre> <p>\u5c06 <code>hhi</code> \u6362\u6210 <code>hhq</code>\uff0ccalcsize \u5206\u522b\u662f 16\u300112\uff08=\u6807\u51c6\u5927\u5c0f=2+2+8\uff09\u3002</p> <p><code>hhi</code> \u548c <code>hhq</code> \u7b49\u6548\u7684C\u8bed\u8a00\u6d4b\u8bd5\u4ee3\u7801\uff0csizeof \u5206\u522b\u8f93\u51fa\uff1a4,8,8,16\u3002</p> <ol> <li>S1\uff1as1+s2\u5171\u53604\u4e2a\u5b57\u8282\uff0c\u4e0ei\u5360\u76844\u4e2a\u5b57\u8282\u5bf9\u9f50\uff0c\u65e0\u9700\u586b\u5145\uff0c\u7ed3\u6784\u4f53\u6574\u4f53size=8\u3002</li> <li>S2\uff1as1+s2\u5171\u53604\u4e2a\u5b57\u8282\uff0c\u9700\u8865\u51454\u4e2a\u5b57\u8282\uff0c\u4e0el\u5360\u76848\u4e2a\u5b57\u8282\u5bf9\u9f50\uff0c\u7ed3\u6784\u4f53\u6574\u4f53size=16\u3002</li> </ol> <pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct tagS1 {\n    short s1;\n    short s2;\n    int i;\n} S1;\n\ntypedef struct tagS2 {\n    short s1;\n    short s2;\n    long l;\n} S2;\n\nint main(int argc, char** argv) {\n    printf(\"sizeof int = %lu\\n\", sizeof(int));\n    printf(\"sizeof long = %lu\\n\", sizeof(long));\n    printf(\"sizeof S1 = %lu\\n\", sizeof(S1));\n    printf(\"sizeof S2 = %lu\\n\", sizeof(S2));\n\n    return 0;\n}\n</code></pre>","tags":["bytes","bytearray"]},{"location":"blog/20191204/10-builtins.bytes/#hhqhqhqhh","title":"hhq,hqh,qhh","text":"<p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cstruct.calcsize \u8ba1\u7b97\u7684\u5c3a\u5bf8\u548cC\u8bed\u8a00\u4e2d\u7684struct\u5e03\u5c40\u5360\u7528\u7684\u5b57\u8282\u6570\u53ef\u80fd\u4e0d\u4e00\u81f4\uff1a</p> <pre><code># %%\nimport struct\nimport binascii\n\n\nprint(struct.calcsize('hhq'))\npacked = struct.pack('hqh', 1, 2, 3)\nprint(packed)\nprint(binascii.hexlify(packed))\n\nprint(struct.calcsize('hqh'))\npacked = struct.pack('hqh', 1, 2, 3)\nprint(packed)\nprint(binascii.hexlify(packed))\n\nprint(struct.calcsize('qhh'))\npacked = struct.pack('hqh', 1, 2, 3)\nprint(packed)\nprint(binascii.hexlify(packed))\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\uff1a</p> <ul> <li>struct.calcsize('hhq') = 16 = 2+2+(4)+8</li> <li>struct.calcsize('hqh') = 18 = 2+(6)+8+2</li> <li>struct.calcsize('qhh') = 12 = 8+2+2</li> </ul> <p>\u5206\u6790\uff1a\u524d\u9762\u7684\u77ed\u5b57\u8282\u586b\u5145\u5bf9\u9f50\u540e\u9762\u7684\u957f\u5b57\u8282\uff0c\u957f\u5b57\u8282\u540e\u9762\u7684\u77ed\u5b57\u8282\u4e0d\u7528\u518d\u5bf9\u9f50\u3002</p> <p>\u7b49\u6548\u7684C\u8bed\u8a00\u6d4b\u8bd5\u4ee3\u7801\uff0csizeof \u5206\u522b\u4e3a 16, 24, 16\u3002</p> <pre><code>#include &lt;stdio.h&gt;\n\ntypedef unsigned char *byte_pointer;\n\nvoid show_bytes(byte_pointer start, size_t len) {\n    size_t i;\n    printf(\"0x\");\n    for (i=0; i&lt;len; i++)\n        printf(\"%.2x\", start[i]);\n    printf(\"\\n\");\n}\n\n// hhq\ntypedef struct tagS2 {\n    short s1;\n    short s2;\n    long l;\n} S2;\n\n// hqh\ntypedef struct tagS3 {\n    short s1;\n    long l;\n    short s2;\n} S3;\n\n// qhh\ntypedef struct tagS4 {\n    long l;\n    short s1;\n    short s2;\n} S4;\n\nint main(int argc, char** argv) {\n    // hexdump bytearray\n    printf(\"sizeof S2 = %lu\\n\", sizeof(S2));\n    S2 s2 = {1, 2, 3};\n    show_bytes((byte_pointer)&amp;s2, sizeof(S2));\n\n    printf(\"sizeof S3 = %lu\\n\", sizeof(S3));\n    S3 s3 = {1, 2, 3};\n    show_bytes((byte_pointer)&amp;s3, sizeof(S3));\n\n    printf(\"sizeof S4 = %lu\\n\", sizeof(S4));\n    S4 s4 = {1, 2, 3};\n    show_bytes((byte_pointer)&amp;s4, sizeof(S4));\n\n    return 0;\n}\n</code></pre> <p>\u5728 macOS\uff08litte-endian\uff09\u4e0a\u7684\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>sizeof S2 = 16\n0x01000200000000000300000000000000\nsizeof S3 = 24\n0x010000000000000002000000000000000300000000000000\nsizeof S4 = 16\n0x01000000000000000200030000000000\n</code></pre> <p>\u5bf9 sizeof struct \u957f\u5ea6\u7684\u7b80\u6790\uff1a</p> <ul> <li>16=2+2+(4)+8</li> <li>24=2+(6)+8+2+(6)</li> <li>16=8+2+2+(4)</li> </ul>","tags":["bytes","bytearray"]},{"location":"blog/20191204/11-builtins.utilities/","title":"python\u5185\u7f6e\u6a21\u5757\u4e4b\u5de5\u5177\u96c6","text":"<p>Python\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u4e00\u4e9b\u5b9e\u7528\u7684\u5c0f\u547d\u4ee4\u53ca\u65e5\u5e38\u7528\u6cd5\u96c6\u9526\u3002</p> <p>Built-in Functions</p>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#len","title":"len","text":"<pre><code>    len(obj, /)\n        Return the number of items in a container.\n</code></pre> <p>\u5bf9\u4e8e\u5b57\u7b26\u4e32\uff08str\uff09\u3001\u6570\u7ec4\uff08array\uff09\u3001\u5217\u8868\uff08list\uff09\u3001\u5143\u7ec4\uff08tuple\uff09\u3001\u96c6\u5408\uff08set\uff09\u3001\u5b57\u5178\uff08dict\uff09\u7b49\u5e38\u7528\u5e8f\u5217\u6216\u96c6\u5408\uff0c\u5747\u53ef\u8c03\u7528 len \u53d6\u5176\u5927\u5c0f\uff08\u672c\u8d28\u4e0a\u662f\u8c03\u7528\u7c7b\u7684 <code>__len__()</code> \u65b9\u6cd5\uff09\u3002</p> <pre><code># len(str)\uff1a\u8fd4\u56de\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u7b26\u4e2a\u6570\u3002\u7b49\u6548\u4e8e\u8c03\u7528 str.__len__()\n&gt;&gt;&gt; str1='hello,world!'\n&gt;&gt;&gt; len(str1)\n12\n\n&gt;&gt;&gt; str2='\"Isn\\'t,\" she said.'\n&gt;&gt;&gt; print(str2)\n\"Isn't,\" she said.\n&gt;&gt;&gt; len(str2)\n18\n\n# len(array)\uff1a\u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u4e2a\u6570\u3002\u7b49\u6548\u4e8e\u8c03\u7528 array.__len__()\n&gt;&gt;&gt; a=array.array('i', [2018,5,4])\n&gt;&gt;&gt; len(a)\n3\n\n# len(list)\uff1a\u8fd4\u56de\u5217\u8868\u4e2d\u7684\u5143\u7d20\u4e2a\u6570\uff08\u4ee5\u9017\u53f7\u5206\u9694\uff09\u3002\u7b49\u6548\u4e8e\u8c03\u7528 list.__len__()\n&gt;&gt;&gt; squares = [1, 4, 9, 16, 25]\n&gt;&gt;&gt; len(squares)\n5\n\n&gt;&gt;&gt; len(dir(builtins))\n152\n&gt;&gt;&gt; len(dir(str))\n77\n\n# len(tuple)\uff1a\u8fd4\u56de\u5143\u7ec4\u4e2d\u7684\u5143\u7d20\u4e2a\u6570\uff08\u4ee5\u9017\u53f7\u5206\u9694\uff09\u3002\u7b49\u6548\u4e8e\u8c03\u7528 tuple.__len__()\n&gt;&gt;&gt; t = 12345, 54321, 'hello!'\n&gt;&gt;&gt; print(t)\n(12345, 54321, 'hello!')\n&gt;&gt;&gt; len(t)\n3\n\n&gt;&gt;&gt; v = ([1, 2, 3], [3, 2, 1])\n&gt;&gt;&gt; len(v)\n2\n\n# len(set)\uff1a\u8fd4\u56de\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u4e2a\u6570\uff08\u4ee5\u9017\u53f7\u5206\u9694\uff0c\u81ea\u52a8\u53bb\u91cd\uff09\u3002\u7b49\u6548\u4e8e\u8c03\u7528 set.__len__()\n&gt;&gt;&gt; basket = {'apple', 'orange', 'apple', 'pear', 'orange', 'banana'}\n&gt;&gt;&gt; len(basket)\n4\n\n# len(dict)\uff1a\u8fd4\u56de\u5b57\u5178\u4e2d\u7684\u5143\u7d20\u4e2a\u6570\uff08\u4ee5\u9017\u53f7\u5206\u9694\uff0c\u952e\u503c\u5bf9\u6570\uff09\u3002\u7b49\u6548\u4e8e\u8c03\u7528 dict.__len__()\n&gt;&gt;&gt; tel={'sape': 4139, 'guido': 4127, 'jack': 4098}\n&gt;&gt;&gt; len(tel)\n3\n\n&gt;&gt;&gt; len(builtins.__dict__)\n152\n&gt;&gt;&gt; len(str.__dict__)\n68\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#ascii","title":"ascii","text":"<p>builtins.ascii builtins.ord # \u8fd4\u56de Unicode \u7f16\u7801 builtins.chr # \u8fd4\u56de Unicode \u7f16\u7801\u5bf9\u5e94\u7684\u5b57\u7b26  </p> <p><code>ord(c)</code>: Given a string representing one Unicode character, return an integer representing the Unicode code point of that character.</p> <pre><code>&gt;&gt;&gt; ord('a')\n97\n&gt;&gt;&gt; ord('A')\n65\n</code></pre> <p><code>chr(i)</code>: Return the string representing a character whose Unicode code point is the integer i.</p> <pre><code>&gt;&gt;&gt; chr(97)\n'a'\n&gt;&gt;&gt; chr(65)\n'A'\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#str_to_int","title":"str to int","text":"<p>\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6574\u5f62\u3001\u6d6e\u70b9\u578b\uff1a</p> <pre><code>&gt;&gt;&gt; help(int)\n\nclass int(object)\n |  int([x]) -&gt; integer\n |  int(x, base=10) -&gt; integer\n</code></pre> <p>Python \u6570\u5b57\u7cfb\u5217-\u6570\u5b57\u683c\u5f0f\u5316\u8f93\u51fa</p> <p>\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6574\u5f62\uff1a</p> <pre><code>&gt;&gt;&gt; int('32')\n32\n</code></pre> <p>\u5c06\u5b57\u7b26\u4e32\u6309base\u6307\u5b9a\u7684\u8fdb\u5236\u8f6c\u6362\u4e3a\u6574\u5f62\uff1a</p> <pre><code># \u8f93\u51fa16\u8fdb\u52360x32\u7684\u5341\u8fdb\u5236\u503c\uff1a\n&gt;&gt;&gt; int('32', base=16)\n50\n&gt;&gt;&gt; int('0x32', base=16)\n50\n# \u8f93\u51fa2\u8fdb\u52360b1011\u7684\u5341\u8fdb\u5236\u503c\uff1a\n&gt;&gt;&gt; int('1011', base=2)\n11\n&gt;&gt;&gt; int('0b1011', base=2)\n11\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#integer_literals","title":"Integer literals","text":"<p>Integer literals</p> <p>Python \u4e0b\u7684\u6574\u5f62\u5b57\u9762\u91cf\u53ef\u4ee5 <code>_</code> \u4e32\u8054\uff0c\u7c7b\u4f3c\u5343\u4f4d\u5206\u9694\u7b26(thousands separator)\uff1a</p> <pre><code>&gt;&gt;&gt; 100_000_000\n100000000\n</code></pre> <p>Using the comma as a thousands separator:</p> <pre><code>&gt;&gt;&gt; '{:,}'.format(1234567890)\n'1,234,567,890'\n&gt;&gt;&gt; '{:,}'.format(100000000)\n'100,000,000'\n&gt;&gt;&gt; '{:_}'.format(100000000)\n'100_000_000'\n&gt;&gt;&gt; f'{100000000:,}'\n'100,000,000'\n</code></pre> <p>311 \u7684\u4e8c\u8fdb\u5236\u5b57\u9762\u91cf\u5199\u6cd5\u4e3a 0b100110111\uff1a</p> <pre><code>&gt;&gt;&gt; bin(311)\n'0b100110111'\n&gt;&gt;&gt; 0b100110111\n311\n&gt;&gt;&gt; 0b_100110111\n311\n&gt;&gt;&gt; 0b_1_0011_0111\n311\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#itertools","title":"itertools","text":"<p>\u5177\u4f53\u53c2\u8003\u8fed\u4ee3\u5668\u4e13\u9898\uff1aiterator\u3002</p> <p>\u5185\u7f6e\u7684 <code>iter()</code> \u51fd\u6570\u8fd4\u56de\u8fed\u4ee3\u5668\uff08iterator\uff09\uff0c<code>next()</code> \u51fd\u6570\u5219\u904d\u5386\u8fed\u4ee3\u5668\uff0c\u89e3\u5f15\u7528\u8fd4\u56de\u904d\u5386\u5230\u7684\u4f4d\u7f6e\u5bf9\u5e94\u7684\u5143\u7d20\u3002 \u5de5\u5177\u7c7b <code>enumerate</code> \u5b9e\u73b0\u4e86 iterator protocol\uff0c\u53ef\u5bf9\u8fd4\u56de\u7684 enumerate \u5bf9\u8c61\u6267\u884c for \u5faa\u73af\u904d\u5386\u6216\u8c03\u7528 list() \u6784\u9020\u8f6c\u6362\u3002</p> <p>\u5de5\u5177\u51fd\u6570 <code>sorted</code> \u652f\u6301\u5bf9\u53ef\u8fed\u4ee3\u5e8f\u5217\u8fdb\u884c\uff08\u5347\u5e8f\uff09\u6392\u5e8f\uff0c\u8fd4\u56de\u6392\u5e8f\u540e\u7684 list\u3002 \u5de5\u5177\u7c7b <code>reversed</code> \u652f\u6301\u5bf9\u53ef\u8fed\u4ee3\u5e8f\u5217\u8fdb\u884c\u9006\u5e8f\uff0c\u6839\u636e\u8f93\u5165\u7684\u5e8f\u5217\u8fd4\u56de\u4e0d\u540c\u7c7b\u578b\u7684\u8fed\u4ee3\u5668\u3002 \u5de5\u5177\u7c7b <code>map</code> \u652f\u6301\u5bf9\u5e8f\u5217\u4e2d\u7684\u5143\u7d20\u505a\u6620\u5c04\u8f6c\u6362\uff0cfunc \u4e3a\u8f6c\u6362\u51fd\u6570\uff08converter\uff09\uff0c\u8fd4\u56de map \u4ee3\u8868\u8f6c\u6362\u540e\u7684\u8fed\u4ee3\u5e8f\u5217\u3002 \u5de5\u5177\u7c7b <code>filter</code> \u652f\u6301\u5bf9\u53ef\u8fed\u4ee3\u5e8f\u5217\u8fdb\u884c\u8fc7\u6ee4\uff0cfunc \u4e3a\u8c13\u8bcd\u51fd\u6570\uff08UnaryPredicate\uff09\uff0c\u7b5b\u9009\u51fa\u7b26\u5408\u8c13\u8bcd\u6761\u4ef6\u7684\u5143\u7d20\uff0c\u53ef\u8fed\u4ee3\u904d\u5386\u8fd4\u56de\u7684 filter\u3002</p>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#dechexbin","title":"DecHexBin","text":"<p>Bin, Hex, Dec Converter</p>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#print_format","title":"print format","text":"<p>\u901a\u8fc7 <code>print()</code> \u51fd\u6570\u7684\u5360\u4f4d\u7b26 <code>%o</code>\u3001<code>%x</code> \u683c\u5f0f\u5316\u8f93\u51fa\u5341\u8fdb\u5236\u6570\u5bf9\u5e94\u7684\u516b\u8fdb\u5236\u548c\u5341\u516d\u8fdb\u5236\u683c\u5f0f\uff1a</p> <pre><code>&gt;&gt;&gt; x=2017\n&gt;&gt;&gt; print('oct=%o' %(x))\noct=3741\n&gt;&gt;&gt; print('hex=%x' %(2017))\nhex=7e1\n</code></pre> <p>\u57fa\u4e8e str.format \u8bbe\u7f6e\u6253\u5370\u8fdb\u5236\u683c\u5f0f\uff1a</p> <pre><code>&gt;&gt;&gt; # format also supports binary numbers\n&gt;&gt;&gt; \"int: {0:d};  hex: {0:x};  oct: {0:o};  bin: {0:b}\".format(42)\n'int: 42;  hex: 2a;  oct: 52;  bin: 101010'\n\n&gt;&gt;&gt; # with 0x, 0o, or 0b as prefix:\n&gt;&gt;&gt; \"int: {0:d};  hex: {0:#x};  oct: {0:#o};  bin: {0:#b}\".format(42)\n'int: 42;  hex: 0x2a;  oct: 0o52;  bin: 0b101010'\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#bin_hex","title":"bin(), hex()","text":"<p>value representation\uff1a\u6253\u5370\u6574\u5f62\uff08integer\uff09\u6570\u503c\u7684\u4e8c\u8fdb\u5236\u3001\u516b\u8fdb\u5236\u3001\u5341\u516d\u8fdb\u5236\u8868\u793a\uff08\u5b57\u7b26\u4e32\uff09\uff1a</p> <p>binary/octal/hexadecimal representation\uff1a</p> <p>builtins.bin  # binary string prefixed with \u201c0b\u201d builtins.oct  # octal string prefixed with \u201c0o\u201d builtins.hex  # lowercase hexadecimal string prefixed with \u201c0x\u201d  </p> <pre><code>    bin(number, /)\n        Return the binary representation of an integer.\n\n    hex(number, /)\n        Return the hexadecimal representation of an integer.\n\n    oct(number, /)\n        Return the octal representation of an integer.\n</code></pre> <p>python \u5185\u7f6e\u7684 <code>bin()</code>\u3001<code>oct()</code>\u3001<code>hex()</code> \u51fd\u6570\u652f\u6301\u5c06\u5341\u8fdb\u5236\u6570\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u3001\u516b\u8fdb\u5236\u3001\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002</p> <pre><code>&gt;&gt;&gt; bin(5)\n'0b101'\n&gt;&gt;&gt; bin(2017)\n'0b11111100001'\n</code></pre> <p>\u5982\u679c\u60f3\u7cbe\u786e\u63a7\u5236\u6309byte\u8f93\u51fa\u4e8c\u8fdb\u5236\u4f4d\uff0c\u4e0d\u8db3\u9ad8\u4f4d\u88650\uff0c\u5219\u53ef\u5c1d\u8bd5\u4f7f\u7528 numpy.binary_repr \u652f\u6301\u6307\u5b9a width\u3002</p> <pre><code>&gt;&gt;&gt; import numpy\n&gt;&gt;&gt; numpy.binary_repr(5, width=8)\n'00000101'\n&gt;&gt;&gt; numpy.binary_repr(2017, width=16)\n'0000011111100001'\n</code></pre> <pre><code>&gt;&gt;&gt; oct(2017)\n'0o3741'\n&gt;&gt;&gt; print(hex(2017))\n0x7e1\n&gt;&gt;&gt; print(0x7e1)\n2017\n</code></pre> <p>311 \u7684\u5341\u516d\u8fdb\u5236\u5b57\u9762\u91cf\u5199\u6cd5\u4e3a 0x137\uff1a</p> <pre><code>&gt;&gt;&gt; hex(311)\n'0x137'\n&gt;&gt;&gt; 0x137\n311\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#floathex","title":"float.hex()","text":"<p>In Python float is always double-precision.</p> <p>\u6839\u636e IEEE-754 \u6d6e\u70b9\u6570\u6807\u51c6\uff0c\u5355\u7cbe\u5ea6\u6d6e\u70b9\u683c\u5f0f\uff08C\u8bed\u8a00\u4e2d\u7684float\uff09\u4e2d\uff0cs\u3001exp \u548c frac \u5b57\u6bb5\u5206\u522b\u5360\u4f4d 1\u3001k=8 \u548c n=23\u3002 \u5728\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u6570\u683c\u5f0f\uff08C\u8bed\u8a00\u4e2d\u7684double\uff09\u4e2d\uff0cs\u3001exp \u548c frac \u5b57\u6bb5\u5206\u522b\u5360\u4f4d 1\u3001k=11 \u548c n=52\u3002</p> <p>\u5177\u4f53\u53ef\u5728 Floating Point to Hex Converter \u4e2d\u67e5\u770b\u6d6e\u70b9\u6570\u7684\u4e8c\u8fdb\u5236\u4f4d\u56fe\u5e03\u5c40\u3002</p> <pre><code>&gt;&gt;&gt; help(float)\n\n |  hex(self, /)\n |      Return a hexadecimal representation of a floating-point number.\n</code></pre> <pre><code>&gt;&gt;&gt; (-0.1).hex()\n'-0x1.999999999999ap-4'\n&gt;&gt;&gt; 3.14159.hex()\n'0x1.921f9f01b866ep+1'\n\n&gt;&gt;&gt; (1.25).hex()\n'0x1.4000000000000p+0'\n&gt;&gt;&gt; float.hex(-1.25)\n'-0x1.4000000000000p+0'\n&gt;&gt;&gt; (123.456).hex()\n'0x1.edd2f1a9fbe77p+6'\n&gt;&gt;&gt; float.hex(-123.456)\n'-0x1.edd2f1a9fbe77p+6'\n</code></pre> <p>1.25 \u7684\u5341\u516d\u8fdb\u5236\u8868\u793a\u4e3a '0x1.4000000000000p+0'\u3002</p> <p>p+\u540e\u9762\u76840\u4e3a\u9636\u7801\u503c\uff08E=e-Bias\uff09\uff0c\u5373 E=0\u3002 0x1.4000000000000 = 1+0x4000000000000 = (1+4/0x10)(2*0) = 1.25</p> <p>\u5c0f\u6570\u90e8\u5206\uff08frac\uff09\u7684\u4e8c\u8fdb\u5236\u63a8\u5bfc\uff1a</p> <p>bin(0x4000000000000)='0b100000000000000000000000000000000000000000000000000' \u4e8c\u8fdb\u5236\u9ad8\u4f4d\u8865\u96f6\u51d1\u621052\u4f4d\uff0c\u5219\u5c0f\u6570\u4f4df=0b0100000000000000000000000000000000000000000000000000/(2**52)=0.25 \u89c4\u683c\u5316\u60c5\u51b5\uff0c\u5c3e\u6570\u5b9a\u4e49\u4e3aM=1+f=1.25\uff0cV=<code>M*(2**E)</code>=<code>(1+0.25)*(2**0)</code>=1.25</p> <p>\u53c2\u8003\uff1a</p> <ul> <li>How to convert a float into hex </li> <li>Convert float to hex in Python</li> <li>Python\u7684 Convert Hex to Float value </li> <li>Python\u4e2dhex\u4e0efloat\u4e92\u8f6c </li> </ul> <p>\u5728\u7ebf\u8f6c\u6362\u6f14\u4f4d\u56fe\u793a\uff1a</p> <ul> <li>Floating Point to Hex Converter</li> <li>IEEE-754 Floating Point Converter</li> </ul>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#bit_length","title":"bit_length","text":"<p>int \u6a21\u5757\uff0c\u8fd8\u63d0\u4f9b\u4e86 <code>bit_length</code> \u53ef\u83b7\u53d6\u67d0\u4e2a\u6574\u6570\u7684\u4e8c\u8fdb\u5236\u4f4d\u6570\uff1a</p> <pre><code>class int(object)\n\n |  bit_length(self, /)\n |      Number of bits necessary to represent self in binary.\n</code></pre> <pre><code>&gt;&gt;&gt; bin(37)\n'0b100101'\n&gt;&gt;&gt; (37).bit_length()\n6\n</code></pre> <p>53191\u7684\u5341\u516d\u8fdb\u5236\u662f0xcfc7\uff0c\u5360\u75282Byte\u7684unsigned short\u7c7b\u578b\u5373\u53ef\u5b58\u50a8\u3002</p> <pre><code>&gt;&gt;&gt; hex(53191)\n'0xcfc7'\n&gt;&gt;&gt; (53191).bit_length()\n16\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#bitwise_operations","title":"Bitwise Operations","text":"<p>Bitwise Operations on Integer Types</p>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#math","title":"math","text":"<p>builtins.min builtins.max  </p> <p>builtins.abs # math.fabs builtins.sum # math.fsum  </p> <p>builtins.round # \u56db\u820d\u4e94\u5165\u4fdd\u7559\u6307\u5b9a\u6d6e\u70b9\u6570  </p>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#sum","title":"sum","text":"<p>builtins.sum \u7684\u5e2e\u52a9\u8bf4\u660e\uff1a\u652f\u6301\u5bf9\u6570\u503c\u5e8f\u5217\u8fdb\u884c\u8fed\u4ee3\u6c42\u548c\u3002</p> <pre><code>&gt;&gt;&gt; help(sum)\n\nhelp on built-in function sum in module builtins:\n\nsum(iterable, /, start=0)\n    Return the sum of a 'start' value (default: 0) plus an iterable of numbers\n\n    When the iterable is empty, return the start value.\n    This function is intended specifically for use with numeric values and may\n    reject non-numeric types.\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u7ed9 sum \u4f20\u5165 range,tuple,list,set \u6570\u503c\u5e8f\u5217\u8fdb\u884c\u6c42\u548c\u3002</p> <pre><code>&gt;&gt;&gt; sum(range(1,10,2))\n25\n&gt;&gt;&gt; sum((1,3,5,7,9))\n25\n&gt;&gt;&gt; sum([1,3,5,7,9])\n25\n&gt;&gt;&gt; sum({1,3,5,7,9})\n25\n</code></pre> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u8c03\u7528 math.fsum \u5bf9\u6d6e\u70b9\u6570\u503c\u5e8f\u5217\u7684\u8fdb\u884c\u53e0\u52a0\u6c42\u548c\u3002</p>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#floor__ceil","title":"floor &amp; ceil","text":"<p>math.floor\uff1a\u5411\u4e0b\u53d6\u6574 math.ceil\uff1a\u5411\u4e0a\u53d6\u6574  </p> <pre><code>&gt;&gt;&gt; length = 4788224\n&gt;&gt;&gt; math.log(length, 1024)\n2.2191059214531657\n&gt;&gt;&gt; math.floor(math.log(length, 1024))\n2\n&gt;&gt;&gt; math.ceil(math.log(length, 1024))\n3\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#divmod","title":"divmod","text":"<p>builtins.divmod  </p> <p>Take two (non complex) numbers as arguments and return a pair of numbers consisting of their quotient and remainder when using integer division.</p> <p>divmod(a, b) \u7b49\u6548\u4e8e <code>(a // b, a % b)</code>\uff0c\u8ba1\u7b97\u5546\uff08quotient\uff09\u548c\u4f59\u6570\uff08remainder\uff09\u3002</p> <p><code>math.fmod(x, y, /)</code>\uff1a\u6c42\u4f59\uff0c\u57fa\u672c\u7b49\u6548\u4e8e x % y = divmod(x,y)[1]\u3002  </p> <p><code>math.modf(x, /)</code>: Return the fractional and integer parts of x\uff0c\u53d6\u6d6e\u70b9\u6570\u7684\u6574\u6570\u548c\u5c0f\u6570\u90e8\u5206\u3002  </p> <p>math.modf(math.pi) = (0.14159265358979312, 3.0) math.modf(-math.pi) = (-0.14159265358979312, -3.0)  </p> <p>\u5176\u4ed6\uff1amath.remainder</p>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#pow__log","title":"pow &amp; log","text":"<p>builtins.pow # math.pow\uff1a\u5e42\u8fd0\u7b97  </p> <p><code>math.sqrt</code>\uff1aReturn the square root of x.  </p> <p><code>math.log(x, [base=math.e])</code>\uff1aReturn the logarithm of x to the given base. <code>math.log10</code> = math.log(x, 10), 10^y=x <code>math.log2</code>  = math.log(x, 2), 2^y=x  </p>","tags":["builtins"]},{"location":"blog/20191204/11-builtins.utilities/#demo","title":"demo","text":"<p>Better way to convert file sizes in Python</p> <p>https://pypi.org/project/hurry.filesize/</p> <pre><code>import math\n\ndef convert_size(size_bytes):\n   if size_bytes == 0:\n       return \"0B\"\n   size_name = (\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\")\n   i = math.floor(math.log(size_bytes, 1024))\n   p = pow(1024, i)\n   s = round(size_bytes / p, 2)\n   return \"%s %s\" % (s, size_name[i])\n</code></pre> <p>math.log(size_bytes, 1024))\uff1a\u8ba1\u7b97\u771f\u6570 size_bytes \u4ee5 1024 \u4e3a\u5e95\u7684\u5bf9\u6570\u3002math.floor \u5411\u4e0b\u53d6\u6307\u6570\u7684\u6574\u6570\u90e8\u5206\u3002</p> <p>\u5982\u679c\u6307\u6570\u662f2\uff0c\u5219\u5bf9\u5e94\u6570\u91cf\u5355\u4f4d\u4e3a p=pow(1024, 2)=1048576\uff0c\u8868\u793a\u5355\u4f4d\u4e3a MB\u3002</p> <p>\u5c06 size_bytes \u9664\u4ee5 1048576 \u5f97\u5230 MB \u8ba1\u91cf\u6570\u91cf\uff0c\u7136\u540e round \u56db\u820d\u4e94\u5165\u53d6\u6574\uff0c\u6700\u540e\u683c\u5f0f\u5316\u6253\u5370\u51fa <code>mm.nn MB</code>\u3002</p> <p>\u6d4b\u8bd5\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; length = 4788224\n&gt;&gt;&gt; convert_size(length)\n'4.57 MB'\n</code></pre>","tags":["builtins"]},{"location":"blog/20191204/2-builtins.print/","title":"python\u5185\u7f6e\u51fd\u6570\u4e4bprint","text":"<p>Python\u5185\u7f6e\u51fd\u6570 builtins.print \u57fa\u672c\u7528\u6cd5\u3002</p> <ul> <li>builtins.repr  </li> <li>builtins.print  </li> </ul> <p>\u5728 Python 2 \u4e2d\uff0cprint \u4e3a\u5173\u952e\u5b57\uff1b\u5728 Python 3 \u4e2d\uff0cprint \u4e3a\u5185\u7f6e\u51fd\u6570\uff08builtins.print\uff09\u3002</p> <p>builtins \u7684 print() \u51fd\u6570\uff1a</p> <pre><code>    print(...)\n        print(value, ..., sep=' ', end='\\n', file=sys.stdout, flush=False)\n</code></pre> <p>\u5728 Python 3 \u4e2d\u53ef\u6267\u884c <code>help(print)</code> \u67e5\u770b print \u51fd\u6570\u8bf4\u660e\uff1a</p> <pre><code>&gt;&gt;&gt; help(print)\n\nHelp on built-in function print in module builtins:\n\nprint(...)\n    print(value, ..., sep=' ', end='\\n', file=sys.stdout, flush=False)\n\n    Prints the values to a stream, or to sys.stdout by default.\n    Optional keyword arguments:\n    file:  a file-like object (stream); defaults to the current sys.stdout.\n    sep:   string inserted between values, default a space.\n    end:   string appended after the last value, default a newline.\n    flush: whether to forcibly flush the stream.\n</code></pre> <p>Python3 \u5df2\u7ecf\u4e0d\u652f\u6301 print \u7684\u975e\u51fd\u6570\u683c\u5f0f\u4e86\uff0c\u5fc5\u987b\u4f7f\u7528 <code>print()</code> \u51fd\u6570\u8c03\u7528\u683c\u5f0f\u3002</p> <pre><code>&gt;&gt;&gt; print 'hello,world!'\n  File \"&lt;stdin&gt;\", line 1\n    print 'hello,world!'\n                       ^\nSyntaxError: Missing parentheses in call to 'print'. Did you mean print('hello,world!')?\n</code></pre> <p>Python print\u51fd\u6570\u7528\u6cd5 python\u683c\u5f0f\u5316\u8f93\u51fa python2\u4e0epython3\u7684print </p> <p>\u5bf9\u5f88\u591a\u5e94\u7528\u7a0b\u5e8f\u6765\u8bf4\uff0c\u4f7f\u7528\u6a21\u5757 logging \u6765\u5199\u5165\u65e5\u5fd7\u6bd4\u4f7f\u7528 print \u66f4\u5408\u9002\u3002</p> <p>\u76f8\u5173\u6a21\u5757\u53c2\u8003\uff1asyslog, logging\u3002</p>","tags":["print"]},{"location":"blog/20191204/2-builtins.print/#sep__end","title":"sep &amp; end","text":"","tags":["print"]},{"location":"blog/20191204/2-builtins.print/#sep","title":"sep","text":"<p>print \u4e00\u884c\u6253\u5370\u591a\u4e2a\u53d8\u91cf\uff08\u9017\u53f7\u5206\u9694\uff09\uff0c\u9ed8\u8ba4\u4f1a\u4ee5\u7a7a\u683c\uff08<code>sep=' '</code>\uff09\u5206\u9694\uff1a</p> <pre><code>&gt;&gt;&gt; year=2019\n&gt;&gt;&gt; month=10\n&gt;&gt;&gt; day=1\n&gt;&gt;&gt; print(year,month,day)\n2019 10 1\n</code></pre> <p>\u53ef\u4ee5\u6307\u5b9a sep \u53c2\u6570\uff0c\u5b9a\u5236\u884c\u5185\u5206\u9694\uff08\u8fde\u63a5\uff09\u7b26\uff1a</p> <pre><code>&gt;&gt;&gt; print(year,month,day,sep='')\n2019101\n&gt;&gt;&gt; print(year,month,day,sep='-')\n2019-10-1\n</code></pre> <p>\u53e6\u5916\u4e00\u4e2a\u4f8b\u5b50\uff1aprint \u6253\u5370\u65e5\u5fd7\u8d77\u59cb\u884c tuple\uff0c\u4e24\u884c\u4e4b\u95f4\u63d2\u4e86\u4e00\u4e2a\u7a7a\u683c\uff1a</p> <pre><code>mbr_start_line = '2019-09-22 21:41:59.416 Debug|1031|137920|:96|IMPDT_MBR_Engine||start: role = 1\\n'\nmbr_stop_line = '2019-09-22 21:43:59.947 Debug|1031|672495|:125|IMPDT_MBR_Engine||stop: reset role from 1\\n'\nprint(mbr_start_line, mbr_stop_line)\n</code></pre> <pre><code>2019-09-22 21:41:59.416 Debug|1031|137920|:96|IMPDT_MBR_Engine||start: role = 1\n 2019-09-22 21:43:59.947 Debug|1031|672495|:125|IMPDT_MBR_Engine||stop: reset role from 1\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u6307\u5b9a sep \u53bb\u6389\u7a7a\u683c\uff1a<code>print(mbr_start_line, mbr_stop_line,sep='')</code></p>","tags":["print"]},{"location":"blog/20191204/2-builtins.print/#end","title":"end","text":"<pre><code>mbr_start_line = '2019-09-22 21:41:59.416 Debug|1031|137920|:96|IMPDT_MBR_Engine||start: role = 1\\n'\nmbr_stop_line = '2019-09-22 21:43:59.947 Debug|1031|672495|:125|IMPDT_MBR_Engine||stop: reset role from 1\\n'\n#print(mbr_start_line),print(mbr_stop_line)\nmbr_border_lines = (mbr_start_line, mbr_stop_line) # make tuple\nfor line in mbr_border_lines:\n    print(line,end='') #print(line)\n</code></pre> <p>\u6253\u5370\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>2019-09-22 21:41:59.416 Debug|1031|137920|:96|IMPDT_MBR_Engine||start: role = 1\n\n2019-09-22 21:43:59.947 Debug|1031|672495|:125|IMPDT_MBR_Engine||stop: reset role from 1\n</code></pre> <p>\u7531\u4e8e\u6309\u6587\u672c\u8bfb\u51fa\u7684\u884c\u672b\u5c3e\u672c\u8eab\u5c31\u6709\u6362\u884c\u7b26\uff0c\u56e0\u6b64\u5728\u8fde\u7eed\u6253\u5370\u591a\u884c\u65e5\u5fd7\u65f6\uff0c\u53ef\u8003\u8651\u5c06 print \u5728\u5c3e\u90e8\u8ffd\u52a0\u7684\u6362\u884c\u7b26\u7f6e\u7a7a\uff0c\u6216\u5b9a\u5236\u5176\u4ed6\u884c\u95f4\u5206\u9694\u7b26\u3002</p> <p>\u5c06 <code>print(line)</code> \u4fee\u6539\u4e3a <code>print(line, end='')</code> \u5373\u53ef\u3002</p>","tags":["print"]},{"location":"blog/20191204/2-builtins.print/#expr","title":"expr","text":"<p><code>print(var)</code> \u6216 <code>print(expr)</code> \u6253\u5370\u53d8\u91cf\u6216\u8868\u8fbe\u5f0f\u7684\u503c\u3002</p> <pre><code>&gt;&gt;&gt; start=1\n&gt;&gt;&gt; stop=10\n&gt;&gt;&gt; step=2\n\n&gt;&gt;&gt; print(start)\n1\n\n&gt;&gt;&gt; print(start+step)\n3\n\n&gt;&gt;&gt; r=range(1,10,2)\n# python2\n&gt;&gt;&gt; print(r)\n[1, 3, 5, 7, 9]\n# python3\n&gt;&gt;&gt; print(r)\nrange(1, 10, 2)\n\n&gt;&gt;&gt; l1=[1,2,3,4]\n&gt;&gt;&gt; print(l1)\n[1, 2, 3, 4]\n</code></pre>","tags":["print"]},{"location":"blog/20191204/2-builtins.print/#repr","title":"repr","text":"<p><code>print(object)</code> \u8f93\u51fa\u7c7b\u578b\u6216\u63cf\u8ff0\u4fe1\u606f\u3002</p> <pre><code>#######################################\n# \u6253\u5370\u6a21\u5757\u4fe1\u606f\n#######################################\n# python3\n&gt;&gt;&gt; print(builtins)\n&lt;module 'builtins' (built-in)&gt;\n\n&gt;&gt;&gt; print(array)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nNameError: name 'array' is not defined\n&gt;&gt;&gt; import array\n\n# python2\n&gt;&gt;&gt; print(array)\n&lt;module 'array' from '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload/array.so'&gt;\n\n# python3\n&gt;&gt;&gt; print(array)\n&lt;module 'array' from '/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/lib-dynload/array.cpython-36m-darwin.so'&gt;\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u8c03\u7528 <code>repr(obj)</code> \u53ef\u4ee5\u83b7\u53d6\u8be5 obj \u5bf9\u8c61\u5b9e\u4f8b\u7684\u63cf\u8ff0\u4fe1\u606f\u3002</p> <p>repr \u5b9e\u9645\u4e0a\u8c03\u7528\u7684\u662f obj \u7684 <code>__repr__</code> \u65b9\u6cd5\uff1a<code>repr(obj) = obj.__repr__()</code></p> <pre><code>&gt;&gt;&gt; help(repr)\n\nHelp on built-in function repr in module builtins:\n\nrepr(obj, /)\n    Return the canonical string representation of the object.\n\n    For many object types, including most builtins, eval(repr(obj)) == obj.\n</code></pre> <p>\u90e8\u5206\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>#######################################\n# \u6253\u5370\u6a21\u5757\u7c7b\u578b\u4fe1\u606f\n#######################################\n\n&gt;&gt;&gt; print(list)\n&lt;class 'list'&gt;\n\n&gt;&gt;&gt; repr(list)\n\"&lt;class 'list'&gt;\"\n\n&gt;&gt;&gt; print(len)\n&lt;built-in function len&gt;\n\n&gt;&gt;&gt; repr(len)\n'&lt;built-in function len&gt;'\n\n&gt;&gt;&gt; print(hex)\n&lt;built-in function hex&gt;\n\n&gt;&gt;&gt; repr(hex)\n'&lt;built-in function hex&gt;'\n\n#######################################\n# \u6253\u5370\u5bf9\u8c61\u5b9e\u4f8b\u63cf\u8ff0\uff08__repr__\uff09\n#######################################\n\n&gt;&gt;&gt; print(sys.version_info)\nsys.version_info(major=3, minor=6, micro=5, releaselevel='final', serial=0)\n\n&gt;&gt;&gt; repr(sys.version_info)\n\"sys.version_info(major=3, minor=9, micro=13, releaselevel='final', serial=0)\"\n\n&gt;&gt;&gt; print(sys.thread_info)\nsys.thread_info(name='pthread', lock='mutex+cond', version=None)\n\n&gt;&gt;&gt; repr(sys.thread_info)\n\"sys.thread_info(name='pthread', lock='mutex+cond', version=None)\"\n</code></pre>","tags":["print"]},{"location":"blog/20191204/2-builtins.print/#list_vars","title":"list vars","text":"<p>\u9017\u53f7\u540e\u76f4\u63a5\u63a5\u53d8\u91cf\uff0cPython 2 \u4e0b\u8f93\u51fa tuple\uff1bPython 3 \u5c06\u81ea\u52a8\u62fc\u63a5\u524d\u534a\u53e5\u5b57\u9762\u91cf\u548c\u540e\u9762\u7684\u53d8\u91cf\uff0c\u4ee5\u7a7a\u683c\uff08space-separated with <code>sep=' '</code>\uff09\u9694\u5f00\u3002</p> <pre><code>&gt;&gt;&gt; start=0\n&gt;&gt;&gt; stop=30\n&gt;&gt;&gt; step=5\n\n# python2 \u4e0b\u7684\u8f93\u51fa tuple\n&gt;&gt;&gt; print('start is', start)\n('start is', 0)\n&gt;&gt;&gt; print('start, stop is', start, stop)\n('start, stop is', 0, 30)\n\n# python3 \u4e0b\u7684\u8f93\u51fa\n&gt;&gt;&gt; print('start is', start)\nstart is 0\n&gt;&gt;&gt; print('start, stop is', start, stop)\nstart, stop is 0 30\n</code></pre> <p>\u53d8\u91cf\u4e5f\u53ef\u7a7f\u63d2\u5728\u4e2d\u95f4\uff1a</p> <pre><code>&gt;&gt;&gt; name = \"John\"\n&gt;&gt;&gt; score = 85\n&gt;&gt;&gt; print(\"Total score for\", name, \"is\", score)\nTotal score for John is 85\n</code></pre>","tags":["print"]},{"location":"blog/20191204/2-builtins.print/#format","title":"format","text":"<p>\u53ef\u53c2\u8003 builtins.format \u548c str.format \u51fd\u6570\uff0c\u8f93\u5165 <code>help('FORMATTING')</code> \u53ef\u67e5\u770b\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u76f8\u5173\u8bae\u9898\u3002</p> <ul> <li>\u53c2\u8003 builtins.str.format\u3001builtins.str\u3002</li> </ul>","tags":["print"]},{"location":"blog/20191204/2-builtins.print/#printf-style","title":"printf-style","text":"<p>printf-style String Formatting</p> <p>C printf \u98ce\u683c\uff0c\u4f7f\u7528 <code>%</code> \u683c\u5f0f\u7b26\u6807\u8bc6\u5360\u4f4d\uff0c</p> <pre><code># start \u53ef\u52a0\u62ec\u53f7\n&gt;&gt;&gt; print('start is %d' % start)\nstart is 0\n\n&gt;&gt;&gt; print('start,stop is %d, %d' % (start, stop))\nstart,stop is 0, 30\n</code></pre> <p>\u4ee5\u4e0b\u91c7\u7528 C-printf-style\uff0c\u63a7\u5236\u5b57\u7b26\u4e32\u622a\u65ad\u8f93\u51fa\uff1a</p> <pre><code>&gt;&gt;&gt; 'i love %s' % 'python'\n'i love python'\n&gt;&gt;&gt; 'i love %.2s' % 'python'\n'i love py'\n\n# \u622a\u53d6\u4e24\u4f4d\uff0c\u603b\u5171\u4e09\u4f4d\uff0c\u9ed8\u8ba4\u53f3\u5bf9\u9f50\n&gt;&gt;&gt; 'i love %3.2s' % 'python'\n'i love  py'\n\n# \u622a\u53d6\u4e24\u4f4d\uff0c\u603b\u5171\u5341\u4f4d\uff0c\u9ed8\u8ba4\u53f3\u5bf9\u9f50\n&gt;&gt;&gt; 'i love %10.2s' % 'python'\n'i love         py'\n\n# \u622a\u53d6\u4e24\u4f4d\uff0c\u603b\u5171\u5341\u4f4d\uff0c\u8bbe\u7f6e\u5de6\u5bf9\u9f50\n&gt;&gt;&gt; 'i love %-10.2s' % 'python'\n'i love py        '\n\n# \u622a\u53d6\u4e24\u4f4d\uff0c\u603b\u5171\u5341\u4f4d\uff0c\u8bbe\u7f6e\u5de6\u5bf9\u9f50\n&gt;&gt;&gt; 'i love %-10.2s !' % 'python'\n'i love py         !'\n</code></pre>","tags":["print"]},{"location":"blog/20191204/2-builtins.print/#format_specifier","title":"format specifier","text":"<p>\u5728\u5360\u4f4d\u5e8f\u53f7\u6216\u5173\u952e\u5b57\u4e4b\u540e\u53ef\u4ee5 <code>:</code> \u6765\u8bbe\u7f6e\u586b\u5145\uff08fill\uff09\u3001\u5bf9\u9f50\uff08align\uff09\u3001\u4f4d\u5bbd\uff08width\uff09\u3001\u8fdb\u5236\uff08base\uff09\u7b49\u683c\u5f0f\u63a7\u5236\u3002</p> <p>An optional '<code>:</code>' and format specifier can follow the field name. This allows greater control over how the value is formatted.</p> <ol> <li>\u8bbe\u7f6e\u6253\u5370\u8fdb\u5236\u683c\u5f0f(str.format)</li> </ol> <pre><code>&gt;&gt;&gt; # format also supports binary numbers\n&gt;&gt;&gt; \"int: {0:d};  hex: {0:x};  oct: {0:o};  bin: {0:b}\".format(42)\n'int: 42;  hex: 2a;  oct: 52;  bin: 101010'\n\n&gt;&gt;&gt; # with 0x, 0o, or 0b as prefix:\n&gt;&gt;&gt; \"int: {0:d};  hex: {0:#x};  oct: {0:#o};  bin: {0:#b}\".format(42)\n'int: 42;  hex: 0x2a;  oct: 0o52;  bin: 0b101010'\n</code></pre> <ol> <li>\u8bbe\u7f6e\u6d6e\u70b9\u6570\u4f4d\u6570(str.format)</li> </ol> <pre><code>&gt;&gt;&gt; import math\n&gt;&gt;&gt; print('The value of PI is approximately {0:.3f}.'.format(math.pi))\nThe value of PI is approximately 3.142.\n\n&gt;&gt;&gt; '{0:6.2f}'.format(math.pi)\n'  3.14'\n&gt;&gt;&gt; '{0:&gt;6.2f}'.format(math.pi)\n'  3.14'\n&gt;&gt;&gt; '{0:&lt;6.2f}'.format(math.pi)\n'3.14  '\n</code></pre> <ol> <li> <p>\u8bbe\u7f6e\u8f93\u51fa\u5bbd\u5ea6\u53ca\u586b\u5145\u683c\u5f0f(str.format)</p> <p>Aligning the text and specifying a width</p> </li> </ol> <pre><code># default align left, fill right with spaces\n&gt;&gt;&gt; '{:30}'.format('left aligned')\n'left aligned                  '\n&gt;&gt;&gt; '{:&lt;30}'.format('left aligned')\n'left aligned                  '\n&gt;&gt;&gt; '{:&gt;30}'.format('right aligned')\n'                 right aligned'\n&gt;&gt;&gt; '{:^30}'.format('centered')\n'           centered           '\n&gt;&gt;&gt; '{:*^30}'.format('centered')  # use '*' as a fill char\n'***********centered***********'\n&gt;&gt;&gt; '{:-^30}'.format('centered')  # use '-' as a fill char\n'-----------centered-----------'\n</code></pre> <p>Passing an integer after the '<code>:</code>' will cause that field to be a minimum number of characters wide. This is useful for making tables pretty.</p> <pre><code># position:{width}{base}\n&gt;&gt;&gt; table = {'Sjoerd': 4127, 'Jack': 4098, 'Dcab': 7678}\n&gt;&gt;&gt; for name, phone in table.items():\n...     print('{0:10} ==&gt; {1:10d}'.format(name, phone))\n... \nSjoerd     ==&gt;       4127\nJack       ==&gt;       4098\nDcab       ==&gt;       7678\n</code></pre> <ol> <li>\u9017\u53f7\u5343\u4f4d\u5206\u9694\uff08Using the comma as a thousands separator\uff09</li> </ol> <pre><code># \u5bf9\u6574\u6570\u8fdb\u884c\u5343\u4f4d\u5206\u9694\n&gt;&gt;&gt; str1 = '{:,}'.format(1234567890)\n&gt;&gt;&gt; str1\n'1,234,567,890'\n\n# \u53bb\u6389\u5343\u4f4d\u5206\u9694\u7b26\n&gt;&gt;&gt; int(str1.replace(',', ''))\n1234567890\n</code></pre> <ol> <li>\u8f93\u51fa\u767e\u5206\u6570(str.format)</li> </ol> <pre><code>&gt;&gt;&gt; points = 19\n&gt;&gt;&gt; total = 22\n&gt;&gt;&gt; 'Correct rate of answers: {:.2%}'.format(points/total)\n'Correct rate of answers: 86.36%'\n</code></pre>","tags":["print"]},{"location":"blog/20191204/3-builtins.str/","title":"python\u5185\u7f6e\u6a21\u5757\u4e4b\u5b57\u7b26\u4e32(str)","text":"<p>Python\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u5b57\u7b26\u4e32\uff08builtins.str\uff09\u57fa\u672c\u7528\u6cd5\u3002</p>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#text_sequence_type__str","title":"Text Sequence Type \u2014 str","text":"<p>str str tutorial </p> <p>\u5b57\u7b26\u4e32\u7c7b str \u662f python \u6700\u5e38\u7528\u7684\u7c7b\uff0c\u7528\u6765\u5904\u7406\u5b57\u7b26\u5e8f\u5217\u548c\u6587\u672c\u6570\u636e\u3002</p>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#help","title":"help","text":"<pre><code>&gt;&gt;&gt; help(str)\n\nHelp on class str in module builtins:\n\nclass str(object)\n |  str(object='') -&gt; str\n |  str(bytes_or_buffer[, encoding[, errors]]) -&gt; str\n |\n |  Create a new string object from the given object. If encoding or\n |  errors is specified, then the object must expose a data buffer\n |  that will be decoded using the given encoding and error handler.\n |  Otherwise, returns the result of object.__str__() (if defined)\n |  or repr(object).\n |  encoding defaults to sys.getdefaultencoding().\n |  errors defaults to 'strict'.\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#empty_string","title":"empty string","text":"<ol> <li><code>s=str()</code>: \u6784\u9020\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\u5bf9\u8c61\u3002  </li> <li><code>s=''</code>\uff1a\u5b9a\u4e49\u7a7a\u5b57\u7b26\u4e32\u5b57\u9762\u91cf\u3002  </li> </ol>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#literals","title":"Literals","text":"<p>\u53c2\u8003 reference - 2.4. Literals - String and Bytes literals\u3002</p> <p>One syntactic restriction not indicated by these productions is that whitespace is not allowed between the <code>stringprefix</code> or <code>bytesprefix</code> and the rest of the literal.</p> <p>String literals are described by the following lexical definitions:</p> <pre><code>stringliteral   ::=  [stringprefix](shortstring | longstring)\nstringprefix    ::=  \"r\" | \"u\" | \"R\" | \"U\" | \"f\" | \"F\"\n                     | \"fr\" | \"Fr\" | \"fR\" | \"FR\" | \"rf\" | \"rF\" | \"Rf\" | \"RF\"\n</code></pre> <p>Bytes literals are described by the following lexical definitions:</p> <pre><code>bytesliteral   ::=  bytesprefix(shortbytes | longbytes)\nbytesprefix    ::=  \"b\" | \"B\" | \"br\" | \"Br\" | \"bR\" | \"BR\" | \"rb\" | \"rB\" | \"Rb\" | \"RB\"\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#\u539f\u59cb\u5b57\u7b26\u4e32","title":"\u539f\u59cb\u5b57\u7b26\u4e32","text":"<p>Both string and bytes literals may optionally be prefixed with a letter <code>'r'</code> or <code>'R'</code>; such strings are called raw strings and treat backslashes as literal characters. As a result, in string literals, <code>'\\U'</code> and <code>'\\u'</code> escapes in raw strings are not treated specially.</p> <p>\u7528\u524d\u7f00r\u8868\u793a\u539f\u59cb\u5b57\u7b26\u4e32\u3002\u539f\u59cb\u5b57\u7b26\u4e32\u4e0d\u4f1a\u5bf9\u53cd\u659c\u6760\u505a\u7279\u6b8a\u5904\u7406\uff0c\u800c\u662f\u8ba9\u5b57\u7b26\u4e32\u5305\u542b\u7684\u6bcf\u4e2a\u5b57\u7b26\u90fd\u4fdd\u6301\u539f\u6837\u3002</p> <pre><code>&gt;&gt;&gt; print(r'C:\\nowhere')\nC:\\nowhere\n</code></pre> <p>\u4e00\u4e2a\u4f8b\u5916\u662f\uff0c\u5f15\u53f7\u9700\u8981\u50cf\u901a\u5e38\u90a3\u6837\u8fdb\u884c\u8f6c\u4e49\uff0c\u4f46\u8fd9\u610f\u5473\u7740\u7528\u4e8e\u6267\u884c\u8f6c\u4e49\u7684\u53cd\u659c\u6760\u4e5f\u5c06\u5305\u542b\u5728\u6700\u7ec8\u7684\u5b57\u7b26\u4e32\u4e2d\u3002</p> <pre><code>&gt;&gt;&gt; print(r'Let\\'s go!')\nLet\\'s go!\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#\u4e09\u79cd\u5f15\u53f7\u5b9a\u4e49","title":"\u4e09\u79cd\u5f15\u53f7\u5b9a\u4e49","text":"<p>\u5b57\u7b26\u4e32\u6709\u4e09\u79cd\u5b9a\u4e49\u65b9\u5f0f\uff1a</p> <ul> <li>Single quotes: <code>'allows embedded \"double\" quotes'</code> </li> <li>Double quotes: <code>\"allows embedded 'single' quotes\"</code> </li> <li>Triple quoted: <code>'''Three single quotes''', \"\"\"Three double quotes\"\"\"</code> </li> </ul> <p>Triple quoted strings may span multiple lines - all associated whitespace will be included in the string literal.</p> <p>\u5176\u4e2d\u5355\u5f15\u53f7\u5b9a\u4e49\u7684\u5b57\u7b26\u4e32\u4e2d\u53ef\u643a\u5e26\u53cc\u5f15\u53f7\uff1b\u53cc\u5f15\u53f7\u5b9a\u4e49\u7684\u5b57\u7b26\u4e32\u4e2d\u53ef\u643a\u5e26\u5355\u5f15\u53f7\u3002 \u82e5\u60f3\u4ee5\u8de8\u884c\u6a21\u5f0f\u5b9a\u4e49\u957f\u5b57\u7b26\u4e32\uff0c\u5219\u53ef\u8003\u8651\u4f7f\u7528\u4e09\u5f15\u53f7\uff0c\u652f\u6301\u6362\u884c\u4e66\u5199\u3002  </p>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#\u5355\u5f15\u53f7","title":"\u5355\u5f15\u53f7","text":"<p>\u5355\u5f15\u53f7\u5b9a\u4e49\u7684\u5b57\u7b26\u4e32\u4e2d\u53ef\u5305\u542b\u53cc\u5f15\u53f7\uff1a</p> <pre><code>&gt;&gt;&gt; 'allows embedded \"double\" quotes'\n'allows embedded \"double\" quotes'\n\n&gt;&gt;&gt; '\"Hello, world!\" she said'\n'\"Hello, world!\" she said'\n</code></pre> <p>\u5355\u5f15\u53f7\u5b9a\u4e49\u7684\u5b57\u7b26\u4e32\u4e2d\u4e0d\u80fd\u5305\u542b\u6487\u53f7\uff0c\u5426\u5219\u89e3\u91ca\u5668\u62a5\u9519\uff1a</p> <pre><code>&gt;&gt;&gt; 'Let's go!'\n  File \"&lt;stdin&gt;\", line 1\n    'Let's go!'\n         ^\nSyntaxError: invalid syntax\n</code></pre> <p>\u5728\u8fd9\u91cc\uff0c\u5b57\u7b26\u4e32\u4e3a 'Let'\uff0c\u56e0\u6b64 Python \u4e0d\u77e5\u9053\u5982\u4f55\u5904\u7406 s \u540e\u9762\u7684\u5185\u5bb9\u3002</p> <p>\u53ef\u4f7f\u7528\u53cd\u659c\u6760\uff08\\\uff09\u5bf9\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49\uff0c\u793a\u610f\u4e2d\u95f4\u7684\u5f15\u53f7\u662f\u5b57\u7b26\u4e32\u7684\u4e00\u90e8\u5206\uff0c\u800c\u975e\u5b57\u7b26\u4e32\u7ed3\u675f\u6807\u5fd7\u3002</p> <pre><code>&gt;&gt;&gt; 'Let\\'s go!'\n\"Let's go!\"\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#\u53cc\u5f15\u53f7","title":"\u53cc\u5f15\u53f7","text":"<p>\u53cc\u5f15\u53f7\u5b9a\u4e49\u7684\u5b57\u7b26\u4e32\u4e2d\u53ef\u5305\u542b\u5355\u5f15\u53f7\uff1a</p> <pre><code>&gt;&gt;&gt; \"allows embedded 'single' quotes\"\n\"allows embedded 'single' quotes\"\n\n&gt;&gt;&gt; \"Let's go!\"\n\"Let's go!\"\n</code></pre> <p>\u53cc\u5f15\u53f7\u5b9a\u4e49\u7684\u5b57\u7b26\u4e32\u4e2d\u4e0d\u80fd\u5305\u542b\u53cc\u5f15\u53f7\uff0c\u5426\u5219\u89e3\u91ca\u5668\u62a5\u9519\uff1a</p> <pre><code>&gt;&gt;&gt; \"\"Hello, world!\" she said\"\n  File \"&lt;stdin&gt;\", line 1\n    \"\"Hello, world!\" she said\"\n          ^\nSyntaxError: invalid syntax\n</code></pre> <p>\u6b64\u65f6\uff0c\u4f7f\u7528\u53cd\u659c\u6760\uff08\\\uff09\u5bf9\u5b57\u7b26\u4e32\u4e2d\u7684\u53cc\u5f15\u53f7\u8fdb\u884c\u8f6c\u4e49\uff0c\u793a\u610f\u4e2d\u95f4\u7684\u53cc\u5f15\u53f7\u4e3a\u539f\u4e49\u3002</p> <pre><code>&gt;&gt;&gt; \"\\\"Hello, world!\\\" she said\"\n'\"Hello, world!\" she said'\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#\u4e09\u5f15\u53f7","title":"\u4e09\u5f15\u53f7","text":"<p>\u53ef\u4f7f\u7528\u4e09\u5f15\u53f7\uff08\u4e09\u4e2a\u5355\u5f15\u53f7\u6216\u4e09\u4e2a\u53cc\u5f15\u53f7\uff09\u6765\u8868\u793a\u5f88\u957f\u7684\u5b57\u7b26\u4e32\uff1a</p> <pre><code>&gt;&gt;&gt; '''Three single quotes''', \"\"\"Three double quotes\"\"\"\n('Three single quotes', 'Three double quotes')\n</code></pre> <p>\u4e09\u5f15\u53f7\u4e2d\u53ef\u5305\u542b\u5355\u5f15\u53f7\u548c\u53cc\u5f15\u53f7\uff1a</p> <pre><code>&gt;&gt;&gt; str1 = ''''single' quotes and \"double\" quotes in Three single quotes'''\n# \u76f8\u5f53\u4e8e print(repr(str1))\n&gt;&gt;&gt; str1\n'\\'single\\' quotes and \"double\" quotes in Three single quotes'\n# \u76f8\u5f53\u4e8e print(str(str1))\n&gt;&gt;&gt; print(str1)\n'single' quotes and \"double\" quotes in Three single quotes\n\n# \u6ce8\u610f\u4e2d\u95f4\u5305\u542b\u6487\u53f7\u8fd8\u662f\u8981\u8f6c\u4e49\uff01\n&gt;&gt;&gt; str2='''Let\\'s say \"Hello, world!\"'''\n# \u76f8\u5f53\u4e8e print(repr(str2))\n&gt;&gt;&gt; str2\n'Let\\'s say \"Hello, world!\"'\n# \u76f8\u5f53\u4e8e print(str(str2))\n&gt;&gt;&gt; print(str2)\nLet's say \"Hello, world!\"\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#bytes","title":"bytes","text":"<p>bytes</p> <p>Only ASCII characters are permitted in bytes literals (regardless of the declared source code encoding). Any binary values over 127 must be entered into bytes literals using the appropriate escape sequence.</p> <p>Bytes literals are always prefixed with <code>'b'</code> or <code>'B'</code>; they produce an instance of the <code>bytes</code> type instead of the <code>str</code> type. They may only contain ASCII characters; bytes with a numeric value of 128 or greater must be expressed with escapes.</p> <pre><code>&gt;&gt;&gt; bs = b'ABC'\n&gt;&gt;&gt; type(bs)\n&lt;class 'bytes'&gt;\n\n&gt;&gt;&gt; bs\nb'ABC'\n&gt;&gt;&gt; bs[0]\n65\n&gt;&gt;&gt; bs[1]\n66\n&gt;&gt;&gt; bs[2]\n67\n</code></pre> <p>Since 2 hexadecimal digits correspond precisely to a single byte, hexadecimal numbers are a commonly used format for describing binary data. Accordingly, the bytes type has an additional class method to read data in that format:</p> <pre><code>classmethod fromhex(string)\n    This bytes class method returns a bytes object, decoding the given string object.  \n    The string must contain two hexadecimal digits per byte, with ASCII whitespace being ignored.\n</code></pre> <pre><code>&gt;&gt;&gt; dot = b'\\x2E'\n&gt;&gt;&gt; dot\nb'.'\n\n&gt;&gt;&gt; bytes.fromhex('2Ef0 F1f2  ')\nb'.\\xf0\\xf1\\xf2'\n</code></pre> <p>\u5176\u4e2d ASCII \u5b57\u7b26 <code>.</code> \u7684\u7f16\u7801\u4e3a 0x2E(46)\uff1a</p> <pre><code>&gt;&gt;&gt; chr(0x2E)\n'.'\n&gt;&gt;&gt; int('2E', 16)\n46\n&gt;&gt;&gt; ord('.')\n46\n&gt;&gt;&gt; hex(46)\n'0x2e'\n</code></pre> <p>A reverse conversion function exists to transform a bytes object into its hexadecimal representation.</p> <pre><code>hex()\n    Return a string object containing two hexadecimal digits for each byte in the instance.\n</code></pre> <pre><code>&gt;&gt;&gt; b'\\xf0\\xf1\\xf2'.hex()\n'f0f1f2'\n\n&gt;&gt;&gt; bs.hex()\n'414243'\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#assign_copy","title":"assign copy","text":"<p>Python Strings | Python Education - Google for Developers</p> <p>Python strings are \"immutable\" which means they cannot be changed after they are created. Since strings can't be changed, we construct new strings as we go to represent computed values.  </p> <p>\u7531\u4e8e str \u662f immutable \u7684\uff0c\u8d4b\u503c\u662f\u62f7\u8d1d\uff08duplicate\uff09\u526f\u672c\uff08copy\uff09\u3002</p> <pre><code>mr = 'Mr. Entity'\nmrs = mr # duplicate\nmrs = 'Mrs. Entity'\nprint(mr) # remain unchanged\nprint(mr is mrs) # False\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#sequential_access","title":"sequential access","text":"<p>access through subscripted index</p> <pre><code>&gt;&gt;&gt; word = 'Python'\n</code></pre> <p>\u987a\u5e8f\u7d22\u5f15\u8bbf\u95ee\uff08\u4ece0\u5f00\u59cb\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; #\u7b2c\u4e00\u4e2a\u5b57\u7b26\n... word[0]\n'P'\n\n&gt;&gt;&gt; #\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\n... word[len(word)-1]\n'n'\n&gt;&gt;&gt; word[5]\n'n'\n</code></pre> <p>\u8d1f\u6570\u5012\u5e8f\u7d22\u5f15\u8bbf\u95ee\uff08\u4ece-1\u5f00\u59cb\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; #\u5012\u6570\u7b2c\u4e00\u4e2a\u5b57\u7b26\n... word[-1]\n'n'\n\n&gt;&gt;&gt; #\u5012\u6570\u7b2c\u4e8c\u4e2a\u5b57\u7b26\n... word[-2]\n'o'\n\n&gt;&gt;&gt; #\u5012\u6570\u7b2c\u516d\u4e2a\u5b57\u7b26\n... word[-6]\n'P'\n</code></pre> <p>\u533a\u95f4\u7d22\u5f15\u8bbf\u95ee\uff1a</p> <pre><code>&gt;&gt;&gt; word[0:2]\n'Py'\n&gt;&gt;&gt; word[2:5]\n'tho'\n</code></pre> <p>\u4e0d\u6307\u5b9a\u8d77\u59cb\u7d22\u5f15\uff0c\u9ed8\u8ba4\u7684\u8d77\u59cb\u7d22\u5f15\u4e3a\u53e5\u9996\uff080\uff09:</p> <pre><code>&gt;&gt;&gt; word[:2]\n'Py'\n</code></pre> <p>\u4e0d\u6307\u5b9a\u8d77\u59cb\u7d22\u5f15\uff0c\u9ed8\u8ba4\u7684\u8d77\u59cb\u7d22\u5f15\u81f3\u672b\u5c3e\uff08len(s)-1,-1\uff09:</p> <p>```&gt;&gt;&gt; word[2:] 'thon'</p> <p>word[4:] 'on' word[-2:] 'on' <pre><code>## Core Methods\n\n[String Methods](https://docs.python.org/3.6/library/stdtypes.html#string-methods)\n\n```Shell\n\n# \u57fa\u4e8e\u5360\u4f4d\u7b26\u683c\u5f0f\u5316\u521b\u5efa\u5b57\u7b26\u4e32\nstr.format(*args, **kwargs)\n\n# \u5224\u65ad\u662f\u5426\u4ee5\u67d0\u4e2a\u5b50\u4e32\u5f00\u5934/\u7ed3\u5c3e\nstr.startswith(prefix[, start[, end]])\nstr.endswith(suffix[, start[, end]])\n\n# \u8ba1\u7b97\u5b50\u4e32\u7684\u4e2a\u6570\nstr.count(sub[, start[, end]])\n\n# \u67e5\u627e\u5b50\u4e32\u7684\u4f4d\u7f6e\u7d22\u5f15\uff0c\u4e0d\u5b58\u5728\u5219\u8fd4\u56de-1\nstr.find(sub[, start[, end]])\nstr.rfind(sub[, start[, end]])\n\n# \u67e5\u627e\u5b50\u4e32\u7684\u4f4d\u7f6e\u7d22\u5f15\uff0c\u627e\u4e0d\u5230\u5219\u629b ValueError \u5f02\u5e38\nstr.index(sub[, start[, end]]) \nstr.rindex(sub[, start[, end]])\n\n# \u66ff\u6362\u5b50\u4e32\nstr.replace(old, new[, count])\n\n# \u79fb\u9664\u5f00\u5934\u6216\u7ed3\u5c3e\u7684\u7a7a\u767d\nstr.strip([chars])\nstr.lstrip([chars])\nstr.rstrip([chars])\n\n# \u5206\u5272\u4e09\u90e8\u5206(head, sep, tail)\nstr.partition(sep)\nstr.rpartition(sep)\n\n# \u6309\u7167\u5206\u9694\u7b26\u5206\u5272\u6210\u5b50\u4e32\nstr.split(sep=None, maxsplit=-1)\nstr.rsplit(sep=None, maxsplit=-1)\n\nstr.splitlines([keepends])\n</code></pre></p> <p>capitalize \u5c06\u9996\u5b57\u6bcd\u5927\u5199\uff1btitle \u5c06\u6bcf\u4e2a\u5355\u8bcd\u9996\u5b57\u6bcd\u5927\u5199\uff1bupper/lower\u5c06\u5168\u90e8\u5b57\u6bcd\u5927\u5199/\u5c0f\u5199\u3002</p> <p>\u7531\u4e8e str \u662f immutable \u7684\uff0c\u8fd9\u4e9b\u5927\u5c0f\u5199\u64cd\u4f5c\u51fd\u6570\u90fd\u662f\u57fa\u4e8e\u526f\u672c\u64cd\u4f5c\uff0c\u8fd4\u56de\u5904\u7406\u540e\u7684\u526f\u672c\uff0c\u4e0d\u5f71\u54cd\u539f\u4ef6(str1)\u3002</p> <pre><code>#%%\nstr1='hello, world!'\nstr2=str1.capitalize()\nprint(str2) # Hello, world!\nstr3=str1.title()\nprint(str3) # Hello, World!\nstr4=str1.upper()\nprint(str4) # HELLO, WORLD!\nstr5=str4.lower()\nprint(str5) # hello, world!\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#startswith_tuple","title":"startswith tuple","text":"<p>startswith \u7684\u4f4d\u7f6e\u53c2\u6570 prefix \u9664\u4e86\u652f\u6301\u5355\u4e2a\u5b57\u7b26\u4e32\uff0c\u4e5f\u652f\u6301\u4f20\u5165\u5b57\u7b26\u4e32 tuple(str1,str2,...)\uff0c\u9010\u4e2a\u5c1d\u8bd5\u5339\u914d\u3002</p> <pre><code>&gt;&gt;&gt; help(str)\n\n |  startswith(...)\n |      S.startswith(prefix[, start[, end]]) -&gt; bool\n |\n |      Return True if S starts with the specified prefix, False otherwise.\n |      With optional start, test S beginning at that position.\n |      With optional end, stop comparing S at that position.\n |      prefix can also be a tuple of strings to try.\n</code></pre> <p>\u4f8b\u5982\uff0c\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u9010\u884c\u8bfb\u53d6\u6587\u672c\u6587\u4ef6\uff0c\u5224\u65ad\u5f00\u5934\u662f\u5426\u4ee5\u7a7a\u767d\u5b57\u7b26\u96c6\u5f00\u5934\uff1a</p> <pre><code>import string\n\nwith open('test.py') as f:\n    for index, line in enumerate(f):\n        if (not line.startswith(tuple(string.whitespace))):\n            print(f'{index+1}:', line, end='')\n        else:\n            print(f'{index+1}: ')\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#join_iterable","title":"join iterable","text":"<pre><code>&gt;&gt;&gt; help(str)\n\n |  join(self, iterable, /)\n |      Concatenate any number of strings.\n |\n |      The string whose method is called is inserted in between each given string.\n |      The result is returned as a new string.\n |\n |      Example: '.'.join(['ab', 'pq', 'rs']) -&gt; 'ab.pq.rs'\n</code></pre> <p>string.py \u4e2d\u7684 string.capwords \u65b9\u6cd5\u5373\u4f7f\u7528 map \u8fed\u4ee3\u5668\u642d\u914d join \u5b9e\u73b0\uff1a</p> <pre><code># Capitalize the words in a string, e.g. \" aBc  dEf \" -&gt; \"Abc Def\".\ndef capwords(s, sep=None):\n    return (sep or ' ').join(map(str.capitalize, s.split(sep)))\n</code></pre>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#expressions","title":"expressions","text":"<ul> <li><code>len(s)</code>: Return the length of str(number of single character).  </li> <li><code>c in s</code>: Test x for membership in s.  </li> <li><code>c not in s</code>: Test x for non-membership in s.  </li> <li><code>for c in s</code>: enumerate substring(character)  in s.  </li> </ul>","tags":["str"]},{"location":"blog/20191204/3-builtins.str/#demos","title":"demos","text":"<pre><code>&gt;&gt;&gt; str1='py'\n&gt;&gt;&gt; str2='python'\n\n&gt;&gt;&gt; str1 in str2\nTrue\n\n&gt;&gt;&gt; str2.find(str1)\n0\n\n&gt;&gt;&gt; str2.count(str1)\n1\n\n&gt;&gt;&gt; str2.startswith(str1) or str2.endswith(str1)\nTrue\n</code></pre>","tags":["str"]},{"location":"blog/20191204/4-builtins.str.format/","title":"python\u5185\u7f6e\u6a21\u5757\u4e4b\u5b57\u7b26\u4e32\u683c\u5f0f\u5316(str.format)","text":"<p>Python\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u5b57\u7b26\u4e32\uff08builtins.str\uff09\u683c\u5f0f\u5316\u60ef\u7528\u6cd5\u3002</p> <p>Format String Syntax </p> <ul> <li>Format Specification Mini-Language </li> <li>Format examples</li> </ul> <p>\u63a7\u5236\u53f0\u8f93\u5165 <code>help('FORMATTING')</code> \u53ef\u67e5\u770b\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u76f8\u5173\u8bae\u9898\uff08Format String Syntax\uff09\u3002</p> <p>7. Input and Output \u2014 Python 3.12.2 documentation</p> <p>Python String Formatting Best Practices</p> <ol> <li>\u201cOld Style\u201d String Formatting (% Operator)</li> <li>\u201cNew Style\u201d String Formatting (str.format)</li> <li>String Interpolation / f-Strings (Python 3.6+)</li> <li>Template Strings (Standard Library)</li> </ol> <p>\u6bd4\u8f03 Python \u7684\u683c\u5f0f\u5316\u5b57\u4e32 \u2014 %-formatting\u3001str.format()\u3001 f-string</p>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#format","title":"format()","text":"<p>builtins.format # help('FORMATTING')  </p> <p>\u53c2\u8003 builtins.format\uff0cformat \u51fd\u6570\u5c06\u503c\u7c7b\u578b\u6309\u7167\u6307\u5b9a\u683c\u5f0f\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u8868\u793a\u3002</p> <pre><code>format(value[, format_spec])\n\nConvert a value to a \u201cformatted\u201d representation, as controlled by *format_spec*. \n</code></pre> <p>The default <code>format_spec</code> is an empty string which usually gives the same effect as calling <code>str(value)</code>.</p> <p>str(255) \u5c06\u503c\u5b57\u7b26\u4e32\u5316\u4e3a '255'\uff0chex(255) \u5c06\u503c\u5b57\u7b26\u4e32\u5316\u4e3a\u5e26 0x \u524d\u7f00\u7684\u5341\u516d\u8fdb\u5236\u8868\u793a '0xff'\u3002 \u9664\u6b64\u4e4b\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7 format \u51fd\u6570\u6307\u5b9a\u66f4\u8be6\u7ec6\u7684\u8868\u793a\u683c\u5f0f\uff0c\u4f8b\u5982\u4e0d\u5e26 0x \u524d\u7f00\u3001\u5341\u516d\u8fdb\u5236\u5927\u5c0f\u5199\u7b49\u3002</p> <pre><code>&gt;&gt;&gt; format(255, '#x'), format(255, 'x'), format(255, 'X')\n('0xff', 'ff', 'FF')\n</code></pre>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#-formatting","title":"%-formatting","text":"<p>Old string formatting</p> <p>The % operator (modulo) can also be used for string formatting. This operation is commonly known as string interpolation.</p> <p>printf-style String Formatting</p> <p>String objects have one unique built-in operation: the <code>%</code> operator (modulo). This is also known as the string formatting or interpolation operator. Given <code>format % values</code> (where format is a string), <code>%</code> conversion specifications in format are replaced with zero or more elements of values. The effect is similar to using the <code>sprintf</code>() in the C language.</p> <p>If format requires a single argument, values may be a single non-tuple object. Otherwise, values must be a tuple with exactly the number of items specified by the format string, or a single mapping object (for example, a dictionary).</p> <p>How to print a C format in python</p> <p>C printf \u98ce\u683c\uff0c\u4f7f\u7528 <code>%</code> \u683c\u5f0f\u7b26\u6807\u8bc6\u5360\u4f4d\u3002</p> <p>\u76f4\u63a5\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>&gt;&gt;&gt; '%#x' % 255, '%x' % 255, '%X' % 255\n('0xff', 'ff', 'FF')\n</code></pre> <p>\u4f7f\u7528 print \u51fd\u6570\u6253\u5370\u8f93\u51fa\uff1a</p> <pre><code># start \u53ef\u52a0\u62ec\u53f7\n&gt;&gt;&gt; print('start is %d' % start)\nstart is 0\n\n&gt;&gt;&gt; print('start,stop is %d, %d' % (start, stop))\nstart,stop is 0, 30\n\nname = \"John\"\nage = 23\nscore = 85\nprint(\"Total score for\", name, \"is\", score)\nprint(\"%s is %d years old.\" % (name, age))\n</code></pre> <p>\u4e5f\u652f\u6301\u547d\u540d\u5360\u4f4d\u53c2\u6570\uff0c\u540e\u9762\u4ee5\u5927\u62ec\u53f7\u5b57\u5178\u5f62\u5f0f\u7ed9\u51fa\uff08\u53c2\u6570key\u5bf9\u5e94\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; print('%(language)s has %(number)03d quote types.' % {'language': \"Python\", \"number\": 2})\nPython has 002 quote types.\n</code></pre> <p>\u4ee5\u4e0b\u91c7\u7528 C-printf-style\uff0c\u63a7\u5236\u5b57\u7b26\u4e32\u622a\u65ad\u8f93\u51fa\uff1a</p> <pre><code>&gt;&gt;&gt; 'i love %s' % 'python'\n'i love python'\n&gt;&gt;&gt; 'i love %.2s' % 'python'\n'i love py'\n\n# \u622a\u53d6\u4e24\u4f4d\uff0c\u603b\u5171\u4e09\u4f4d\uff0c\u9ed8\u8ba4\u53f3\u5bf9\u9f50\n&gt;&gt;&gt; 'i love %3.2s' % 'python'\n'i love  py'\n\n# \u622a\u53d6\u4e24\u4f4d\uff0c\u603b\u5171\u5341\u4f4d\uff0c\u9ed8\u8ba4\u53f3\u5bf9\u9f50\n&gt;&gt;&gt; 'i love %10.2s' % 'python'\n'i love         py'\n\n# \u622a\u53d6\u4e24\u4f4d\uff0c\u603b\u5171\u5341\u4f4d\uff0c\u8bbe\u7f6e\u5de6\u5bf9\u9f50\n&gt;&gt;&gt; 'i love %-10.2s' % 'python'\n'i love py        '\n\n# \u622a\u53d6\u4e24\u4f4d\uff0c\u603b\u5171\u5341\u4f4d\uff0c\u8bbe\u7f6e\u5de6\u5bf9\u9f50\n&gt;&gt;&gt; 'i love %-10.2s !' % 'python'\n'i love py         !'\n</code></pre>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#strformat","title":"str.format","text":"<p>PEP 3101 \u2013 Advanced String Formatting</p> <p>The \u2018%\u2019 operator is primarily limited by the fact that it is a binary operator, and therefore can take at most two arguments. One of those arguments is already dedicated to the format string, leaving all other variables to be squeezed into the remaining argument. The current practice is to use either a dictionary or a tuple as the second argument, but as many people have commented, this lacks flexibility. The \u201call or nothing\u201d approach (meaning that one must choose between only positional arguments, or only named arguments) is felt to be overly constraining.</p> <p>The built-in string class (and also the unicode class in 2.6) will gain a new method, \u2018format\u2019, which takes an arbitrary number of positional and keyword arguments:</p> <p>\u51fd\u6570\u539f\u578b\uff1astr.format(*args, **kwargs)</p> <pre><code>Perform a string formatting operation. The string on which this method is called can contain literal text or replacement fields delimited by braces {}. Each replacement field contains either the numeric index of a positional argument, or the name of a keyword argument.\n</code></pre> <ul> <li>reference - 2.4.3. Formatted string literals - New in version 3.6.  </li> <li>tutorial - 7.1. Fancier Output Formatting </li> <li>library - str.format </li> <li>library - 6.1.3. Format String Syntax </li> </ul> <p><code>str.format()</code> \u51fd\u6570\u628a\u5b57\u7b26\u4e32\u5f53\u6210\u4e00\u4e2a\u6a21\u677f\uff0c\u901a\u8fc7\u4f20\u5165\u7684\u53c2\u6570\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u5e76\u4f7f\u7528\u5927\u62ec\u53f7 <code>{}</code> \u4f5c\u4e3a\u7279\u6b8a\u5b57\u7b26\u4ee3\u66ff % \u5360\u4f4d\u683c\u5f0f\u7b26\u3002</p>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#positional_argument","title":"positional argument","text":"<p>\u5927\u62ec\u53f7\u4e2d\u53ef\u6307\u5b9a\u53c2\u6570\u7d22\u5f15\uff08the numeric index of a positional argument\uff09\u3002 \u4ece Python 3.1 \u5f00\u59cb\uff0c\u5360\u4f4d\u5e8f\u53f7\u4e5f\u53ef\u4ee5\u7701\u7565\uff0c<code>{} {}</code> \u81ea\u52a8\u7f16\u53f7\u4e3a <code>{0} {1}</code>\u3002  </p> <p>Accessing arguments by position:</p> <pre><code>&gt;&gt;&gt; print('{0} {1}'.format('hello','world'))\nhello world\n&gt;&gt;&gt; print('{} {}'.format('hello','world'))\nhello world\n# \u91cd\u590d\u4f7f\u7528\u67d0\u4e00\u4f4d\u7f6e\u5e8f\u53f7\n&gt;&gt;&gt; print('{0} {1} {0}'.format('hello','world'))\nhello world hello\n</code></pre> <p>\u751a\u81f3\uff0c\u53ef\u4ee5\u50cf\u4e0b\u9762\u8fd9\u6837\uff0c\u628a\u7f16\u53f7\u5f53\u5bf9\u8c61\u4f7f\u7528\u8fdb\u884c\u6df1\u5ea6\u5f15\u7528\uff1a</p> <pre><code>&gt;&gt;&gt; table = {'Sjoerd': 4127, 'Jack': 4098, 'Dcab': 8637678}\n&gt;&gt;&gt; print('Jack: {0[Jack]:d}; Sjoerd: {0[Sjoerd]:d}; '\n...       'Dcab: {0[Dcab]:d}'.format(table))\nJack: 4098; Sjoerd: 4127; Dcab: 8637678\n</code></pre>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#keyword_argument","title":"keyword argument","text":"<p>\u5927\u62ec\u53f7\u4e2d\u4e5f\u53ef\u6307\u5b9a\u5360\u4f4d\u66ff\u6362\u53d8\u91cf\uff08the name of a keyword argument\uff09\u3002  </p> <p>Accessing arguments by name:</p> <pre><code>&gt;&gt;&gt; print('i love {you}'.format(you='python'))\ni love python\n&gt;&gt;&gt;\n&gt;&gt;&gt; 'Coordinates: {latitude}, {longitude}'.format(latitude='37.24N', longitude='-115.81W')\n'Coordinates: 37.24N, -115.81W'\n&gt;&gt;&gt; \n&gt;&gt;&gt; coord = {'latitude': '37.24N', 'longitude': '-115.81W'}\n&gt;&gt;&gt; 'Coordinates: {latitude}, {longitude}'.format(**coord)\n'Coordinates: 37.24N, -115.81W'\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u5229\u7528\u4e09\u5f15\u53f7\u8de8\u884c\u5b9a\u4e49\u4e00\u4e2a HTML \u6a21\u677f\uff1a</p> <pre><code>&gt;&gt;&gt; template='''&lt;html&gt;\n... &lt;head&gt;&lt;title&gt;{title}&lt;/title&gt;&lt;/head&gt;\n... &lt;body&gt;\n... &lt;h1&gt;{title}&lt;/h1&gt;\n... &lt;p&gt;{text}&lt;/p&gt;\n... &lt;/body&gt;'''\n\n&gt;&gt;&gt; template\n'&lt;html&gt;\\n&lt;head&gt;&lt;title&gt;{title}&lt;/title&gt;&lt;/head&gt;\\n&lt;body&gt;\\n&lt;h1&gt;{title}&lt;/h1&gt;\\n&lt;p&gt;{text}&lt;/p&gt;\\n&lt;/body&gt;'\n\n&gt;&gt;&gt; print(template)\n&lt;html&gt;\n&lt;head&gt;&lt;title&gt;{title}&lt;/title&gt;&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;{title}&lt;/h1&gt;\n&lt;p&gt;{text}&lt;/p&gt;\n&lt;/body&gt;\n</code></pre> <p>\u7136\u540e\uff0c\u901a\u8fc7 format \u4f20\u53c2\u66ff\u6362\u5360\u4f4d\u53d8\u91cf\u5bf9\u6a21\u677f\u8fdb\u884c\u5b9e\u4f8b\u5316\uff1a</p> <pre><code>&gt;&gt;&gt; print(template.format(title='My Home Page', text='Welcome to my home page!'))\n&lt;html&gt;\n... &lt;head&gt;&lt;title&gt;My Home Page&lt;/title&gt;&lt;/head&gt;\n... &lt;body&gt;\n... &lt;h1&gt;My Home Page&lt;/h1&gt;\n... &lt;p&gt;Welcome to my home page!&lt;/p&gt;\n... &lt;/body&gt;\n</code></pre>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#format_map","title":"format_map","text":"<p>Python 3.2 \u5f00\u59cb\u8fd8\u63d0\u4f9b\u4e86 str.format_map() \u65b9\u6cd5\uff0c\u652f\u6301\u4f20\u5165\u5b57\u5178\u4f5c\u4e3a\u53c2\u6570\u952e\u503c\u5bf9\u5bf9\u6a21\u677f\u8fdb\u884c\u5b9e\u4f8b\u5316\uff1a</p> <pre><code>&gt;&gt;&gt; data = {'title': 'My Home Page', 'text': 'Welcome to my home page!'}\n&gt;&gt;&gt; print(template.format_map(data))\n&lt;html&gt;\n&lt;head&gt;&lt;title&gt;My Home Page&lt;/title&gt;&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;My Home Page&lt;/h1&gt;\n&lt;p&gt;Welcome to my home page!&lt;/p&gt;\n&lt;/body&gt;\n</code></pre>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#mixins","title":"mixins","text":"<p>\u4f4d\u7f6e\u5360\u4f4d\u548c\u5173\u952e\u5b57\u5360\u4f4d\u53ef\u6df7\u5408\u4f7f\u7528\uff1a</p> <pre><code>&gt;&gt;&gt; a='python'\n&gt;&gt;&gt; b='you'\n&gt;&gt;&gt; d='me'\n&gt;&gt;&gt; \"The story of {0}, {1}, and {c}\".format(a, b, c=d)\n'The story of python, you, and me'\n\n&gt;&gt;&gt; print('The story of {0}, {1}, and {other}.'.format('Bill', 'Manfred', other='Georg'))\nThe story of Bill, Manfred, and Georg.\n</code></pre>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#f-string","title":"f-string","text":"<p>2016 \u53d1\u5e03\u7684 Python 3.6 \u4e2d\u65b0\u589e\u7684 <code>f-string</code>\uff0c\u53ef\u4ee5\u89e3\u51b3 <code>%-formatting</code> \u53d8\u91cf\u4e0d\u6613\u9605\u8bfb\u4ee5\u53ca <code>str.format()</code> \u63a5\u53d8\u91cf\u540e\u53d8\u8d85\u957f\u7684\u95ee\u9898\u3002</p> <p>Formatted string literals</p> <p>A formatted string literal or f-string is a string literal that is prefixed with <code>'f'</code> or <code>'F'</code>. These strings may contain replacement fields, which are expressions delimited by curly braces <code>{}</code>. While other string literals always have a constant value, formatted strings are really expressions evaluated at run time.</p> <p>A string literal with <code>'f'</code> or <code>'F'</code> in its prefix is a formatted string literal. The <code>'f'</code> may be combined with <code>'r'</code>, but not with <code>'b'</code> or <code>'u'</code>, therefore raw formatted strings are possible, but formatted bytes literals are not.</p> <p>\u8bed\u6cd5\u548c\u6548\u679c\uff0c\u6709\u70b9\u7c7b\u4f3c JavaScript \u4e2d ES2015 \u5f15\u5165\u7684 Template literals (Template strings)\u3002</p> <p>If a conversion is specified, the result of evaluating the expression is converted before formatting. Conversion '<code>!s</code>' calls <code>str</code>() on the result, '<code>!r</code>' calls <code>repr</code>(), and '<code>!a</code>' calls <code>ascii</code>().</p> <p>!r \u5bf9\u6574\u6570\u53d8\u91cf\u8c03\u7528str\u5b57\u7b26\u4e32\u5316\u8f93\u51fa\uff1a</p> <p>\u6b64\u5904\u4e0d\u5e26\u8fd9\u4e2a\uff0c\u9ed8\u8ba4\u4e5f\u4f1a\u8f6c\u6362\u3002</p> <pre><code>&gt;&gt;&gt; year = 2019\n&gt;&gt;&gt; f'year is {year!s}' # \u7b49\u6548\u4e8e f'year is {str(year)}'\n'year is 2019'\n</code></pre> <p>!r \u5bf9\u5b57\u7b26\u4e32\u53d8\u91cf\u8c03\u7528repr\uff0c\u4fdd\u6301\u539f\u59cb\u5b57\u7b26\u4e32\u8f93\u51fa\uff08\u5305\u62ec\u5f15\u53f7\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; name = \"Fred\"\n&gt;&gt;&gt; f\"He said his name is {name}.\"\n'He said his name is Fred.'\n&gt;&gt;&gt; f\"He said his name is {name!r}.\" # f\"He said his name is {repr(name)}.\"\n\"He said his name is 'Fred'.\"\n</code></pre> <p>\u6216\u8005\u7528 <code>=</code> \u6765\u5b9e\u73b0\u7c7b\u4f3c\u7684\u6548\u679c\uff1a</p> <pre><code>&gt;&gt;&gt; f\"He said his {name = }.\"\n\"He said his name = 'Fred'.\"\n</code></pre> <p>\u5bf9\u4e8e iterable \u7c7b\u578b\uff0c\u5b9e\u9645\u4e0a\u662f iter next \u8c03\u7528\u591a\u6b21\uff1a</p> <pre><code>&gt;&gt;&gt; a=[\"a\", \"b\", \"c\"]\n&gt;&gt;&gt; print(f\"List a contains:\\n{\"\\n\".join(a)}\")\nList a contains:\na\nb\nc\n</code></pre> <p>\u53c2\u8003\u8d44\u6599\uff1a</p> <ul> <li>Python 3's f-Strings: An Improved String Formatting Syntax</li> <li>String formatting for dictionary with f-string in Python</li> <li>How can I do a dictionary format with f-string in Python 3 .6?</li> </ul>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#\u6307\u5b9a\u683c\u5f0f","title":"\u6307\u5b9a\u683c\u5f0f","text":"<p>\u5bf9\u4e8e\u65e5\u671f\u6309\u7167\u5e74\u6708\u65e5\u5b57\u6bb5\u683c\u5f0f\u7ec4\u5408\u8f93\u51fa\uff1a</p> <pre><code>&gt;&gt;&gt; today = datetime.datetime(year=2017, month=1, day=27)\n&gt;&gt;&gt; f\"{today:%B %d, %Y}\"  # using date format specifier\n'January 27, 2017'\n&gt;&gt;&gt; f\"{today=:%B %d, %Y}\" # using date format specifier and debugging\n'today=January 27, 2017'\n</code></pre> <p>\u5bf9\u6570\u5b57\u8fdb\u884c\u5feb\u6377\u8f6c\u6362\uff0c\u6309\u6307\u5b9a\u8fdb\u5236/\u683c\u5f0f\u8f93\u51fa\uff1a</p> <pre><code>&gt;&gt;&gt; number = 1024\n&gt;&gt;&gt; f\"{number:#0x}\"\n'0x400'\n\n&gt;&gt;&gt; f'{255:#x}', f'{255:x}', f'{255:X}'\n('0xff', 'ff', 'FF')\n</code></pre>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#\u652f\u6301\u8fd0\u7b97","title":"\u652f\u6301\u8fd0\u7b97","text":"<p>Because f-strings are evaluated at runtime, you can put any and all valid Python expressions in them.</p> <pre><code>&gt;&gt;&gt; a = 5\n&gt;&gt;&gt; b = 10\n&gt;&gt;&gt; f'Five plus ten is {a + b} and not {2 * (a + b)}.'\n'Five plus ten is 15 and not 30.'\n\n&gt;&gt;&gt; x=10\n&gt;&gt;&gt; y=3\n&gt;&gt;&gt; f'{x/y = :.2f}'\n'x/y = 3.33'\n&gt;&gt;&gt; f'{x}/{y} = {x/y:.2f}'\n'10/3 = 3.33'\n</code></pre>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#\u8de8\u884c\u62fc\u63a5","title":"\u8de8\u884c\u62fc\u63a5","text":"<p>Formatted string literals may be concatenated, but replacement fields cannot be split across literals.</p> <p>Multiline f-Strings:</p> <pre><code>name = \"Eric\"\nprofession = \"comedian\"\naffiliation = \"Monty Python\"\n\n# \u7eed\u884c\u7b26\nmessage = f\"Hi {name}. \" \\\n          f\"You are a {profession}. \" \\\n          f\"You were in {affiliation}.\"\nprint(message)\n\n# \u62ec\u53f7\u7701\u7565\u7eed\u884c\u7b26\nmessage = (f\"Hi {name}. \"\n           f\"You are a {profession}. \"\n           f\"You were in {affiliation}.\")\nprint(message)\n\n# f\u52a0\u4e09\u5f15\u53f7\uff0c\u5219\u6309\u7167\u6392\u7248\u8f93\u51fa\uff0c\u5305\u62ec\u6362\u884c\u7f29\u8fdb\nmessage = f\"\"\"Hi {name}. \nYou are a {profession}. \nYou were in {affiliation}.\"\"\"\nprint(message)\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u591a\u4e2a f-strings \u8fdb\u884c\u8de8\u884c\u62fc\u63a5\uff1a</p> <pre><code>    payload = {\n        'msgtype': 'markdown',\n        'markdown': {\n            'content':\n            f'**App\u6628\u65e5Crash\u7edf\u8ba1**\\n'\n            f'**Android\u524d\u4e00\u7248\u672ccrash\u7387:** {(android_old_crash_rate * 100):.4f}%\\n'\n            f'**Android\u524d\u4e00\u7248\u672cflutter\u9519\u8bef\u7387:** {(android_old_error_rate * 100):.4f}%\\n'\n            f'**Android\u5f53\u524d\u7248\u672ccrash\u7387:** {(android_new_crash_rate * 100):.4f}%\\n'\n            f'**Android\u5f53\u524d\u7248\u672cflutter\u9519\u8bef\u7387:** {(android_new_error_rate * 100):.4f}%\\n'\n            f'**IOS\u524d\u4e00\u7248\u672ccrash\u7387:** {(ios_old_crash_rate * 100):.4f}%\\n'\n            f'**IOS\u524d\u4e00\u7248\u672cflutter\u9519\u8bef\u7387:** {(ios_old_error_rate * 100):.4f}%\\n'\n            f'**IOS\u5f53\u524d\u7248\u672ccrash\u7387:** {(ios_new_crash_rate * 100):.4f}%\\n'\n            f'**IOS\u5f53\u524d\u7248\u672cflutter\u9519\u8bef\u7387:** {(ios_new_error_rate * 100):.4f}%\\n'\n        }\n    }\n</code></pre>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#string_template","title":"string Template","text":"<p>The string module contains a Template class which offers yet another way to substitute values into strings.</p> <p>\u53c2\u8003\uff1abuiltins.str\u3002</p>","tags":["str","format","template"]},{"location":"blog/20191204/4-builtins.str.format/#rule_of_thumb","title":"rule of thumb","text":"<p>Python String Formatting Rule of Thumb: If your format strings are user-supplied, use Template Strings to avoid security issues. Otherwise, use Literal String Interpolation/f-Strings if you\u2019re on Python 3.6+, and \u201cNew Style\u201d str.format if you\u2019re not.  </p>","tags":["str","format","template"]},{"location":"blog/20191204/5-builtins.range/","title":"python\u5185\u7f6e\u6a21\u5757\u4e4b\u533a\u95f4\u8303\u56f4(range)","text":"<p>Python\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u533a\u95f4\u8303\u56f4\uff08builtins.range\uff09\u7684\u57fa\u672c\u7528\u6cd5\u3002</p> <p>range\uff08\u533a\u95f4\u8303\u56f4\uff09</p>","tags":["range"]},{"location":"blog/20191204/5-builtins.range/#help","title":"help","text":"<pre><code>&gt;&gt;&gt; help(range)\n\nHelp on class range in module builtins:\n\nclass range(object)\n |  range(stop) -&gt; range object\n |  range(start, stop[, step]) -&gt; range object\n |\n |  Return an object that produces a sequence of integers from start (inclusive)\n |  to stop (exclusive) by step.  range(i, j) produces i, i+1, i+2, ..., j-1.\n |  start defaults to 0, and stop is omitted!  range(4) produces 0, 1, 2, 3.\n |  These are exactly the valid indices for a list of 4 elements.\n |  When step is given, it specifies the increment (or decrement).\n</code></pre>","tags":["range"]},{"location":"blog/20191204/5-builtins.range/#usage","title":"usage","text":"<pre><code>&gt;&gt;&gt; r=range(1,10,2)\n\n&gt;&gt;&gt; r.start\n1\n&gt;&gt;&gt; r.stop\n10\n&gt;&gt;&gt; r.step\n2\n</code></pre> <p>\u53ef\u4ee5\u5c06\u5176\u8f6c\u6362\u4e3a tuple \u6216 list \u6253\u5370\u51fa\u5176\u503c\uff1a</p> <pre><code>&gt;&gt;&gt; tuple(r)\n(1, 3, 5, 7, 9)\n\n&gt;&gt;&gt; list(r) # or [*r]\n[1, 3, 5, 7, 9]\n</code></pre>","tags":["range"]},{"location":"blog/20191204/5-builtins.range/#access_through_subscripted_index","title":"access through subscripted index","text":"<p>range \u652f\u6301\u4e0b\u6807\u7d22\u5f15\u8bbf\u95ee\uff1a</p> <pre><code>&gt;&gt;&gt; r[3]\n7\n&gt;&gt;&gt; r[:3]\nrange(1, 7, 2)\n&gt;&gt;&gt; r[-1]\n9\n</code></pre>","tags":["range"]},{"location":"blog/20191204/5-builtins.range/#expressions","title":"expressions","text":"<ul> <li><code>len(r)</code>: Return the number of elements in range r.  </li> <li><code>e in r</code>: Test e for membership in r.  </li> <li><code>e not in r</code>: Test e for non-membership in r.  </li> <li><code>for e in r</code>: enumerate elements in r.  </li> </ul> <pre><code># \u8fd4\u56de\u533a\u95f4\u5305\u542b\u7684\u5143\u7d20\u4e2a\u6570\n&gt;&gt;&gt; len(r)\n5\n\n# \u5224\u65ad5\u662f\u5426\u5728\u533a\u95f4\u5185\n&gt;&gt;&gt; 5 in r\nTrue\n\n# \u5224\u65ad6\u662f\u5426\u4e0d\u5728\u533a\u95f4\u5185\n&gt;&gt;&gt; 6 not in r\nTrue\n\n# for \u5faa\u73af\u904d\u5386\n&gt;&gt;&gt; for i in r:\n...     print(i)\n... \n1\n3\n5\n7\n9\n</code></pre>","tags":["range"]},{"location":"blog/20191204/5-builtins.range/#methods","title":"Methods","text":"<pre><code> |  count(...)\n |      rangeobject.count(value) -&gt; integer -- return number of occurrences of value\n |  \n |  index(...)\n |      rangeobject.index(value, [start, [stop]]) -&gt; integer -- return index of value.\n |      Raise ValueError if the value is not present.\n</code></pre> <p><code>r.count(e)</code>\uff1a\u8fd4\u56de\u533a\u95f4\u8303\u56f4\u5185\u5143\u7d20e\u7684\u4e2a\u6570\uff1a</p> <pre><code>&gt;&gt;&gt; r.count(4)\n0\n&gt;&gt;&gt; r.count(5)\n1\n</code></pre> <p><code>r.index(e)</code>\uff1a\u8fd4\u56de\u533a\u95f4\u8303\u56f4\u5185\u5143\u7d20e\u7684\u7d22\u5f15\uff0c\u4e0d\u5b58\u5728\u629b\u5f02\u5e38\uff1a</p> <pre><code>&gt;&gt;&gt; r.index(4)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nValueError: 4 is not in range\n&gt;&gt;&gt; r.index(5)\n2\n</code></pre>","tags":["range"]},{"location":"blog/20191204/5-builtins.range/#usage_1","title":"usage","text":"<p>\u533a\u95f4\u7684\u5178\u578b\u5e94\u7528\u662f\u754c\u5b9a\u5217\u8868\u7d22\u5f15\uff1a</p> <pre><code>&gt;&gt;&gt; a = [1, 2, 3, 4, 5, 6, 7]\n&gt;&gt;&gt; a\n[1, 2, 3, 4, 5, 6, 7]\n\n&gt;&gt;&gt; for i,e in enumerate(a):\n...     print('l[%d] = %d' % (i, e))\n...\nl[0] = 1\nl[1] = 2\nl[2] = 3\nl[3] = 4\nl[4] = 5\nl[5] = 6\nl[6] = 7\n\n&gt;&gt;&gt; for i in range(0, len(a)): # i=[0, len(a)-1]\n...     print(\"a[{0}] = {1}\".format(i, a[i]))\n...\na[0] = 1\na[1] = 2\na[2] = 3\na[3] = 4\na[4] = 5\na[5] = 6\na[6] = 7\n</code></pre>","tags":["range"]},{"location":"blog/20191204/5-builtins.range/#negative_step","title":"negative step","text":"<p>\u5982\u679c <code>step&gt;0</code>\uff0c\u5219 <code>start+n*step</code> \u7ec8\u6b62\u6761\u4ef6\u4e3a <code>&lt;stop</code>\u3002</p> <p>\u5f53\u987a\u5e8f\u904d\u5386\u6570\u7ec4\u65f6\uff0c\u7d22\u5f15\u8303\u56f4\u662f [0, len-1]\uff0c\u7ec8\u6b62\u6761\u4ef6\u4e3a <code>&lt;len</code>\u3002</p> <p>\u5982\u679c <code>step&lt;0</code>\uff0c\u5219 <code>start+n*step</code> \u7ec8\u6b62\u6761\u4ef6\u4e3a <code>&gt;stop</code>\u3002</p> <p>\u5f53\u9006\u5411\u904d\u5386\u6570\u7ec4\u65f6\uff0c\u7d22\u5f15\u8303\u56f4\u662f [len-1, 0]\uff0c\u7ec8\u6b62\u6761\u4ef6\u4e3a <code>&gt;-1</code>\u3002</p> <p>C\u8bed\u8a00\u4e2d <code>for (i=len-1; i&gt;=1; i--)</code> \u7684\u7b49\u6548\u5b9e\u73b0\uff1a</p> <p>\u5192\u6ce1\u5347\u5e8f\u6392\u5e8f\u4e2d\u6bcf\u8f6e\u7684\u5192\u6ce1\u4f4d\u7f6e</p> <pre><code>A=[1,3,5,7,9]\nfor i in range(len(A)-1, 0, -1): # &gt;0\n    print(i, end=' ') # 4,3,2,1\n</code></pre> <p>C\u8bed\u8a00\u4e2d <code>for (i=len-1; i&gt;=0; i--)</code> \u7684\u7b49\u6548\u5b9e\u73b0\uff1a</p> <pre><code>A=[1,3,5,7,9]\nfor i in range(len(A)-1, -1, -1): # &gt;-1\n    print(i, end=' ') # 4,3,2,1,0\n</code></pre> <p>C\u8bed\u8a00\u4e2d <code>for (int k=i; k&gt;=offset; k-=offset)</code> \u7684\u7b49\u6548\u5b9e\u73b0\uff1a</p> <p>\u5e0c\u5c14\u5347\u5e8f\u6392\u5e8f\u4e2d</p> <pre><code>i=6; offset=2\n# i=7; offset=2\nfor k in range(i, offset-1, -offset): # &gt;offset-1\n    print(k, end=' ')\n</code></pre>","tags":["range"]},{"location":"blog/20191204/6-builtins.list/","title":"python\u5185\u7f6e\u6a21\u5757\u4e4b\u6709\u5e8f\u5217\u8868(list)","text":"<p>Python\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u6709\u5e8f\u5217\u8868\uff08builtins.list\uff09\u7684\u57fa\u672c\u7528\u6cd5\u3002</p> <p>list\uff08\u6709\u5e8f\u5217\u8868\uff09</p> <pre><code>&gt;&gt;&gt; type(sys.argv)\n&lt;class 'list'&gt;\n</code></pre> <pre><code># \u5224\u65ad\u6a21\u5757\u540d\u79f0\u4e2d\u662f\u5426\u5305\u542b '__doc__' \u548c '__file__'\n&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; '__doc__' in dir(builtins)\nTrue\n&gt;&gt;&gt; '__file__' in dir(builtins)\nFalse\n\n&gt;&gt;&gt; import os\n&gt;&gt;&gt; '__doc__' in dir(os)\nTrue\n&gt;&gt;&gt; '__file__' in dir(os)\nTrue\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#help","title":"help","text":"<pre><code>&gt;&gt;&gt; help(list)\n\nHelp on class list in module builtins:\n\nclass list(object)\n |  list(iterable=(), /)\n |\n |  Built-in mutable sequence.\n |\n |  If no argument is given, the constructor creates a new empty list.\n |  The argument must be an iterable if specified.\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#why_not_array_","title":"why not array ?","text":"<p><code>array</code> \u2014 Efficient arrays of numeric values</p> <p>This module defines an object type which can compactly represent an array of basic values: characters, integers, floating point numbers.  Arrays are sequence types and behave very much like lists, except that the type of objects stored in them is constrained. The type is specified at object creation time by using a type code, which is a single character.  </p> <pre><code>a=array.array('i', [1, 2, 3, 4, 5])\n</code></pre> <p>\u5f53\u6211\u4eec\u8981\u5b58\u50a8\u64cd\u4f5c\u5927\u89c4\u6a21\u7684\u6807\u91cf\u6570\u503c\u7c7b\u578b\u65f6\uff0c\u6570\u7ec4\uff08array\uff09\u7684\u6548\u7387\u8981\u6bd4\u5217\u8868\uff08list\uff09\u8981\u9ad8\u5f97\u591a\u3002 \u56e0\u4e3a\u6570\u7ec4\u5728\u80cc\u540e\u5b58\u7684\u5e76\u4e0d\u662f\u5bf9\u8c61\uff0c\u800c\u662f\u6570\u5b57\u7684\u673a\u5668\u7ffb\u8bd1\uff0c\u4e5f\u5c31\u662f\u5b57\u8282\u8868\u8ff0\u3002</p> <p>python\u4e4b\u6570\u7ec4\u6a21\u5757array python3\u4e4b\u6570\u7ec4(array) </p> <p>array \u76f8\u6bd4 list \u7684\u5c40\u9650\u5728\u4e8e\uff1alist \u53ef\u4ee5\u6df7\u5408\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\uff0c\u800c array \u5728\u6784\u9020\u65f6\u5fc5\u987b\u6307\u5b9a\u786e\u5b9a\u7684\u6570\u503c\u7c7b\u578b\u3002 \u4e00\u822c list \u7528\u7684\u573a\u5408\u6bd4\u8f83\u591a\u3002</p>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#common","title":"common","text":"","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#initialization","title":"initialization","text":"<ol> <li><code>l=list()</code>: \u6784\u9020\u4e00\u4e2a\u7a7a\u5217\u8868\u5bf9\u8c61\u3002  </li> </ol> <ul> <li><code>l=list(range(1,5))</code>\uff1a\u57fa\u4e8erange\u6784\u9020list\u3002</li> </ul> <ol> <li><code>l=[]</code>\uff1a\u4e2d\u62ec\u53f7\u5b9a\u4e49\u7a7a\u5217\u8868\u3002  </li> <li><code>l=[10]</code>\uff1a\u5b9a\u4e49\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\u5217\u8868\u3002</li> </ol> <ul> <li>\u6ce8\u610fC\u8bed\u8a00\u4e2d\u8868\u793a\u751f\u547dsize=10\u7684\u6570\u7ec4\u3002  </li> </ul> <ol> <li> <p><code>l1=[1,2,3,4]</code>\uff1a\u5b9a\u4e49\u5305\u542b\u591a\u4e2a\u5143\u7d20\u7684\u5217\u8868\uff0c\u591a\u4e2a\u5143\u7d20\u4e4b\u95f4\u4ee5\u9017\u53f7\u5206\u9694\u3002</p> </li> <li> <p><code>l=[*range(1,5)]</code> \u6216 <code>l=[*tuple(range(1,5))]</code>\uff1a\u4f7f\u7528\u661f\u53f7\u5bf9\u53ef\u679a\u4e3e\u5bf9\u8c61range\u3001tuple\u8fdb\u884c\u89e3\u5305\uff0c\u751f\u6210\u5217\u8868\u3002</p> </li> </ol> <p>\u5217\u8868\u652f\u6301\u57fa\u4e8e\u811a\u6807\u7d22\u5f15\u8bbf\u95ee\u5143\u7d20\uff08access through subscripted index\uff09\u3002</p> <p>\u6b64\u5916\uff0c\u6709\u4e9b\u573a\u5408\u53ef\u80fd\u9700\u8981\u9884\u5206\u914d\u6307\u5b9a\u5c3a\u5bf8\u7684\u6570\u7ec4\uff08\u5217\u8868\uff09\uff0c\u4ee5\u4fbf\u6309\u7d22\u5f15\u8bbe\u503c\u800c\u4e0d\u7528\u62c5\u5fc3\u8d8a\u754c\u8bbf\u95ee\u3002</p> <ul> <li><code>[None]*10</code>: \u521d\u59cb\u5316\u957f\u5ea6\u4e3a10\u7684\u5217\u8868\uff0c\u6240\u6709\u5143\u7d20\u521d\u59cb\u5316\u4e3a\u7a7a\u5bf9\u8c61None\u3002</li> <li><code>[0]*10</code>: \u521d\u59cb\u5316\u5305\u542b10\u4e2a0\u7684\u5217\u8868\u3002</li> </ul> <pre><code>&gt;&gt;&gt; l1=[None]*10\n&gt;&gt;&gt; l1\n[None, None, None, None, None, None, None, None, None, None]\n&gt;&gt;&gt; l2=[0]*10\n&gt;&gt;&gt; l2\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n</code></pre> <p>\u4f8b\u5982\u8ba1\u6570\u6392\u5e8f\uff08Counting Sort\uff09\u4e2d\uff0c\u9884\u5148\u58f0\u660e\u4e00\u4e2a\u548c\u6e90\u5217\u8868\u76f8\u540c\u5c3a\u5bf8\u7684\u6570\u7ec4\uff0c\u7528\u4e8e\u63a5\u6536\u6392\u5e8f\u7ed3\u679c\u3002</p> <p>B = [None]*len(A)</p>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#expressions","title":"expressions","text":"<ul> <li><code>len(l)</code>: Return the number of elements in list l.  </li> <li><code>e in l</code>: Test e for membership in l.  </li> <li><code>e not in l</code>: Test e for non-membership in l.  </li> <li><code>for e in l</code>: enumerate elements in l.  </li> </ul>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#api_overview","title":"api overview","text":"<p>\u5728 python shell \u4e2d\uff0c\u6784\u9020\u4e00\u4e2a\u7a7a\u5217\u8868 l\uff0c\u7136\u540e\u8f93\u5165 <code>l.</code> \u518d\u8f93\u5165 tab \u952e\u81ea\u52a8\u63d0\u793a\u53ef\u7528\u7684\u6210\u5458\u51fd\u6570\uff1a</p> <pre><code>&gt;&gt;&gt; l=list()\n&gt;&gt;&gt; l.\nl.append(   l.copy(     l.extend(   l.insert(   l.remove(   l.sort(\nl.clear(    l.count(    l.index(    l.pop(      l.reverse(\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#add","title":"add","text":"","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#append_insert","title":"append, insert","text":"<p>\u5411\u5217\u8868\u4e2d\u6dfb\u52a0\u5143\u7d20\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ol> <li>\u8c03\u7528 <code>l.append(e)</code>\uff0c\u5c06\u65b0\u5143\u7d20 e \u6dfb\u52a0\u5230\u5217\u8868 l \u7684\u672b\u5c3e\uff1b  </li> <li> <p>\u8c03\u7528 <code>l.insert(i, e)</code>\uff0c\u5c06\u65b0\u5143\u7d20 e \u63d2\u5165\u5230\u5217\u8868 l \u539f\u6765\u7d22\u5f15\u4e3a i \u7684\u5143\u7d20\u4e4b\u524d\uff1a</p> <p>\u539f\u6765\u7d22\u5f15 i \u53ca\u5176\u540e\u7684\u5143\u7d20\u987a\u52bf\u540e\u79fb\u4e00\u4f4d\uff0c\u65b0\u5143\u7d20 e \u5360\u636e\u7d22\u5f15 i \u7684\u4f4d\u7f6e\u3002</p> </li> </ol> <ul> <li>\u5c3e\u8ffd\u6cd5\uff1a<code>l.append(e)</code>;  </li> <li>\u5934\u63d2\u6cd5\uff1a<code>l.insert(0,e)</code>;  </li> </ul> <p>\u4ee5\u4e0b\u4e3a\u57fa\u4e8e list.append \u65b9\u6cd5\u5b9e\u73b0\u6590\u6ce2\u90a3\u5951\u5217\u8868\u3002</p> <pre><code>def fibs(n: int) -&gt; list:\n    if n &lt; 2:\n        print('To make sense, n should be bigger than 2.')\n        return None\n    else:\n        r = [0, 1]\n        for i in range(n-2):\n            r.append(r[-2]+r[-1])\n        return r\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#extend","title":"extend","text":"<p><code>append</code> \u4e00\u822c\u662f\u5c06\u5355\u4e2a\u5143\u7d20\u8ffd\u52a0\u5230\u5217\u8868\u672b\u5c3e\uff0c\u5982\u4f55\u5728\u5df2\u6709\u5217\u8868\u540e\u9762\u8ffd\u52a0\uff08\u8854\u63a5\uff09\u53e6\u5916\u4e00\u4e2a\u5217\u8868\u5462\uff1f</p> <p>\u8fd9\u6d89\u53ca\u5230 extend \u63a5\u53e3\uff1a<code>extend</code> list by appending elements from the iterable.</p> <p>\u6211\u4eec\u521b\u5efa\u5217\u8868 l1 \u53ca\u5176\u526f\u672c l2\uff0c\u63a5\u4e0b\u6765\u770b\u770b\u5b83\u4eec\u5206\u522b\u901a\u8fc7 append \u548c extend \u8ffd\u52a0\u7684\u6548\u679c\u3002</p> <pre><code>&gt;&gt;&gt; l1=list(range(1,5))\n&gt;&gt;&gt; l1\n[1, 2, 3, 4]\n&gt;&gt;&gt; l2 = l1.copy()\n&gt;&gt;&gt; l2\n[1, 2, 3, 4]\n&gt;&gt;&gt; l3=list(range(5,9))\n&gt;&gt;&gt; l3\n[5, 6, 7, 8]\n</code></pre> <p><code>l1.append(l3)</code> \u5c06 l3 \u8ffd\u52a0\u5230 l1\uff0c\u662f\u5c06\u5217\u8868 l3 \u4f5c\u4e3a\u4e00\u4e2a\u5143\u7d20\u8ffd\u52a0\u5230 l1\uff1a</p> <pre><code>&gt;&gt;&gt; l1.append(l3)\n&gt;&gt;&gt; l1\n[1, 2, 3, 4, [5, 6, 7, 8]]\n&gt;&gt;&gt; len(l1)\n5\n&gt;&gt;&gt; l1[4]\n[5, 6, 7, 8]\n&gt;&gt;&gt; type(l1[4])\n&lt;class 'list'&gt;\n</code></pre> <p><code>l2.extend(l3)</code> \u5219\u5c06 l3 \u4e2d\u7684\u5217\u8868\u5143\u7d20\u9010\u4e2a append \u8ffd\u52a0\u5230 l2 \u540e\u9762\uff0c\u5b9e\u73b0\u4e86\u9884\u671f\u7684\u5217\u8868\u8854\u63a5\u3002</p> <pre><code>&gt;&gt;&gt; l2.extend(l3)\n&gt;&gt;&gt; l2\n[1, 2, 3, 4, 5, 6, 7, 8]\n&gt;&gt;&gt; len(l2)\n8\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#delete","title":"delete","text":"","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#del","title":"del","text":"<p>\u8c03\u7528\u5185\u7f6e\u7684 <code>del</code> \u51fd\u6570\uff0c\u53ef\u4ee5\u5220\u9664\u5217\u8868\u4e2d\u7684\u5143\u7d20\uff0c\u88ab\u5220\u4f4d\u7f6e\u81ea\u52a8\u6392\u7a7a\u3002</p> <ol> <li><code>del(l[i])</code> \u6216 <code>del l[i]</code>\uff1a\u4ece\u5217\u8868l\u4e2d\u79fb\u9664\u7d22\u5f15 i \u5904\u7684\u5143\u7d20\uff1b</li> <li>\u5f53\u7136\u4e5f\u53ef\u4ee5 <code>del l[i:j:k]</code> \u79fb\u9664\u5207\u7247\u5b50\u96c6\u3002</li> </ol>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#pop","title":"pop","text":"<p>list \u672c\u8eab\u81ea\u5e26\u7684 pop \u51fd\u6570\uff0c\u652f\u6301\u5f39\u51fa\u6307\u5b9a\u4f4d\u7f6e\u5143\u7d20\u3002</p> <p><code>e=l.pop(i)</code>\uff1a\u4ece\u5217\u8868l\u4e2d\u5f39\u51fa\u7d22\u5f15i\u5904\u7684\u5143\u7d20\u5230\u53d8\u91cfe\uff0c\u7b49\u6548\u4e8e <code>e=l[i]; del(l[i])</code>\uff1b  </p> <ul> <li><code>l.pop()</code>\uff1a\u4e0d\u6307\u5b9a\u7d22\u5f15\uff0c\u9ed8\u8ba4\u5f39\u51fa\u4e0a\u4e00\u6b21 append \u5230\u961f\u5c3e\uff08\u6808\u9876\uff09\u7684\u5143\u7d20\u3002  </li> <li><code>e=l.pop(0)</code>\uff1a\u5f39\u51fa\u961f\u5934\uff08\u6808\u5e95\uff09\u5143\u7d20\u5230\u53d8\u91cfe\u3002  </li> </ul>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#remove","title":"remove","text":"<p>\u6709\u65f6\u5019\uff0c\u4f60\u4e0d\u77e5\u9053\u8981\u4ece\u5217\u8868\u4e2d\u5220\u9664\u7684\u503c\u6240\u5904\u7684\u4f4d\u7f6e\u3002 \u5982\u679c\u4f60\u53ea\u77e5\u9053\u8981\u5220\u9664\u7684\u5143\u7d20\uff08\u7684\u503c\uff09\uff0c\u53ef\u8c03\u7528 <code>list.remove(e)</code> \u65b9\u6cd5\u3002</p> <p>Remove first occurrence of value. Raises ValueError if the value is not present.</p> <pre><code>&gt;&gt;&gt; if e in l1:\n...     l1.remove(e)\n...     print(l1)\n... else:\n...     print(\"{} not in list\".format(e))\n</code></pre> <p>\u5f53 e=4 \u5728\u5217\u8868\u4e2d\u65f6\uff0c\u88ab\u79fb\u9664\uff1b\u5f53 e=9 \u4e0d\u5728\u5217\u8868\u4e2d\u65f6\uff0c\u6253\u5370\u63d0\u793a\u4e0d\u5728\u5217\u8868\u4e2d\u3002</p>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#slice","title":"slice","text":"<p>\u5207\u7247\u7684\u5b8c\u6574\u683c\u5f0f\u662f <code>[start:stop:step]</code>\uff0c\u5bf9\u5e94 slice \u51fd\u6570\u7684\u5b9a\u4e49\u3002  </p> <p>\u4e00\u822c\u7701\u7565\u9ed8\u8ba4step=1\uff0c\u7b80\u5199\u4e3a\u4e00\u4e2a\u5192\u53f7\u533a\u95f4\u5f62\u5f0f <code>[start:stop]</code>\u3002 \u751a\u81f3\u8fdestart\u548cstop\u90fd\u53ef\u4e0d\u6307\u5b9a\uff0c\u7b80\u5199\u4e00\u4e2a\u5192\u53f7\u5f62\u5f0f <code>[:]</code>\uff08\u7b49\u4ef7\u4e8e <code>[::]</code>\uff09\u3002  </p> <p>a = <code>[1,2,3,4,5,6,7]</code>\uff0c\u53d6\u5207\u7247 <code>a[1:3]</code> \u7d22\u5f15\u8303\u56f4 = [1,3)\uff0c\u53d6\u51fa\u7684\u5b50\u96c6\u4e3a <code>[2, 3]</code>\u3002</p> <pre><code>&gt;&gt;&gt; a=[1,2,3,4,5,6,7]\n&gt;&gt;&gt; a[1:3]\n[2, 3]\n</code></pre> <p><code>a[:4]</code>\uff1a\u7701\u7565\u5207\u7247\u5f00\u59cb\u7d22\u5f15\uff0c\u9ed8\u8ba4\u4e3a0\uff0c\u76f8\u5f53\u4e8e <code>a[0:4]</code>\uff0c\u53d6\u503c a[0]~a[3]\u3002</p> <pre><code>&gt;&gt;&gt; a[:4]\n[1, 2, 3, 4]\n</code></pre> <p><code>a[4:]</code>\uff1a\u7701\u7565\u5207\u7247\u7ed3\u675f\u7d22\u5f15\uff0c\u9ed8\u8ba4\u4e3alen\uff0c\u76f8\u5f53\u4e8e <code>a[4:len(a)]</code>\uff0c\u53d6\u503c a[4]~a[len(a)-1]\u3002</p> <pre><code>&gt;&gt;&gt; a[4:]\n[5, 6, 7]\n</code></pre> <p><code>a[:]</code>\uff1a\u7701\u7565\u5207\u7247\u5f00\u59cb\u548c\u7ed3\u675f\u7d22\u5f15\uff0c\u76f8\u5f53\u4e8e <code>a[0:len(a)]</code>\uff0c\u53d6\u503c a[0]~a[len(a)-1]\u3002</p> <pre><code>&gt;&gt;&gt; a[:] # \u9ed8\u8ba4\u6b65\u957f\u4e3a1\uff0c\u7b49\u6548\u4e8e a[::]\u3001a[::1]\n[1, 2, 3, 4, 5, 6, 7]\n\n&gt;&gt;&gt; a[::2] # \u6307\u5b9a\u6b65\u957f\u4e3a2\uff0c\u53d6\u6240\u6709\u5076\u6570\u7d22\u5f15\u4f4d\u7f6e\u7684\u503c\n[1, 3, 5, 7]\n\n&gt;&gt;&gt; a[1::2] # \u6307\u5b9a\u6b65\u957f\u4e3a2\uff0c\u6307\u5b9a\u8d77\u59cb\u7d22\u5f15\u4e3a1\uff0c\u53d6\u6240\u6709\u5947\u6570\u7d22\u5f15\u4f4d\u7f6e\u7684\u503c\n[2, 4, 6]\n</code></pre> <p>\u8fd8\u6709\u4e00\u79cd\u7279\u6b8a\u7684\u7528\u6cd5\uff1a\u4f7f\u7528 <code>a[::-1]</code> \u6307\u5b9a\u6b65\u957f\u4e3a-1\uff0c\u4ece\u540e\u5230\u524d\u8bfb\u53d6\u751f\u6210\u5217\u8868a\u7684\u53cd\u8f6c\u526f\u672c\uff1a</p> <pre><code>&gt;&gt;&gt; a[::-1]\n[7, 6, 5, 4, 3, 2, 1]\n&gt;&gt;&gt; a # \u8bfb\u53d6\u5207\u7247\u4e0d\u5f71\u54cd\u539f\u5217\u8868\n[1, 2, 3, 4, 5, 6, 7]\n</code></pre> <p>\u5982\u679c\u8c03\u7528 <code>reverse</code> \u5219\u5c06\u539f\u5217\u8868\u6c38\u4e45\u7ffb\u8f6c\u4e86\uff1a</p> <pre><code>&gt;&gt;&gt; a.reverse()\n&gt;&gt;&gt; a\n[7, 6, 5, 4, 3, 2, 1]\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u7528\u5185\u7f6e\u7684 slice \u51fd\u6570\u6307\u5b9a start\u3001stop \u548c step\uff0c\u6784\u9020\u5207\u7247\u7d22\u5f15\uff0c\u5bf9\u5e8f\u5217\u8fdb\u884c\u5207\u7247\u53d6\u503c\u3002</p> <pre><code>slice(start, stop[, step])\n</code></pre> <p>\u8fd9\u6837\u4f7f\u5f97\u5207\u7247\u8303\u56f4\u53ef\u7f16\u7a0b\u5b9a\u5236\u5316\uff0c\u66f4\u7075\u6d3b\u7684\u622a\u53d6\u5b50\u96c6\u3002</p> <pre><code>&gt;&gt;&gt; s = slice(1,3)\n&gt;&gt;&gt; a[s] # \u7b49\u6548\u4e8e a[1:3] \u548c a[1:3:1]\n[2, 3]\n</code></pre> <p>\u7279\u6b8a\u5730\u6709 <code>slice(None)</code>\uff0c\u8fde\u8d77\u59cb\u7d22\u5f15 start \u90fd\u7701\u7565\uff0c\u7b49\u4ef7\u4e8e\u5192\u53f7 <code>:</code>\uff0c\u8868\u793a\u4ece\u5934\u5230\u5c3e\u3002</p> <pre><code>&gt;&gt;&gt; s=slice(None)\n&gt;&gt;&gt; a[s]\n[1, 2, 3, 4, 5, 6, 7]\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#copy_slice","title":"copy slice","text":"<p>\u56fe\u89e3LeetCode\u521d\u7ea7\u7b97\u6cd5\u63d2\u5165\u6392\u5e8f\u4e2d\uff0c\u7528\u5230\u4e86Python\u7684\u5207\u7247\u8d4b\u503c\u3002</p> <ol> <li>\u4ece\u524d\u5b50\u5411\u91cf\u5207\u7247 [0:right]\uff08\u7ed3\u675f\u7d22\u5f15\u4e3a right-1\uff09 \u4e2d\u67e5\u627e\u6bd4\u53f3\u5b50\u5411\u91cf\u5f53\u524d\u9996\u5143\u7d20 target \u5927\u7684\u7d22\u5f15 left\uff1b  </li> <li> <p>\u5c06\u4ece left \u5f00\u59cb\u6bd4 right \u5927\u7684\u5207\u7247 [left:right]\uff08\u4e0d\u5305\u62ec right \u5bf9\u5e94\u7684 target \u5143\u7d20\uff09\u6574\u4f53\u5411\u53f3\u79fb\u52a8\u4e00\u4f4d\uff1b  </p> <p>right \u7684\u503c\u63d0\u524d\u6682\u5b58\u5230 target \u4e2d\u4e86\uff0cright \u4f4d\u7f6e\u5c06\u88ab\u53f3\u79fb\u5360\u7528\uff0c\u5de6\u8fb9 left \u4f4d\u7f6e\u817e\u51fa\u63d2\u5165 target \u503c\u3002</p> </li> </ol> <pre><code>def insertionSort(iList: list) -&gt; list:\n    if len(iList) &lt;= 1:\n        return iList\n    for right in range(1, len(iList)):\n        target = iList[right]\n        for left in range(0, right):\n            if target &lt;= iList[left]:\n                iList[left+1:right+1] = iList[left:right] #\u4f7f\u7528Python\u7684\u5207\u7247\u8d4b\u503c\n                iList[left] = target\n                break\n        # print(\"\u7b2c %d \u8f6e\u6392\u5e8f\u7ed3\u679c:\" %(right), end=\"\")\n        # print(iList)\n    return iList\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#copy_list","title":"copy list","text":"<p>list \u662f mutable sequence\uff0c\u5c06\u5217\u8868\u8d4b\u7ed9\u65b0\u7684\u53d8\u91cf\u65f6\uff0c\u65b0\u7684\u53d8\u91cf\u5e76\u4e0d\u4f1a\u6267\u884c\u6df1\u62f7\u8d1d\uff0c\u800c\u5c06\u6307\u5411\u540c\u4e00\u4e2a\u539f\u59cb\u5217\u8868\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5728\u4e0d\u4f7f\u7528\u5207\u7247\uff08\u526f\u672c\uff09\u7684\u60c5\u51b5\u4e0b\u590d\u5236\u5217\u8868\u64cd\u4f5c\u7684\u975e\u9884\u671f\u707e\u96be\u6027\u540e\u679c\uff1a</p> <pre><code># \u670b\u53cb\u548c\u6211\u76f8\u540c\u7684\u7f8e\u98df\u7231\u597d\nmy_foods = ['pizza', 'falafel', 'carrot cake']\n\nfriend_foods = my_foods\n\n# \u5b9a\u5236\u6211\u548c\u670b\u53cb\u5404\u81ea\u559c\u6b22\u7684\u7f8e\u98df\nmy_foods.append('cannoli')\nfriend_foods.append('ice cream')\n\nprint(\"My favorite foods are:\")\nprint(my_foods)\nprint(\"\\nMy friend's favorite foods are:\")\nprint(friend_foods)\n</code></pre> <p>\u5982\u679c\u540e\u7eed\u8fc7\u7a0b\u5904\u7406\u4e0d\u60f3\u5f71\u54cd\u539f\u4ef6\uff0c\u53ef\u8003\u8651\u62f7\u8d1d\u539f\u59cb\u5217\u8868\u7684\u526f\u672c\uff0c\u7136\u540e\u9488\u5bf9\u526f\u672c\u64cd\u4f5c\u3002 \u5982\u679c\u9700\u8981\u6839\u636e\u65e2\u6709\u5217\u8868\u521b\u5efa\u5168\u65b0\u7684\u5217\u8868\uff0c\u9664\u4e86\u53ef\u4ee5\u8c03\u7528\u6e90\u5217\u8868\u7684 <code>copy</code> \u51fd\u6570\u521b\u5efa\u526f\u672c\u5916\uff0c\u4e5f\u53ef\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u6574\u4e2a\u5217\u8868\u7684\u5207\u7247\uff08<code>[:]</code>\uff09\uff0c\u7136\u540e\u8d4b\u503c\u7ed9\u65b0\u5217\u8868\u53d8\u91cf\uff0c\u5373\u8fbe\u76ee\u7684\u3002</p> <pre><code>&gt;&gt;&gt; b=a[:] # \u6df1\u5ea6\u590d\u5236 a \u7684\u526f\u672c\n&gt;&gt;&gt; b\n[1, 2, 3, 4, 5, 6, 7]\n&gt;&gt;&gt; b.pop(0)\n1\n&gt;&gt;&gt; b # b \u5f39\u51fa\u961f\u9996\u5143\u7d20\n[2, 3, 4, 5, 6, 7]\n&gt;&gt;&gt; a # b \u7684\u6539\u52a8\u4e0d\u5f71\u54cd a\uff0ca \u4e0d\u53d8\n[1, 2, 3, 4, 5, 6, 7]\n</code></pre> <p>\u5177\u4f53\u5230\u4e0a\u8ff0\u5b9a\u5236\u7f8e\u98df\u6e05\u5355\u6848\u4f8b\u4e2d\uff0c\u62f7\u8d1d\u4e00\u4efd\u6211\u7684\u7f8e\u98df\u6e05\u5355\uff0c\u526f\u672c\u4f5c\u4e3a\u670b\u53cb\u81ea\u5df1\u7684\u7f8e\u98df\u6e05\u5355\uff0c\u518d\u8fdb\u884c\u5b9a\u5236\u5373\u7b26\u5408\u9884\u671f\uff1a</p> <pre><code># \u62f7\u8d1d\u4e00\u4efd\u6211\u7684\u7f8e\u98df\u6e05\u5355\uff0c\u526f\u672c\u4f5c\u4e3a\u670b\u53cb\u81ea\u5df1\u7684\u7f8e\u98df\u6e05\u5355\nfriend_foods = my_foods[:] # my_foods.copy()\n\n# \u57fa\u4e8e\u6211\u548c\u670b\u53cb\u5404\u81ea\u7684\u7f8e\u98df\u6e05\u5355\uff0c\u5f00\u59cb\u5b9a\u5236\n</code></pre> <p>\u4fee\u6539\u524d\uff0c\u6307\u5411\u590d\u7528 friend_foods is my_foods = True\uff1b\u4fee\u6539\u540e\uff0c\u62f7\u8d1d\u89e3\u8026 friend_foods is my_foods = False\u3002</p> <p>\u5bf9\u4e8e\u5217\u8868\uff0c\u5f62\u53c2\u548c\u5b9e\u53c2\u8fd9\u4e24\u4e2a\u53d8\u91cf\u5c06\u6307\u5411\u540c\u4e00\u4e2a\u5217\u8868\uff0c\u76f8\u5f53\u4e8eC\u8bed\u8a00\u4e2d\u7684\u5f15\u7528\u6216\u6307\u9488\u4f20\u53c2\uff0c\u51fd\u6570\u5185\u90e8\u5bf9\u8be5\u53d8\u91cf\u7684\u64cd\u4f5c\u5c06\u76f4\u63a5\u5f71\u54cd\u539f\u59cb\u53d8\u91cf\u3002</p> <pre><code>def try_to_change_list1(l):\n    l = list(range(6)) # \u5f62\u53c2\u53e6\u6709\u6240\u6307\uff0c\u4e0e\u5b9e\u53c2\u5206\u79bb\uff0c\u4e0d\u5f71\u54cd\u539f\u4ef6\n\ndef try_to_change_list2(l):\n    l.append(6) # \u4fee\u6539\u5f62\u53c2\u6240\u6307\uff0c\u76f4\u63a5\u5f71\u54cd\u539f\u4ef6\n\nl = list(range(5))\ntry_to_change_list1(l)\nprint(l)\n\ntry_to_change_list2(l)\nprint(l)\n</code></pre> <p>\u5982\u679c\u4f20\u5165\u5217\u8868\uff0c\u53ea\u662f\u60f3\u770b\u770b\u51fd\u6570\u5904\u7406\u7684\u7ed3\u679c\uff0c\u800c\u4e0d\u5e0c\u671b\u5f71\u54cd\u5916\u9762\u7684\u539f\u59cb\u5217\u8868\uff0c\u53ef\u4ee5\u8003\u8651\u901a\u8fc7\u5168\u5207\u7247\u62f7\u8d1d\uff08[:] \u6216 copy\uff09\u4f20\u5165\u526f\u672c\u3002</p> <pre><code>def try_to_change_list(l):\n    l.append(6)\n\nl = list(range(5))\nm = l[:] # l.copy()\ntry_to_change_list(m)\nprint(l)\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#refs","title":"refs","text":"<p>Python\u5207\u7247Slice python\u4e2d\u5207\u7247\uff08Slice\uff09\u64cd\u4f5c\u7b26 \u5207\u7247\uff08Slice\uff09\u5728python\u4e2d\u7684\u8fd0\u7528 Python\u9ad8\u7ea7\u7279\u6027\u2014\u2014\u5207\u7247\uff08Slice\uff09 </p>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#stack","title":"stack","text":"<p>list \u6a21\u62df\u961f\u5217 FIFO \u7684\u60ef\u7528\u6cd5\uff1a</p> <ul> <li>\u5c3e\u90e8\u5165\u5217\uff1alist.append(e)</li> <li>\u5934\u90e8\u51fa\u5217\uff1ae=l.pop(0)</li> </ul> <p>list \u6a21\u62df\u6808\u7684 LIFO \u60ef\u7528\u6cd5\uff1a</p> <ul> <li>\u5c3e\u90e8\u538b\u6808\uff1alist.append(e)</li> <li>\u8bbf\u95ee\u5c3e\u90e8\uff1ae=list[len-1]</li> <li>\u5c3e\u90e8\u51fa\u6808\uff1ae=list.pop()</li> <li>\u66ff\u6362\uff1a\u5148\u8bfb\u53d6\u6309\u9700\u4fee\u6539\uff0c\u518d pop \u540e append</li> </ul> <p>\u53e6\u5916\u4e5f\u53ef\u5355\u5411\u8bbf\u95ee\u53cc\u7aef\u961f\u5217\uff08collections.<code>deque</code>\uff09\u9075\u5faa\u6808\u7684 LIFO \u7528\u6cd5\u3002</p> <p>\u5982\u679c\u9700\u8981\u9891\u7e41\u5bf9\u5e8f\u5217\u505a\u5148\u51fa\u5148\u8fdb\uff08FIFO\uff09\u7684\u64cd\u4f5c\uff0c\u53cc\u7aef\u961f\u5217\uff08collections.deque\uff09\u7684\u901f\u5ea6\u5e94\u8be5\u4f1a\u66f4\u5feb\u3002 \u9664\u4e86\u6807\u51c6\u7684 append/pop \u63a5\u53e3\uff0cdeque \u8fd8\u4e13\u95e8\u63d0\u4f9b\u4e86 <code>appendleft</code>/<code>popleft</code> \u63a5\u53e3\u3002</p> <ul> <li>\u53cc\u7aef\u961f\u5217\u6807\u51c6\u60ef\u7528\u6cd5\uff1a\u5165\u961f enqueue - <code>dq.append(e)</code>, \u51fa\u961f dequeue - <code>e=dq.popleft()</code>\u3002</li> </ul>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#listcomp","title":"listcomp","text":"<p>list comprehension : A compact way to process all or part of the elements in a sequence and return a list with the results.</p> <p>5.1.3. List Comprehensions: List comprehensions provide a concise way to create lists. Common applications are to make new lists where each element is the result of some operations applied to each member of another sequence or iterable, or to create a subsequence of those elements that satisfy a certain condition.</p> <p>listcomp (\u5217\u8868\u89e3\u6790\u5f0f) \u662f\u904d\u5386\u4e00\u4e2a\u5217\u8868\u4e2d\u7684\u5143\u7d20\uff0c\u8fc7\u6ee4\u7b5b\u9009\u51fa\u7b26\u5408\u4e00\u5b9a\u6761\u4ef6\u7684\u5143\u7d20\uff0c\u6267\u884c\u5fc5\u8981\u5730\u8f6c\u6362\u540e\u8ffd\u52a0\u5230\u53e6\u4e00\u4e2a\u5217\u8868\u5e76\u8fd4\u56de\u8fd9\u4e2a\u65b0\u7684\u5217\u8868\u7684\u8868\u8fbe\u5f0f\u3002  </p> <p>\u5217\u8868\u89e3\u6790\u5f0f\u5f62\u5982 <code>expression comp_for [comp_if]</code>\uff0c\u6216\u66f4\u6e05\u6670\u4e00\u70b9 <code>expr for iter_var in iterable [if cond_expr]</code>\uff0c\u5176\u4e2d\u7684\u6761\u4ef6\u8fc7\u6ee4\u5668 if \u8bed\u53e5\u662f\u53ef\u9009\u7684\u3002\u5982\u679c\u6ca1\u6709 if \u8fc7\u6ee4\uff0c\u5219\u9ed8\u8ba4\u904d\u5386\u6240\u6709\u5143\u7d20\u6267\u884c\u8f6c\u6362\u3002</p> <p>The if clause is optional. If omitted, all elements in comp_for are processed.</p>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#without_if","title":"without if","text":"<p><code>x in y</code> \u7684\u5217\u8868\u89e3\u6790\u7b49\u6548\u8868\u8fbe\u5f0f\uff1a<code>any(x is e or x == e for e in y)</code>\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8bfor\u5faa\u73af\u904d\u5386\u539f\u59cb\u53ef\u679a\u4e3e\u5bf9\u8c61\uff0c\u5bf9\u904d\u5386\u5143\u7d20value\u6267\u884c value**2 \u8ba1\u7b97\u5e73\u65b9\uff0c\u6574\u4f53\u6548\u679c\u662f\u751f\u62101\u523010\u7684\u5e73\u65b9\u503c\u5217\u8868\u3002</p> <pre><code>&gt;&gt;&gt; squares = [value**2 for value in range(1,11)]\n&gt;&gt;&gt; print(squares)\n[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n</code></pre> <p>\u4ee5\u4e0b\u521b\u5efa\u4e00\u4e2a\u5217\u8868\uff0c\u5217\u8868\u5143\u7d20\u662f\u5143\u7ec4\uff0c\u5305\u62ec\u5e73\u65b9\u6839\u548c\u5e73\u65b9\uff1a</p> <pre><code># create a list of 2-tuples like (number, square)\n&gt;&gt;&gt; [(x, x**2) for x in range(1,11)]\n[(1, 1), (2, 4), (3, 9), (4, 16), (5, 25), (6, 36), (7, 49), (8, 64), (9, 81), (10, 100)]\n</code></pre> <p>\u6765\u770b\u4e00\u4e2a\u65e5\u5e38\u751f\u6d3b\u4e2d\u57fa\u4e8e\u5217\u8868\u89e3\u6790\u7684\u5b9e\u9645\u5e94\u7528\u6848\u4f8b\u3002</p> <p>\u9700\u6c42\uff1aPDF\u6587\u6863\uff0c\u5b9e\u9645\u9875\u6570\u548c\u6587\u6863\u6807\u8bb0\u9875\u6570\u5b58\u5728\u8bef\u5dee\uff0c\u5982\u4f55\u5feb\u901f\u8ba1\u7b97\u6bcf\u4e00\u7ae0\u8282\u7684\u51c6\u786e\u8df3\u8f6c\u9875\u7801\uff1f \u65b9\u6848\uff1a\u5148\u770b\u770b\u6807\u8bb0\u7b2c\u4e00\u9875\u548c\u5b9e\u9645\u7b2c\u4e00\u9875\u4e4b\u95f4\u7684\u504f\u79fboffset\u3002\u7136\u540e\uff0c\u901a\u8fc7TOC\u67e5\u770b\u6bcf\u7ae0\u7684\u6807\u8bb0\u9875\u7801\uff0c\u904d\u5386\u52a0\u4e0a\u504f\u79fb\u91cf\u5373\u53ef\u5f97\u5230\u6bcf\u7ae0\u7684\u5b9e\u9645\u8df3\u8f6c\u9875\u7801\u3002</p> <p>Adding K to each element in a list of integers</p> <pre><code>page_no = [3,11,45,65,69,85,109,127,141,163,191,195,203,227]\noffset = 25\ncorrect_page_no = [p + offset for p in page_no]\n</code></pre> <p>\u4ee5\u4e0a\u4f7f\u7528\u5217\u8868\u63a8\u5bfc\u5bf9\u9875\u6570\u8fdb\u884c\u77eb\u6b63\uff0c\u4e5f\u53ef\u4f7f\u7528 map \u7ed3\u5408 lambda \u7684\u51fd\u6570\u5f0f\u7f16\u7a0b\u65b9\u5f0f\u5b9e\u73b0\u540c\u6837\u7684\u76ee\u7684\u3002</p> <pre><code>correct_page_no=list(map(lambda x:x+offset, page_no))\n</code></pre> <p>\u73b0\u4ee3 Python \u66f4\u591a\u5730\u63a8\u8350\u91c7\u7528\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u8303\u5f0f\uff0c\u5efa\u8bae\u5c3d\u91cf\u4e0d\u91c7\u7528\u8fd9\u79cd\u51fd\u6570\u5f0f\u7f16\u7a0b\u65b9\u5f0f\u3002 \u76f8\u6bd4\u800c\u8a00\uff0c\u5217\u8868\u63a8\u5bfc\uff08list comprehension\uff09\u5b9e\u73b0\u65b9\u5f0f\u4e66\u5199\u7b80\u6d01\u4e14\u53ef\u8bfb\u6027\u66f4\u9ad8\uff08concise and readable\uff09\u3002</p>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#with_if","title":"with if","text":"<p>\u8fd8\u53ef\u4ee5\u9488\u5bf9 for \u5faa\u73af\u6dfb\u52a0\u8fc7\u6ee4\u6761\u4ef6\uff0c\u7b5b\u9009\u51fa\u7b26\u5408\u6761\u4ef6\u7684\u5143\u7d20\uff0c\u518d\u6267\u884c\u590d\u5408\u8ba1\u7b97\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u5c06\u5217\u8868\u89e3\u6790\u8fd4\u56de\u7684\u5143\u7d20\u4f20\u5165\u4e09\u76ee\u8fd0\u7b97\uff0c\u5224\u65ad\u5076\u6570\u4e3a1\uff0c\u5947\u6570\u4e3a0\uff0c\u8fd4\u56de\u5947\u5076\u6027\u6807\u8bc6\u5217\u8868\u3002</p> <pre><code>&gt;&gt;&gt; [1 if e%2==0 else 0 for e in range(1,11)]\n[0, 1, 0, 1, 0, 1, 0, 1, 0, 1]\n</code></pre> <p>\u4ee5\u4e0b\u8fd8\u662f\u5217\u8868\u89e3\u6790\u7ed3\u5408\u4e09\u76ee\u8fd0\u7b97\uff0c\u904d\u5386range(1,8)\uff0c\u5bf9\u4e8e\u22644\u7684\u6570\u66ff\u6362\u4e3a1\uff0c\u751f\u6210\u65b0\u5217\u8868\u3002</p> <pre><code>&gt;&gt;&gt; [e if e&gt;4 else 1 for e in range(1,8)]\n[1, 1, 1, 1, 5, 6, 7]\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u901a\u8fc7\u5217\u8868\u63a8\u5bfc\u5c06\u6307\u5b9a\u6a21\u5757\u4e2d\u4ee5\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\u975e\u4f9b\u5916\u90e8\u4f7f\u7528\u7684\u540d\u79f0\u8fc7\u6ee4\u6389\uff1a</p> <pre><code>&gt;&gt;&gt; import copy\n&gt;&gt;&gt; [n for n in dir(copy) if not n.startswith('_')]\n['Error', 'copy', 'deepcopy', 'dispatch_table', 'error']\n&gt;&gt;&gt; \n&gt;&gt;&gt; import string\n&gt;&gt;&gt; [n for n in dir(string) if not n.startswith('_')]\n['Formatter', 'Template', 'ascii_letters', 'ascii_lowercase', 'ascii_uppercase', 'capwords', 'digits', 'hexdigits', 'octdigits', 'printable', 'punctuation', 'whitespace']\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#multilayer","title":"multilayer","text":"<p>listcomp \u8fd8\u652f\u6301 multi-layers loop\u3002</p> <p>\u4ee5\u4e0b\u7528\u4e24\u91cd for \u5faa\u73af\u5c55\u5f00\u5217\u8868\u7684\u5217\u8868\uff1a</p> <pre><code>&gt;&gt;&gt; vec = [[1,2,3], [4,5,6], [7,8,9]]\n&gt;&gt;&gt; [num for elem in vec for num in elem] # from left to right\n[1, 2, 3, 4, 5, 6, 7, 8, 9]\n</code></pre> <p>\u4ee5\u4e0b\u7528\u4e24\u91cd for \u5faa\u73af\u5c06\u4e24\u4e2a\u5217\u8868\u7684\u5143\u7d20\u6392\u5217\u7ec4\u5408\u6210 tuple \u5e8f\u5217\uff1a</p> <pre><code>&gt;&gt;&gt; [(x, y) for x in [1,2,3] for y in [4,5,6]]\n[(1, 4), (1, 5), (1, 6), (2, 4), (2, 5), (2, 6), (3, 4), (3, 5), (3, 6)]\n\n# \u6ce8\u610f\uff1a\u4e0e zip \u7684\u533a\u522b\uff01\n&gt;&gt;&gt; [*zip([1,2,3],[4,5,6])]\n[(1, 4), (2, 5), (3, 6)]\n</code></pre> <p>\u4e5f\u53ef\u5728\u5faa\u73af\u540e\u9762\u589e\u52a0\u8fc7\u6ee4\u6761\u4ef6\uff1a</p> <pre><code>&gt;&gt;&gt; [(x, y) for x in [1,2,3] for y in [3,1,4] if x != y]\n[(1, 3), (1, 4), (2, 3), (2, 1), (2, 4), (3, 1), (3, 4)]\n</code></pre>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#nested","title":"Nested","text":"<p>The initial expression in a list comprehension can be any arbitrary expression, including another list comprehension.</p> <p>\u4ee5\u4e0b matrix \u5b9a\u4e49\u4e86\u4e00\u4e2a 3x4 \u7684\u77e9\u9635\uff0c\u7136\u540e\u901a\u8fc7\u5d4c\u5957 listcomp \u5b9e\u73b0\u77e9\u9635\u7684\u8f6c\u7f6e\uff08transpose\uff09\u3002</p> <pre><code>&gt;&gt;&gt; matrix = [\n...     [1, 2, 3, 4],\n...     [5, 6, 7, 8],\n...     [9, 10, 11, 12],\n... ]\n&gt;&gt;&gt; [[row[i] for row in matrix] for i in range(4)]\n[[1, 5, 9], [2, 6, 10], [3, 7, 11], [4, 8, 12]]\n</code></pre> <p>\u7b49\u6548\u4e8e for \u5faa\u73af\u52a0\u4e00\u5c42 listcomp:</p> <pre><code>&gt;&gt;&gt; transposed = []\n&gt;&gt;&gt; for i in range(4):\n...     transposed.append([row[i] for row in matrix])\n...\n&gt;&gt;&gt; transposed\n[[1, 5, 9], [2, 6, 10], [3, 7, 11], [4, 8, 12]]\n</code></pre> <p>\u5f53\u7136\uff0c\u4ee5\u4e0a\u6700\u7b80\u6d01\u7684\u7b49\u6548\u5b9e\u73b0\u65b9\u5f0f\u662f\u4f7f\u7528\u661f\u53f7\u89e3\u5f15\u7528\u642d\u914dzip\uff1a<code>list(zip(*matrix))</code>\u3002</p>","tags":["list"]},{"location":"blog/20191204/6-builtins.list/#refs_1","title":"refs","text":"<p>\u5173\u4e8e dict comprehension/set comprehension \u7b49\u8bdd\u9898\uff0c\u53c2\u8003 6.2.4. Displays for lists, sets and dictionaries\u3002</p> <ul> <li>python\u77e5\u8bc6\u70b9: \u5217\u8868\u89e3\u6790 </li> <li>python-\u5217\u8868\u89e3\u6790\u4e4bif </li> <li>Python\u5217\u8868\u89e3\u6790\uff08\u5217\u8868\u63a8\u5bfc\u5f0f\uff09 </li> <li>\u5f62\u8c61\u5730\u89e3\u91ca Python \u4e2d\u7684\u5217\u8868\u89e3\u6790 </li> <li>\u63a8\u5bfc\u5f0f Comprehension</li> </ul>","tags":["list"]},{"location":"blog/20191204/7-builtins.tuple/","title":"python\u5185\u7f6e\u6a21\u5757\u4e4b\u5143\u7ec4(tuple)","text":"<p>Python\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u5143\u7ec4\uff08builtins.tuple\uff09\u7684\u57fa\u672c\u7528\u6cd5\u3002</p> <p>tuple\uff08\u5143\u7ec4\uff09</p> <p>\u5217\u8868\u662f\u53ef\u4ee5\u4fee\u6539\u7684\uff0c\u975e\u5e38\u9002\u5408\u7528\u4e8e\u5b58\u50a8\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u53ef\u80fd\u53d8\u5316\u7684\u6570\u636e\u96c6\u3002 \u7136\u800c\uff0c\u6709\u65f6\u5019\u4f60\u9700\u8981\u521b\u5efa\u4e00\u7cfb\u5217\u4e0d\u53ef\u4fee\u6539\u7684\u5143\u7d20\uff0c \u5143\u7ec4\u53ef\u4ee5\u6ee1\u8db3\u8fd9\u79cd\u9700\u6c42\u3002 Python\u5c06\u4e0d\u80fd\u4fee\u6539\u7684\u503c\u79f0\u4e3a<code>\u4e0d\u53ef\u53d8\u7684</code>\uff0c\u800c\u4e0d\u53ef\u53d8\u7684\u5217\u8868\u88ab\u79f0\u4e3a\u5143\u7ec4\u3002  </p>","tags":["tuple"]},{"location":"blog/20191204/7-builtins.tuple/#help","title":"help","text":"<pre><code>&gt;&gt;&gt; help(tuple)\n\nHelp on class tuple in module builtins:\n\nclass tuple(object)\n |  tuple(iterable=(), /)\n |\n |  Built-in immutable sequence.\n |\n |  If no argument is given, the constructor returns an empty tuple.\n |  If iterable is specified the tuple is initialized from iterable's items.\n |\n |  If the argument is a tuple, the return value is the same object.\n |\n |  Built-in subclasses:\n |      asyncgen_hooks\n |      UnraisableHookArgs\n</code></pre>","tags":["tuple"]},{"location":"blog/20191204/7-builtins.tuple/#demo","title":"demo","text":"<pre><code>&gt;&gt;&gt; range1=range(1,8)\n&gt;&gt;&gt; tuple1=tuple(range1)\n&gt;&gt;&gt; tuple1\n(1, 2, 3, 4, 5, 6, 7)\n&gt;&gt;&gt; tuple1[-1]\n7\n&gt;&gt;&gt; tuple1[-1]=8\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nTypeError: 'tuple' object does not support item assignment\n&gt;&gt;&gt;\n</code></pre>","tags":["tuple"]},{"location":"blog/20191204/7-builtins.tuple/#init","title":"init","text":"<p>\u5143\u7ec4\u770b\u8d77\u6765\u72b9\u5982\u5217\u8868\uff0c\u4f46\u4f7f\u7528\u5706\u62ec\u53f7\u800c\u4e0d\u662f\u65b9\u62ec\u53f7\u6765\u6807\u8bc6\u3002</p> <ol> <li><code>t=tuple()</code>: \u6784\u9020\u4e00\u4e2a\u7a7a\u5143\u7ec4\u5bf9\u8c61\u3002  </li> <li><code>t=()</code>\uff1a\u5c0f\u62ec\u53f7\u5b9a\u4e49\u7a7a\u5143\u7ec4\u3002  </li> </ol> <p>\u591a\u4e2a\u5143\u7d20\u4e4b\u95f4\u4ee5\u9017\u53f7\u5206\u9694\uff0c\u4f8b\u5982 <code>t1=(1,2,3,4)</code>\u3002  </p> <p>\u5b9a\u4e49 tuple \u65f6\uff0c\u4e5f\u53ef\u4e0d\u52a0\u5c0f\u62ec\u53f7\uff1a</p> <pre><code>labels = 'first', 'middle', 'last'\ntype(labels) # &lt;class 'tuple'&gt;\nlabels # ('first', 'middle', 'last')\n</code></pre> <p>\u4ee5\u4e0b\u57fa\u4e8e\u5185\u7f6e\u51fd\u6570format\u3001str\u7684C printf\u683c\u5f0f\u5316\u548cf-string\u6253\u5370255\u7684\u4e09\u79cd\u5341\u516d\u8fdb\u5236\uff0c\u5728\u4e00\u884c\u4e2d\u7528\u9017\u53f7\u5206\u9694\uff0c\u8f93\u51fa tuple:</p> <pre><code>&gt;&gt;&gt; format(255, '#x'), format(255, 'x'), format(255, 'X')\n('0xff', 'ff', 'FF')\n\n&gt;&gt;&gt; '%#x' % 255, '%x' % 255, '%X' % 255\n('0xff', 'ff', 'FF')\n\n&gt;&gt;&gt; f'{255:#x}', f'{255:x}', f'{255:X}'\n('0xff', 'ff', 'FF')\n</code></pre> <p>\u5143\u7ec4\u652f\u6301\u57fa\u4e8e\u811a\u6807\u7d22\u5f15\u8bbf\u95ee\u5143\u7d20\uff08access through subscripted index\uff09\u3002</p>","tags":["tuple"]},{"location":"blog/20191204/7-builtins.tuple/#zip","title":"zip","text":"<pre><code>Help on class zip in module builtins:\n\nclass zip(object)\n |  zip(*iterables, strict=False) --&gt; Yield tuples until an input is exhausted.\n |\n |     &gt;&gt;&gt; list(zip('abcdefg', range(3), range(4)))\n |     [('a', 0, 0), ('b', 1, 1), ('c', 2, 2)]\n |\n |  The zip object yields n-length tuples, where n is the number of iterables\n |  passed as positional arguments to zip().  The i-th element in every tuple\n |  comes from the i-th iterable argument to zip().  This continues until the\n |  shortest argument is exhausted.\n</code></pre> <p>\u5185\u7f6e\u51fd\u6570 zip \u5c06\u4f20\u5165\u7684\u53ef\u8fed\u4ee3\u5e8f\u5217\uff0c\u6bcf\u4e2a\u5e8f\u5217\u9009\u53d6\u4e00\u4e2a\u5143\u7d20\u751f\u6210tuple\u3002</p> <pre><code>&gt;&gt;&gt; list(zip('abc', '123', [4,5,6]))\n[('a', '1', 4), ('b', '2', 5), ('c', '3', 6)]\n\n# \u7b2c\u4e00\u4e2a\u53c2\u6570\u591a\u51fa\u4e00\u4e2a\u5143\u7d20\n&gt;&gt;&gt; list(zip('abcd', '123', [4,5,6]))\n[('a', '1', 4), ('b', '2', 5), ('c', '3', 6)]\n\n# \u7b2c\u4e8c\u4e2a\u53c2\u6570\u591a\u51fa\u4e00\u4e2a\u5143\u7d20\n&gt;&gt;&gt; list(zip('abc', '1234', [4,5,6]))\n[('a', '1', 4), ('b', '2', 5), ('c', '3', 6)]\n\n# \u7b2c\u4e8c\u3001\u4e09\u4e2a\u53c2\u6570\u5404\u591a\u51fa\u4e00\u4e2a\u5143\u7d20\n&gt;&gt;&gt; list(zip('abc', '1234', [4,5,6,7]))\n[('a', '1', 4), ('b', '2', 5), ('c', '3', 6)]\n</code></pre> <p>\u4ee5\u4e0b\u662f\u5e94\u7528 zip \u51fd\u6570\u7684\u53e6\u5916\u4e00\u4e2a\u6848\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; labels = 'first', 'middle', 'last'\n&gt;&gt;&gt; full_name = 'Magnus Lie Hetland'\n&gt;&gt;&gt; names = full_name.split()\n&gt;&gt;&gt; for label, name in zip(labels, names):\n...     print('{}: {}'.format(label, name))\n...\nfirst: Magnus\nmiddle: Lie\nlast: Hetland\n</code></pre>","tags":["tuple"]},{"location":"blog/20191204/7-builtins.tuple/#expressions","title":"expressions","text":"<ul> <li><code>len(t)</code>: Return the number of elements in tuple t.  </li> <li><code>e in t</code>: Test e for membership in t.  </li> <li><code>e not in t</code>: Test e for non-membership in t.  </li> <li><code>for e in t</code>: enumerate elements in t.  </li> </ul>","tags":["tuple"]},{"location":"blog/20191204/7-builtins.tuple/#comparison","title":"comparison","text":"<p>Python \u4e2d\u652f\u6301\u76f4\u63a5\u5bf9\u6570\u503ctuple\u5e8f\u5217\u6bd4\u8f83\u5927\u5c0f\uff1a</p> <pre><code>&gt;&gt;&gt; t1=(1,3,5)\n&gt;&gt;&gt; t2=(2,4,6)\n&gt;&gt;&gt; t1&lt;t2\nTrue\n&gt;&gt;&gt; t3=(1,2,6)\n&gt;&gt;&gt; t1&lt;t3\nFalse\n</code></pre> <p>\u901a\u8fc7 sys \u83b7\u53d6 python \u7248\u672c\u53f7\uff1atuple(sys.version_info) = (3, 9, 6, 'final', 0)\uff0c\u53ef\u76f4\u63a5\u4e0e\u9884\u671f\u7248\u672ctuple\u8fdb\u884c\u6bd4\u8f83\u5339\u914d\u3002</p> <pre><code>tuple(sys.version_info) &gt; (3, 9, 6)\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0cPython \u4e2d\u4e5f\u652f\u6301\u76f4\u63a5\u5bf9\u6570\u503clist\u5e8f\u5217\u6bd4\u8f83\u5927\u5c0f\uff1a</p> <pre><code>&gt;&gt;&gt; l1=[1,3,5]\n&gt;&gt;&gt; l2=[2,4,6]\n&gt;&gt;&gt; l1&lt;l2\nTrue\n&gt;&gt;&gt; l3=[1,2,6]\n&gt;&gt;&gt; l1&lt;l3\nFalse\n</code></pre>","tags":["tuple"]},{"location":"blog/20191204/8-builtins.dict/","title":"python\u5185\u7f6e\u6a21\u5757\u4e4b\u6620\u5c04\u5b57\u5178(dict)","text":"<p>Python\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u6620\u5c04\u5b57\u5178\uff08builtins.dict\uff09\u7684\u57fa\u672c\u7528\u6cd5\u3002</p> <p>Mapping Types \u2014 dict</p> <p>\u5728Python\u4e2d\uff0c\u5b57\u5178\u662f\u4e00\u7cfb\u5217 <code>\u952e\u2014\u503c\u5bf9</code>\u3002</p> <p>\u6bcf\u4e2a\u952e\u90fd\u4e0e\u4e00\u4e2a\u503c\u76f8\u5173\u8054\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u952e\u6765\u8bbf\u95ee\u4e0e\u4e4b\u76f8\u5173\u8054\u7684\u503c\u3002 \u4e0e\u952e\u76f8\u5173\u8054\u7684\u503c\u53ef\u4ee5\u662f\u6570\u5b57\u3001\u5b57\u7b26\u4e32\u3001\u5217\u8868\u4e43\u81f3\u5b57\u5178\u3002 \u4e8b\u5b9e\u4e0a\uff0c\u53ef\u5c06\u4efb\u4f55Python\u5bf9\u8c61\u7528\u4f5c\u5b57\u5178\u4e2d\u7684\u503c\u3002  </p>","tags":["dict"]},{"location":"blog/20191204/8-builtins.dict/#help","title":"help","text":"<pre><code>&gt;&gt;&gt; help(dict)\n\nHelp on class dict in module builtins:\n\nclass dict(object)\n |  dict() -&gt; new empty dictionary\n |  dict(mapping) -&gt; new dictionary initialized from a mapping object's\n |      (key, value) pairs\n |  dict(iterable) -&gt; new dictionary initialized as if via:\n |      d = {}\n |      for k, v in iterable:\n |          d[k] = v\n |  dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs\n |      in the keyword argument list.  For example:  dict(one=1, two=2)\n |\n</code></pre>","tags":["dict"]},{"location":"blog/20191204/8-builtins.dict/#init_dict","title":"init dict","text":"<ol> <li><code>d=dict()</code>: \u6784\u9020\u4e00\u4e2a\u7a7a\u5b57\u5178\u5bf9\u8c61\u3002  </li> <li><code>d={}</code>\uff1a\u5927\u62ec\u53f7\u5b9a\u4e49\u7a7a\u5b57\u5178\u3002  </li> </ol> <p>\u5b57\u5178\u7684\u952e\u503c\u4ee5\u5192\u53f7\u5206\u9694\uff0c<code>d1={1:2}</code> \u7b49\u6548\u4e8e <code>d1=dict();d1[1]=2</code>\u3002 \u591a\u5bf9\u952e\u503c\u4ee5\u9017\u53f7\u5206\u9694\uff0c\u4f8b\u5982 <code>d1={1:2, 3:4}</code>\u3002  </p> <p>\u901a\u8fc7\u4f20\u5165 positional argument \u521d\u59cb\u5316\u5b57\u5178\uff1a</p> <pre><code>&gt;&gt;&gt; d1={1:2, 3:4}\n&gt;&gt;&gt; d1\n{1: 2, 3: 4}\n&gt;&gt;&gt; d1={1:'2', 3:4}\n&gt;&gt;&gt; d1\n{1: '2', 3: 4}\n</code></pre> <p>\u901a\u8fc7\u4f20\u5165 keyword argument \u521d\u59cb\u5316\u6784\u9020\u5b57\u5178\uff08keyword\u5fc5\u987b\u662f\u5b57\u7b26\u4e32\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; d = dict(k1=1, k2=2, k3=3)\n&gt;&gt;&gt; d\n{'k1': 1, 'k2': 2, 'k3': 3}\n</code></pre> <p>\u5b57\u5178\u652f\u6301\u57fa\u4e8e\u811a\u6807\u952e\u503c\u8bbf\u95ee\u503c\uff08access through subscripted index\uff09\u3002</p>","tags":["dict"]},{"location":"blog/20191204/8-builtins.dict/#expressions","title":"expressions","text":"<ul> <li><code>len(d)</code>: Return the number of elements in dict d.  </li> <li><code>e in d</code>: Test e for membership in d.keys.  </li> <li><code>e not in d</code>: Test e for non-membership in d.keys.  </li> <li><code>for e in d</code>: enumerate elements in d.keys.  </li> </ul>","tags":["dict"]},{"location":"blog/20191204/8-builtins.dict/#copy_dict","title":"copy dict","text":"<p>dict \u548c list \u90fd\u662f\u53ef\u53d8\u7684\uff08mutable\uff09\uff0c\u5c06\u5b57\u5178\u8d4b\u7ed9\u65b0\u7684\u53d8\u91cf\u65f6\uff0c\u65b0\u7684\u53d8\u91cf\u5e76\u4e0d\u4f1a\u6267\u884c\u6df1\u62f7\u8d1d\uff0c\u800c\u5c06\u6307\u5411\u540c\u4e00\u4e2a\u539f\u59cb\u5b57\u5178\u3002</p> <pre><code>d = {'k1':'v1', 'k2':'v2'}\nd2 = d\nd2 is d # True\n</code></pre> <p>\u5982\u679c\u9700\u8981\u6839\u636e\u65e2\u6709\u5b57\u5178\u521b\u5efa\u5168\u65b0\u7684\u5b57\u5178\uff0c\u53ef\u4ee5\u8c03\u7528\u6e90\u5b57\u5178\u7684 <code>copy</code> \u51fd\u6570\u521b\u5efa\u526f\u672c\u3002</p> <pre><code>d3 = d.copy()\nd3 is d # False\n</code></pre> <p>\u6ce8\u610f\uff1a\u5728\u5c06\u5b57\u5178\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u51fd\u6570\u540e\uff0c\u51fd\u6570\u5185\u90e8\u4fee\u6539\u5f62\u53c2\u6240\u6307\uff0c\u5c06\u76f4\u63a5\u5f71\u54cd\u539f\u4ef6\u3002</p>","tags":["dict"]},{"location":"blog/20191204/8-builtins.dict/#enumerate","title":"enumerate","text":"<pre><code>&gt;&gt;&gt; favorite_languages.keys()\ndict_keys(['jen', 'sarah', 'edward', 'phil'])\n&gt;&gt;&gt; favorite_languages.values()\ndict_values(['python', 'c', 'ruby', 'python'])\n</code></pre>","tags":["dict"]},{"location":"blog/20191204/8-builtins.dict/#keys","title":"keys","text":"<p>\u5728\u4e0d\u9700\u8981\u4f7f\u7528\u5b57\u5178\u4e2d\u7684\u503c\u65f6\uff0c\u65b9\u6cd5 <code>keys()</code> \u5f88\u6709\u7528\uff0c\u5b83\u8fd4\u56de\u952e\u5217\u8868\u3002</p> <p>\u904d\u5386\u5b57\u5178\u65f6\uff0c\u4f1a\u9ed8\u8ba4\u904d\u5386\u6240\u6709\u7684\u952e\u3002\u5982\u679c\u663e\u5f0f\u5730\u4f7f\u7528\u65b9\u6cd5 <code>keys()</code> \u53ef\u8ba9\u4ee3\u7801\u66f4\u5bb9\u6613\u7406\u89e3\u3002  </p> <p>\u5728\u8fd9\u79cd\u5faa\u73af\u4e2d\uff0c\u53ef\u4f7f\u7528\u5f53\u524d\u952e\u6765\u8bbf\u95ee\u4e0e\u4e4b\u76f8\u5173\u8054\u7684\u503c\u3002</p> <pre><code>&gt;&gt;&gt; # \u7b49\u6548\u4e8e for k in dict1.keys()\n&gt;&gt;&gt; for k in dict1:\n...     print('dict1[{0}]={1}'.format(k, dict1[k]))\n... \ndict1[k1]=1\ndict1[k2]=2\ndict1[k3]=3\ndict1[k4]=4\ndict1[k5]=5\ndict1[k6]=6\ndict1[k7]=7\n</code></pre>","tags":["dict"]},{"location":"blog/20191204/8-builtins.dict/#values","title":"values","text":"<p>\u5982\u679c\u4f60\u611f\u5174\u8da3\u7684\u4e3b\u8981\u662f\u5b57\u5178\u5305\u542b\u7684\u503c\uff0c\u53ef\u4f7f\u7528\u65b9\u6cd5 <code>values()</code>\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a\u503c\u5217\u8868\uff0c\u800c\u4e0d\u5305\u542b\u4efb\u4f55\u952e\u3002 \u53ef\u57fa\u4e8e <code>values()</code> \u8fd4\u56de\u7684\u5217\u8868\u6784\u9020\u96c6\u5408(set)\u6765\u5254\u9664\u91cd\u590d\u9879\u3002</p> <pre><code>&gt;&gt;&gt; favorite_languages = {\n...     'jen': 'python',\n...     'sarah': 'c',\n...     'edward': 'ruby',\n...     'phil': 'python',\n... }\n&gt;&gt;&gt; print(\"The following languages have been mentioned:\")\nThe following languages have been mentioned:\n&gt;&gt;&gt; for language in set(favorite_languages.values()):\n...     print(language.title())\n...\nRuby\nC\nPython\n</code></pre>","tags":["dict"]},{"location":"blog/20191204/8-builtins.dict/#items","title":"items","text":"<p>\u8981\u7f16\u5199\u7528\u4e8e\u904d\u5386\u5b57\u5178\u7684for\u5faa\u73af\uff0c\u53ef\u58f0\u660e\u4e24\u4e2a\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u952e\u2014\u503c\u5bf9\u4e2d\u7684\u952e\u548c\u503c\u3002\u5bf9\u4e8e\u8fd9\u4e24\u4e2a\u53d8\u91cf\uff0c\u53ef\u4f7f\u7528\u4efb\u4f55\u540d\u79f0\u3002</p> <pre><code>for k, v in user_0.items()\n</code></pre> <p>for\u8bed\u53e5\u7684\u7b2c\u4e8c\u90e8\u5206\u5305\u542b\u5b57\u5178\u540d\u548c\u65b9\u6cd5items()\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a\u952e\u2014\u503c\u5bf9\u5217\u8868\u3002for\u5faa\u73af\u4f9d\u6b21\u5c06\u6bcf\u4e2a\u952e\u2014\u503c\u5bf9\u5b58\u50a8\u5230\u6307\u5b9a\u7684\u4e24\u4e2a\u53d8\u91cf\u4e2d\u3002</p> <pre><code>&gt;&gt;&gt; for key, value in dict1.items():\n...     print('dict1[{0}]={1}'.format(key, value))\n... \ndict1[k1]=1\ndict1[k2]=2\ndict1[k3]=3\ndict1[k4]=4\ndict1[k5]=5\ndict1[k6]=6\ndict1[k7]=7\n</code></pre>","tags":["dict"]},{"location":"blog/20191204/9-builtins.set/","title":"python\u5185\u7f6e\u6a21\u5757\u4e4b\u96c6\u5408(set)","text":"<p>Python\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u96c6\u5408\uff08builtins.set\uff09\u7684\u57fa\u672c\u7528\u6cd5\u3002</p> <p>Set Types \u2014 set, frozenset</p>","tags":["set"]},{"location":"blog/20191204/9-builtins.set/#help","title":"help","text":"<pre><code>&gt;&gt;&gt; help(set)\n\nHelp on class set in module builtins:\n\nclass set(object)\n |  set() -&gt; new empty set object\n |  set(iterable) -&gt; new set object\n |\n |  Build an unordered collection of unique elements.\n</code></pre>","tags":["set"]},{"location":"blog/20191204/9-builtins.set/#empty_set","title":"empty set","text":"<p><code>st=set()</code>: \u6784\u9020\u4e00\u4e2a\u7a7a\u96c6\u5408\u5bf9\u8c61\u3002  </p> <p>\u6ce8\u610f\uff1a <code>st={}</code> \u5b9a\u4e49\u7684\u662f\u7a7a\u5b57\u5178\u3002  </p> <p><code>st={1,2}</code> \u76f8\u5f53\u4e8e <code>st=set();st.add(1);st.add(2)</code>\u3002</p> <p>\u96c6\u5408\u4e0d\u652f\u6301\u57fa\u4e8e\u811a\u6807\u7d22\u5f15\u8bbf\u95ee\u5143\u7d20\uff08access through subscripted index\uff09\u3002</p>","tags":["set"]},{"location":"blog/20191204/9-builtins.set/#expressions","title":"expressions","text":"<ul> <li><code>len(st)</code>: Return the number of elements in set st.  </li> <li><code>e in st</code>: Test e for membership in st.  </li> <li><code>e not in st</code>: Test e for non-membership in st.  </li> <li><code>for e in st</code>: enumerate elements in st.  </li> </ul>","tags":["set"]},{"location":"blog/20191204/9-builtins.set/#api_overview","title":"api overview","text":"<pre><code>&gt;&gt;&gt; set.\nset.add(                          set.intersection(                 set.pop(\nset.clear(                        set.intersection_update(          set.remove(\nset.copy(                         set.isdisjoint(                   set.symmetric_difference(\nset.difference(                   set.issubset(                     set.symmetric_difference_update(\nset.difference_update(            set.issuperset(                   set.union(\nset.discard(                      set.mro()                         set.update(\n</code></pre> <p>\u57fa\u4e8e set \u63d0\u4f9b\u7684\u4e30\u5bcc\u63a5\u53e3\uff0c\u53ef\u6267\u884c\u5e38\u89c1\u7684\u96c6\u5408\u8fd0\u7b97\u3002</p>","tags":["set"]},{"location":"blog/20191204/9-builtins.set/#set_vs_list","title":"set vs. list","text":"<p>\u96c6\u5408 set \u76f8\u5bf9 list \u7684\u6700\u5927\u533a\u522b\u662f\uff0c\u96c6\u5408 set \u4e2d\u7684\u5143\u7d20\u5fc5\u987b\u662f\u72ec\u4e00\u65e0\u4e8c\u7684\uff0cadd\u91cd\u590d\u5143\u7d20\u65e0\u6548\u3002</p> <pre><code> |  add(...)\n |      Add an element to a set.\n |\n |      This has no effect if the element is already present.\n</code></pre> <pre><code>&gt;&gt;&gt; lt=[1,2]\n&gt;&gt;&gt; lt.add(2)\n&gt;&gt;&gt; lt.append(2)\n&gt;&gt;&gt; lt\n[1, 2, 2]\n\n&gt;&gt;&gt; st={1,2}\n&gt;&gt;&gt; st\n{1, 2}\n&gt;&gt;&gt; st.add(2)\n&gt;&gt;&gt; st\n{1, 2}\n</code></pre> <p>\u53ef\u4ee5\u57fa\u4e8elist\u6784\u9020set\uff0c\u79fb\u9664\u76f8\u540c\u7684\u5143\u7d20\u5b9e\u73b0\u53bb\u91cd\uff1a</p> <pre><code>&gt;&gt;&gt; lt=[1,2,2]\n&gt;&gt;&gt; set(lt)\n{1, 2}\n</code></pre> <p>\u6b64\u5916\uff0cset \u652f\u6301\u5e38\u89c4\u96c6\u5408\u8fd0\u7b97\uff1a</p> <ul> <li>\u96c6\u5408\u5305\u542b\u5173\u7cfb\uff1aissuperset\u3001issubset</li> <li>\u8ba1\u7b97\u5e76\u96c6\uff1aunion</li> <li>\u8ba1\u7b97\u4ea4\u96c6\uff1aintersection</li> <li>\u8ba1\u7b97\u5dee\u96c6\uff1adifference</li> </ul>","tags":["set"]},{"location":"blog/20191203/1-python-pip/","title":"python\u5305\u7ba1\u7406\u5668--pip","text":"<p>Python Packaging User Guide: Packaging Tool &amp; Installation Tool.</p> <p>PyPA \u00bb Python Packaging User Guide \u00bb Guides \u00bb Tool recommendations</p> <ul> <li>Installation Tool Recommendations  <ul> <li>Use pip to install Python packages from PyPI.  </li> <li>Use virtualenv, or venv to isolate application specific dependencies from a shared Python installation.  </li> </ul> </li> <li>Packaging Tool Recommendations  <ul> <li>Use setuptools to define projects and create Source Distributions.  </li> <li>Use the <code>bdist_wheel</code> setuptools extension available from the wheel project to create wheels. This is especially beneficial, if your project contains binary extensions.  </li> </ul> </li> </ul>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#packaging_tool","title":"Packaging Tool","text":"","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#setuptools","title":"setuptools","text":"<p>Package Index &gt; setuptools</p> <p>Easily download, build, install, upgrade, and uninstall Python packages</p> <p>Github Page: pypa / setuptools</p> <p>setuptools (which includes <code>easy_install</code>) is a collection of enhancements to the Python distutils that allow you to more easily build and distribute Python distributions, especially ones that have dependencies on other packages.</p> <p>macOS \u4e0b\u4f7f\u7528 brew \u5b89\u88c5 python3 \u65f6\uff0c\u9ed8\u8ba4\u5df2\u5b89\u88c5 pip3 \u548c setuptools\u3002</p> <pre><code>faner@FAN-MB0:~|\u21d2  pip3 list\nDEPRECATION: The default format will switch to columns in the future. You can use --format=(legacy|columns) (or define a format=(legacy|columns) in your pip.conf under the [list] section) to disable this warning.\npip (9.0.1)\nsetuptools (36.5.0)\nwheel (0.30.0)\n</code></pre> <p>How can I get a list of locally installed Python modules? </p> <p>\u53ef\u901a\u8fc7 <code>pip3 show setuptools</code> \u547d\u4ee4\u67e5\u770b\u5df2\u5b89\u88c5\u7684 setuptools \u5305\u4fe1\u606f\u3002</p> <pre><code>faner@FAN-MB0:~|\u21d2  pip3 show setuptools\nName: setuptools\nVersion: 36.5.0\nSummary: Easily download, build, install, upgrade, and uninstall Python packages\nHome-page: https://github.com/pypa/setuptools\nAuthor: Python Packaging Authority\nAuthor-email: distutils-sig@python.org\nLicense: UNKNOWN\nLocation: /usr/local/lib/python3.6/site-packages\nRequires:\n</code></pre> <p>\u5982\u679c\u60f3\u67e5\u770b\u7684\u5305\u672a\u5b89\u88c5\uff0c\u4f1a\u63d0\u793a not found\uff1a</p> <pre><code>$ pip3 show ipykernel\nWARNING: Package(s) not found: ipykernel\n</code></pre>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#wheel","title":"Wheel","text":"<p>Docs  \u00bb Wheel</p> <p>A built-package format for Python. A wheel is a ZIP-format archive with a specially formatted filename and the <code>.whl</code> extension.  </p> <p>macOS \u4e0b\u4f7f\u7528 brew \u5b89\u88c5 python3 \u65f6\uff0c\u9ed8\u8ba4\u5df2\u5b89\u88c5 pip3 \u548c wheel3\u3002</p> <pre><code>faner@FAN-MB0:~|\u21d2  wheel3 -V\nusage: wheel3 [-h]\n              {keygen,sign,unsign,verify,unpack,install,install-scripts,convert,version,help}\n              ...\nwheel3: error: unrecognized arguments: -V\n</code></pre> <p>\u53ef\u901a\u8fc7 <code>pip3 show wheel</code> \u547d\u4ee4\u67e5\u770b wheel \u5305\u4fe1\u606f\u3002</p> <pre><code>faner@FAN-MB0:~|\u21d2  pip3 show wheel     \nName: wheel\nVersion: 0.30.0\nSummary: A built-package format for Python.\nHome-page: https://github.com/pypa/wheel\nAuthor: Alex Gr\u00f6nholm\nAuthor-email: alex.gronholm@nextday.fi\nLicense: MIT\nLocation: /usr/local/lib/python3.6/site-packages\nRequires: \n</code></pre>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#installation_tool","title":"Installation Tool","text":"<p>Python\u6709\u4e24\u4e2a\u8457\u540d\u7684\u5305\u7ba1\u7406\u5de5\u5177 <code>easy_install.py</code> \u548c <code>pip</code>\u3002</p> <p>\u5728 Python2.7 \u7684\u5b89\u88c5\u5305\u4e2d\uff0c<code>easy_install.py</code> \u662f\u9ed8\u8ba4\u5b89\u88c5\u7684\uff0c\u800c <code>pip</code> \u9700\u8981\u6211\u4eec\u624b\u52a8\u5b89\u88c5\u3002 \u5728 python 2.7.9+ \u53ca python 3.4+ \u7684\u5b89\u88c5\u5305\u4e2d\uff0c\u9ed8\u8ba4\u5df2\u7ecf\u81ea\u5e26 <code>pip</code> \u5305\u7ba1\u7406\u5668\u3002  </p>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#easy_install","title":"easy_install","text":"<p>EasyInstall (easy_install) gives you a quick and painless way to install packages remotely by connecting to the cheeseshop or even other websites via HTTP. It is somewhat analogous to the CPAN and PEAR tools for Perl and PHP, respectively.</p> <p>setuptools 36.6.0 documentation \u00bb Easy Install </p> <p>Easy Install is a python module (<code>easy_install</code>) bundled with <code>setuptools</code> that lets you automatically download, build, install, and manage Python packages.</p> <p>\u5728 macOS/raspbian \u7ec8\u7aef\u8f93\u5165 <code>easy_install</code> \u518d\u6309\u4e0b tab \u53ef\u67e5\u770b\u6240\u6709\u7248\u672c\u7684 <code>easy_install</code>\uff1b</p> <ul> <li>\u8f93\u5165 <code>easy_install --version</code> \u547d\u4ee4\u53ef\u67e5\u770b Python 2.7 \u5bf9\u5e94\u7684 easy_install \u7684\u7248\u672c\u53f7\uff1b  </li> <li>\u8f93\u5165 <code>easy_install-3.6 --version</code>\uff08<code>easy_install3 --version</code>\uff09\u53ef\u67e5\u770b Python 3.* \u5bf9\u5e94\u7684 easy_install \u7684\u7248\u672c\u53f7\u3002  </li> </ul> <pre><code>faner@FAN-MB0:~|\u21d2  easy_install\neasy_install      easy_install-2.6  easy_install-2.7  easy_install-3.6\n\nfaner@FAN-MB0:~|\u21d2  easy_install --version\nsetuptools 18.5 from /System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python (Python 2.7)\n\nfaner@FAN-MB0:~|\u21d2  easy_install-3.6 --version\nsetuptools 36.5.0 from /usr/local/lib/python3.6/site-packages (Python 3.6)\n</code></pre> <pre><code>pi@raspberrypi:~ $ easy_install\neasy_install   easy_install3\n\npi@raspberrypi:~ $ easy_install --version\nsetuptools 33.1.1 from /usr/lib/python2.7/dist-packages (Python 2.7)\npi@raspberrypi:~ $ easy_install3 --version\nsetuptools 33.1.1 from /usr/lib/python3/dist-packages (Python 3.5)\n</code></pre>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#pip","title":"pip","text":"<p>Github Page: pypa / pip </p> <p>The PyPA recommended tool for installing Python packages. pip works on Unix/Linux, macOS, and Windows.  </p> <p>Pip is a modern, general purpose installation tool for python packages. Most often it is useful to install it in your system python.</p> <p>pip \u662f\u4e00\u4e2a\u4ee5 Python \u8ba1\u7b97\u673a\u7a0b\u5e8f\u8bed\u8a00\u5199\u6210\u7684\u8f6f\u4ef6\u5305\u7ba1\u7406\u7cfb\u7edf\uff0c\u4ed6\u53ef\u4ee5\u5b89\u88c5\u548c\u7ba1\u7406\u8f6f\u4ef6\u5305\u3002 \u53e6\u5916\uff0c\u4e0d\u5c11\u7684\u8f6f\u4ef6\u5305\u4e5f\u53ef\u4ee5\u5728 PyPI \u4e2d\u627e\u5230\u3002  </p>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#installation","title":"Installation","text":"<p>To install pip, securely download get-pip.py</p> <p>Then run the following:</p> <pre><code>python get-pip.py\n</code></pre> <p>Installing pip/setuptools/wheel with Linux Package Managers \u600e\u4e48\u5728windows\u4e0b\u5b89\u88c5pip? windows\u4e0b\u9762\u5b89\u88c5Python\u548cpip\u7ec8\u6781\u6559\u7a0b </p>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#pip2__pip3","title":"pip2 &amp; pip3","text":"<p><code>pip</code> comes with the official Python 2.7 and 3.4+ packages from python.org, and a <code>pip</code> bootstrap is included by default if you build from source. <code>pip</code> is already installed if you're using Python 2 &gt;=2.7.9 or Python 3 &gt;=3.4 binaries downloaded from python.org, but you'll need to upgrade pip.  </p> <p>\u8f93\u5165 pip \u9ed8\u8ba4\u8fd0\u884c pip 2\uff0c\u8f93\u5165 pip3 \u5219\u6307\u5b9a\u8fd0\u884c\u7248\u672c3\u7684 pip\u3002  </p> <pre><code># macOS\n\nfaner@FAN-MB0:~|\u21d2  pip3 -V\npip 9.0.1 from /usr/local/lib/python3.6/site-packages (python 3.6)\nfaner@FAN-MB0:~|\u21d2  which pip3\n/usr/local/bin/pip3\n</code></pre> <pre><code># raspbian\n\npi@raspberrypi:~ $ pip -V\npip 9.0.1 from /usr/lib/python2.7/dist-packages (python 2.7)\npi@raspberrypi:~ $ which pip\n/usr/bin/pip\npi@raspberrypi:~ $ whereis pip\npip: /usr/bin/pip /etc/pip.conf /usr/share/man/man1/pip.1.gz\n\npi@raspberrypi:~ $ pip3 -V\npip 9.0.1 from /usr/lib/python3/dist-packages (python 3.5)\npi@raspberrypi:~ $ which pip3\n/usr/bin/pip3\npi@raspberrypi:~ $ whereis pip3\npip3: /usr/bin/pip3 /usr/share/man/man1/pip3.1.gz\n</code></pre>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#help","title":"help","text":"<p>\u5b98\u65b9\u6587\u6863\uff1aDocs \u00bb pip </p> <p>pip \u548c pip3 \u5e26 <code>-h</code>(<code>--help</code>) \u9009\u9879\u53ef\u67e5\u770b\u5e2e\u52a9\uff08Show help\uff09\u3002  </p> <p>pip \u7684\u4e3b\u8981\u547d\u4ee4\uff08Commands\uff09\u5982\u4e0b\uff1a</p> <pre><code>pi@raspberrypi:~ $ pip -h\n\nUsage:   \n  pip &lt;command&gt; [options]\n\nCommands:\n  install                     Install packages.\n  download                    Download packages.\n  uninstall                   Uninstall packages.\n  freeze                      Output installed packages in requirements format.\n  list                        List installed packages.\n  show                        Show information about installed packages.\n  check                       Verify installed packages have compatible dependencies.\n  search                      Search PyPI for packages.\n  wheel                       Build wheels from your requirements.\n  hash                        Compute hashes of package archives.\n  completion                  A helper command used for command completion.\n  help                        Show help for commands.\n</code></pre> <p>\u5728\u7ec8\u7aef\u8f93\u5165 <code>pip3 help install</code> \u53ef\u67e5\u770b pip install \u547d\u4ee4\u7684\u5e2e\u52a9\u8bf4\u660e\u3002  </p> <p>\u5728 raspbian \u4e0b\u8fd8\u53ef\u4ee5\u8f93\u5165 <code>man pip</code> / <code>man pip3</code> \u67e5\u770b pip(3) \u7684 Manual Page\uff1a</p> <ul> <li>man pip\uff1a<code>/usr/share/man/man1/pip.1.gz</code> </li> <li>man pip3\uff1a<code>/usr/share/man/man1/pip3.1.gz</code> </li> </ul> <p>Python\u7684\u5305\u7ba1\u7406\u5de5\u5177pip\u7684\u5b89\u88c5\u4e0e\u4f7f\u7528 pip\u5b89\u88c5\u4f7f\u7528\u8be6\u89e3 / python pip\u5e38\u7528\u547d\u4ee4 \u5e38\u7528\u7684python\u6a21\u5757\u53ca\u5b89\u88c5\u65b9\u6cd5 \u4e0d\u5f97\u4e0d\u77e5\u7684\u51e0\u4e2a python \u5f00\u6e90\u9879\u76ee </p>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#python_-m_pip","title":"python -m pip","text":"<p>\u53e6\u5916\u4e5f\u53ef\u4ee5 <code>python3 -m pip</code> \u6267\u884c\u6307\u5b9a Python \u914d\u5957\u7684 pip\u3002</p> <p><code>-m mod</code> : run library module as a script</p> <pre><code># macOS\npython3 -m pip install matplotlib\n\n# Windows (may require elevation)\npython -m pip install matplotlib\n\n# Linux (Debian)\napt-get install python3-tk\npython3 -m pip install matplotlib\n</code></pre> <p>\u5047\u8bbe\u6211\u4eec\u7528 brew \u5b89\u88c5\u4e86\u591a\u4e2a python\uff0c\u6216\u8005\u4e4b\u524d\u7528\u8fc7\u7684 python \u4e00\u76f4\u6b8b\u7559\u7740\u6ca1\u6709\u79fb\u9664\u3002</p> <pre><code>$ ls -1 /usr/local/Cellar/ | grep 'python@'\npython@3.10\npython@3.11\npython@3.12\npython@3.8\npython@3.9\n\n$ find /usr/local/Cellar/ -type d -iname \"python@*\"\n/usr/local/Cellar//python@3.12\n/usr/local/Cellar//python@3.10\n/usr/local/Cellar//python@3.11\n/usr/local/Cellar//python@3.8\n/usr/local/Cellar//python@3.9\n</code></pre> <p>\u6211\u4eec\u5728\u4e4b\u524d\u7684\u67d0\u4e2a\u7248\u672c\u5b89\u88c5\u4e86\u4e00\u4e9b\u5de5\u5177\u5305\uff0c\u540e\u6765\u5fd8\u4e86\u3002\u90a3\u4e48\u600e\u4e48\u67e5\u627e\u5230\u5f53\u65f6\u7528\u7684\u90a3\u4e2a\u7248\u672c\u5462\uff1f</p> <p>\u5728\u547d\u4ee4\u884c\u6267\u884c <code>python3 -m pip -V</code> \u53ef\u4ee5\u770b\u5230\u6307\u5b9a python \u7248\u672c\u7684\u914d\u5957 pip \u7248\u672c\u548c site-packages \u4f4d\u7f6e\u3002</p> <ul> <li>\u4e5f\u53ef\u6253\u5370 <code>sys.path</code> \u770b\u770b modules \u7684\u641c\u7d22\u8def\u5f84\u3002</li> </ul> <pre><code># macOS Xcode command line tool \u5b89\u88c5\u7684 python3 \u7684 site-packages \u4f4d\u7f6e\n$ python -m pip -V\npip 21.2.4 from /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/site-packages/pip (python 3.9)\n\n# macOS brew \u5b89\u88c5\u7684 python3 \u7684 site-packages \u4f4d\u7f6e\n$ python3 -m pip -V\npip 24.0 from /usr/local/lib/python3.12/site-packages/pip (python 3.12)\n\n# conda base \u4e2d site-packages \u7684\u4f4d\u7f6e\n$ pip -V\npip 23.3.1 from /usr/local/anaconda3/lib/python3.9/site-packages/pip (python 3.9)\n</code></pre> <p>\u53ef\u4ee5\u6307\u5b9apython\u53ef\u6267\u884c\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u6267\u884c <code>python -m pip list</code> \u547d\u4ee4\u5217\u51fa\u5df2\u5b89\u88c5\u7684 site-packages\u3002</p> <pre><code>$ /usr/local/Cellar/python@3.8/3.8.18_2/bin/python3.8 -m pip list\n$ /usr/local/Cellar/python@3.9/3.9.18_2/bin/python3.9 -m pip list\n$ /usr/local/Cellar/python@3.10/3.10.13_2/bin/python3.10 -m pip list\n$ /usr/local/Cellar/python@3.11/3.11.7_2/bin/python3.11 -m pip list\n</code></pre>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#upgrade_pip","title":"upgrade pip","text":"<p>On Linux or macOS:</p> <pre><code>pip install -U pip\n</code></pre> <pre><code>pi@raspberrypi:~ $ pip install -U pip\nCollecting pip\n  Downloading pip-9.0.1-py2.py3-none-any.whl (1.3MB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1.3MB 13kB/s \nInstalling collected packages: pip\nSuccessfully installed pip-9.0.1\n</code></pre> <p>On Windows:</p> <pre><code>python -m pip install -U pip\n</code></pre> <p>\u8fd0\u884c pip3 \u547d\u4ee4\uff0c\u63d0\u793a\u65b0\u7248\u672c\u53ef\u4f9b\u5347\u7ea7\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  pip3 list\nDEPRECATION: The default format will switch to columns in the future. You can use --format=(legacy|columns) (or define a format=(legacy|columns) in your pip.conf under the [list] section) to disable this warning.\nbeautifulsoup4 (4.6.0)\ncppman (0.4.8)\nhtml5lib (1.0.1)\npip (9.0.1)\nsetuptools (36.5.0)\nsix (1.11.0)\nwebencodings (0.5.1)\nwheel (0.30.0)\nYou are using pip version 9.0.1, however version 9.0.3 is available.\nYou should consider upgrading via the 'pip install --upgrade pip' command.\n</code></pre> <p>\u6309\u7167\u63d0\u793a\u8fd0\u884c <code>pip install --upgrade pip</code>\uff08<code>-U</code> = <code>--upgrade</code>\uff09\u53ef\u5347\u7ea7 pip\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  pip3 install -U pip\nCollecting pip\n  Downloading pip-9.0.3-py2.py3-none-any.whl (1.4MB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1.4MB 989kB/s \nInstalling collected packages: pip\n  Found existing installation: pip 9.0.1\n    Uninstalling pip-9.0.1:\n      Successfully uninstalled pip-9.0.1\nSuccessfully installed pip-9.0.3\n\nfaner@MBP-FAN:~|\u21d2  pip3 --version\npip 9.0.3 from /usr/local/lib/python3.6/site-packages (python 3.6)\n</code></pre> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u66f4\u65b0 python(3) \u65f6\uff0c\u81ea\u52a8\u4f1a\u66f4\u65b0\u5185\u7f6e\u7684 pip\u3002</p>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#pip_over_easy_install","title":"pip over easy_install","text":"<p>Installing Python Modules: pip is the preferred installer program. Starting with <code>Python 3.4</code>, it is included by default with the Python binary installers.</p>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#reason","title":"reason","text":"<p>pip vs easy_install Why use pip over easy_install?  Pip Compared To easy_install </p> <ol> <li>pip provides an <code>uninstall</code> command  </li> <li>if an installation fails in the middle, pip will leave you in a clean state.  </li> <li>Requirements files allow you to create a snapshot of all packages that have been installed through <code>pip</code>.  </li> </ol> <p>@img </p> <p>Setuptools and easy_install will be replaced by the new hotness\u2014distribute and pip. While pip is still the new hotness, Distribute merged with Setuptools in 2013 with the release of Setuptools v0.7.</p> <p>@img </p>","tags":["pip"]},{"location":"blog/20191203/1-python-pip/#update","title":"UPDATE","text":"<p><code>setuptools</code> has absorbed <code>distribute</code> as opposed to the other way around, as some thought. <code>setuptools</code> is up-to-date with the latest <code>distutils</code> changes and the wheel format. Hence, <code>easy_install</code> and <code>pip</code> are more or less on equal footing now.  </p>","tags":["pip"]},{"location":"blog/20191203/2-python-module/","title":"python\u5305\u548c\u6a21\u5757","text":"<p>Python\u4e2d\u7684\u5305\u548c\u6a21\u5757\u6982\u8ff0\uff0c\u5305\u62ec import\u3001<code>__main__</code> \u7b49\u5185\u5bb9.</p> <p>The Python Language Reference - The import system The Python Tutorial - Modules </p> <p>General Index Global Module Index </p> <p>Python\u7684\u7a0b\u5e8f\u7531\u5305\uff08package\uff09\u3001\u6a21\u5757\uff08module\uff09\u548c\u51fd\u6570\u7ec4\u6210\u3002\u5305\u662f\u7531\u4e00\u7cfb\u5217\u6a21\u5757\u7ec4\u6210\u7684\u96c6\u5408\u3002\u6a21\u5757\u662f\u5904\u7406\u67d0\u4e00\u7c7b\u95ee\u9898\u7684\u51fd\u6570\u548c\u7c7b\u7684\u96c6\u5408\u3002</p> <ul> <li> <p>package: A Python module which can contain submodules or recursively, subpackages. Technically, a package is a Python module with an <code>__path__</code> attribute.</p> </li> <li> <p>module: An object that serves as an organizational unit of Python code. Modules have a namespace containing arbitrary Python objects. Modules are loaded into Python by the process of importing.</p> </li> <li> <p>function: A series of statements which returns some value to a caller. It can also be passed zero or more arguments which may be used in the execution of the body. See also parameter, method, and the Function definitions section.</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/2-python-module/#sys","title":"sys","text":"<pre><code>&gt;&gt;&gt; import sys\n\n&gt;&gt;&gt; help(sys)\n\nHelp on built-in module sys:\n\nNAME\n    sys\n\nDESCRIPTION\n    This module provides access to some objects used or maintained by the\n    interpreter and to functions that interact strongly with the interpreter.\n\n    Dynamic objects:\n\n    argv -- command line arguments; argv[0] is the script pathname if known\n    path -- module search path; path[0] is the script directory, else ''\n    modules -- dictionary of loaded modules\n\n    Static objects:\n\n    builtin_module_names -- tuple of module names built into this interpreter\n</code></pre>","tags":["module"]},{"location":"blog/20191203/2-python-module/#import_module","title":"import module","text":"<p>Python code in one module gains access to the code in another module by the process of importing it. The import statement is the most common way of invoking the import machinery, but it is not the only way. Functions such as importlib.import_module() and built-in <code>__import__()</code> can also be used to invoke the import machinery.</p> <p>The import statement combines two operations; it searches for the named module, then it binds the results of that search to a name in the local scope.</p>","tags":["module"]},{"location":"blog/20191203/2-python-module/#search_path","title":"Search Path","text":"<p>The first place checked during import search is sys.modules. </p> <ul> <li>sys.path: A list of strings that specifies the search path for modules. Initialized from the environment variable PYTHONPATH, plus an installation-dependent default.  </li> <li>sys.modules: This is a dictionary that maps module names to modules which have already been loaded. This can be manipulated to force reloading of modules and other tricks. However, replacing the dictionary will not necessarily work as expected and deleting essential items from the dictionary may cause Python to fail.  </li> </ul> <p>When the named module is not found in sys.modules, Python next searches sys.meta_path, which contains a list of meta path finder objects. These finders are queried in order to see if they know how to handle the named module.</p> <ul> <li>sys.meta_path: A list of meta path finder objects that have their find_spec() methods called to see if one of the objects can find the module to be imported. </li> </ul>","tags":["module"]},{"location":"blog/20191203/2-python-module/#import","title":"import","text":"<p>The import statement </p> <p>If the requested module is retrieved successfully, it will be made available in the local namespace.</p> <p>Examples:</p> <pre><code>import foo                 # foo imported and bound locally\nimport foo.bar.baz         # foo.bar.baz imported, foo bound locally\nimport foo.bar.baz as fbb  # foo.bar.baz imported and bound as fbb\nfrom foo.bar import baz    # foo.bar.baz imported and bound as baz\nfrom foo import attr       # foo imported and foo.attr bound as attr\n</code></pre> <p>import \u7c7b\u4f3c C(++) \u4e2d\u7684 include\uff0cObjective-C \u4e2d\u7684 import\uff1b <code>from module import class(.method)</code> \u7c7b\u4f3c C++ \u4e2d\u547d\u540d\u7a7a\u95f4\u7684\u5bfc\u5165\u5f15\u7528\uff08using\uff09\u3002  </p> <p>If the list of identifiers is replaced by a star ('<code>*</code>'), all public names defined in the module are bound in the local namespace for the scope where the import statement occurs.</p> <p>The wild card form of import \u2014 <code>from module import *</code> \u2014 is only allowed at the module level. Attempting to use it in class or function definitions will raise a SyntaxError.</p>","tags":["module"]},{"location":"blog/20191203/2-python-module/#isort","title":"isort","text":"<p>isort: Import Organization support for python files.</p> <p>\u5982\u679c import \u5e93\u987a\u5e8f\u6df7\u4e71\uff0c\u5219\u53ef\u80fd\u8b66\u544a\u63d0\u793a\uff1aImports are incorrectly sorted and/or formatted.isort(E)</p> <p>Quick Fix \u5c06\u8c03\u7528 isort Sort Python import definitions alphabetically within logical sections.</p>","tags":["module"]},{"location":"blog/20191203/2-python-module/#main","title":"main","text":"<p><code>__main__</code> is the name of the scope in which top-level code executes. A module\u2019s <code>__name__</code> is set equal to '<code>__main__</code>' when read from standard input, a script, or from an interactive prompt.</p> <p>A module can discover whether or not it is running in the main scope by checking its own <code>__name__</code>, which allows a common idiom for conditionally executing code in a module when it is run as a script or with <code>python -m</code> but not when it is imported:</p> <pre><code>if __name__ == \"__main__\":\n    # execute only if run as a script\n    main()\n</code></pre> <p>For a package, the same effect can be achieved by including a <code>__main__.py</code> module, the contents of which will be executed when the module is run with <code>-m</code>.</p> <pre><code>\u21d2  python -h\nusage: python [option] ... [-c cmd | -m mod | file | -] [arg] ...\nOptions and arguments (and corresponding environment variables):\n\n-m mod : run library module as a script (terminates option list)\n</code></pre> <p>Special considerations for main </p>","tags":["module"]},{"location":"blog/20191203/2-python-module/#main_entry","title":"main entry","text":"<pre><code>#!/usr/bin/env python3\n# -*- coding: UTF-8 -*-\n\nimport sys\n\n\ndef function(args):\n    pass\n\n\ndef main(args):\n    function(args)  # do something\n\n\n# main entry\nif __name__ == '__main__':\n    print('This program is being run by itself')\n    if len(sys.argv) &lt; 2:\n        print('please input parameters:')\n    else:\n        main(sys.argv[1:])\nelse:\n    print('I am being imported from another module')\n</code></pre>","tags":["module"]},{"location":"blog/20191203/2-python-module/#shebang","title":"shebang","text":"<p>shebang</p> <p>shebang: In computing, a shebang is the character sequence consisting of the characters number sign and exclamation mark (#!) at the beginning of a script. It is also called sharp-exclamation, sha-bang, hashbang, pound-bang, or hash-pling.</p> <p>Purpose of #!/usr/bin/python3 Should I put #! (shebang) in Python scripts, and what form should it take? </p> <ul> <li>Shebang line for Python 2.7\uff1a<code>#!/usr/bin/env python2.7</code> </li> <li>Shebang line for Python 3\uff1a<code>#!/usr/bin/env python3</code> </li> <li>compatible with both Python 2.x and 3.x\uff1a<code>#!/usr/bin/env python</code> </li> </ul> <p>To be better portable users can use <code>#!/usr/bin/env python3</code> which will use the first python3 from the <code>PATH</code>.</p> <p>\u5f53\u6267\u884c<code>chmod a+x code.py</code> \u8d4b\u4e88 python \u811a\u672c\u6267\u884c\u6743\uff0c\u5219\u53ef\u5728\u7ec8\u7aef\u6572\u4e0b <code>code.py</code> \u6216 <code>./code.py</code> \u50cf\u6267\u884c bash shell \u811a\u672c\u90a3\u6837\u8fd0\u884c\u3002 \u6b64\u65f6\uff0c\u5c06\u8bfb\u53d6\u9996\u884c\u7684 shebang\uff0c\u627e\u5230\u5176\u6307\u5b9a\u7684 python \u7248\u672c\u8fdb\u884c\u89e3\u91ca\u6267\u884c\u3002</p> <p>\u5f53\u4ee5 <code>python code.py</code> \u6216 <code>python3 code.py</code> \u663e\u5f0f\u6307\u5b9a\u8c03\u7528 python(2.7) \u6216 python3 \u8fdb\u884c\u89e3\u91ca\u6267\u884c\u65f6\uff0c\u5c06\u5ffd\u7565\u9996\u884c\u7684 shebang\u3002</p> <p>\u5982\u679cpy\u811a\u672c\u5f00\u5934\u6ca1\u6709\u6307\u5b9a Shebang - <code>#!/usr/bin/env python3</code>\uff0c\u5219 vscode Run Code \u6267\u884c <code>python -u test.py</code>\uff0c\u53ef\u80fd\u63d0\u793a\u627e\u4e0d\u5230 python \u547d\u4ee4\u3002</p> <p>macOS \u81ea Monterey\uff08April 2022\uff09\u540e\u79fb\u9664\u4e86 Python 2.7\u3002</p>","tags":["module"]},{"location":"blog/20191203/2-python-module/#test","title":"test","text":"<ol> <li>test_module.py  </li> <li>test_modulefinder.py  </li> </ol>","tags":["module"]},{"location":"blog/20191203/2-python-module/#demo","title":"demo","text":"<p>\u65b0\u5efa\u4e00\u4e2a resnet1.py \u6587\u4ef6\uff1a</p> <pre><code>#!/usr/bin/env python3\n# -*- coding: UTF-8 -*-\n\n\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\n\ndef inference(a, b):\n    return a+b\n</code></pre> <p>\u518d\u65b0\u5efa\u4e00\u4e2a train.py \u6587\u4ef6\uff0c\u5bfc\u5165 resnet1 \u6a21\u5757\uff0c\u8c03\u7528\u5176\u4e2d\u7684 inference \u51fd\u6570\uff1a</p> <pre><code>#!/usr/bin/env python3\n# -*- coding: UTF-8 -*-\n\nfrom __future__ import absolute_import\nfrom __future__ import division\nfrom __future__ import print_function\n\nimport sys\nimport importlib\nimport argparse\n\n\ndef main(args):\n    network = importlib.import_module(args.model_def, 'inference')\n    c = network.inference(1,2)\n    print(c)\n\n\ndef parse_arguments(argv):\n    parser = argparse.ArgumentParser()\n    parser.add_argument('--model_def', \n        type=str, \n        help='Model definition.', \n        default='resnet1')\n    return parser.parse_args(argv)\n\n\nif __name__ == '__main__':\n    main(parse_arguments(sys.argv[1:]))\n</code></pre>","tags":["module"]},{"location":"blog/20191203/2-python-module/#references","title":"references","text":"<p>Python\u5bfc\u5165\u6a21\u5757\u7684\u51e0\u79cd\u59ff\u52bf python\u5b66\u4e60\u4e4b\u52a8\u6001\u5bfc\u5165\u6a21\u5757\uff1aimport \u548c importlib Python\u4e2d\u6807\u51c6\u6a21\u5757 importlib \u4ecb\u7ecd \u53ca \u8be6\u89e3 scrapy \u4e2d\u5f15\u5165\u6e90\u7801\u7684 load_object \u5b9e\u73b0 python\u4e2dfrom module import * \u7684\u4e00\u4e2a\u9677\u9631 python\u4e2d\u5b9e\u73b0\u52a8\u6001\u5bfc\u5165\u6a21\u5757 importlib.import_module Python \u52a8\u6001\u5bfc\u5165\u5bf9\u8c61\u4e4b importlib.import_module \u6848\u4f8b </p> <p>Python Class vs. Module Attributes</p>","tags":["module"]},{"location":"blog/20191203/3-python-inspect/","title":"python inspect","text":"<p>\u4ecb\u7ecdPython\u4e2d\u5305\u548c\u6a21\u5757\u7684 <code>__doc__</code> \u548c <code>__file__</code> \u5c5e\u6027\uff0c\u5e76\u501f\u6b64\u67e5\u770b\u6a21\u5757\u6982\u8ff0\u548c\u6587\u4ef6\u8def\u5f84\u3002</p>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#docstring","title":"Docstring","text":"<p>A docstring is a string literal that occurs as the first statement in a module, function, class, or method definition. Such a docstring becomes the <code>__doc__</code> special attribute of that object.</p> <p></p> <p>pydoc \u6a21\u5757\u81ea\u52a8\u6839\u636e\u5b9e\u73b0\u4ee3\u7801\u4e2d\u5404\u90e8\u5206\u6309\u7ea6\u5b9a\u683c\u5f0f\u5b9a\u4e49\u7684 docstring\uff0c\u805a\u5408\u751f\u6210\u6574\u4e2a\u6a21\u5757\u7684\u5e2e\u52a9\u6587\u6863\u3002</p> <p>The pydoc module automatically generates documentation from Python modules.  </p> <p>\u8c03\u7528 <code>help()</code> \u7684\u8f93\u51fa\u5b9e\u9645\u4e0a\u5c31\u662f\u6574\u4e2a\u6a21\u5757\u7684 docstrings \u6216\u5404\u4e2a\u90e8\u5206\u7684 docstring\u3002</p> <p>Calling <code>help()</code> on methods or functions displays the docstrings.  </p> <p>The built-in function <code>help()</code> invokes the online help system in the interactive interpreter, which uses pydoc to generate its documentation as text on the console.  </p> <p>PEP 257 -- Docstring Conventions \u4f7f\u7528Python\u7684docstring </p>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#doc","title":"doc","text":"<p>python \u4e2d\u6bcf\u4e2a module\uff0c\u6bcf\u4e2a class\uff0c\u6bcf\u4e2a def \u90fd\u7559\u6709\u5199 doc \u7684\u5730\u65b9\u3002</p> <p>\u5173\u4e8e <code>__doc__</code> \u5c5e\u6027\uff0c\u53c2\u8003 \u300aTypes and members\u300b\u3002</p> <ul> <li><code>print(module.__doc__)</code>\uff1a\u67e5\u770b\u6a21\u5757\u6982\u8ff0\u3002</li> </ul> <pre><code>&gt;&gt;&gt; # \u67e5\u770b builtins \u6a21\u5757\u7684 docstring\n&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; print(builtins.__doc__)\nBuilt-in functions, exceptions, and other objects.\n\nNoteworthy: None is the `nil' object; Ellipsis represents `...' in slices.\n&gt;&gt;&gt;\n&gt;&gt;&gt; # \u67e5\u770b string \u6a21\u5757\u7684 docstring\n&gt;&gt;&gt; print(string.__doc__)\nA collection of string constants.\n\nPublic module variables:\n\nwhitespace -- a string containing all ASCII whitespace\nascii_lowercase -- a string containing all ASCII lowercase letters\nascii_uppercase -- a string containing all ASCII uppercase letters\nascii_letters -- a string containing all ASCII letters\ndigits -- a string containing all ASCII decimal digits\nhexdigits -- a string containing all ASCII hexadecimal digits\noctdigits -- a string containing all ASCII octal digits\npunctuation -- a string containing all ASCII punctuation characters\nprintable -- a string containing all ASCII characters considered printable\n</code></pre> <p>\u6ce8\u610f\uff1a\u5148\u8981 import module\u3002</p>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#pprint","title":"pprint","text":"<p>\u5728 py \u76ee\u5f55\u4e0b\u6267\u884c <code>python3 open_python_module_code.py pprint</code> \u6253\u5f00 pprint.py \u6e90\u7801\uff0c\u7b2c11~35\u884c\u4e3a\u6a21\u5757\u7684docstring\uff08\u6a21\u5757\u6982\u8981\uff09\u3002 \u7b2c50\u300159\u300165\u884c\u4e3a\u51fd\u6570 pprint\u3001pformat\u3001pp \u7684docstring\uff08\u51fd\u6570\u8bf4\u660e\uff09\u3002</p> <p></p> <p>\u6a21\u5757\u4ee3\u7801\u6587\u4ef6\u5f00\u5934\u5b9a\u4e49\u7684 <code>pprint.__doc__</code> \u5373\u4e3a help(pprint) \u5e2e\u52a9\u547d\u4ee4\u8f93\u51fa\u7684 DESCRIPTION \u90e8\u5206\uff1a</p> <pre><code>&gt;&gt;&gt; import pprint\n&gt;&gt;&gt; pprint.__doc__\n\"Support to pretty-print lists, tuples, &amp; dictionaries recursively.\\n\\nVery simple, but useful, especially in debugging data structures.\\n\\nClasses\\n-------\\n\\nPrettyPrinter()\\n    Handle pretty-printing operations onto a stream using a configured\\n    set of formatting parameters.\\n\\nFunctions\\n---------\\n\\npformat()\\n    Format a Python object into a pretty-printed representation.\\n\\npprint()\\n    Pretty-print a Python object to a stream [default is sys.stdout].\u00e5\\n\\nsaferepr()\\n    Generate a 'standard' repr()-like value, but protect against recursive\\n    data structures.\\n\\n\"\n\n&gt;&gt;&gt; help(pprint)\n\nHelp on module pprint:\n\nNAME\n    pprint - Support to pretty-print lists, tuples, &amp; dictionaries recursively.\n\nDESCRIPTION\n    Very simple, but useful, especially in debugging data structures.\n\n    Classes\n    -------\n\n    PrettyPrinter()\n        Handle pretty-printing operations onto a stream using a configured\n        set of formatting parameters.\n\n    Functions\n    ---------\n\n    pformat()\n        Format a Python object into a pretty-printed representation.\n\n    pprint()\n        Pretty-print a Python object to a stream [default is sys.stdout].\u00e5\n\n    saferepr()\n        Generate a 'standard' repr()-like value, but protect against recursive\n        data structures.\n</code></pre> <p>\u4ee5\u4e0b\u67e5\u770b <code>pprint.pprint.__doc__</code>\uff1a</p> <pre><code>&gt;&gt;&gt; import pprint\n&gt;&gt;&gt; pprint.pprint.__doc__\n'Pretty-print a Python object to a stream [default is sys.stdout].'\n</code></pre>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#string","title":"string","text":"<p><code>string.__doc__</code> \u5373 string.docstring \u622a\u56fe\u4e2d\u5b9a\u4e49\u5728\u6a21\u5757\u4ee3\u7801 <code>string.py</code> \u9996\u90e8\u4e09\u5f15\u53f7\u5305\u62ec\u7684\u591a\u884c\u6ce8\u91ca\u90e8\u5206\uff08Multi-line Docstrings\uff09\u2014\u2014 \u2460\u3002 \u7ed3\u5408 help() \u8f93\u51fa\u53ef\u77e5\uff0c\u5305\u62ec\u7d27\u968f\u4e09\u5f15\u53f7\u540e\u7684 NAME \u90e8\u5206\uff0c\u4ee5\u53ca\u95f4\u9694\u7a7a\u884c\u540e\u7684 DESCRIPTION \u90e8\u5206\u3002  </p> <ul> <li><code>print(class.__doc__)</code>\uff08\u6216 <code>print(object.__doc__)</code>\uff09\uff1a\u67e5\u770b\u7c7b\u8bf4\u660e\u3002  </li> </ul> <pre><code>&gt;&gt;&gt; # \u67e5\u770b builtins.str \u7c7b\u7684 docstring\n&gt;&gt;&gt; print(str.__doc__)\nstr(object='') -&gt; str\nstr(bytes_or_buffer[, encoding[, errors]]) -&gt; str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer\nthat will be decoded using the given encoding and error handler.\nOtherwise, returns the result of object.__str__() (if defined)\nor repr(object).\nencoding defaults to sys.getdefaultencoding().\nerrors defaults to 'strict'.\n</code></pre> <pre><code>&gt;&gt;&gt; # \u67e5\u770b string \u6a21\u5757\u7684\u7c7b Template \u7684 docstring\n&gt;&gt;&gt; print(string.Template.__doc__)\nA string class for supporting $-substitutions.\n</code></pre> <p><code>string.Template.__doc__</code> \u5373 string.docstring \u622a\u56fe\u4e2d\u5b9a\u4e49\u5728\u6a21\u5757\u4ee3\u7801 <code>string.py</code> \u4e2d Template \u7c7b\u58f0\u660e\u540e\u7684\u5355\u884c\u4e09\u5f15\u53f7\u6ce8\u91ca\u90e8\u5206\uff08One-line Docstrings\uff09 \u2014\u2014 \u2462\u3002  </p> <ul> <li><code>print(class.method.__doc__)</code>\uff08\u6216 <code>print(object.method.__doc__)</code>\uff09\uff1a\u67e5\u770b\u7c7b\u6210\u5458\u51fd\u6570\u8bf4\u660e\u3002  </li> </ul> <pre><code>&gt;&gt;&gt; # \u67e5\u770b builtins.str \u7c7b\u7684\u6210\u5458\u51fd\u6570 format \u7684 docstring\n&gt;&gt;&gt; print(str.format.__doc__)\nS.format(*args, **kwargs) -&gt; str\n\nReturn a formatted version of S, using substitutions from args and kwargs.\nThe substitutions are identified by braces ('{' and '}').\n&gt;&gt;&gt;\n&gt;&gt;&gt; # \u67e5\u770b string \u6a21\u5757\u7684\u51fd\u6570 capwords \u7684 docstring\n&gt;&gt;&gt; print(string.capwords.__doc__)\ncapwords(s [,sep]) -&gt; string\n\n    Split the argument into words using split, capitalize each\n    word using capitalize, and join the capitalized words using\n    join.  If the optional second argument sep is absent or None,\n    runs of whitespace characters are replaced by a single space\n    and leading and trailing whitespace are removed, otherwise\n    sep is used to split and join the words.\n</code></pre> <p><code>string.capwords.__doc__</code> \u5373 string.docstring \u622a\u56fe\u4e2d\u5b9a\u4e49\u5728\u6a21\u5757\u4ee3\u7801 <code>string.py</code> \u4e2d capwords \u51fd\u6570\u4f53\u9996\u90e8\u4e09\u5f15\u53f7\u5305\u62ec\u7684\u591a\u884c\u6ce8\u91ca\u90e8\u5206 \u2014\u2014 \u2461\u3002 \u7ed3\u5408 help() \u8f93\u51fa\u53ef\u77e5\uff0c\u5305\u62ec\u7d27\u968f\u4e09\u5f15\u53f7\u540e\u7684\u6982\u8981\uff08summary line\uff09\uff0c\u4ee5\u53ca\u95f4\u9694\u7a7a\u884c\u540e\uff08followed by a blank line\uff09\u7684\u8be6\u7ec6\u8bf4\u660e\u90e8\u5206\uff08more elaborate description\uff09\u3002  </p>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#inspectgetdoc","title":"inspect.getdoc","text":"<p>\u901a\u8fc7 inspect.getdoc(object) \u63a5\u53e3\u4ea6\u53ef\u83b7\u53d6 object \u5bf9\u5e94\u7684 docstring\uff08documentation string\uff09\uff1a</p> <pre><code>inspect.getdoc(object)\nGet the documentation string for an object\n</code></pre> <pre><code>&gt;&gt;&gt; inspect.getdoc(str)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nNameError: name 'inspect' is not defined\n\n# \u9700\u8981\u5148 import inspect \u6a21\u5757\u65b9\u53ef\u8c03\u7528\n&gt;&gt;&gt; import inspect\n&gt;&gt;&gt; inspect.getdoc(str)\n\"str(object='') -&gt; str\\nstr(bytes_or_buffer[, encoding[, errors]]) -&gt; str\\n\\nCreate a new string object from the given object. If encoding or\\nerrors is specified, then the object must expose a data buffer\\nthat will be decoded using the given encoding and error handler.\\nOtherwise, returns the result of object.__str__() (if defined)\\nor repr(object).\\nencoding defaults to sys.getdefaultencoding().\\nerrors defaults to 'strict'.\"\n</code></pre> <p><code>inspect.getdoc(str)</code> \u7b49\u6548\u4e8e <code>str.__doc__</code> <code>inspect.getdoc(string)</code> \u7b49\u6548\u4e8e <code>string.__doc__</code> <code>inspect.getdoc(string.Template)</code> \u7b49\u6548\u4e8e <code>string.Template.__doc__</code> <code>inspect.getdoc(string.capwords)</code> \u7b49\u6548\u4e8e <code>string.capwords.__doc__</code> </p>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#source_code","title":"Source Code","text":"<p>\u5982\u679c\u5b9a\u4f4d\u7b26\u53f7\u6240\u5728\u7684\u5305\u6a21\u5757\u5462\uff1f</p> <p>\u5df2\u7ecf\u901a\u8fc7pip3\u5b89\u88c5\u4e86pdfminer\uff0c\u4f46\u662f\u901a\u8fc7 from import \u5bfc\u5165 <code>PDFNoOutlines</code>\u3001<code>PSLiteral</code>\u3001<code>LTTextBox</code> \u65f6\uff0c\u5982\u4f55\u786e\u5b9a\u5177\u4f53\u5728\u54ea\u4e2a\u5b50\u6a21\u5757\u5462\uff1f</p> <ol> <li> <p>\u65b9\u6848\u4e00\uff1a\u9010\u4e2a help \u6216 dir \u5b50\u6a21\u5757\uff0c\u8089\u773c\u67e5\u627e\u7c7b\u6216\u51fd\u6570\u540d\u7b26\u53f7\u5728\u54ea\u4e2a\u5b50\u6a21\u5757\u4e2d\u3002  </p> <ul> <li>\u4e5f\u53ef\u5199\u4e2apython\u811a\u672c\uff0c\u904d\u5386pdfminer\u6240\u6709\u6a21\u5757\u7684dir\u67e5\u627e\u5339\u914d\u67d0\u4e2a\u7b26\u53f7\u3002</li> </ul> </li> <li> <p>\u65b9\u6848\u4e8c\uff1a\u901a\u8fc7 open_python_module_code.py\uff08\u53c2\u89c1\u4e0b\u6587\uff09\u811a\u672c\u6253\u5f00\u6307\u5b9a pdfminer \u5305\u6e90\u4ee3\u7801\u8fdb\u884c\u67e5\u627e\u3002  </p> <ul> <li>python3 open_python_module_code.py pdfminer</li> </ul> </li> </ol>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#file","title":"file","text":"<p>\u5173\u4e8e <code>__file__</code> \u5c5e\u6027\uff0c\u53c2\u8003 \u300aTypes and members\u300b\u3002</p> <p>\u5728 python \u4e3b\u63a7\u5236\u53f0\u4e2d\u76f4\u63a5\u8f93\u5165 <code>module</code>\u3001<code>module.function</code>\u3001<code>module.class</code>\u3001<code>module.class.method</code> \u4e5f\u4f1a\u663e\u793a\u5176\u8def\u5f84\u6216\u7c7b\u578b\u7b49\u4fe1\u606f\uff1a</p> <pre><code>&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; builtins\n&lt;module 'builtins' (built-in)&gt;\n\n&gt;&gt;&gt; builtins.print\n&lt;built-in function print&gt;\n\n&gt;&gt;&gt; builtins.str\n&lt;class 'str'&gt;\n\n&gt;&gt;&gt; builtins.str.format\n&lt;method 'format' of 'str' objects&gt;\n\n&gt;&gt;&gt; import sys\n&gt;&gt;&gt; sys\n&lt;module 'sys' (built-in)&gt;\n\n&gt;&gt;&gt; import os\n&gt;&gt;&gt; os\n&lt;module 'os' from '/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/os.py'&gt;\n\n&gt;&gt;&gt; import array\n&gt;&gt;&gt; array\n&lt;module 'array' from '/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/lib-dynload/array.cpython-36m-darwin.so'&gt;\n</code></pre> <p>\u5728\u7ec8\u7aef\u6267\u884c python(3) \u542f\u52a8\u65f6\uff0c\u53ef\u643a\u5e26 <code>-v</code> \u9009\u9879\uff0c\u5c06\u8f93\u51fa\u8be6\u7ec6\u7684\u6a21\u5757\u52a0\u8f7d\u4fe1\u606f\uff1a</p> <pre><code>-v     : verbose (trace import statements); also PYTHONVERBOSE=x\n         can be supplied multiple times to increase verbosity\n</code></pre> <p>\u53e6\u5916\uff0c\u4e5f\u53ef\u6253\u5370\u6a21\u5757\u7684 <code>__file__</code> \u5c5e\u6027\u6765\u67e5\u770b\u6a21\u5757\u8def\u5f84\u4fe1\u606f\u3002</p> <pre><code># builtins \u6a21\u5757\u672a\u5b9a\u4e49\u8be5\u5c5e\u6027\n&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; builtins.__file__\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nAttributeError: module 'builtins' has no attribute '__file__'\n\n# sys \u6a21\u5757\u672a\u5b9a\u4e49\u8be5\u5c5e\u6027\n&gt;&gt;&gt; import sys\n&gt;&gt;&gt; sys.__file__\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nAttributeError: module 'sys' has no attribute '__file__'\n\n# string \u6a21\u5757\u5bf9\u5e94 Python \u6e90\u7801\n&gt;&gt;&gt; import string\n&gt;&gt;&gt; string.__file__\n'/usr/local/Cellar/python/3.7.4/Frameworks/Python.framework/Versions/3.7/lib/python3.7/string.py'\n\n# os \u6a21\u5757\u5bf9\u5e94 Python \u6e90\u7801\n&gt;&gt;&gt; import os\n&gt;&gt;&gt; os.__file__\n'/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/os.py'\n\n# array \u6a21\u5757\u5bf9\u5e94 cpython \u5b9e\u73b0\u52a8\u6001\u5e93\n&gt;&gt;&gt; import array\n&gt;&gt;&gt; array.__file__\n'/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/lib-dynload/array.cpython-36m-darwin.so'\n</code></pre>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#study_the_source_code","title":"study the source code","text":"<p>\u521d\u5b66 Python \u7684\u4e00\u79cd\u6709\u6548\u9014\u5f84\u662f\u9605\u8bfb python \u6807\u51c6\u6a21\u5757\u6e90\u7801\uff0c\u901a\u8fc7\u9605\u8bfb\u6e90\u7801\u53ef\u89c2\u6469\u7f16\u7801\u89c4\u8303\uff0c\u4e86\u89e3\u8bed\u8a00\u98ce\u683c\uff0c\u5feb\u901f\u638c\u63e1 Python \u7a0b\u5e8f\u8bbe\u8ba1\u7684\u4e00\u822c\u6d41\u7a0b\u3002</p> <p>\u627e\u5230\u5bf9\u5e94\u6a21\u5757\u7684 Python \u6e90\u7801\u8def\u5f84\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00\u8fdb\u884c\u7814\u8bfb\u3002  </p> <p><code>os.system('open '+module.__file__)</code>\uff1a\u8c03\u7528 open \u4f7f\u7528\u9ed8\u8ba4\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00 module \u6e90\u7801\uff1a</p> <pre><code>&gt;&gt;&gt; import argparse\n&gt;&gt;&gt; import os\n# \u8c03\u7528 open \u547d\u4ee4\u6253\u5f00 argparse \u6a21\u5757\u6e90\u7801\n&gt;&gt;&gt; os.system('open '+argparse.__file__)\n\n# \u8c03\u7528 subl \u547d\u4ee4\u6253\u5f00 argparse \u6a21\u5757\u6e90\u7801\n&gt;&gt;&gt; os.system('subl '+argparse.__file__)\n</code></pre> <p>\u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5148\u5207\u6362\u5de5\u4f5c\u76ee\u5f55\u5230 python \u5e93\u6e90\u7801\u76ee\u5f55\uff0c\u518d\u8c03\u7528 <code>os.system('open '+'module'+'.py')</code>\u3002</p> <pre><code>&gt;&gt;&gt; import os\n\n# \u83b7\u53d6\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u5e76\u8bb0\u5f55\n&gt;&gt;&gt; os.getcwd()\n'/Users/faner'\n&gt;&gt;&gt; last_cwd=os.getcwd()\n\n# \u4fee\u6539\u5de5\u4f5c\u76ee\u5f55\n&gt;&gt;&gt; os.chdir('/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/')\n&gt;&gt;&gt; os.getcwd()\n'/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6'\n\n# \u8c03\u7528 open \u547d\u4ee4\u6253\u5f00 python \u5e93\u6e90\u7801\u76ee\u5f55\n&gt;&gt;&gt; os.system('subl '+os.getcwd())\n0\n\n# \u8c03\u7528 subl \u547d\u4ee4\u6253\u5f00 python \u5e93\u6e90\u7801\u76ee\u5f55\n&gt;&gt;&gt; os.system('subl '+os.getcwd())\n0\n\n# \u8c03\u7528 open \u547d\u4ee4\u6253\u5f00\u6307\u5b9a python \u6e90\u7801\n&gt;&gt;&gt; os.system('open '+'argparse'+'.py')\n0\n\n# \u8c03\u7528 subl \u547d\u4ee4\u6253\u5f00\u6307\u5b9a python \u6e90\u7801\n&gt;&gt;&gt; os.system('subl '+'argparse'+'.py')\n0\n</code></pre> <p>\u8c03\u7528 subl \u547d\u4ee4\u6253\u5f00 python \u5e93\u6e90\u7801\u76ee\u5f55\uff0c\u53ef\u4f7f\u7528 Sublime Text \u5f3a\u5927\u7684\u641c\u7d22\u548c\u5b9a\u4f4d\u529f\u80fd\u8fdb\u884c\u9ad8\u6548\u9605\u8bfb\u3002</p> <p>\u9605\u8bfb <code>base64.py</code> \u53ef\u77e5\u5185\u90e8\u8c03\u7528\u4e86\u57fa\u7840\u5e93 binascii\uff0c\u5176\u4e3a\u89e3\u91ca\u5668\u5185\u7f6e\u6a21\u5757\uff08<code>binascii.cpython-36m-darwin.so</code>\uff09\u3002</p> <pre><code>&gt;&gt;&gt; import binascii\n&gt;&gt;&gt; binascii\n&lt;module 'binascii' from '/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/lib-dynload/binascii.cpython-36m-darwin.so'&gt;\n</code></pre> <p>\u53c2\u8003 cpython \u7684 binascii.c.h\u3002</p>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#openpythonmodulecode","title":"openPythonModuleCode","text":"<p>open_python_module_code.py \u811a\u672c\u6253\u5f00\u6307\u5b9a\u540d\u79f0\u7684\u6a21\u5757\u6e90\u4ee3\u7801\u8fdb\u884c\u5b66\u4e60\u3002</p> open_python_module_code.py <pre><code>#!/usr/bin/env python3\n# -*- coding: UTF-8 -*-\n\n\"\"\"\n\u8fd0\u884c\u793a\u4f8b\uff1a\n$ python3 open_python_module_code.py string\n$ python3 open_python_module_code.py datetime\n\"\"\"\n\nimport os\nimport sys\nimport importlib\n\n\ndef open_module_source_code(str_module_name):\n    try:\n        dynamic_module = importlib.import_module(str_module_name)\n        str_cmd = 'code '  # 'open ' # 'subl '\n        # module_path = inspect.getsourcefile(str_module_name)\n        str_file = dynamic_module.__file__  # \u7edd\u5bf9\u8def\u5f84\n        if str_file is not None:\n            (file_path, file_name) = os.path.split(str_file)\n            # dot_idx = str_file.rindex(os.extsep)\n            # file_ext = str_file[(dot_idx + 1):]\n            (file_name_prefix, file_name_suffix) = os.path.splitext(file_name)\n            if file_name_suffix == '.py':  # ext\n                if file_name_prefix == '__init__':\n                    print(str_cmd + file_path)\n                    os.system(str_cmd + file_path)  # vscode\u6253\u5f00\u76ee\u5f55\n                else:\n                    print(str_cmd + str_file)\n                    os.system(str_cmd + str_file)  # vscode\u6253\u5f00\u6587\u4ef6\n            else:  # 'module.cpython*.so'\n                # file_name_idx = str_file.rindex(os.sep)\n                # file_name = str_file[file_name_idx+1:]\n                print('module file: ', str_file)\n        else:\n            print('module file not exist!')\n    except (ImportError, AttributeError, ValueError) as e:\n        print(e)\n        sys.exit()\n\n\ndef main(args):\n    open_module_source_code(args[0])\n\n\n# main entry\nif __name__ == '__main__':\n    print('This program is being run by itself')\n    if len(sys.argv) &lt; 2:\n        print('please input module name')\n    else:\n        main(sys.argv[1:])\nelse:\n    print('I am being imported from another module')\n</code></pre> <ol> <li>\u8bfb\u53d6\u6a21\u5757\u6240\u5728\u4ee3\u7801\u8def\u5f84\uff1a</li> </ol> <p><code>dynamic_module = importlib.import_module(module)</code> \u5bfc\u5165\u6307\u5b9a module\uff0c\u7136\u540e\u53d6\u5176 <code>__file__</code> \u5c5e\u6027\uff0c\u7b49\u6548\u4e8e <code>module_path = inspect.getsourcefile(str_module_name)</code> \u53d6\u5176\u7edd\u5bf9\u8def\u5f84\u3002</p> <ol> <li>\u5224\u65ad\u6587\u4ef6\u540e\u7f00\u540d\u662f <code>.py</code>\uff1a\u5982\u679c\u6587\u4ef6\u540d\u662f <code>__init__.py</code>\uff0c\u5219\u7528 vscode \u6253\u5f00\u6240\u5728\u76ee\u5f55\uff1b\u5426\u5219\u7528 vscode \u6253\u5f00py\u6e90\u7801\u3002</li> </ol> <p>\u4ee5\u4e0b\u4e3a\u51e0\u7ec4\u7528\u4f8b\u6267\u884c\u7ed3\u679c\uff1a</p> <pre><code># ImportError\n$ python3 open_python_module_code.py str\nThis program is being run by itself\nNo module named 'str'\n\n# AttributeError\n$ python3 open_python_module_code.py builtins\nThis program is being run by itself\nmodule 'builtins' has no attribute '__file__'\n\n# cpython.so\n$ python3 open_python_module_code.py array\nThis program is being run by itself\nmodule file:  /usr/local/Cellar/python@3.9/3.9.7/Frameworks/Python.framework/Versions/3.9/lib/python3.9/lib-dynload/array.cpython-39-darwin.so\n\n# python sourcefile\n$ python3 open_python_module_code.py string\nThis program is being run by itself\ncode /usr/local/Cellar/python@3.9/3.9.7/Frameworks/Python.framework/Versions/3.9/lib/python3.9/string.py\n\n# python sourcefile\n$ python3 open_python_module_code.py argparse\nThis program is being run by itself\ncode /usr/local/Cellar/python@3.9/3.9.7/Frameworks/Python.framework/Versions/3.9/lib/python3.9/argparse.py\n\n# python dir\n$ python3 open_python_module_code.py pdfminer\nThis program is being run by itself\ncode /usr/local/lib/python3.9/site-packages/pdfminer\n</code></pre>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#inspect","title":"inspect","text":"<p>How do I find the location of Python module sources?</p> <p>\u9664\u4e86\u901a\u8fc7 <code>__file__</code> \u5c5e\u6027\u5916 \uff0c\u8fd8\u53ef\u901a\u8fc7 inspect \u6a21\u5757\u63d0\u4f9b\u7684\u4e00\u4e9b\u63a5\u53e3\uff0c\u6765\u67e5\u770b\u67d0\u4e2a\u7c7b\u3001\u5bf9\u8c61\u6216\u51fd\u6570\u6240\u5c5e\u6a21\u5757\u4ee5\u53ca\u6e90\u6587\u4ef6\u7b49\u4fe1\u606f\u3002\u53c2\u8003 29.12.2. Retrieving source code \u7ae0\u8282\u3002</p>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#inspectgetfile","title":"inspect.getfile","text":"<p><code>inspect.getfile(object)</code> \u63a5\u53e3\u7528\u4e8e\u83b7\u53d6\u5b9a\u4e49 object\uff08\u6a21\u5757\u3001\u7c7b\u6216\u51fd\u6570\uff09\u7684\u6587\u4ef6\uff0cpython \u6e90\u7801\u6216 cpython \u52a8\u6001\u5e93\uff08so\uff09\u3002</p> <pre><code>inspect.getfile(object)\nReturn the name of the (text or binary) file in which an object was defined. This will fail with a TypeError if the object is a built-in module, class, or function.\n</code></pre> <p>\u5bf9\u4e8e\u5185\u7f6e\u6a21\u5757\u3001\u7c7b\u6216\u51fd\u6570\uff0c\u8c03\u7528\u8be5\u63a5\u53e3\u5c06\u62a5 TypeError \u5f02\u5e38\u3002</p> <pre><code>&gt;&gt;&gt; # string \u6a21\u5757\u7684\u4ee3\u7801\n&gt;&gt;&gt; inspect.getfile(string)\n'/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/string.py'\n&gt;&gt;&gt;\n&gt;&gt;&gt; # array \u6a21\u5757\u7684 cpython \u5b9e\u73b0 so\n&gt;&gt;&gt; inspect.getfile(array)\n'/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/lib-dynload/array.cpython-36m-darwin.so'\n&gt;&gt;&gt;\n&gt;&gt;&gt; # str \u7c7b\u4e3a\u5185\u7f6e built-in class\uff0c\u62a5 TypeError \u5f02\u5e38\n&gt;&gt;&gt; inspect.getfile(str)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 654, in getfile\n    raise TypeError('{!r} is a built-in class'.format(object))\nTypeError: &lt;module 'builtins' (built-in)&gt; is a built-in class\n</code></pre>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#inspectgetsourcefile","title":"inspect.getsourcefile","text":"<p><code>inspect.getsourcefile(object)</code> \u63a5\u53e3\u7528\u4e8e\u83b7\u53d6\u5b9a\u4e49 object\uff08\u6a21\u5757\u3001\u7c7b\u6216\u51fd\u6570\uff09\u7684 python \u6e90\u6587\u4ef6\u3002</p> <pre><code>inspect.getsourcefile(object)\nReturn the name of the Python source file in which an object was defined. This will fail with a TypeError if the object is a built-in module, class, or function.\n</code></pre> <p>\u5bf9\u4e8e\u901a\u8fc7 cpython.so \u52a8\u6001\u5e93\u63d0\u4f9b\u7684\u6a21\u5757\u63a5\u53e3\uff0c\u6ca1\u6709 python \u6e90\u7801\uff0c\u8fd4\u56de\u7a7a\u3002 \u5bf9\u4e8e\u5185\u7f6e\u6a21\u5757\u3001\u7c7b\u6216\u51fd\u6570\uff0c\u8c03\u7528\u8be5\u63a5\u53e3\u5c06\u62a5 TypeError \u5f02\u5e38\u3002  </p> <pre><code>&gt;&gt;&gt; # string \u6a21\u5757\u7684\u4ee3\u7801\n&gt;&gt;&gt; inspect.getsourcefile(string))\n/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/string.py\n&gt;&gt;&gt;\n&gt;&gt;&gt; # array \u6a21\u5757\u7684\u6e90\u7801\uff1f\n&gt;&gt;&gt; inspect.getsourcefile(array)\n&gt;&gt;&gt; \n&gt;&gt;&gt; # str \u7c7b\u4e3a\u5185\u7f6e built-in class\uff0c\u62a5 TypeError \u5f02\u5e38\n&gt;&gt;&gt; inspect.getsourcefile(str)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 684, in getsourcefile\n    filename = getfile(object)\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 654, in getfile\n    raise TypeError('{!r} is a built-in class'.format(object))\nTypeError: &lt;module 'builtins' (built-in)&gt; is a built-in class\n</code></pre>","tags":["inspect"]},{"location":"blog/20191203/3-python-inspect/#inspectgetsource","title":"inspect.getsource","text":"<p><code>inspect.getsource(object)</code> \u63a5\u53e3\u7528\u4e8e\u83b7\u53d6 object\uff08\u6a21\u5757\u3001\u7c7b\u6216\u51fd\u6570\uff09\u7684 python \u5b9e\u73b0\u6e90\u7801\u3002</p> <pre><code>inspect.getsource(object)\nReturn the text of the source code for an object. The argument may be a module, class, method, function, traceback, frame, or code object. The source code is returned as a single string. An OSError is raised if the source code cannot be retrieved.\n</code></pre> <p>\u5bf9\u4e8e\u5185\u7f6e\u6a21\u5757(builtins) \u7b49\u4ee5 so \u5f62\u5f0f\u672a\u63d0\u4f9b python \u6e90\u7801\uff0c\u5c06\u62a5 TypeError \u5f02\u5e38\u3002</p> <pre><code>&gt;&gt;&gt; # \u89e3\u91ca\u5668\u63a7\u5236\u53f0\u8f93\u51fa string.Template.substitute \u5b9e\u73b0\u6e90\u7801\n&gt;&gt;&gt; inspect.getsource(string.Template.substitute))\n    def substitute(*args, **kws):\n        if not args:\n            raise TypeError(\"descriptor 'substitute' of 'Template' object \"\n                            \"needs an argument\")\n        self, *args = args  # allow the \"self\" keyword be passed\n        if len(args) &gt; 1:\n            raise TypeError('Too many positional arguments')\n        if not args:\n            mapping = kws\n        elif kws:\n            mapping = _ChainMap(kws, args[0])\n        else:\n            mapping = args[0]\n        # Helper function for .sub()\n        def convert(mo):\n            # Check the most common path first.\n            named = mo.group('named') or mo.group('braced')\n            if named is not None:\n                return str(mapping[named])\n            if mo.group('escaped') is not None:\n                return self.delimiter\n            if mo.group('invalid') is not None:\n                self._invalid(mo)\n            raise ValueError('Unrecognized named group in pattern',\n                             self.pattern)\n        return self.pattern.sub(convert, self.template)\n&gt;&gt;&gt; \n&gt;&gt;&gt; # array \u6a21\u5757\u4ee5 so \u63d0\u4f9b\uff0c\u672a\u63d0\u4f9b python \u6e90\u7801\uff0c\u62a5 TypeError \u5f02\u5e38\n&gt;&gt;&gt; inspect.getsource(array)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 968, in getsource\n    lines, lnum = getsourcelines(object)\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 955, in getsourcelines\n    lines, lnum = findsource(object)\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 778, in findsource\n    raise OSError('source code not available')\nOSError: source code not available\n&gt;&gt;&gt;\n&gt;&gt;&gt; # str \u5b9a\u4e49\u5728\u5185\u7f6e\u6a21\u5757(builtins)\uff0c\u4ee5 so \u63d0\u4f9b\uff0c\u672a\u63d0\u4f9b python \u6e90\u7801\uff0c\u62a5 TypeError \u5f02\u5e38\n&gt;&gt;&gt; inspect.getsource(str)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 968, in getsource\n    lines, lnum = getsourcelines(object)\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 955, in getsourcelines\n    lines, lnum = findsource(object)\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 768, in findsource\n    file = getsourcefile(object)\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 684, in getsourcefile\n    filename = getfile(object)\n  File \"/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/inspect.py\", line 654, in getfile\n    raise TypeError('{!r} is a built-in class'.format(object))\nTypeError: &lt;module 'builtins' (built-in)&gt; is a built-in class\n</code></pre>","tags":["inspect"]},{"location":"blog/20191203/4-python-builtins/","title":"python\u5185\u7f6e\u6a21\u5757--builtins","text":"<p>Python\u5185\u7f6e\u6a21\u5757 builtins \u6982\u89c8\uff0c\u5305\u62ec\u5e38\u89c1 FUNCTIONS \u548c\u57fa\u7840 CLASSES\u3002</p> <p>\u6253\u5370 <code>sys.builtin_module_names</code> \u53ef\u67e5\u770b python \u89e3\u91ca\u5668\u81ea\u5e26\u7684\u57fa\u7840\u6a21\u5757\uff1a</p> <pre><code>&gt;&gt;&gt; import sys\n&gt;&gt;&gt; sys.builtin_module_names\n('_ast', '_codecs', '_collections', '_functools', '_imp', '_io', '_locale', '_operator', '_signal', '_sre', '_stat', '_string', '_symtable', '_thread', '_tracemalloc', '_warnings', '_weakref', 'atexit', 'builtins', 'errno', 'faulthandler', 'gc', 'itertools', 'marshal', 'posix', 'pwd', 'sys', 'time', 'xxsubtype', 'zipimport')\n</code></pre> <p>A tuple of strings giving the names of all modules that are compiled into this Python interpreter.</p>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#builtins","title":"builtins","text":"<p>\u5728 python help utility \u4ea4\u4e92\u63a7\u5236\u53f0\u4e2d\uff0c\u76f4\u63a5\u8f93\u5165 builtins \u53ef\u67e5\u770b\u6a21\u5757\u5e2e\u52a9\u3002 \u5728 python \u4ea4\u4e92\u63a7\u5236\u53f0\u4e2d\uff0c\u5219\u5148\u6267\u884c <code>import builtins</code> \u5bfc\u5165 builtins \u6a21\u5757\uff0c\u518d\u8c03\u7528 <code>help(builtins)</code> \u67e5\u770b\u6a21\u5757\u5e2e\u52a9\u3002</p> <pre><code>&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; help(builtins)\n\nHelp on built-in module builtins:\n\nNAME\n    builtins - Built-in functions, exceptions, and other objects.\n\nDESCRIPTION\n    Noteworthy: None is the `nil' object; Ellipsis represents `...' in slices.\n</code></pre> <ul> <li>\u6267\u884c <code>print(builtins.__doc__)</code> \u67e5\u770b\u6a21\u5757\u6982\u8981\uff1a</li> </ul> <pre><code>&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; print(builtins.__doc__)\nBuilt-in functions, exceptions, and other objects.\n\nNoteworthy: None is the `nil' object; Ellipsis represents `...' in slices.\n</code></pre> <ul> <li>\u6267\u884c <code>dir(builtins)</code> \u67e5\u770b\u6a21\u5757\uff1a</li> </ul> <pre><code>&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; dir(builtins)\n</code></pre> <pre><code>&gt; \u4e5f\u53ef\u6267\u884c `print(builtins.__dict__)` \u6253\u5370 builtins \u6a21\u5757\u7684\u7b26\u53f7\u8868\u3002\n</code></pre> <p>Understanding Data Types in Python</p> <p>\u4ee5\u4e0b\u5148\u8fc7\u6ee4\u5185\u7f6e\u6a21\u5757\u4e2d\u7684\u516c\u5f00\u7b26\u53f7\uff0c\u7136\u540e\u518d\u8fdb\u4e00\u6b65\u8fc7\u6ee4\u51fa\u4ee5\u201cis\u201d\u5f00\u5934\u7684\u5224\u65ad\u63a5\u53e3\uff1a</p> <pre><code>&gt;&gt;&gt; [n for n in dir(builtins) if not n.startswith('_') and n.startswith('is')]\n['isinstance', 'issubclass']\n</code></pre>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#functions","title":"FUNCTIONS","text":"<p>builtins \u6a21\u5757\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u5185\u7f6e\u51fd\u6570\uff08FUNCTIONS\uff09\uff0c\u5927\u6982\u5206\u4e3a vars\u3001math\u3001utility \u4e09\u7c7b\uff1a</p>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#vars","title":"vars","text":"<pre><code>    globals()\n        Return the dictionary containing the current scope's global variables.\n\n    locals()\n        Return a dictionary containing the current scope's local variables.\n\n    vars(...)\n        vars([object]) -&gt; dictionary\n\n        Without arguments, equivalent to locals().\n        With an argument, equivalent to object.__dict__.\n</code></pre>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#math","title":"math","text":"<pre><code>    abs(x, /)\n        Return the absolute value of the argument.\n\n    divmod(x, y, /)\n        Return the tuple (x//y, x%y).  Invariant: div*y + mod == x.\n\n    max(...)\n\n    min(...)\n\n    pow(x, y, z=None, /)\n        Equivalent to x**y (with two arguments) or x**y % z (with three arguments)\n\n    round(...)\n        round(number[, ndigits]) -&gt; number\n\n    sorted(iterable, /, *, key=None, reverse=False)\n        Return a new list containing all items from the iterable in ascending order.\n\n    sum(iterable, start=0, /)\n        Return the sum of a 'start' value (default: 0) plus an iterable of numbers\n</code></pre> <p>\u66f4\u591a\u53ef\u53c2\u8003 math\u3001cmath \u7b49 C \u6807\u51c6\u7684\u6570\u5b66\u5e93\u6a21\u5757\uff0c\u6216\u5b89\u88c5\u66f4\u4e13\u4e1a\u7684\u7b2c\u4e09\u65b9\u79d1\u5b66\u8ba1\u7b97\u5e93 SciPy \u7ec4\u7ec7\u63d0\u4f9b\u7684 SciPy \u548c NumPy\u3002  </p>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#inspectisbuiltin","title":"inspect.isbuiltin","text":"<p>\u7531\u4e8e python3 \u63a7\u5236\u53f0 REPL \u9ed8\u8ba4\u5bfc\u5165\u4e86 builtins \u6a21\u5757\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u8f93\u5165\u51fd\u6570\u7b26\u53f7\u540d\uff0c\u5982\u4e0b\u663e\u793a\u5219\u4e3a\u5185\u7f6e\u51fd\u6570\uff1a</p> <pre><code>&gt;&gt;&gt; len\n&lt;built-in function len&gt;\n&gt;&gt;&gt; open\n&lt;built-in function open&gt;\n&gt;&gt;&gt; print\n&lt;built-in function print&gt;\n</code></pre> <p>\u53e6\u5916\uff0c\u4e5f\u53ef\u901a\u8fc7 <code>inspect.isbuiltin(object)</code> \u5224\u65ad object \u662f\u5426\u4e3a\u5185\u7f6e\u51fd\u6570\uff1a</p> <pre><code>inspect.isbuiltin(object)\nReturn true if the object is a built-in function or a bound built-in method.\n</code></pre> <p>\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>&gt;&gt;&gt; inspect.isbuiltin(print)\nTrue\n&gt;&gt;&gt; inspect.isbuiltin(len)\nTrue\n&gt;&gt;&gt; inspect.isbuiltin(hex)\nTrue\n&gt;&gt;&gt; inspect.isbuiltin(str)\nFalse\n&gt;&gt;&gt; inspect.isbuiltin(string)\nFalse\n</code></pre>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#inspect_in_builtins","title":"inspect in builtins","text":"<p>\u7531\u4e8e python3 \u63a7\u5236\u53f0 REPL \u9ed8\u8ba4\u5bfc\u5165\u4e86 builtins \u6a21\u5757\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u8f93\u5165\u7c7b\u540d\uff0c\u6839\u636e\u8f93\u51fa\u7684\u63d0\u793a\u4fe1\u606f\u5224\u65ad\u662f\u5426\u4e3a\u5185\u5efa\u6a21\u5757\uff1a</p> <p>str \u4e3a\u5185\u5efa\u7c7b\u578b\uff08\u5728 builtins \u6a21\u5757\u4e2d\uff09\uff0cstring \u4e0d\u662f\u5185\u5efa\u7c7b\u578b\uff08\u4f46\u662f\u6807\u51c6\u5e93\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; str\n&lt;class 'str'&gt;\n\n&gt;&gt;&gt; string\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nNameError: name 'string' is not defined\n</code></pre> <p>enumerate \u4e3a\u5185\u5efa\u7c7b\u578b\uff0cenum \u4e0d\u662f\u5185\u5efa\u7c7b\u578b\uff1a</p> <pre><code>&gt;&gt;&gt; enum\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nNameError: name 'enum' is not defined\n\n&gt;&gt;&gt; enumerate\n&lt;class 'enumerate'&gt;\n</code></pre> <p>date \u548c datetime \u975e\u5185\u5efa\u7c7b\u578b\uff1a</p> <pre><code>&gt;&gt;&gt; date\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nNameError: name 'date' is not defined\n\n&gt;&gt;&gt; datetime\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nNameError: name 'datetime' is not defined\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7 in dir(builtins) \u5224\u65ad\u662f\u5426\u5728dir\u5217\u8868\u4e2d\uff0c\u6765\u5224\u65ad\u7b26\u53f7\u662f\u5426\u5728\u5185\u7f6e\u547d\u540d\u7a7a\u95f4 builtins \u4e2d\u3002</p> <pre><code>&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; 'list' in [n for n in dir(builtins) if not n.startswith('_')]\nTrue\n</code></pre> <p>\u6216\u8005\u5c1d\u8bd5\u6267\u884c <code>help(list)</code> \u6216 <code>dir(list)</code>\uff0c\u770b\u662f\u5426\u6b63\u5e38\u8f93\u51fa\u4ece\u800c\u5224\u65ad\u662f\u5426\u5305\u542b\u5728\u5185\u7f6e\u547d\u540d\u7a7a\u95f4 builtins \u4e2d\u3002</p>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#classes","title":"CLASSES","text":"<p>builtins \u6a21\u5757\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u57fa\u7840\u7c7b\uff08CLASSES\uff09\uff1a</p> <pre><code>CLASSES\n    object\n        BaseException\n\n        bytearray\n        bytes\n        classmethod\n        complex\n        dict\n        enumerate\n        filter\n        float\n        frozenset\n        int\n            bool\n        list\n        map\n        memoryview\n        property\n        range\n        reversed\n        set\n        slice\n        staticmethod\n        str\n        super\n        tuple\n        type\n        zip\n</code></pre> <p>How do I check whether a module is installed or not in Python? </p> <p>How to Check if a List, Tuple or Dictionary is Empty in Python </p> <pre><code>&gt;&gt;&gt; str.__module__\n'builtins'\n\n&gt;&gt;&gt; import inspect\n&gt;&gt;&gt; inspect.getmodule(str)\n&lt;module 'builtins' (built-in)&gt;\n</code></pre>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#str","title":"str","text":"<p>Text Sequence Type \u2014 str</p> <p>Textual data in Python is handled with str objects.</p> <p>\u5b57\u7b26\u4e32\u7c7b str \u662f python \u6700\u5e38\u7528\u7684\u7c7b\uff0c\u7528\u6765\u5904\u7406\u6587\u672c\u6570\u636e\u3002</p> <p>\u5b57\u7b26\u4e32\u6709\u4e09\u79cd\u5b9a\u4e49\u65b9\u5f0f\uff1a</p> <ul> <li>Single quotes: <code>'allows embedded \"double\" quotes'</code> </li> <li>Double quotes: <code>\"allows embedded 'single' quotes\"</code> </li> <li>Triple quoted: <code>'''Three single quotes''', \"\"\"Three double quotes\"\"\"</code> </li> </ul> <p>Triple quoted strings may span multiple lines - all associated whitespace will be included in the string literal.</p> <p>\u5176\u4e2d\u5355\u5f15\u53f7\u5b9a\u4e49\u7684\u5b57\u7b26\u4e32\u4e2d\u53ef\u643a\u5e26\u53cc\u5f15\u53f7\uff1b\u53cc\u5f15\u53f7\u5b9a\u4e49\u7684\u5b57\u7b26\u4e32\u4e2d\u53ef\u643a\u5e26\u5355\u5f15\u53f7\u3002 \u82e5\u60f3\u4ee5\u8de8\u884c\u6a21\u5f0f\u5b9a\u4e49\u957f\u5b57\u7b26\u4e32\uff0c\u5219\u53ef\u8003\u8651\u4f7f\u7528\u4e09\u5f15\u53f7\uff0c\u652f\u6301\u6362\u884c\u4e66\u5199\u3002  </p> <p>\u4e24\u4e2a\u76f8\u90bb\u7684\u5b57\u7b26\u4e32\u5b57\u9762\u91cf\u4f1a\u81ea\u52a8\u8fde\u63a5\uff1a</p> <pre><code>&gt;&gt;&gt; str1='Py' 'thon'\n&gt;&gt;&gt; str1\n'Python'\n\n&gt;&gt;&gt; prefix='Py'\n&gt;&gt;&gt; prefix+'thon'\n'Python'\n</code></pre> <p>\u5f53\u4e66\u5199\u957f\u5b57\u7b26\u4e32\u65f6\uff0c\u4f7f\u7528 <code>()</code> \u5b9a\u4e49\u591a\u4e2a\u5b57\u9762\u91cf\u90e8\u5206\uff0c\u6362\u884c\u65f6\u81ea\u52a8\u8de8\u884c\u7eed\u63a5\uff0c\u76f4\u5230\u53cd\u62ec\u53f7\u7ed3\u675f\uff1a</p> <pre><code># \u5c0f\u62ec\u53f7\u5b9a\u4e49\u591a\u4e2a\u5b57\u9762\u91cf\u62fc\u63a5\n&gt;&gt;&gt; text=('Put several strings within parentheses '\n... 'to have them joined together.')\n&gt;&gt;&gt; text\n'Put several strings within parentheses to have them joined together.'\n\n# \u4e09\u5f15\u53f7\u8de8\u884c\u4e66\u5199\u957f\u5b57\u7b26\u4e32\n&gt;&gt;&gt; text='''Put several strings within parentheses \n... to have them joined together.'''\n&gt;&gt;&gt; text\n'Put several strings within parentheses \\nto have them joined together.'\n</code></pre> <p><code>str[subscripted_index]</code>\uff1a\u57fa\u4e8e\u811a\u6807\u7d22\u5f15\u8bbf\u95ee\u6307\u5b9a\u4f4d\u7f6e\u7684\u5b57\u7b26\uff08\u4f4d\u7f6e\u5bf9\u5e94\u957f\u5ea6\u4e3a1\u7684\u5b50\u4e32\uff09\u3002</p> <p>Strings can be indexed (subscripted), with the first character having index 0. There is no separate character type; a character is simply a string of size one:</p> <p><code>str[start:stop]</code>\uff1a\u8bbf\u95ee\u7d22\u5f15\u533a\u95f4\u4e3a <code>[start, stop)</code> \u5bf9\u5e94\u7684\u5b50\u5b57\u7b26\u4e32\u3002</p> <p>subscripted_index\u3001start\u3001stop \u5747\u53ef\u4e3a\u8d1f\u6570\uff0c\u5176\u4e2d -1 \u7d22\u5f15\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u4f9d\u6b21\u7c7b\u63a8\u3002</p>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#numeric_types","title":"Numeric Types","text":"<p>Numeric Types</p> <ul> <li>int\uff1a\u6574\u5f62  </li> <li>float\uff1a\u6d6e\u70b9\u578b  </li> <li>complex\uff1a\u590d\u6570  </li> </ul>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#binary_sequence_types","title":"Binary Sequence Types","text":"<ul> <li>bytes objects are immutable sequences of single bytes.  </li> <li>bytearray objects are a mutable counterpart to bytes objects.  </li> </ul> <p>String and Bytes literals Bytes and Bytearray Operations </p>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#sequence_types","title":"Sequence Types","text":"<p>Sequence Types</p>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#list","title":"list","text":"<p>\u5217\u8868 list \u5b9a\u4e49\u683c\u5f0f\u4e3a\uff1a[e1, e2, e3, ...]  </p> <p>\u5176\u4e2d e \u53ef\u4ee5\u4e3a\u57fa\u672c\u7c7b\u578b\u6216 tuple\u3001list\u3001set\u3001dict \u7b49\u590d\u5408\u7c7b\u578b</p> <pre><code># [\u6574\u5f62,\u5b57\u7b26\u4e32,\u5143\u7ec4,\u5217\u8868,\u96c6\u5408,\u5b57\u5178]\n&gt;&gt;&gt; list1=[1,'2',(3,4),[5,6],{7,8},{'a':9,'b':10}]\n&gt;&gt;&gt; len(list1)\n6\n</code></pre> <p>\u9488\u5bf9\u6807\u91cf\u6570\u503c\u7c7b\u578b\uff0c\u53ef\u4f7f\u7528\u6bd4 list \u66f4\u9ad8\u6548\u7684 array \u7c7b\u578b\uff08Efficient arrays of numeric values\uff09\u3002</p> <p>Arrays are sequence types and behave very much like lists, except that the type of objects stored in them is constrained.</p>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#tuple","title":"tuple","text":"<p>Tuples are immutable sequences, typically used to store collections of heterogeneous data.</p> <p>\u5143\u7ec4 tuple \u5b9a\u4e49\u683c\u5f0f\u4e3a\uff1a(e1, e2, e3, ...)  </p> <p>\u5176\u4e2d e \u53ef\u4ee5\u4e3a\u57fa\u672c\u7c7b\u578b\u6216 tuple\u3001list\u3001set\u3001dict \u7b49\u590d\u5408\u7c7b\u578b</p> <pre><code># (\u6574\u5f62,\u5b57\u7b26\u4e32,\u5143\u7ec4,\u5217\u8868,\u96c6\u5408,\u5b57\u5178)\n&gt;&gt;&gt; tuple1=(1,'2',(3,4),[5,6],{7,8},{'a':9,'b':10})\n&gt;&gt;&gt; len(tuple1)\n6\n</code></pre> <p>\u5185\u7f6e\u51fd\u6570 enumerate() \u4ea7\u751f\u7684\u7ed3\u679c\u4e3a <code>list&lt;tuple&gt;</code>\uff0c\u6bcf\u4e2a\u5217\u8868\u5143\u7d20\u4e3a <code>(index, value)</code> \u4e8c\u5143\u7ec4\uff082-tuples\uff09\u3002</p> <pre><code>&gt;&gt;&gt; help(enumerate)\n\nHelp on class enumerate in module builtins:\n\nclass enumerate(object)\n |  enumerate(iterable[, start]) -&gt; iterator for index, value of iterable\n |  \n |  Return an enumerate object.  iterable must be another object that supports iteration.  The enumerate object yields pairs containing a count (from start, which defaults to zero) and a value yielded by the iterable argument.\n |  enumerate is useful for obtaining an indexed list:\n |      (0, seq[0]), (1, seq[1]), (2, seq[2]), ...\n</code></pre> <p>\u4ee5\u4e0b\u4e3a\u5177\u4f53\u793a\u4f8b\uff1a</p> <pre><code>&gt;&gt;&gt; seasons = ['Spring', 'Summer', 'Fall', 'Winter']\n&gt;&gt;&gt; list(enumerate(seasons))\n[(0, 'Spring'), (1, 'Summer'), (2, 'Fall'), (3, 'Winter')]\n</code></pre>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#range","title":"range","text":"<p>range \u5b9a\u4e49\u4e86\u533a\u95f4\u8303\u56f4\u3002</p> <p>The arguments to the range constructor must be integers (either built-in <code>int</code> or any object that implements the <code>__index__</code> special method).</p> <ul> <li>class range(stop)  </li> <li>class range(start, stop[, step])  </li> </ul> <p>\u5b9a\u4e49\u524d\u5f00\u540e\u95ed\u533a\u95f4 start \u2264 e \uff1c stop\uff0c\u6b65\u8fdb\u4e3a step\u3002</p> <p>start \u9ed8\u8ba4\u4e3a0\uff1bstep \u9ed8\u8ba4\u4e3a1\u3002</p> <pre><code>&gt;&gt;&gt; list(range(10))\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n\n&gt;&gt;&gt; list(range(1, 11))\n[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n\n&gt;&gt;&gt; list(range(0, 30, 5))\n[0, 5, 10, 15, 20, 25]\n</code></pre> <p><code>range(start,stop,step)</code> \u53ef\u7528 while \u5faa\u73af\u7b49\u6548\u5b9e\u73b0\uff1a</p> <pre><code>&gt;&gt;&gt; start=0\n&gt;&gt;&gt; stop=30\n&gt;&gt;&gt; step=5\n\n&gt;&gt;&gt; r=range(start,stop,step)\n&gt;&gt;&gt; list(r)\n[0, 5, 10, 15, 20, 25]\n\n# range \u7684\u7b49\u6548\u5b9a\u4e49\n&gt;&gt;&gt; i=0\n&gt;&gt;&gt; v=0\n&gt;&gt;&gt; while True:\n...     v = start+i*step\n...     if v &gt;= stop:\n...         break\n...     else:\n...         print('v[%d] = %d' % (i, v))\n...         i += 1\n... \nv[0] = 0\nv[1] = 5\nv[2] = 10\nv[3] = 15\nv[4] = 20\nv[5] = 25\n</code></pre> <p>\u5178\u578b\u5e94\u7528\u662f stop \u53d6 len(list)\uff0c\u57fa\u4e8e\u7d22\u5f15\u5faa\u73af\u904d\u5386\u5217\u8868\uff1a</p> <pre><code>&gt;&gt;&gt; for i in range(len(list1)):\\\n...     print(list1[i])\n... \n1\n2\n(3, 4)\n[5, 6]\n{8, 7}\n{'a': 9, 'b': 10}\n</code></pre>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#set_types","title":"Set Types","text":"<p>Set Types \u2014 set, frozenset</p> <ul> <li>set\uff1a\u65e0\u5e8f\u96c6\u5408  </li> </ul> <p>A set object is an unordered collection of distinct hashable objects.</p> <p>\u96c6\u5408\u5b9a\u4e49\u683c\u5f0f\u4e3a\uff1a{e1, e2, e3, ...}  </p> <p>\u5176\u4e2d e \u53ef\u4ee5\u4e3a\u57fa\u672c\u7c7b\u578b\u6216 tuple \u7c7b\u578b</p> <pre><code>&gt;&gt;&gt; set1={1,'2',(3,4)}\n&gt;&gt;&gt; len(set1)\n3\n</code></pre> <p>set \u4e2d\u7684\u5143\u7d20\u5fc5\u987b\u63d0\u4f9b <code>__hash__()</code> \u65b9\u6cd5\uff0c\u4e3a hashable\uff08has a hash value\uff09\uff0c\u5426\u5219\u62a5\u9519 <code>TypeError: unhashable type:</code></p> <pre><code>&gt;&gt;&gt; set2={1,'2',(3,4),[5,6]}\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nTypeError: unhashable type: 'list'\n&gt;&gt;&gt; set3={1,'2',(3,4),{7,8}}\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nTypeError: unhashable type: 'set'\n&gt;&gt;&gt; set4={1,'2',(3,4),{'a':9,'b':10}}\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nTypeError: unhashable type: 'dict'\n</code></pre> <p>\u66f4\u591a\u5bb9\u5668\u76f8\u5173\u7684\u7c7b\u578b\uff0c\u53ef\u53c2\u8003 collections\u3002</p>","tags":["builtins"]},{"location":"blog/20191203/4-python-builtins/#mapping_types","title":"Mapping Types","text":"<p>Mapping Types \u2014 dict</p> <ul> <li>dict\uff1a\u65e0\u5e8f\u5b57\u5178(\u952e\u503c\u5bf9\u6620\u5c04)  </li> </ul> <p>A mapping object maps hashable values to arbitrary objects. Mappings are mutable objects. There is currently only one standard mapping type, the dictionary. A dictionary\u2019s keys are almost arbitrary values. Values that are not hashable, that is, values containing lists, dictionaries or other mutable types may not be used as keys.  </p> <ul> <li>key \u5fc5\u987b\u4e3a arbitrary\uff08hashable\uff09\uff0clist\u3001set\u3001dict \u7b49 unhashable \u7c7b\u578b\u4e0d\u80fd\u4f5c\u4e3a\u952e\uff1b  </li> <li>value \u53ef\u4e3a not hashable \u6216 hashable\u3002  </li> </ul> <pre><code>&gt;&gt;&gt; dict1[squares]=3\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nTypeError: unhashable type: 'list'\n&gt;&gt;&gt; dict1[3]=squares\n&gt;&gt;&gt; dict1\n{3: [1, 4, 9, 16, 25]}\n</code></pre>","tags":["builtins"]},{"location":"blog/20191203/5-python-modules/","title":"python\u5e38\u7528\u6a21\u5757\u6982\u89c8","text":"<p>Python\u5185\u7f6e\u6a21\u5757 builtins \u6982\u89c8\uff0c\u5305\u62ec\u5e38\u89c1 FUNCTIONS \u548c\u57fa\u7840 CLASSES\u3002</p> <p>Popular Modules </p> <pre><code>inspect.getmodule(object)\nTry to guess which module an object was defined in.\n</code></pre>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#sys","title":"sys","text":"<ul> <li> <p>sys  </p> <p>This module provides access to some objects used or maintained by the  interpreter and to functions that interact strongly with the interpreter.</p> </li> <li> <p>os  </p> <p>OS routines for NT or Posix depending on what system we're on.  </p> </li> <li> <p>platform  </p> <p>This module tries to retrieve as much platform-identifying data as possible.  </p> </li> </ul> <p>Python\u4e2d\u5224\u65ad\u5f53\u524d\u7cfb\u7edf\u7248\u672c\u4fe1\u606f</p>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#argparse","title":"argparse","text":"<ul> <li> <p>getopt  </p> <p>Parser for command line options. This module helps scripts to parse the command line arguments in <code>sys.argv</code>.  It supports the same conventions as the Unix <code>getopt()</code> function.  </p> </li> <li> <p>optparse  </p> <p>A powerful, extensible, and easy-to-use option parser.</p> </li> <li> <p>argparse  </p> <p>Command-line parsing library</p> </li> </ul> <p>\u901a\u8fc7 getopt \u53ef\u89e3\u6790 Python \u4f20\u5165\u7684\u53c2\u6570\uff0cargparse \u5219\u662f\u4e00\u4e2a\u53ef\u4ee5\u81ea\u52a8\u751f\u6210\u4f7f\u7528\u5e2e\u52a9\uff08usage\uff09\u7684 Python \u6a21\u5757\u3002  </p> <p>\u4ece2.7\u5f00\u59cb\u5e9f\u5f03 optparse \u6a21\u5757\uff0c\u5efa\u8bae\u4f7f\u7528 argparse\u3002</p> <p>argparse module is an optparse-inspired command-line parsing library</p> <p>\u53c2\u8003\uff1a</p> <p>Python\u547d\u4ee4\u884c\u53c2\u6570\u89e3\u6790\uff1agetopt\u548cargparse python\u547d\u4ee4\u884c\u53c2\u6570\u5904\u7406\uff1aargparse\u3001optparse\u548cgetopt python\u5165\u95e8\uff1asys.argv\u4e0eoptparse\u4e0eargparse\u4e0egetopt\u7684\u533a\u522b </p>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#string","title":"string","text":"<ul> <li> <p>string  </p> <p>A collection of string constants.  </p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#path_utilities","title":"path utilities","text":"<ul> <li>pathlib </li> <li> <p>nturl2path/macurl2path  </p> <p>Macintosh-specific module for conversion between pathnames and URLs.  </p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#glob__re","title":"glob &amp; re","text":"<ul> <li> <p>glob  </p> <p>Filename globbing utility.</p> </li> <li> <p>re  </p> <p>Support for regular expressions (RE).</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#time","title":"time","text":"<ul> <li> <p>time  </p> <p>This module provides various functions to manipulate time values.  </p> </li> <li> <p>datetime  </p> <p>Fast implementation of the datetime type.  </p> </li> <li> <p>timeit  </p> <p>Tool for measuring execution time of small code snippets.</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#config","title":"config","text":"<ul> <li> <p>sysconfig  </p> <p>Access to Python's configuration information.  </p> </li> <li> <p>configparser  </p> <p>Configuration file parser.  </p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#serialization","title":"serialization","text":"<ul> <li> <p>xml  </p> <p>Core XML support for Python.  </p> </li> <li> <p>json  </p> </li> </ul> <p>JSON (JavaScript Object Notation) http://json.org is a subset of JavaScript syntax (ECMA-262 3rd edition) used as a lightweight data interchange format.</p> <ul> <li> <p>plistlib  </p> <p>a tool to generate and parse MacOSX .plist files.  </p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#storage","title":"storage","text":"<ul> <li> <p>tempfile  </p> <p>Temporary files. This module provides generic, low- and high-level interfaces for creating temporary files and directories.  </p> </li> <li> <p>sqlite3  </p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#crypt","title":"crypt","text":"<ul> <li> <p>random  </p> <p>Random variable generators.  </p> </li> <li> <p>base64  </p> <p>Base16, Base32, Base64 (RFC 3548), Base85 and Ascii85 data encodings.  </p> </li> <li> <p>binhex  </p> <p>Macintosh binhex compression/decompression.  </p> </li> <li> <p>secrets  </p> <p>Generate cryptographically strong pseudo-random numbers suitable for managing secrets such as account authentication, tokens, and similar.  </p> </li> <li> <p>crypt  </p> <p>Wrapper to the POSIX crypt library call and associated functionality.  </p> </li> <li> <p>ssl  </p> <p>This module provides some more Pythonic support for SSL.  </p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#threading","title":"threading","text":"<ul> <li>signal  </li> <li> <p>threading  </p> <p>Thread module emulating a subset of Java's threading model.</p> </li> <li> <p>dummy_threading  </p> <p>Faux <code>threading</code> version using <code>dummy_thread</code> instead of <code>thread</code>.</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#network","title":"network","text":"<ul> <li> <p>ipaddress  </p> <p>A fast, lightweight IPv4/IPv6 manipulation library in Python. This library is used to create/poke/manipulate IPv4 and IPv6 addresses and networks.  </p> </li> </ul> <pre><code>&gt;&gt;&gt; import socket\n# indicating if IPv6 is supported\n&gt;&gt;&gt; socket.has_ipv6\nTrue\n</code></pre>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#socket","title":"socket","text":"<ul> <li> <p>socket  </p> <p>This module provides socket operations and some related functions. On Unix, it supports IP (Internet Protocol) and Unix domain sockets. On other systems, it only supports IP. Functions specific for a socket are available as methods of the socket object.</p> </li> <li> <p>socketserver  </p> <p>Generic socket server classes.  </p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#select","title":"select","text":"<ul> <li> <p>select  </p> <p>This module supports asynchronous I/O on multiple file descriptors.</p> </li> <li> <p>selectors  </p> <p>Selectors module. This module allows high-level and efficient I/O multiplexing, built upon the <code>select</code> module primitives.  </p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#asyncio","title":"asyncio","text":"<ul> <li> <p>asynchat  </p> <p>A class supporting chat-style (command/response) protocols. This class adds support for 'chat' style protocols - where one side sends a 'command', and the other sends a response (examples would be the common internet protocols - smtp, nntp, ftp, etc..).</p> </li> <li> <p>asyncio  </p> <p>The asyncio package, tracking PEP 3156.</p> </li> <li> <p>asyncore  </p> <p>Basic infrastructure for asynchronous socket service clients and servers.</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#urllib","title":"urllib","text":"<ul> <li> <p>urllib  </p> <ul> <li>error  </li> <li>parse  </li> <li>request  </li> <li>response  </li> <li>robotparser  </li> </ul> </li> <li> <p>webbrowser  </p> <p>Interfaces for launching and remotely controlling Web browsers.</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#html__http","title":"html &amp; http","text":"<ul> <li> <p>html  </p> <p>General functions for HTML manipulation.</p> </li> <li> <p>http  </p> <ul> <li>client  </li> <li>cookiejar  </li> <li>cookies  </li> <li>server  </li> </ul> </li> <li> <p>cgi  </p> <p>Support module for CGI (Common Gateway Interface) scripts. This module defines a number of utilities for use by CGI scripts written in Python.</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#other_libs","title":"other libs","text":"<ul> <li> <p>ftplib  </p> <p>An FTP client class and some helper functions.</p> </li> <li> <p>smtpd  </p> <p>An RFC 5321 smtp proxy with optional RFC 1870 and RFC 6531 extensions.</p> </li> <li> <p>smtplib  </p> <p>SMTP/ESMTP client class.</p> </li> <li> <p>telnetlib  </p> <p>TELNET client class.</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#trace","title":"trace","text":"","tags":["module"]},{"location":"blog/20191203/5-python-modules/#syslog","title":"syslog","text":"<ul> <li>syslog  </li> <li> <p>logging  </p> <p>Logging package for Python. Based on PEP 282 and comments thereto in comp.lang.python.</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#trace_1","title":"trace","text":"<ul> <li> <p>symtable  </p> <p>Interface to the compiler's internal symbol tables</p> </li> <li> <p>trace  </p> <p>program/module to trace Python program or function execution</p> </li> <li> <p>traceback  </p> <p>Extract, format and print information about Python stack traces.</p> </li> </ul>","tags":["module"]},{"location":"blog/20191203/5-python-modules/#test","title":"test","text":"<ul> <li> <p>unittest  </p> <p>Python unit testing framework</p> </li> <li> <p>test  </p> <p>Dummy file to make this directory a package.</p> </li> </ul> <p>\u53c2\u8003\uff1a</p> <ul> <li>Python\u5355\u5143\u6d4b\u8bd5\u2014\u2014\u6df1\u5165\u7406\u89e3unittest </li> <li>Python\u5fc5\u4f1a\u7684\u5355\u5143\u6d4b\u8bd5\u6846\u67b6 \u2014\u2014 unittest </li> </ul>","tags":["module"]},{"location":"blog/20191206/1-string/","title":"python\u5e38\u7528\u6a21\u5757\u4e4bstring","text":"<p>\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86 python \u4e2d\u5b57\u7b26\u4e32\u7c7b string\uff0c\u5305\u62ec constants\u3001Formatter \u548c Template\u3002</p> <p><code>str</code> \u662f built-in string class\uff0c<code>string</code> \u662f A collection of string constants\u3002</p>","tags":["version"]},{"location":"blog/20191206/1-string/#help","title":"help","text":"<p>\u6a21\u5757 string \u5b9a\u4e49\u4e86\u4e00\u4e9b\u5b57\u7b26\u7c7b\u578b\u96c6\u5e38\u91cf\uff1a</p> <pre><code># \u6216\u76f4\u63a5\u8f93\u5165 help('string')\n&gt;&gt;&gt; import string\n&gt;&gt;&gt; print(string.__doc__)\nA collection of string constants.\n\nPublic module variables:\n\nwhitespace -- a string containing all ASCII whitespace\nascii_lowercase -- a string containing all ASCII lowercase letters\nascii_uppercase -- a string containing all ASCII uppercase letters\nascii_letters -- a string containing all ASCII letters\ndigits -- a string containing all ASCII decimal digits\nhexdigits -- a string containing all ASCII hexadecimal digits\noctdigits -- a string containing all ASCII octal digits\npunctuation -- a string containing all ASCII punctuation characters\nprintable -- a string containing all ASCII characters considered printable\n</code></pre> <pre><code>&gt;&gt;&gt; string.digits\n'0123456789'\n&gt;&gt;&gt; '5' in string.digits\nTrue\n\n&gt;&gt;&gt; string.hexdigits\n'0123456789abcdefABCDEF'\n&gt;&gt;&gt; 'f' in string.hexdigits\nTrue\n</code></pre>","tags":["version"]},{"location":"blog/20191206/1-string/#formatter","title":"Formatter","text":"<p>Custom String Formatting</p> <p>The built-in string class provides the ability to do complex variable substitutions and value formatting via the format() method described in PEP 3101. The Formatter class in the string module allows you to create and customize your own string formatting behaviors using the same implementation as the built-in <code>format()</code> method.</p> <pre><code>class string.Formatter\nThe Formatter class has the following public methods:\n\nformat(format_string, *args, **kwargs)\n    The primary API method. It takes a format string and an arbitrary set of positional and keyword arguments. It is just a wrapper that calls vformat().\n\nvformat(format_string, args, kwargs)\n    This function does the actual work of formatting. It is exposed as a separate function for cases where you want to pass in a predefined dictionary of arguments, rather than unpacking and repacking the dictionary as individual arguments using the *args and **kwargs syntax.\n</code></pre>","tags":["version"]},{"location":"blog/20191206/1-string/#template","title":"Template","text":"<pre><code>CLASSES\n    builtins.object\n        Formatter\n        Template\n</code></pre> <p>The string module provides a Template class that implements these rules. The methods of Template are:</p> <p>class string.Template(template)</p> <p>The constructor takes a single argument which is the template string.</p> <pre><code>&gt;&gt;&gt; from string import Template\n&gt;&gt;&gt; s = Template('$who likes $what')\n&gt;&gt;&gt; s.substitute(who='tim', what='kung pao')\n'tim likes kung pao'\n</code></pre> <p>TDW\uff08\u817e\u8baf\u7684\u5206\u5e03\u5f0f\u6570\u636e\u4ed3\u5e93\uff09  HIVE SQL \u4f7f\u7528\u4e86 python \u4f5c\u4e3a\u6d41\u7a0b\u63a7\u5236\u8bed\u8a00\uff0c\u4ee5\u4e0b\u6458\u81ea\u67d0\u6bb5\u683c\u5f0f\u5316\u67e5\u8be2\u811a\u672c\uff1a</p> <pre><code># \u6a21\u677f\uff08\u5927\u62ec\u53f7\u53ef\u7701\u7565\uff09\nsql_query_t = 'SELECT * FROM ${db}::${tbl} WHERE time=${date}'\n# \u683c\u5f0f\u5316\u66ff\u6362\u53c2\u6570\nsql_query = string.Template(sql_query_t).substitute(db='myDB', tbl='myTable', date='20180108')\n# \u6267\u884c sql\ntdwqe.execute(sql_query)\n</code></pre>","tags":["version"]},{"location":"blog/20191206/10-io/","title":"python\u4e2d\u7684\u6587\u4ef6io\u64cd\u4f5c","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 python \u4e2d\u7684 io \u6a21\u5757\uff0c\u5305\u62ec\u6253\u5f00\u6587\u4ef6\u548c\u8bfb\u5199\u5904\u7406\u57fa\u672c\u64cd\u4f5c\u3002</p> <p>open </p> <p>io \u2014 Core tools for working with streams</p> <p>7.2. Reading and Writing Files</p>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#help","title":"help","text":"<p>\u8981\u6253\u5f00\u6587\u4ef6\uff0c\u53ef\u4f7f\u7528\u5185\u7f6e\u7684\u51fd\u6570 <code>open</code>\uff0c\u5b83\u5b9e\u9645\u4f4d\u4e8e\u81ea\u52a8\u5bfc\u5165\u7684\u6a21\u5757io\u4e2d\u3002 \u76f8\u5f53\u4e8e builtins \u6a21\u5757\u4e2d\u6267\u884c\u4e86 <code>from io import open</code>\u3002</p> <pre><code>&gt;&gt;&gt; help(open)\n\nHelp on built-in function open in module io:\n\nopen(file, mode='r', buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)\n    Open file and return a stream.  Raise OSError upon failure.\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5148\u5bfc\u5165 io \u6a21\u5757\uff08<code>import io</code>\uff09\uff0c\u518d help(io) \u6216 help(io.open) \u67e5\u770b\u5b8c\u6574\u5e2e\u52a9\u3002</p> <pre><code>&gt;&gt;&gt; import io\n&gt;&gt;&gt; help(io.open)\n</code></pre> <p><code>open</code>() returns a file object, and is most commonly used with two positional arguments and one keyword argument:</p> <p>open(filename, mode, encoding=None)</p>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#open","title":"open","text":"<p>The first argument <code>file</code> is a string containing the filename.</p> <p>\u51fd\u6570 open \u5c06\u6587\u4ef6\u540d\u4f5c\u4e3a\u552f\u4e00\u5fc5\u4e0d\u53ef\u5c11\u7684\u53c2\u6570\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8c61\u3002 \u5982\u679c\u5f53\u524d\u76ee\u5f55\u4e2d\u6709\u4e00\u4e2a\u540d\u4e3asomefile.txt\u7684\u6587\u672c\u6587\u4ef6\uff08\u53ef\u80fd\u662f\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u521b\u5efa\u7684\uff09\uff0c\u5219\u53ef\u50cf\u4e0b\u9762\u8fd9\u6837\u6253\u5f00\u5b83\uff1a</p> <p>f = open('somefile.txt')</p> <p>\u5982\u679c\u6587\u4ef6\u4f4d\u4e8e\u5176\u4ed6\u5730\u65b9\uff0c\u53ef\u6307\u5b9a\u76f8\u5bf9\u8def\u5f84\u6216\u5b8c\u6574\u7684\u7edd\u5bf9\u8def\u5f84\u3002</p> <pre><code>&gt;&gt;&gt; fp = open('test.py')\n&gt;&gt;&gt; # io manipulation\n&gt;&gt;&gt; fp.close()\n</code></pre> <p>\u6700\u7ec8\u6587\u4ef6\u4e0d\u7528\u65f6\uff0c\u9700\u8981\u663e\u5f0f\u8c03\u7528 fp.<code>close</code>() \u5173\u95ed\u6587\u4ef6\u3002</p>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#mode","title":"mode","text":"<p>The second argument <code>mode</code> is another string containing a few characters describing the way in which the file will be used.</p> <p>The mode argument is optional; <code>'r'</code> will be assumed if it\u2019s omitted.</p> <pre><code>    ========= ===============================================================\n    Character Meaning\n    --------- ---------------------------------------------------------------\n    'r'       open for reading (default)\n    'w'       open for writing, truncating the file first\n    'x'       create a new file and open it for writing\n    'a'       open for writing, appending to the end of the file if it exists\n    'b'       binary mode\n    't'       text mode (default)\n    '+'       open a disk file for updating (reading and writing)\n    'U'       universal newline mode (deprecated)\n    ========= ===============================================================\n</code></pre> <p>Normally, files are opened in text mode(<code>'t'</code>), that means, you read and write strings from and to the file, which are encoded in a specific encoding.</p> <p>\u9ed8\u8ba4 mode='r'\uff0c\u5373\u4ee5\u53ea\u8bfb\u3001\u6587\u672c\u6a21\u5f0f(<code>rt</code>)\u6253\u5f00\u6587\u4ef6\u3002</p> <p>In text mode (the default, or when 't' is included in the mode argument), the contents of the file are returned as <code>str</code>, the bytes having been first decoded using a platform-dependent encoding or using the specified encoding if given.</p> <p>Appending a <code>'b'</code> to the mode opens the file in binary mode. Binary mode data is read and written as bytes objects. You can not specify encoding when opening file in binary mode.</p> <p>Files opened in binary mode (including 'b' in the mode argument) return contents as bytes objects without any decoding.</p> <p><code>mode</code>: Must have exactly one of create/read/write/append mode and at most one plus</p> <ol> <li>\u9009\u5b9a\u6253\u5f00\u6a21\u5f0f\uff1a<code>t</code> \u548c <code>b</code> \u4e8c\u9009\u4e00\uff0c\u4ee5\u6587\u672c\u5f62\u5f0f\u6216\u4e8c\u8fdb\u5236\u5f62\u5f0f\u6253\u5f00\u6587\u4ef6\u3002</li> <li>\u9009\u5b9a\u8bfb\u5199\u6a21\u5f0f\uff1a<code>r</code>\u3001<code>x</code>\u3001<code>w</code>\u3001<code>a</code> \u56db\u9009\u4e00\uff0c\u5206\u522b\u662f read/create/write/append\uff0c\u7b2c\u4e00\u79cd\u4e3a\u8bfb\uff0c\u540e\u4e09\u79cd\u90fd\u662f\u5199\u3002</li> <li>\u6700\u591a\u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u52a0\u53f7\uff1a<code>+</code>\u3002</li> </ol> <p>\u6a21\u5f0f\u4f4d\u7ec4\u5408\u793a\u4f8b\uff1a</p> <ol> <li>\u5982\u679c\u6253\u5f00\u7684\u662f <code>tr</code>/<code>br</code>\uff0c\u5982\u679c\u8fd8\u60f3\u5199\uff0c\u53ef\u4ee5\u8ffd\u52a0\u4e00\u4e2a\u52a0\u53f7\uff1a<code>tr+</code>/<code>br+</code>\u3002</li> <li>\u5982\u679c\u6253\u5f00\u7684\u662f <code>ta</code>/<code>ba</code>\uff0c\u5982\u679c\u8fd8\u60f3\u8bfb\uff0c\u53ef\u4ee5\u8ffd\u52a0\u4e00\u4e2a\u52a0\u53f7\uff1a<code>ta+</code>/<code>ba+</code>\u3002</li> </ol>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#with_open","title":"with open","text":"<p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u6f14\u793a\u4e86\u6253\u5f00\u6587\u4ef6\uff08open\uff09\uff0c\u7136\u540e\u8fdb\u884c\u5904\u7406\uff08manipulation\uff09\uff0c\u6700\u540e\u5173\u95ed\u6587\u4ef6\uff08close\uff09\u7684\u6d41\u7a0b\u3002</p> <p>\u65e0\u8bba try \u4e3b\u5904\u7406\u6a21\u5757\u4e2d\u6709\u65e0\u5f02\u5e38\u629b\u51fa\uff0c\u6700\u7ec8\u90fd\u4f1a\u8fdb\u5165 finally \u91ca\u653e\u6587\u4ef6\u53e5\u67c4\u8d44\u6e90\u3002</p> <pre><code>debug = True\nfile = None # io.TextIOWrapper\nshebang = ''\n\ntry:\n    file = open('nosuchfile.md')\n    shebang = file.readline()\n    print(shebang)\n    # manipulation\nexcept Exception as exc:\n    if (debug):\n        print(exc)\n        print(shebang)\n    else:\n        print('A exception flew by!')\n        raise\nfinally:\n    print('finally')\n    if file:\n        file.close()\n</code></pre> <p>It is good practice to use the <code>with</code> keyword when dealing with file objects. The advantage is that the file is properly closed after its suite finishes, even if an exception is raised at some point. Using with is also much shorter than writing equivalent <code>try-finally</code> blocks.  </p> <p>\u5efa\u8bae\u91c7\u7528 with...as \u8bed\u53e5\uff1a<code>with open('test.py') as fp:</code>\u3002</p> <p>\u56e0\u4e3a with \u533a\u5757\u9500\u6bc1\u65f6\u4f1a\u81ea\u52a8\u6267\u884c\u6e05\u7406\u52a8\u4f5c\uff0c\u4ece\u800c\u65e0\u9700\u663e\u5f0f\u8c03\u7528 close\u3002 \u5373\u4f7f\u8bfb\u5199\u6587\u4ef6\u4e2d\u9014\u9047\u5230\u5f02\u5e38\uff0c\u4e5f\u80fd\u5b89\u5168\u56de\u6536\u6587\u4ef6\u8d44\u6e90\u3002 \u53e6\u5916\uff0c\u76f8\u6bd4 try-finally \u533a\u5757\uff0c\u53ef\u4ee5\u7b80\u5316\u4ee3\u7801\u3002</p> <p>If you\u2019re not using the <code>with</code> keyword, then you should call f.<code>close</code>() to close the file and immediately free up any system resources used by it.</p> <p>Warning Calling f.<code>write</code>() without using the <code>with</code> keyword or calling f.<code>close</code>() might result in the arguments of f.<code>write</code>() not being completely written to the disk, even if the program exits successfully.</p>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#ospath","title":"os.path","text":"<p>\u53c2\u8003 sysos\uff0c\u5bf9\u4e8e\u7ed9\u5b9a\u8def\u5f84\u5b57\u7b26\u4e32\uff0c\u5728\u5c1d\u8bd5\u8c03\u7528 open \u4e4b\u524d\uff0c\u53ef\u8c03\u7528 os.path \u5148\u884c\u5224\u65ad\u6587\u4ef6\u7684\u5b58\u5728\u6027\u548c\u76f8\u5173\u5c5e\u6027\u3002</p> <ol> <li>\u5224\u65ad\u7ed9\u5b9a\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u76ee\u5f55\uff1aos.path.isdir(path)</li> <li>\u5224\u65ad\u7ed9\u5b9a\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u6587\u4ef6\uff1aos.path.isfile(path)</li> <li>\u5224\u65ad\u7ed9\u5b9a\u5b57\u7b26\u4e32\uff08\u76ee\u5f55\u6216\u6587\u4ef6\uff09\u662f\u5426\u5b58\u5728\uff1aos.path.exists(path)</li> <li>\u83b7\u53d6\u8def\u5f84\u76ee\u5f55\u548c\u6587\u4ef6\u90e8\u5206\uff1aos.path.dirname, os.path.basename</li> <li>\u5206\u79bb\u6216\u7ec4\u5408\u8def\u5f84\u5b57\u7b26\u4e32\uff1aos.path.split(drive, ext)\uff0cos.path.join</li> </ol>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#class_hierarchy","title":"Class hierarchy","text":"<p>\u53ef\u4ee5 import io\uff0c\u7136\u540e\u6267\u884c <code>help(io)</code> \u4e00\u89c8 io \u6a21\u5757\uff0c\u6d89\u53ca\u5230\u7684\u7c7b\u5982\u4e0b\uff1a</p> <pre><code>&gt;&gt;&gt; help(io)\n\nCLASSES\n    _io._BufferedIOBase(_io._IOBase)\n        _io.BufferedRWPair\n        _io.BufferedRandom\n        _io.BufferedReader\n        _io.BufferedWriter\n        _io.BytesIO\n        BufferedIOBase(_io._BufferedIOBase, IOBase)\n    _io._IOBase(builtins.object)\n        IOBase\n            BufferedIOBase(_io._BufferedIOBase, IOBase)\n            RawIOBase(_io._RawIOBase, IOBase)\n            TextIOBase(_io._TextIOBase, IOBase)\n    _io._RawIOBase(_io._IOBase)\n        _io.FileIO\n        RawIOBase(_io._RawIOBase, IOBase)\n    _io._TextIOBase(_io._IOBase)\n        _io.StringIO\n        _io.TextIOWrapper\n        TextIOBase(_io._TextIOBase, IOBase)\n</code></pre> <p>\u5728\u63a7\u5236\u53f0 REPL \u4e2d\uff0c\u501f\u52a9\u5e2e\u52a9 tab \u81ea\u52a8\u8865\u5168\uff0c\u53ef\u4ee5\u770b\u770b io \u6a21\u5757\u5411\u5916\u63d0\u4f9b\u7684\u63a5\u53e3\uff1a</p> <pre><code>&gt;&gt;&gt; help(io.\nio.abc                        io.DEFAULT_BUFFER_SIZE        io.SEEK_END\nio.BlockingIOError(           io.FileIO(                    io.SEEK_SET\nio.BufferedIOBase()           io.IncrementalNewlineDecoder( io.StringIO(\nio.BufferedRandom(            io.IOBase()                   io.text_encoding(\nio.BufferedReader(            io.open(                      io.TextIOBase()\nio.BufferedRWPair(            io.open_code(                 io.TextIOWrapper(\nio.BufferedWriter(            io.RawIOBase()                io.UnsupportedOperation(\nio.BytesIO(                   io.SEEK_CUR\n</code></pre> <p>IOBase \u4e3a\u57fa\u7c7b\uff0cBufferedIOBase \u4e3a\u4e8c\u8fdb\u5236\u5904\u7406\u57fa\u7c7b\uff0cTextIOBase \u4e3a\u6587\u672c\u5904\u7406\u57fa\u7c7b\u3002</p> <ol> <li>\u4e8c\u8fdb\u5236\u76f8\u5173\u5904\u7406\uff1aBufferedReader/BufferedWriter \u548c BytesIO</li> <li>\u6587\u4ef6\u5904\u7406\u76f8\u5173\uff1aFileIO</li> <li>\u6587\u672c\u76f8\u5173\u5904\u7406\uff1aTextIOWrapper</li> </ol> <ul> <li>io.IOBase </li> <li>io.TextIOBase </li> <li>io.TextIOWrapper </li> </ul> <p>\u6267\u884c <code>type(fp)</code> \u53ef\u4ee5\u67e5\u770b\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\u662f TextIOWrapper \u5bf9\u8c61\uff1a</p> <pre><code>&gt;&gt;&gt; type(fp)\n&lt;class '_io.TextIOWrapper'&gt;\n\n&gt;&gt;&gt; isinstance(f, io.TextIOWrapper)\nTrue\n</code></pre> <p>\u6267\u884c <code>help(io.TextIOWrapper)</code> \u67e5\u770b\u6587\u4ef6\u53e5\u67c4\u5bf9\u8c61\u76f8\u5173\u5e2e\u52a9\u3002</p> <pre><code> |  Method resolution order:\n |      TextIOWrapper\n |      _TextIOBase\n |      _IOBase\n |      builtins.object\n</code></pre> <p>\u501f\u52a9\u5e2e\u52a9 tab \u81ea\u52a8\u8865\u5168\uff0c\u67e5\u770b TextIOWrapper \u7c7b\u5411\u5916\u63d0\u4f9b\u7684\u63a5\u53e3\uff1a</p> <pre><code>&gt;&gt;&gt; help(io.TextIOWrapper.\nio.TextIOWrapper.buffer         io.TextIOWrapper.line_buffering io.TextIOWrapper.seek(\nio.TextIOWrapper.close(         io.TextIOWrapper.mro()          io.TextIOWrapper.seekable(\nio.TextIOWrapper.closed         io.TextIOWrapper.name           io.TextIOWrapper.tell(\nio.TextIOWrapper.detach(        io.TextIOWrapper.newlines       io.TextIOWrapper.truncate(\nio.TextIOWrapper.encoding       io.TextIOWrapper.read(          io.TextIOWrapper.writable(\nio.TextIOWrapper.errors         io.TextIOWrapper.readable(      io.TextIOWrapper.write(\nio.TextIOWrapper.fileno(        io.TextIOWrapper.readline(      io.TextIOWrapper.write_through\nio.TextIOWrapper.flush(         io.TextIOWrapper.readlines(     io.TextIOWrapper.writelines(\nio.TextIOWrapper.isatty(        io.TextIOWrapper.reconfigure(\n</code></pre> <p>\u5bf9\u4e8e\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\uff08TextIOWrapper \u5bf9\u8c61\u5b9e\u4f8b\uff09\uff0c\u53ef\u67e5\u770b\u76f8\u5173\u5c5e\u6027\uff1a</p> <pre><code>&gt;&gt;&gt; fp.name\n'test.py'\n&gt;&gt;&gt; fp.mode\n'r'\n&gt;&gt;&gt; fp.encoding\n'UTF-8'\n&gt;&gt;&gt; fp.newlines\n'\\n'\n</code></pre> <p>\u4e0b\u9762\u4e3b\u8981\u9488\u5bf9\u6587\u672c\u6587\u4ef6\u5904\u7406\uff08TextIOWrapper\uff09\u5c55\u5f00\u8ba8\u8bba\uff0c\u540e\u9762\u6d89\u53ca\u5230\u7f51\u7edc\u7f16\u7a0b\u65f6\u518d\u770b\u770b\u4e8c\u8fdb\u5236\u5904\u7406\u3002</p>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#read","title":"read","text":"<p>\u8981\u4f7f\u7528\u6587\u672c\u6587\u4ef6\u4e2d\u7684\u4fe1\u606f\uff0c\u9996\u5148\u9700\u8981\u5c06\u4fe1\u606f\u8bfb\u53d6\u5230\u5185\u5b58\u4e2d\u3002\u4e3a\u6b64\uff0c\u4f60\u53ef\u4ee5\u4e00\u6b21\u6027\u8bfb\u53d6\u6587\u4ef6\u7684\u5168\u90e8\u5185\u5bb9\uff0c\u4e5f\u53ef\u4ee5\u4ee5\u6bcf\u6b21\u4e00\u884c\u7684\u65b9\u5f0f\u9010\u6b65\u8bfb\u53d6\u3002</p> <p><code>io.TextIOWrapper</code> \u4e2d\u8bfb\u6587\u4ef6\u76f8\u5173\u7684\u63a5\u53e3\u5982\u4e0b\uff1a</p> <pre><code>&gt;&gt;&gt; help(io.TextIOWrapper)\n\n |  read(self, size=-1, /)\n |      Read at most size characters from stream.\n |\n |      Read from underlying buffer until we have size characters or we hit EOF.\n |      If size is negative or omitted, read until EOF.\n |\n |  readline(self, size=-1, /)\n |      Read until newline or EOF.\n |\n |      Return an empty string if EOF is hit immediately.\n |      If size is specified, at most size characters will be read.\n\n |  ----------------------------------------------------------------------\n |  Methods inherited from _IOBase:\n |\n |  readlines(self, hint=-1, /)\n |      Return a list of lines from the stream.\n |\n |      hint can be specified to control the number of lines read: no more\n |      lines will be read if the total size (in bytes/characters) of all\n |      lines so far exceeds hint.\n</code></pre>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#read_1","title":"read","text":"<p><code>read</code> \u65b9\u6cd5\u4ece\u6587\u4ef6\u6700\u591a\uff08\u6216\u8005\u8bf4\u5c3d\u91cf\u5c1d\u8bd5\uff09\u8bfb\u53d6 size \u6307\u5b9a\u6570\u91cf\u7684\u5b57\u7b26\uff08\u5b57\u8282\uff09\u3002 \u5982\u679c\u672a\u6307\u5b9asize\uff0c\u5219\u9ed8\u8ba4\u8bfb\u81f3\u672b\u5c3e\uff08EOF, End Of File\uff09\uff0c\u5373\u8bfb\u53d6\u6574\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> <p>\u5bf9\u4e8e\u6587\u672c\u6a21\u5f0f\uff0cread \u8bfb\u53d6\u8fd4\u56de <code>str</code> \u5bf9\u8c61\uff08\u5305\u542b\u6362\u884c\u7b26\u7684 repr\uff09\u3002</p> <p>Python\u8bfb\u6587\u4ef6\u548cC\u8bed\u8a00\u4e2d\u7684\u6587\u4ef6\u64cd\u4f5c\u7c7b\u4f3c\uff0c\u5185\u90e8\u6709\u6e38\u6807\uff08\u6307\u9488\uff09\u8ddf\u8e2a\u8bfb\u53d6\u4f4d\u7f6e\uff0c\u4ee5\u652f\u6301\u8fed\u4ee3\u8bfb\u53d6\u3002 \u5177\u4f53\u6765\u8bf4\uff0c\u6bcf\u8c03\u7528\u4e00\u6b21\u8bfb\u64cd\u4f5c\uff08read, readline, readlines\uff09\uff0c\u90fd\u4ece\u5f53\u524d\u6e38\u6807\u5f00\u59cb\u8bfb\u53d6\u3002 \u6bcf\u8bfb\u53d6\u4e00\u4e2a\u5b57\u8282\uff0c\u6e38\u6807\u540e\u79fb\u4e00\u4f4d\uff0c\u672c\u6b21\u8bfb\u5b8c\u540e\uff0c\u6e38\u6807\u540e\u79fb\u81f3\u4e0b\u4e00\u4e2a\u5f85\u8bfb\u53d6\u70b9\u3002</p> <p>\u53ef\u4ee5\u8c03\u7528\u7ee7\u627f\u81ea IOBase \u7684 <code>tell</code> \u65b9\u6cd5\uff0c\u83b7\u53d6\u5f53\u524d\u6e38\u6807\u4f4d\u7f6e\uff08\u521d\u59cb\u4e3a0\uff09\u3002</p> <pre><code>&gt;&gt;&gt; help(io.TextIOWrapper)\n\n |  ----------------------------------------------------------------------\n |  Methods inherited from _IOBase:\n |\n |  tell(self, /)\n |      Return the stream position as an opaque number.\n |\n |      The return value of tell() can be given as input to seek(), to restore a\n |      previous stream position.\n</code></pre> <p>\u4ee5\u4e0b read \u548c tell \u914d\u5408\u6f14\u793a\u4e86\u8bfb\u53d6\u6587\u672c\u6587\u4ef6\u4e00\u884c\u7684\u8fc7\u7a0b\u548c\u673a\u5236\uff1a</p> <pre><code># \u6253\u5f00\u6587\u4ef6\n&gt;&gt;&gt; f = open('test.py')\n# \u521d\u59cb\u6e38\u6807\u4f4d\u7f6e\u4e3a0\uff1a\u4e0b\u4e00\u4e2a\u5f85\u8bfb\u521d\u59cb\u4f4d\u7f6e\n&gt;&gt;&gt; f.tell()\n0\n# \u8bfb\u53d62\u4e2a\u5b57\u7b26\uff08\u5b57\u8282\uff09\uff0c\u6e38\u6807\u81ea\u52a8\u540e\u79fb2\u4f4d\n&gt;&gt;&gt; f.read(2)\n'#!'\n&gt;&gt;&gt; f.tell()\n2\n# \u7ee7\u7eed\u8bfb\u53d612\u4e2a\u5b57\u7b26\uff08\u5b57\u8282\uff09\uff0c\u6e38\u6807\u81ea\u52a8\u540e\u79fb12\u4f4d\n&gt;&gt;&gt; f.read(12)\n'/usr/bin/env'\n&gt;&gt;&gt; f.tell()\n14\n# \u7ee7\u7eed\u8bfb\u53d61\u4e2a\u5b57\u7b26\uff08\u5b57\u8282\uff09\uff0c\u6e38\u6807\u81ea\u52a8\u540e\u79fb1\u4f4d\n&gt;&gt;&gt; f.read(1)\n' '\n# \u7ee7\u7eed\u8bfb\u53d67\u4e2a\u5b57\u7b26\uff08\u5b57\u8282\uff09\uff0c\u6e38\u6807\u81ea\u52a8\u540e\u79fb7\u4f4d\n&gt;&gt;&gt; f.read(7)\n'python3'\n&gt;&gt;&gt; f.tell()\n22\n# \u7ee7\u7eed\u8bfb\u53d61\u4e2a\u5b57\u7b26\uff08\u5b57\u8282\uff09\uff0c\u4e3a\u7b2c\u4e00\u884c\u7ed3\u5c3e\u6362\u884c\u7b26\uff1b\u6e38\u6807\u81ea\u52a8\u540e\u79fb1\u4f4d\u81f3\u4e0b\u4e00\u884c\u5f00\u5934\n&gt;&gt;&gt; f.read(1)\n'\\n'\n# \u7ee7\u7eed\u8bfb\u53d61\u4e2a\u5b57\u7b26\uff08\u5b57\u8282\uff09\uff0c\u4e3a\u7b2c\u4e8c\u884c\u7b2c\u4e00\u4e2a\u5b57\u7b26\n&gt;&gt;&gt; f.read(1)\n'#'\n</code></pre>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#seek","title":"seek","text":"<p>\u5982\u679c\u4e2d\u9014\u60f3\u6539\u53d8\u8bfb\u53d6\u7684\u6e38\u6807\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u8003\u8651\u8c03\u7528 seek \u65b9\u6cd5\u3002</p> <pre><code>&gt;&gt;&gt; help(io.TextIOWrapper)\n\n |  ----------------------------------------------------------------------\n |  Methods inherited from _IOBase:\n |\n |  seek(self, cookie, whence=0, /)\n |      Set the stream position, and return the new stream position.\n |\n |        cookie\n |          Zero or an opaque number returned by tell().\n |        whence\n |          The relative position to seek from.\n |\n |      Four operations are supported, given by the following argument\n |      combinations:\n |\n |      - seek(0, SEEK_SET): Rewind to the start of the stream.\n |      - seek(cookie, SEEK_SET): Restore a previous position;\n |        'cookie' must be a number returned by tell().\n |      - seek(0, SEEK_END): Fast-forward to the end of the stream.\n |      - seek(0, SEEK_CUR): Leave the current stream position unchanged.\n |\n |      Any other argument combinations are invalid,\n |      and may raise exceptions.\n |\n |  tell(self, /)\n |      Return the stream position as an opaque number.\n |\n |      The return value of tell() can be given as input to seek(), to restore a\n |      previous stream position.\n</code></pre> <p>\u5176\u4e2d whence \u53c2\u6570\u53ef\u4ee5\u53d6\u4ee5\u4e0b\u679a\u4e3e\u503c\uff0c\u4ee3\u8868\u6587\u4ef6\u5f00\u5934\u3001\u5f53\u524d\u4f4d\u7f6e\u548c\u7ed3\u5c3e\u3002</p> <pre><code>&gt;&gt;&gt; io.SEEK_SET\n0\n&gt;&gt;&gt; io.SEEK_CUR\n1\n&gt;&gt;&gt; io.SEEK_END\n2\n</code></pre> <ol> <li>seek(0, io.SEEK_CUR)\uff1a\u4fdd\u6301\u5f53\u524d\u6e38\u6807\u3002</li> <li> <p>seek(0, io.SEEK_END)\uff1a\u5b9a\u4f4d\u5230\u6587\u4ef6\u7ed3\u5c3e\u3002</p> <ul> <li>\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0ccookie \u5fc5\u987b\u4e3a\u96f6\uff0c\u5426\u5219\u62a5\u9519\uff1aio.UnsupportedOperation: can't do nonzero cur-relative seeks\u3002</li> </ul> </li> <li> <p>seek(0, io.SEEK_SET)\uff1a\u5b9a\u4f4d\u5230\u6587\u4ef6\u5f00\u5934\uff0c\u53ef\u6307\u5b9a cookie \u504f\u79fb\u91cf\u3002</p> <ul> <li>f.seek(2, io.SEEK_SET)\uff1a\u8fd4\u56de\u65b0\u7684\u4f4d\u7f6e\uff0c\u540c f.tell() = 2\u3002</li> </ul> </li> </ol>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#readline","title":"readline","text":"<p>readline: Read until newline or EOF.</p> <p>TextIOWrapper \u7684 <code>readline</code> \u65b9\u6cd5\u57fa\u4e8e newlines\uff08\u9ed8\u8ba4\u4e3a <code>\\n</code>\uff09\u4f5c\u4e3a\u65ad\u884c\u5206\u5272\u7b26\u3002</p> <p>\u5bf9\u4e8e\u6587\u672c\u6a21\u5f0f\uff0creadline \u8bfb\u53d6\u8fd4\u56de<code>str</code> \u5bf9\u8c61\uff0c\u5b83\u662f\u4e00\u884c\u5185\u5bb9\u7684\u5b57\u7b26\u4e32\u8868\u793a\uff08\u5305\u542b\u6362\u884c\u7b26\u7684 repr\uff09\u3002</p> <p>readline \u5982\u679c\u6307\u5b9a\u4e86 size\uff0c\u8bfb\u53d6\u5f53\u524d\u884c\u7684 size \u4e2a\u5b57\u7b26\uff08\u5b57\u8282\uff09\uff1b\u5426\u5219\uff0c\u8bfb\u53d6\u5f53\u524d\u884c\uff08\u5305\u62ec\u884c\u5c3e\u90e8\u6362\u884c\u7b26\uff09\uff0c\u6e38\u6807\u79fb\u52a8\u5230\u4e0b\u4e00\u884c\u5f00\u5934\u3002</p> <pre><code>&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n# \u8bfb\u53d6\u5f53\u524d\u884c\uff083\u4e2a\u5b57\u7b26\uff09\n&gt;&gt;&gt; f.readline(3)\n'#!/'\n# \u7ee7\u7eed\u8bfb\u5b8c\u8be5\u884c\n&gt;&gt;&gt; f.readline()\n'usr/bin/env python3\\n'\n# \u7ee7\u7eed\u8bfb\u53d6\u7b2c\u4e8c\u884c\u7b2c\u4e00\u4e2a\u5b57\u7b26\n&gt;&gt;&gt; f.read(1)\n'#'\n# \u7ee7\u7eed\u8bfb\u5b8c\u7b2c\u4e8c\u884c\n&gt;&gt;&gt; f.readline()\n' -*- coding: UTF-8 -*-\\n'\n# \u7ee7\u7eed\u8bfb\u7b2c\u4e09\u884c\uff08\u7a7a\u884c\uff09\n&gt;&gt;&gt; f.readline()\n'\\n'\n</code></pre> <p>\u5b9e\u9645\u9879\u76ee\u5e94\u7528\u4e2d\uff0c\u53ef\u5728\u5faa\u73af\u4e2d\u8c03\u7528 readline\uff0c\u5b9e\u73b0\u9010\u884c\u8bfb\u53d6\u5904\u7406\u3002 readline \u5e26 size \u76f8\u5f53\u4e8e read \u8bfb\u53d6\u6307\u5b9a\u5b57\u8282\uff0c\u4e0d\u5e26 size \u8bfb\u53d6\u5230\u884c\u5c3e\u3002 \u8fd9\u79cd\u7279\u6027\u9002\u5408\u89e3\u6790\u57fa\u4e8e\u884c\u5206\u5272\u7684 HTTP \u62a5\u6587\uff1aread \u8bfb\u53d6\u62a5\u6587\u5934\uff0creadline \u8bfb\u81f3\u7ed3\u5c3e\u3002</p> <p>\u4ee5\u4e0b\u6f14\u793a\u4e86\u5faa\u73af\u8c03\u7528 readline \u9010\u884c\u8bfb\u53d6\u6587\u672c\u5185\u5bb9\u3002</p> <ol> <li>\u7531\u4e8e\u4e8b\u5148\u4e0d\u77e5\u9053\u603b\u884c\u6570\uff0c\u6545\u7528 while True \u5faa\u73af\uff0c\u5f85\u8bfb\u5230 EOF \u8fd4\u56de None \u65f6 break \u7ed3\u675f\u5faa\u73af\u3002</li> <li>\u7531\u4e8e\u6bcf\u4e00\u884c\u672b\u5c3e\u81ea\u5e26\u6362\u884c\u7b26\uff0cprint \u9ed8\u8ba4\u4f1a\u5728\u672b\u5c3e\uff08end\uff09\u63d2\u5165\u6362\u884c\u7b26\uff0c\u56e0\u6b64\u5e94\u91cd\u8bbe end \u4e3a\u7a7a\uff0c\u6216\u5bf9\u884c\u5185\u5bb9\u6267\u884c rstrip\u3002</li> </ol> <pre><code>with open(filename) as f:\n    while True:\n        line = f.readline()\n        if not line:\n            break\n        print(line, end='') # print(line.rstrip())\n        # manipulation\n</code></pre> <p>\u4ee5\u4e0b\u4ee3\u7801 for \u5faa\u73af\u8bfb\u53d66\u884c\u6587\u672c\uff0c\u6253\u5370\u6bcf\u4e00\u884c\uff0c\u7ed9\u6bcf\u4e00\u884c\u51a0\u4ee5\u884c\u53f7\uff1a</p> <pre><code>import string\n\nMAX_LINES = 6\n\nwith open('test.py') as f:\n    for i in range(MAX_LINES):\n        line = f.readline()\n        if (not line.startswith(tuple(string.whitespace))):\n            print(f'{i+1}:', line, end='')\n            # manipulation\n        else:\n            print(f'{i+1}: ')\n</code></pre>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#readlines","title":"readlines","text":"<p>TextIOWrapper \u7684 <code>readline</code> \u65b9\u6cd5\u548c\u7ee7\u627f\u81ea\u57fa\u7c7b IOBase \u7684 <code>readlines</code> \u65b9\u6cd5\u90fd\u662f\u57fa\u4e8e newlines\uff08\u9ed8\u8ba4\u4e3a <code>\\n</code>\uff09\u4f5c\u4e3a\u65ad\u884c\u5206\u5272\u7b26\u3002</p> <ul> <li>readline: Read until newline or EOF.</li> <li>readlines: Return a list of lines from the stream.</li> </ul> <p>\u5982\u679c\u4e0d\u6307\u5b9a\u53c2\u6570\uff08hint\u9ed8\u8ba4\u4e3a-1 \u6216 0\uff09\uff0creadlines \u5c06\u9010\u884c\u8bfb\u53d6\u5168\u6587\uff0c\u8fd4\u56de\u5b57\u7b26\u4e32\u5217\u8868\uff08list\uff09\u3002 \u76f8\u5f53\u4e8e\u5faa\u73af\u8c03\u7528 readline \u518d append \u5230\u5217\u8868\u3002 <p>\u4e0b\u9762\u91cd\u70b9\u770b\u770b\uff0c\u5f53 hint \u975e\u96f6\u65f6\uff0c\u5373\u5728\u6307\u5b9a\u5b57\u7b26\u9650\u5b9a\u4e0b\uff0c\u8be5\u65b9\u6cd5\u662f\u5982\u4f55\u5c3d\u53ef\u80fd\u591a\u5730\u8bfb\u53d6\u884c\u3002</p> <p>\u5047\u8bbe test.py \u6587\u4ef6\u524d\u56db\u884c\u7684\u5b57\u7b26\u6570\u5982\u4e0b\uff08\u6bcf\u884c\u5305\u542b\u7ed3\u5c3e\u6362\u884c\u7b26\uff09\uff1a</p> <ol> <li>23</li> <li>24</li> <li>1</li> <li>11</li> </ol> <p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u6f14\u793a\u4e86 readlines \u7684\u53c2\u6570 hint \u7684\u9650\u5236\u903b\u8f91\u3002</p> <pre><code># hint\u5c11\u4e8e1\u884c\uff0c\u81f3\u5c11\u8bfb\u53d6\u4e00\u884c\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines(3)\n['#!/usr/bin/env python3\\n']\n# hint\u521a\u597d1\u884c\uff08\u4e0d\u5305\u62ec\u6362\u884c\u7b26\uff09\uff0c\u8bfb\u53d6\u4e00\u884c\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines(22)\n['#!/usr/bin/env python3\\n']\n# hint\u521a\u597d1\u884c\uff08\u5305\u62ec\u6362\u884c\u7b26\uff09\uff0c\u8bfb\u53d6\u4e00\u884c\uff0c\u518d\u8bfb\u4e00\u884c\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines(23)\n['#!/usr/bin/env python3\\n', '# -*- coding: UTF-8 -*-\\n']\n# hint\u521a\u597d2\u884c\uff08\u4e0d\u5305\u62ec\u7b2c\u4e8c\u884c\u7684\u6362\u884c\u7b26\uff09\uff0c\u8bfb\u53d6\u4e24\u884c\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines(46)\n['#!/usr/bin/env python3\\n', '# -*- coding: UTF-8 -*-\\n']\n# hint\u521a\u597d2\u884c\uff08\u5305\u62ec\u7b2c\u4e8c\u884c\u7684\u6362\u884c\u7b26\uff09\uff0c\u8bfb\u53d6\u4e24\u884c\uff0c\u518d\u8bfb\u4e00\u884c\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines(47)\n['#!/usr/bin/env python3\\n', '# -*- coding: UTF-8 -*-\\n', '\\n']\n</code></pre> <p>\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u8c03\u7528 readlines \u4e0d\u4f20\u53c2\u6570\uff0c\u8bfb\u53d6\u6574\u4e2a\u6587\u4ef6\u5185\u5bb9\u3002 \u5f53\u7136\u4e5f\u53ef\u76f4\u63a5\u5c06\u652f\u6301\u5e8f\u5217\u5316\u7684\u6587\u4ef6\u5bf9\u8c61\u4f20\u7ed9 list \u76f4\u63a5\u6784\u9020\uff0c\u5b9e\u73b0\u540c\u7b49\u6548\u679c\u3002</p> <p>If you want to read all the lines of a file in a list you can also use <code>list(f)</code> or <code>f.readlines()</code>.</p> <p>\u8bfb\u53d6\u6240\u6709\u884c\u5230\u5b57\u7b26\u4e32\u5217\u8868\uff08list of str\uff09\uff0c\u7136\u540e\u53ef\u4ee5 for \u5faa\u73af\u9010\u884c\u8fdb\u884c\u6587\u672c\u5206\u6790\u3002</p> <pre><code>&gt;&gt;&gt; lines = fp.readlines() # list(fp)\n&gt;&gt;&gt; type(lines)\n&lt;class 'list'&gt;\n&gt;&gt;&gt; type(lines[0])\n&lt;class 'str'&gt;\n</code></pre> <p><code>len(lines)</code> \u8ba1\u7b97\u6587\u4ef6\u5305\u542b\u7684\u884c\u6570\uff08\u5305\u542b\u7a7a\u884c\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; len(lines)\n294637\n</code></pre> <p>\u5bf9\u4e8e\u5c0f\u6587\u4ef6\uff0c\u4e00\u6b21\u6027\u8bfb\u53d6\u5230\u5185\u5b58\uff0c\u7a7a\u95f4\u6362\u53d6I/O\u65f6\u95f4\uff0c\u53ef\u4ee5\u5728\u5185\u5b58\u4e2d\u4fbf\u6377\u5b58\u53d6\u3002 \u4f46\u662f\uff0c\u5bf9\u4e8e\u5927\u6587\u4ef6\uff0c\u4e00\u6b21\u6027\u8bfb\u53d6\u5230\u5185\u5b58\uff0c\u6bd4\u8f83\u6d88\u8017\u5185\u5b58\u7a7a\u95f4\u3002 \u6839\u636e\u60c5\u51b5\u53ef\u6298\u8877\u9009\u62e9\u5faa\u73af readline\uff0c\u8fb9\u8bfb\u8fb9\u5904\u7406\u3002</p>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#for_loop","title":"for loop","text":"<p>IOBase (and its subclasses) supports the iterator protocol, meaning that an IOBase object can be iterated over yielding the lines in a stream.</p> <p>For reading lines from a file, you can loop over the file object. This is memory efficient, fast, and leads to simple code.</p> <p>\u6587\u4ef6\u5b9e\u9645\u4e0a\u662f\u53ef\u8fed\u4ee3\u7684\uff0c\u8fd9\u610f\u5473\u7740\u53ef\u5728for\u5faa\u73af\u4e2d\u76f4\u63a5\u4f7f\u7528\u5b83\u4eec\u6765\u8fed\u4ee3\u884c\u3002 \u5efa\u8bae\u91c7\u7528 for...in \uff08\u6216 while readline\uff09\u5faa\u73af\u8fed\u4ee3\u9010\u884c\u8bfb\u53d6\u5206\u6790\u3002</p> <p>\u4ee5\u4e0b\u4ee3\u7801\u8bfb\u53d6\u6587\u4ef6\u524d10\u884c\u5e76\u9010\u884c\u5206\u6790\uff08\u6253\u5370\uff09\uff1a</p> <pre><code>with open('test.py') as f:\n    line_count = 10\n    line_index = 0\n    for line in fp:\n        if (line_index &lt; line_count):\n            print(line, end='') #print(line)\n            line_index = line_index+1\n        else:\n            break\n</code></pre> <p>\u6587\u4ef6\u6307\u9488\u5df2\u7ecf\u504f\u79fb\u5230\u4e86\u7b2c11\u884c\uff0c\u5982\u679c\u518d\u7ee7\u7eed\u6267\u884c\u4e00\u904d\u4ee5\u4e0a\u4ee3\u7801\uff0c\u5c06\u4f1a\u6253\u5370\u7b2c11-20\u884c\u3002 \u5982\u679c\u60f3\u91cd\u65b0\u6253\u5370\u524d10\u884c\uff0c\u5219\u9700\u8981\u6267\u884c <code>fp.seek(0, io.SEEK_SET)</code> \u5c06\u6e38\u6807\u79fb\u5230\u5f00\u59cb\u4f4d\u7f6e\u3002  </p> <p>\u4e5f\u53ef\u4ee5\u5148\u5c06\u6587\u4ef6\u5bf9\u8c61\u4f20\u7ed9 enumerate\uff0c\u518d for \u5faa\u73af\u8fed\u4ee3\uff0c\u6790\u89e3\u884c\u7d22\u5f15\u548c\u5185\u5bb9\u3002</p> <pre><code>import string\n\nwith open('test.py') as f:\n    for index, line in enumerate(f):\n        if (not line.startswith(tuple(string.whitespace))):\n            print(f'{index+1}:', line, end='')\n        else:\n            print(f'{index+1}: ')\n</code></pre>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#write","title":"write","text":"<p>\u8981\u60f3\u5199\u6587\u4ef6\uff0c\u6253\u5f00\u6587\u4ef6\u65f6\uff0c\u8981\u652f\u6301\u5199\u6a21\u5f0f\u3002</p> <p>\u7b2c\u4e00\u79cd\u65b9\u5f0f\u662f\uff0c\u6253\u5f00\u6587\u4ef6\u4ee5\u8bfb\u6a21\u5f0f\uff08<code>r</code>\uff09\u6253\u5f00\uff0c\u4f46\u662f\u8ffd\u52a0 <code>+</code> \u652f\u6301\u5199\u66f4\u65b0\uff1a<code>tr+</code>/<code>br+</code>\u3002 \u7b2c\u4e8c\u79cd\u65b9\u5f0f\u662f\uff0c\u6253\u5f00\u6587\u4ef6\u65f6\uff0c\u4ee5\u5199\u6a21\u5f0f\uff08<code>x</code>\u3001<code>a</code>\u3001<code>w</code>\uff09\u6253\u5f00\u3002</p> <p>\u5173\u4e8e open \u4ee5\u5199\u6a21\u5f0f\u6253\u5f00 mode \u6807\u8bb0\u7684\u6ce8\u610f\u4e8b\u9879\uff1a</p> <ul> <li><code>x</code>: \u5982\u679c\u6307\u5b9a\u8def\u5f84\u7684\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\uff0c\u4f1a\u62a5\u9519 FileExistsError: [Errno 17] File exists\u3002</li> <li><code>a</code>: \u6253\u5f00\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u5c06\u6e38\u6807\u79fb\u5230\u6587\u4ef6\u672b\u5c3e\uff08\u4e0b\u4e00\u4e2a\u53ef\u5199\u7684\u4f4d\u7f6e\uff09\uff0c\u4ee5\u4fbf write \u8ffd\u52a0\u5185\u5bb9\u3002</li> <li><code>w</code>: \u6253\u5f00\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u5e76\u4e14\u6e05\u7a7a\u6587\u4ef6\uff08truncate first\uff09\uff0c\u5343\u4e07\u8981\u6ce8\u610f\u3002</li> </ul> <p>\u5982\u679c\u662f\u4ee5\u5199\u6a21\u5f0f\u6253\u5f00\u8fd8\u60f3\u8bfb\uff0c\u53ef\u4ee5\u8ffd\u52a0\u4e00\u4e2a\u52a0\u53f7\uff1a<code>tx+</code>/<code>bx+</code>\u3001<code>ta+</code>/<code>ba+</code>\u3002</p> <p>\u4e0e <code>read</code> \u65b9\u6cd5\u76f8\u5bf9\u5e94\uff0cTextIOWrapper \u63d0\u4f9b\u4e86 <code>write</code> \u65b9\u6cd5\uff0c\u652f\u6301\u5199\u5165\u5b57\u7b26\u4e32\u3002 \u4e0e <code>readlines</code> \u65b9\u6cd5\u76f8\u5bf9\u5e94\uff0c\u7ee7\u627f\u4e86\u57fa\u7c7b IOBase \u7684 <code>writelines</code> \u65b9\u6cd5\u652f\u6301\u5199\u5165\u591a\u884c\uff08\u5b57\u7b26\u4e32\u5217\u8868\uff1alist\uff09\u3002 <p>\u6ce8\u610f\uff1a\u4e24\u4e2a\u65b9\u6cd5\u90fd\u9700\u8981\u81ea\u884c\u5728\u5199\u5165\u7684\u5b57\u7b26\u4e32\uff08text\uff09\u672b\u5c3e\u8ffd\u52a0\u6362\u884c\u5b57\u7b26\u4e32\uff08<code>\\n</code>\uff09\uff0c\u5426\u5219\u591a\u6b21write(lines)\u7684\u5185\u5bb9\u4f1a\u7c98\u8fde\u5728\u4e00\u8d77\u3002</p> <pre><code>&gt;&gt;&gt; help(io.TextIOWrapper)\n\n |  write(self, text, /)\n |      Write string to stream.\n |      Returns the number of characters written (which is always equal to\n |      the length of the string).\n\n |  ----------------------------------------------------------------------\n |  Methods inherited from _IOBase:\n |\n |  writelines(self, lines, /)\n |      Write a list of lines to stream.\n |\n |      Line separators are not added, so it is usual for each of the\n |      lines provided to have a line separator at the end.\n</code></pre> <p>\u4ee5\u4e0b\u8c03\u7528 write \u63d2\u5165\u4e24\u4e2a\u5b57\u7b26\u4e32\uff0c\u7531\u4e8e\u884c\u5c3e\u6ca1\u6709\u6362\u884c\u7b26\uff0c\u591a\u6b21\u5199\u5165\u6587\u4ef6\u8ffd\u52a0\u4e3a\u4e00\u884c\u3002</p> <pre><code>&gt;&gt;&gt; f=open('test.log', 'tr+')\n&gt;&gt;&gt; f.tell()\n0\n&gt;&gt;&gt; f.write('line 1')\n6\n&gt;&gt;&gt; f.write('line 2')\n6\n# \u6e38\u6807\u5728\u672b\u5c3e\uff0c\u8981\u60f3\u8bfb\u53d6\uff0c\u9700\u8981\u590d\u4f4d\n&gt;&gt;&gt; f.readlines()\n[]\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines()\n['line 1line 2']\n</code></pre> <p>\u6ce8\u610f\uff1awrite \u603b\u662f\u5728\u5f53\u524d\u6e38\u6807\u5904\u5f00\u59cb\u5199\u5165\uff0c\u5982\u679c\u4e2d\u9014\u5c06\u6e38\u6807\u56de\u62e8\uff0c\u53ef\u80fd\u4f1a\u8986\u5199\u6389\u539f\u6765\u7684\u6570\u636e\uff01</p> <pre><code>&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.write('line 3')\n6\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines()\n['line 3line 2']\n</code></pre> <p>\u4ee5\u4e0b\u6f14\u793a\u5e9f\u5f03 test.log \u4e2d\u7684\u5185\u5bb9\uff0c\u7136\u540e\u91cd\u65b0\u5199\u5165\u5e26\u6362\u884c\u7b26\u7684\u5b57\u7b26\u4e32\u884c\uff1a</p> <pre><code>&gt;&gt;&gt; f=open('test.log', 'tw+')\n&gt;&gt;&gt; f.readlines()\n[]\n&gt;&gt;&gt; f.write('line 1\\n')\n7\n&gt;&gt;&gt; f.write('line 2\\n')\n7\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines()\n['line 1\\n', 'line 2\\n']\n</code></pre> <p>\u4e0b\u9762\u6f14\u793a writelines \u5199\u5165\u5217\u8868\u4e2d\u7684\u591a\u884c\u5b57\u7b26\u4e32\uff1a</p> <pre><code>&gt;&gt;&gt; line34=['line 3', 'line 4']\n&gt;&gt;&gt; f.tell()\n14\n&gt;&gt;&gt; f.writelines(line34)\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines()\n['line 1\\n', 'line 2\\n', 'line 3line 4']\n\n&gt;&gt;&gt; line56=['line 5\\n' 'line 6\\n']\n&gt;&gt;&gt; f.writelines(line56)\n&gt;&gt;&gt; f.seek(0, io.SEEK_SET)\n0\n&gt;&gt;&gt; f.readlines()\n['line 1\\n', 'line 2\\n', 'line 3line 4line 5\\n', 'line 6\\n']\n</code></pre>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#codecs","title":"codecs","text":"","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#bom","title":"BOM","text":"<p>\u53ef\u4ee5\u7528 hexdump \u67e5\u770b UTF-8 with BOM\uff08byte-order mark\uff09\u5f00\u5934\u76843\u4e2a\u5b57\u8282\u662f <code>0xEF 0xBB 0xBF</code>\u3002</p> <p>Encoding declarations:</p> <p>If no encoding declaration is found, the default encoding is UTF-8. In addition, if the first bytes of the file are the UTF-8 byte-order mark (<code>b'\\xef\\xbb\\xbf'</code>), the declared file encoding is UTF-8 (this is supported, among others, by Microsoft\u2019s notepad).</p> <p>Reading Unicode file data with BOM chars in Python </p> <p>Standard UTF-8 without BOM:</p> <pre><code>&gt;&gt;&gt; b'hello'.decode('utf-8')\n'hello'\n&gt;&gt;&gt; b'hello'.decode('utf-8-sig')\n'hello'\n</code></pre> <p>BOM encoded UTF-8:</p> <pre><code>&gt;&gt;&gt; b'\\xef\\xbb\\xbfhello'.decode('utf-8')\n'\\ufeffhello'\n&gt;&gt;&gt; b'\\xef\\xbb\\xbfhello'.decode('utf-8-sig')\n'hello'\n</code></pre> <p>\u81ea\u52a8\u68c0\u6d4b\u6587\u4ef6\u7f16\u7801\uff1a</p> <pre><code>import codecs\n\ndef detect_by_bom(path,default):\n    with open(path, 'rb') as f:\n        raw = f.read(4)    #will read less if the file is smaller\n    for enc,boms in \\\n            ('utf-8-sig',(codecs.BOM_UTF8,)),\\\n            ('utf-16',(codecs.BOM_UTF16_LE,codecs.BOM_UTF16_BE)),\\\n            ('utf-32',(codecs.BOM_UTF32_LE,codecs.BOM_UTF32_BE)):\n        if any(raw.startswith(bom) for bom in boms): return enc\n    return default\n</code></pre> <p>codecs \u6253\u5370 BOM \u5934\uff1a</p> <pre><code>&gt;&gt;&gt; codecs.BOM_UTF8\nb'\\xef\\xbb\\xbf'\n&gt;&gt;&gt; codecs.BOM_UTF16_LE\nb'\\xff\\xfe'\n&gt;&gt;&gt; codecs.BOM_UTF16_BE\nb'\\xfe\\xff'\n&gt;&gt;&gt; codecs.BOM_UTF32_LE\nb'\\xff\\xfe\\x00\\x00'\n&gt;&gt;&gt; codecs.BOM_UTF32_BE\nb'\\x00\\x00\\xfe\\xff'\n</code></pre> <p>Convert UTF-8 with BOM to UTF-8 with no BOM in Python </p> <p>Sublime Text: File - Save with Encoding</p> <pre><code>import os\n\n# absfilepath1, add BOM\ns1 = open(absfilepath1, mode='r', encoding='utf-8').read()\n(filepath1, filename1) = os.path.split(absfilepath1)\n(relfilename1, fileext1) = os.path.splitext(filename1)\nbom_filename = relfilename1+'_bom'+fileext1\nbom_filepath = os.path.join(filepath1, bom_filename)\nopen(bom_filepath, mode='w', encoding='utf-8-sig').write(s1)\n\n#rewrite without BOM\ns = open(bom_file, mode='r', encoding='utf-8-sig').read()\nopen(bom_file, mode='w', encoding='utf-8').write(s)\n\n# absfilepath2, remove BOM\ns2 = open(absfilepath2, mode='r', encoding='utf-8-sig').read()\n(filepath2, filename2) = os.path.split(absfilepath2)\n(relfilename2, fileext2) = os.path.splitext(filename2)\nnobom_filename = relfilename2+'_nobom'+fileext2\nnobom_filepath = os.path.join(filepath2, nobom_filename)\nopen(nobom_filepath, mode='w', encoding='utf-8').write(s2)\n</code></pre>","tags":["io","open","read","write"]},{"location":"blog/20191206/10-io/#unicodedecodeerror","title":"UnicodeDecodeError","text":"<pre><code>&gt;&gt;&gt; fp1 = open('2019-09-23-06.log')\n&gt;&gt;&gt; lines1 = fp1.readlines()\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/Cellar/python/3.7.4_1/Frameworks/Python.framework/Versions/3.7/lib/python3.7/codecs.py\", line 322, in decode\n    (result, consumed) = self._buffer_decode(data, self.errors, final)\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xb5 in position 7312: invalid start byte\n\n&gt;&gt;&gt; fp2 = open('2019-10-01-12.log')\n&gt;&gt;&gt; lines2 = fp2.readlines()\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n  File \"/usr/local/Cellar/python/3.7.4_1/Frameworks/Python.framework/Versions/3.7/lib/python3.7/codecs.py\", line 322, in decode\n    (result, consumed) = self._buffer_decode(data, self.errors, final)\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 6873: invalid start byte\n</code></pre> <p>UnicodeDecodeError: 'utf-8' codec can't decode byte UnicodeDecodeError: 'utf8' codec can't decode byte 0x80 in position 3131: invalid start byte </p> <p>The encoding was \"ISO-8859-1\", so replacing <code>open(\"u.item\", encoding=\"utf-8\")</code> with <code>open('u.item', encoding = \"ISO-8859-1\")</code> will solve the problem.</p> <p>The trick is that <code>ISO-8859-1</code> or <code>Latin_1</code> is 8 bit character sets, thus all garbage has a valid value. Perhaps not useable, but if you want to ignore!</p>","tags":["io","open","read","write"]},{"location":"blog/20191206/11-logging/","title":"python\u4e2d\u7684\u65e5\u5fd7\u7c7b\u2014\u2014logging","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 python \u4e2d\u7684\u65e5\u5fd7\u6253\u70b9\u6a21\u5757\u2014\u2014logging\uff0c\u4ecb\u7ecd\u4e86\u5176\u57fa\u672c\u6846\u67b6\u548c\u57fa\u7840\u60ef\u7528\u6cd5\u3002</p>","tags":["logging"]},{"location":"blog/20191206/11-logging/#print_to_specified_file_instead_of_stdout","title":"print to specified file instead of std.out","text":"<p>Built-in Functions \u2014 print</p> <p>\u8fd8\u8bb0\u5f97\u521d\u8bc6 python \u65f6\uff0c\u5411\u63a7\u5236\u53f0\u8f93\u51fa <code>Hello, World!</code> \u65f6\u7684\u6fc0\u52a8\u5fc3\u60c5\u5417\uff1f\u6bd5\u7adf\u5b83\u4e3a\u6211\u4eec\u5f00\u542f\u4e86\u4e00\u6bb5\u5168\u65b0\u7684\u65c5\u7a0b\u3002 print \u4e5f\u8bb8\u662f\u5927\u591a\u6570\u4eba\u5b66\u4e60 Python \u65f6\u8ba4\u8bc6\u548c\u4f7f\u7528\u7684\u7b2c\u4e00\u4e2a\u51fd\u6570\uff0c\u5b83\u8ba9\u6211\u4eec\u5f97\u4ee5\u50cf\u5c4f\u5e55\u8f93\u51fa\u4fe1\u606f\uff0c\u6253\u70b9\u8ddf\u8e2a\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u3002</p> <p>\u8ba9\u6211\u4eec\u56de\u8fc7\u5934\u6765\u518d\u4ed4\u7ec6\u770b\u770b print \u51fd\u6570\uff0c\u5176\u643a\u5e26\u4e86\u4e00\u4e2a\u5173\u952e\u5b57\u53c2\u6570 file\uff0c\u9ed8\u8ba4\u4e0d\u586b\u65f6\uff0c\u8f93\u51fa\u6253\u5370\u5230\u63a7\u5236\u53f0\uff08sys.stdout\uff09\u3002</p> <p>\u5982\u679c\u6211\u4eec\u4e0d\u60f3\u6253\u5370\u5230\u63a7\u5236\u53f0\uff0c\u53ef\u4ee5\u6307\u5b9a\u5c06\u65e5\u5fd7\u5199\u5165\u5230\u6307\u5b9a\u6587\u4ef6 file\u3002</p> <pre><code>print(*args, sep=' ', end='\\n', file=None, flush=False)\n    Prints the values to a stream, or to sys.stdout by default.\n\n    sep\n      string inserted between values, default a space.\n    end\n      string appended after the last value, default a newline.\n    file\n      a file-like object (stream); defaults to the current sys.stdout.\n    flush\n      whether to forcibly flush the stream.\n</code></pre> <p>\u4ee5\u4e0b\u4ee3\u7801\u57fa\u4e8e\u65f6\u95f4\u6574\u70b9\u62fc\u63a5\u4e00\u4e2a\u65e5\u5fd7\u6587\u4ef6\u540d\uff0c\u5982\u679c\u6587\u4ef6\u5df2\u5b58\u5728\u5219\u8ffd\u52a0\uff0c\u5426\u5219\u65b0\u5efa\u6587\u4ef6\u3002</p> <p>with open \u6253\u5f00\u6587\u4ef6\u533a\u5757\u4e2d\u7684 print \u6307\u5b9a file\uff0c\u5199\u5165\u6587\u4ef6\u4e0d\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u3002 \u533a\u5757\u524d\u540e\u7684 print \u6ca1\u6709\u6307\u5b9a file\uff0c\u4f9d\u65e7\u6253\u5370\u5230\u63a7\u5236\u53f0\u3002</p> <pre><code>import os, datetime\n\ncur_time = datetime.datetime.now()\nstr_cur_time = cur_time.strftime('%Y%m%d%H')\nlog_path = str_cur_time + '.log'\nprint(f'{log_path = }')\nmode = 'ta' if os.path.exists(log_path) else 'tx'\nwith open(log_path, mode) as log_file:\n    for i in range(5):\n        print(f'log line {i}', file=log_file)\nprint('finish')\n</code></pre>","tags":["logging"]},{"location":"blog/20191206/11-logging/#how_to_print_to_both_stdout_and_file","title":"How to print to both std.out and file?","text":"<p>\u600e\u6837\u50cf Shell \u4e2d\u7684 <code>command | tee run.log</code> \u5c06 command \u8fd0\u884c\u7ed3\u679c\u540c\u65f6\u8f93\u51fa\u5230\u63a7\u5236\u53f0(stdout)\u548c\u6587\u4ef6(run.log)\u5462\uff1f</p> <p>python - How to redirect stdout to both file and console with scripting? - Stack Overflow</p> <p>\u65b9\u6848\u662f\u81ea\u5b9a\u4e49\u4e00\u4e2a\u7c7b Logger\uff0c\u5728 write \u65b9\u6cd5\u4e2d\u540c\u65f6\u8c03\u7528\u5199\u63a7\u5236\u53f0\uff08sys.stdout.write\uff09\u548c\u5199\u6587\u4ef6\u3002</p> <p>\u7136\u540e\u7528\u91cd\u8f7d sys.stdout\uff0c\u5c06\u5176\u8d4b\u503c\u4e3a Logger\uff0c\u8fd9\u6837\u540e\u7eed\u8c03\u7528 print \u5b9e\u9645\u4e0a\u5c31\u8c03\u7528 Logger.write\u3002</p> <pre><code># Author: Amith Koujalgi, Sanon\n\nclass Logger(object):\n    def __init__(self):\n        self.terminal = sys.stdout\n\n    def write(self, message):\n        with open (\"logfile.log\", \"a\", encoding = 'utf-8') as self.log:\n            self.log.write(message)\n        self.terminal.write(message)\n\n    def flush(self):\n        #this flush method is needed for python 3 compatibility.\n        #this handles the flush command by doing nothing.\n        #you might want to specify some extra behavior here.\n        pass\n\nsys.stdout = Logger()\n</code></pre> <p>\u4ee5\u4e0b\u6539\u8fdb\u7248\uff0c\u5728 start \u4e2d\u52ab\u6301 sys.stdout\uff0c\u5728 stop \u4e2d\u6062\u590d\u539f\u59cb sys.stdout\u3002</p> <pre><code>\"\"\"\nTranscript - direct print output to a file, in addition to terminal.\nAuthor: Brian Burns\n\nUsage:\n    import transcript\n    transcript.start('logfile.log')\n    print(\"inside file\")\n    transcript.stop()\n    print(\"outside file\")\n\"\"\"\n\nimport sys\n\nclass Transcript(object):\n\n    def __init__(self, filename):\n        self.terminal = sys.stdout\n        self.logfile = open(filename, \"a\")\n\n    def write(self, message):\n        self.terminal.write(message)\n        self.logfile.write(message)\n\n    def flush(self):\n        # this flush method is needed for python 3 compatibility.\n        # this handles the flush command by doing nothing.\n        # you might want to specify some extra behavior here.\n        pass\n\ndef start(filename):\n    \"\"\"Start transcript, appending print output to given filename\"\"\"\n    sys.stdout = Transcript(filename)\n\ndef stop():\n    \"\"\"Stop transcript and return print functionality to normal\"\"\"\n    sys.stdout.logfile.close()\n    sys.stdout = sys.stdout.terminal\n</code></pre> <p>\u6709\u4eba\u63d0\u4f9b\u4e86\u652f\u6301 with \u7684 Tee \u7c7b\uff1a</p> <pre><code># Author: supersolver\n\nimport traceback\nimport sys\n\n# Context manager that copies stdout and any exceptions to a log file\nclass Tee(object):\n    def __init__(self, filename):\n        self.file = open(filename, 'w')\n        self.stdout = sys.stdout\n\n    def __enter__(self):\n        sys.stdout = self\n\n    def __exit__(self, exc_type, exc_value, tb):\n        sys.stdout = self.stdout\n        if exc_type is not None:\n            self.file.write(traceback.format_exc())\n        self.file.close()\n\n    def write(self, data):\n        self.file.write(data)\n        self.stdout.write(data)\n\n    def flush(self):\n        self.file.flush()\n        self.stdout.flush()\n\nif __name__ == '__main__':\n    print(\"Print\")\n    with Tee('test.txt'):\n        print(\"Print+Write\")\n        raise Exception(\"Test\")\n    print(\"Print\")\n</code></pre>","tags":["logging"]},{"location":"blog/20191206/11-logging/#logging_-_python_log_system","title":"logging - python log system","text":"<p>\u65e5\u5fd7\u5927\u81f4\u4e0a\u5c31\u662f\u6536\u96c6\u4e0e\u7a0b\u5e8f\u8fd0\u884c\u76f8\u5173\u7684\u6570\u636e\uff0c\u4f9b\u4e8b\u540e\u8fdb\u884c\u8ffd\u6eaf\u3001\u7814\u7a76\u548c\u5206\u6790\u3002 \u67e5\u770b\u65e5\u5fd7\u662f\u5f00\u53d1\u4eba\u5458\u65e5\u5e38\u83b7\u53d6\u4fe1\u606f\u3001\u6392\u67e5\u5f02\u5e38\u3001\u8bca\u65ad\u5206\u6790\u95ee\u9898\u7684\u6700\u597d\u9014\u5f84\u3002</p> <p>\u4e24\u7c7b\u65e5\u5fd7\u53ca\u5176\u76ee\u7684\uff08\u4f5c\u7528\uff09\uff1a</p> <ul> <li>\u8bca\u65ad\u65e5\u5fd7: \u8bb0\u5f55\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u76f8\u5173\u64cd\u4f5c\u548c\u72b6\u6001\u65e5\u5fd7\u3002\u4f8b\u5982\uff0c\u7528\u6237\u9047\u5230\u7684\u5f02\u5e38\u62a5\u9519\u4fe1\u606f\uff0c\u53ef\u901a\u8fc7\u68c0\u7d22\u65e5\u5fd7\u83b7\u5f97\u4e0a\u4e0b\u6587\u4fe1\u606f\uff0c\u4ece\u800c\u8bca\u65ad\u5206\u6790\u95ee\u9898\u3002</li> <li>\u5ba1\u8ba1\u65e5\u5fd7: \u4e3a\u5546\u4e1a\u5206\u6790\u800c\u8bb0\u5f55\u7684\u7528\u6237\u884c\u4e3a\u65e5\u5fd7\u3002\u4ece\u4e2d\u53ef\u63d0\u53d6\u7528\u6237\u7684\u64cd\u4f5c\u8def\u5f84\u548c\u4ea4\u6613\u4fe1\u606f\uff0c\u7ed3\u5408\u7528\u6237\u8d44\u6599\u53ef\u6784\u5efa\u7528\u6237\u62a5\u544a\uff08\u753b\u50cf\uff09\uff0c\u7528\u6765\u4f18\u5316\u5546\u4e1a\u76ee\u6807\u3002</li> </ul> <p>\u73b0\u4ee3\u516c\u53f8\u8fd0\u8425\u7684\u5927\u9879\u76ee\u65e5\u5fd7\u7cfb\u7edf\u4e2d\uff0c\u5ba2\u6237\u7aef\u9664\u4e86\u652f\u6301\u5c06\u672c\u5730\u65e5\u5fd7\u5b9e\u65f6\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u548c\u5b58\u50a8\u843d\u76d8\u5916\uff0c\u5f80\u5f80\u8fd8\u652f\u6301\u5c06\u65e5\u5fd7\u6d41\u6c34\u65c1\u8def\u4e00\u4efd\u5f02\u6b65\u4e0a\u62a5\u5230\u65e5\u5fd7\u670d\u52a1\u5668\u3002 \u5177\u4f53\u6765\u8bf4\uff0c\u672c\u5730\u65e5\u5fd7\u4e0a\u62a5\u6a21\u5757\u5b9a\u65f6\u5c06\u65e5\u5fd7\u4e3b\u52a8\u4e0a\u4f20\u5230\u7f51\u7edc\u65e5\u5fd7\u670d\u52a1\u5668\uff0c\u670d\u52a1\u7aef\u65e5\u5fd7\u5b58\u50a8\u7cfb\u7edf\u642d\u914d\u5728\u7ebf\u65e5\u5fd7\u68c0\u7d22\u5e73\u53f0\uff0c\u53ef\u4f9b\u5f00\u53d1\u4eba\u5458\u8fdc\u7a0b\u5728\u7ebf\u68c0\u7d22\u8bca\u65ad\u5206\u6790\u3002</p> <p>\u66f4\u9ad8\u7ea7\u7684\u65e5\u5fd7\u7cfb\u7edf\u4e2d\uff0c\u672c\u5730\u65e5\u5fd7\u4e0a\u62a5\u6a21\u5757\u8fd8\u652f\u6301\u88ab\u52a8\u4e0a\u62a5\u3002\u5177\u4f53\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>\u672c\u5730\u65e5\u5fd7\u4e0a\u62a5\u6a21\u5757\u76d1\u542c\u9884\u8bbe\u6d88\u606f PUSH \u901a\u9053\uff08\u957f\u8fde\u63a5\uff09\u4e0a\u670d\u52a1\u5668\u4e0b\u53d1\u7684\u65e5\u5fd7\u8fdc\u7a0b\u635e\u53d6\u4fe1\u4ee4\u3002</li> <li>\u5728\u7ebf\u65e5\u5fd7\u5e73\u53f0\u63d0\u51fa\u68c0\u7d22\u9700\u6c42\uff0c\u6307\u5b9a\u5ba2\u6237\uff08\u8bbe\u5907ID\u6216\u8d26\u53f7ID\uff09\u4fe1\u606f\u548c\u65f6\u95f4\u6bb5\uff0c\u901a\u8fc7\u6d88\u606f\u901a\u9053\u4e0b\u53d1\u65e5\u5fd7\u635e\u53d6\u547d\u4ee4\u3002</li> <li>\u5ba2\u6237\u7aef\u5728\u6536\u5230\u65e5\u5fd7\u635e\u53d6\u6307\u4ee4\u540e\uff0c\u6536\u96c6\u6253\u5305\u6307\u5b9a\u65f6\u95f4\u6bb5\u7684\u65e5\u5fd7\uff0c\u5e76\u901a\u8fc7\u9884\u94fa\u4fe1\u9053\uff08\u6216\u4e34\u65f6\u8fde\u63a5\uff09\u4e0a\u4f20\u65e5\u5fd7\u5230\u670d\u52a1\u7aef\u3002</li> <li>\u5f00\u53d1\u8fd0\u7ef4\u4eba\u5458\u6536\u5230\u68c0\u7d22\u5e73\u53f0\u7684\u635e\u53d6\u6210\u529f\u901a\u77e5\u540e\uff0c\u5728\u65e5\u5fd7\u5e73\u53f0\u68c0\u7d22\u6307\u5b9a\u5ba2\u6237\u88ab\u52a8\u4e0a\u62a5\u7684\u65e5\u5fd7\uff0c\u534f\u52a9\u8fdc\u7a0b\u5206\u6790\u5b9a\u4f4d\u95ee\u9898\u3002</li> </ol>","tags":["logging"]},{"location":"blog/20191206/11-logging/#replace_print_with_logging","title":"replace print with logging","text":"<p>\u8c03\u7528 print \u5411\u5c4f\u5e55\u8f93\u51fa\u4fe1\u606f\u662f\u4e00\u79cd\u7b80\u5355\u6613\u7528\u7684\u65e5\u5fd7\u5f62\u5f0f\uff0c\u53ef\u7528\u4e8e\u6253\u70b9\u8ddf\u8e2a\u7a0b\u5e8f\u8fd0\u884c\u72b6\u6001\u3002</p> <p>\u5728\u4e0b\u9762\u7684\u4ee3\u7801\u7247\u6bb5\u4e2d\uff0c\u4f7f\u7528 print \u8ddf\u8e2a urllib \u4e0b\u8f7d\u524d\u540e\u7684\u72b6\u6001\uff0cprint \u6307\u5b9a\u5199\u65e5\u5fd7\u6587\u4ef6\u3002</p> <pre><code>print('Downloading file from URL', url, file=urllib.log)\ntext = urllib.urlopen(url).read()\nprint('File successfully downloaded', file=urllib.log)\n</code></pre> <p>\u5982\u679c\u7a0b\u5e8f\u5728\u4e0b\u8f7d\u671f\u95f4\u5d29\u6e83\uff0c\u8fd9\u79cd\u65b9\u6cd5\u7684\u6548\u679c\u5c31\u4e0d\u4f1a\u5f88\u597d\u3002 \u66f4\u5b89\u5168\u7684\u505a\u6cd5\u662f\uff0c\u5728\u6bcf\u6761\u65e5\u5fd7\u8bed\u53e5\u524d\u540e\u90fd\u6253\u5f00\u548c\u5173\u95ed\u6587\u4ef6\uff08\u81f3\u5c11\u5e94\u8be5\u5728\u5199\u5165\u540e\u5237\u65b0\u6587\u4ef6\uff09\u3002 \u4e13\u4e1a\u7684\u505a\u6cd5\u662f\u4f7f\u7528 Python \u6807\u51c6\u5e93\u4e2d\u63d0\u4f9b\u7684\u65e5\u5fd7\u6a21\u5757\u2014\u2014logging \u66ff\u4ee3\u539f\u59cb\u7684 print\u3002</p> <p>This module defines functions and classes which implement a flexible event logging system for applications and libraries.</p> <p>The key benefit of having the logging API provided by a standard library module is that all Python modules can participate in logging, so your application log can include your own messages integrated with messages from third-party modules.</p> <ul> <li>\u65e5\u5fd7\u4e8b\u4ef6\u4ea7\u751f\u7684\u65e5\u5fd7\u8bb0\u5f55\u5305\u542b\u6e05\u6670\u53ef\u7528\u7684\u8bca\u65ad\u4fe1\u606f\uff0c\u5982\u5f02\u5e38\u65f6\u95f4\u3001\u64cd\u4f5c\u8def\u5f84\u3001\u6587\u4ef6\u8def\u5f84\u540d\u79f0\u3001\u51fd\u6570\u540d\u53ca\u884c\u53f7\u7b49\u3002</li> <li>\u53ef\u901a\u8fc7 Logger.setLevel() \u8bbe\u5b9a\u65e5\u5fd7\u7ea7\u522b\uff0c\u6709\u9009\u62e9\u5730\u8bb0\u5f55\u65e5\u5fd7\uff1b\u6216\u901a\u8fc7\u8bbe\u7f6e Logger.disabled \u7981\u7528\u3002</li> <li>\u5305\u542b\u65e5\u5fd7\u6a21\u5757\u7684\u5e94\u7528\uff0c\u9ed8\u8ba4\u53ef\u901a\u8fc7\u6839\u8bb0\u5f55\u5668\u5bf9\u5e94\u7528\u7684\u65e5\u5fd7\u6d41\u8fdb\u884c\u8bbf\u95ee\uff0c\u9664\u975e\u4f60\u5c06\u65e5\u5fd7\u8fc7\u6ee4\u4e86\u3002</li> </ul> <p>\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u8f93\u51fa\u7ec8\u7aef\uff08Handler\uff09\u8fdb\u884c\u5206\u7c7b\uff0c\u4e5f\u53ef\u4ee5\u6309\u7167\u65e5\u5fd7\u7ea7\u522b\uff08Level\uff09\u8fdb\u884c\u5206\u7c7b\uff1a</p> <ol> <li>\u6309\u8f93\u51fa\u7ec8\u7aef\u8fdb\u884c\u5206\u7c7b\uff0c\u901a\u5e38\u6307\u7684\u662f\u5c06\u65e5\u5fd7\u5728\u63a7\u5236\u53f0\u8f93\u51fa\u663e\u793a\uff0c\u8fd8\u662f\u5c06\u65e5\u5fd7\u5b58\u5165\u6587\u4ef6\u3002</li> <li>\u65e5\u5fd7\u7ea7\u522b\u662f\u6309 DEBUG\u3001INFO\u3001WARNING\u3001ERROR\u3001CRITICAL \u7b49\u4e25\u91cd\u7b49\u7ea7\u5212\u5206\u3002</li> </ol> <p>python \u7684 logging \u6a21\u5757\u4e0e Android/Java \u4e2d\u7684 log4j \u65e5\u5fd7\u7cfb\u7edf\u7684\u673a\u5236\u57fa\u672c\u4e00\u6837\uff0c\u53ea\u662f\u5177\u4f53\u7684\u5b9e\u73b0\u7ec6\u8282\u4e0d\u540c\u3002</p> <p>Log4j - Apache Logging Services</p> <p>Apache Log4j is a Java-based logging utility originally written by Ceki G\u00fclc\u00fc. It is part of the Apache Logging Services, a project of the Apache Software Foundation. Log4j is one of several Java logging frameworks.</p>","tags":["logging"]},{"location":"blog/20191206/11-logging/#logging_module","title":"logging module","text":"<p>logging \u2014 Logging facility for Python \u2014 Python 3.12.2 documentation</p> <ul> <li>Module logging.config: Configuration API for the logging module.</li> <li>Module logging.handlers: Useful handlers included with the logging module.</li> </ul> <p>Logging HOWTO \u2014 Python 3.12.2 documentation</p> <p>\u6309\u7167\u60ef\u4f8b\uff0c\u6211\u4eec\u5148\u501f\u52a9 help \u7cfb\u7edf\u4e00\u89c8 logging \u63d0\u4f9b\u7684 class hierarchy\u3002</p> <p>\u4e3b\u8981\u5305\u62ec\u7ee7\u627f\u81ea Filterer \u7684 <code>Logger</code> \u7c7b\u548c <code>Handler</code> \u7c7b\uff0c\u4ee5\u53ca\u5185\u7f6e\u7684 <code>Filter</code> \u7c7b\u548c <code>Formatter</code> \u7c7b\u3002</p> <pre><code>&gt;&gt;&gt; help(logging)\n\nCLASSES\n    builtins.object\n        BufferingFormatter\n        Filter\n        Formatter\n        LogRecord\n        LoggerAdapter\n    Filterer(builtins.object)\n        Handler\n            NullHandler\n            StreamHandler\n                FileHandler\n        Logger\n</code></pre> <p>The basic classes defined by the module, together with their functions, are listed below.</p> <ul> <li><code>Loggers</code> expose the interface that application code directly uses.</li> <li><code>Handlers</code> send the log records (created by loggers) to the appropriate destination.</li> <li><code>Filters</code> provide a finer grained facility for determining which log records to output.</li> <li><code>Formatters</code> specify the layout of log records in the final output.</li> </ul> <p>\u4e0b\u9762\u5bf9\u8fd9\u56db\u4e2a\u7c7b\u8fdb\u884c\u7b80\u5355\u68b3\u7406\uff1a</p> <ol> <li> <p><code>Logger</code>\uff1a\u63d0\u4f9b\u65e5\u5fd7\u63a5\u53e3\uff0c\u4f9b\u5e94\u7528\u4ee3\u7801\u4f7f\u7528\u3002logger\u6700\u5e38\u7528\u7684\u64cd\u4f5c\u6709\u4e24\u7c7b\uff1a\u914d\u7f6e\u548c\u53d1\u9001\u65e5\u5fd7\u6d88\u606f\u3002</p> <ul> <li>\u53ef\u901a\u8fc7 logging.getLogger(name) \u83b7\u53d6 logger \u5bf9\u8c61\uff0c\u5982\u4e0d\u6307\u5b9aname\u5219\u8fd4\u56deroot\u5bf9\u8c61\u3002</li> <li>\u4f7f\u7528\u76f8\u540c\u7684 name \u8c03\u7528 getLogger \u65b9\u6cd5\u8fd4\u56de\u540c\u4e00\u4e2a logger \u5bf9\u8c61\u3002</li> <li>name \u53ef\u53d6\u6a21\u5757\u540d\u79f0\uff08<code>__name__</code>\uff09\uff0c\u5373\u6309\u6a21\u5757 getLogger\u3002</li> </ul> </li> <li> <p><code>Handler</code>\uff1a\u5c06\u65e5\u5fd7\u8bb0\u5f55\uff08LogRecord\uff09\u53d1\u9001\u5230\u5408\u9002\u7684\u76ee\u7684\u5730\uff08destination\uff09\uff0c\u6bd4\u5982\u63a7\u5236\u53f0\u3001\u6587\u4ef6\u3001socket \u7b49\u3002</p> <ul> <li>\u4e00\u4e2a Logger \u5bf9\u8c61\u53ef\u4ee5\u901a\u8fc7 addHandler \u65b9\u6cd5\u6dfb\u52a0 0 \u5230\u591a\u4e2a Handler\u3002</li> <li>\u6bcf\u4e2a Handler \u53c8\u53ef\u4ee5\u5b9a\u4e49\u4e0d\u540c\u65e5\u5fd7\u7ea7\u522b\uff0c\u4ee5\u5b9e\u73b0\u65e5\u5fd7\u5206\u7ea7\u8fc7\u6ee4\u663e\u793a\u3001\u5b58\u50a8\u843d\u76d8\u6216\u8fdc\u7a0b\u4e0a\u62a5\u3002</li> </ul> </li> <li> <p><code>Filter</code>\uff1a\u4e3a Logger\u3001Handler \u63d0\u4f9b\u7684\u8fc7\u6ee4\u5668\uff08\u94a9\u5b50\uff09\uff0c\u63d0\u4f9b\u4e00\u79cd\u4f18\u96c5\u7684\u65b9\u5f0f\u51b3\u5b9a\u4e00\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u662f\u5426\u53d1\u9001\u5230 Handler\u3002</p> <ul> <li>Logger \u548c Handler \u4e24\u4e2a\u5c42\u7ea7\u5747\u63d0\u4f9b\u4e86 addFilter/removeFilter \u63a5\u53e3\u3002</li> <li>Logger \u5c42\u7ea7\u7684 Filter \u5c06\u4f5c\u7528\u4e8e\u6240\u6709 Handler\uff1bHandler \u4e5f\u53ef\u5b9a\u5236 Filter\uff08\u8986\u76d6 Logger \u7684 Filter\uff09\u3002</li> </ul> </li> <li> <p><code>Formatter</code>\uff1a\u6307\u5b9a\u65e5\u5fd7\u8bb0\u5f55\u8f93\u51fa\u7684\u5177\u4f53\u683c\u5f0f\u3002</p> </li> </ol> <ul> <li>Formatter \u7684\u6784\u9020\u65b9\u6cd5\u9700\u8981\u4e24\u4e2a\u53c2\u6570\uff1a\u6d88\u606f\u7684\u683c\u5f0f\u5b57\u7b26\u4e32\uff08fmt\uff09\u548c\u65e5\u671f\u5b57\u7b26\u4e32\uff08datefmt\uff09\uff0c\u8fd9\u4e24\u4e2a\u53c2\u6570\u90fd\u662f\u53ef\u9009\u7684\u3002</li> <li>\u53ef\u5bf9 Handler \u8c03\u7528 setFormatter \u4e3a\u5176\u8bbe\u5b9a Formatter\u3002</li> </ul> <p>The flow of log event information in loggers and handlers is illustrated in the following diagram.</p> <ul> <li>LogRecord instances are created automatically by the Logger every time something is logged.</li> <li>Logger pass LogRecords to Handler for further processing/dispatch.</li> </ul> <p></p> <p>\u901a\u8fc7\u7b80\u5355\u68b3\u7406 logging \u6a21\u5757\u6d89\u53ca\u7684\u6838\u5fc3\u7c7b\u540e\uff0c\u6211\u4eec\u6765\u770b\u770b\u65e5\u5fd7\u6a21\u5757\u7684\u60ef\u7528\u6cd5\u3002</p>","tags":["logging"]},{"location":"blog/20191206/11-logging/#logging_levels","title":"logging levels","text":"<p>The numeric values of logging levels are given in the following table. These are primarily of interest if you want to define your own levels, and need them to have specific values relative to the predefined levels. If you define a level with the same numeric value, it overwrites the predefined value; the predefined name is lost.</p> <p>\u6bcf\u4e2a\u65e5\u5fd7\u7ea7\u522b\u6570\u503c\u95f4\u9694 10\uff0c\u6211\u4eec\u53ef\u4ee5\u63d2\u5165\u81ea\u5b9a\u4e49\u7684\u65e5\u5fd7\u7ea7\u522b\u3002</p> Level Numeric value What it means / When to use it <code>logging.NOTSET</code> 0 When set on a logger, indicates that ancestor loggers are to be consulted to determine the effective level. If that still resolves to NOTSET, then all events are logged. When set on a handler, all events are handled. <code>logging.DEBUG</code> 10 Detailed information, typically only of interest to a developer trying to diagnose a problem. <code>logging.INFO</code> 20 Confirmation that things are working as expected. <code>logging.WARNING</code> 30 An indication that something unexpected happened, or that a problem might occur in the near future (e.g. \u2018disk space low\u2019). The software is still working as expected. <code>logging.ERROR</code> 40 Due to a more serious problem, the software has not been able to perform some function. <code>logging.CRITICAL</code> 50 A serious error, indicating that the program itself may be unable to continue running.","tags":["logging"]},{"location":"blog/20191206/11-logging/#logginglog","title":"logging.log","text":"<p>logging \u6a21\u5757\u63d0\u4f9b\u4e86 log \u63a5\u53e3\u6253\u70b9\u6307\u5b9a\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4e5f\u53ef\u76f4\u63a5\u8c03\u7528\u5bf9\u5e94\u7ea7\u522b\u7684log\u63a5\u53e3\uff08debug\u3001info\u3001warning\u3001error \u548c critical\uff09\u3002</p> <pre><code>logging.disable(level=CRITICAL)\nProvides an overriding level level for all loggers which takes precedence over the logger\u2019s own level.\n\nlogging.log(level, msg, *args, **kwargs)\nLogs a message with level level on the root logger. The other arguments are interpreted as for debug().\n\nlogging.debug(msg, *args, **kwargs)\nLogs a message with level DEBUG on the root logger. The msg is the message format string, and the args are the arguments which are merged into msg using the string formatting operator. (Note that this means that you can use keywords in the format string, together with a single dictionary argument.)\n\nlogging.info(msg, *args, **kwargs)\nLogs a message with level INFO on the root logger. The arguments are interpreted as for debug().\n\nlogging.warning(msg, *args, **kwargs)\nLogs a message with level WARNING on the root logger. The arguments are interpreted as for debug().\n\nlogging.error(msg, *args, **kwargs)\nLogs a message with level ERROR on the root logger. The arguments are interpreted as for debug().\n\nlogging.critical(msg, *args, **kwargs)\nLogs a message with level CRITICAL on the root logger. The arguments are interpreted as for debug().\n</code></pre>","tags":["logging"]},{"location":"blog/20191206/11-logging/#rootlogger","title":"RootLogger","text":"<p>\u6700\u7b80\u5355\u7684\u4f7f\u7528\u5c31\u662f\u5bfc\u5165 logging \u540e\uff0c\u4ec0\u4e48\u90fd\u4e0d\u7528\u914d\u7f6e\uff0c\u76f4\u63a5\u8c03\u7528\u6a21\u5757\u7ea7\u522b\u7684\u65e5\u5fd7\u6253\u70b9\u51fd\u6570\uff08Module-Level Functions\uff09\uff0c\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230\u63a7\u5236\u53f0\uff08\u76f8\u5f53\u4e8e print\uff09\u3002</p> <p>\u53ef\u4ee5\u53d1\u73b0 debug\u3001info \u65e5\u5fd7\u5e76\u672a\u8f93\u51fa\uff0c\u53ea\u6709 warning \u53ca\u4ee5\u4e0a\u7ea7\u522b\u7684\u65e5\u5fd7\u624d\u4f1a\u8f93\u51fa\u3002 \u9ed8\u8ba4\u7684\u65e5\u5fd7\u683c\u5f0f\u662f <code>logging.BASIC_FORMAT</code> = '%(levelname)s:%(name)s:%(message)s'\uff0c\u7ea7\u522b:\u6a21\u5757:\u6d88\u606f\u3002</p> <pre><code>&gt;&gt;&gt; import logging\n&gt;&gt;&gt; logging.debug('debug')\n&gt;&gt;&gt; logging.info('info')\n&gt;&gt;&gt; logging.warning('warning')\nWARNING:root:warning\n&gt;&gt;&gt; logging.error('error')\nERROR:root:error\n&gt;&gt;&gt; logging.critical('critical')\nCRITICAL:root:critical\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0c\u5c3d\u7ba1\u6211\u4eec\u4ec0\u4e48\u90fd\u6ca1\u914d\u7f6e\uff0clogging \u5185\u90e8\u7b2c\u4e00\u6b21\u8c03\u7528\u65e5\u5fd7\u6253\u70b9\u51fd\u6570\u65f6\uff0c\u5185\u90e8\u4f1a\u8c03\u7528 <code>basicConfig</code> \u521d\u59cb\u5316\uff0c\u521b\u5efa\u4e00\u4e2a <code>StreamHandler</code>/<code>Formatter</code> \u6302\u63a5\u5230\u9ed8\u8ba4\u7684 <code>RootLogger</code> \u4e0a\u3002</p> <pre><code>logging.basicConfig(**kwargs)\nDoes basic configuration for the logging system by creating a StreamHandler with a default Formatter and adding it to the root logger. The functions debug(), info(), warning(), error() and critical() will call basicConfig() automatically if no handlers are defined for the root logger.\n</code></pre> <ul> <li>logging.debug() (as well as info(), warning(), error() and critical()) will call <code>basicConfig</code>() if the root logger doesn\u2019t have any handler attached.</li> </ul> <p>\u6211\u4eec\u53ef\u4ee5\u8c03\u7528 <code>logging.getLogger()</code> \u67e5\u770b\u9ed8\u8ba4\u7684 RootLogger\u3002</p> <p>Note that the root logger is created with level WARNING.</p> <pre><code>logging.getLogger(name=None)\nReturn a logger with the specified name or, if name is None, return a logger which is the root logger of the hierarchy.\n</code></pre> <p>logging.getLogger() \u8fd4\u56de <code>RootLogger</code>\uff0c\u65e5\u5fd7\u7ea7\u522b\u662f WARNING\uff1a</p> <pre><code>&gt;&gt;&gt; logging.getLogger()\n&lt;RootLogger root (WARNING)&gt;\n</code></pre> <p>\u67e5\u770b RootLogger \u7684 level\uff1a</p> <pre><code>&gt;&gt;&gt; rootLogger=logging.getLogger()\n&gt;&gt;&gt; rootLogger.level\n30\n&gt;&gt;&gt; rootLogger.getEffectiveLevel()\n30\n</code></pre> <p>\u4ece logging.log \u7684\u5e2e\u52a9\u6587\u6863\u4e2d\uff0c\u8fd9\u4e9b\u63a5\u53e3\u90fd\u662f\u6253\u5230 root logger\uff0c\u5b9e\u9645\u4e0a\u662f\u8c03\u7528 RootLogger \u7684\u76f8\u5e94\u63a5\u53e3\u3002\u56e0\u6b64\uff0c\u4e0a\u8ff0\u6700\u7b80\u793a\u4f8b\u7b49\u6548\u4e8e\uff1a</p> <pre><code>&gt;&gt;&gt; rootLogger.debug('debug')\n&gt;&gt;&gt; rootLogger.info('info')\n&gt;&gt;&gt; rootLogger.warning('warning')\nWARNING:root:warning\n&gt;&gt;&gt; rootLogger.error('error')\nERROR:root:error\n&gt;&gt;&gt; rootLogger.critical('critical')\nCRITICAL:root:critical\n</code></pre>","tags":["logging"]},{"location":"blog/20191206/11-logging/#handlers__filters","title":"handlers &amp; filters","text":"<p>\u67e5\u770b RootLogger \u7684 Handlers\uff0c\u5373 basicConfig \u521b\u5efa\u7684 <code>StreamHandler</code>\uff1a</p> <p>\u4ece stream \u6765\u770b\uff0c\u5176\u672c\u8d28\u662f\u4e00\u4e2a TextIOWrapper\uff0c\u4f46\u4e0d\u662f\u5199\u5165\u6587\u4ef6\uff0c\u800c\u662f\u5199\u5165 stderr\uff0c\u5373\u8f93\u51fa\u5230\u63a7\u5236\u53f0\uff08print \u9ed8\u8ba4\u8f93\u51fa\u5230 stdout\uff09\u3002</p> <pre><code>&gt;&gt;&gt; rootLogger.hasHandlers()\nTrue\n&gt;&gt;&gt; rootLogger.handlers\n[&lt;StreamHandler &lt;stderr&gt; (NOTSET)&gt;]\n&gt;&gt;&gt; defaultStreamHandler.stream\n&lt;_io.TextIOWrapper name='&lt;stderr&gt;' mode='w' encoding='utf-8'&gt;\n&gt;&gt;&gt; defaultStreamHandler.terminator\n'\\n'\n</code></pre> <p>\u67e5\u770b RootLogger \u7684 Filters\uff08\u9ed8\u8ba4\u6ca1\u6709\u914d\u7f6e\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; rootLogger.filters\n[]\n</code></pre>","tags":["logging"]},{"location":"blog/20191206/11-logging/#test_level__formatter","title":"test level &amp; formatter","text":"<p>\u5c1d\u8bd5\u964d\u4f4e RootLogger \u7684\u65e5\u5fd7\u7ea7\u522b\uff0c\u4f7f\u5176\u80fd\u8f93\u51fa INFO \u53ca\u4ee5\u4e0a\u7ea7\u522b\u7684\u4fe1\u606f\uff1a</p> <pre><code>&gt;&gt;&gt; rootLogger.setLevel(logging.INFO)\n&gt;&gt;&gt; rootLogger.debug('debug')\n&gt;&gt;&gt; rootLogger.info('info')\nINFO:root:info\n&gt;&gt;&gt; rootLogger.warning('warning')\nWARNING:root:warning\n&gt;&gt;&gt; rootLogger.error('error')\nERROR:root:error\n&gt;&gt;&gt; rootLogger.critical('critical')\nCRITICAL:root:critical\n</code></pre> <p>\u5c1d\u8bd5\u4fee\u6539 RootLogger \u9ed8\u8ba4 StreamHandler \u7684\u65e5\u5fd7\u683c\u5f0f\uff1a</p> <pre><code>&gt;&gt;&gt; formatter = logging.Formatter('%(asctime)s %(name)-12s %(levelname)-8s %(message)s')\n&gt;&gt;&gt; defaultStreamHandler.setFormatter(formatter)\n&gt;&gt;&gt; rootLogger.info('info')\n2024-03-07 16:45:19,645 root         INFO     info\n</code></pre> <p>\u5f53\u7136\uff0c\u4ee5\u4e0a\u4e24\u6b65\u7684\u4fee\u6539\uff0c\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528 logging.basicConfig \u914d\u7f6e\uff0c\u7136\u540e\u8c03\u7528\u65e5\u5fd7\u63a5\u53e3\u3002</p> <pre><code>&gt;&gt;&gt; import logging\n# \u4e00\u5b9a\u8981\u5728\u7b2c\u4e00\u6b21\u8c03\u7528 log \u65e5\u5fd7\u63a5\u53e3\u4e4b\u524d\u8c03\u7528 basicConfig\n&gt;&gt;&gt; logging.basicConfig(level=logging.INFO, format='%(asctime)s %(name)-12s %(levelname)-8s %(message)s')\n&gt;&gt;&gt; logging.debug('debug')\n&gt;&gt;&gt; logging.info('info')\n2024-03-07 17:26:31,908 root         INFO     info\n&gt;&gt;&gt; logging.warning('warning')\n2024-03-07 17:26:39,515 root         WARNING  warning\n&gt;&gt;&gt; logging.error('error')\n2024-03-07 17:26:45,479 root         ERROR    error\n&gt;&gt;&gt; logging.critical('critical')\n2024-03-07 17:26:51,360 root         CRITICAL critical\n</code></pre>","tags":["logging"]},{"location":"blog/20191206/11-logging/#practices","title":"practices","text":"<p>\u65e5\u5fd7\uff08Logging\uff09\u2014 \u4e09\u79cd\u914d\u7f6e\u65b9\u5f0f</p> <ul> <li>\u901a\u8fc7INI\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e\u7684\u4f8b\u5b50 - fileConfig</li> <li>\u901a\u8fc7\u5b57\u5178\u8fdb\u884c\u914d\u7f6e\u7684\u4f8b\u5b50 - dictConfig</li> <li>\u901a\u8fc7\u6e90\u7801\u76f4\u63a5\u914d\u7f6e\u7684\u4f8b\u5b50 - logger, handler, formatter</li> </ul>","tags":["logging"]},{"location":"blog/20191206/11-logging/#several_loggers_with_per_handler","title":"several loggers with per handler","text":"<p>CSDN-\u4e1c\u534e\u679c\u6c41\u54e5 : Python \u65e5\u5fd7\u6a21\u5757\u8be6\u89e3\u53ca\u5177\u4f53\u5e94\u7528</p> <ul> <li>\u6309\u65e5\u5fd7\u7ea7\u522b getLogger \u5e76\u6307\u5b9a FileHandler\uff0c\u843d\u76d8\u5230\u4e0d\u540c\u7684\u65e5\u5fd7\u6587\u4ef6\u3002</li> <li>\u6ca1\u6709\u6307\u5b9a Formatter\uff0c\u6bcf\u6b21\u81ea\u884c\u7ec4\u88c5 log_msg \u548c error_msg\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f \u4e1c\u534e\u679c\u6c41\u54e5 \u5c01\u88c5\u7684 loggers.py\uff0c\u5176\u4ed6\u6a21\u5757\u5bfc\u5165\u8be5\u6a21\u5757\u5373\u53ef\u4f7f\u7528\u3002</p> <ul> <li>\u7531\u4e8e\u4e0d\u540c\u7ea7\u522b\u7684\u65e5\u5fd7\u843d\u76d8\u5230\u4e0d\u540c\u7684\u6587\u4ef6\uff0c\u8bca\u65ad\u5206\u6790\u67d0\u4e00\u65f6\u95f4\u6bb5\u7684\u65e5\u5fd7\u65f6\uff0c\u53ef\u80fd\u8981\u4e32\u67e5\u591a\u4e2a log \u6587\u4ef6\u3002</li> </ul> <pre><code># -*- coding: utf-8 -*-\n# author: \u4e1c\u534e\u679c\u6c41\u54e5\n\nimport os\nimport time\nimport logging\nimport inspect\n\ndt = time.strftime(\"%Y%m%d\")\n\nhandlers = {logging.DEBUG: \"./log/debug_%s.log\" % (dt),\n            logging.INFO: \"./log/info_%s.log\" % (dt),\n            logging.WARNING: \"./log/warn_%s.log\" % (dt),\n            logging.ERROR: \"./log/error_%s.log\" % (dt)}\nloggers = {}\n\n\ndef init_loggers():\n    for level in handlers.keys():\n        path = os.path.abspath(handlers[level])\n        handlers[level] = logging.FileHandler(path)\n    for level in handlers.keys():\n        logger = logging.getLogger(str(level))\n        # \u5982\u679c\u4e0d\u6307\u5b9alevel\uff0c\u83b7\u5f97\u7684handler\u4f3c\u4e4e\u662f\u540c\u4e00\u4e2ahandler\n        logger.addHandler(handlers[level])\n        logger.setLevel(level)\n        loggers.update({level: logger})\n\n\n# \u52a0\u8f7d\u6a21\u5757\u65f6\u521b\u5efa\u5168\u5c40\u53d8\u91cf\ninit_loggers()\n\n\ndef print_now():\n    return time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())\n\n\ndef get_log_msg(message):\n    return \"[%s]  %s\" % (print_now(), message)\n\n\ndef get_error_msg(message):\n    frame, filename, lineNo, functionName, code, unknowField = inspect.stack()[2]\n    return \"[%s] [%s - %s - %s] %s\" % (print_now(), filename, lineNo, functionName, message)\n\n\ndef info(message):\n    message = get_log_msg(message)\n    loggers[logging.INFO].info(message)\n\n\ndef error(message):\n    message = get_error_msg(message)\n    loggers[logging.ERROR].error(message)\n\n\ndef debug(message):\n    message = get_log_msg(message)\n    loggers[logging.DEBUG].debug(message)\n\n\ndef warn(message):\n    message = get_log_msg(message)\n    loggers[logging.WARNING].warning(message)\n</code></pre>","tags":["logging"]},{"location":"blog/20191206/11-logging/#logger_with_multiple_handlers","title":"logger with multiple handlers","text":"<p>Python\u65e5\u5fd7\u6a21\u5757logging\u7528\u6cd5\u8be6\u89e3 Python \u65e5\u5fd7\u6a21\u5757</p> <p>\u4e0b\u9762\u793a\u4f8b\uff0c\u6f14\u793a\u540c\u65f6\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230\u63a7\u5236\u53f0\u548c\u6587\u4ef6\u4e2d\uff0c\u8fd9\u4e5f\u662f\u65e5\u5e38\u5f00\u53d1\u8fc7\u7a0b\u6700\u5e38\u7528\u7684\u65e5\u5fd7\u6253\u70b9\u6a21\u5f0f\u3002</p> <p>\u5728\u63a7\u5236\u53f0\uff08stderr\uff09\u4e0a\u53ea\u6253\u51fa warning \u53ca\u4ee5\u4e0a\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\u6253\u51fa debug \u53ca\u4ee5\u4e0a\u7ea7\u522b\u7684\u65e5\u5fd7\u3002</p> <pre><code>#!/usr/bin/env python3\n# -*- coding: UTF-8 -*-\n\nimport logging\n\n# \u5efa\u7acb\u4e00\u4e2a Streamhandler \u6765\u628a\u65e5\u5fd7\u6253\u5728\u63a7\u5236\u53f0\u4e0a\uff0c\u7ea7\u522b\u4e3a WARNING \u4ee5\u4e0a\nch = logging.StreamHandler()\nch.setLevel(logging.WARNING)\n\n# \u5efa\u7acb\u4e00\u4e2a Filehandler \u6765\u628a\u65e5\u5fd7\u8bb0\u5f55\u5728\u6587\u4ef6\u91cc\uff0c\u7ea7\u522b\u4e3a DEBUG \u4ee5\u4e0a\nfh = logging.FileHandler(\"spam.log\")\nfh.setLevel(logging.DEBUG)\n\n# \u8bbe\u7f6e\u65e5\u5fd7\u683c\u5f0f\uff0cStreamHandler \u548c FileHandler \u5171\u7528\nformatter = logging.Formatter(\n    \"%(asctime)s - %(name)s - %(levelname)s - %(message)s\")\nch.setFormatter(formatter)\nfh.setFormatter(formatter)\n\n# \u5c06\u4e24\u4e2a handler \u6dfb\u52a0\u5230 logger \u5bf9\u8c61\u4e2d\nlogger = logging.getLogger(\"log_demo\")\nlogger.setLevel(logging.DEBUG)\nlogger.addHandler(ch)\nlogger.addHandler(fh)\n\n# \u5f00\u59cb\u6253\u65e5\u5fd7\nlogger.debug(\"debug message\")\nlogger.info(\"info message\")\nlogger.warning(\"warn message\")\nlogger.error(\"error message\")\nlogger.critical(\"critical message\")\n</code></pre> <p>\u4ee5\u4e0b\u662f\u8fd0\u884c\u811a\u672c\u540e\uff0c\u63a7\u5236\u53f0\u8f93\u51fa\u548c\u65e5\u5fd7\u6587\u4ef6\u5185\u5bb9\uff1a</p> <pre><code>$ python3 test_logging.py\n2024-03-07 17:13:31,969 - log_demo - WARNING - warn message\n2024-03-07 17:13:31,969 - log_demo - ERROR - error message\n2024-03-07 17:13:31,969 - log_demo - CRITICAL - critical message\n\n$ cat spam.log\n2024-03-07 17:13:31,968 - log_demo - DEBUG - debug message\n2024-03-07 17:13:31,969 - log_demo - INFO - info message\n2024-03-07 17:13:31,969 - log_demo - WARNING - warn message\n2024-03-07 17:13:31,969 - log_demo - ERROR - error message\n2024-03-07 17:13:31,969 - log_demo - CRITICAL - critical message\n</code></pre> <p>\u5982\u679c\u662f\u7cfb\u7edf\u7ea7\u670d\u52a1\uff0c\u53ef\u8003\u8651\u5c06\u65e5\u5fd7\u8bb0\u5f55\u5230\u64cd\u4f5c\u7cfb\u7edf\u4e8b\u52a1\u65e5\u5fd7\uff0c\u53c2\u8003 <code>SysLogHandler</code> \u548c <code>NTEventLogHandler</code>\u3002</p> <p>\u73b0\u4ee3\u65e5\u5fd7\u7cfb\u7edf\u4e2d\uff0c\u53ef\u80fd\u8fd8\u8981\u65c1\u8def\u4e00\u4efd\u4e0a\u4f20\u5230\u65e5\u5fd7\u670d\u52a1\u5668\u3002</p> <ul> <li> <p>\u5982\u679c\u77e5\u9053\u65e5\u5fd7\u670d\u52a1\u5668\u7684\u76d1\u542c\u7aef\u53e3\uff0c\u53ef\u4ee5\u91c7\u7528 <code>SocketHandler</code> \u548c <code>DatagramHandler</code> \u8fde\u63a5\u670d\u52a1\u5668\uff0c\u518d\u8c03\u7528 send \u63a5\u53e3\u4e0a\u4f20\u3002</p> <ul> <li>\u5982\u679c\u670d\u52a1\u7aef\u63d0\u4f9b\u7684\u662f HTTP CGI \u65e5\u5fd7\u4e0a\u62a5\u63a5\u53e3\uff0c\u5219\u53ef\u4ee5\u91c7\u7528 <code>HTTPHandler</code>\u3002</li> </ul> </li> <li> <p>\u5982\u679c\u5c06\u65e5\u5fd7\u4e0a\u62a5\u7684\u540c\u65f6\uff0c\u5bf9\u4e8e WARNING \u53ca\u4ee5\u4e0a\u7ea7\u522b\u7684\u65e5\u5fd7\u7ec4\u7ec7\u53d1\u9001\u544a\u8b66\u90ae\u4ef6\uff0c\u90a3\u4e48\u53ef\u4ee5\u8003\u8651 SMTPHandler \u8fde\u63a5\u90ae\u7bb1\u670d\u52a1\u5668\u53d1\u9001\u90ae\u4ef6\u3002</p> </li> </ul>","tags":["logging"]},{"location":"blog/20191206/11-logging/#refs","title":"refs","text":"<p>Does python logging replace print? - Stack Overflow</p> <p>Make it easy to replace print() calls with logging calls \u00b7 Issue #66391 \u00b7 python/cpython</p> <p>Stop Using \u201cPrint\u201d and Start Using \u201cLogging\u201d | by Naser Tamimi | Towards Data Science</p> <p>1\u4e07\u5b57\u8be6\u89e3 python logging\u65e5\u5fd7\u6a21\u5757 - FooFish Python\u4e2dLogging \u65e5\u5fd7\u6a21\u5757\uff08\u6700\u8be6\u7ec6\u5b8c\u6574\u7248\uff09 - \u77e5\u4e4e</p>","tags":["logging"]},{"location":"blog/20191206/12-iterator/","title":"python\u4e2d\u7684\u8fed\u4ee3\u5668\u2014\u2014iterator","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 python \u4e2d\u7684\u8fed\u4ee3\u5668\u7c7b\u2014\u2014iterator\uff0c\u4ecb\u7ecd\u4e86\u5176\u57fa\u672c\u6982\u5ff5\u548c\u57fa\u7840\u60ef\u7528\u6cd5\u3002</p> <p>Glossary \u2014 iterator Built-in Types \u2014 Iterator Types 9.8. Iterators</p> <p>\u53ef\u501f\u9274\u53c2\u8003\u300aES6 \u6807\u51c6\u5165\u95e8\u300b\u7b2c 15 \u7ae0\u300aiteraor \u548c for...of \u5faa\u73af\u300b\u3002</p>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#iterable","title":"iterable","text":"<p>Python supports a concept of iteration over containers. This is implemented using two distinct methods; these are used to allow user-defined classes to support iteration. Sequences, described below in more detail, always support the iteration methods.</p> <p>One method needs to be defined for container objects to provide iterable support:</p> <p>container.<code>__iter__</code>()</p> <p>Return an iterator object. The object is required to support the iterator protocol described below. If a container supports different types of iteration, additional methods can be provided to specifically request iterators for those iteration types. (An example of an object supporting multiple forms of iteration would be a tree structure which supports both breadth-first and depth-first traversal.) This method corresponds to the tp_iter slot of the type structure for Python objects in the Python/C API.</p> <p>An object capable of returning its members one at a time. Examples of iterables include all sequence types (such as\u00a0<code>list</code>,\u00a0<code>str</code>, and\u00a0<code>tuple</code>) and some non-sequence types like\u00a0<code>dict</code>,\u00a0file objects, and objects of any classes you define with an\u00a0<code>__iter__()</code>\u00a0method or with a\u00a0<code>__getitem__()</code>\u00a0method that implements\u00a0sequence\u00a0semantics.</p> <p>Iterables can be used in a\u00a0<code>for</code>\u00a0loop and in many other places where a sequence is needed (<code>zip()</code>,\u00a0<code>map()</code>, \u2026). When an iterable object is passed as an argument to the built-in function\u00a0<code>iter()</code>, it returns an iterator for the object. This iterator is good for one pass over the set of values. When using iterables, it is usually not necessary to call\u00a0<code>iter()</code>\u00a0or deal with iterator objects yourself. The\u00a0<code>for</code>\u00a0statement does that automatically for you, creating a temporary unnamed variable to hold the iterator for the duration of the loop. See also\u00a0iterator,\u00a0sequence, and\u00a0generator.</p>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#sequence","title":"sequence","text":"<ul> <li>Sequence Types \u2014 list\uff08mutable\uff09, tuple\uff08immutable\uff09, range\uff08immutable\uff09</li> <li>Text Sequence Type \u2014 str\uff08immutable\uff09</li> </ul> <p>\u5e8f\u5217\u7c7b list\u3001tuple\u3001range\u3001str \u5747\u5b9e\u73b0\u4e86\u53ef\u8fed\u4ee3\u534f\u8bae\uff0c\u5177\u5907 iterable \u7279\u6027\u3002</p> <pre><code>&gt;&gt;&gt; help(list)\n\n |  __iter__(self, /)\n |      Implement iter(self).\n\n |  ----------------------------------------------------------------------\n |  Class methods defined here:\n |\n |  __class_getitem__(...) from builtins.type\n |      See PEP 585\n</code></pre> <p>list\u3001tuple\u3001set \u5747\u652f\u6301\u4f20\u5165 iterable object \u6784\u9020\uff0c\u56e0\u6b64\u5b83\u4eec\u4e4b\u95f4\u53ef\u4ee5\u4e92\u76f8\u6784\u9020\u8f6c\u6362\u3002</p> <pre><code>class list(object)\n |  list(iterable=(), /)\n |\n |  Built-in mutable sequence.\n |\n |  If no argument is given, the constructor creates a new empty list.\n |  The argument must be an iterable if specified.\n\nclass tuple(object)\n |  tuple(iterable=(), /)\n |\n |  Built-in immutable sequence.\n |\n |  If no argument is given, the constructor returns an empty tuple.\n |  If iterable is specified the tuple is initialized from iterable's items.\n |\n |  If the argument is a tuple, the return value is the same object.\n\nclass set(object)\n |  set() -&gt; new empty set object\n |  set(iterable) -&gt; new set object\n |\n |  Build an unordered collection of unique elements.\n</code></pre> <p>list \u7684 extend \u63a5\u53e3\u4f20\u5165 iterable object\uff0c\u9010\u4e2a\u8ffd\u52a0\u53ef\u8fed\u4ee3\u5bf9\u8c61\u4e2d\u7684\u5143\u7d20\u3002</p> <p>list.extend(self, iterable, /): Extend list by appending elements from the iterable.</p> <p>\u7531\u4e8e range \u4e5f\u662f iterable\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u4f20\u5165 list\u3001tuple\u3001set\uff0crange \u5e38\u7528\u4e8e\u5feb\u6377\u521d\u59cb\u5316\u5e8f\u5217\u3002</p> <pre><code>&gt;&gt;&gt; list(range(1,11))\n[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n&gt;&gt;&gt; list(range(1,11,2))\n[1, 3, 5, 7, 9]\n</code></pre> <p>\u7531\u4e8e str \u4e5f\u662f iterable\uff0c\u56e0\u6b64\u4e5f\u53ef\u4ee5\u4f20\u5165 list\u3001tuple\u3001set\uff0c\u751f\u6210\u5b57\u7b26\uff08\u4e32\uff09\u5e8f\u5217\u3002</p> <pre><code>&gt;&gt;&gt; list('string')\n['s', 't', 'r', 'i', 'n', 'g']\n</code></pre> <p>str \u7684 join(self, iterable, /) \u65b9\u6cd5\u9700\u8981\u4f20\u5165\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c\u5c06\u5b83\u4eec\u8fde\u63a5\u8d77\u6765\u3002</p> <pre><code>&gt;&gt;&gt; ','.join(('Hello', 'World'))\n'Hello,World'\n</code></pre>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#iterator","title":"iterator","text":"<p>An object representing a stream of data. Repeated calls to the iterator\u2019s\u00a0<code>__next__()</code>\u00a0method (or passing it to the built-in function\u00a0<code>next()</code>) return successive items in the stream. When no more data are available a\u00a0<code>StopIteration</code>\u00a0exception is raised instead. At this point, the iterator object is exhausted and any further calls to its\u00a0<code>__next__()</code>\u00a0method just raise\u00a0<code>StopIteration</code>\u00a0again. Iterators are required to have an\u00a0<code>__iter__()</code>\u00a0method that returns the iterator object itself so every iterator is also iterable and may be used in most places where other iterables are accepted. One notable exception is code which attempts multiple iteration passes. A container object (such as a\u00a0<code>list</code>) produces a fresh new iterator each time you pass it to the\u00a0<code>iter()</code>\u00a0function or use it in a\u00a0<code>for</code>\u00a0loop. Attempting this with an iterator will just return the same exhausted iterator object used in the previous iteration pass, making it appear like an empty container.</p> <p>The iterator objects themselves are required to support the following two methods, which together form the iterator protocol:</p> <p>iterator.<code>__iter__</code>()</p> <p>Return the iterator object itself. This is required to allow both containers and iterators to be used with the for and in statements. This method corresponds to the tp_iter slot of the type structure for Python objects in the Python/C API.</p> <p>iterator.<code>__next__</code>()</p> <p>Return the next item from the iterator. If there are no further items, raise the StopIteration exception. This method corresponds to the tp_iternext slot of the type structure for Python objects in the Python/C API.</p> <p>Python defines several iterator objects to support iteration over general and specific sequence types, dictionaries, and other more specialized forms. The specific types are not important beyond their implementation of the iterator protocol.</p> <p>Once an iterator\u2019s <code>__next__</code>() method raises <code>StopIteration</code>, it must continue to do so on subsequent calls. Implementations that do not obey this property are deemed broken.</p>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#concept","title":"concept","text":"<p>iterator \u8fed\u4ee3\u5668\uff08\u904d\u5386\u5668\uff09\u5c31\u662f\u8fd9\u4e00\u79cd\u63a5\u53e3\uff0c\u4e3a\u5404\u79cd\u4e0d\u540c\u7684\u6570\u636e\u7ed3\u6784\u63d0\u4f9b\u7edf\u4e00\u7684\u8bbf\u95ee\u673a\u5236\u3002 \u4efb\u4f55\u6570\u636e\u7ed3\u6784\u53ea\u8981\u90e8\u7f72\u4e86 iterator \u63a5\u53e3\uff0c\u5c31\u53ef\u4ee5\u652f\u6301 for...in \u5faa\u73af\u904d\u5386\u64cd\u4f5c\u3002</p> <p>\u4efb\u4f55\u53ef\u8fed\u4ee3\uff08iterable\uff09\u7684\u5bf9\u8c61\u90fd\u4f1a\u5b9a\u4e49 <code>__iter__</code> \u548c <code>__next__</code> \u65b9\u6cd5\uff0c\u5373\u5b9e\u73b0\u8fed\u4ee3\u5668\u534f\u8bae\u3002 \u66f4\u6b63\u89c4\u7684\u5b9a\u4e49\u662f\uff1a\u5b9e\u73b0\u4e86\u65b9\u6cd5 <code>__iter__</code> \u7684\u5bf9\u8c61\u662f\u53ef\u8fed\u4ee3\u7684\uff0c\u800c\u5b9e\u73b0\u4e86\u65b9\u6cd5 <code>__next__</code> \u7684\u5bf9\u8c61\u662f\u8fed\u4ee3\u5668\u3002  </p> <p>\u65b9\u6cd5 <code>__iter__</code> \u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u5b83\u662f\u5305\u542b<code>__next__</code> \u65b9\u6cd5\u7684\u5bf9\u8c61\u3002</p> <p><code>list</code> provide iterable support\uff1b<code>list_iterator</code> conform to iterator protocl.</p> <pre><code>&gt;&gt;&gt; hasattr(list, '__iter__')\nTrue\n&gt;&gt;&gt; hasattr(list, '__next__')\nFalse\n</code></pre> <p>iterator \u7684\u904d\u5386\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ol> <li>\u521b\u5efa\u4e00\u4e2a\u6307\u9488\u5bf9\u8c61\uff0c\u6307\u5411\u5f53\u524d\u6570\u636e\u7ed3\u6784\u7684\u8d77\u59cb\u4f4d\u7f6e\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u904d\u5386\u5668\u5bf9\u8c61\u672c\u8d28\u4e0a\u5c31\u662f\u4e00\u4e2a\u6307\u9488\u5bf9\u8c61\u3002</li> <li>\u7b2c\u4e00\u6b21\u8c03\u7528\u6307\u9488\u5bf9\u8c61\u7684 next \u65b9\u6cd5\uff0c\u53ef\u4ee5\u5c06\u6307\u9488\u6307\u5411\u6570\u636e\u7ed3\u6784\u7684\u7b2c\u4e00\u4e2a\u6210\u5458\u3002</li> <li>\u7b2c\u4e8c\u6b21\u8c03\u7528\u6307\u9488\u5bf9\u8c61\u7684 next \u65b9\u6cd5\uff0c\u6307\u9488\u5c31\u6307\u5411\u6570\u636e\u7ed3\u6784\u7684\u7b2c\u4e8c\u4e2a\u6210\u5458\u3002</li> <li>\u4e0d\u65ad\u8c03\u7528\u6307\u9488\u5bf9\u8c61\u7684 next \u65b9\u6cd5\uff0c\u76f4\u5230\u5b83\u6307\u5411\u6570\u636e\u7ed3\u6784\u7684\u7ed3\u675f\u4f4d\u7f6e\u3002</li> </ol> <p>\u6bcf\u6b21\u8c03\u7528 next \u65b9\u6cd5\u90fd\u4f1a\u8fd4\u56de\u6570\u636e\u7ed3\u6784\u7684\u5f53\u524d\u6210\u5458\u7684\u4fe1\u606f\u3002</p>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#fibonacci","title":"Fibonacci","text":"<p>\u6211\u4eec\u6765\u770b\u770b\u7ecf\u5178\u7684\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff0c\u5b83\u5177\u5907\u5178\u578b\u7684\u524d\u5411\u63a8\u5bfc\u548c\u8fed\u4ee3\u7279\u6027\u3002</p> <p>\u5148\u6765\u770b\u770b\u539f\u59cb\u5b9a\u4e49\uff1af(n)=f(n-1)+f(n-2)\u3002</p> \\[ % abs f(n)= \\begin{cases}         n, &amp; x&lt;2 \\\\         f(n-1)+f(n-2), &amp; x \\ge 2 \\end{cases} \\] <p>\u4e4b\u524d\u57fa\u4e8e list.append \u65b9\u6cd5\u5b9e\u73b0\u7684\u6590\u6ce2\u90a3\u5951\u5217\u8868\uff1a</p> <pre><code>def fibs(n: int) -&gt; list:\n    if n &lt; 2:\n        print('To make sense, n should be bigger than 2.')\n        return None\n    else:\n        r = [0, 1]\n        for i in range(n-2):\n            r.append(r[-2]+r[-1])\n        return r\n</code></pre> <p>\u57fa\u4e8e\u591a\u91cd\u8d4b\u503c\uff08\u9010\u4e2a\u8ba1\u7b97\u53f3\u503c\u8868\u8fbe\u5f0f\uff0c\u518d\u4f9d\u6b21\u8d4b\u7ed9\u5de6\u4fa7\u53d8\u91cf\uff09\uff0c\u7a0d\u4f5c\u6539\u8fdb\uff1a</p> <pre><code>&gt;&gt;&gt; def fib2(n):  # return Fibonacci series up to n\n...     \"\"\"Return a list containing the Fibonacci series up to n.\"\"\"\n...     result = []\n...     a, b = 0, 1\n...     while a &lt; n:\n...         result.append(a)    # see below\n...         a, b = b, a+b\n...     return result\n... \n&gt;&gt;&gt; f100 = fib2(100)\n&gt;&gt;&gt; f100\n[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89]\n</code></pre> <p>\u4ee5\u4e0a\u5c06\u751f\u6210\u7684\u6590\u6ce2\u90a3\u5951\u6570\u5217\u4e00\u4e00\u5b58\u50a8\u5728\u5217\u8868\u4e2d\u3002\u4f46\u5047\u5982\u6211\u4eec\u53ea\u60f3\u9010\u4e2a\u5730\u83b7\u53d6\u503c\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u5217\u8868\u4e00\u6b21\u6027\u83b7\u53d6\u3002 \u4f8b\u5982\uff0c\u53ea\u60f3\u627e\u51fa\u7b2c\u4e00\u4e2a\u5927\u4e8e1000\u7684\u6590\u6ce2\u90a3\u5951\u6570\uff0c\u800c\u4e0d\u5173\u6ce8\u524d\u5411\u5e8f\u5217\uff0c\u5982\u679c\u7528\u5217\u8868\u5b9e\u73b0\uff0c\u975e\u5e38\u8017\u8d39\u5185\u5b58\u3002 \u6b64\u65f6\uff0c\u4f7f\u7528\u8fed\u4ee3\u5668\u5b9e\u73b0\u66f4\u901a\u7528\u3001\u66f4\u7b80\u5355\u3001\u66f4\u4f18\u96c5\u3002</p> <pre><code>class Fibs:\n    def __init__(self):\n        self.a = 0\n        self.b = 1\n\n    def __next__(self):\n        self.a, self.b = self.b, self.a + self.b\n        return self.a\n\n    def __iter__ (self):\n        return self\n\nfibs = Fibs()\nfor fib in fibs:\n    if fib &gt; 1000:\n        print(fib)\n        break\n</code></pre> <p>\u8fd9\u4e2a\u5faa\u73af\u4e4b\u6240\u4ee5\u4f1a\u505c\u6b62\uff0c\u662f\u56e0\u4e3a\u5176\u4e2d\u5305\u542b break \u8bed\u53e5\uff1b\u5426\u5219\uff0c\u8fd9\u4e2a for \u5faa\u73af\u5c06\u6ca1\u5b8c\u6ca1\u4e86\u5730\u6267\u884c\u3002</p>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#iterate","title":"iterate","text":"<p>8.3. The for statement: The for statement is used to iterate over the elements of a sequence (such as a string, tuple or list) or other iterable object.</p>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#iter-next","title":"iter-next","text":"<p>\u5185\u7f6e\u7684 <code>iter()</code> \u51fd\u6570\u8fd4\u56de\u8fed\u4ee3\u5668\uff08iterator\uff09\uff0c<code>next()</code> \u51fd\u6570\u5219\u904d\u5386\u8fed\u4ee3\u5668\uff0c\u89e3\u5f15\u7528\u8fd4\u56de\u904d\u5386\u5230\u7684\u4f4d\u7f6e\u5bf9\u5e94\u7684\u5143\u7d20\u3002</p> <p>\u4e0d\u540c\u7684\u5bf9\u8c61\u7c7b\u578b\u4f20\u9012\u7ed9 iter \u8fd4\u56de\u5404\u81ea\u7c7b\u578b\u7684 iterator\uff1a</p> <ol> <li>iter(str) \u8fd4\u56de str_ascii_iterator</li> <li>iter(list) \u8fd4\u56de list_iterator</li> <li>iter(tuple) \u8fd4\u56de tuple_iterator</li> <li>iter(range) \u8fd4\u56de range_iterator</li> </ol> <p>\u5bf9 iterator \u8c03\u7528 next\uff0c\u5b9e\u9645\u4e0a\u7b49\u6548\u4e8e\u8c03\u7528\u5176 <code>__next__</code> \u65b9\u6cd5\u3002</p> <pre><code>Help on built-in function iter in module builtins:\n\niter(...)\n    Get an iterator from an object.\n\n    In the first form, the argument must supply its own iterator, or be a sequence.\n    In the second form, the callable is called until it returns the sentinel.\n\nnext(...)\n    Return the next item from the iterator.\n\n    If default is given and the iterator is exhausted,\n    it is returned instead of raising StopIteration.\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528 iter+next \u8fed\u4ee3\u904d\u5386\u8bbf\u95ee\u5217\u8868\uff1a</p> <pre><code>&gt;&gt;&gt; l=['abc', 2024, (3,8)]\n&gt;&gt;&gt; i=iter(l)\n&gt;&gt;&gt; next(i)\n'abc'\n&gt;&gt;&gt; next(i)\n2024\n&gt;&gt;&gt; next(i)\n(3, 8)\n&gt;&gt;&gt; next(i)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre> <p>\u8c03\u7528 next \u8bbf\u95ee\u8fd4\u56de\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u540e\uff0c\u8fed\u4ee3\u5b8c\u6bd5\uff08exhausted\uff09\uff0c\u518d\u6b21\u8c03\u7528 next \u5c06\u629b\u51fa <code>StopIteration</code> \u5f02\u5e38\u3002 \u8c03\u7528 iter \u83b7\u53d6 iterator \u540e\uff0c\u9010\u6b21\u8c03\u7528 next \u6bd4\u8f83\u7e41\u7410\uff0c\u4e0d\u5207\u5b9e\u9645\uff0c\u5efa\u8bae\u4f7f\u7528\u5faa\u73af\u8fed\u4ee3\u904d\u5386\u3002 \u53ef\u4f7f\u7528 while \u5faa\u73af\u8c03\u7528 next \u8fed\u4ee3\uff0c\u5e76\u6355\u83b7\u8fed\u4ee3\u6ea2\u51fa\u5f02\u5e38\u9000\u51fa\u5faa\u73af\u3002</p> <pre><code>&gt;&gt;&gt; l=['abc', 2024, (3,8)]\n&gt;&gt;&gt; it=iter(l)\n&gt;&gt;&gt; while True:\n...     try:\n...             e=next(it)\n...             print(e)\n...     except StopIteration:\n...             break\n... \nabc\n2024\n(3, 8)\n</code></pre> <p>\u6ce8\u610f\uff1a\u5b57\u5178\uff08dict\uff09\u7684\u8fed\u4ee3\u5668\u662f\u9488\u5bf9 \u952e\u503c\u5bf9 \u8fdb\u884c\u7684\u4e00\u7ef4\u8fed\u4ee3\u3002</p> <p>\u7531\u4e8e iterator \u672c\u8eab\u4e5f\u5b9e\u73b0\u4e86 <code>__iter__</code> \u63a5\u53e3\uff0c\u4e5f\u53ef\u76f4\u63a5\u5bf9\u5176\u6267\u884c for \u5faa\u73af\u8fed\u4ee3\uff1a</p> <pre><code>&gt;&gt;&gt; l=['abc', 2024, (3,8)]\n&gt;&gt;&gt; i=iter(l)\n&gt;&gt;&gt; for x in i:\n...     print(x)\n... \nabc\n2024\n(3, 8)\n</code></pre> <p>\u5f53\u7136\uff0c\u76f4\u63a5\u4f7f\u7528 for \u5faa\u73af\u5bf9 iterable object \u904d\u5386\u8fed\u4ee3\u66f4\u7b80\u6d01\uff1a</p> <pre><code>&gt;&gt;&gt; for i in l:\n...     print(i)\n...\nabc\n2024\n(3, 8)\n</code></pre>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#enumerate","title":"enumerate","text":"<p>enumerate \u7c7b\u5b9e\u73b0\u4e86 iterator protocol\uff0c\u53ef\u5bf9\u8fd4\u56de\u7684 enumerate \u5bf9\u8c61\u6267\u884c for \u5faa\u73af\u904d\u5386\u6216\u8c03\u7528 list() \u6784\u9020\u8f6c\u6362\u3002</p> <pre><code>Help on class enumerate in module builtins:\n\nclass enumerate(object)\n |  enumerate(iterable, start=0)\n |\n |  Return an enumerate object.\n |\n |    iterable\n |      an object supporting iteration\n |\n |  The enumerate object yields pairs containing a count (from start, which\n |  defaults to zero) and a value yielded by the iterable argument.\n |\n |  enumerate is useful for obtaining an indexed list:\n |      (0, seq[0]), (1, seq[1]), (2, seq[2]), ...\n |\n |  Methods defined here:\n |\n |  __getattribute__(self, name, /)\n |      Return getattr(self, name).\n |\n |  __iter__(self, /)\n |      Implement iter(self).\n |\n |  __next__(self, /)\n |      Implement next(self).\n |\n |  __reduce__(...)\n |      Return state information for pickling.\n |\n |  ----------------------------------------------------------------------\n |  Class methods defined here:\n |\n |  __class_getitem__(...) from builtins.type\n |      See PEP 585\n |\n |  ----------------------------------------------------------------------\n |  Static methods defined here:\n |\n |  __new__(*args, **kwargs) from builtins.type\n |      Create and return a new object.  See help(type) for accurate signature.\nlines 5-41 bytes 120-1225 98% of file -\n</code></pre> <p>enumerate(object) \u51fd\u6570\u8fd4\u56de enumerate \u5bf9\u8c61\u5b9e\u4f8b\uff0c\u53ef\u4f20\u9012\u7ed9 list() \u6784\u9020 indexed list\u3002</p> <pre><code>&gt;&gt;&gt; l=['abc', 2024, (3,8)]\n&gt;&gt;&gt; en=enumerate(l)\n&gt;&gt;&gt; [*en]\n[(0, 'abc'), (1, 2024), (2, (3, 8))]\n&gt;&gt;&gt; [*en] # exhausted\n[]\n</code></pre> <p>\u8fed\u4ee3\u904d\u5386 enumerate \u5bf9\u8c61\uff0c\u6bcf\u4e2a\u5143\u7d20\u4e3a\u4e00\u4e2a tuple \u4e8c\u5143\u7ec4 (index, value)\u3002</p> <pre><code>&gt;&gt;&gt; en=enumerate(l)\n&gt;&gt;&gt; for e in en:\n...     print(e)\n... \n(0, 'abc')\n(1, 2024)\n(2, (3, 8))\n</code></pre> <p>\u5bf9\u5217\u8868\u8c03\u7528 <code>enumerate()</code> \u53ef\u4ee5\u83b7\u53d6\u6bcf\u4e2a\u5143\u7d20\u7684\u7d22\u5f15\u53ca\u5176\u503c\uff0c\u4e5f\u53ef\u57fa\u4e8e\u8fd4\u56de\u7684\u679a\u4e3e\u5bf9\u8c61\u6784\u9020\u5143\u7ec4\u6216\u5217\u8868\u3002</p> <pre><code>&gt;&gt;&gt; l=[*range(1,13, 2)]\n&gt;&gt;&gt; tuple(enumerate(l))\n((0, 1), (1, 3), (2, 5), (3, 7), (4, 9), (5, 11))\n&gt;&gt;&gt; list(enumerate(l))\n[(0, 1), (1, 3), (2, 5), (3, 7), (4, 9), (5, 11)]\n</code></pre>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#itertools","title":"itertools","text":"","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#sorted","title":"sorted","text":"<p>Python \u5185\u5efa\u6a21\u5757 builtins \u4e2d\u7684\u51fd\u6570 <code>sorted</code> \u652f\u6301\u5bf9\u53ef\u8fed\u4ee3\u5e8f\u5217\u8fdb\u884c\uff08\u5347\u5e8f\uff09\u6392\u5e8f\uff0c\u8fd4\u56de\u6392\u5e8f\u540e\u7684 list\u3002</p> <ul> <li>\u53ef\u6307\u5b9a\u53c2\u6570 reverse=True \u8fdb\u884c\u964d\u5e8f\u6392\u5217\u3002</li> </ul> <pre><code>    sorted(iterable, /, *, key=None, reverse=False)\n        Return a new list containing all items from the iterable in ascending order.\n</code></pre> <p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u5728 [1,40] \u4e4b\u95f4\u968f\u673a\u6311\u900913\u4e2a\u6570\uff0c\u7136\u540e\u8c03\u7528 sorted \u51fd\u6570\u8fdb\u884c\u6392\u5e8f\uff1a</p> <pre><code>    l = 1; r = 40; n = 13\n    random.seed(r+1)\n    rl = random.sample(range(l,r+1), n)\n    srl = sorted(rl) # \u9ed8\u8ba4\u5347\u5e8f\n    # srl = sorted(rl, reverse=True) # \u964d\u5e8f\n</code></pre> <p>\u5bf9\u4e8e list(tuple) \u548c dict \u7b49\u7b26\u5408\u53ef\u7ed3\u5408 lambda \u6307\u5b9a\u6392\u5e8f\u7684 key\uff1a</p> <pre><code>a=[('b',3), ('a',2), ('d',4), ('c',1)]\n# \u6309\u7167\u7b2c\u4e00\u4e2a\u5143\u7d20\u6392\u5e8f\nsorted(a,key=lambda x:x[0])\n# \u6309\u7167\u7b2c\u4e8c\u4e2a\u5143\u7d20\u6392\u5e8f\nsorted(a,key=lambda x:x[1])\n</code></pre> <p>Python | Sort Python Dictionaries by Key or Value - GeeksforGeeks</p> <pre><code>d={'b':3, 'a':2, 'd':4, 'c':1}\n# sort by keys\nsorted(d.items())\n\n# sort by keys\uff08\u5217\u8868\u63a8\u5bfc\uff09\nks = list(d.keys())\nks.sort()\nsorted_dict = {k: d[k] for k in ks}\n\n# sort by values\nsorted(d.items(), key=lambda kv:(kv[1], kv[0]))\n</code></pre>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#reversed","title":"reversed","text":"<p>Python \u5185\u5efa\u6a21\u5757 builtins \u4e2d\u7684\u5de5\u5177\u7c7b <code>reversed</code> \u652f\u6301\u5bf9\u53ef\u8fed\u4ee3\u5e8f\u5217\u8fdb\u884c\u9006\u5e8f\uff0c\u6839\u636e\u8f93\u5165\u7684\u5e8f\u5217\u8fd4\u56de\u4e0d\u540c\u7c7b\u578b\u7684\u8fed\u4ee3\u5668\u3002</p> <ul> <li>\u5bf9\u8fd4\u56de\u7684\u8fed\u4ee3\u5668\u5bf9\u8c61\uff0c\u53ef\u76f4\u63a5 for \u5faa\u73af\u904d\u5386\u6216\u8c03\u7528 list() \u6784\u9020\u8f6c\u6362\u3002</li> </ul> <pre><code>class reversed(object)\n |  reversed(sequence, /)\n |\n |  Return a reverse iterator over the values of the given sequence.\n</code></pre> <p>\u4ee5\u4e0b\u4ee3\u7801\u7247\u6bb5\u5c06 str\u3001range\u3001tuple\u3001list \u4f20\u5165 reversed() \u8fd4\u56de\u5bf9\u5e94\u7684\u9006\u5e8f\u5217\u8fed\u4ee3\u5668\u3002</p> <pre><code>s='Hello, World!'\nrs=reversed(s)\ntype(rs) # \u8fd4\u56de reversed\n\nr = range(1,11)\nrr = reversed(r)\ntype(rr) # \u8fd4\u56de range_iterator\n\nt = tuple(r)\nrt = reversed(t)\ntype(rt) # \u8fd4\u56de reversed\n\nl = [*r]\nrl = reversed(l)\ntype(rl) # \u8fd4\u56de list_reverseiterator\n</code></pre>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#map","title":"map","text":"<p>Python \u5185\u5efa\u6a21\u5757 builtins \u4e2d\u7684\u5de5\u5177\u7c7b <code>map</code> \u652f\u6301\u5c06\u5e8f\u5217\u4e2d\u7684\u5143\u7d20\u505a\u6620\u5c04\u8f6c\u6362\uff0cfunc \u4e3a\u8f6c\u6362\u51fd\u6570\uff08converter\uff09\u3002 map \u8fed\u4ee3\u904d\u5386\u4f20\u5165\u7684 iterable object\uff0c\u5bf9\u6bcf\u4e2a\u5143\u7d20\u8c03\u7528\u8f6c\u6362\u51fd\u6570\uff08func\uff09\uff0c\u6620\u5c04\u751f\u6210\u65b0\u7684\u7684\u5143\u7d20\u5e8f\u5217\u3002 \u5982\u679c\u8f6c\u6362\u51fd\u6570\u5f88\u7b80\u77ed\u4e14\u4e0d\u5fc5\u8003\u8651\u590d\u7528\uff0c\u53ef\u6539\u7528 in-place \u5f62\u5f0f\u7684 lambda \u8868\u8fbe\u5f0f\u3002</p> <ul> <li>\u53ef\u5bf9\u8fd4\u56de\u7684 map \u5bf9\u8c61\u6267\u884c for \u5faa\u73af\u904d\u5386\u6216\u8c03\u7528 list() \u6784\u9020\u8f6c\u6362\u3002</li> </ul> <pre><code>Help on class map in module builtins:\n\nclass map(object)\n |  map(func, *iterables) --&gt; map object\n |\n |  Make an iterator that computes the function using arguments from\n |  each of the iterables.  Stops when the shortest iterable is exhausted.\n |\n |  Methods defined here:\n |\n |  __getattribute__(self, name, /)\n |      Return getattr(self, name).\n |\n |  __iter__(self, /)\n |      Implement iter(self).\n |\n |  __next__(self, /)\n |      Implement next(self).\n |\n |  __reduce__(...)\n |      Return state information for pickling.\n |\n |  ----------------------------------------------------------------------\n |  Static methods defined here:\n |\n |  __new__(*args, **kwargs) from builtins.type\n |      Create and return a new object.  See help(type) for accurate signature.\n</code></pre>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#demo1_stringcapwords","title":"demo1: string.capwords","text":"<p>string.py \u4e2d\u7684 string.capwords \u65b9\u6cd5\u5373\u4f7f\u7528 map \u5b9e\u73b0\uff1a</p> <pre><code># Capitalize the words in a string, e.g. \" aBc  dEf \" -&gt; \"Abc Def\".\ndef capwords(s, sep=None):\n    return (sep or ' ').join(map(str.capitalize, s.split(sep)))\n</code></pre>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#demo2_version_tuple_str2int","title":"demo2: version tuple str2int","text":"<ol> <li>sysconfig.get_python_version() \u8f93\u51fa '3.9'\uff0cplatform.python_version() \u8f93\u51fa '3.9.6'\u3002</li> </ol> <p><code>version_str2tuple</code> \u51fd\u6570\u5c06\u7248\u672c\u53f7\u5b57\u7b26\u4e32\u6309\u70b9\u53f7\uff08<code>.</code>\uff09\u5206\u5272\u6210\u5b57\u7b26\u6570\u7ec4\uff0c\u518d\u5bf9\u5b57\u7b26\u6570\u7ec4\u8c03\u7528 int \u9010\u4e00\u6620\u5c04\u4e3a\u6574\u6570\u3002</p> <pre><code>def version_str2tuple(vs:str):\n    return tuple(map(int, vs.split(\".\")))\n    # list comprehension\n    # return tuple([int(s) for s in vs.split('.')])\n</code></pre> <ul> <li>version_str2tuple(sysconfig.get_python_version()) \u8f93\u51fa (3, 9)\uff1b</li> <li>version_str2tuple(platform.python_version()) \u8f93\u51fa (3, 9, 6)\uff1b</li> </ul> <ol> <li>platform.python_version_tuple() \u8f93\u51fa ('3', '9', '6')\uff0c\u8c03\u7528 <code>version_tuple_str2int</code> \u51fd\u6570\u5c06\u5143\u7ec4\u5e8f\u5217\u4e2d\u7684\u5b57\u7b26\u8f6c\u6210\u6574\u6570\u3002</li> </ol> <pre><code>def version_tuple_str2int(vst:tuple):\n    return tuple(map(int, vst))\n    # list comprehension\n    # return tuple([int(s) for s in vst])\n</code></pre> <ul> <li>version_tuple_str2int(platform.python_version_tuple()) \u8f93\u51fa (3, 9, 6)\u3002</li> </ul> <p>\u5c06\u7248\u672c\u5b57\u7b26\u4e32\u8f6c\u6362\u6210\u6574\u6570tuple\u540e\uff0c\u5373\u53ef\u76f4\u63a5\u4e0e\u9884\u671f\u7248\u672ctuple\u8fdb\u884c\u6bd4\u8f83\u5339\u914d\u3002</p> <pre><code># '3.9'\nversion_str2tuple(sysconfig.get_python_version()) &gt; (3, 8)\n\n# '3.9.6'\nversion_str2tuple(platform.python_version()) &gt; (3, 9, 6)\n\n# ('3', '9', '6')\nversion_tuple_str2int(platform.python_version_tuple()) &gt; (3, 9, 6)\n\n# (3, 9, 6, 'final', 0)\ntuple(sys.version_info) &gt; (3, 9, 6) # sys.version_info &gt; (3, 9, 6)\n</code></pre> <p>\u4ee5\u4e0a\u793a\u4f8b\u4e2d\uff0c\u5b57\u7b26\u4e32\u8f6c\u6574\u6570\uff0c\u8f6c\u6362\u5668\u4e3a int \u7c7b\uff0c\u4f20\u5165\u5b57\u7b26\u4e32\u6784\u9020\u8f6c\u6362\u3002 \u5426\u5219\uff0c\u9700\u8981\u81ea\u5df1\u7f16\u5199\u8f6c\u6362\u5668\u3002\u5982\u679c\u8f6c\u6362\u5668\u51fd\u6570\u53ea\u4f7f\u7528\u4e00\u6b21\uff08\u4e0d\u8003\u8651\u590d\u7528\uff09\uff0c\u53ef\u4f7f\u7528 lambda \u8868\u8fbe\u5f0f\uff08\u533f\u540d\u51fd\u6570\uff09\u3002</p>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#demo3_sequence_calculation","title":"demo3: sequence calculation","text":"<p>\u4f8b\u5982\uff0c\u8981\u751f\u6210 1-10 \u7684\u5e73\u65b9\uff0c\u53ef\u4f7f\u7528 map \u5bf9 range(1,11) \u5e8f\u5217\u6267\u884c\u6620\u5c04\u8f6c\u6362\uff1a</p> <ul> <li>\u7b49\u6548\u5217\u8868\u63a8\u5bfc\uff1a[value**2 for value in range(1,11)]</li> </ul> <pre><code># [1, 4,9, 16, 25, 36, 49, 64, 81, 100]\n&gt;&gt;&gt; square=map(lambda x:x**2, range(1,11))\n&gt;&gt;&gt; next(square)\n1\n&gt;&gt;&gt; next(square)\n4\n&gt;&gt;&gt; [*square] # list(square)\n[9, 16, 25, 36, 49, 64, 81, 100]\n&gt;&gt;&gt; next(square)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n&gt;&gt;&gt; [*square]\n[]\n</code></pre> <p>\u9700\u8981\u8bf4\u660e\u7684\u662f\uff0c\u5bf9\u4e8e map \u5b9e\u4f8b\u5bf9\u8c61 square\uff0c\u4f20\u9012\u7ed9 list() \u6784\u9020\u540e\uff0c\u5df2\u7ecf\u904d\u5386\u5b8c\u6bd5\u3002 \u5c1d\u8bd5\u518d\u6b21\u8c03\u7528 next \u8fed\u4ee3\uff0c\u5c06\u629b\u51fa\u5f02\u5e38 StopIteration\u3002</p> <p>\u6765\u770b\u4e00\u4e2a\u65e5\u5e38\u751f\u6d3b\u4e2d\u7684\u5b9e\u9645\u5e94\u7528\u6848\u4f8b\u3002</p> <p>\u9700\u6c42\uff1aPDF\u6587\u6863\uff0c\u5b9e\u9645\u9875\u6570\u548c\u6587\u6863\u6807\u8bb0\u9875\u6570\u5b58\u5728\u8bef\u5dee\uff0c\u5982\u4f55\u5feb\u901f\u8ba1\u7b97\u6bcf\u4e00\u7ae0\u8282\u7684\u51c6\u786e\u8df3\u8f6c\u9875\u7801\uff1f \u65b9\u6848\uff1a\u5148\u770b\u770b\u6807\u8bb0\u7b2c\u4e00\u9875\u548c\u5b9e\u9645\u7b2c\u4e00\u9875\u4e4b\u95f4\u7684\u504f\u79fboffset\u3002\u7136\u540e\uff0c\u901a\u8fc7TOC\u67e5\u770b\u6bcf\u7ae0\u7684\u6807\u8bb0\u9875\u7801\uff0c\u904d\u5386\u52a0\u4e0a\u504f\u79fb\u91cf\u5373\u53ef\u5f97\u5230\u6bcf\u7ae0\u7684\u5b9e\u9645\u8df3\u8f6c\u9875\u7801\u3002</p> <p>Adding K to each element in a list of integers</p> <p>\u4f7f\u7528\u5217\u8868\u63a8\u5bfc\u5bf9\u9875\u6570\u8fdb\u884c\u77eb\u6b63\uff1a</p> <pre><code>page_no = [3,11,45,65,69,85,109,127,141,163,191,195,203,227]\noffset = 25\ncorrect_page_no = [p + offset for p in page_no]\n</code></pre> <p>\u4e5f\u53ef\u4f7f\u7528 map \u7ed3\u5408 lambda \u7684\u51fd\u6570\u5f0f\u7f16\u7a0b\u65b9\u5f0f\u5b9e\u73b0\u540c\u6837\u7684\u76ee\u7684\u3002</p> <pre><code>correct_page_no=list(map(lambda x:x+offset, page_no))\n</code></pre> <p>\u73b0\u4ee3 Python \u66f4\u591a\u5730\u91c7\u7528\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u8303\u5f0f\uff0c\u5efa\u8bae\u5c3d\u91cf\u4e0d\u91c7\u7528\u8fd9\u79cd\u51fd\u6570\u5f0f\u7f16\u7a0b\u65b9\u5f0f\uff0c\u5f53\u7136 map\u3001filter \u672c\u8eab\u4e5f\u662f\u7c7b\u3002 \u5982\u679c map \u548c filter \u4e2d\u8f6c\u6362/\u8fc7\u6ee4\u903b\u8f91\u7b80\u5355\u5230\u4e00\u884c\u4ee3\u7801\u5c31\u80fd\u5b9e\u73b0\u7684\uff0c\u5efa\u8bae\u91c7\u7528 lambda \u8868\u8fbe\u5f0f\u3002 \u6216\u76f4\u63a5\u91c7\u7528\u5217\u8868\u63a8\u5bfc\u7b49\u6548\u5b9e\u73b0\uff0c\u66f4\u52a0\u7b80\u6d01\u4e14\u53ef\u8bfb\u6027\u66f4\u9ad8\uff08concise and readable\uff09\u3002</p>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#filter","title":"filter","text":"<p>Python \u5185\u5efa\u6a21\u5757 builtins \u4e2d\u7684\u5de5\u5177\u7c7b <code>filter</code> \u652f\u6301\u5bf9 iterable \u5bf9\u8c61\u5b9e\u73b0\u8fc7\u6ee4\uff0c\u7b5b\u9009\u51fa\u7b26\u5408\u6761\u4ef6\u7684\u5143\u7d20\u3002 filter \u8fed\u4ee3\u904d\u5386\u4f20\u5165\u7684 object\uff0c\u5bf9\u6bcf\u4e2a\u5143\u7d20\u8c03\u7528\u8c13\u8bcd\u51fd\u6570\uff08function\uff09\u6267\u884c\u8fc7\u6ee4\uff0c\u7559\u4e0b\u7b26\u5408\u8c13\u8bcd\u6761\u4ef6\u7684\u5143\u7d20\u3002 \u5982\u679c\u8c13\u8bcd\u51fd\u6570\u5f88\u7b80\u77ed\u4e14\u4e0d\u5fc5\u8003\u8651\u590d\u7528\uff0c\u53ef\u6539\u7528 in-place \u5f62\u5f0f\u7684 lambda \u8868\u8fbe\u5f0f\u3002</p> <ul> <li>\u53ef\u5bf9\u8fd4\u56de\u7684 filter \u5bf9\u8c61\u6267\u884c for \u5faa\u73af\u904d\u5386\u6216\u8c03\u7528 list() \u6784\u9020\u8f6c\u6362\u3002</li> </ul> <pre><code># filter \u7684\u5b9a\u4e49\u548c map \u51e0\u4e4e\u4e00\u6837\u3002\n\nHelp on class filter in module builtins:\n\nclass filter(object)\n |  filter(function or None, iterable) --&gt; filter object\n |\n |  Return an iterator yielding those items of iterable for which function(item)\n |  is true. If function is None, return the items that are true.\n |\n |  Methods defined here:\n |\n |  __getattribute__(self, name, /)\n |      Return getattr(self, name).\n |\n |  __iter__(self, /)\n |      Implement iter(self).\n |\n |  __next__(self, /)\n |      Implement next(self).\n |\n |  __reduce__(...)\n |      Return state information for pickling.\n |\n |  ----------------------------------------------------------------------\n |  Static methods defined here:\n |\n |  __new__(*args, **kwargs) from builtins.type\n |      Create and return a new object.  See help(type) for accurate signature.\n</code></pre> <p>\u5047\u5982\u6211\u4eec\u60f3\u8fc7\u6ee4 1-10 \u4e2d\u7684\u5076\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528 filter \u8fc7\u6ee4\u51fa\u5e8f\u5217\u4e2d\u6574\u9664 2 \u7684\u5143\u7d20\uff1a</p> <ul> <li>\u57fa\u4e8e\u5217\u8868\u63a8\u5bfc\u7684\u7b49\u6548\u5b9e\u73b0\uff1a[n for n in range(1,11) if n%2==0]</li> </ul> <pre><code>&gt;&gt;&gt; even=filter(lambda n:n%2==0, range(1,11))\n&gt;&gt;&gt; [*even]\n[2, 4, 6, 8, 10]\n&gt;&gt;&gt; [*even]\n[]\n</code></pre> <p>\u540c\u6837\uff0c\u5bf9\u4e8e filter \u5b9e\u4f8b\u5bf9\u8c61 even\uff0c\u4f20\u9012\u7ed9 list() \u6784\u9020\u540e\uff0c\u5df2\u7ecf\u904d\u5386\u5b8c\u6bd5\u3002 \u5c1d\u8bd5\u518d\u6b21\u8c03\u7528 next \u8fed\u4ee3\uff0c\u5c06\u629b\u51fa\u5f02\u5e38 StopIteration\u3002</p> <p>\u4e0b\u9762\u901a\u8fc7 filter \u8fc7\u6ee4\u51fa\u4e86\u5185\u7f6e\u6a21\u5757\uff08builtins\uff09\u4e2d\u7684\u516c\u5f00\u7b26\u53f7\uff1a</p> <pre><code>&gt;&gt;&gt; import builtins, pprint\n&gt;&gt;&gt; builtin_sym=filter(lambda s:not s.startswith('_'), dir(builtins))\n&gt;&gt;&gt; pprint.pp([*builtin_sym])\n</code></pre> <p>\u518d\u4f7f\u7528 filter \u8fc7\u6ee4\u51fa\u4ee5\u201cis\u201d\u5f00\u5934\u7684\u5224\u65ad\u63a5\u53e3:</p> <pre><code>&gt;&gt;&gt; is_sym=filter(lambda s:s.startswith('is'), builtin_sym)\n&gt;&gt;&gt; [*is_sym]\n['isinstance', 'issubclass']\n</code></pre> <p>\u57fa\u4e8e\u5217\u8868\u63a8\u5bfc\u7684\u7b49\u6548\u5b9e\u73b0\uff1a</p> <p>[n for n in dir(builtins) if not n.startswith('_') and n.startswith('is')]</p> <p>\u8c13\u8bcd\u51fd\u6570\u76f8\u5173\u53c2\u8003\uff1a</p> <p>C++ STL \u4e2d\u5e26\u6709 <code>_if</code> \u540e\u7f00\u7684\u7b97\u6cd5\uff08std::find, std::find_if, std::find_if_not\uff09\u9700\u8981\u5e26\u6709\u8c13\u8bcd\u51fd\u6570\uff08UnaryPredicate\uff09\u4f5c\u4e3a\u5f62\u53c2\u3002</p> <p>\u5728 IBM DB2 \u6587\u6863\u4e2d\uff0c\u8c13\u8bcd \u662f\u4e00\u4e2a\u641c\u7d22\u6761\u4ef6\u7684\u5143\u7d20\uff0c\u5b83\u8868\u793a\u6216\u9690\u542b\u4e00\u4e2a\u6bd4\u8f83\u64cd\u4f5c\u3002\u8c13\u8bcd\u5305\u62ec\u5728\u4ee5 WHERE \u6216 HAVING \u5f00\u5934\u7684\u5b50\u53e5\u4e2d\u3002</p> <p>\u5728 IBM i7.5 \u6587\u6863\u4e2d\uff0c\u8c13\u8bcd\u00a0\u7531\u4e00\u4e2a\u79f0\u4e3a\u8c13\u8bcd\u8868\u8fbe\u5f0f\u7684\u8868\u8fbe\u5f0f\u7ec4\u6210\uff0c\u8be5\u8868\u8fbe\u5f0f\u62ec\u5728\u65b9\u62ec\u53f7 ([]) \u4e2d\u3002 \u8c13\u8bcd\u901a\u8fc7\u4fdd\u7559\u67d0\u4e9b\u9879\u5e76\u5e9f\u5f03\u5176\u4ed6\u9879\u6765\u8fc7\u6ee4\u5e8f\u5217\u3002\u9488\u5bf9\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e2a\u9879\u5bf9\u8c13\u8bcd\u8868\u8fbe\u5f0f\u6c42\u503c\u4e00\u6b21\u3002 \u8c13\u8bcd\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u79f0\u4e3a\u8c13\u8bcd\u771f\u503c\u7684\u00a0xs:boolean\u00a0\u503c\u3002 \u5c06\u4fdd\u7559\u8c13\u8bcd\u771f\u503c\u4e3a\u00a0true\u00a0\u7684\u90a3\u4e9b\u9879\uff0c\u5e76\u4e14\u5c06\u5e9f\u5f03\u8c13\u8bcd\u771f\u503c\u4e3a\u00a0false\u00a0\u7684\u90a3\u4e9b\u9879\u3002</p>","tags":["iterator"]},{"location":"blog/20191206/12-iterator/#itertools_1","title":"itertools","text":"<p>\u5982\u679c\u60f3\u8981\u8fc7\u6ee4\u51fa iterable object \u7b26\u5408\u6761\u4ef6\u7684\u5143\u7d20\uff0c\u9664\u4e86\u53ef\u4ee5\u8c03\u7528\u5185\u7f6e\u7684 filter \u5de5\u5177\u7c7b\u5916\uff0c\u4e5f\u53ef\u8c03\u7528 itertools \u4e2d\u7684\u76f8\u5173\u5de5\u5177\u96c6\u3002</p> <ul> <li>itertools.takewhile(predicate,\u00a0iterable)</li> <li>itertools.filterfalse(predicate,\u00a0iterable)</li> <li>itertools.dropwhile(predicate,\u00a0iterable)</li> </ul> <p>\u4ee5\u4e0a\u63a5\u53e3\u8fd4\u56de\u53ef\u8fed\u4ee3\u5bf9\u8c61 takewhile\u3001filterfalse\u3001dropwhile\uff0c\u9700\u8981\u5bf9\u5176\u8c03\u7528 next \u5b8c\u6210\u8fed\u4ee3\u3002</p> <p>itertools \u2014 Functions creating iterators for efficient looping \u2014 Python 3.12.2 documentation</p> <p>takewhile \u8fc7\u6ee4\u51fa\u7b26\u5408\u8c13\u8bcd\u903b\u8f91 predicate \u7684\u5143\u7d20\uff0c\u4e00\u65e6\u9047\u5230\u7b2c\u4e00\u4e2a\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u5373\u7ec8\u6b62\u3002</p> <pre><code>&gt;&gt;&gt; x=itertools.takewhile(lambda x:x&lt;5, [1,4,6,4,1])\n&gt;&gt;&gt; x\n&lt;itertools.takewhile object at 0x108f204c0&gt;\n&gt;&gt;&gt; next(x)\n1\n&gt;&gt;&gt; next(x)\n4\n&gt;&gt;&gt; next(x)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre> <p>filterfalse \u8fc7\u6ee4\u51fa\u6240\u6709\u4e0d\u7b26\u5408\u8c13\u8bcd\u903b\u8f91 predicate \u7684\u5143\u7d20\u3002</p> <pre><code>&gt;&gt;&gt; x=itertools.filterfalse(lambda x: x%2, range(10))\n&gt;&gt;&gt; next(x)\n0\n&gt;&gt;&gt; next(x)\n2\n&gt;&gt;&gt; next(x)\n4\n&gt;&gt;&gt; next(x)\n6\n&gt;&gt;&gt; next(x)\n8\n&gt;&gt;&gt; next(x)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre> <p>takewhile \u8fc7\u6ee4\u6389\u7b26\u5408\u8c13\u8bcd\u903b\u8f91 predicate \u7684\u5143\u7d20\uff0c\u4e00\u65e6\u9047\u5230\u7b2c\u4e00\u4e2a\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u4e88\u4ee5\u4fdd\u7559\uff08\u81f3\u672b\u5c3e\uff09\u3002</p> <pre><code>&gt;&gt;&gt; x=itertools.dropwhile(lambda x: x&lt;5, [1,4,6,4,1])\n&gt;&gt;&gt; next(x)\n6\n&gt;&gt;&gt; next(x)\n4\n&gt;&gt;&gt; next(x)\n1\n&gt;&gt;&gt; next(x)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre>","tags":["iterator"]},{"location":"blog/20191206/13-generator/","title":"python\u4e2d\u7684\u751f\u6210\u5668\u2014\u2014generator","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 python \u4e2d\u7684\u751f\u6210\u5668\u7c7b\u2014\u2014generator\uff0c\u4ecb\u7ecd\u4e86\u5176\u57fa\u672c\u6982\u5ff5\u548c\u57fa\u7840\u60ef\u7528\u6cd5\u3002</p> <p>Glossary \u2014 generator Built-in Types \u2014 Generator Types 9.9. Generators</p> <p>\u53ef\u501f\u9274\u53c2\u8003\u300aES6 \u6807\u51c6\u5165\u95e8\u300b\u7b2c 16 \u7ae0\u300aGenerator \u51fd\u6570\u7684\u8bed\u6cd5\u300b\u3002</p>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u672f\u8bed\u6982\u5ff5term","title":"\u672f\u8bed\u6982\u5ff5\uff08term\uff09","text":"<p>Glossary - generator\uff1a</p> <p>A function which returns a\u00a0generator iterator. It looks like a normal function except that it contains\u00a0<code>yield</code>\u00a0expressions for producing a series of values usable in a for-loop or that can be retrieved one at a time with the\u00a0<code>next()</code>\u00a0function.</p> <p>Usually refers to a generator function, but may refer to a\u00a0generator iterator\u00a0in some contexts. In cases where the intended meaning isn\u2019t clear, using the full terms avoids ambiguity.</p> <p>Generator Types:</p> <p>Python\u2019s\u00a0generators provide a convenient way to implement the iterator protocol. If a container object\u2019s\u00a0<code>__iter__()</code>\u00a0method is implemented as a generator, it will automatically return an iterator object (technically, a generator object) supplying the\u00a0<code>__iter__()</code>\u00a0and\u00a0<code>__next__()</code>\u00a0methods. More information about generators can be found in\u00a0the documentation for the yield expression.</p> <p>Generators:</p> <p>Generators\u00a0are a simple and powerful tool for creating iterators. They are written like regular functions but use the\u00a0<code>yield</code>\u00a0statement whenever they want to return data. Each time\u00a0<code>next()</code>\u00a0is called on it, the generator resumes where it left off (it remembers all the data values and which statement was last executed).</p>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u672f\u8bed\u7406\u89e3interpretation","title":"\u672f\u8bed\u7406\u89e3\uff08interpretation\uff09","text":"<p>\u751f\u6210\u5668\u7531\u4e24\u4e2a\u5355\u72ec\u7684\u90e8\u5206\u7ec4\u6210\uff1a\u751f\u6210\u5668\u7684\u51fd\u6570\u548c\u751f\u6210\u5668\u7684\u8fed\u4ee3\u5668\uff0c\u4e24\u4f4d\u4e00\u4f53\u901a\u79f0\u4e3a\u751f\u6210\u5668\uff08generator\uff09\u3002</p> <p>\u4ece\u5916\u8868\u770b\uff0c\u751f\u6210\u5668\u7684\u51fd\u6570\u548c\u666e\u901a\u51fd\u6570\u4e00\u6837\uff0c\u53ea\u662f\u5176\u4e2d\u5305\u542b\u4e00\u6761\u6216\u591a\u6761 yield \u8bed\u53e5\u3002 \u4ece\u8bed\u6cd5\u4e0a\uff0c\u53ef\u4ee5\u628a\u751f\u6210\u5668\u51fd\u6570\u7406\u89e3\u6210\u4e00\u4e2a\u72b6\u6001\u673a\uff0cyield \u8bed\u53e5\u5b9a\u4e49\u4e86\u4e0d\u540c\u7684\u5185\u90e8\u72b6\u6001\u3002</p> <p>\u5176\u6b21\uff0c\u5b83\u8fd8\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\u5bf9\u8c61\u751f\u6210\u51fd\u6570\uff0c\u8c03\u7528\u8be5\u51fd\u6570\u5e76\u4e0d\u7acb\u5373\u6267\u884c\u51fd\u6570\u4f53\uff0c\u800c\u662f\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\u3002 \u9488\u5bf9\u8fd4\u56de\u7684\u8fed\u4ee3\u5668\u5bf9\u8c61\uff0c\u53ef\u4ee5\u9010\u6b21\u8c03\u7528 next \u6216\u6267\u884c for \u5faa\u73af\u904d\u5386\u5176\u5185\u90e8 yield \u5b9a\u4e49\u7684\u72b6\u6001\u3002</p> <p>\u6bcf\u6b21\u8c03\u7528 next \u65b9\u6cd5\uff0c\u4ece\u51fd\u6570\u5934\u90e8\u6216\u4e0a\u4e00\u6b21\u505c\u4e0b\u6765\u7684\u5730\u65b9\u5f00\u59cb\u6267\u884c\uff0c\u76f4\u5230\u9047\u5230\u4e0b\u4e00\u6761 yield \u8bed\u53e5\u4e3a\u6b62\u3002 \u6362\u8a00\u4e4b\uff0c\u751f\u6210\u5668\u51fd\u6570\u662f\u5206\u6bb5\u6267\u884c\u7684\uff0cyield \u8bed\u53e5\u662f\u6682\u505c\u6267\u884c\u7684\u6807\u8bb0\uff0c\u800c next \u65b9\u6cd5\u53ef\u4ee5\u6062\u590d\u6267\u884c\u3002</p> <p><code>yield</code> \u8fd9\u4e2a\u5355\u8bcd\u65e2\u6709\u201c\u751f\u4ea7\u201d\u3001\u201c\u4ea7\u51fa\u201d\u7684\u610f\u601d\uff0c\u53c8\u6709\u201c\u8ba9\u8def\u201d\u3001\u201c\u8ba9\u51fa\u201d\u7684\u610f\u601d\uff0c\u771f\u662f\u4e00\u8bed\u53cc\u5173\uff01</p> <p>\u4e3a\u4e86\u9610\u8ff0 yield \u8bed\u53e5\u7684\u5177\u4f53\u4f5c\u7528\u673a\u5236\uff0c\u9996\u5148\u660e\u786e\u4e00\u4e0b\u201c\u8bed\u53e5\u201d\u548c\u201c\u8868\u8fbe\u5f0f\u201d\u7684\u6982\u5ff5\uff1a</p> <ul> <li>yield \u8bed\u53e5\uff1ayield (state)</li> <li>yield \u8868\u8fbe\u5f0f\uff1ay = yield (state)</li> </ul> <p>\u4e0b\u9762\u4ee5 yield \u8bed\u53e5\u8868\u8fbe\u5f0f <code>y = yield (state)</code> \u4e3a\u4f8b\uff0c\u521d\u6b65\u89e3\u8bfb\u4e00\u4e0b\u5176\u8fd0\u4f5c\u673a\u5236\uff1a</p> <ol> <li>\u8c03\u7528 next\uff0c\u8fd0\u884c\u81f3 yield \u8bed\u53e5\uff0c\u8fd4\u56de\u72b6\u6001\u503c\uff08yield state\uff09\uff0c\u5e76\u6682\u505c\u6267\u884c\uff08yield CPU control\uff09\u3002</li> <li>\u518d\u6b21\u8c03\u7528 next\uff0c\u4ece\u4e0a\u6b21\u7684 yield \u51bb\u7ed3\u70b9\u5524\u9192\uff0cyield \u8868\u8fbe\u5f0f\u8fd4\u56de None\uff0c\u5373 y=None\u3002</li> <li>\u5982\u679c\u60f3\u6539\u53d8 yield \u8868\u8fbe\u5f0f\u7684\u8fd4\u56de\u503c\uff0c\u53ef\u6539\u8c03 g.send(v)\uff0c\u6ce8\u5165 y=v\u3002</li> </ol> <p>\u5982\u679c\u4e00\u4e2a\u751f\u6210\u5668\u51fd\u6570\u5305\u542b\u591a\u6761 yield \u8bed\u53e5\uff0c\u5bf9\u5176\u8fed\u4ee3\u5668\u8fdb\u884c\u904d\u5386\u5373\u53ef\u83b7\u53d6\u591a\u4e2a\u72b6\u6001\u503c\u3002</p> <ul> <li>\u666e\u901a\u51fd\u6570\u53ea\u80fd\u901a\u8fc7 return \u8bed\u53e5\u8fd4\u56de\u4e00\u4e2a\u503c\u3002</li> </ul>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u751f\u6210\u5668\u6f14\u793ademonstration","title":"\u751f\u6210\u5668\u6f14\u793a\uff08demonstration\uff09","text":"<p>\u5148\u6765\u770b\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u751f\u6210\u5668\uff0c\u53ea\u6709\u4e00\u6761\u7a7a yield\uff0c\u4ec5\u5b9e\u73b0\u8ba9\u51fa\u8fd0\u884c\u6743\u7684\u6548\u679c\u3002</p> <pre><code>def generator1():\n    print('before yield')\n    yield\n    print('after yield')\n\ng1 = generator1()\n# NOP\nprint(next(g1))\n# before yield, yield nothing\nprint(next(g1))\n# after yield, no yield else\n</code></pre> <ol> <li>g1 = generator1()\uff1a\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u5c1a\u672a\u89e6\u53d1\u6267\u884c</li> <li>next(g1): \u89e6\u53d1\u6267\u884c\u751f\u6210\u5668\u51fd\u6570\uff0c\u6253\u5370 'before yield' \u540e\uff0c\u8fd0\u884c\u81f3 yield\uff0c\u65e0\u8fd4\u56de\u503c\uff0c\u51bb\u7ed3\u6682\u505c</li> <li>next(g1): yield \u5524\u9192\uff0c\u7ee7\u7eed\u8fd0\u884c\u6253\u5370 'after yield' \u540e\u7ed3\u675f\uff0c\u6ca1\u6709\u4e0b\u4e00\u6761 yield\uff0c\u629b\u51fa StopIteration \u5f02\u5e38</li> </ol> <p>\u7a0d\u4f5c\u6539\u8fdb\uff0cyield \u540e\u9762\u52a0\u4e00\u4e2a\u503c\uff0c\u770b\u770b\u8fd0\u884c\u6548\u679c\u3002</p> <pre><code>def generator2():\n    print('before yield')\n    yield 2024\n    print('after yield')\n\ng2 = generator2()\nprint(next(g2))\nprint(next(g2))\n</code></pre> <ol> <li>g2 = generator2()\uff1a\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u5c1a\u672a\u89e6\u53d1\u6267\u884c</li> <li>next(g2): \u89e6\u53d1\u6267\u884c\u751f\u6210\u5668\u51fd\u6570\uff0c\u6253\u5370 'before yield' \u540e\uff0c\u8fd0\u884c\u81f3 yield\uff0c\u8fd4\u56de 2024 \u6253\u5370\uff0c\u51bb\u7ed3\u6682\u505c</li> <li>next(g2): yield \u5524\u9192\uff0c\u7ee7\u7eed\u8fd0\u884c\u6253\u5370 'after yield' \u540e\u7ed3\u675f\uff0c\u6ca1\u6709\u4e0b\u4e00\u6761 yield\uff0c\u629b\u51fa StopIteration \u5f02\u5e38</li> </ol> <p>\u7ee7\u7eed\u6539\u8fdb\uff0c\u7ed9\u751f\u6210\u5668\u51fd\u6570\u589e\u52a0\u4e00\u6761 return \u8bed\u53e5\uff0c\u6267\u884c\u7ed3\u679c\u540c\u4e0a\u3002</p> <ul> <li>\u8fd9\u91cc\u548c ES6 \u4e0d\u4e00\u6837\uff0creturn \u8bed\u53e5\u4e0d\u540c\u4e8e yield \u8bed\u53e5\uff0c\u4e0d\u63a5\u53d7 next \u8bbf\u95ee\u8bed\u4e49\u3002</li> </ul> <pre><code>def generator3():\n    print('before yield')\n    yield 2024\n    print('after yield')\n    return 2025\n\ng3 = generator3()\nprint(next(g3))\nprint(next(g3))\n</code></pre> <p>\u7ee7\u7eed\u6539\u8fdb\uff0c\u518d\u589e\u52a0\u4e24\u6761 yield \u8bed\u53e5\uff1a</p> <pre><code>def generator4():\n    print('yield 1')\n    yield 2024\n    print('yield 2')\n    yield 2025\n    print('yield 3')\n    yield 2026\n\ng4 = generator4()\nprint(next(g4))\nprint(next(g4))\nprint(next(g4))\nprint(next(g4))\n</code></pre> <ol> <li>next(g4): \u8f93\u51fa\u4e24\u884c\uff1ayield 1; 2024</li> <li>next(g4): \u8f93\u51fa\u4e24\u884c\uff1ayield 2; 2025</li> <li>next(g4): \u8f93\u51fa\u4e24\u884c\uff1ayield 3; 2026</li> <li>next(g4): \u629b\u51fa StopIteration \u5f02\u5e38</li> </ol> <p>\u7531\u4e8e\u751f\u6210\u5668\u51fd\u6570\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u6545\u53ef\u4ee5\u76f4\u63a5\u5bf9\u5176\u6267\u884c for \u5faa\u73af\uff1a</p> <pre><code>for i in g4:\n    print(i)\n</code></pre> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6709 n \u6761 yield \u8bed\u53e5\uff0c\u5c31\u53ef\u4ee5\u8c03\u7528 n \u6b21 next \u8fed\u4ee3\u53d6\u503c\uff0c\u518d\u8c03\u4e00\u6b21\u629b\u51fa StopIteration \u5f02\u5e38\u3002</p>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u901a\u7528\u751f\u6210\u5668--\u9012\u5f52","title":"\u901a\u7528\u751f\u6210\u5668--\u9012\u5f52","text":"<p>\u8003\u8651\u6709\u4e00\u4e2a\u4e8c\u5c42\u5d4c\u5957\u5217\u8868\uff1anested = [[1, 2], [3, 4], [5]]\uff0c\u5176\u6bcf\u4e2a\u5143\u7d20\u8fd8\u662f\u5217\u8868\u3002\u6362\u800c\u8a00\u4e4b\uff0c\u8fd9\u662f\u4e00\u4e2a\u5217\u8868\u7684\u5217\u8868\u3002</p> <p>\u5982\u679c\u8981\u5c06\u5176\u5c55\u5f00\uff0c\u4e0b\u9762\u662f\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\uff1a</p> <pre><code>def flatten(nested):\n    for sublist in nested:\n        for element in sublist:\n            yield element\n</code></pre> <p>\u5916\u5c42 for \u5faa\u73af\u8fed\u4ee3\u63d0\u4f9b\u5d4c\u5957\u5217\u8868\u4e2d\u7684\u6240\u6709\u5b50\u5217\u8868\uff0c\u5185\u5b58 for \u5faa\u73af\u6309\u987a\u5e8f\u8fed\u4ee3\u6bcf\u4e2a\u5b50\u5217\u8868\u7684\u5143\u7d20\u3002 \u4e4b\u524d\u7684\u5b9e\u73b0\u6700\u540e\u4e00\u884c\u4e3a print(element)\uff0c\u8fd9\u91cc\u6539\u4e3a\u4e86 yield element \u5c06\u5176\u53d8\u6210\u4e86\u751f\u6210\u5668\u3002</p> <p>\u4f20\u5165\u8981\u5c55\u5f00\u7684\u5d4c\u5957\u5217\u8868\uff0c\u7136\u540e\u5bf9 flatten \u8fd4\u56de\u7684\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u4f7f\u7528 for \u5faa\u73af\u8fed\u4ee3\u5373\u53ef\u3002</p> <pre><code>nested = [[1, 2], [3, 4], [5]]\nfor e in flatten(nested):\n    print(e)\n</code></pre> <p>\u4f46\u662f\uff0c\u4e0a\u9762\u8bbe\u8ba1\u7684\u751f\u6210\u5668\u53ea\u80fd\u5904\u7406\u4e24\u5c42\u7684\u5d4c\u5957\u5217\u8868\uff0c\u8fd9\u662f\u4f7f\u7528\u4e24\u4e2afor\u5faa\u73af\u6765\u5b9e\u73b0\u7684\u3002\u5982\u679c\u8981\u5904\u7406\u4efb\u610f\u5c42\u5d4c\u5957\u7684\u5217\u8868\uff0c\u8be5\u5982\u4f55\u529e\u5462\uff1f \u5bf9\u4e8e\u6bcf\u5c42\u5d4c\u5957\uff0c\u90fd\u9700\u8981\u4e00\u4e2afor\u5faa\u73af\uff0c\u4f46\u7531\u4e8e\u4e0d\u77e5\u9053\u6709\u591a\u5c11\u5c42\u5d4c\u5957\uff0c\u4f60\u5fc5\u987b\u4fee\u6539\u89e3\u51b3\u65b9\u6848\uff0c\u4f7f\u5176\u66f4\u7075\u6d3b\u3002\u8be5\u6c42\u52a9\u4e8e\u9012\u5f52\u4e86\u3002</p> <pre><code>def flatten(nested):\n    try:\n        for sublist in nested:\n            for element in flatten(sublist):\n                yield element\n    except TypeError:\n        yield nested\n\nnested = [[[1], 2], 3, 4, [5, [6, 7]], 8]\nfor e in flatten(nested):\n    print(e)\n</code></pre> <p>\u8c03\u7528flatten\u65f6\uff0c\u6709\u4e24\u79cd\u53ef\u80fd\u6027\uff08\u5904\u7406\u9012\u5f52\u65f6\u90fd\u5982\u6b64\uff09\uff1a\u57fa\u7ebf\u6761\u4ef6\u548c\u9012\u5f52\u6761\u4ef6\u3002\u5728\u57fa\u7ebf\u6761\u4ef6\u4e0b\uff0c \u8981\u6c42\u8fd9\u4e2a\u51fd\u6570\u5c55\u5f00\u5355\u4e2a\u5143\u7d20\uff08\u5982\u4e00\u4e2a\u6570\uff09\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cfor\u5faa\u73af\u5c06\u5f15\u53d1TypeError\u5f02\u5e38\uff08\u56e0\u4e3a\u4f60\u8bd5\u56fe\u8fed\u4ee3\u4e00\u4e2a\u6570\uff09\uff0c\u800c\u8fd9\u4e2a\u751f\u6210\u5668\u53ea\u751f\u6210\u4e00\u4e2a\u5143\u7d20\u3002</p> <p>\u7136\u800c\uff0c\u5982\u679c\u8981\u5c55\u5f00\u7684\u662f\u4e00\u4e2a\u5217\u8868\uff08\u6216\u5176\u4ed6\u4efb\u4f55\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff09\uff0c\u4f60\u5c31\u9700\u8981\u505a\u4e9b\u5de5\u4f5c\uff1a\u904d\u5386\u6240\u6709\u7684\u5b50\u5217\u8868\uff08\u5176\u4e2d\u6709\u4e9b\u53ef\u80fd\u5e76\u4e0d\u662f\u5217\u8868\uff09\u5e76\u5bf9\u5b83\u4eec\u8c03\u7528flatten\uff0c\u7136\u540e\u4f7f\u7528\u53e6\u4e00\u4e2afor\u5faa\u73af\u751f\u6210\u5c55\u5f00\u540e\u7684\u5b50\u5217\u8868\u4e2d\u7684\u6240\u6709\u5143\u7d20\u3002</p> <p>\u4f46\u662f\uff0c\u8fd9\u4e2a\u89e3\u51b3\u65b9\u6848\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u679cnested\u662f\u5b57\u7b26\u4e32\u6216\u7c7b\u4f3c\u4e8e\u5b57\u7b26\u4e32\u7684\u5bf9\u8c61\uff0c\u5b83\u5c31\u5c5e\u4e8e\u5e8f\u5217\uff0c\u56e0\u6b64\u4e0d\u4f1a\u5f15\u53d1TypeError\u5f02\u5e38\uff0c\u53ef\u4f60\u5e76\u4e0d\u60f3\u5bf9\u5176\u8fdb\u884c\u8fed\u4ee3\u3002</p> <p>\u5728\u51fd\u6570 flatten \u4e2d\uff0c\u4e0d\u5e94\u8be5\u5bf9\u7c7b\u4f3c\u4e8e\u5b57\u7b26\u4e32\u7684\u5bf9\u8c61\u8fdb\u884c\u8fed\u4ee3\uff0c\u4e3b\u8981\u539f\u56e0\u6709\u4e24\u4e2a\u3002\u9996\u5148\uff0c\u4f60\u60f3\u5c06\u7c7b\u4f3c\u4e8e\u5b57\u7b26\u4e32\u7684\u5bf9\u8c61\u89c6\u4e3a\u539f\u5b50\u503c\uff0c\u800c\u4e0d\u662f\u5e94\u8be5\u5c55\u5f00\u7684\u5e8f\u5217\u3002\u5176\u6b21\uff0c\u5bf9\u8fd9\u6837\u7684\u5bf9\u8c61\u8fdb\u884c\u8fed\u4ee3\u4f1a\u5bfc\u81f4\u65e0\u7a77\u9012\u5f52\uff0c\u56e0\u4e3a\u5b57\u7b26\u4e32\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a1\u7684\u5b57\u7b26\u4e32\uff0c\u800c\u957f\u5ea6\u4e3a1\u7684\u5b57\u7b26\u4e32\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u662f\u5b57\u7b26\u4e32\u672c\u8eab\uff01</p> <p>\u8981\u5904\u7406\u8fd9\u79cd\u95ee\u9898\uff0c\u5fc5\u987b\u5728\u751f\u6210\u5668\u5f00\u5934\u8fdb\u884c\u68c0\u67e5\u3002\u8981\u68c0\u67e5\u5bf9\u8c61\u662f\u5426\u7c7b\u4f3c\u4e8e\u5b57\u7b26\u4e32\uff0c\u6700\u7b80\u5355\u3001\u6700 \u5feb\u6377\u7684\u65b9\u5f0f\u662f\uff0c\u5c1d\u8bd5\u5c06\u5bf9\u8c61\u4e0e\u4e00\u4e2a\u5b57\u7b26\u4e32\u62fc\u63a5\u8d77\u6765\uff0c\u5e76\u68c0\u67e5\u8fd9\u662f\u5426\u4f1a\u5f15\u53d1TypeError\u5f02\u5e38\u3002\u6dfb\u52a0 \u8fd9\u79cd\u68c0\u67e5\u540e\u7684\u751f\u6210\u5668\u5982\u4e0b\uff1a</p> <pre><code>def flatten(nested):\n    try:\n        try: nested + ''\n        except TypeError: pass # \u975e\u5b57\u7b26\u4e32\u62fc\u63a5\u5f02\u5e38\uff0c\u7ee7\u7eed\u8fed\u4ee3\n        else: raise TypeError  # \u7c7b\u5b57\u7b26\u4e32\u5bf9\u8c61\uff0c\u4e0d\u8fed\u4ee3\n\n        for sublist in nested:\n            for element in flatten(sublist):\n                yield element\n    except TypeError:\n        yield nested\n\nnested = ['foo', ['bar', ['baz']]]\nfor e in flatten(nested):\n    print(e)\n</code></pre>","tags":["generator"]},{"location":"blog/20191206/13-generator/#yield_from_subgenerator","title":"yield from subgenerator","text":"<p>flatten \u672c\u8eab\u662f\u4e2a\u51fd\u6570\u751f\u6210\u5668\uff0c\u5185\u90e8\u9012\u5f52\u8c03\u7528\u76f8\u5f53\u4e8e subgenerator\uff0c\u53ef\u4ee5\u6539\u7528 <code>yield from</code> \u8bed\u53e5\uff0c\u66f4\u52a0\u7b80\u6d01\u3002 \u5982\u679c\u4e0d\u52a0 isinstance \u5224\u65ad\u6392\u9664 str\uff0c\u4f1a\u62a5\u9519 RecursionError: maximum recursion depth exceeded\u3002</p> <pre><code>def flatten(sequence):\n    \"\"\"flatten a multi level list or something\n    &gt;&gt;&gt; list(flatten([1, [2], 3]))\n    [1, 2, 3]\n    &gt;&gt;&gt; list(flatten([1, [2], [3, [4]]]))\n    [1, 2, 3, 4]\n    \"\"\"\n    for element in sequence:\n        if hasattr(element, '__iter__') and not isinstance(element, str):\n            yield from flatten(element)\n        else:\n            yield element\n\nprint(list(flatten([1, [2], [3, [4]]])))\nprint(list(flatten([[[1], 2], 3, 4, [5, [6, 7]], 8])))\nprint(list(flatten(['foo', ['bar', ['baz']]])))\n</code></pre> <p>\u53c2\u8003\uff1a</p> <ul> <li>Python yield from \u7528\u6cd5\u8be6\u89e3 - \u7b80\u4e66</li> <li>In practice, what are the main uses for the \"yield from\" syntax in Python 3.3? - Stack Overflow</li> </ul>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u901a\u7528\u751f\u6210\u5668--\u5e26\u5faa\u73af","title":"\u901a\u7528\u751f\u6210\u5668--\u5e26\u5faa\u73af","text":"<p>\u4ee5\u4e0b repeater \u662f\u4e2a\u65e0\u9650\u5faa\u73af\uff0c\u521d\u59cb\u4f20\u5165 value=3\uff0c\u6bcf\u6b21\u8c03\u7528 next \u8fd4\u56de value=3\u3002</p> <pre><code>def repeater(value):\n    while True:\n        yield value\n\nr=repeater(3)\nprint(next(r))\nprint(next(r))\nprint(next(r))\n</code></pre> <ol> <li>r=repeater(3)\uff1avalue=3\uff0c\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u5c1a\u672a\u89e6\u53d1\u6267\u884c</li> <li>next(r): \u89e6\u53d1\u6267\u884c\u751f\u6210\u5668\u51fd\u6570\uff0c\u8fd0\u884c\u81f3 yield\uff0c\u8fd4\u56de 3 \u540e\u51bb\u7ed3</li> <li>next(r): yield \u8fd4\u56de None\uff0c\u7ee7\u7eed\u5faa\u73af\u81f3 yield\uff0c\u8fd4\u56de 3 \u540e\u51bb\u7ed3</li> <li>next(r): \u540c\u4e0a</li> </ol> <p>\u53ef\u53c2\u8003 itertools \u2014 Functions creating iterators for efficient looping \u4e2d takewhile\u3001filterfalse \u548c dropwhile \u7684\u7b49\u6548\u751f\u6210\u5668\u5b9e\u73b0\u3002</p> <pre><code># \u8fc7\u6ee4\u51fa\u7b26\u5408\u8c13\u8bcd\u903b\u8f91 predicate \u7684\u5143\u7d20\uff0c\u4e00\u65e6\u9047\u5230\u7b2c\u4e00\u4e2a\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u5373\u7ec8\u6b62\u3002\ndef takewhile(predicate, iterable):\n    # takewhile(lambda x: x&lt;5, [1,4,6,4,1]) --&gt; 1 4\n    for x in iterable:\n        if predicate(x):\n            yield x\n        else:\n            break\n\n# \u8fc7\u6ee4\u51fa\u6240\u6709\u4e0d\u7b26\u5408\u8c13\u8bcd\u903b\u8f91 predicate \u7684\u5143\u7d20\u3002\ndef filterfalse(predicate, iterable):\n    # filterfalse(lambda x: x%2, range(10)) --&gt; 0 2 4 6 8\n    if predicate is None:\n        predicate = bool\n    for x in iterable:\n        if not predicate(x):\n            yield x\n\n# \u8fc7\u6ee4\u6389\u7b26\u5408\u8c13\u8bcd\u903b\u8f91 predicate \u7684\u5143\u7d20\uff0c\u4e00\u65e6\u9047\u5230\u7b2c\u4e00\u4e2a\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u4e88\u4ee5\u4fdd\u7559\uff08\u81f3\u672b\u5c3e\uff09\u3002\ndef dropwhile(predicate, iterable):\n    # dropwhile(lambda x: x&lt;5, [1,4,6,4,1]) --&gt; 6 4 1\n    iterable = iter(iterable)\n    for x in iterable:\n        if not predicate(x):\n            yield x\n            break\n    for x in iterable:\n        yield x\n</code></pre>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u901a\u7528\u751f\u6210\u5668--\u5916\u90e8\u901a\u4fe1","title":"\u901a\u7528\u751f\u6210\u5668--\u5916\u90e8\u901a\u4fe1","text":"<p>\u5728\u751f\u6210\u5668\u5f00\u59cb\u8fd0\u884c\u540e\uff0c\u53ef\u4f7f\u7528\u751f\u6210\u5668\u548c\u5916\u90e8\u4e4b\u95f4\u7684\u901a\u4fe1\u6e20\u9053\u5411\u5b83\u63d0\u4f9b\u503c\u3002\u8fd9\u4e2a\u901a\u4fe1\u6e20\u9053\u5305\u542b\u5982\u4e0b\u4e24\u4e2a\u7aef\u70b9\uff1a</p> <ul> <li>\u5916\u90e8\u4e16\u754c\uff1a\u5916\u90e8\u4e16\u754c\u53ef\u8bbf\u95ee\u751f\u6210\u5668\u7684\u65b9\u6cd5 send\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u7c7b\u4f3c\u4e8e next\uff0c\u4f46\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff08\u8981\u53d1\u9001\u7684\u201c\u6d88\u606f\u201d\uff0c\u53ef\u4ee5\u662f\u4efb\u4f55\u5bf9\u8c61\uff09\u3002</li> <li>\u751f\u6210\u5668\uff1a\u5728\u6302\u8d77\u7684\u751f\u6210\u5668\u5185\u90e8\uff0cyield \u53ef\u80fd\u7528\u4f5c\u8868\u8fbe\u5f0f\u800c\u4e0d\u662f\u8bed\u53e5\u3002\u6362\u800c\u8a00\u4e4b\uff0c\u5f53\u751f\u6210\u5668\u91cd\u65b0\u8fd0\u884c\u65f6\uff0cyield \u8fd4\u56de\u4e00\u4e2a\u503c\u2014\u2014\u901a\u8fc7 send \u4ece\u5916\u90e8\u4e16\u754c\u53d1\u9001\u7684\u503c\u3002</li> </ul> <p>\u8bf7\u6ce8\u610f\uff0c\u4ec5\u5f53\u751f\u6210\u5668\u88ab\u6302\u8d77\uff08\u5373\u9047\u5230\u7b2c\u4e00\u4e2a yield\uff09\u540e\uff0c\u4f7f\u7528 send\uff08\u800c\u4e0d\u662f next\uff09\u624d\u6709\u610f\u4e49\u3002 \u8981\u5728\u6b64\u4e4b\u524d\u5411\u751f\u6210\u5668\u63d0\u4f9b\u4fe1\u606f\uff0c\u53ef\u4f7f\u7528\u751f\u6210\u5668\u7684\u51fd\u6570\u7684\u53c2\u6570\u3002</p> <p>\u6ce8\u610f\uff1a\u5982\u679c\u4e00\u5b9a\u8981\u5728\u751f\u6210\u5668\u521a\u542f\u52a8\u65f6\u5bf9\u5176\u8c03\u7528\u65b9\u6cd5 send\uff0c\u53ef\u5411\u5b83\u4f20\u9012\u53c2\u6570 None\u3002</p> <p>\u4e0a\u9762\u7684 repeater \u5c31\u662f\u4e2a\u7b80\u5355\u7684\u590d\u8bfb\u673a\uff0c\u65e0\u9650\u5faa\u73af\u8f93\u51fa\u521d\u59cb\u7ed9\u5b9a\u7684\u503c\u3002 \u5bf9\u5176\u7a0d\u52a0\u4fee\u6539\uff0c\u5728\u4e2d\u9014\u8c03\u7528 send \u5411\u5176\u5185\u90e8\u6ce8\u5165\u65b0\u503c\uff0c\u66f4\u65b0\u5185\u90e8\u72b6\u6001\uff08\u5373\u590d\u8bfb\u7684\u5185\u5bb9\uff09\u3002</p> <pre><code>def repeater(value):\n    while True:\n        print('before yield')\n        yret = yield value\n        print('after yield', yret)\n        if yret:\n            value = yret # update with send param\n\nr=repeater(3)\nprint(next(r))\nprint(next(r))\nprint(r.send('24'))\nprint(next(r))\nprint(next(r))\n</code></pre> <ol> <li>r=repeater(3)\uff1a\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u5c1a\u672a\u89e6\u53d1\u6267\u884c</li> <li>next(r): \u89e6\u53d1\u6267\u884c\u751f\u6210\u5668\u51fd\u6570\uff0c\u8fd0\u884c\u81f3 yield\uff0c\u8fd4\u56de value=3 \u540e\u51bb\u7ed3</li> <li>next(r): yield \u8fd4\u56de None\uff0c\u7ee7\u7eed\u5faa\u73af\u81f3 yield\uff0c\u8fd4\u56de value=3 \u540e\u51bb\u7ed3</li> <li>r.send('24'): yield \u8fd4\u56de 24 \u5e76\u66f4\u65b0 value=24\uff0c\u7ee7\u7eed\u5faa\u73af\u81f3 yield\uff0c\u8fd4\u56de value=24 \u540e\u51bb\u7ed3</li> <li>next(r): yield \u8fd4\u56de None\uff0c\u7ee7\u7eed\u5faa\u73af\u81f3 yield\uff0c\u8fd4\u56de value=24 \u540e\u51bb\u7ed3</li> <li>next(r): \u540c\u4e0a</li> </ol> <p>\u4e0b\u9762\u7efc\u5408\u6f14\u793a yield \u8bed\u53e5\u548c\u8868\u8fbe\u5f0f\u6df7\u5408\u4f7f\u7528\uff1a</p> <pre><code>def generator5(x):\n    y = 2 * (yield (x+1))\n    z = yield (y//3)\n    yield (x+y+z)\n\ng5 = generator5(5)\nprint(next(g5))\nprint(next(g5))\n</code></pre> <ol> <li>g5=generator5(5)\uff1ax=5\uff0c\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u5c1a\u672a\u89e6\u53d1\u6267\u884c</li> <li>next(g5): \u89e6\u53d1\u6267\u884c\u751f\u6210\u5668\u51fd\u6570\uff0c\u8fd0\u884c\u81f3 yield\uff0c\u8fd4\u56de x+1=6 \u540e\u51bb\u7ed3</li> <li> <p>next(g5): yield \u8868\u8fbe\u5f0f\u8fd4\u56de None\uff0c\u4e0e\u6574\u6570 2 \u76f8\u4e58\uff0c\u62a5\u5f02\u5e38 TypeError\uff1a</p> <ul> <li>TypeError: unsupported operand type(s) for *: 'int' and 'NoneType'</li> </ul> </li> </ol> <p>\u4fee\u6539\u6d4b\u8bd5\u4ee3\u7801\uff0c\u7b2c\u4e00\u6b21\u8c03\u7528 next(g5) \u540e\uff0c\u53ef\u4ee5\u8c03\u7528 send \u5411\u5185\u6ce8\u5165 yield \u8868\u8fbe\u5f0f\u503c\uff1a</p> <pre><code>g5 = generator5(5)\nprint(next(g5))\nprint(g5.send(12))\nprint(next(g5))\n</code></pre> <ol> <li>g5=generator5(5)\uff1ax=5\uff0c\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u5c1a\u672a\u89e6\u53d1\u6267\u884c</li> <li>next(g5): \u89e6\u53d1\u6267\u884c\u751f\u6210\u5668\u51fd\u6570\uff0c\u8fd0\u884c\u81f3 yield\uff0c\u8fd4\u56de x+1=6 \u540e\u51bb\u7ed3</li> <li>g5.send(12)\uff1a\u7b2c1\u4e2a yield \u8868\u8fbe\u5f0f\u8fd4\u56de 12\uff0cy=2*12=24\uff0c\u8fd4\u56de y//3=8</li> <li>next(g5): \u7b2c2\u4e2a yield \u8868\u8fbe\u5f0f\u8fd4\u56de None\uff0cz=None\uff0c\u7b2c\u4e09\u4e2a yield \u8bed\u53e5\u62a5\u5f02\u5e38 TypeError:</li> </ol> <ul> <li>TypeError: unsupported operand type(s) for +: 'int' and 'NoneType'</li> </ul> <p>\u518d\u6b21\u4fee\u6539\u6d4b\u8bd5\u90e8\u5206\uff0c\u628a send \u540e\u7684 next \u6539\u4e3a\u518d\u6b21 send \u4f20\u503c\uff1a</p> <pre><code>g5 = generator5(5)\nprint(next(g5))\nprint(g5.send(12))\nprint(g5.send(13))\n</code></pre> <ol> <li>g5=generator5(5)\uff1ax=5\uff0c\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u5c1a\u672a\u89e6\u53d1\u6267\u884c</li> <li>next(g5): \u89e6\u53d1\u6267\u884c\u751f\u6210\u5668\u51fd\u6570\uff0c\u8fd0\u884c\u81f3 yield\uff0c\u8fd4\u56de x+1=6 \u540e\u51bb\u7ed3</li> <li>g5.send(12)\uff1a\u7b2c1\u4e2a yield \u8868\u8fbe\u5f0f\u8fd4\u56de 12\uff0cy=2*12=24\uff0c\u8fd4\u56de y//3=8</li> <li>g5.send(13)\uff1a\u7b2c2\u4e2a yield \u8868\u8fbe\u5f0f\u8fd4\u56de 13\uff0cz=13\uff0cyield \u8bed\u53e5 x+y+z=5+24+13=42\uff0c\u8fd4\u56de 42</li> </ol>","tags":["generator"]},{"location":"blog/20191206/13-generator/#throw__close","title":"throw &amp; close","text":"<p>\u751f\u6210\u5668\u8fd8\u5305\u542b\u53e6\u5916\u4e24\u4e2a\u65b9\u6cd5\u3002</p> <ul> <li><code>throw</code>\uff1a\u7528\u4e8e\u5728\u751f\u6210\u5668\u4e2d\uff08yield\u8868\u8fbe\u5f0f\u5904\uff09\u5f15\u53d1\u5f02\u5e38\uff0c\u5e76\u8fd4\u56de\u4e0b\u4e00\u4e2a\u72b6\u6001\u3002\u8c03\u7528\u65f6\u53ef\u63d0\u4f9b\u4e00\u4e2a\u5f02\u5e38\u7c7b\u578b\u3001\u4e00\u4e2a\u53ef\u9009\u503c\u548c\u4e00\u4e2atraceback\u5bf9\u8c61\u3002</li> <li><code>close</code>\uff1a\u7528\u4e8e\u505c\u6b62\u751f\u6210\u5668\uff0c\u8c03\u7528\u65f6\u65e0\u9700\u63d0\u4f9b\u4efb\u4f55\u53c2\u6570\u3002</li> </ul> <p>\u65b9\u6cd5 close\uff08\u7531Python\u5783\u573e\u6536\u96c6\u5668\u5728\u9700\u8981\u65f6\u8c03\u7528\uff09\u4e5f\u662f\u57fa\u4e8e\u5f02\u5e38\u7684\uff1a\u5728 yield \u5904\u5f15\u53d1 <code>GeneratorExit</code> \u5f02\u5e38\u3002 \u56e0\u6b64\u5982\u679c\u8981\u5728\u751f\u6210\u5668\u4e2d\u63d0\u4f9b\u4e00\u4e9b\u6e05\u7406\u4ee3\u7801\uff0c\u53ef\u5c06yield\u653e\u5728\u4e00\u6761 try/finally \u8bed\u53e5\u4e2d\u3002</p> <pre><code>def echo(value=None):\n    print(\"Execution starts when 'next()' is called for the first time.\")\n    try:\n        while True:\n            try:\n                value = (yield value)\n            except Exception as e:\n                value = e\n    finally:\n        print(\"Don't forget to clean up when 'close()' is called.\")\n</code></pre> <p>\u8c03\u7528\u751f\u6210\u5668\u51fd\u6570\uff0c\u521d\u59cb\u5316\u751f\u6210\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u5e76\u9996\u6b21\u8c03\u7528 next\uff1a</p> <pre><code>&gt;&gt;&gt; generator = echo(1)\n&gt;&gt;&gt; print(next(generator))\nExecution starts when 'next()' is called for the first time.\n1\n</code></pre> <p>\u518d\u6b21\u8c03\u7528 next\uff0c\u6fc0\u6d3b\u4e0a\u6b21 yield \u8868\u8fbe\u5f0f\u8fd4\u56de None \u8d4b\u503c\u7ed9 value\uff0c\u518d\u6b21\u8fd0\u884c\u81f3 yield \u8fd4\u56de value=None\u3002</p> <pre><code>&gt;&gt;&gt; print(next(generator))\nNone\n</code></pre> <p>\u5bf9\u751f\u6210\u5668\u8c03\u7528 send \u6ce8\u5165\u65b0\u72b6\u6001\uff08value=2\uff09\uff0c\u91cd\u65b0 yield \u8fd4\u56de value=2\uff1a</p> <pre><code>&gt;&gt;&gt; print(generator.send(2))\n2\n</code></pre> <p>\u4e3a\u4e0a\u6b21 yield \u51bb\u7ed3\u70b9\u6ce8\u5165\u5f02\u5e38\uff0c\u6355\u83b7\u66f4\u65b0\u72b6\u6001 value=TypeError('spam')\uff0c\u5e76\u8fd0\u884c\u81f3\u4e0b\u4e00\u6761 yield \u8fd4\u56de value\uff1a</p> <pre><code>&gt;&gt;&gt; generator.throw(TypeError(\"spam\"))\nTypeError('spam')\n</code></pre> <p>\u4e3a\u4e0a\u6b21 yield \u51bb\u7ed3\u70b9\u6ce8\u5165 GeneratorExit \u5f02\u5e38\uff0c\u6267\u884c finally \u4ee3\u7801\u5757\uff1a</p> <pre><code>&gt;&gt;&gt; generator.close()\nDon't forget to clean up when 'close()' is called.\n</code></pre> <p>\u8c03\u7528 close \u5173\u95ed\u72b6\u6001\u673a\u540e\uff0c\u518d\u6b21\u8c03\u7528 next \u5c06\u62a5 StopIteration \u5f02\u5e38\u3002</p> <pre><code>&gt;&gt;&gt; next(generator)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u5706\u62ec\u53f7\u6784\u9020\u751f\u6210\u5668\u8868\u8fbe\u5f0f","title":"\u5706\u62ec\u53f7\u6784\u9020\u751f\u6210\u5668\u8868\u8fbe\u5f0f","text":"<p>\u5728 Python 2.4 \u4e2d\uff0c\u5f15\u5165\u4e86\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u5217\u8868\u63a8\u5bfc\uff08List Comprehension\uff09\u7684\u6982\u5ff5\uff1a\u751f\u6210\u5668\u63a8\u5bfc\uff0c\u4e5f\u53eb\u751f\u6210\u5668\u8868\u8fbe\u5f0f\uff08Generator Expressions\uff09\u3002 \u5176\u5de5\u4f5c\u539f\u7406\u4e0e\u5217\u8868\u63a8\u5bfc\u76f8\u540c\uff0c\u4f46\u4e0d\u662f\u521b\u5efa\u4e00\u4e2a\u5217\u8868\uff08\u5373\u4e0d\u7acb\u5373\u6267\u884c\u5faa\u73af\uff09\uff0c\u800c\u662f\u8fd4\u56de\u4e00\u4e2a\u751f\u6210\u5668\uff0c\u8ba9\u4f60\u80fd\u591f\u9010\u6b65\u6267\u884c\u8ba1\u7b97\u3002</p> <pre><code>&gt;&gt;&gt; g = ((i + 2) ** 2 for i in range(2, 27))\n&gt;&gt;&gt; next(g)\n16\n&gt;&gt;&gt; golf = 'golf'\n&gt;&gt;&gt; list(golf[i] for i in range(len(golf)-1, -1, -1))\n['f', 'l', 'o', 'g']\n</code></pre> <p>\u5982\u4f60\u6240\u89c1\uff0c\u4e0d\u540c\u4e8e\u5217\u8868\u63a8\u5bfc\uff0c\u8fd9\u91cc\u4f7f\u7528\u7684\u662f\u5706\u62ec\u53f7\u3002\u5728\u50cf\u8fd9\u6837\u7684\u7b80\u5355\u60c5\u5f62\u4e0b\uff0c\u8fd8\u4e0d\u5982\u4f7f\u7528\u5217\u8868\u63a8\u5bfc\uff1b\u4f46\u5982\u679c\u8981\u5305\u88c5\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff08\u53ef\u80fd\u751f\u6210\u5927\u91cf\u7684\u503c\uff09\uff0c\u4f7f\u7528\u5217\u8868\u63a8\u5bfc\u5c06\u7acb\u5373\u5b9e\u4f8b\u5316\u4e00\u4e2a\u5217\u8868\uff0c\u4ece\u800c\u4e27\u5931\u8fed\u4ee3\u7684\u4f18\u52bf\u3002</p> <p>Generator expressions are more compact but less versatile than full generator definitions and tend to be more memory friendly than equivalent list comprehensions.</p> <p>\u53e6\u4e00\u4e2a\u597d\u5904\u662f\uff0c\u76f4\u63a5\u5728\u4e00\u5bf9\u65e2\u6709\u7684\u5706\u62ec\u53f7\u5185\uff08\u5982\u5728\u51fd\u6570\u8c03\u7528\u4e2d\uff09\u4f7f\u7528\u751f\u6210\u5668\u63a8\u5bfc\u65f6\uff0c\u65e0\u9700\u518d\u6dfb\u52a0\u4e00\u5bf9\u5706\u62ec\u53f7\u3002\u6362\u800c\u8a00\u4e4b\uff0c\u53ef\u7f16\u5199\u4e0b\u9762\u8fd9\u6837\u975e\u5e38\u6f02\u4eae\u7684\u4ee3\u7801\uff1a</p> <p>sum(i ** 2 for i in range(10))</p> <p>\u4ee5\u4e0b\u4f7f\u7528 sum \u7ed3\u5408\u751f\u6210\u5668\u8868\u8fbe\u5f0f\uff0c\u4fbf\u6377\u5730\u5b9e\u73b0\u5411\u91cf\u7684\u70b9\u79ef\uff08dot product\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; xvec = [10, 20, 30]\n&gt;&gt;&gt; yvec = [7, 5, 3]\n&gt;&gt;&gt; sum(x*y for x,y in zip(xvec, yvec))\n260\n</code></pre> <p>string.py \u4e2d string.capwords \u51fd\u6570\u7684\u65e9\u671f\u5b9e\u73b0\u5373\u57fa\u4e8e\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff08\u73b0\u5df2\u6539\u4e3a map \u5b9e\u73b0\uff09\uff1a</p> <pre><code># Capitalize the words in a string, e.g. \" aBc  dEf \" -&gt; \"Abc Def\".\ndef capwords(s, sep=None):\n    return (sep or ' ').join(x.capitalize() for x in s.split(sep))\n</code></pre> <p>\u4ee5\u4e0b\u6784\u5efa\u751f\u6210\u5668\uff0c\u8fc7\u6ee4\u751f\u6210 1-10 \u5185\u7684\u5076\u6570\uff0ceven \u627f\u63a5\u8fd4\u56de\u8fed\u4ee3\u5668\uff1a</p> <pre><code>&gt;&gt;&gt; even=(n for n in range(1,11) if n%2==0)\n&gt;&gt;&gt; type(even)\n&lt;class 'generator'&gt;\n</code></pre> <p>syntax - Python equivalent of c++ find_if - Stack Overflow</p> <p>\u627e\u51fa\u5e8f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u88ab 5 \u6574\u9664\u7684\u6570\uff1a</p> <pre><code>&gt;&gt;&gt; lst=[1,2,10,3,5,3,4]\n&gt;&gt;&gt; next(n for n in lst if n%5==0)\n10\n</code></pre> <p>A slight modification will give you the index rather than the value:</p> <pre><code>&gt;&gt;&gt; next(idx for idx,n in enumerate(lst) if n%5==0)\n2\n</code></pre>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u751f\u6210\u5668\u4e0e\u72b6\u6001\u673a\u5e94\u7528\u5b9e\u4f8b","title":"\u751f\u6210\u5668\u4e0e\u72b6\u6001\u673a\u5e94\u7528\u5b9e\u4f8b","text":"<p>Generator \u662f\u5b9e\u73b0\u72b6\u6001\u673a\u7684\u6700\u4f73\u7ed3\u6784\u3002\u6bd4\u5982\uff0c\u4e0b\u9762\u7684 clock \u51fd\u6570\u5c31\u662f\u4e00\u4e2a\u72b6\u6001\u673a\u3002</p> <pre><code>ticking = True\ndef clock():\n    global ticking\n    if ticking:\n        print('Tick!')\n    else:\n        print('Tock!')\n    ticking = not ticking\n\nclock()\nclock()\nclock()\nclock()\n</code></pre> <p>\u4e0a\u9762\u7684 clock \u51fd\u6570\u4e00\u5171\u6709\u4e24\u79cd\u72b6\u6001\uff08Tick \u548c Tock\uff09\uff0c\u6bcf\u8fd0\u884c\u4e00\u6b21\u5c31\u6539\u53d8\u4e00\u6b21\u72b6\u6001\uff0c\u6a21\u62df\u949f\u6446\u7684\u5600\u55d2\u3002</p> <ul> <li>\u5f53\u628a\u8fd9\u4e24\u79cd\u72b6\u6001\u7528\u4e8c\u8fdb\u5236 0,1 \u8868\u793a\u65f6\uff0c\u76f8\u5f53\u4e8e\u5e03\u5c14\u5f00\u5173\u72b6\u6001\u673a\u3002</li> </ul> <p>\u8fd9\u4e2a\u51fd\u6570\u5982\u679c\u7528 Generator \u5b9e\u73b0\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>def clock():\n    while True:\n        print('Tick!')\n        yield\n        print('Tock!')\n        yield\n\nc = clock()\nnext(c)\nnext(c)\nnext(c)\nnext(c)\n</code></pre> <p>\u5bf9\u6bd4\u4e0a\u9762\u7684 Generator \u5b9e\u73b0\u4e0e\u666e\u901a\u51fd\u6570\u5b9e\u73b0\uff0c\u53ef\u4ee5\u770b\u5230\u5c11\u4e86\u7528\u6765\u4fdd\u5b58\u72b6\u6001\u7684\u5916\u90e8\u53d8\u91cf ticking\uff0c\u8fd9\u6837\u5c31\u66f4\u7b80\u6d01\uff0c\u66f4\u5b89\u5168\uff08\u72b6\u6001\u4e0d\u4f1a\u88ab\u975e\u6cd5\u7be1\u6539\uff09\uff0c\u66f4\u7b26\u5408\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u601d\u60f3\uff0c\u5728\u5199\u6cd5\u4e0a\u4e5f\u66f4\u4f18\u96c5\u3002</p> <p>Generator \u4e4b\u6240\u4ee5\u53ef\u4ee5\u4e0d\u7528\u5916\u90e8\u53d8\u91cf\u4fdd\u5b58\u72b6\u6001\uff0c\u662f\u56e0\u4e3a\u5b83\u672c\u8eab\u5c31\u5305\u542b\u4e86\u4e00\u4e2a\u72b6\u6001\u4fe1\u606f\uff0c\u5373\u76ee\u524d\u662f\u5426\u5904\u4e8e\u6682\u505c\u6001\u3002</p> <p>\u7c7b\u4f3c\uff0c\u4ee5\u4e0b\u662f\u5f15\u5165\u4e09\u79cd\u72b6\u6001\u7684\u201c\u526a\u5200\u77f3\u5934\u5e03\u201d\u6e38\u620f\uff08Rock-Paper-Scissors\uff0cStone-Scissors-Cloth\uff09\uff0c\u5faa\u73af\u51fa\u77f3\u5934\u3001\u5e03\u3001\u526a\u5200\u3002</p> <pre><code>def draw_rps():\n    while True:\n        print('Rock')\n        yield\n        print('Paper')\n        yield\n        print('Scissors')\n        yield\n\ndr = draw_rps()\nnext(dr)\nnext(dr)\nnext(dr)\nnext(dr)\nnext(dr)\nnext(dr)\n</code></pre>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u5468\u671f\u5e8f\u5217\u751f\u6210\u5668","title":"\u5468\u671f\u5e8f\u5217\u751f\u6210\u5668","text":"<p>\u5728 repeater \u7684\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u7a0d\u4f5c\u4fee\u6539\uff0c\u8ba9\u5176\u4ea7\u751f\u589e\u957f\u5e8f\u5217\uff0c\u5176\u4e2d i \u4e3a\u521d\u59cb\u503c\uff0cstep \u4e3a\u6b65\u957f\u3002</p> <pre><code>def generator6(i=0\uff0c step=1):\n    while True:\n        reset = yield i\n        if reset is not None: # isinstance(reset, int)\n            i = reset\n        i += step\n</code></pre> <p>\u521d\u59cb\u5316\u72b6\u6001\u673a\u540e\uff0c\u5f53\u5916\u90e8\u4e0d\u5e72\u6d89\u72b6\u6001\u673a\u65f6\uff0c\u5176\u751f\u6210\u65e0\u9650\u7b49\u6b65\u957f\u589e\u957f\u5e8f\u5217\u3002</p> <p>\u4f8b\u5982 odds \u751f\u6210\u5947\u6570\u5e8f\u5217 1,3,5,7,9,...\uff1b\u628a\u8d77\u59cb\u503c\u6539\u4e3a 2\uff0c\u5219\u751f\u6210\u5076\u6570\u5e8f\u5217\u3002</p> <pre><code>def odds():\n    g6 = generator6(i=1, step=2)\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n\nodds()\n</code></pre> <p>count \u5f15\u5165\u4e86\u5916\u90e8\u5e72\u6270\uff0c\u9047\u5230 10 \u5373\u590d\u4f4d\u4e3a 0\uff0c\u4ece\u800c\u751f\u6210\u5341\u8fdb\u5236\u6570\u5e8f\u5217\uff080-9\uff09\uff1a</p> <pre><code>def count():\n    g6 = generator6()\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n    print(next(g6))\n    print(next(g6)) # 9\n    print(g6.send(-1)) # \u9022\u5341\u8fdb\u4e00\u590d\u4f4d\u4e3a 0\n\ncount()\n</code></pre> <p>binary \u5f15\u5165\u4e86\u5916\u90e8\u5e72\u6270\uff0c\u6bcf\u751f\u6210\u4e24\u4e2a\u6570 0,1 \u5373\u590d\u4f4d\uff0c\u4ece\u800c\u751f\u6210\u4e8c\u8fdb\u5236\u6570\u5e8f\u5217\uff1a</p> <ul> <li>\u7c7b\u4f3c\u4e0a\u9762\u7684 Tick-Tock \u548c\u65e5\u5e38\u751f\u6d3b\u4e2d\u7684\u5e03\u5c14\u5f00\u5173\u72b6\u6001\u3002</li> </ul> <pre><code>def binary():\n    g6 = generator6()\n    print(next(g6))\n    print(next(g6))\n    print(g6.send(-1))\n    print(next(g6))\n    print(g6.send(-1))\n    print(next(g6))\n\nbinary()\n</code></pre> <ol> <li>g6=generator6()\uff1a\u8fd4\u56de\u751f\u6210\u5668\u8fed\u4ee3\u5668\uff0c\u5c1a\u672a\u89e6\u53d1\u6267\u884c</li> <li>next(g6): \u89e6\u53d1\u6267\u884c\u751f\u6210\u5668\u51fd\u6570\uff0c\u8fd0\u884c\u81f3 yield\uff0c\u8fd4\u56de 0 \u540e\u51bb\u7ed3</li> <li>next(g6): yield \u8fd4\u56de None\uff0ci \u81ea\u589e\u4e3a1\uff0c\u7ee7\u7eed\u5faa\u73af\u81f3 yield\uff0c\u8fd4\u56de 1 \u540e\u51bb\u7ed3</li> <li>g6.send(-1): yield \u8fd4\u56de -1\uff0ci \u590d\u4f4d\u4e3a -1 \u5e76\u81ea\u589e\u4e3a 0\uff0c\u7ee7\u7eed\u5faa\u73af\u81f3 yield\uff0c\u8fd4\u56de 0 \u540e\u51bb\u7ed3</li> <li>next(g6): yield \u8fd4\u56de None\uff0ci \u81ea\u589e\u4e3a1\uff0c\u7ee7\u7eed\u5faa\u73af\u81f3 yield\uff0c\u8fd4\u56de 1 \u540e\u51bb\u7ed3</li> <li>\u91cd\u590d 4-5\uff0c\u4e0d\u65ad\u751f\u6210\u4e8c\u8fdb\u5236\u5e8f\u5217\u3002</li> </ol> <p>\u521d\u59cb\u5316\u548c\u6ce8\u5165\u70b9\u7a0d\u4f5c\u4fee\u6539\uff0c\u5373\u53ef\u6539\u4e3a\u751f\u6210\u519b\u8bad\u53e3\u4ee4\u201c\u4e00\u4e8c\u4e00\u201d\u5e8f\u5217\u3002</p> <ul> <li>\u8fd9\u4e2a\u975e\u5178\u578b\u793a\u4f8b\u4e2d send \u4fee\u6539\u90fd\u8d85\u8fc7\u4e86 next \u8bfb\u53d6\u5185\u90e8\u72b6\u6001\uff0c\u4e00\u822c\u72b6\u6001\u673a\u4e5f\u4e0d\u8fd9\u4e48\u8bbe\u8ba1\u3002</li> </ul> <pre><code>def command():\n    g6 = generator6(1)\n    print(next(g6))\n    print(next(g6))\n    print(g6.send(0))\n\n    print(g6.send(0))\n    print(next(g6))\n    print(g6.send(0))\n\n    print(g6.send(0))\n    print(next(g6))\n    print(g6.send(0))\n\ncommand()\n</code></pre> <p>count \u793a\u4f8b\u5341\u8fdb\u5236\u7ec4\u6210\u6570\uff0c\u5b9e\u9645\u4e0a\u662f\u4e2a\u5468\u671f\u5faa\u73af\u3002 \u65e5\u5e38\u751f\u6d3b\u4e2d\uff0c\u6700\u5178\u578b\u7684\u201c\u5468\u671f\u201d\u662f week\uff0c\u4e03\u5929\u5faa\u73af\u4e00\u5468\u3002 weekdays \u5219\u6f14\u793a\u4e86\u4e00\u5468\u4ece\u5468\u4e00\u5230\u5468\u65e5\uff0c\u8fc7\u5b8c\u4e00\u5468\u540e\u590d\u4f4d\u4e3a\u5468\u4e00\uff0c\u5468\u800c\u590d\u59cb\u3002</p> <pre><code>def weekdays():\n    g5 = generator6(1)\n    print(next(g5)) # Monday\n    print(next(g5)) # Tuesday\n    print(next(g5)) # Wednesday\n    print(next(g5)) # Thursday\n    print(next(g5)) # Friday\n    print(next(g5)) # Saturday\n    print(next(g5)) # Sunday\n    print(g5.send(0)) # reset to Monday\n    print(next(g5))\n    print(next(g5))\n    print(next(g5))\n    print(next(g5))\n    print(next(g5))\n    print(next(g5))\n    print(g5.send(0)) # reset to Monday\n\nweekdays()\n</code></pre>","tags":["generator"]},{"location":"blog/20191206/13-generator/#\u6590\u6ce2\u90a3\u5951\u6570\u5217","title":"\u6590\u6ce2\u90a3\u5951\u6570\u5217","text":"<p>\u5047\u5982\u53ea\u60f3\u627e\u51fa\u7b2c\u4e00\u4e2a\u5927\u4e8e1000\u7684\u6590\u6ce2\u90a3\u5951\u6570\uff0c\u800c\u4e0d\u5173\u6ce8\u524d\u5411\u5e8f\u5217\uff0c\u5982\u679c\u7528\u5217\u8868\u5b9e\u73b0\uff0c\u975e\u5e38\u8017\u8d39\u5185\u5b58\u3002 \u5728\u8fed\u4ee3\u5668\u4e13\u9898\u4e2d\uff0c\u6211\u4eec\u6f14\u793a\u4e86\u57fa\u4e8e\u8fed\u4ee3\u5668\u5b9e\u73b0\u4e86\u6590\u6ce2\u90a3\u5951\u6570\u5217\u3002</p> <pre><code>class Fibs:\n    def __init__(self):\n        self.a = 0\n        self.b = 1\n\n    def __next__(self):\n        self.a, self.b = self.b, self.a + self.b\n        return self.a\n\n    def __iter__ (self):\n        return self\n\nfibs = Fibs()\nfor fib in fibs:\n    if fib &gt; 1000:\n        print(fib)\n        break\n</code></pre> <p>\u8fd9\u4e00\u8282\uff0c\u6211\u4eec\u57fa\u4e8e\u751f\u6210\u5668\uff08\u8fed\u4ee3\u5668\uff09\u6765\u66f4\u7b80\u6d01\u5730\u7b49\u6548\u5b9e\u73b0\u3002</p> <pre><code>def fibonacci():\n    a,b = 0,1\n    while True:\n        a,b = b,a+b\n        yield b\n\nfor fib in fibonacci():\n    if fib &gt; 1000:\n        print(fib)\n        break\n</code></pre>","tags":["generator"]},{"location":"blog/20191206/14-re/","title":"python\u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5904\u7406\u7c7b\u2014\u2014re","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 python \u4e2d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5904\u7406\u7c7b\u2014\u2014re\uff0c\u4ecb\u7ecd\u4e86\u5176\u57fa\u7840\u60ef\u7528\u6cd5\u3002</p>","tags":["re"]},{"location":"blog/20191206/14-re/#re","title":"re","text":"<p>re</p>","tags":["re"]},{"location":"blog/20191206/14-re/#help","title":"help","text":"<pre><code>&gt;&gt;&gt; import re\n&gt;&gt;&gt; help(re)\n\nHelp on module re:\n\nNAME\n    re - Support for regular expressions (RE).\n\nDESCRIPTION\n    This module provides regular expression matching operations similar to\n    those found in Perl.  It supports both 8-bit and Unicode strings; both\n    the pattern and the strings being processed can contain null bytes and\n    characters outside the US ASCII range.\n\n    Regular expressions can contain both special and ordinary characters.\n    Most ordinary characters, like \"A\", \"a\", or \"0\", are the simplest\n    regular expressions; they simply match themselves.  You can\n    concatenate ordinary characters, so last matches the string 'last'.\n</code></pre>","tags":["re"]},{"location":"blog/20191206/14-re/#howto","title":"howto","text":"<p>regex-howto</p> <p>The sequence</p> <pre><code>prog = re.compile(pattern)\nresult = prog.match(string)\n</code></pre> <p>is equivalent to</p> <pre><code>result = re.match(pattern, string)\n</code></pre>","tags":["re"]},{"location":"blog/20191206/14-re/#flags","title":"flags","text":"<ul> <li><code>re.I</code>(re.IGNORECASE): Perform case-insensitive matching;  </li> <li><code>re.M</code>(re.MULTILINE): When specified, the pattern character '^' matches at the beginning of the string and at the beginning of each line (immediately following each newline); and the pattern character '$' matches at the end of the string and at the end of each line (immediately preceding each newline).</li> <li><code>re.S</code>(re.DOTALL): Make the '.' special character match any character at all, including a newline; without this flag, '.' will match anything except a newline. Corresponds to the inline flag (<code>?s</code>).  </li> </ul> <p><code>re.I</code> \u548c <code>re.M</code> \u5206\u522b\u5bf9\u5e94 javascript RegExp \u4e2d\u7684 <code>/i</code> \u548c <code>/m</code> \u6807\u5fd7\u3002</p> <p>\u6b63\u5219\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5305\u542b\u4e00\u4e9b\u53ef\u9009\u6807\u5fd7\u4fee\u9970\u7b26\u6765\u63a7\u5236\u5339\u914d\u7684\u6a21\u5f0f\u3002 \u4fee\u9970\u7b26\u88ab\u6307\u5b9a\u4e3a\u4e00\u4e2a\u53ef\u9009\u7684\u6807\u5fd7\u3002\u591a\u4e2a\u6807\u5fd7\u53ef\u4ee5\u901a\u8fc7\u6309\u4f4d OR(<code>|</code>) \u6765\u6307\u5b9a\u3002 \u5982 <code>re.I | re.M</code> \u88ab\u8bbe\u7f6e\u6210 I \u548c M \u6807\u5fd7\u3002</p>","tags":["re"]},{"location":"blog/20191206/14-re/#apis","title":"APIs","text":"","tags":["re"]},{"location":"blog/20191206/14-re/#search","title":"search","text":"<pre><code>re.search(pattern, string, flags=0)\n</code></pre> <p>re.search \u626b\u63cf\u6574\u4e2a\u5b57\u7b26\u4e32\u5e76\u8fd4\u56de \u7b2c\u4e00\u4e2a \u6210\u529f\u7684\u5339\u914d\u3002</p> <p>\u5339\u914d\u6210\u529f\u5c06\u8fd4\u56de\u4e00\u4e2a\u5339\u914d\u7684\u5bf9\u8c61 match object\uff0c\u5426\u5219\u8fd4\u56de None\u3002 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 group(num) \u6216 groups() \u5339\u914d\u5bf9\u8c61\u51fd\u6570\u6765\u83b7\u53d6\u5339\u914d\u8868\u8fbe\u5f0f\u3002</p>","tags":["re"]},{"location":"blog/20191206/14-re/#match","title":"match","text":"<pre><code>re.match(pattern, string, flags=0)\nre.fullmatch(pattern, string, flags=0)\n</code></pre> <ul> <li>re.match \u5c1d\u8bd5\u4ece\u5b57\u7b26\u4e32\u7684\u8d77\u59cb\u4f4d\u7f6e\u5339\u914d\u4e00\u4e2a\u6a21\u5f0f\uff0c\u5982\u679c\u4e0d\u662f\u8d77\u59cb\u4f4d\u7f6e\u5339\u914d\u6210\u529f\u7684\u8bdd\u5c31\u8fd4\u56de None\u3002  </li> <li>re.fullmatch \u5339\u914d\u6574\u4e2a\u5b57\u7b26\u4e32\u3002  </li> </ul> <p>re.match \u53ea\u5339\u914d\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\uff0c\u5982\u679c\u5b57\u7b26\u4e32\u5f00\u59cb\u4e0d\u7b26\u5408\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u5219\u5339\u914d\u5931\u8d25\uff0c\u51fd\u6570\u8fd4\u56deNone\uff1b \u800c re.search \u5219\u5339\u914d\u6574\u4e2a\u5b57\u7b26\u4e32\uff0c\u76f4\u5230\u627e\u5230\u4e00\u4e2a\u5339\u914d\u3002  </p>","tags":["re"]},{"location":"blog/20191206/14-re/#split","title":"split","text":"<pre><code>re.split(pattern, string, maxsplit=0, flags=0)\n</code></pre> <p>split \u65b9\u6cd5\u6309\u7167\u80fd\u591f\u5339\u914d\u7684\u5b50\u4e32\u5c06\u5b57\u7b26\u4e32\u5206\u5272\u540e\u8fd4\u56de\u5217\u8868\u3002</p>","tags":["re"]},{"location":"blog/20191206/14-re/#findall","title":"findall","text":"<pre><code>re.findall(pattern, string, flags=0)\n</code></pre> <p>\u5728\u5b57\u7b26\u4e32\u4e2d\u627e\u5230\u6b63\u5219\u8868\u8fbe\u5f0f\u6240\u5339\u914d\u7684\u6240\u6709\u5b50\u4e32\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5217\u8868\uff0c\u5982\u679c\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\uff0c\u5219\u8fd4\u56de\u7a7a\u5217\u8868\u3002</p> <p>\u6ce8\u610f\uff1a match \u548c search \u662f\u5339\u914d \u4e00\u6b21\uff0cfindall \u5219\u662f\u5339\u914d \u6240\u6709\u3002</p>","tags":["re"]},{"location":"blog/20191206/14-re/#sub","title":"sub","text":"<pre><code>re.sub(pattern, repl, string, count=0, flags=0)\nre.subn(pattern, repl, string, count=0, flags=0)\n</code></pre>","tags":["re"]},{"location":"blog/20191206/14-re/#log_line_extractor","title":"log_line_extractor","text":"<p>\u4f20\u5165\u65e5\u5fd7\u7b2c\u4e00\u884c\uff0c\u6b63\u5219\u5339\u914d\u731c\u6d4b\u51fa\u5e73\u53f0\u7c7b\u578b\u3002</p> <pre><code>log_line_ios = '2019-09-29 14:46:49.301 Debug|1031|23627|:96|IMPDT_MBR_Engine||start: role = 1'\nlog_line_android = '19-09-22 15:09:09|1569136148648[4600]4794|W|VasQuickUpdateEngine_Native|[2019-09-22 15:09:08][1569136148648][debug   ][unnamed thread:4794][MBR_Engine:96]: start: role = 1'\nlog_line_windows = r'''\"36098\",\"2\",\"2019/09/29 17:12:44:884\",\"183323671\",\"XP.MSGBAK.MBR_Engine\",\"start: role = 1\",\"10400\",\"18892\",\"95\"'''\n</code></pre> <p>\u6682\u4e0d\u8003\u8651\u65e5\u671f\u53ca\u65f6\u95f4\u7684\u5408\u6cd5\u6027\uff0c\u4ece\u884c\u9996\u5339\u914d\u5404\u4e2a\u5e73\u53f0\u7684\u65e5\u5fd7\u683c\u5f0f\u3002</p>","tags":["re"]},{"location":"blog/20191206/14-re/#test_cases","title":"test cases","text":"<pre><code>log_line_i_m = 'test 2019-09-29 14:46:49.301 mid'\nlog_line_i_e = 'test end 2019-09-29 14:46:49.301'\nlog_line_i = '2019-09-29 14:46:49.301 Debug|1031|23627|:96|IMPDT_MBR_Engine||start: role = 1'\n\nlog_line_a_m = 'test 19-09-22 15:09:09| mid'\nlog_line_a_e = 'test end 19-09-22 15:09:09|'\nlog_line_a = '19-09-22 15:09:09|1569136148648[4600]4794|W|VasQuickUpdateEngine_Native|[2019-09-22 15:09:08][1569136148648][debug   ][unnamed thread:4794][MBR_Engine:96]: start: role = 1'\n\nlog_line_w_m = r'''test ,\"2019/09/29 17:12:44:884\", mid'''\nlog_line_w_e = r'''test end ,\"2019/09/29 17:12:44:884\",'''\nlog_line_w = r'''\"36098\",\"2\",\"2019/09/29 17:12:44:884\",\"183323671\",\"XP.MSGBAK.MBR_Engine\",\"start: role = 1\",\"10400\",\"18892\",\"95\"'''\n</code></pre>","tags":["re"]},{"location":"blog/20191206/14-re/#regexp","title":"RegExp","text":"<p>\u4ee5\u4e0b\u4e3a javascript \u5bf9\u5e94\u7684 literal expression\uff0c\u53ef\u5728 vscode \u4e2d\u5229\u7528 Regex Previewer \u63d2\u4ef6\u8fdb\u884c Test Regex\uff1a</p> <pre><code>let irem = /(?:^)\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d{3} /m\nlet iren = /(?:^|\\n)\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d{3} /\nlet arem = /(?:^)\\d{2}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\|/m\nlet aren = /(?:^|\\n)\\d{2}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\|/\nlet wre = /,\"\\d{4}\\/\\d{2}\\/\\d{2} \\d{2}:\\d{2}:\\d{2}\\:\\d{3}\",/ // \u53ef\u5339\u914d\u4e2d\u90e8\nlet wrem = /(?:^)\"\\d+\",\"\\d\",\"\\d{4}\\/\\d{2}\\/\\d{2} \\d{2}:\\d{2}:\\d{2}\\:\\d{3}\",/m\n</code></pre>","tags":["re"]},{"location":"blog/20191206/14-re/#re_1","title":"re","text":"<p>\u4ece\u884c\u9996 match \u5339\u914d\u5404\u4e2a\u5e73\u53f0\u7684\u65e5\u5fd7\u683c\u5f0f\u3002</p> <p>\u7531\u4e8e re \u4e2d\u7684 match \u672c\u8eab\u5c31\u662f\u4ece\u884c\u9996\u5f00\u59cb\u5339\u914d\uff0c\u6545\u65e0\u9700\u6307\u5b9a <code>re.M</code> \u5339\u914d\u884c\u5934 <code>(?:^)</code>\u3002</p> <pre><code>#moi = re.match(r'(?:^)\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d{3} ', log_line_i, re.M)\n#roi = re.compile(r'(?:^|\\n)\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d{3} ')\nroi = re.compile(r'\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d{3} ')\nmoi = roi.match(log_line_i)     # not None, non-group, moi.group(0)\nmoi_m = roi.match(log_line_i_m) # None\nmoi_e = roi.match(log_line_i_e) # None\n\nroa = re.compile(r'\\d{2}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\|')\nmoa = roa.match(log_line_a)     # not None, non-group, moi.group(0)\nmoa_m = roa.match(log_line_a_m) # None\nmoa_e = roa.match(log_line_a_e) # None\n\nrow = re.compile(r'\"\\d+\",\"\\d\",\"\\d{4}\\/\\d{2}\\/\\d{2} \\d{2}:\\d{2}:\\d{2}\\:\\d{3}\",')\nmow = row.match(log_line_w)     # not None, non-group, moi.group(0)\nmow_m = row.match(log_line_w_m) # None\nmow_e = row.match(log_line_w_e) # None\n</code></pre> <p>\u63d0\u53d6\u4e3a <code>try_to_guess_platform</code> \u51fd\u6570\uff1a</p> <pre><code>import enum\nimport re\n\n\nclass PLATFORM(enum.Enum):\n    ios = 0\n    android = 1\n    windows = 2\n\n\ndef try_to_guess_platform(log_line: str) -&gt; int:\n    roi = re.compile(r'\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d{3} ')\n    roa = re.compile(r'\\d{2}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\|')\n    row = re.compile(r'\"\\d+\",\"\\d\",\"\\d{4}\\/\\d{2}\\/\\d{2} \\d{2}:\\d{2}:\\d{2}\\:\\d{3}\",')\n    if (roi.match(log_line)):\n        return PLATFORM.ios.value\n    if (roa.match(log_line)):\n        return PLATFORM.android.value\n    if (row.match(log_line)):\n        return PLATFORM.windows.value\n    return -1\n</code></pre> <p>\u4ee5\u4e0b\u4e3a\u6d4b\u8bd5\u4ee3\u7801\uff1a</p> <pre><code>try_to_guess_platform(log_line_i)   # 0: ios\ntry_to_guess_platform(log_line_i_m) # -1\ntry_to_guess_platform(log_line_i_e) # -1\n\ntry_to_guess_platform(log_line_a)   # 1: android\ntry_to_guess_platform(log_line_a_m) # -1\ntry_to_guess_platform(log_line_a_e) # -1\n\ntry_to_guess_platform(log_line_w)   # 2: windows\ntry_to_guess_platform(log_line_w_m) # -1\ntry_to_guess_platform(log_line_w_e) # -1\n</code></pre>","tags":["re"]},{"location":"blog/20191206/14-re/#refs","title":"refs","text":"<p>\u7528python\u6b63\u5219\u8868\u8fbe\u5f0f\u63d0\u53d6\u5b57\u7b26\u4e32 \u901a\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u4e0epython\u4e2d\u7684\u6b63\u5219\u5339\u914d </p>","tags":["re"]},{"location":"blog/20191206/2-pprint/","title":"python\u5e38\u7528\u6a21\u5757\u4e4bprint\u52a0\u5f3a\u7248\u2014\u2014pprint","text":"<p>\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86 python \u4e2d print \u52a0\u5f3a\u7248 pprint \u7684\u7528\u6cd5\u3002</p> <p>pprint \u2014 Data pretty printer pprint --- \u6570\u636e\u7f8e\u5316\u8f93\u51fa </p> <p>\u4ece help(pprint) \u4e2d\u7684\u51fd\u6570\u539f\u578b\u6765\u770b\uff1a</p> <ol> <li><code>pprint</code> \u5f53\u4fe1\u606f\u8d85\u8fc780\u4e2a\u5b57\u7b26\u65f6\u5c06\u5206\u884c\u663e\u793a\uff0c\u8fd8\u53ef\u901a\u8fc7 ident \u8bbe\u7f6e\u5206\u884c\u7f29\u8fdb\u3002</li> <li>\u5982\u679c\u4e0d\u9700\u8981\u6307\u5b9a stream\u3001indent\u3001width\u3001depth\u3001compact \u7b49\u63a7\u5236\u4fe1\u606f\uff0c\u53ef\u91c7\u7528\u7b80\u6613\u63a5\u53e3 <code>pp</code> \u5373\u53ef\u3002</li> </ol> <pre><code>&gt;&gt;&gt; help(pprint)\n\nFUNCTIONS\n\n    pp(object, *args, sort_dicts=False, **kwargs)\n        Pretty-print a Python object\n\n    pprint(object, stream=None, indent=1, width=80, depth=None, *, compact=False, sort_dicts=True)\n        Pretty-print a Python object to a stream [default is sys.stdout].\n</code></pre> <ul> <li>Python - Pretty Print Numbers</li> <li>\u6253\u5370 Python \u7684\u4e00\u5207 \u2014\u2014 pprint &amp; beeprint</li> </ul>","tags":["version"]},{"location":"blog/20191206/2-pprint/#list","title":"list","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u901a\u8fc7\u7b80\u5355\u5217\u8868\u63a8\u5bfc\uff0c\u8c03\u7528 pprint.pp \u6253\u5370\u5185\u5efa\u6a21\u5757 builtins \u4e2d\u7684\u7b26\u53f7\u5217\u8868\u3002</p> <pre><code>&gt;&gt;&gt; import builtins, pprint\n&gt;&gt;&gt; builtin_sym=[n for n in dir(builtins) if not n.startswith('_')]\n&gt;&gt;&gt; pprint.pp(builtin_sym)\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u901a\u8fc7\u7b80\u5355\u5217\u8868\u63a8\u5bfc\uff0c\u8fc7\u6ee4\u5217\u8868list\u516c\u7528\u63a5\u53e3\uff0c\u5e76\u5206\u522b\u7528 print\u3001pprint \u6253\u5370\u7b26\u53f7\u5217\u8868\u3002</p> <pre><code>import pprint\n\n\nlist_all = [n for n in dir(list) if not n.startswith('_')]\nprint(list_all)\npprint.pp(list_all)\n</code></pre> <p>print \u5728\u4e00\u884c\u6253\u5370\u6574\u4e2a\u5217\u8868\uff0c\u800c pprint \u5219\u5728\u6bcf\u4e00\u884c\u8f93\u51fa\u4e00\u4e2a\u5217\u8868\u9879\uff1a</p> <pre><code>['append', 'clear', 'copy', 'count', 'extend', 'index', 'insert', 'pop', 'remove', 'reverse', 'sort']\n\n['append',\n 'clear',\n 'copy',\n 'count',\n 'extend',\n 'index',\n 'insert',\n 'pop',\n 'remove',\n 'reverse',\n 'sort']\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u5206\u522b\u7528 print\u3001pprint \u6253\u5370 string \u6a21\u5757\u5411\u5916\u5bfc\u51fa\u7684\u7b26\u53f7\u5217\u8868\uff1a</p> <pre><code>import pprint\nimport string\n\n\nprint(string.__all__)\npprint.pprint(string.__all__, indent=4)\n</code></pre> <pre><code>['ascii_letters', 'ascii_lowercase', 'ascii_uppercase', 'capwords', 'digits', 'hexdigits', 'octdigits', 'printable', 'punctuation', 'whitespace', 'Formatter', 'Template']\n\n[   'ascii_letters',\n    'ascii_lowercase',\n    'ascii_uppercase',\n    'capwords',\n    'digits',\n    'hexdigits',\n    'octdigits',\n    'printable',\n    'punctuation',\n    'whitespace',\n    'Formatter',\n    'Template']\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u5206\u522b\u7528 print\u3001pprint \u6253\u5370 sys.path\uff1a</p> <pre><code>import pprint\nimport sys\n\n\nprint(sys.path)\npprint.pp(sys.path)\n</code></pre> <p>\u5bf9\u4e8e\u957f\u5217\u8868\uff0cpprint \u66f4\u65b9\u4fbf\u5730\u9010\u884c\u67e5\u770b\u6bcf\u4e2a\u5143\u7d20\uff1a</p> <pre><code>['', '/usr/local/Cellar/python@3.10/3.10.8/Frameworks/Python.framework/Versions/3.10/lib/python310.zip', '/usr/local/Cellar/python@3.10/3.10.8/Frameworks/Python.framework/Versions/3.10/lib/python3.10', '/usr/local/Cellar/python@3.10/3.10.8/Frameworks/Python.framework/Versions/3.10/lib/python3.10/lib-dynload', '/usr/local/lib/python3.10/site-packages', '/usr/local/Cellar/pygments/2.13.0/libexec/lib/python3.10/site-packages']\n\n['',\n '/usr/local/Cellar/python@3.10/3.10.8/Frameworks/Python.framework/Versions/3.10/lib/python310.zip',\n '/usr/local/Cellar/python@3.10/3.10.8/Frameworks/Python.framework/Versions/3.10/lib/python3.10',\n '/usr/local/Cellar/python@3.10/3.10.8/Frameworks/Python.framework/Versions/3.10/lib/python3.10/lib-dynload',\n '/usr/local/lib/python3.10/site-packages',\n '/usr/local/Cellar/pygments/2.13.0/libexec/lib/python3.10/site-packages']\n</code></pre>","tags":["version"]},{"location":"blog/20191206/2-pprint/#dict","title":"dict","text":"<p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u5206\u522b\u7528 print\u3001pprint \u6253\u5370\u5b57\u5178 dict \u5bf9\u8c61\uff1a</p> <pre><code>import pprint\n\n\nd = {'foo': 1, 'bar': 2, 'foobar': 3}\nprint(d)\npprint.pprint(d)\n</code></pre> <p>pprint \u6253\u5370\u5b57\u5178\u65f6\uff0c\u4f1a\u5728\u8ba1\u7b97\u5176\u663e\u793a\u5f62\u5f0f\u524d\u4f1a\u5148\u6839\u636e\u952e\u6765\u6392\u5e8f\u3002</p> <pre><code>{'foo': 1, 'bar': 2, 'foobar': 3}\n\n{'bar': 2, 'foo': 1, 'foobar': 3}\n</code></pre> <p>\u4ee5\u4e0b\u793a\u4f8b\uff0c\u5206\u522b\u7528 print\u3001pprint \u6253\u5370Python \u5b9e\u73b0\u4fe1\u606f\u5b57\u5178\u5bf9\u8c61\uff1a</p> <pre><code>import pprint\nimport sys\n\n\nprint(sys.implementation.__dict__)\npprint.pprint(sys.implementation.__dict__)\n</code></pre> <p>\u5bf9\u4e8e\u957f\u5b57\u5178\uff0cpprint \u66f4\u65b9\u4fbf\u5730\u9010\u884c\u67e5\u770b\u6bcf\u4e2aitem\uff1a</p> <pre><code>{'name': 'cpython', 'cache_tag': 'cpython-310', 'version': sys.version_info(major=3, minor=10, micro=8, releaselevel='final', serial=0), 'hexversion': 50989296, '_multiarch': 'darwin'}\n\n{'_multiarch': 'darwin',\n 'cache_tag': 'cpython-310',\n 'hexversion': 50989296,\n 'name': 'cpython',\n 'version': sys.version_info(major=3, minor=10, micro=8, releaselevel='final', serial=0)}\n</code></pre>","tags":["version"]},{"location":"blog/20191206/3-sysos/","title":"python\u5e38\u7528\u6a21\u5757\u4e4bsys,os,platform","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 python \u4e2d\u5e38\u7528\u6a21\u5757\uff1asys,os, platform \u548c sysconfig\u3002</p>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#sys","title":"sys","text":"","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#doc","title":"doc","text":"<pre><code>&gt;&gt;&gt; import sys\n&gt;&gt;&gt; print(sys.__doc__)\nThis module provides access to some objects used or maintained by the\ninterpreter and to functions that interact strongly with the interpreter.\n\nDynamic objects:\n\nargv -- command line arguments; argv[0] is the script pathname if known\npath -- module search path; path[0] is the script directory, else ''\nmodules -- dictionary of loaded modules\n</code></pre> <ul> <li>Dynamic objects  </li> <li>Static objects  </li> <li>Functions  </li> </ul> <p>argv \u4e3a\u811a\u672c\u8fd0\u884c\u53c2\u6570\u5217\u8868(str list)\u3002 <code>argv[0]</code> \u4e3a\u811a\u672c\u540d\u79f0\uff0c\u4ece <code>argv[1]</code> \u5f00\u59cb\u4e3a\u7528\u6237\u53c2\u6570\u3002  </p>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#test","title":"test","text":"<pre><code>&gt;&gt;&gt; import sys\n\n# \u5e73\u53f0\u7c7b\u578b\u6807\u8bc6\n&gt;&gt;&gt; sys.platform\n'darwin'\n\n# \u7248\u672c\u4fe1\u606f\uff08string\u683c\u5f0f\uff09\n&gt;&gt;&gt; sys.version\n'3.6.5 (default, Apr 14 2018, 06:59:43) \\n[GCC 4.2.1 Compatible Apple LLVM 9.1.0 (clang-902.0.39.1)]'\n\n&gt;&gt;&gt; print(sys.version)\n3.6.5 (default, Apr 14 2018, 06:59:43) \n[GCC 4.2.1 Compatible Apple LLVM 9.1.0 (clang-902.0.39.1)]\n\n# \u7248\u672c\u4fe1\u606f\uff08Version information as a named tuple.\uff09\n&gt;&gt;&gt; sys.version_info\nsys.version_info(major=3, minor=6, micro=5, releaselevel='final', serial=0)\n# \u83b7\u53d6\u5b57\u7b26\u4e32\u683c\u5f0f\u63cf\u8ff0\n&gt;&gt;&gt; repr(sys.version_info)\n\"sys.version_info(major=3, minor=6, micro=5, releaselevel='final', serial=0)\"\n# \u83b7\u53d6\u6570\u636e\u6210\u5458\u5c5e\u6027(Data descriptors)\n&gt;&gt;&gt; sys.version_info.major\n3\n&gt;&gt;&gt; sys.version_info.minor\n6\n&gt;&gt;&gt; sys.version_info.micro\n5\n&gt;&gt;&gt; sys.version_info.releaselevel\n'final'\n&gt;&gt;&gt; sys.version_info.serial\n0\n\n# Python \u5b9e\u73b0\u4fe1\u606f(python3)\n## \u8fd4\u56de types.SimpleNamespace \u5bf9\u8c61\u5b9e\u4f8b\n&gt;&gt;&gt; sys.implementation\nnamespace(_multiarch='darwin', cache_tag='cpython-36', hexversion=50726384, name='cpython', version=sys.version_info(major=3, minor=6, micro=5, releaselevel='final', serial=0))\n## \u53d6\u5b57\u5178\u683c\u5f0f\n&gt;&gt;&gt; sys.implementation.__dict__\n{'name': 'cpython', 'cache_tag': 'cpython-36', 'version': sys.version_info(major=3, minor=6, micro=5, releaselevel='final', serial=0), 'hexversion': 50726384, '_multiarch': 'darwin'}\n\n# \u5b57\u8282\u5e8f\n&gt;&gt;&gt; sys.byteorder\n'little'\n\n# python2: sys.long_info\n&gt;&gt;&gt; sys.int_info\nsys.int_info(bits_per_digit=30, sizeof_digit=4)\n&gt;&gt;&gt; sys.int_info.bits_per_digit\n30\n&gt;&gt;&gt; sys.int_info.sizeof_digit\n4\n\n# \u7ebf\u7a0b\u6a21\u578b(python3)\n&gt;&gt;&gt; sys.thread_info\nsys.thread_info(name='pthread', lock='mutex+cond', version=None)\n</code></pre>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#os","title":"os","text":"","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#doc_1","title":"doc","text":"<pre><code>&gt;&gt;&gt; import os\n&gt;&gt;&gt; print(os.__doc__)\nOS routines for NT or Posix depending on what system we're on.\n\nThis exports:\n  - all functions from posix or nt, e.g. unlink, stat, etc.\n  - os.path is either posixpath or ntpath\n  - os.name is either 'posix' or 'nt'\n  - os.curdir is a string representing the current directory (always '.')\n  - os.pardir is a string representing the parent directory (always '..')\n  - os.sep is the (or a most common) pathname separator ('/' or '\\\\')\n  - os.extsep is the extension separator (always '.')\n  - os.altsep is the alternate pathname separator (None or '/')\n  - os.pathsep is the component separator used in $PATH etc\n  - os.linesep is the line separator in text files ('\\r' or '\\n' or '\\r\\n')\n  - os.defpath is the default search path for executables\n  - os.devnull is the file path of the null device ('/dev/null', etc.)\n\nPrograms that import and use 'os' stand a better chance of being\nportable between different platforms.  Of course, they must then\nonly use functions that are defined by all platforms (e.g., unlink\nand opendir), and leave all pathname manipulation to os.path\n(e.g., split and join).\n</code></pre>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#ospath","title":"os.path","text":"<p>Source code: <code>Lib/posixpath.py</code> (for POSIX), <code>Lib/ntpath.py</code> (for Windows NT), and <code>Lib/macpath.py</code> (for Macintosh)</p> <p>macOS Python REPL \u4e2d\u8f93\u5165 <code>help(os.path)</code> \u663e\u793a  posixpath\uff1a</p> <pre><code>Help on module posixpath:\n\nNAME\n    posixpath - Common operations on Posix pathnames.\n</code></pre> <p>os.path Examples </p> <p>python\u6587\u4ef6\u548c\u76ee\u5f55\u64cd\u4f5c\u65b9\u6cd5\u5927\u5168\uff08\u542b\u5b9e\u4f8b\uff09 </p>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#property","title":"property","text":"<p>\u5224\u65ad\u7ed9\u5b9a\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u76ee\u5f55\u6216\u6587\u4ef6\uff1a</p> <pre><code>os.path.isdir(path)\n    Return True if path is an existing directory. \n    This follows symbolic links, so both islink() and isdir() can be true for the same path.\nos.path.isfile(path)\n    Return True if path is an existing regular file. \n    This follows symbolic links, so both islink() and isfile() can be true for the same path.\n</code></pre> <p>\u5224\u65ad\u7ed9\u5b9a\u5b57\u7b26\u4e32\uff08\u76ee\u5f55\u6216\u6587\u4ef6\uff09\u662f\u5426\u5b58\u5728\uff1a</p> <pre><code>os.path.exists(path)\n    Return True if path refers to an existing path or an open file descriptor. Returns False for broken symbolic links. On some platforms, this function may return False if permission is not granted to execute os.stat() on the requested file, even if the path physically exists.\n</code></pre> <p>\u83b7\u53d6\u6307\u5b9a\u8def\u5f84\u4e0b\u6587\u4ef6\uff08\u76ee\u5f55\uff1f\uff09\u7684\u6587\u4ef6\u5927\u5c0f\uff1a</p> <pre><code>os.path.getsize(path)\n    Return the size, in bytes, of path. Raise OSError if the file does not exist or is inaccessible.\n</code></pre>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#split","title":"split","text":"<pre><code>os.path.split(path)\n    Split the pathname path into a pair, (head, tail) where tail is the last pathname component and head is everything leading up to that. \n    The tail part will never contain a slash; if path ends in a slash, tail will be empty.\nos.path.splitdrive(path)\n    Split the pathname path into a pair (drive, tail) where drive is either a mount point or the empty string. \n    On systems which do not use drive specifications, drive will always be the empty string. In all cases, drive + tail will be the same as path.\nos.path.splitext(path)\n    Split the pathname path into a pair (root, ext) such that root + ext == path, and ext is empty or begins with a period and contains at most one period. Leading periods on the basename are ignored; splitext('.cshrc') returns ('.cshrc', '').\n</code></pre> <p>How to split a dos path into its components in Python Splitting a Path into All of Its Parts Python | os.path.splitext() method </p>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#join","title":"join","text":"<p>\u5c06\u591a\u4e2a\u90e8\u5206\u4ee5 <code>os.sep</code> \u62fc\u63a5\u76f8\u8fde\u3002</p> <pre><code>os.path.join(path, *paths)\n    Join one or more path components intelligently. The return value is the concatenation of path and any members of *paths with exactly one directory separator (os.sep) following each non-empty part except the last, meaning that the result will only end in a separator if the last part is empty. If a component is an absolute path, all previous components are thrown away and joining continues from the absolute path component.\n</code></pre> <p>Build the full path filename in Python Python os.path.join() on a list Python os.path.join on Windows </p>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#test_1","title":"test","text":"<pre><code>&gt;&gt;&gt; import os\n\n&gt;&gt;&gt; os.path\n&lt;module 'posixpath' from '/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/posixpath.py'&gt;\n\n&gt;&gt;&gt; os.name\n'posix'\n\n&gt;&gt;&gt; os.uname()\nposix.uname_result(sysname='Darwin', nodename='MBP-FAN', release='17.6.0', version='Darwin Kernel Version 17.6.0: Fri Apr 13 19:57:44 PDT 2018; root:xnu-4570.60.17.0.1~3/RELEASE_X86_64', machine='x86_64')\n\n# \u8def\u5f84\u5206\u9694\u7b26\uff08pathname separator\uff09\n&gt;&gt;&gt; os.sep\n'/'\n\n# \u6587\u4ef6\u540e\u7f00\u5206\u9694\u7b26\uff08extension separator\uff09\n&gt;&gt;&gt; os.extsep\n'.'\n\n# \u73af\u5883\u53d8\u91cf PATH \u5206\u9694\u7b26\uff08component separator used in $PATH\uff09\n&gt;&gt;&gt; os.pathsep\n':'\n\n# \u6362\u884c\u7b26\uff08line separator\uff09\uff0cnt \u4e0b\u4e3a '\\r\\n'\n&gt;&gt;&gt; os.linesep\n'\\n'\n</code></pre>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#platform","title":"platform","text":"","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#doc_2","title":"doc","text":"<pre><code>&gt;&gt;&gt; import platform\n&gt;&gt;&gt; print(platform.__doc__)\n This module tries to retrieve as much platform-identifying data as\n    possible. It makes this information available via function APIs.\n\n    If called from the command line, it prints the platform\n    information concatenated as single string to stdout. The output\n    format is useable as part of a filename.\n</code></pre>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#test_2","title":"test","text":"<pre><code>&gt;&gt;&gt; import platform\n\n&gt;&gt;&gt; platform.platform()\n'Darwin-17.6.0-x86_64-i386-64bit'\n\n&gt;&gt;&gt; platform.version()\n'Darwin Kernel Version 17.6.0: Fri Apr 13 19:57:44 PDT 2018; root:xnu-4570.60.17.0.1~3/RELEASE_X86_64'\n\n&gt;&gt;&gt; platform.uname()\nuname_result(system='Darwin', node='MBP-FAN', release='17.6.0', version='Darwin Kernel Version 17.6.0: Fri Apr 13 19:57:44 PDT 2018; root:xnu-4570.60.17.0.1~3/RELEASE_X86_64', machine='x86_64', processor='i386')\n\n# \u4f53\u7cfb\u67b6\u6784\n&gt;&gt;&gt; platform.machine()\n'x86_64'\n\n# \u5904\u7406\u5668\n&gt;&gt;&gt; platform.processor()\n'i386'\n\n# \u7cfb\u7edf\n&gt;&gt;&gt; platform.system()\n'Darwin'\n\n&gt;&gt;&gt; platform.python_implementation()\n'CPython'\n\n&gt;&gt;&gt; platform.python_version()\n'3.6.5'\n\n&gt;&gt;&gt; platform.python_version_tuple()\n('3', '6', '5')\n</code></pre>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#sysconfig","title":"sysconfig","text":"","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#doc_3","title":"doc","text":"<pre><code>&gt;&gt;&gt; import sysconfig\n&gt;&gt;&gt; print(sysconfig.__doc__)\nAccess to Python's configuration information.\n</code></pre>","tags":["sys","os","platform"]},{"location":"blog/20191206/3-sysos/#test_3","title":"test","text":"<pre><code>&gt;&gt;&gt; import sysconfig\n\n&gt;&gt;&gt; sysconfig.get_platform()\n'macosx-10.13-x86_64'\n\n&gt;&gt;&gt; sysconfig.get_python_version()\n'3.6'\n</code></pre>","tags":["sys","os","platform"]},{"location":"blog/20191206/4-version/","title":"python\u68c0\u6d4b\u5b89\u88c5\u7684\u7248\u672c","text":"<p>\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86\u5982\u4f55\u68c0\u6d4b\u672c\u673a\u5b89\u88c5\u7684 python \u7248\u672c\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u7684python\u9879\u76ee\u57fa\u4e8e\u67d0\u4e00\u7248\u672c\u53d1\u884c\uff0c\u82e5\u5ba2\u6237python\u8fd0\u884c\u65f6\u4f4e\u4e8e\u6b64\u7248\u672c\uff0c\u5219\u67d0\u4e9b\u529f\u80fd\u7279\u6027\u53ef\u80fd\u4e0d\u652f\u6301\u3002 \u6b64\u65f6\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u68c0\u6d4b\u5ba2\u6237\u662f\u5426\u5b89\u88c5\u4e86python\uff0c\u5e76\u4e14\u7248\u672c\u662f\u5426\u6ee1\u8db3\u6700\u4f4e\u8981\u6c42\uff0c\u5426\u5219\u63d0\u793a\u7528\u6237\u5b89\u88c5\u6216\u5347\u7ea7python\u3002</p>","tags":["version"]},{"location":"blog/20191206/4-version/#sh\u68c0\u6d4b\u662f\u5426\u5b89\u88c5\u4e86python","title":"sh\u68c0\u6d4b\u662f\u5426\u5b89\u88c5\u4e86python","text":"<p>\u672a\u5b89\u88c5python\u65f6\uff0c\u6267\u884c <code>python -V</code> \u63d0\u793a\u547d\u4ee4\u627e\u4e0d\u5230\uff1a</p> <pre><code>$ python -V\nzsh: command not found: python\n$ echo $?\n127\n</code></pre> <p>\u5df2\u5b89\u88c5python\u65f6\uff0c\u6267\u884c <code>python -V</code> \u6b63\u5e38\u8fd4\u56de\u7248\u672c\uff1a</p> <pre><code>$ python -V\nPython 3.9.6\n$ echo $?\n0\n</code></pre> <p>\u4ee5\u4e0b\u5b9a\u4e49\u4e86 shell \u51fd\u6570 check_python_version \u7528\u4e8e\u68c0\u6d4b\u672c\u5730\u662f\u5426\u5b89\u88c5\u4e86 python \u8fd0\u884c\u65f6\uff1a</p> <pre><code>check_python_version()\n{\n    if python -V &amp;&gt;/dev/null; # \u4e0d\u8f93\u51fa\u6267\u884c\u7ed3\u679c\n    then\n        python_version=$(python -V) 1&gt;/dev/null # \u4e0d\u8f93\u51fa\u7248\u672c\u4fe1\u606f\n        echo \"python installed: $python_version\"\n        return 0\n    else\n        echo \"python uninstalled!\"\n        return 1\n    fi\n}\n</code></pre>","tags":["version"]},{"location":"blog/20191206/4-version/#python\u68c0\u6d4b\u5f53\u524d\u5b89\u88c5\u7248\u672c","title":"python\u68c0\u6d4b\u5f53\u524d\u5b89\u88c5\u7248\u672c","text":"<p>\u901a\u8fc7\u4e0a\u6587\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u53ef\u4ee5\u901a\u8fc7 platform, sys \u548c sysconfig \u76f8\u5173\u63a5\u53e3\u68c0\u6d4b\u5f53\u524d python \u7248\u672c\u3002</p> <ol> <li>sysconfig.get_python_version() \u8fd4\u56de\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982 '3.9'\uff1b</li> </ol> <pre><code>&gt;&gt;&gt; sysconfig.get_python_version()\n'3.9'\n</code></pre> <ol> <li>platform.python_version() \u8fd4\u56de\u5b57\u7b26\u4e32\uff0c\u6216\u8c03\u7528 platform.python_version_tuple() \u8fd4\u56de\u5b57\u7b26\u4e32\u5143\u7ec4\u3002</li> </ol> <pre><code>&gt;&gt;&gt; platform.python_version()\n'3.9.6'\n&gt;&gt;&gt; platform.python_version_tuple()\n('3', '9', '6')\n</code></pre> <ol> <li>sys.version_info \u8fd4\u56de version_info \u5bf9\u8c61\u3002</li> </ol> <pre><code>&gt;&gt;&gt; sys.version_info\nsys.version_info(major=3, minor=9, micro=6, releaselevel='final', serial=0)\n&gt;&gt;&gt; tuple(sys.version_info)\n(3, 9, 6, 'final', 0)\n</code></pre>","tags":["version"]},{"location":"blog/20191206/4-version/#python\u5bf9\u6bd4\u5b89\u88c5\u7248\u672c","title":"python\u5bf9\u6bd4\u5b89\u88c5\u7248\u672c","text":"<p>How do I compare version numbers in Python? - Stack Overflow</p> <p>\u4ee5\u4e0b\u7528\u56db\u79cd\u65b9\u5f0f\u5224\u65ad python \u7248\u672c\u662f\u5426\u5927\u4e8e 3.8/3.9.6\u3002</p> <pre><code>import platform, sys, sysconfig\n\ndef version_str2tuple(vs:str):\n    return tuple(map(int, vs.split(\".\")))\n\ndef version_tuple_str2int(vst:tuple):\n    return tuple(map(int, vst))\n\n# '3.12'\nversion_str2tuple(sysconfig.get_python_version()) &gt; (3, 8)\n\n# '3.12.2'\nversion_str2tuple(platform.python_version()) &gt; (3, 9, 6)\n\n# ('3', '12', '2')\nversion_tuple_str2int(platform.python_version_tuple()) &gt; (3, 9, 6)\n\n# (3, 12, 2, 'final', 0)\ntuple(sys.version_info) &gt; (3, 9, 6) # sys.version_info &gt; (3, 9, 6)\n</code></pre>","tags":["version"]},{"location":"blog/20191206/5-enum/","title":"python\u4e2d\u7684\u679a\u4e3e\u7c7b\u578b\u2014\u2014enum","text":"<p>\u672c\u6587\u7b80\u5355\u4ecb\u7ecd\u4e86 python \u4e2d\u679a\u4e3e\u7c7b enum \u7684\u57fa\u672c\u7528\u6cd5\u3002</p> <p>Python\u4e2d\u679a\u4e3e\u7684\u4f7f\u7528</p>","tags":["enum"]},{"location":"blog/20191206/5-enum/#help","title":"help","text":"<pre><code>&gt;&gt;&gt; import enum\n&gt;&gt;&gt; help(enum)\n\nHelp on module enum:\n\nNAME\n    enum\n\nCLASSES\n    builtins.int(builtins.object)\n        IntEnum(builtins.int, Enum)\n        IntFlag(builtins.int, Flag)\n    builtins.object\n        Enum\n            Flag\n                IntFlag(builtins.int, Flag)\n            IntEnum(builtins.int, Enum)\n        auto\n    builtins.type(builtins.object)\n        EnumMeta\n</code></pre>","tags":["enum"]},{"location":"blog/20191206/5-enum/#usage","title":"usage","text":"<pre><code>from enum import Enum\n\nclass Color (Enum):\n      red=1\n      orange=2\n      yellow=3\n      green=4\n      blue=5\n      indigo=6\n      purple=7\n</code></pre> <p>\u5982\u679c\u8981\u9650\u5236\u5b9a\u4e49\u679a\u4e3e\u65f6\uff0c\u4e0d\u80fd\u5b9a\u4e49\u76f8\u540c\u503c\u7684\u6210\u5458\u3002\u53ef\u4ee5\u4f7f\u7528\u88c5\u9970\u5668 <code>@unique</code>:</p> <pre><code>from enum import Enum, unique\n\n@unique\nclass Color(Enum):\n</code></pre>","tags":["enum"]},{"location":"blog/20191206/5-enum/#access","title":"access","text":"<p>\u901a\u8fc7\u6210\u5458\u7684\u540d\u79f0\u6765\u83b7\u53d6\u6210\u5458\uff1a</p> <pre><code>&gt;&gt;&gt; Color['red']\n&lt;Color.red: 1&gt;\n</code></pre> <p>\u901a\u8fc7\u6210\u5458\u7684\u503c\u6765\u83b7\u53d6\u6210\u5458\uff1a</p> <pre><code>&gt;&gt;&gt; Color(1)\n&lt;Color.red: 1&gt;\n</code></pre> <p>\u901a\u8fc7\u6210\u5458\uff0c\u6765\u83b7\u53d6\u5b83\u7684\u540d\u79f0\u548c\u503c\uff1a</p> <pre><code>&gt;&gt;&gt; Color.red\n&lt;Color.red: 1&gt;\n\n&gt;&gt;&gt; Color.red.name\n'red'\n&gt;&gt;&gt; Color.red.value\n1\n</code></pre>","tags":["enum"]},{"location":"blog/20191206/6-random/","title":"python\u4e2d\u751f\u6210\u968f\u673a\u6570\u2014\u2014random","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 python \u4e2d\u751f\u6210\u968f\u673a\u6570\u7684 random \u7c7b\u7684\u60ef\u7528\u6cd5\u3002</p> <p>random \u2014 Generate pseudo-random numbers @zh-cn</p> <ul> <li>python \u968f\u673a\u6570 random \u5e93\u7684\u4f7f\u7528\u603b\u7ed3</li> <li>Python\u968f\u673a\u51fd\u6570random\u4f7f\u7528\u8be6\u89e3</li> <li>Python random \u968f\u673a\u51fd\u6570\u793a\u4f8b</li> </ul> <p>\u6a21\u5757random\u5305\u542b\u751f\u6210\u4f2a\u968f\u673a\u6570\u7684\u51fd\u6570\uff0c\u6709\u52a9\u4e8e\u7f16\u5199\u6a21\u62df\u7a0b\u5e8f\u6216\u751f\u6210\u968f\u673a\u8f93\u51fa\u7684\u7a0b\u5e8f\u3002\u8bf7\u6ce8\u610f\uff0c\u867d\u7136\u8fd9\u4e9b\u51fd\u6570\u751f\u6210\u7684\u6570\u5b57\u597d\u50cf\u662f\u5b8c\u5168\u968f\u673a\u7684\uff0c\u4f46\u5b83\u4eec\u80cc\u540e\u7684\u7cfb\u7edf\u662f\u53ef\u9884\u6d4b\u7684\u3002 \u5982\u679c\u4f60\u8981\u6c42\u771f\u6b63\u7684\u968f\u673a\uff08\u5982\u7528\u4e8e\u52a0\u5bc6\u6216\u5b9e\u73b0\u4e0e\u5b89\u5168\u76f8\u5173\u7684\u529f\u80fd\uff09\uff0c\u5e94\u8003\u8651\u4f7f\u7528\u6a21\u5757os\u4e2d\u7684\u51fd\u6570 <code>urandom</code>\u3002\u6a21\u5757random \u4e2d\u7684 <code>SystemRandom</code> \u7c7b\u57fa\u4e8e\u7684\u529f\u80fd\u4e0eurandom\u7c7b\u4f3c\uff0c\u53ef\u63d0\u4f9b\u63a5\u8fd1\u4e8e\u771f\u6b63\u968f\u673a\u7684\u6570\u636e\u3002</p> <p>\u53c2\u8003 Alternative Generator \u4e2d\u7684 <code>class random.SystemRandom([seed])</code> \u8bf4\u660e\u3002</p>","tags":["random"]},{"location":"blog/20191206/6-random/#randomseed","title":"random.seed","text":"<p>Initialize the random number generator.</p> <pre><code>random.seed(a=None, version=2)\n</code></pre> <p>If <code>a</code> is omitted or None, the current system time is used.</p> <p>Since version 3.11: The seed must be one of the following types: <code>NoneType</code>, int, float, str, bytes, or bytearray.</p> <p>If randomness sources are provided by the operating system, they are used instead of the system time (see the os.urandom() function for details on availability).</p> <pre><code>&gt;&gt;&gt; import os\n&gt;&gt;&gt; help(os.urandom)\nurandom(size, /)\n    Return a bytes object containing random bytes suitable for cryptographic use.\n</code></pre> <p>\u5982\u679c\u4e0d\u8c03\u7528 <code>seed</code> \u6216\u8c03\u7528 <code>seed(None)</code>\uff0c\u9ed8\u8ba4\u5728\u8fd0\u884c\u65f6\u4f7f\u7528\u7cfb\u7edf\u65f6\u95f4\u4f5c\u4e3a\u968f\u673a\u6570\u79cd\u5b50\uff0c\u56e0\u6b64\u6bcf\u6b21\u8fd0\u884c\u7a0b\u5e8f\u5f97\u5230\u7684\u7ed3\u679c\u90fd\u662f\u4e0d\u4e00\u6837\u7684\u3002</p>","tags":["random"]},{"location":"blog/20191206/6-random/#reproducibility","title":"reproducibility","text":"<p>Notes on Reproducibility</p> <p>Sometimes it is useful to be able to reproduce the sequences given by a pseudo-random number generator. By re-using a seed value, the same sequence should be reproducible from run to run as long as multiple threads are not running.  </p> <p>When the random seed is set to be a constant, the random number is fixed every time.  </p> <ul> <li>If <code>a</code> is an int, it is used directly.  </li> </ul> <p>\u5982\u679c\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u6307\u5b9a\u968f\u673a\u6570\u79cd\u5b50\uff0c\u90a3\u4e48\u968f\u673a\u51fd\u6570\u6bcf\u6b21\u91cd\u65b0\u8fd0\u884c\u540e\u4ea7\u751f\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\u3002</p> <p>\u8fd9\u5bf9\u4e8e\u4e00\u4e9b\u9700\u8981\u4fdd\u8bc1\u6d4b\u8bd5\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u4ee5\u4fbf\u591a\u6b21\u91cd\u590d\u6d4b\u8bd5\u7684\u573a\u666f\uff0c\u975e\u5e38\u6709\u7528\u3002</p>","tags":["random"]},{"location":"blog/20191206/6-random/#randomrandom","title":"random.random","text":"<p>random.random \u51fd\u6570\u7528\u4e8e\u751f\u6210\u4e00\u4e2a\u843d\u5165\u533a\u95f4 [0, 1) \u7684\u968f\u673a\u7b26\u70b9\u6570\u3002</p> <pre><code>random() method of random.Random instance\n    random() -&gt; x in the interval [0, 1).\n</code></pre> <p>\u4e24\u6b21\u8c03\u7528 random\uff0c\u751f\u6210\u4e0d\u540c\u7684\u6d6e\u70b9\u7eaf\u5c0f\u6570\uff1a</p> <pre><code>&gt;&gt;&gt; random.random()\n0.5297818805989034\n&gt;&gt;&gt; random.random()\n0.49944915534347745\n</code></pre> <p>\u6307\u5b9a seed\uff0c\u751f\u6210\u76f8\u540c\u7684\u968f\u673a\u6570\uff1a</p> <pre><code>&gt;&gt;&gt; random.seed(10)\n&gt;&gt;&gt; random.random()\n0.5714025946899135\n\n&gt;&gt;&gt; random.random()\n0.4288890546751146\n\n&gt;&gt;&gt; random.seed(10)\n&gt;&gt;&gt; random.random()\n0.5714025946899135\n</code></pre>","tags":["random"]},{"location":"blog/20191206/6-random/#randomuniform","title":"random.uniform","text":"<p>random.uniform \u7528\u4e8e\u751f\u6210\u4e00\u4e2a\u6307\u5b9a\u8303\u56f4\u5185\u7684\u968f\u673a\u7b26\u70b9\u6570\uff0c\u4e24\u4e2a\u53c2\u6570\u4f9d\u6b21\u6307\u5b9a\u4e0a\u9650\u548c\u4e0b\u9650\u3002</p> <pre><code>uniform(a, b) method of random.Random instance\n    Get a random number in the range [a, b) or [a, b] depending on rounding.\n</code></pre> <ul> <li>\u5982\u679c a&lt;b\uff0c\u5219\u751f\u6210\u7684\u968f\u673a\u6570\u8303\u56f4\u662f [a, b]\u3002</li> <li>\u5982\u679c a&gt;b\uff0c\u5219\u751f\u6210\u7684\u968f\u673a\u6570\u8303\u56f4\u662f [b, a]\u3002</li> </ul> <pre><code>&gt;&gt;&gt; random.uniform(3,5)\n3.857778109350229\n&gt;&gt;&gt; random.uniform(3,5)\n4.156182602268941\n\n&gt;&gt;&gt; random.seed(10)\n&gt;&gt;&gt; random.uniform(3,5)\n4.142805189379827\n\n&gt;&gt;&gt; random.uniform(3,5)\n3.857778109350229\n\n&gt;&gt;&gt; random.seed(10)\n&gt;&gt;&gt; random.uniform(3,5)\n4.142805189379827\n</code></pre>","tags":["random"]},{"location":"blog/20191206/6-random/#randomrandint","title":"random.randint","text":"<p>random.randint \u7528\u4e8e\u751f\u6210\u4e00\u4e2a\u6307\u5b9a\u8303\u56f4\u5185\u7684\u6574\u6570\u3002</p> <pre><code>randint(a, b) method of random.Random instance\n    Return random integer in range [a, b], including both end points.\n</code></pre> <p>\u5176\u4e2d\u53c2\u6570a\u662f\u4e0b\u9650\uff0c\u53c2\u6570b\u662f\u4e0a\u9650\uff0c\u751f\u6210\u7684\u968f\u673a\u6570\u8303\u56f4\u662f [a, b]\u3002</p> <pre><code>&gt;&gt;&gt; random.randint(30,50)\n45\n&gt;&gt;&gt; random.randint(30,50)\n48\n</code></pre>","tags":["random"]},{"location":"blog/20191206/6-random/#randomrandrange","title":"random.randrange","text":"<p>random.randrange \u7684\u51fd\u6570\u539f\u578b\u4e3a <code>random.randrange([start], stop[, step])</code>\uff0c\u4fee\u590d\u4e86 randint \u5305\u542b\u4e0a\u754c\u7684\u95ee\u9898\u3002</p> <pre><code>randrange(start, stop=None, step=1) method of random.Random instance\n    Choose a random item from range(start, stop[, step]).\n\n    This fixes the problem with randint() which includes the\n    endpoint; in Python this is usually not what you want.\n</code></pre> <ul> <li>random.randrange(stop): \u7528\u4e8e\u751f\u6210\u4e00\u4e2a\u968f\u673a\u6574\u6570\uff0c\u53d6\u503c\u8303\u56f4\u4e3a [0, stop)\u3002</li> <li>random.randrange(start, stop[, step]): \u7528\u4e8e\u751f\u6210\u4e00\u4e2a\u968f\u673a\u6574\u6570\uff0c\u53d6\u503c\u8303\u56f4\u4e3a [start, stop)\u3002</li> </ul> <p>\u751f\u6210\u4e00\u4e2a\u53d6\u503c 0-999 \u7684\u968f\u673a\u6570\uff1a</p> <pre><code>&gt;&gt;&gt; random.randrange(1000)\n15\n&gt;&gt;&gt; random.randrange(1000)\n211\n</code></pre>","tags":["random"]},{"location":"blog/20191206/6-random/#randomchoice","title":"random.choice","text":"<p>random.choice \u4ece\u6307\u5b9a\u5e8f\u5217 <code>seq</code> \u4e2d\u968f\u673a\u83b7\u53d6\u4e00\u4e2a\u5143\u7d20\u3002</p> <p>\u53c2\u6570 <code>seq</code> \u8868\u793a\u4e00\u4e2a\u6709\u5e8f\u7c7b\u578b\uff0c\u5728python\u4e2d\u6cdb\u6307\u4e00\u7cfb\u5217\u7684\u7c7b\u578b\uff0c\u4f8b\u5982 list,range,tuple,str\u7b49\u3002</p> <pre><code>choice(seq) method of random.Random instance\n    Choose a random element from a non-empty sequence.\n</code></pre> <pre><code># list\n&gt;&gt;&gt; random.choice([1,3,5,7,9])\n7\n&gt;&gt;&gt; random.choice([1,3,5,7,9])\n5\n# range\n&gt;&gt;&gt; random.choice(range(1000))\n473\n# tuple\n&gt;&gt;&gt; random.choice((2,4,6,8,10))\n4\n&gt;&gt;&gt; random.choice((2,4,6,8,10))\n2\n# str\n&gt;&gt;&gt; random.choice('Python')\n'o'\n&gt;&gt;&gt; random.choice('Zen of Python')\n'P'\n</code></pre>","tags":["random"]},{"location":"blog/20191206/6-random/#randomchoices","title":"random.choices","text":"<p>\u57fa\u4e8e\u4e0d\u91cd\u590d\u5e8f\u5217\uff0c\u6269\u5bb9\u751f\u6210\u8fd4\u56de\u5e26\u91cd\u590d\u6570\u5b57\u7684\u65b0\u5e8f\u5217\uff0c\u9a8c\u8bc1\u5305\u542b\u91cd\u590d\u6570\u5b57\u7684\u6d4b\u8bd5\u7528\u4f8b\u3002</p> <ul> <li>\u6e90\u8f93\u5165\u5e8f\u5217 population \u4fdd\u6301\u4e0d\u53d8\u3002</li> </ul> <pre><code>choices(population, weights=None, *, cum_weights=None, k=1) method of random.Random instance\n    Return a k sized list of population elements chosen with replacement.\n\n    If the relative weights or cumulative weights are not specified,\n    the selections are made with equal probability.\n</code></pre> <ul> <li>sequence\uff1a\u5fc5\u586b\u53c2\u6570\uff0c\u8ddf random.choice() \u4e00\u6837\u3002</li> <li>weights\uff1a\u53ef\u9009\u53c2\u6570\uff0c\u7528\u4e8e\u8861\u91cf\u6bcf\u4e2a\u503c\u7684\u53ef\u80fd\u6027\u7684\u53ef\u9009\u53c2\u6570\uff0c\u503c\u8d8a\u5927\u968f\u673a\u51fa\u73b0\u7684\u51e0\u7387\u4e5f\u5c31\u8d8a\u5927\uff0c\u4e0d\u586b\u8ddf random.choice() \u6ca1\u533a\u522b\u3002</li> <li>cum_weights\uff1a\u53ef\u9009\u53c2\u6570\uff0c\u7528\u4e8e\u6743\u8861\u6bcf\u4e2a\u503c\u7684\u53ef\u80fd\u6027\uff0c\u4f46\u662f\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u6027\u88ab\u7d2f\u52a0\u3002</li> <li>k\uff1a\u53ef\u9009\u53c2\u6570\uff0c\u7528\u4e8e\u5b9a\u4e49\u8fd4\u56de\u5217\u8868\u7684\u957f\u5ea6\uff0c\u9ed8\u8ba4 1 \u4e2a\u3002</li> </ul> <p>\u6ce8\u610f\uff1aweights \u6570\u7ec4\u7684\u5143\u7d20\u4e2a\u6570\u5fc5\u987b\u4e0e population \u4e00\u81f4\uff0c\u5426\u5219\u62a5\u9519 <code>ValueError: The number of weights does not match the population</code>\u3002</p> <pre><code>&gt;&gt;&gt; mylist = [\"geeks\", \"for\", \"python\"]\n&gt;&gt;&gt; print(random.choices(mylist, weights = [10, 1, 1], k = 5))\n['geeks', 'geeks', 'geeks', 'geeks', 'geeks']\n</code></pre> <p>\u957f\u5ea6\u4e3a5\u7684\u5217\u8868 mylist \u4e0d\u5305\u542b\u91cd\u590d\u5143\u7d20\uff0c\u53ef\u8c03\u7528 choices \u751f\u6210\u5305\u542b\u91cd\u590d\u5143\u7d20\u7684\u6269\u5bb9\u5e8f\u5217\uff0c<code>weights</code> \u8bbe\u7f6e\uff08\u91cd\u590d\uff09\u51fa\u73b0\u7684\u6982\u7387\u3002</p> <p>\u4ece\u7ed3\u679c\u770b\uff0cchoices \u65e0\u6cd5\u4fdd\u8bc1\u6bcf\u4e2a\u5143\u7d20\u90fd\u81f3\u5c11\u51fa\u73b0\u4e00\u6b21\u3002</p> <pre><code>&gt;&gt;&gt; mylist=[1,3,5,7,9]\n&gt;&gt;&gt; random.choices(mylist, weights=[1,4,6,3,5], k=10)\n[7, 7, 3, 9, 9, 9, 7, 1, 1, 3]\n</code></pre> <p>\u5bf9\u4e8e <code>k&lt;len(population)</code> \u7684\u60c5\u5f62\uff0c\u622a\u53d6\u7684\u7247\u6bb5\u4e2d\u53ef\u80fd\u5b58\u5728\u91cd\u590d\u7684\u5143\u7d20\uff0c\u5373\u901a\u8fc7choices\u8fdb\u884c\u591a\u6311\u5c11\u662f\u653e\u56de\u53d6\u6837\u3002 \u5982\u679c\u8981\u4e0d\u653e\u56de\u53d6\u6837\u62bd\u53d6\u4e0d\u91cd\u590d\u7684\u5b50\u5e8f\u5217\uff0c\u5efa\u8bae\u91c7\u7528 <code>random.sample</code> \u51fd\u6570\u3002</p> <pre><code># \u4ece[0,9]\u4e5d\u4e2a\u6570\u4e2d\u653e\u56de\u53d6\u68375\u4e2a\uff0c\u53ef\u80fd\u5b58\u5728\u91cd\u590d\u3002\n&gt;&gt;&gt; random.choices(range(0,10), k=5)\n[9, 1, 9, 7, 4]\n</code></pre>","tags":["random"]},{"location":"blog/20191206/6-random/#randomshuffle","title":"random.shuffle","text":"<p>random.shuffle \u7528\u4e8e\u6a21\u62df\u6d17\u724c\uff0c\u5c06\u4e00\u4e2a\u5217\u8868\u4e2d\u7684\u5143\u7d20\u6253\u4e71\u987a\u5e8f\u3002</p> <pre><code>shuffle(x, random=None) method of random.Random instance\n    Shuffle list x in place, and return None.\n\n    Optional argument random is a 0-argument function returning a\n    random float in [0.0, 1.0); if it is the default None, the\n    standard random.random will be used.\n</code></pre> <p>shuffle \u672c\u8eab\u65e0\u8fd4\u56de\u503c\uff0c\u88ab\u64cd\u4f5c\u5bf9\u8c61 mylist \u88ab\u6d17\u724c\u540e\u5c31\u5730\u6253\u4e71\u3002</p> <pre><code>&gt;&gt;&gt; mylist=[1,3,5,7,9]\n&gt;&gt;&gt; random.shuffle(mylist)\n&gt;&gt;&gt; mylist\n[7, 3, 1, 9, 5]\n\n&gt;&gt;&gt; random.shuffle(mylist)\n&gt;&gt;&gt; mylist\n[7, 1, 3, 9, 5]\n</code></pre>","tags":["random"]},{"location":"blog/20191206/6-random/#randomsample","title":"random.sample","text":"<p>random.sample \u7528\u4e8e\u6a21\u62df\u62bd\u724c\uff0c\u4ece\u6307\u5b9a\u5e8f\u5217\u4e2d\u968f\u673a\u62bd\u53d6\u6307\u5b9a\u957f\u5ea6\u7684\u7247\u65ad\u3002</p> <pre><code>sample(population, k, *, counts=None) method of random.Random instance\n    Chooses k unique random elements from a population sequence or set.\n\n    Returns a new list containing elements from the population while\n    leaving the original population unchanged.  The resulting list is\n    in selection order so that all sub-slices will also be valid random\n    samples.  This allows raffle winners (the sample) to be partitioned\n    into grand prize and second place winners (the subslices).\n\n    Repeated elements can be specified one at a time or with the optional keyword-only counts parameter. \n</code></pre> <p>\u4ece population \u4e2d\u968f\u673a\u62bd\u53d65\u4e2a\u5143\u7d20\uff0c\u4f5c\u4e3a\u4e00\u4e2a\u7247\u65ad\uff08\u5b50\u5e8f\u5217\uff09\u8fd4\u56de\u3002 \u57fa\u4e8e\u526f\u672c\u64cd\u4f5c\uff0c\u6e90\u8f93\u5165\u5e8f\u5217\u5c06\u4fdd\u6301\u4e0d\u53d8\u3002</p> <pre><code>&gt;&gt;&gt; random.sample(range(0,10), 5)\n[4, 2, 8, 6, 0]\n\n&gt;&gt;&gt; list = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n&gt;&gt;&gt; slice = random.sample(list, 5)\n&gt;&gt;&gt; slice\n[2, 6, 3, 7, 10]\n</code></pre> <p>\u5982\u679c k&gt;len(population)\uff0c\u5219\u4f1a\u62a5\u9519\uff1a<code>ValueError: Sample larger than population or is negative</code>\u3002</p> <pre><code>&gt;&gt;&gt; l = list(range(1,10,2))\n&gt;&gt;&gt; l\n[1, 3, 5, 7, 9]\n&gt;&gt;&gt; import random\n&gt;&gt;&gt; random.sample(l, k=10)\n    raise ValueError(\"Sample larger than population or is negative\")\nValueError: Sample larger than population or is negative\n</code></pre> <p>\u6b64\u65f6\uff0c\u53ef\u901a\u8fc7 <code>counts</code> \u53c2\u6570\u6307\u5b9a\u6bcf\u4e2a\u5143\u7d20\u51fa\u73b0\u7684\u6b21\u6570\u3002 l=[1,3,5,7,9]\uff0c\u6307\u5b9a counts=[1,2,2,2,3]\uff0c\u52191\u51fa\u73b01\u6b21\uff0c3\u30015\u30017\u5404\u51fa\u73b02\u6b21\uff0c9\u51fa\u73b0\u4e09\u6b21\u3002</p> <pre><code>l = list(range(1,10,2))\n&gt;&gt;&gt; random.sample(l, k=10, counts=[1,2,2,2,3])\n[7, 9, 5, 9, 9, 1, 5, 3, 3, 7]\n</code></pre>","tags":["random"]},{"location":"blog/20191206/6-random/#\u5b9e\u6218\u793a\u4f8b","title":"\u5b9e\u6218\u793a\u4f8b","text":"<p>\u5b9e\u9645\u9700\u6c42\u4e2d\uff0c\u968f\u673a\u751f\u6210\u4e00\u4e2a\u3001\u4e24\u4e2a\u6574\u6570\u6216\u4e00\u7cfb\u5217\u6574\u6570\u7684\u573a\u666f\u6bd4\u8f83\u591a\u3002</p> <ul> <li>\u751f\u6210\u4e00\u4e2a\u6574\u6570\uff0c\u53ef\u4ee5\u57fa\u4e8e <code>random.randrange</code> \u6216 <code>random.choice</code> \u4ece\u5df2\u77e5\u5e8f\u5217\u4e2d\u968f\u673a\u9009\u4e00\u4e2a\u3002</li> <li>\u751f\u6210\u4e24\u4e2a\u6574\u6570\uff0c\u53ef\u4ee5\u4e24\u6b21\u8c03\u7528 <code>random.randrange</code> \u6216 <code>random.choice</code>\uff0c\u4e5f\u53ef\u4ee5\u8c03\u7528 <code>random.sample</code> \u4ece\u5df2\u77e5\u5e8f\u5217\u4e2d\u968f\u673a\u6311\u9009\u4e24\u4e2a\u3002</li> <li>\u751f\u6210N\u4e2a\u6574\u6570\u5e8f\u5217\uff0c\u53ef\u4ee5for\u5faa\u73afN\u6b21\u8c03\u7528 <code>random.randrange</code>\uff0c\u6216\u8c03\u7528 <code>random.sample</code> \u4ece\u5df2\u77e5\u5e8f\u5217\uff08\u4f8b\u5982range\uff09\u4e2d\u968f\u673a\u6311\u9009N\u4e2a\u3002</li> <li>\u5df2\u77e5\u4e0d\u91cd\u590d\u7684\u5e8f\u5217list\uff0c\u53ef\u8c03\u7528 <code>random.choices</code> \u5bf9\u5176\u8fdb\u884c\u6269\u5bb9\u3002</li> </ul> <p>\u4ee5\u4e0b\u7efc\u5408\u793a\u4f8b\uff0c\u4e3b\u8981</p> <ol> <li>randomList \u51fd\u6570\u7528\u4e8e\u751f\u6210\u4e00\u4e2a\u957f\u5ea6\u4e3an\u7684\u968f\u673a\u6574\u6570\u5217\u8868\uff0c\u6570\u503c\u8303\u56f4\u4e3a [0,1000]\u3002</li> <li>\u8c03\u7528 <code>random.shuffle</code> \u5bf9 iList1 \u7684\u526f\u672c iList2 \u8fdb\u884c\u6d17\u724c\u3002</li> <li>\u8c03\u7528 <code>random.choices</code> \u6269\u5bb9\u751f\u6210\u5305\u542b\u91cd\u590d\u5143\u7d20\u7684\u65b0\u5e8f\u5217 iList3\u3002</li> </ol> <pre><code>import random\n\ndef randomList(n: int = 5, min: int = 1, max: int = 10) -&gt; list:\n    '''\u8fd4\u56de\u4e00\u4e2a\u957f\u5ea6\u4e3an\u7684\u6574\u6570\u5217\u8868'''\n    if min &gt; max or n&gt;=max-min+1:\n        return []\n\n    # \u65b9\u6cd5\u4e00\uff1a\u57fa\u4e8e for \u5faa\u73af\u548c randrange\uff0c\u6570\u503c\u8303\u56f4\u8f83\u5c0f\u65f6\u5f88\u5bb9\u6613\u91cd\u590d\n    # iList = []\n    # for i in range(n):\n    #     iList.append(random.randint(min, max))\n    # \u65b9\u6cd5\u4e8c\uff1a\u57fa\u4e8e sample\uff0c\u62bd\u6837\u4e0d\u91cd\u590d\n    iList = random.sample(range(min,max+1), n)\n    return iList\n\nif __name__ == \"__main__\":\n    # \u4ece[1,100]\u4e2d\u968f\u673a\u6311\u900910\u4e2a\u6570\n    iList = randomList(10, 1, 100)\n    print(iList)\n    # \u4ece[1,10]\u4e2d\u968f\u673a\u6311\u90096\u4e2a\u6570\n    iList1 = randomList(6)\n    # manipulate with iList: countingSort(iList1)\n    print(iList1)\n    iList2 = iList1.copy()\n    random.shuffle(iList2)\n    print(iList2)\n    # manipulate with iList2: countingSort(iList2)\n    # \u6269\u5bb9\u751f\u6210\u957f\u5ea6\u4e3a10\u7684\u65b0\u5e8f\u5217\uff0c\u4ee5\u4fbf\u5305\u542b\u91cd\u590d\u5143\u7d20\uff08\u6709\u4e9b\u5143\u7d20\u53ef\u80fd\u4e0d\u5305\u542b\uff09\n    iList3 = random.choices(iList2, weights=[1,2,3,4,5,6], k=10)\n    print(iList3)\n    # manipulate with iList3: countingSort(iList3)\n    # \u6269\u5bb9\u751f\u6210\u957f\u5ea6\u4e3a10\u7684\u65b0\u5e8f\u5217\uff0ccounts \u6307\u5b9a\u6bcf\u4e2a\u5143\u7d20\u51fa\u73b0\u6b21\u6570\n    iList4 = random.sample(iList2, k=10, counts=[1,2,1,2,3,1])\n    print(iList4)\n    # manipulate with iList3: countingSort(iList4)\n</code></pre>","tags":["random"]},{"location":"blog/20191206/7-collections/","title":"python\u4e2d\u7684\u5bb9\u5668\u7c7b\u2014\u2014collections","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 python \u4e2d\u7684\u5bb9\u5668\u7c7b collections \u63d0\u4f9b\u7684\u4fbf\u5229\u5de5\u5177\u96c6\uff08wrapper toolset\uff09\u3002</p> <p>collections \u2014 Container datatypes</p> <ul> <li><code>namedtuple()</code>\uff08\u547d\u540d\u5143\u7ec4\uff09: factory function for creating tuple subclasses with named fields  </li> <li><code>deque</code>\uff08\u53cc\u7aef\u961f\u5217\uff09: list-like container with fast appends and pops on either end  </li> <li><code>ChainMap</code>\uff08\u94fe\u63a5\u5b57\u5178\uff09: dict-like class for creating a single view of multiple mappings  </li> <li><code>Counter</code>\uff08\u8ba1\u6570\u5668\uff09: dict subclass for counting hashable objects  </li> <li><code>OrderedDict</code>\uff08\u6709\u5e8f\u5b57\u5178\uff09: dict subclass that remembers the order entries were added  </li> <li><code>defaultdict</code>: dict subclass that calls a factory function to supply missing values  </li> <li><code>UserDict</code>: wrapper around dictionary objects for easier dict subclassing  </li> <li><code>UserList</code>: wrapper around list objects for easier list subclassing  </li> <li><code>UserString</code>: wrapper around string objects for easier string subclassing  </li> </ul>","tags":["collections"]},{"location":"blog/20191206/7-collections/#help","title":"help","text":"<pre><code>&gt;&gt;&gt; import collections\n&gt;&gt;&gt; help(collections)\n\nHelp on package collections:\n\nNAME\n    collections\n\nDESCRIPTION\n    This module implements specialized container datatypes providing\n    alternatives to Python's general purpose built-in containers, dict,\n    list, set, and tuple.\n\n    * namedtuple   factory function for creating tuple subclasses with named fields\n    * deque        list-like container with fast appends and pops on either end\n    * ChainMap     dict-like class for creating a single view of multiple mappings\n    * Counter      dict subclass for counting hashable objects\n    * OrderedDict  dict subclass that remembers the order entries were added\n    * defaultdict  dict subclass that calls a factory function to supply missing values\n    * UserDict     wrapper around dictionary objects for easier dict subclassing\n    * UserList     wrapper around list objects for easier list subclassing\n    * UserString   wrapper around string objects for easier string subclassing\n</code></pre>","tags":["collections"]},{"location":"blog/20191206/7-collections/#ordereddict","title":"OrderedDict","text":"<p>Converting dict to OrderedDict</p> <pre><code>import collections\n\nJoe = {\"Age\": 28, \"Race\": \"Latino\", \"Job\": \"Nurse\"}\nBob = {\"Age\": 25, \"Race\": \"White\", \"Job\": \"Mechanic\", \"Random\": \"stuff\"}\n\n#Just for clarity:\nJoe = collections.OrderedDict(Joe)\nBob = collections.OrderedDict(Bob)\n\nprint(Joe)\n# OrderedDict([('Age', 28), ('Race', 'Latino'), ('Job', 'Nurse')])\nprint(Bob)\n# OrderedDict([('Age', 25), ('Race', 'White'), ('Job', 'Mechanic'), ('Random', 'stuff')])\n</code></pre>","tags":["collections"]},{"location":"blog/20191206/7-collections/#orderedset","title":"OrderedSet","text":"<p>Does Python have an ordered set?</p> <p>orderedset</p>","tags":["collections"]},{"location":"blog/20191206/8-datetime/","title":"python\u4e2d\u7684\u65e5\u671f\u65f6\u95f4\u5904\u7406\u7c7b\u2014\u2014datetime","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 python \u4e2d\u7684\u65e5\u671f\u65f6\u95f4\u5904\u7406\u7c7b datetime\uff0c\u8bb0\u5f55\u4e86\u4e00\u4e9b\u65e5\u5e38\u7528\u6cd5\u3002</p>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#utc","title":"UTC","text":"<p>What is UTC or GMT Time?</p> <ul> <li><code>GMT</code>: Greenwich Mean Time</li> <li><code>UTC</code>: Universal Time Coordinated</li> </ul> <p>UTC \u2013 The World's Time Standard</p> <ul> <li><code>UTC</code> is A Standard, Not a Time Zone;  </li> <li><code>GMT</code> is now a Time Zone.  </li> </ul> <p>Coordinated Universal Time (UTC, GMT, CUT)</p> <p>\u65f6\u95f4\u670d\u52a1\u5668\uff1a</p> <ul> <li>Epoch Clock </li> <li> <p>Unix Epoch Clock </p> </li> <li> <p>World Time Server </p> </li> <li>TIME.IS: UTC: Unix Time, Beijing Time </li> </ul> <p>Epoch Converter\uff1a</p> <ul> <li>Unix Timestamp - Epoch Converter </li> <li>Unix Time Stamp - Epoch Converter </li> <li>Epoch Converter - Unix Timestamp Converter </li> <li>Convert Epoch/Unix Timestamp </li> </ul>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#datetime","title":"datetime","text":"<p>datetime </p> <pre><code>NAME\n    datetime - Fast implementation of the datetime type.\n\nCLASSES\n    builtins.object\n        date\n            datetime\n        time\n        timedelta\n        tzinfo\n            timezone\n</code></pre> <p>class <code>datetime.date</code></p> <ul> <li>An idealized naive date, assuming the current Gregorian calendar always was, and always will be, in effect. Attributes: year, month, and day.</li> </ul> <p>class <code>datetime.time</code></p> <ul> <li>An idealized time, independent of any particular day, assuming that every day has exactly 246060 seconds. (There is no notion of \u201cleap seconds\u201d here.) Attributes: hour, minute, second, microsecond, and tzinfo.</li> </ul> <p>class <code>datetime.datetime</code></p> <ul> <li>A combination of a date and a time. Attributes: year, month, day, hour, minute, second, microsecond, and tzinfo.</li> </ul> <p>class <code>datetime.timedelta</code></p> <ul> <li>A duration expressing the difference between two date, time, or datetime instances to microsecond resolution.</li> </ul>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#strftime","title":"strftime","text":"<p>datetime.strftime(format)</p> <p>strftime: Return a string representing the date</p> <p>\u6309\u683c\u5f0f\u8f93\u51fa\u65e5\u671f\u5b57\u7b26\u4e32\uff1a</p> <pre><code>&gt;&gt;&gt; import datetime\n\n&gt;&gt;&gt; datetime_now = datetime.datetime.now()\n&gt;&gt;&gt; datetime_now\ndatetime.datetime(2018, 4, 24, 15, 51, 2, 399371)\n&gt;&gt;&gt; datetime_now.strftime('%Y-%m-%d %H:%M:%S')\n'2018-04-24 15:51:02'\n</code></pre> <p>type-specific formatting \u7b49\u6548\u5199\u6cd5\uff1a</p> <pre><code>&gt;&gt;&gt; import datetime\n&gt;&gt;&gt; d=datetime.datetime(2018, 4, 25, 13, 0, 0)\n&gt;&gt;&gt; '{:%Y-%m-%d %H:%M:%S}'.format(d)\n'2018-04-25 13:00:00'\n</code></pre>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#strptime","title":"strptime","text":"<p>classmethod datetime.strptime(date_string, format)</p> <p>strptime: Return a datetime corresponding to date_string, parsed according to format.</p> <pre><code>&gt;&gt;&gt; datetime_now = datetime.datetime.strptime('20180424', '%Y%m%d')\n&gt;&gt;&gt; datetime_begin = datetime.datetime.strptime('20180323', '%Y%m%d')\n&gt;&gt;&gt; datetime_count = datetime_now-datetime_begin\n&gt;&gt;&gt; datetime_count\ndatetime.timedelta(32)\n&gt;&gt;&gt; datetime_count.days\n32\n</code></pre>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#timestamp","title":"timestamp","text":"<p>Unix \u65f6\u95f4\u6233\u662f\u4ece1970\u5e741\u67081\u65e5\uff08UTC/GMT\u7684\u5348\u591c\uff09\u5f00\u59cb\u6240\u7ecf\u8fc7\u7684\u79d2\u6570\uff08\u4e0d\u8003\u8651\u95f0\u79d2\uff09\uff0c\u662f\u4e00\u4e2a\u6d6e\u70b9\u6570\u3002 \u82f1\u6587\u4e3a Unix time, POSIX time, Unix epoch \u6216 Unix timestamp\u3002</p> <ul> <li>The Current Epoch Unix Timestamp: Seconds since Jan 01 1970. (UTC)</li> <li>The Unix epoch is the number of seconds that have elapsed since January 1, 1970 at midnight UTC time minus the leap seconds.</li> </ul> <p>time\u548cdatetime\u90fd\u662fPython\u4e2d\u7684\u5185\u7f6e\u6a21\u5757\uff0c\u90fd\u53ef\u4ee5\u5bf9\u65f6\u95f4\u8fdb\u884c\u83b7\u53d6\uff0c\u5bf9\u65f6\u95f4\u683c\u5f0f\u8fdb\u884c\u8f6c\u6362\uff0c\u5982\u65f6\u95f4\u6233\u548c\u65f6\u95f4\u5b57\u7b26\u4e32\u7684\u76f8\u4e92\u8f6c\u6362\u3002</p> <ul> <li>Python\u4e2dtime\u548cdatetime\u65f6\u95f4\u6233\u548c\u65f6\u95f4\u5b57\u7b26\u4e32\u76f8\u4e92\u8f6c\u6362</li> </ul>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#time","title":"time","text":"<p>time \u6a21\u5757\u5b9a\u4e49\u7684 <code>time()</code> \u51fd\u6570\u8fd4\u56de\u5f53\u524d\u65f6\u95f4\uff0c\u662f\u4e00\u4e2a\u79d2\u7ea7\u65f6\u95f4\u6233\u6d6e\u70b9\u6570\u3002</p> <pre><code>FUNCTIONS\n\n    time(...)\n        time() -&gt; floating point number\n\n        Return the current time in seconds since the Epoch.\n</code></pre> <p>\u5bf9\u4e8e <code>time()</code> \u8fd4\u56de\u7684\u79d2\u7ea7\u65f6\u95f4\u6233\uff0c\u4e58\u4ee51000\u5373\u53ef\u6c42\u5f97\u6beb\u79d2\u7ea7\uff1a</p> <pre><code>import time, math\n\nsTimestamp = time.time() # 6\u4f4d\u5c0f\u6570\nprint(sTimestamp)\nmsTimestamp = time.time() * 1000\nprint(msTimestamp)\nprint(math.floor(msTimestamp)) # \u5411\u4e0b\u53d6\u6574\uff0c\u5ffd\u7565us\nprint(round(msTimestamp)) # \u56db\u820d\u4e94\u5165\n</code></pre> <p>\u8fd0\u884c\u8f93\u51fa\uff1a</p> <pre><code>1669000141.6891751\n1669000141689.566\n1669000141690\n1669000141689\n</code></pre> <p>\u57fa\u4e8e <code>time_ns()</code> \u63a5\u53e3\u8fd4\u56de\u9ad8\u7cbe\u5ea6\u7684\u7eb3\u79d2\u7ea7\u65f6\u95f4\u6233\uff0c\u6765\u6362\u7b97\u66f4\u7c97\u7c92\u5ea6\u7684\u6beb\u79d2\u5355\u4f4d\uff0c\u53ef\u80fd\u66f4\u4e3a\u5408\u7406\uff1a</p> <pre><code>import time\n\nsTimestamp = time.time() # \u79d2\uff0c6\u4f4d\u5c0f\u6570\nprint(sTimestamp)\nnsTimestamp = time.time_ns() # \u7eb3\u79d2\nprint(nsTimestamp)\nmsTimestamp = nsTimestamp / (1000 * 1000) # \u6beb\u79d2\nprint(msTimestamp)\n</code></pre> <pre><code>1669000543.659899\n1669000543660408000\n1669000543660.408\n</code></pre>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#datetime_1","title":"datetime","text":"<p>class datetime \u7684\u5b9e\u4f8b\u65b9\u6cd5 <code>timestamp()</code>\uff1aReturn POSIX timestamp as float.</p> <pre><code>import datetime;\n\ncurrent_time = datetime.datetime.now()\ntime_stamp = current_time.timestamp()\nprint(\"timestamp:\", time_stamp)\n</code></pre> <p>\u4e5f\u53ef\u8c03\u7528\u7c7b\u65b9\u6cd5 datetime.timestamp(dt)\uff0c\u5176\u4e2ddt\u4e3adatetime\u5bf9\u8c61\u5b9e\u4f8b\uff1a</p> <pre><code>from datetime import datetime\n\nnow = datetime.now()\ntimestamp = datetime.timestamp(now)\nprint(\"timestamp =\", timestamp)\n</code></pre>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#fromtimestamp","title":"fromtimestamp","text":"<pre><code>classmethod datetime.fromtimestamp(timestamp, tz=None)\nReturn the local date and time corresponding to the POSIX timestamp, such as is returned by time.time(). \n</code></pre> <p>\u4e5f\u53ef\u8c03\u7528\u7c7b\u65b9\u6cd5 datetime.timestamp(ts)\uff0c\u5176\u4e2dts\u4e3a\u79d2\u7ea7\u65f6\u95f4\u6233\uff1a</p> <pre><code>&gt;&gt;&gt; datetime.fromtimestamp(time.time())\ndatetime.datetime(2022, 11, 21, 11, 42, 7, 720789)\n</code></pre>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#timedelta","title":"timedelta","text":"<pre><code>&gt;&gt;&gt; # \u83b7\u53d6\u5f53\u524d\u65f6\u95f4\n&gt;&gt;&gt; d0 = datetime.datetime.now()\n&gt;&gt;&gt; # \u57fa\u4e8e\u65e5\u671f\u5b57\u7b26\u4e32\u521b\u5efa\u65e5\u671f\u5bf9\u8c61\n&gt;&gt;&gt; str_begin_date = '20180314'\n&gt;&gt;&gt; d1 = datetime.datetime.strptime(str_begin_date, '%Y%m%d')\n&gt;&gt;&gt; d2 = datetime.datetime(2018,2,2)\n&gt;&gt;&gt; # \u8ba1\u7b97\u65e5\u671f\u76f8\u9694\u5929\u6570\n&gt;&gt;&gt; dd1=d0-d1\n&gt;&gt;&gt; dd1.days\n43\n&gt;&gt;&gt; dd2=d1-d2\n&gt;&gt;&gt; dd2.days\n40\n&gt;&gt;&gt; # \u8ba1\u7b9732\u5929\u524d\u7684\u65e5\u671f\n&gt;&gt;&gt; d3 = d0 - datetime.timedelta(days=32)\n&gt;&gt;&gt; d3\ndatetime.datetime(2018, 3, 25, 22, 37, 55, 465668)\n</code></pre>","tags":["datetime"]},{"location":"blog/20191206/8-datetime/#examples","title":"Examples","text":"<ul> <li>Examples of Usage: date</li> <li>Examples of Usage: datetime</li> <li>Examples of Usage: time</li> <li>Examples of usage: timedelta</li> </ul>","tags":["datetime"]},{"location":"blog/20191206/9-json/","title":"python\u4e2d\u7684json\u5904\u7406","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 python \u4e2d\u7684 json \u5904\u7406\u60ef\u7528\u6cd5\u3002</p> <p>json \u2014 JSON encoder and decoder json --- JSON \u7f16\u7801\u548c\u89e3\u7801\u5668</p> <p>JSON (JavaScript Object Notation)\uff0c\u7531 RFC 7159 (\u5b83\u53d6\u4ee3\u4e86 RFC 4627) \u548c ECMA-404 \u6307\u5b9a\uff0c\u662f\u4e00\u4e2a\u53d7 JavaScript \u7684\u5bf9\u8c61\u5b57\u9762\u503c\u53e5\u6cd5\u542f\u53d1\u7684\u8f7b\u91cf\u7ea7\u6570\u636e\u4ea4\u6362\u683c\u5f0f\uff0c\u5c3d\u7ba1\u5b83\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u4e25\u683c\u610f\u4e49\u4e0a\u7684 JavaScript \u7684\u5b50\u96c6 1\u3002</p> <ul> <li>Python3 JSON \u6570\u636e\u89e3\u6790</li> <li>\u4f7f\u7528Python\u8bfb\u53d6\u3001\u5199\u5165\u548c\u89e3\u6790JSON</li> <li>Working With JSON Data in Python</li> </ul> <p>Python3 \u4e2d\u53ef\u4ee5\u4f7f\u7528 json \u6a21\u5757\u6765\u5bf9 JSON \u6570\u636e\u8fdb\u884c\u7f16\u89e3\u7801\uff0c\u5b83\u5305\u542b\u4e86\u4e24\u4e2a\u51fd\u6570\uff1a</p> <ul> <li>json.dumps(): \u5bf9\u6570\u636e\u8fdb\u884c\u7f16\u7801\u3002</li> <li>json.loads(): \u5bf9\u6570\u636e\u8fdb\u884c\u89e3\u7801\u3002</li> </ul>","tags":["json"]},{"location":"blog/20191206/9-json/#dumpsdict_-_json_str","title":"dumps(dict -&gt; json_str)","text":"<p>\u4ee5\u4e0b\u5b9e\u4f8b\u6f14\u793a\u4e86\u5c06 Python \u6570\u636e\u7ed3\u6784\uff08dict\uff09\u8f6c\u6362\u4e3a JSON \u5bf9\u8c61\uff1a</p> <pre><code>#!/usr/bin/env python3\n\nimport json\n\n# Python \u5b57\u5178\u7c7b\u578b\u8f6c\u6362\u4e3a JSON \u5bf9\u8c61\ndata = {\n    'no' : 1,\n    'name' : 'W3CSchool',\n    'url' : 'http://www.w3cschool.cn'\n}\n\njson_str = json.dumps(data)\nprint (\"Python \u539f\u59cb\u6570\u636e\uff1a\", repr(data))\nprint (\"JSON \u5bf9\u8c61\uff1a\", json_str)\n</code></pre>","tags":["json"]},{"location":"blog/20191206/9-json/#dumpdict_-_json_file","title":"dump(dict -&gt; json_file)","text":"<p><code>json.dump()</code> \u65b9\u6cd5\u53ef\u7528\u4e8e\u5c06Python\u5b57\u5178\u5199\u5165JSON\u6587\u4ef6\u3002</p> <p>\u53e5\u6cd5\uff1a</p> <pre><code>json.dump\uff08dict\uff0cfile_pointer\uff09\n</code></pre>","tags":["json"]},{"location":"blog/20191206/9-json/#loadsjson_str_-_dict","title":"loads(json_str -&gt; dict)","text":"<p>\u63a5\u7740\u4ee5\u4e0a\u5b9e\u4f8b\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u4e2aJSON\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u56de\u4e00\u4e2aPython\u6570\u636e\u7ed3\u6784\uff1a</p> <pre><code>#!/usr/bin/env python3\n\nimport json\n\n# Python \u5b57\u5178\u7c7b\u578b\u8f6c\u6362\u4e3a JSON \u5bf9\u8c61\ndata1 = {\n    'no' : 1,\n    'name' : 'W3CSchool',\n    'url' : 'http://www.w3cschool.cn'\n}\n\njson_str = json.dumps(data1)\nprint (\"Python \u539f\u59cb\u6570\u636e\uff1a\", repr(data1))\nprint (\"JSON \u5bf9\u8c61\uff1a\", json_str)\n\n# \u5c06 JSON \u5bf9\u8c61\u8f6c\u6362\u4e3a Python \u5b57\u5178\ndata2 = json.loads(json_str)\nprint (\"data2['name']: \", data2['name'])\nprint (\"data2['url']: \", data2['url'])\n</code></pre>","tags":["json"]},{"location":"blog/20191206/9-json/#loadjson_file_-_dict","title":"load(json_file -&gt; dict)","text":"<p><code>json.load()</code> \u65b9\u6cd5\u53ef\u7528\u4e8e\u4eceJSON\u6587\u4ef6\u8bfb\u53d6\u4e3aPython\u5b57\u5178\u5bf9\u8c61\u3002</p> <pre><code>&gt;&gt;&gt; with open(\"test.json\", \"r\") as read_file:\n...     data = json.load(read_file)\n...\n&gt;&gt;&gt; type(data)\n&lt;class 'dict'&gt;\n</code></pre>","tags":["json"]},{"location":"blog/20191206/9-json/#requests","title":"requests","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 requests post \u53d1\u9001\u548c\u63a5\u6536json\u7684\u4ee3\u7801\u7247\u6bb5\uff1a</p> <pre><code>import requests\nimport json\n\nheaders = {'Content-Type': 'application/json'}\ncontent = {\"no\": 1, \"name\": \"W3CSchool\", \"url\": \"http://www.w3cschool.cn\"}\npayload = {\n  'msgtype': 'markdown',\n  'markdown': {\n    'content': json.dumps(content)\n  }\n}\nrsp = requests.request(\"POST\", robot_url, headers=headers, json=payload)\nrspJson = json.loads(rsp.text)  # rsp.json()\nprint('push_alarm rsp:', rspJson)\nif rspJson['errcode'] != 0 or rsp.status_code != 200:\n    print(f\"\u53d1\u9001\u63d0\u9192\u6d88\u606f\u5931\u8d25 \u63a5\u53e3\u72b6\u6001\u7801{rsp.status_code}\"\n          f\"code: {rspJson['errcode']}\"\n          f\"msg: {rspJson['errmsg']}\")\n</code></pre>","tags":["json"]},{"location":"blog/20191206/9-json/#jsontool","title":"json.tool","text":"<p>\u5bf9\u4e8e\u538b\u7f29/\u8f6c\u4e49\u7684 JSON \u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u5728\u4ee5\u4e0b\u7f51\u7ad9\u8fdb\u884c\u683c\u5f0f\u5316\u6216\u89e3\u6790\u8f6c\u6362\u3002</p> <ul> <li>JSON\u5728\u7ebf\u89e3\u6790\u53ca\u683c\u5f0f\u5316\u9a8c\u8bc1\uff1a\u652f\u6301\u5728\u7ebf\u89e3\u6790\u548c\u538b\u7f29\u8f6c\u4e49\u3002</li> <li>JSON\u89e3\u6790\u683c\u5f0f\u5316\u5de5\u5177\uff1a\u652f\u6301\u6821\u9a8c/\u683c\u5f0f\u5316\u3001\u538b\u7f29/\u8f6c\u4e49\u3002</li> <li>JSON\u683c\u5f0f\u5316\u67e5\u770b\u5de5\u5177\uff1a\u652f\u6301\u5bf9 JSON \u8fdb\u884c\u538b\u7f29\uff0c\u4ee5\u53ca\u5bf9\u538b\u7f29\uff08\u8f6c\u4e49\uff09\u7684JSON\u5b57\u7b26\u4e32\u8fdb\u884c\u8fd8\u539f\u3002</li> </ul> <p>macOS/Linux \u4e0b\u8fd8\u53ef\u4ee5\u5b89\u88c5 <code>jq</code> \u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5c06\u538b\u7f29/\u8f6c\u4e49\u7684json\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u683c\u5f0f\u5316\u7684 JSON \u5bf9\u8c61\u3002</p> <p>jq is a lightweight and flexible command-line JSON processor.</p> <p>Using <code>json.tool</code> from the shell to validate and pretty-print:</p> <pre><code>$ echo '{\"json\":\"obj\"}' | python3 -m json.tool\n{\n    \"json\": \"obj\"\n}\n</code></pre>","tags":["json"]},{"location":"blog/20191201/1-mac-run-python3/","title":"macOS\u4e0b\u5b89\u88c5\u8fd0\u884cpython3","text":"<p>macOS \u4e0b\u4f7f\u7528 brew \u5b89\u88c5 python3 \u4ee5\u53ca\u4f7f\u7528\u7b80\u4ecb\u3002</p>"},{"location":"blog/20191201/1-mac-run-python3/#brew_\u5b89\u88c5_python3","title":"brew \u5b89\u88c5 Python3","text":""},{"location":"blog/20191201/1-mac-run-python3/#brew_search_python3","title":"brew search python3","text":"<p>\u5728 macOS \u7ec8\u7aef\u8f93\u5165 <code>brew search python3</code> \u5373\u53ef\u641c\u7d22 Python3 \u5b89\u88c5\u5305\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  brew search python3\n==&gt; Searching local taps...\npython3 \u2714\n==&gt; Searching taps on GitHub...\n</code></pre>"},{"location":"blog/20191201/1-mac-run-python3/#brew_info_python3","title":"brew info python3","text":"<p>\u5728 macOS \u7ec8\u7aef\u8f93\u5165 <code>brew info python3</code> \u5373\u53ef\u67e5\u8be2 Python3 \u5b89\u88c5\u5305\u4fe1\u606f\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  brew info python3\npython3: stable 3.6.3 (bottled), devel 3.7.0a1, HEAD\nInterpreted, interactive, object-oriented programming language\nhttps://www.python.org/\nNot installed\n</code></pre>"},{"location":"blog/20191201/1-mac-run-python3/#brew_install_python3","title":"brew install python3","text":"<p>\u5728 macOS \u7ec8\u7aef\u8f93\u5165 <code>brew install python3</code> \u5373\u53ef\u5b89\u88c5 Python3\u3002</p>"},{"location":"blog/20191201/1-mac-run-python3/#\u4f7f\u7528_python3","title":"\u4f7f\u7528 python3","text":""},{"location":"blog/20191201/1-mac-run-python3/#python3_--version","title":"python3 --version","text":"<p>\u6267\u884c <code>python -V</code>\uff08<code>python --version</code>\uff09\u67e5\u770b macOS/Xcode \u81ea\u5e26\u7684 python2 \u7684\u7248\u672c\u53f7\u3002 \u5b89\u88c5 python3 \u540e\uff0c\u6267\u884c <code>python3 -V</code>\uff08<code>python3 --version</code>\uff09\u53ef\u67e5\u770b\u5b89\u88c5\u7684 python3  \u7684\u7248\u672c\u53f7\u3002  </p> <pre><code>faner@FAN-MB0:~|\u21d2  python -V\nPython 2.7.10\nfaner@FAN-MB0:~|\u21d2  which python\n/usr/bin/python\nfaner@FAN-MB0:~|\u21d2  whereis python\n/usr/bin/python\n\nfaner@FAN-MB0:~|\u21d2  python3 --version\nPython 3.6.3\nfaner@FAN-MB0:~|\u21d2  which python3\n/usr/local/bin/python3\n</code></pre> <p>raspbian \u9ed8\u8ba4\u5df2\u7ecf\u5b89\u88c5\u4e86 python2 \u548c python3\uff1a</p> <pre><code>pi@raspberrypi:~ $ python --version\nPython 2.7.13\npi@raspberrypi:~ $ which python\n/usr/bin/python\n\npi@raspberrypi:~ $ python3 -V\nPython 3.5.3\npi@raspberrypi:~ $ which python3\n/usr/bin/python3\n</code></pre> <p>python\u548cnumpy\u7684\u7248\u672c\u3001\u5b89\u88c5\u4f4d\u7f6e </p>"},{"location":"blog/20191201/1-mac-run-python3/#python3_orignial","title":"python3 Orignial","text":"<p>macOS \u901a\u8fc7 brew \u5b89\u88c5\u7684 python3 \u9ed8\u8ba4\u5728 <code>/usr/local/Cellar/python3/</code> \u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u8f6f\u94fe\uff08symlink\uff09\u5230 <code>/usr/local/bin/</code> \u76ee\u5f55\u4e0b\u3002</p> <pre><code>faner@FAN-MB0:~|\u21d2  echo $PATH\n/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin\n</code></pre> <p>\u901a\u8fc7 <code>ls -l</code> \u547d\u4ee4\u53ef\u663e\u793a python3 \u7684\u539f\u8eab\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  ls -al /usr/local/bin/python3\nlrwxr-xr-x  1 faner  admin  35 Nov  3 08:09 /usr/local/bin/python3 -&gt; ../Cellar/python3/3.6.3/bin/python3\n</code></pre> <p>\u8fdb\u4e00\u6b65\u901a\u8fc7 <code>ls -l</code> \u547d\u4ee4\u67e5\u627e  python3  \u7684\u7ec8\u6781\u539f\u8eab\uff1a</p> <pre><code>faner@FAN-MB0:~|\u21d2  ls -al /usr/local/Cellar/python3/3.6.3/bin/python3 \nlrwxr-xr-x  1 faner  admin  55 Nov  3 08:09 /usr/local/Cellar/python3/3.6.3/bin/python3 -&gt; ../Frameworks/Python.framework/Versions/3.6/bin/python3\n</code></pre>"},{"location":"blog/20191201/1-mac-run-python3/#hello_world_from_python3","title":"Hello World from Python3","text":"<p>\u65b0\u5b89\u88c5\u7684 Python3 \u4e0e\u7cfb\u7edf\u81ea\u5e26\u7684\u65e7\u7248 Python2 \u5e76\u5b58\uff0c\u4f7f\u7528\u65f6\u6307\u660e\u7248\u672c\u53f7\u5373\u53ef\u3002</p> <p>\u5728\u5b89\u88c5\u5e76\u914d\u7f6e\u597d\u73af\u5883\u53d8\u91cf\u7684\u7cfb\u7edf\u7ec8\u7aef\u4e2d\u8f93\u5165 <code>python</code> \u9ed8\u8ba4\u8fdb\u5165 python2 \u7684\u547d\u4ee4\u884c\u7f16\u8f91\u4ea4\u4e92\u63a7\u5236\u53f0\u3002\u82e5\u663e\u5f0f\u6307\u5b9a <code>python3</code>\uff08\u6216 python3.6\uff09\uff0c\u5219\u53ef\u542f\u52a8\u8fd0\u884c\u7248\u672c 3\u3002</p> <p>The interpreter\u2019s line-editing features include interactive editing, history substitution and code completion on systems that support readline.  </p> <p>The interpreter operates somewhat like the Unix shell: when called with standard input connected to a tty device, it reads and executes commands interactively; when called with a file name argument or with a file as standard input, it reads and executes a script from that file.  </p> <p>python shell \u524d\u5bfc\u7b26\uff08primary prompt\uff09\u4e3a3\u4e2a\u5927\u4e8e\u53f7 <code>&gt;&gt;&gt;</code>\uff08\u7c7b\u4f3c bash shell \u7684 $\uff09\uff0c\u7b49\u5f85\u8f93\u5165 python \u547d\u4ee4\u3002  </p> <pre><code>&gt;&gt;&gt; import sys\n\n# primary prompts\n&gt;&gt;&gt; sys.ps1\n'&gt;&gt;&gt; '\n\n# secondary prompts\n&gt;&gt;&gt; sys.ps2\n'... '\n</code></pre> <p>\u5728 python(2) \u4e0b\u8f93\u5165 <code>&gt;&gt;&gt; print \"Hello World from Python2\"</code>\uff0c\u5728 python3 \u4e0b\u8f93\u5165 <code>&gt;&gt;&gt; print(\"Hello World from Python3\")</code> \u53ef\u6253\u5370 <code>Hello World from Python*</code>\u3002</p> <pre><code>faner@FAN-MB0:~|\u21d2  python\nPython 2.7.10 (default, Feb  7 2017, 00:08:15) \n[GCC 4.2.1 Compatible Apple LLVM 8.0.0 (clang-800.0.34)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; print \"Hello World from Python2\"\nHello World from Python2\n&gt;&gt;&gt; ^D\n\nfaner@FAN-MB0:~|\u21d2  python3\nPython 3.6.3 (default, Nov  3 2017, 08:08:42) \n[GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.35)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; print \"Hello World from Python3\"\n  File \"&lt;stdin&gt;\", line 1\n    print \"Hello World from Python3\"\n                                   ^\nSyntaxError: Missing parentheses in call to 'print'. Did you mean print(\"Hello World from Python3\")?\n&gt;&gt;&gt; print (\"Hello World from Python3\")\nHello World from Python3\n&gt;&gt;&gt;  \n</code></pre> <p>python3 XXX.py \u6307\u5b9a python3 \u6267\u884c py \u811a\u672c\u6587\u4ef6\u3002</p>"},{"location":"blog/20191201/1-mac-run-python3/#multi_line_input","title":"multi line input","text":"<p>\u5f53\u8f93\u5165 <code>(</code>,<code>[</code>,<code>{</code>\uff0c\u5c1a\u672a\u5b9a\u4e49\u5b8c\u65f6\uff0c\u89e3\u6790\u5668\u4f1a\u81ea\u52a8\u63a5\u53d7\u7eed\u884c\u8f93\u5165\u3002</p> <pre><code>&gt;&gt;&gt; str1=('hello'\n... 'world')\n&gt;&gt;&gt; str1\n'helloworld'\n\n&gt;&gt;&gt; list1=[1,3,5,\n... 7,9,11]\n\n&gt;&gt;&gt; tuple1=(1,4,9,\n... 16,25,36)\n\n&gt;&gt;&gt; set1={2,4,6,\n... 8,10,12}\n\n&gt;&gt;&gt; exit(\n... )\n</code></pre> <p>\u5982\u679c\u4e00\u884c\u8f93\u5165\u4e0d\u4e0b\uff0c\u53ef\u4ee5\u8f93\u5165\u53cd\u659c\u6760 \\\uff0c\u65b0\u8d77\u7eed\u822a\u4e66\u5199\u3002</p> <pre><code>&gt;&gt;&gt; hello = 'Hello World \\\n... from Python3'\n&gt;&gt;&gt; print(hello)\nHello World from Python3\n&gt;&gt;&gt; \n</code></pre> <p>\u4e09\u5f15\u53f7\uff08<code>'''</code>\uff09\u5f00\u5934\u7ed3\u5c3e\u7684\u8f93\u5165\uff0c\u4e2d\u95f4\u652f\u6301\u6362\u884c\u8f93\u5165\uff1a</p> <pre><code>&gt;&gt;&gt; hello = '''Hello\n... World\n... from\n... Python3'''\n&gt;&gt;&gt; print(hello)\nHello\nWorld\nfrom\nPython3\n</code></pre> <p>\u4ee5\u4e0a\u6bcf\u884c\u5c3e\u90e8\u52a0\u53cd\u659c\u6760 \\ \u793a\u610f\u7eed\u884c\uff0c\u9632\u6b62\u5206\u884c\uff1a</p> <pre><code>&gt;&gt;&gt; hello = '''Hello \\\n... World \\\n... from \\\n... Python3'''\n&gt;&gt;&gt; print(hello)\nHello World from Python3\n</code></pre>"},{"location":"blog/20191201/1-mac-run-python3/#comment","title":"comment","text":"<p>python \u63a7\u5236\u53f0\u53ca\u811a\u672c\u4e2d\u5747\u652f\u6301\u5f00\u5934\u6216\u8bed\u53e5\u5c3e\u90e8\u4ee5 <code>#</code> \u5f00\u59cb\u7684\u6ce8\u91ca\u3002</p> <pre><code>&gt;&gt;&gt; #comment\n... test='test'\n&gt;&gt;&gt; test\n'test'\n\n&gt;&gt;&gt; test='hello' #comment\n&gt;&gt;&gt; test\n'hello'\n</code></pre>"},{"location":"blog/20191201/1-mac-run-python3/#quitexit","title":"quit/exit","text":"<p>\u6309\u4e0b <code>&lt;C-d&gt;</code>\uff08windows \u4e0b\u4e3a <code>&lt;C-z&gt;</code>\uff09\u6216\u8f93\u5165 <code>quit()</code>/<code>exit()</code> \u5373\u53ef\u9000\u51fa python shell\uff0c\u9000\u56de\u5230\u7cfb\u7edf shell\u3002</p> <p>Typing an end-of-file character (<code>Control-D</code> on Unix, <code>Control-Z</code> on Windows) at the primary prompt causes the interpreter to exit with a zero exit status. If that doesn\u2019t work, you can exit the interpreter by typing the following command: <code>quit()</code>.</p>"},{"location":"blog/20191201/1-mac-run-python3/#default_python3","title":"default python3","text":"<p>\u5982\u679c\u60f3\u8f93\u5165 python \u9ed8\u8ba4\u542f\u52a8 python3\uff0c\u53ef\u4ee5\u5728 bash \u914d\u7f6e\u6587\u4ef6\u4e2d <code>~/.bash_profile</code> \u6216 <code>~/.bashrc</code> \u589e\u52a0 alias \u5c06 python \u6307\u5411 Python3\uff1a</p> <pre><code>alias python=\"/usr/local/Cellar/python3/3.6.3/Frameworks/Python.framework/Versions/3.6/bin/python3.6\"\n</code></pre> <p>\u6216</p> <pre><code>alias python=\"python3.6\"\n</code></pre>"},{"location":"blog/20191201/1-mac-run-python3/#\u5e9f\u5f03_python_27","title":"\u5e9f\u5f03 Python 2.7","text":"<p>macOS \u4e0a\u5982\u4f55\u5207\u6362\u9ed8\u8ba4\u7684 Python \u7248\u672c\uff1f macOS \u4e0a\u6700\u7b80\u5355\u914d\u7f6epython3\u5f00\u53d1\u73af\u5883 macOS \u4e0a\u4e0d\u5378\u8f7d\u81ea\u5e26\u7684 Python2 \u5982\u4f55\u4f7f\u7528 Python3 macOS \u6b63\u786e\u5730\u540c\u65f6\u5b89\u88c5Python 2.7 \u548c Python3 </p> <p>macOS \u4e0a\u5b89\u88c5python\u73af\u5883 macOS \u5b89\u88c5 Python3 \u53ca \u521d\u4f53\u9a8c macOS \u5b89\u88c5 Python3 \u4ee5\u53ca\u95ee\u9898\u603b\u7ed3\uff1aPython3 / Python3.5 </p>"},{"location":"blog/20191201/1-mac-run-python3/#2x_\u5347\u7ea7\u4e3a_3x","title":"2.x \u5347\u7ea7\u4e3a 3.x","text":"<p>\u5982\u4f55\u5c06 Mac OS X 10.9 \u4e0b\u7684Python 2.7\u5347\u7ea7\u5230\u6700\u65b0\u7248\u7684 Python 3.3 \u5347\u7ea7MAC OS X \u4e0a\u7684 Python \u5230\u6700\u65b0\u7248 3.4 macOS \u4e0a Python \u4ece2.x\u5347\u7ea7\u52303.x\u7684\u8270\u82e6\u5386\u7a0b </p> <p>Mac\u4e0b\u81ea\u5e26Python\u5b89\u88c5Tensorflow\u7684\u95ee\u9898</p>"},{"location":"blog/20191201/1-mac-run-python3/#compatibility","title":"compatibility","text":"<p>six - docs </p> <pre><code>pi@raspberrypi:~ $ pip3 show six\nName: six\nVersion: 1.10.0\nSummary: Python 2 and 3 compatibility utilities\nHome-page: http://pypi.python.org/pypi/six/\nAuthor: Benjamin Peterson\nAuthor-email: benjamin@python.org\nLicense: MIT\nLocation: /usr/lib/python3/dist-packages\nRequires: \n</code></pre>"},{"location":"blog/20191201/1-mac-run-python3/#removal","title":"removal","text":"<p>How to remove python 2.7 from MacBook Pro 14? - Apple Community</p> <p>Apple Finally Removing Python 2 in macOS 12.3 - MacRumors</p> <p>Apple removing Python 2.7 on Mac - What does this mean for IT admins?</p> <p>Back in 2019, Apple announced its plans to deprecate the Python 2.7 scripting language. With the release of macOS Monterey, Apple made good on that promise. macOS devices that are on versions 12.3 and above will no longer be able to execute scripts and operations that run on Python 2.7.</p> <p>But what about apps and scripts that use the Python 3 runtime? Here too, users may encounter a slight hiccup. At least, during the first run.</p> <p>Python 3 does not come automatically installed on macOS devices (even on those above versions 12.3). Hence, if the user tries to run a software, app, or script that calls on Python 3, a notification is triggered, which prompts the user to install XCode and developer tools.</p>"},{"location":"blog/20191201/1-mac-run-python3/#alias","title":"alias","text":"<p>\u5982\u679cpy\u811a\u672c\u5f00\u5934\u6ca1\u6709\u6307\u5b9a Shebang - <code>#!/usr/bin/env python3</code>\uff0c\u5219 vscode Run Code \u6267\u884c <code>python -u test.py</code>\uff0c\u53ef\u80fd\u63d0\u793a\u627e\u4e0d\u5230 python \u547d\u4ee4\u3002</p> <p>macOS \u81ea Monterey\uff08April 2022\uff09\u540e\u79fb\u9664\u4e86 Python 2.7\u3002</p> <p>macOS \u5728\u5b89\u88c5 Xcode command-lines tools \u65f6\u4f1a\u5b89\u88c5 Python3\uff0c\u9ed8\u8ba4\u8def\u5f84\u4e3a <code>/usr/bin/python3</code>\uff0c\u800c\u4f7f\u7528 brew \u5b89\u88c5\u7684 python3 \u7684\u8def\u5f84\u4e00\u822c\u4e3a /usr/local/bin/python3\u3002 \u65e2\u7136 python\uff082.7\uff09\u4e0d\u518d\uff0c\u53ef\u8003\u8651\u5728 ~/.zshrc \u4e2d\u6dfb\u52a0 <code>alias python=/usr/bin/python3</code>\uff0c\u8fd9\u6837 python \u6307\u5411\u7cfb\u7edf\u81ea\u5e26\u7684 python3 \u7248\u672c\uff0c\u4f5c\u4e3a fallback\u3002</p>"},{"location":"blog/20191201/2-vscode-run-python/","title":"vscode\u8fd0\u884cpython3","text":"<p>vscode \u4e2d\u8fd0\u884c\u8c03\u8bd5 python3 \u7b80\u4ecb\u3002</p> <p>Python in VS Code</p> <ul> <li>Tutorial - Getting Started with Python in VS Code </li> <li>Environments - Using Python environments in VS Code </li> </ul> <p>Python in Visual Studio Code</p> <ul> <li>Editing Code </li> <li>Linting </li> <li>Debugging </li> </ul>","tags":["vscode"]},{"location":"blog/20191201/2-vscode-run-python/#vscode__python","title":"vscode + python","text":"<p>vscode-python</p> <p>\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u4e86 Python \u63d2\u4ef6\uff08\u5185\u5d4c Jupyter \u63d2\u4ef6\uff09\uff1a</p> <ol> <li> <p><code>Python</code>: IntelliSense (Pylance), Linting, Debugging (multi-threaded, remote), Jupyter Notebooks, code formatting, refactoring, unit tests, and more.</p> <ul> <li>Extension Pack: <code>Pylance</code>, <code>Jupyter</code> and <code>isort</code>.</li> </ul> </li> <li> <p><code>Jupyter</code>: Jupyter notebook support, interactive programming and computing that supports Intellisense, debugging and more.</p> <ul> <li>Extension Pack: <code>Jupyter Keymap</code>, <code>Jupyter Notebook Renderers</code>, <code>Jupyter Slide Show</code>, <code>Jupyter Cell Tags</code>.</li> </ul> </li> </ol> <p>vscode\u4e0a\u914d\u7f6epython\u7684\u8fd0\u884c\u73af\u5883 \u90a3\u4e9b\u4f7f\u7528VSCode\u5199Python\u8e29\u8fc7\u7684\u5751(Anaconda\u914d\u7f6e) </p>","tags":["vscode"]},{"location":"blog/20191201/2-vscode-run-python/#interpreter","title":"interpreter","text":"<p>Select a Python interpreter</p> <p></p> <ol> <li><code>Recommended</code> \u4e3a vscode settings \u4e2d\u914d\u7f6e\u7684 defaultInterpreterPath\u3002</li> <li>\u5f53\u5728 vscode settings \u4e2d\u914d\u7f6e\u4e86 CondaPath\uff0c\u4f1a\u5728\u6b64\u5904\u51fa\u73b0 <code>Conda</code> \u5b50\u73af\u5883\u7684\u89e3\u91ca\u5668\u7248\u672c\u3002</li> <li><code>Global</code> \u4e3a homebrew \u5b89\u88c5\uff08/usr/local/bin/python3\uff09\u548c macOS \u81ea\u5e26\u7684\uff08usr/bin/python3\uff09\u3002</li> </ol> <p>Global \u4e0b\u53ef\u80fd\u51fa\u73b0 brew \u5b89\u88c5\u7684\u591a\u4e2a\u7248\u672c\u4f9b\u9009\u62e9\u3002</p>","tags":["vscode"]},{"location":"blog/20191201/2-vscode-run-python/#run_debug","title":"run debug","text":"<p>vscode \u6253\u5f00\u666e\u901a Python File\uff08\u4f8b\u5982code.py\uff09\uff0c\u53ef\u4ee5\u6709\u4ee5\u4e0b\u8fd0\u884c\u65b9\u5f0f\uff1a</p> <ol> <li> <p><code>\u21e7\u2318P</code> \u8c03\u8d77 Command Palette\uff0c\u8f93\u5165 <code>Run</code>\uff0c\u53ef\u6267\u884c Run Code \u6216 Python: Run Python File in Terminal\u3002</p> <ul> <li>\u5982\u679cpy\u811a\u672c\u5f00\u5934\u6ca1\u6709\u6307\u5b9a Shebang - <code>#!/usr/bin/env python3</code>\uff0c\u5219\u6267\u884c <code>/usr/bin/env python3 code.py</code>\uff1b\u5426\u5219\uff0c\u5c06\u6267\u884c <code>python -u code.py</code>\u3002</li> </ul> </li> <li> <p>\u53ef\u5728\u53f3\u4e0a\u89d2 \u25b6\ufe0e \u6309\u94ae\u4e0b\u62c9\u9009\u62e9\u8fd0\u884c\u65b9\u5f0f\uff1aRun Python File, Run Python File in Dedicated Terminal \u5c06\u91c7\u7528 Python: Select Interpreter \u4e2d\u9009\u5b9a\u7684python\u7248\u672c\u6267\u884c\u811a\u672c\u3002</p> <ul> <li>\u4f8b\u5982\uff1a<code>/usr/local/bin/python3.9 code.py</code></li> </ul> </li> </ol> <p>\u5728 vscode \u4e2d\u6253\u5f00 Python \u811a\u672c\u6587\u4ef6(test.py)\uff0c\u5728\u6587\u672c\u7f16\u8f91\u533a\u5de6\u4fa7 gutter \u4e0a\u70b9\u51fb\u4e0b\u65ad\u70b9\u3002</p> <p>\u8c03\u8bd5\uff08Debug\uff09\u4e5f\u53ef\u4ece\u591a\u4e2a\u5165\u53e3\u53d1\u8d77\uff1a</p> <ol> <li><code>\u21e7\u2318P</code> \u8c03\u8d77 Command Palette\uff0c\u8f93\u5165 <code>Debug</code>\uff0c\u9009\u62e9 Debug: Start Debugging \u9009\u62e9 Python Debugger\u3002</li> <li>\u53ef\u5728\u53f3\u4e0a\u89d2 \u25b6\ufe0e \u6309\u94ae\u4e0b\u62c9\u9009\u62e9 <code>Python Debugger: Debug Python File</code> \u542f\u52a8\u8c03\u8bd5\u3002</li> <li>\u5728\u5de6\u4fa7\u6d4f\u89c8\u5668\u9762\u677f\u4e2d\u70b9\u51fb Run and Debug\uff0c\u4e5f\u8d77\u53d1\u8d77\u8c03\u8bd5\u3002</li> </ol> <p>\u542f\u52a8\u8c03\u8bd5\u8fd0\u884c\u8d77\u6765\u540e\uff0c\u547d\u4e2d\u65ad\u70b9\u4e2d\u65ad\uff0c\u53f3\u4fa7\u4f1a\u6709\u4e00\u4e2a\u60ac\u6d6e\u7684\u8c03\u8bd5\u5de5\u5177\u6761\uff0c\u652f\u6301 Continue\u3001Step Over/Into/Out\u3002 \u540c\u65f6\uff0c\u5de6\u4fa7\u4fa7\u8fb9\u62c9\u4f1a\u6253\u5f00 Run and Debug\uff0c\u5176\u4e2d\u53ef\u4ee5\u67e5\u770b Variables\uff08Locals, Globals\uff09\u3001Watch \u548c CallStack\u3002</p> <p>\u53c2\u8003\uff1a</p> <ul> <li>Quick Start - UI tour\u3002</li> <li>Quick Start - Run, debug, and test</li> </ul>","tags":["vscode"]},{"location":"blog/20191201/2-vscode-run-python/#vscode__conda","title":"vscode + conda","text":"<p>Anaconda \u914d\u5408 VSCode \u53ef\u4ee5\u642d\u5efa\u4e00\u4e2a\u9002\u7528\u4e8e\u673a\u5668\u5b66\u4e60\u3001AI\u3001\u6570\u636e\u79d1\u5b66\u9886\u57df\u5b66\u4e60\u4e0e\u5f00\u53d1\u7684 Python \u5f00\u53d1\u73af\u5883\u3002</p>","tags":["vscode"]},{"location":"blog/20191201/2-vscode-run-python/#condapath","title":"condaPath","text":"<pre><code>  // Path to the conda executable to use for activation (version 4.4+).\n  \"python.condaPath\": \"/usr/local/anaconda3/condabin/conda\",\n</code></pre> <p>Remove python.condaPath from workspace scope #17819 python.condaPath not considered when calling conda #9154</p> <p>\u914d\u7f6e\u4e86 <code>python.condaPath</code> \u4e4b\u540e\uff0c\u8fd0\u884c\u547d\u4ee4 Python: Select Interpreter \u4e0b\u62c9\u5217\u8868\u4e2d\u5c06\u4f1a\u663e\u793a conda base \u73af\u5883\u7684 python\u3002</p>","tags":["vscode"]},{"location":"blog/20191201/2-vscode-run-python/#pythonpath","title":"pythonPath","text":"<p>Activating Anaconda Environment in VsCode</p> <p>\u5feb\u6377\u952e <code>cmd+,</code> \u6253\u5f00 vscode \u504f\u597d\u8bbe\u7f6e\uff0c\u7f16\u8f91\u4fee\u6539\uff08<code>~/Library/Application Support/Code/User/settings.json</code>\uff09\uff0c\u627e\u5230\u5982\u4e0b\u4e24\u4e2a\u53c2\u6570\uff1a</p> <ol> <li>python.pythonPath\uff08\u73b0\u5df2\u53d8\u66f4\u4e3a <code>defaultInterpreterPath</code>\uff09\uff1b  </li> <li>python.autoComplete.extraPaths\uff1b  </li> </ol> <p>\u4fee\u6539\u4e3a conda \u5b50\u73af\u5883\u4e0b\u5bf9\u5e94\u7684 bin/python \u548c side-packages\uff1a</p> <p>Finding your Anaconda Python interpreter path</p> <pre><code># \u8bbe\u7f6e base \u73af\u5883\n    \"python.defaultInterpreterPath\": \"/usr/local/anaconda3/bin/python3\",\n    \"python.autoComplete.extraPaths\": [\"/usr/local/anaconda3/lib/python3.9/site-packages\"],\n</code></pre> <pre><code># \u8bbe\u7f6e Py376 \u73af\u5883\n    \"python.defaultInterpreterPath\": \"/usr/local/anaconda3/envs/Py376/bin/python3\",\n    \"python.autoComplete.extraPaths\": [\"/usr/local/anaconda3/envs/Py376/lib/python3.7/site-packages\"],\n</code></pre>","tags":["vscode"]},{"location":"blog/20191201/2-vscode-run-python/#refs","title":"refs","text":"<p>\u642d\u5efa Python \u8f7b\u91cf\u7ea7\u7f16\u5199\u73af\u5883\uff08Anaconda+VSCode\uff09 Working with Anaconda in Visual Studio Code </p> <p>Anaconda+VSCode\u642d\u5efapython\u73af\u5883 - Windows Anaconda\uff0bVSCode\u642d\u5efapython\u5f00\u53d1\u73af\u5883 - Windows windows10\u73af\u5883\u4e0b\u7528anaconda\u548cVScode\u914d\u7f6e </p> <p>MacOS\u4e0b\u5982\u4f55\u914d\u7f6eVscode+Anaconda\u5462\uff1f mac vscode\u914d\u7f6e anaconda \u865a\u62df\u73af\u5883 Mac+Anaconda+PyCharm+VSCode\u73af\u5883\u642d\u5efa </p>","tags":["vscode"]},{"location":"blog/20191201/3-python-help/","title":"python\u5e2e\u52a9\u6307\u5357","text":"<p>\u672c\u6587\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528 python \u81ea\u5e26\u7684\u5e2e\u52a9\u51fd\u6570\u548c\u5e2e\u52a9\u7cfb\u7edf\u3002</p>","tags":["help"]},{"location":"blog/20191201/3-python-help/#docs","title":"Docs","text":"<p>Python Docs</p> <p>Python 3.x Docs </p> <ul> <li>Glossary</li> <li>The Python Language Reference</li> <li>The Python Standard Library</li> <li>The Python Tutorial</li> <li>Python HOWTOs</li> </ul> <p>Python Developer\u2019s Guide </p> <p>\u67e5\u770bpython\u7684\u6a21\u5757\u548c\u51fd\u6570\u5e2e\u52a9\u6587\u6863\u65b9\u6cd5 </p>","tags":["help"]},{"location":"blog/20191201/3-python-help/#help","title":"help","text":"<p>help</p> <pre><code>&gt;&gt;&gt; help\nType help() for interactive help, or help(object) for help about object.\n</code></pre> <p>Invoke the built-in help system. (This function is intended for interactive use.) </p> <ul> <li>If no argument is given, the interactive help system starts on the interpreter console.  </li> <li>If the argument is a string, then the string is looked up as the name of a module, function, class, method, keyword, or documentation topic, and a help page is printed on the console.  </li> <li>If the argument is any other kind of object, a help page on the object is generated.  </li> </ul>","tags":["help"]},{"location":"blog/20191201/3-python-help/#helpobject","title":"help(object)","text":"<p>\u8c03\u7528 <code>help('modules')</code> \u53ef\u4ee5\u5217\u51fa\u5f53\u524d\u6240\u6709\u5df2\u5b89\u88c5\u7684\u6a21\u5757\uff1a</p> <pre><code>&gt;&gt;&gt; help(modules)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nNameError: name 'modules' is not defined\n\n&gt;&gt;&gt; help('modules')\n\nPlease wait a moment while I gather a list of all available modules...\n</code></pre> <p>\u5728 REPL \u4e2d\u8f93\u5165 <code>import module</code> \u5bfc\u5165\u6a21\u5757 module \u540e\uff0c\u53ef\u8c03\u7528 <code>help(module)</code> \u67e5\u770b\u6a21\u5757\u5e2e\u52a9\uff1a</p> <ol> <li>\u8c03\u7528  <code>help(module.function)</code> \u67e5\u770b module \u7684\u9759\u6001\u51fd\u6570 function \u7684\u5e2e\u52a9\u3002  </li> <li>\u8c03\u7528  <code>help(module.class)</code> \u67e5\u770b module \u7684\u7c7b class \u5e2e\u52a9\u3002  </li> <li>\u8c03\u7528  <code>help(module.class.method)</code> \u67e5\u770b module \u7684\u7c7b class \u6210\u5458\u51fd\u6570 function \u5e2e\u52a9\u3002  </li> </ol> <p>\u5bf9\u4e8e\u5185\u7f6e\u7684 builtins \u6a21\u5757\uff0c\u4ee5\u4e0a\u4e09\u6b65\u53ef\u7701\u6389 module \u524d\u7f00\uff1a</p> <pre><code># \u67e5\u770b builtins \u5185\u5efa\u7684 print \u51fd\u6570\u5e2e\u52a9\n&gt;&gt;&gt; help(print)\n\nHelp on built-in function print in module builtins:\n\n# \u67e5\u770b builtins \u5185\u5efa\u7684 len \u51fd\u6570\u5e2e\u52a9\n&gt;&gt;&gt; help(len)\n\nHelp on built-in function len in module builtins:\n\nlen(obj, /)\n    Return the number of items in a container.\n\n# \u67e5\u770b builtins \u5185\u5efa\u7684 str \u7c7b\u5e2e\u52a9\n&gt;&gt;&gt; help(str)\n\nHelp on class str in module builtins:\n\n# \u67e5\u770b builtins \u5185\u5efa\u7684 int \u7c7b\u5e2e\u52a9\n&gt;&gt;&gt; help(int)\n\nHelp on class int in module builtins:\n\nclass int(object)\n\n# \u67e5\u770b builtins \u5185\u5efa\u7684 list \u7c7b\u5e2e\u52a9\n&gt;&gt;&gt; help(list)\n\nHelp on class list in module builtins:\n\nclass list(object)\n |  list() -&gt; new empty list\n |  list(iterable) -&gt; new list initialized from iterable's items\n |  \n\n# \u67e5\u770b builtins \u5185\u5efa\u7684 set \u7c7b\u5e2e\u52a9\n&gt;&gt;&gt; help(set)\n\nHelp on class set in module builtins:\n\nclass set(object)\n |  set() -&gt; new empty set object\n |  set(iterable) -&gt; new set object\n |  \n |  Build an unordered collection of unique elements.\n\n# \u67e5\u770b builtins \u5185\u5efa\u7684 set \u7c7b\u5e2e\u52a9\n&gt;&gt;&gt; help(dict)\n\nHelp on class dict in module builtins:\n\nclass dict(object)\n |  dict() -&gt; new empty dictionary\n</code></pre>","tags":["help"]},{"location":"blog/20191201/3-python-help/#import_then_help","title":"import then help","text":"<p>\u82e5\u60f3\u8c03\u7528 <code>help(module)</code> \u67e5\u770b builtins \u6a21\u5757\u6216\u5176\u4ed6\u6a21\u5757\u5e2e\u52a9\u53ca\u8bf4\u660e\uff0c\u8fd8\u5f97\u5148\u663e\u5f0f import \u5bfc\u5165\u6a21\u5757\u3002</p> <pre><code>&gt;&gt;&gt; # help(builtins)\n&gt;&gt;&gt; help(builtins)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nNameError: name 'builtins' is not defined\n&gt;&gt;&gt; # \u5148 import \u518d help\n&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; help(builtins)\n\nHelp on built-in module builtins:\n\nNAME\n    builtins - Built-in functions, exceptions, and other objects.\n</code></pre>","tags":["help"]},{"location":"blog/20191201/3-python-help/#str","title":"str","text":"<pre><code>&gt;&gt;&gt; # \u67e5\u770b builtins.str \u7c7b\u7684 docstring\n&gt;&gt;&gt; print(str.__doc__) # help(str) \u7684\u9996\u90e8\u6982\u8ff0\nstr(object='') -&gt; str\nstr(bytes_or_buffer[, encoding[, errors]]) -&gt; str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer\nthat will be decoded using the given encoding and error handler.\nOtherwise, returns the result of object.__str__() (if defined)\nor repr(object).\nencoding defaults to sys.getdefaultencoding().\nerrors defaults to 'strict'.\n</code></pre> <p>\u67e5\u770b\u5185\u7f6e\u6a21\u5757\u7684 <code>str</code> \u7c7b\u7684 startswith \u51fd\u6570\uff1a</p> <pre><code>&gt;&gt;&gt; # \u67e5\u770b builtins \u6a21\u5757\u7684\u7c7b str \u7684 startswith \u51fd\u6570\u5e2e\u52a9\n&gt;&gt;&gt; help(str.startswith) #print(str.startswith.__doc__)\nHelp on method_descriptor:\n\nstartswith(...)\n    S.startswith(prefix[, start[, end]]) -&gt; bool\n\n    Return True if S starts with the specified prefix, False otherwise.\n    With optional start, test S beginning at that position.\n    With optional end, stop comparing S at that position.\n    prefix can also be a tuple of strings to try.\n</code></pre> <p>\u5e2e\u52a9\u6587\u6863\u4e2d\uff0cstr\u6784\u9020\u51fd\u6570\u548c startswith \u51fd\u6570\uff0c\u7bad\u5934\u540e\u4e3a\u8fd4\u56de\u503c\u7c7b\u578b\u3002 \u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u5fc5\u987b\uff0c\u4e2d\u62ec\u53f7\u4e2d\u7684\u53c2\u6570\u4e3a\u53ef\u9009\uff0c\u4e0d\u586b\u65f6\u4e3a\u9ed8\u8ba4\u503c\u3002 \u7b2c1\u4e2a\u53c2\u6570\u5fc5\u586b\uff0c\u5176\u4ed62\u4e2a\u4f9d\u6b21\u9009\u586b\u3002</p> <pre><code>    str(bytes_or_buffer[, encoding[, errors]]) -&gt; str\n    S.startswith(prefix[, start[, end]]) -&gt; bool\n</code></pre>","tags":["help"]},{"location":"blog/20191201/3-python-help/#string","title":"string","text":"<p>\u67e5\u770b <code>string</code> \u6a21\u5757\u7684\u5e2e\u52a9\u8bf4\u660e\uff1a</p> <pre><code>&gt;&gt;&gt; # help(string)\n&gt;&gt;&gt; help(string)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nNameError: name 'string' is not defined\n&gt;&gt;&gt; # \u5148 import \u518d help\n&gt;&gt;&gt;\n&gt;&gt;&gt; import string\n&gt;&gt;&gt; help(string)\n\nHelp on module string:\n\nNAME\n    string - A collection of string constants.\n&gt;&gt;&gt;\n</code></pre> <p></p> <p>\u5982\u679c\u4e0d import \u5bfc\u5165\u6a21\u5757\uff0c\u52a0\u5f15\u53f7 <code>help('module')</code> \u4e5f\u53ef\u4ee5\u67e5\u770b\u6a21\u5757\u5e2e\u52a9\u3002</p> <pre><code>&gt;&gt;&gt; help('array')\n\nHelp on module array:\n\nNAME\n    array\n\nMODULE REFERENCE\n    https://docs.python.org/3.6/library/array\n\n&gt;&gt;&gt; help('collections.deque')\n\nHelp on class deque in collections:\n\ncollections.deque = class deque(builtins.object)\n |  deque([iterable[, maxlen]]) --&gt; deque object\n |  \n |  A list-like sequence optimized for data accesses near its endpoints.\n |  \n |  Methods defined here:\n</code></pre>","tags":["help"]},{"location":"blog/20191201/3-python-help/#pdfminer","title":"pdfminer","text":"<p>\u5bfc\u5165\u67e5\u770b pdfminer \u5e2e\u52a9\uff0c\u53ef\u4ee5\u770b\u5230\u5217\u51fa\u7684\u6a21\u5757\uff08PACKAGE CONTENTS\uff09\uff1a</p> <pre><code>&gt;&gt;&gt; import pdfminer\n&gt;&gt;&gt; help(pdfminer)\n</code></pre> <p>\u5982\u679c\u8981\u67e5\u770b\u5177\u4f53\u67d0\u4e2a\u6a21\u5757\uff08\u4f8b\u5982 pdfdocument\uff09\u7684\u5e2e\u52a9\uff0c\u4e5f\u9700\u8981\u5148\u5bfc\u5165\u518d\u67e5\u770b\uff1a</p> <pre><code>&gt;&gt;&gt; import pdfminer.pdfdocument\n&gt;&gt;&gt; help(pdfminer.pdfdocument)\n</code></pre> <p>\u4e5f\u53ef\u901a\u8fc7 dir \u67e5\u770b\u5176\u5c5e\u6027\u5217\u8868\uff0c\u65b9\u4fbf\u7565\u89c8\u5176\u4e2d\u5b9a\u4e49\u7684\u5c5e\u6027\u3002</p>","tags":["help"]},{"location":"blog/20191201/3-python-help/#quit","title":"quit","text":"<p><code>help(object)</code> \u4ee5 less/vi \u6a21\u5f0f\u6253\u5f00\u5e2e\u52a9 manual page\uff0c\u5e95\u884c\u8f93\u5165 <code>q</code> \u5373\u53ef\u9000\u51fa\u8fd4\u56de\u63a7\u5236\u53f0\u3002 \u8f93\u5165 <code>h</code> \u53ef\u67e5\u770b less \u547d\u4ee4\u5e2e\u52a9\uff1b\u8f93\u5165 <code>?pattern</code> \u6216 <code>/pattern</code> \u53ef\u6267\u884c\u524d\u5411/\u540e\u5411\u641c\u7d22\u3002  </p>","tags":["help"]},{"location":"blog/20191201/3-python-help/#help_1","title":"help()","text":"<p>\u5728 python \u63a7\u5236\u53f0\u4e2d\u8f93\u5165 <code>help()</code> \u53ef\u6253\u5f00\u4ea4\u4e92\u5f0f\uff08<code>help&gt; prompt</code>\uff09\u5e2e\u52a9\u7cfb\u7edf\uff08help utility\uff09\u3002</p> <pre><code>&gt;&gt;&gt; help()\n\nWelcome to Python 3.6's help utility!\n\nIf this is your first time using Python, you should definitely check out\nthe tutorial on the Internet at https://docs.python.org/3.6/tutorial/.\n\nEnter the name of any module, keyword, or topic to get help on writing\nPython programs and using Python modules.  To quit this help utility and\nreturn to the interpreter, just type \"quit\".\n\nTo get a list of available modules, keywords, symbols, or topics, type\n\"modules\", \"keywords\", \"symbols\", or \"topics\".  Each module also comes\nwith a one-line summary of what it does; to list the modules whose name\nor summary contain a given string such as \"spam\", type \"modules spam\".\n\nhelp&gt; \n</code></pre> <p>\u4ece\u4e2d\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u5230 Python \u5b98\u65b9\u6559\u7a0b\uff08The Python Tutorial\uff09\u7684\u7f51\u5740\u4e3a https://docs.python.org/3.6/tutorial/ \u3002</p> <p>\u5149\u6807\u505c\u7559\u5728 <code>help&gt;</code> \u4e4b\u540e\uff0c\u53ef\u4ee5\u8f93\u5165 any module\uff08name\uff09\u3001keywords \u6216 topics \u67e5\u770b\u6a21\u5757\u3001\u5173\u952e\u5b57\u3001\u8bdd\u9898\u7b49\u76f8\u5173\u5e2e\u52a9\u4e3b\u9898\u3002</p> <ul> <li><code>modules</code>\uff1a\u5217\u51fa\u6240\u6709\u5df2\u5b89\u88c5\u6a21\u5757  </li> <li><code>keywords</code>\uff1a\u5217\u51fa\u8bed\u8a00\u5185\u7f6e\u5173\u952e\u5b57  </li> <li><code>symbols</code>\uff1a\u5217\u51fa\u8bed\u8a00\u5185\u7f6e\u7b26\u53f7  </li> <li><code>topics</code>\uff1a\u5217\u51fa\u76f8\u5173\u5e2e\u52a9\u4e3b\u9898  </li> </ul>","tags":["help"]},{"location":"blog/20191201/3-python-help/#keywords","title":"keywords","text":"<p>\u8f93\u5165 <code>keywords</code> \u53ef\u4ee5\u5217\u51fa Python \u8bed\u8a00\u7684\u5185\u7f6e\u5173\u952e\u5b57\uff1a</p> <pre><code>help&gt; keywords\n\nHere is a list of the Python keywords.  Enter any keyword to get more help.\n\nFalse               def                 if                  raise\nNone                del                 import              return\nTrue                elif                in                  try\nand                 else                is                  while\nas                  except              lambda              with\nassert              finally             nonlocal            yield\nbreak               for                 not                 \nclass               from                or                  \ncontinue            global              pass                \n</code></pre> <p>\u901a\u8fc7 <code>help('keyword')</code> \u53ef\u67e5\u770b\u67d0\u4e2a\u5173\u952e\u5b57 keyword \u7684\u8bf4\u660e\u3002</p> <ul> <li>\u5982\u679c\u4e0d\u6e05\u695a python \u4e2d <code>in</code>, <code>is</code>, <code>as</code> \u5173\u7cfb\u5224\u65ad\u7684\u533a\u522b\uff0c\u53ef\u8c03\u7528 help(<code>in</code>)\u3001help(<code>is</code>) \u6216 help(<code>as</code>) \u67e5\u770b\u76f8\u5173\u8bf4\u660e\uff1b  </li> <li>\u5982\u679c\u4e0d\u6e05\u695a\u5173\u952e\u5b57 <code>None</code> \u548c <code>not</code> \u7684\u533a\u522b\uff0c\u53ef\u8c03\u7528 help(<code>None</code>) \u6216 help(<code>not</code>) \u67e5\u770b\u76f8\u5173\u8bf4\u660e\uff1b  </li> </ul> <p>\u4ee5\u4e0b\u901a\u8fc7 <code>help('pass')</code> \u83b7\u53d6 pass \u5173\u952e\u5b57\u7684\u5e2e\u52a9\u8bf4\u660e\u3002</p> <pre><code>&gt;&gt;&gt; help('pass')\n\nThe \"pass\" statement\n********************\n\n   pass_stmt ::= \"pass\"\n\n\"pass\" is a null operation --- when it is executed, nothing happens.\nIt is useful as a placeholder when a statement is required\nsyntactically, but no code needs to be executed, for example:\n\n   def f(arg): pass    # a function that does nothing (yet)\n\n   class C: pass       # a class with no methods (yet)\n(END)\n</code></pre> <p>\u5176\u4ed6\u4e0d\u719f\u6089\u6216\u4e0d\u6e05\u695a\u7684 nonlocal, global, with \u7b49\u5173\u952e\u5b57\uff0c\u5747\u53ef\u901a\u8fc7\u6b64\u6cd5\u83b7\u53d6\u5176\u5e2e\u52a9\u8bf4\u660e\u3002</p>","tags":["help"]},{"location":"blog/20191201/3-python-help/#symbols","title":"symbols","text":"<p>\u8f93\u5165 <code>symbols</code> \u53ef\u4ee5\u5217\u51fa Python \u8bed\u8a00\u7684\u5185\u7f6e\u7b26\u53f7\uff1a</p> <pre><code>help&gt; symbols\n\nHere is a list of the punctuation symbols which Python assigns special meaning\nto. Enter any symbol to get more help.\n\n!=                  *=                  &lt;&lt;                  ^\n\"                   +                   &lt;&lt;=                 ^=\n\"\"\"                 +=                  &lt;=                  _\n%                   ,                   &lt;&gt;                  __\n%=                  -                   ==                  `\n&amp;                   -=                  &gt;                   b\"\n&amp;=                  .                   &gt;=                  b'\n'                   ...                 &gt;&gt;                  j\n'''                 /                   &gt;&gt;=                 r\"\n(                   //                  @                   r'\n)                   //=                 J                   |\n*                   /=                  [                   |=\n**                  :                   \\                   ~\n**=                 &lt;                   ]                   \n</code></pre>","tags":["help"]},{"location":"blog/20191201/3-python-help/#modules","title":"modules","text":"<p>modules</p> <p>\u8f93\u5165 <code>modules</code> \u53ef\u4ee5\u5217\u51fa\u5f53\u524d\u6240\u6709\u5df2\u5b89\u88c5\u7684\u6a21\u5757\uff1a</p> <pre><code>help&gt; modules\n\nPlease wait a moment while I gather a list of all available modules...\n</code></pre> <p>\u7b49\u6548\u4e8e  <code>help('modules')</code> </p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u8c03\u7528 <code>modules time</code> \u67e5\u770b\u6240\u6709\u540d\u79f0\u6216\u6982\u8981\u4fe1\u606f\u4e2d\u5305\u542b time \u7684\u6a21\u5757\u3002</p> <pre><code>help&gt; modules time\n\nHere is a list of modules whose name or summary contains 'time'.\nIf there are any, enter a module name to get more help.\n\ntime - This module provides various functions to manipulate time values.\n_strptime - Strptime-related classes and functions.\ndatetime - Concrete date/time and related types.\ntest.ann_module3 - Correct syntax for variable annotation that should fail at runtime\ntest.datetimetester - Test date/time type.\ntest.test_datetime \ntest.test_strftime - Unittest for time.strftime\ntest.test_strptime - PyUnit testing against strptime\ntest.test_time \ntest.test_timeit \ntest.test_timeout - Unit tests for socket timeout feature.\ntest.time_hashlib \ntimeit - Tool for measuring execution time of small code snippets.\n_datetime \npip._vendor.urllib3.util.timeout \n</code></pre> <p>\u5728\u5904\u7406\u67d0\u4e00\u7279\u5b9a\u9886\u57df\u95ee\u9898\uff0c\u60f3\u8981\u770b\u770b\u73b0\u6709\u7684\u6a21\u5757\u5e93\u652f\u6301\u65f6\uff0c\u57fa\u4e8e\u5173\u952e\u5b57\u8fdb\u884c\u6a21\u7cca\u5339\u914d\u76f8\u5f53\u5b9e\u7528\u3002</p>","tags":["help"]},{"location":"blog/20191201/3-python-help/#quit_1","title":"quit","text":"<p>\u901a\u8fc7\u5feb\u6377\u952e <code>&lt;C-c&gt;</code> / <code>&lt;C-d&gt;</code> \u6216 <code>quit</code> \u53ef\u9000\u51fa help utility \u547d\u4ee4\u884c <code>help&gt;</code>\uff0c\u56de\u5230 Python \u4e3b\u63a7\u5236\u53f0 <code>&gt;&gt;&gt;</code>\u3002</p> <pre><code>help&gt; quit\n\nYou are now leaving help and returning to the Python interpreter.\nIf you want to ask for help on a particular object directly from the\ninterpreter, you can type \"help(object)\".  Executing \"help('string')\"\nhas the same effect as typing a particular string at the help&gt; prompt.\n</code></pre> <p><code>help&gt;</code> \u8f93\u5165 <code>module</code>\uff08\u65e0\u9700\u5148 import\uff09, <code>module.function</code>, <code>module.class</code>, <code>module.class.method</code> \u53ef\u67e5\u770b\u76f8\u5173\u5e2e\u52a9\u3002</p> <p>\u9000\u56de\u5230 <code>&gt;&gt;&gt;</code> \u4e2d\u8f93\u5165<code>help(module)</code>\u3001<code>help(module.function)</code>\u3001<code>help(module.class)</code>\u3001<code>help(module.class.method)</code> \u53ef\u67e5\u770b\u7b49\u6548\u5e2e\u52a9\u3002  </p>","tags":["help"]},{"location":"blog/20191201/3-python-help/#dir__all","title":"dir() &amp; all","text":"<p>dir()</p> <p>The built-in function dir() is used to find out which names a module defines. It returns a sorted list of strings:</p> <p>Note that it lists all types of names: variables, modules, functions, etc. dir() does not list the names of built-in functions and variables.  </p> <p>\u5185\u7f6e\u6a21\u5757 builtins \u63d0\u4f9b\u7684 <code>dir()</code> \u65b9\u6cd5\u7528\u4e8e\u5217\u4e3e\u7c7b\u6216\u5b9e\u4f8b\u7684\u5c5e\u6027\u65b9\u6cd5\u3002</p> <p>\u53ef\u5bfc\u5165 builtins \u6a21\u5757\uff0c\u7136\u540e\u8c03\u7528 <code>help(builtins.dir)</code> \u67e5\u770b\u5e2e\u52a9\uff1a</p> <pre><code>&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; help(builtins.dir)\n</code></pre> <p>\u7531\u4e8e builtins \u6a21\u5757\u5df2\u7ecf\u5185\u7f6e\u5230\u89e3\u91ca\u5668\uff0c\u56e0\u6b64\u5bf9\u4e8e\u5176\u4e2d\u7684\u7c7b\u6216\u51fd\u6570\uff0c\u53ef\u7701\u53bb import\uff0c\u76f4\u63a5\u8c03\u7528 help \u6216\u8bbf\u95ee\u5176 <code>__doc__</code> \u67e5\u770b <code>dir()</code> \u51fd\u6570\u7684\u8bf4\u660e\u3002</p> <pre><code># \u4e5f\u53ef\u6267\u884c print(dir.__doc__) \u67e5\u770b\u6982\u8981\n\n&gt;&gt;&gt; help(dir)\n\nHelp on built-in function dir in module builtins:\n\ndir(...)\n    dir([object]) -&gt; list of strings\n\n    If called without an argument, return the names in the current scope.\n    Else, return an alphabetized list of names comprising (some of) the attributes\n    of the given object, and of attributes reachable from it.\n    If the object supplies a method named __dir__, it will be used; otherwise\n    the default dir() logic is used and returns:\n      for a module object: the module's attributes.\n      for a class object:  its attributes, and recursively the attributes\n        of its bases.\n      for any other object: its attributes, its class's attributes, and\n        recursively the attributes of its class's base classes.\n</code></pre> <p>\u4f8b\u5982\u6267\u884c <code>dir(builtins)</code> \u53ef\u67e5\u770b\u6a21\u5757 builtins \u63d0\u4f9b\u7684\u6240\u6709\u5c5e\u6027\u53ca\u65b9\u6cd5\uff1a</p> <pre><code>&gt;&gt;&gt; import builtins\n&gt;&gt;&gt; dir(builtins)\n</code></pre> <pre><code>&gt; \u4e5f\u53ef\u6267\u884c `print(builtins.__dict__)` \u6253\u5370 builtins \u6a21\u5757\u7684\u7b26\u53f7\u8868\u3002\n</code></pre> <p>\u4ee5\u4e0b\u5bfc\u5165 pdfminer \u53ca\u5176 layout\uff0c\u7136\u540e\u901a\u8fc7 dir \u67e5\u770b\u5176\u5c5e\u6027\u5217\u8868\uff0c\u65b9\u4fbf\u7565\u89c8\u67e5\u627e\uff1a</p> <pre><code>&gt;&gt;&gt; import pdfminer\n&gt;&gt;&gt; dir(pdfminer)\n['__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__path__', '__spec__', '__version__', 'ascii85', 'ccitt', 'layout', 'lzw', 'pdfdocument', 'pdfparser', 'pdftypes', 'psparser', 'runlength', 'settings', 'utils']\n\n&gt;&gt;&gt; import pdfminer.layout\n&gt;&gt;&gt; dir(pdfminer.layout)\n['INF', 'IndexAssigner', 'LAParams', 'LTAnno', 'LTChar', 'LTComponent', 'LTContainer', 'LTCurve', 'LTExpandableContainer', 'LTFigure', 'LTImage', 'LTItem', 'LTLayoutContainer', 'LTLine', 'LTPage', 'LTRect', 'LTText', 'LTTextBox', 'LTTextBoxHorizontal', 'LTTextBoxVertical', 'LTTextContainer', 'LTTextGroup', 'LTTextGroupLRTB', 'LTTextGroupTBRL', 'LTTextLine', 'LTTextLineHorizontal', 'LTTextLineVertical', 'Plane', '__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__spec__', 'apply_matrix_pt', 'bbox2str', 'fsplit', 'get_bound', 'heapq', 'logger', 'logging', 'matrix2str', 'uniq']\n\n&gt;&gt;&gt; import pdfminer.psparser\n&gt;&gt;&gt; dir(pdfminer.psparser)\n</code></pre> <p>\u8c03\u7528 dir \u5217\u4e3e\u6a21\u5757\u5185\u5bb9\uff0c\u4f1a\u5305\u542b\u4e00\u4e9b\u4ee5\u4e0b\u5212\u7ebf\u5f00\u5934\u4e0d\u5e0c\u671b\u5411\u5916\u516c\u5f00\u5bfc\u51fa\u7684\u7b26\u53f7\u3002 \u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u5217\u8868\u63a8\u5bfc\u5f0f\u5c06\u4ee5\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\u975e\u4f9b\u5916\u90e8\u4f7f\u7528\u7684\u540d\u79f0\u8fc7\u6ee4\u6389\uff1a</p> <pre><code>&gt;&gt;&gt; import string\n&gt;&gt;&gt; [n for n in dir(string) if not n.startswith('_')]\n['Formatter', 'Template', 'ascii_letters', 'ascii_lowercase', 'ascii_uppercase', 'capwords', 'digits', 'hexdigits', 'octdigits', 'printable', 'punctuation', 'whitespace']\n</code></pre> <p>\u5728 dir \u5217\u51fa\u7684\u5b8c\u6574\u6e05\u5355\u4e2d\uff0c\u5305\u542b\u540d\u79f0 <code>__all__</code>\u3002\u8fd9\u4e2a\u53d8\u91cf\u5305\u542b\u4e00\u4e2a\u5217\u8868\uff0c\u4e0e\u4e0a\u8ff0\u5217\u8868\u63a8\u5bfc\u8fc7\u6ee4\u7684\u7ed3\u679c\u4e00\u81f4\uff0c\u65e8\u5728\u5b9a\u4e49\u6a21\u5757\u7684\u516c\u6709\u63a5\u53e3\u3002 \u5b83\u544a\u8bc9\u89e3\u91ca\u5668\uff0c\u4ece\u8fd9\u4e2a\u6a21\u5757\u5bfc\u5165\u6240\u6709\u7684\u540d\u79f0\u610f\u5473\u7740\u4ec0\u4e48\uff0c\u5177\u4f53\u6765\u8bf4 <code>from string import *</code> \u540e\u53ef\u8c03\u7528 <code>string.__all__</code> \u4e2d\u58f0\u660e\u5bfc\u51fa\u7684\u7b26\u53f7\u3002</p> <p><code>string.__all__</code> \u7b49\u6548\u4e8e\u4ee5\u4e0a\u5217\u8868\u63a8\u5bfc\u8fc7\u6ee4\u3002</p> <pre><code>&gt;&gt;&gt; import string\n&gt;&gt;&gt; string.__all__\n['ascii_letters', 'ascii_lowercase', 'ascii_uppercase', 'capwords', 'digits', 'hexdigits', 'octdigits', 'printable', 'punctuation', 'whitespace', 'Formatter', 'Template']\n</code></pre>","tags":["help"]},{"location":"blog/20191201/3-python-help/#autocompletion","title":"autocompletion","text":"<p>\u5728 python3 \u63a7\u5236\u53f0\u4e2d\uff0c\u5bf9\u4e8e\u660e\u786e\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u8f93\u5165\u5f15\u7528\u7b26\u70b9\u53f7\uff08<code>.</code>\uff09\u540e\uff0c\u518d\u6309\u4e0b tab \u4f1a\u5217\u4e3e\u6240\u6709\u53ef\u80fd\u7684\u6210\u5458\u51fd\u6570\u6216\u5c5e\u6027\u3002</p> <p>\u4f8b\u5982\u5b9a\u4e49\u4e86\u5b57\u7b26\u4e32 str1\uff0c\u5c1d\u8bd5\u70b9\u5f15\u7528\u5e76\u6309tab\u952e\u5c06\u81ea\u52a8\u5217\u51fa str \u5bf9\u8c61\u652f\u6301\u7684\u65b9\u6cd5\uff1a</p> <pre><code>&gt;&gt;&gt; str1='hello'\n&gt;&gt;&gt; str1.\nstr1.capitalize(    str1.isalnum(       str1.join(          str1.rsplit(\nstr1.casefold(      str1.isalpha(       str1.ljust(         str1.rstrip(\nstr1.center(        str1.isdecimal(     str1.lower(         str1.split(\nstr1.count(         str1.isdigit(       str1.lstrip(        str1.splitlines(\nstr1.encode(        str1.isidentifier(  str1.maketrans(     str1.startswith(\nstr1.endswith(      str1.islower(       str1.partition(     str1.strip(\nstr1.expandtabs(    str1.isnumeric(     str1.replace(       str1.swapcase(\nstr1.find(          str1.isprintable(   str1.rfind(         str1.title(\nstr1.format(        str1.isspace(       str1.rindex(        str1.translate(\nstr1.format_map(    str1.istitle(       str1.rjust(         str1.upper(\nstr1.index(         str1.isupper(       str1.rpartition(    str1.zfill(\n</code></pre> <p>\u4f8b\u5982\u5b9a\u4e49\u6784\u9020\u5217\u8868\u5bf9\u8c61 l\uff0c\u5c1d\u8bd5\u70b9\u5f15\u7528\u5e76\u6309tab\u952e\u5c06\u81ea\u52a8\u5217\u51fa list \u5bf9\u8c61\u652f\u6301\u7684\u65b9\u6cd5\uff1a</p> <pre><code>&gt;&gt;&gt; l = list()\n&gt;&gt;&gt; l.\nl.append(    l.copy()     l.extend(    l.insert(    l.remove(    l.sort(\nl.clear()    l.count(     l.index(     l.pop(       l.reverse()\n</code></pre> <p>\u501f\u6b64\u7279\u6027\uff0c\u5728\u7f16\u7801\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4e00\u89c8\u67d0\u4e00\u7c7b\u522b\u5b9e\u4f8b\u7684\u53ef\u7528\u5c5e\u6027\u3001\u65b9\u6cd5\u3002</p> <p>\u5bf9\u4e8e Sublime Text \u7b49\u6587\u672c\u7f16\u8f91\u5668\uff0c\u9700\u8981\u501f\u52a9 Anaconda \u6216 SublimeLinter-pycodestyle \u7b49\u63d2\u4ef6\u6765\u5b9e\u73b0\u81ea\u52a8\u5b8c\u6210\u667a\u80fd\u63d0\u793a\u3002</p>","tags":["help"]},{"location":"blog/20191201/4-pyenv-virtualenv/","title":"pyenv & virtualenv","text":"<p>pyenv\uff0cvirtualenv\uff0cpyenv-virtualenv \u7b80\u4ecb\u3002</p> <p>What is the difference between venv, pyvenv, pyenv, virtualenv, virtualenvwrapper, pipenv, etc? </p>","tags":["pyenv","virtualenv"]},{"location":"blog/20191201/4-pyenv-virtualenv/#pyenv","title":"pyenv","text":"<p>github: pyenv / pyenv</p> <p>Simple Python Version Management: pyenv</p> <p>pyenv lets you easily switch between multiple versions of Python. It's simple, unobtrusive, and follows the UNIX tradition of single-purpose tools that do one thing well.  </p> <p>intallation by Homebrew on macOS Multiple Python installations on OS X python \u73af\u5883\u7ba1\u7406\u5668pyenv \u547d\u4ee4 \u5728 Mac OS X 10.10 \u5b89\u88c5 pyenv \u7684\u4e00\u4e2a\u5c0f\u5751 CentOS \u4f7f\u7528 pyenv, CentOS 6.4 \u4e0b\u5b89\u88c5\u914d\u7f6e pip \u548c pyenv </p> <p>pyenv \u7684\u7f8e\u597d\u4e4b\u5904\u5728\u4e8e\u5b83\u5e76\u6ca1\u6709\u4f7f\u7528\u5c06\u4e0d\u540c\u7684 $PATH \u690d\u5165\u4e0d\u540c\u7684 shell \u8fd9\u79cd\u9ad8\u8026\u5408\u7684\u5de5\u4f5c\u65b9\u5f0f\uff0c\u800c\u662f\u7b80\u5355\u5730\u5728 $PATH \u6700\u524d\u9762\u63d2\u5165\u4e86\u4e00\u4e2a\u57ab\u7247\u8def\u5f84\uff08shims\uff09\uff1a</p> <p><code>~/.pyenv/shims:/usr/local/bin:/usr/bin:/bin</code></p> <p>\u6240\u6709\u5bf9 Python \u53ef\u6267\u884c\u6587\u4ef6\u7684\u67e5\u627e\u90fd\u4f1a\u9996\u5148\u88ab\u8fd9\u4e2a shims \u8def\u5f84\u622a\u83b7\uff0c\u4ece\u800c\u67b6\u7a7a\u4e86\u540e\u9762\u7684\u7cfb\u7edf\u8def\u5f84\u3002</p>","tags":["pyenv","virtualenv"]},{"location":"blog/20191201/4-pyenv-virtualenv/#command_reference","title":"Command Reference","text":"<p>pyenv Command Reference</p> <p>To list the all available versions of Python, including Anaconda, Jython, pypy, and stackless use: </p> <p>\u5217\u51fa\u6240\u6709\u53ef\u5b89\u88c5\u7684 python \u7248\u672c\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  pyenv install --list\nAvailable versions:\n  2.1.3\n  2.2.3\n</code></pre> <p>Then install the desired versions:</p> <p>\u5b89\u88c5\u7279\u5b9a\u7684 python \u7248\u672c\uff1a</p> <pre><code>$ pyenv install 2.7.6\n$ pyenv install 2.6.8\n</code></pre> <p>Lists all Python versions known to pyenv, and shows an asterisk next to the currently active version.</p> <p>\u5217\u51fa\u5df2\u7ecf\u5b89\u88c5\u7684 python \u7248\u672c\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  pyenv versions\n* system (set by /Users/faner/.pyenv/version)\n</code></pre> <p>\u67e5\u770b\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684 python \u7248\u672c\uff1a</p> <pre><code>faner@MBP-FAN:~|\u21d2  pyenv version\nsystem (set by /Users/faner/.pyenv/version)\n</code></pre> <p>Uninstall a specific Python version.</p> <p>\u5378\u8f7d\u6307\u5b9a\u7248\u672c\u7684 python\uff1a</p> <pre><code>Usage: pyenv uninstall [-f|--force] &lt;version&gt;\n\n   -f  Attempt to remove the specified version without prompting\n       for confirmation. If the version does not exist, do not\n       display an error message.\n</code></pre> <p>Displays the full path to the executable that pyenv will invoke when you run the given command.</p> <p>\u5217\u51fa\u6307\u5b9a\u7248\u672c python \u7684\u5b9e\u9645\u8def\u5f84\uff1a</p> <pre><code>$ pyenv which python3.3\n/home/yyuu/.pyenv/versions/3.3.3/bin/python3.3\n</code></pre>","tags":["pyenv","virtualenv"]},{"location":"blog/20191201/4-pyenv-virtualenv/#virtualenv","title":"virtualenv","text":"<p>virtualenv is a tool to create isolated Python environments.</p> <p>Docs \u00bb Virtualenv </p> <p>ubuntu \u4f7f\u7528 pyenv \u548c virtualenv \u642d\u5efa\u591a\u7248\u672c\u865a\u62df\u5f00\u53d1\u73af\u5883 CentOS 6.8 \u4f7f\u7528 pyenv + virtualenv \u6253\u9020\u591a\u7248\u672c Python \u5f00\u53d1\u73af\u5883 </p>","tags":["pyenv","virtualenv"]},{"location":"blog/20191201/4-pyenv-virtualenv/#pyenv-virtualenv","title":"pyenv-virtualenv","text":"<p>github: pyenv / pyenv-virtualenv</p> <p>pyenv \u662f\u4e00\u4e2a Python \u591a\u7248\u672c\u73af\u5883\u7ba1\u7406\u5de5\u5177\uff0c\u8fd9\u4e2a\u662f\u548c\u6211\u4eec\u5e38\u7528\u7684 virtualenv \u6709\u6240\u4e0d\u540c\u3002  </p> <ol> <li>\u524d\u8005\u662f\u5bf9 Python \u7684\u7248\u672c\u8fdb\u884c\u7ba1\u7406\uff0c\u5b9e\u73b0\u4e0d\u540c\u7248\u672c\u7684\u5207\u6362\u548c\u4f7f\u7528\uff1b  </li> <li>\u540e\u8005\u6d4b\u8bd5\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u73af\u5883\uff0c\u4e0e\u7cfb\u7edf\u73af\u5883\u4ee5\u53ca\u5176\u4ed6 Python \u73af\u5883\u9694\u79bb\uff0c\u907f\u514d\u5e72\u6270\u3002  </li> </ol> <p>pyenv-virtualenv is a pyenv plugin that provides features to manage virtualenvs and conda environments for Python on UNIX-like systems.</p>","tags":["pyenv","virtualenv"]},{"location":"blog/20191201/4-pyenv-virtualenv/#references","title":"references","text":"<p>pyenv\u7b80\u4ecb\u2014\u2014Debian/Ubuntu\u4e2d\u7ba1\u7406\u591a\u7248\u672cPython - git clone  </p> <p>mac\u4e0b\u4f7f\u7528pyenv,pyenv-virtualenv\u7ba1\u7406python\u7684\u591a\u4e2a\u7248\u672c - homebrew - \u56fe\u6587\u8be6\u7ec6 Mac OS \u4e0a\u7528pyenv\u548cpyenv-virtualenv\u7ba1\u7406\u591a\u4e2aPython\u591a\u7248\u672c\u53ca\u865a\u62df\u73af\u5883 - homebrew Python\u7248\u672c\u7ba1\u7406\uff1apyenv\u548cpyenv-virtualenv(MAC\u3001Linux)\u3001virtualenv\u548cvirtualenvwrapper(windows) - git clone  </p>","tags":["pyenv","virtualenv"]},{"location":"blog/20191201/5-Anaconda/","title":"Anaconda IDE \u4ecb\u7ecd","text":"<p>Anaconda IDE \u5f00\u53d1\u73af\u5883\u7b80\u4ecb\u3002</p> <p>Anaconda</p> <p>Unleash Al Innovation and Value</p> <p>The World's Most Popular Python/R Data Science Platform</p> <p>The open-source Anaconda Distribution is the easiest way to perform Python/R data science and machine learning on Linux, Windows, and Mac OS X.</p> <p>Anaconda - Anaconda Documentation - Anaconda Distribution</p> <p>Anaconda \u662f\u4e00\u4e2a\u5305\u542b\u8bf8\u591a\u5e38\u7528\u79d1\u5b66\u5305\u53ca\u5176\u4f9d\u8d56\u9879\u7684 Python \u53d1\u884c\u7248\u672c\uff0c\u5176\u5f00\u6e90\u8de8\u5e73\u53f0\uff0c\u89e3\u51b3\u4e86 Python \u539f\u751f\u5305\u7ba1\u7406\u5668 Pip \u7684\u4f9d\u8d56\u51b2\u7a81\u95ee\u9898\uff0c\u6781\u5927\u5730\u65b9\u4fbf\u4e86 Python \u73af\u5883\u7684\u7ba1\u7406\u3002</p> <p>\u5982\u679c\u4f60\u4f7f\u7528 Python \u7684\u573a\u666f\u5c5e\u4e8e\u6570\u636e\u79d1\u5b66\u9886\u57df\uff0c\u5219 Anaconda \u53ef\u4ee5\u88ab\u770b\u4f5c\u662f\u6807\u914d\u3002</p>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#install","title":"install","text":"<p>\u5728 Windows \u4e0b\uff0c\u53ef\u901a\u8fc7\u5305\u7ba1\u7406\u5668 Chocolatey \u6216 Scoop \u8fdb\u884c\u5b89\u88c5\uff1a</p> <pre><code># scoop bucket add scoopet https://github.com/integzz/scoopet\nscoop install miniconda-cn\nchoco install miniconda3\n</code></pre> <p>\u5bf9 macOS \u7528\u6237\uff0c\u53ef\u7528 Homebrew \u5b89\u88c5\uff1a</p> <pre><code>brew cask install anaconda\n</code></pre> <p>brew \u5b89\u88c5\u65e5\u5fd7\u63d0\u793a\u5176\u5b89\u88c5\u4f4d\u7f6e\uff1a</p> <pre><code>PREFIX=/usr/local/anaconda3\n</code></pre> <p>macOS \u901a\u8fc7 brew \u5b89\u88c5\u7684 python3 \u76ee\u524d\u7684\u7248\u672c\u4e3a 3.9.0\uff1a</p> <pre><code>$ python3 -V\nPython 3.9.0\n\n$ pip3 -V\npip 20.2.4 from /usr/local/lib/python3.9/site-packages/pip (python 3.9)\n</code></pre> <p>cd \u8fdb\u5165 anaconda3 \u547d\u4ee4\u884c\u5de5\u5177\u5305\u76ee\u5f55\uff08<code>/usr/local/anaconda3/bin</code>\uff09\uff0c\u6267\u884c <code>./python3 -V</code> \u53ef\u77e5\uff0canaconda3 \u5185\u7f6e\u7684 python3 \u7248\u672c\u4e3a 3.7.6\uff1a</p> <pre><code>$ cd /usr/local/anaconda3/bin\n$ ./python3 -V\nPython 3.7.6\n\n$ ./pip -V\npip 20.0.2 from /usr/local/anaconda3/lib/python3.7/site-packages/pip (python 3.7)\n</code></pre> <p>\u6267\u884c <code>./pip list</code> \u53ef\u4ee5\u67e5\u770b\u5b89\u88c5\u7684\u7b2c\u4e09\u65b9\u5305\uff1a</p> <pre><code>$ ./pip list | more\nPackage                            Version\n---------------------------------- -------------------\nalabaster                          0.7.12\nanaconda-client                    1.7.2\nanaconda-navigator                 1.9.12\nanaconda-project                   0.8.3\n\n$ ./pip list | grep 'pandas'\npandas                             1.0.1\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#conda","title":"conda","text":"<p><code>conda</code> is a tool for managing and deploying applications, environments and packages.</p> <p>conda \u662f Anaconda \u5185\u7f6e\u7684\u547d\u4ee4\u884c\u5de5\u5177\u5305\uff0cmacOS \u5b89\u88c5 Anaconda \u540e\u65e0\u6cd5\u5728\u7ec8\u7aef\u4f7f\u7528 conda \u547d\u4ee4\u600e\u4e48\u529e\uff1f</p> <p>cd \u8fdb\u5165 anaconda3 \u547d\u4ee4\u884c\u5de5\u5177\u5305\u76ee\u5f55\uff08<code>/usr/local/anaconda3/bin</code>\uff09\uff0c\u5373\u53ef\u6267\u884c <code>./conda</code> \u76f8\u5173\u547d\u4ee4\u3002</p> <p>\u67e5\u770b conda \u7248\u672c\uff1a</p> <pre><code>$ cd /usr/local/anaconda3/bin\n$ ./conda -V\nconda 4.8.2\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#help","title":"help","text":"<p>\u67e5\u770b conda \u5e2e\u52a9\uff1a</p> <pre><code>$ ./conda -h\nusage: conda [-h] [-V] command ...\n\nconda is a tool for managing and deploying applications, environments and packages.\n\nOptions:\n\npositional arguments:\n  command\n    clean        Remove unused packages and caches.\n    config       Modify configuration values in .condarc. This is modeled\n                 after the git config command. Writes to the user .condarc\n                 file (/Users/faner/.condarc) by default.\n    create       Create a new conda environment from a list of specified\n                 packages.\n    help         Displays a list of available conda commands and their help\n                 strings.\n    info         Display information about current conda install.\n    init         Initialize conda for shell interaction. [Experimental]\n    install      Installs a list of packages into a specified conda\n                 environment.\n    list         List linked packages in a conda environment.\n    package      Low-level conda package utility. (EXPERIMENTAL)\n    remove       Remove a list of packages from a specified conda environment.\n    uninstall    Alias for conda remove.\n    run          Run an executable in a conda environment. [Experimental]\n    search       Search for packages and display associated information. The\n                 input is a MatchSpec, a query language for conda packages.\n                 See examples below.\n    update       Updates conda packages to the latest compatible version.\n    upgrade      Alias for conda update.\n</code></pre> <p>\u6267\u884c <code>conda activate -h</code> \u67e5\u770b activate \u5b50\u547d\u4ee4\u7684\u5e2e\u52a9\uff1a</p> <pre><code>$ conda activate -h\nusage: conda activate [-h] [--[no-]stack] [env_name_or_prefix]\n\nActivate a conda environment.\n\nOptions:\n\npositional arguments:\n  env_name_or_prefix    The environment name or prefix to activate. If the\n                        prefix is a relative path, it must start with './'\n                        (or '.\\' on Windows).\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#info","title":"info","text":"<p>\u6267\u884c <code>./conda info</code> \u547d\u4ee4\u53ef\u67e5\u770b\u5f53\u524d\u5b89\u88c5\u7684 conda \u76f8\u5173\u914d\u7f6e\u4fe1\u606f\u3002 conda \u6709\u4e2a\u5b50\u73af\u5883\u7684\u6982\u5ff5\uff0c\u9ed8\u8ba4\u4e3a <code>active environment : base</code>\u3002  </p> <pre><code>$ ./conda info\n\n     active environment : base\n    active env location : /usr/local/anaconda3\n            shell level : 1\n       user config file : /Users/faner/.condarc\n populated config files : /Users/faner/.condarc\n          conda version : 4.8.2\n    conda-build version : 3.18.11\n         python version : 3.7.6.final.0\n       virtual packages : __osx=10.16\n       base environment : /usr/local/anaconda3  (writable)\n           channel URLs : https://repo.anaconda.com/pkgs/main/osx-64\n                          https://repo.anaconda.com/pkgs/main/noarch\n                          https://repo.anaconda.com/pkgs/r/osx-64\n                          https://repo.anaconda.com/pkgs/r/noarch\n          package cache : /usr/local/anaconda3/pkgs\n                          /Users/faner/.conda/pkgs\n       envs directories : /usr/local/anaconda3/envs\n                          /Users/faner/.conda/envs\n               platform : osx-64\n             user-agent : conda/4.8.2 requests/2.22.0 CPython/3.7.6 Darwin/20.1.0 OSX/10.16\n                UID:GID : 501:20\n             netrc file : None\n           offline mode : False\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#list","title":"list","text":"<p>\u5217\u4e3e conda \u9ed8\u8ba4\u7684 base \u73af\u5883\uff08/usr/local/anaconda3\uff09\u96c6\u6210\u7684\u5de5\u5177\u5305\uff1a</p> <pre><code>$ ./conda list | wc -l\n     305\n\n$ ./conda list | more\n# packages in environment at /usr/local/anaconda3:\n#\n# Name                    Version                   Build  Channel\n_ipyw_jlab_nb_ext_conf    0.1.0                    py37_0\nalabaster                 0.7.12                   py37_0\nanaconda                  2020.02                  py37_0\nanaconda-client           1.7.2                    py37_0\nanaconda-navigator        1.9.12                   py37_0\nanaconda-project          0.8.4                      py_0\n\n$ ./conda list | grep 'pandas'\npandas                    1.0.1            py37h6c726b0_0\n</code></pre> <p>Anaconda Toolset Suite</p> <p>Our repository features over 8,000 open-source data science and machine learning packages, Anaconda-built and compiled for all major operating systems and architectures.</p> <p></p> <ul> <li>Jupyter: Jupyter is a non-profit, open-source project, born out of the IPython Project in 2014 as it evolved to support interactive data science and scientific computing across all programming languages.  </li> </ul> <p>Analyze data with scalability and performance:</p> <ul> <li>NumPy: NumPy is the fundamental package for scientific computing with Python.  </li> <li>SciPy: SciPy is a Python-based ecosystem of open-source software for mathematics, science, and engineering.  </li> <li>Numba: Numba is an open source JIT compiler that translates a subset of Python and NumPy code into fast machine code.  </li> <li>pandas: pandas is an open source, BSD-licensed library providing high-performance, easy-to-use data structures and data analysis tools for the Python programming language.  </li> <li>Dask: Dask provides advanced parallelism for analytics, enabling performance at scale for the tools you love. It is developed in coordination with other community projects like Numpy, Pandas, and Scikit-Learn.  </li> </ul> <p>Visualize Toolset:</p> <ul> <li>Matplotlib: Matplotlib is a Python 2D plotting library which produces publication quality figures in a variety of hardcopy formats and interactive environments across platforms.  </li> <li>Bokeh: Bokeh is an interactive visualization library that targets modern web browsers for presentation.  </li> <li>Datashader: Datashader is a graphics pipeline system for creating meaningful representations of large datasets quickly and flexibly.  </li> <li>Holoviews: HoloViews is an open-source Python library designed to make data analysis and visualization seamless and simple.  </li> </ul>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#conda_envs","title":"conda envs","text":"<p>Anaconda\u4ecb\u7ecd\u3001\u5b89\u88c5\u53ca\u4f7f\u7528\u6559\u7a0b </p>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#base","title":"base","text":"<p>\u6267\u884c <code>./conda activate</code> \u5c1d\u8bd5\u6fc0\u6d3b base \u73af\u5883\uff0c\u62a5\u9519 CommandNotFoundError\uff1a</p> <pre><code>$ ./conda activate\n\nCommandNotFoundError: Your shell has not been properly configured to use 'conda activate'.\nTo initialize your shell, run\n\n    $ conda init &lt;SHELL_NAME&gt;\n\nCurrently supported shells are:\n  - bash\n  - fish\n  - tcsh\n  - xonsh\n  - zsh\n  - powershell\n\nSee 'conda init --help' for more information and options.\n\nIMPORTANT: You may need to close and restart your shell after running 'conda init'.\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#init_shell","title":"init shell","text":"<p>\u6839\u636e\u63d0\u793a\u6267\u884c <code>./conda init zsh</code>\uff0c<code>vim ~/.zshrc</code> \u53ef\u770b\u5230 ZSH \u914d\u7f6e\u6587\u4ef6\u672b\u5c3e\u6dfb\u52a0\u4e86 conda initialize\uff0c\u4e3b\u8981\u662f\u5c06 conda bin \u6dfb\u52a0\u5230\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>export PATH=\"/usr/local/anaconda3/bin:$PATH\"\n</code></pre> <p>\u6267\u884c <code>. ~/.zshrc</code> \u6216 <code>source ~/.zshrc</code> \u6216\u91cd\u5f00\u4e00\u4e2a\u65b0\u7684 zsh \u7ec8\u7aef\u7a97\u53e3\uff0c\u5373\u53ef\u8fdb\u5165 conda base \u73af\u5883\uff0c\u53ef\u76f4\u63a5\u8fd0\u884c conda \u7cfb\u5217\u547d\u4ee4\u3002</p> <pre><code>$ conda -V\nconda 4.8.2\n(base)\n\n$ python3 -V\nPython 3.7.6\n(base)\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#activate","title":"activate","text":"<p>\u5c06 conda \u96c6\u6210\u8fdb\u5f53\u524d shell\uff08zsh\uff09 \u4e4b\u540e\uff0c\u518d\u6b21\u6267\u884c <code>conda activate</code> \u53ef\u8fdb\u5165 conda base \u73af\u5883\u3002</p> <p>\u9ed8\u8ba4\u7684 base \u73af\u5883\u643a\u5e26\u4e86\u6240\u6709\u96c6\u6210\u7684\u7ec4\u4ef6\u5e93\uff08Toolset Suite\uff09\uff0c\u53ef\u4ee5\u76f4\u63a5\u5bfc\u5165\u5f15\u7528\uff0c\u65b0\u5efa\u7684\u5b50\u73af\u5883\u5219\u9700\u8981\u81ea\u884c\u6309\u9700\u5b89\u88c5\u3002 \u5982\u65e0\u7279\u6b8a\u7684\u73af\u5883\u9694\u79bb\u9700\u6c42\uff0c\u666e\u901a\u7b80\u5355\u7684\u9700\u6c42\u76f4\u63a5\u5728 base \u73af\u5883\u8fd0\u884c\u8c03\u8bd5\u5373\u53ef\u3002  </p> <p>activate \u540e\u8fdb\u5165 conda base prompt \u73af\u5883\uff0c\u67e5\u770b\u5185\u7f6e\u7684 python \u7248\u672c\u548c\u8def\u5f84\uff1a</p> <pre><code>$ conda activate\n$ (base) python -V\nPython 3.9.7\n$ (base) which python\n/usr/local/anaconda3/bin/python\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#deactivate","title":"deactivate","text":"<p>\u5728 conda base \u73af\u5883\u4e0b\uff0c\u6267\u884c <code>conda deactivate</code> \u53ef\u9000\u51fa base \u73af\u5883\uff0c\u56de\u5230\u7cfb\u7edf\u9ed8\u8ba4\u7684 zsh-python \u73af\u5883\u3002</p> <pre><code>$ conda deactivate\n\n$ python3 -V\nPython 3.9.0\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#auto_activate_base","title":"auto_activate_base","text":"<p>\u7531\u4e8e\u6267\u884c <code>./conda init zsh</code> \u65f6\u6539\u52a8\u4e86 ZSH \u914d\u7f6e\u6587\u4ef6\uff08<code>~/.zshrc</code>\uff09\uff0c\u5bfc\u81f4\u6bcf\u6b21\u542f\u52a8 zsh \u7ec8\u7aef\u7a97\u53e3\uff0c\u90fd\u4f1a\u81ea\u52a8\u8fdb\u5165 conda base \u73af\u5883\u3002</p> <p>\u600e\u6837\u53d6\u6d88\u6bcf\u6b21\u81ea\u52a8\u8fdb\u5165 conda base \u73af\u5883\u5462\uff1f</p> <p>\u53ef\u901a\u8fc7\u4ee5\u4e0b\u4e09\u79cd\u65b9\u5f0f\uff1a</p> <p>\u65b9\u6cd5\u4e00\uff1a\u6ce8\u91ca\u6389 ZSH \u914d\u7f6e\u6587\u4ef6\uff08<code>~/.zshrc</code>\uff09\u4e2d\u7684 conda initialize \u76f8\u5173\u811a\u672c\uff1b  </p> <p>\u65b9\u6cd5\u4e8c\uff1a\u6bcf\u6b21\u5728\u547d\u4ee4\u884c\u901a\u8fc7 <code>conda deactivate</code> \u9000\u51fa base \u73af\u5883\uff1b  </p> <p>\u65b9\u6cd5\u4e09\uff1a\u63a8\u8350\u65b9\u5f0f</p> <ol> <li>\u901a\u8fc7\u5c06 <code>auto_activate_base</code> \u53c2\u6570\u8bbe\u7f6e\u4e3a false \u5b9e\u73b0\uff1a</li> </ol> <pre><code>conda config --set auto_activate_base false\n</code></pre> <p>\u5982\u679c\u8981\u8fdb\u5165\u7684\u8bdd\u53ef\u6267\u884c\u901a\u8fc7 <code>conda activate</code> \u9ed8\u8ba4\u8fdb\u5165 base \u73af\u5883</p> <ol> <li>\u5982\u679c\u53cd\u6094\u4e86\uff0c\u53ef\u4ee5\u518d\u6b21\u6062\u590d <code>auto_activate_base</code> \u53c2\u6570\u503c\uff1a</li> </ol> <pre><code>conda config --set auto_activate_base true\n</code></pre> <p>conda config \u5b9e\u9645\u4e0a\u662f\u4fee\u6539 user config file : <code>~/.condarc</code>\u3002</p>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#create_env","title":"create env","text":"<p>\u6267\u884c <code>conda create -h</code> \u67e5\u770b create \u5b50\u547d\u4ee4\u5e2e\u52a9\u3002</p> <pre><code># \u521b\u5efa\nconda create -n [env_name] [package_spec [package_spec ...]]\n# \u5220\u9664\nconda env remove -n [env_name]\n</code></pre> <p>\u8f93\u5165 <code>conda create -n Py376 python=3.7.6</code>\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a Py376 \u7684 python 3.7.6 \u5b50\u73af\u5883\u3002</p> <pre><code>Preparing transaction: done\nVerifying transaction: \\ WARNING conda.core.path_actions:verify(963): Unable to create environments file. Path not writable.\n  environment location: /Users/faner/.conda/environments.txt\n\ndone\nExecuting transaction: / WARNING conda.core.envs_manager:register_env(52): Unable to register environment. Path not writable or missing.\n  environment location: /usr/local/anaconda3/envs/Py376\n  registry file: /Users/faner/.conda/environments.txt\ndone\n#\n# To activate this environment, use\n#\n#     $ conda activate Py376\n#\n# To deactivate an active environment, use\n#\n#     $ conda deactivate\n\n# \u4e2d\u95f4\u7701\u7565\n\nPreparing transaction: done\nVerifying transaction: \\ WARNING conda.core.path_actions:verify(963): Unable to create environments file. Path not writable.\n  environment location: /Users/faner/.conda/environments.txt\n\ndone\nExecuting transaction: / WARNING conda.core.envs_manager:register_env(52): Unable to register environment. Path not writable or missing.\n  environment location: /usr/local/anaconda3/envs/Py376\n  registry file: /Users/faner/.conda/environments.txt\ndone\n#\n# To activate this environment, use\n#\n#     $ conda activate Py376\n#\n# To deactivate an active environment, use\n#\n#     $ conda deactivate\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#path_not_writable","title":"Path not writable","text":"<p>\u6267\u884c conda \u76f8\u5173\u547d\u4ee4\u65f6\uff0c\u63d0\u793a WARNING\uff1a</p> <ul> <li>Unable to create environments file. Path not writable.</li> <li>Unable to register environment. Path not writable or missing.</li> </ul> <p>\u5f53\u7136\u53ef\u4ee5\u5df2 sudo \u8eab\u4efd\u91cd\u65b0\u6267\u884c\u4e00\u904d\uff0c\u4f46\u662f\u6700\u597d\u6309\u7167\u4ee5\u4e0b\u65b9\u5f0f\u4e3a conda \u5de5\u4f5c\u76ee\u5f55\u6dfb\u52a0\u5fc5\u8981\u7684\u5199\u6743\u9650\u3002</p> <p>How does one fix the issue of not writable paths with conda?</p> <p>ls \u67e5\u770b <code>~/.conda</code> \u6743\u9650\u4e3a755\uff0c\u5c5e\u7ec4\u6210\u5458\u4e0d\u53ef\u5199\uff1a</p> <pre><code>$ ls -lhFA | grep '\\.conda/'\ndrwxr-xr-x    3 faner  staff    96B Nov 15 18:53 .conda/\n</code></pre> <p>\u4e3a\u5c5e\u7ec4\u6210\u5458\u6dfb\u52a0\u6743\u9650\uff0cchmod -R g+w \u53d8\u66f4\u6743\u9650\u4e3a 775\uff1a</p> <pre><code>$ # sudo chmod -R 775 .conda\n$ sudo chmod -R g+w .conda\nPassword:\n\n$ ls -lhFA | grep '\\.conda/'\ndrwxrwxr-x    3 faner  staff    96B Nov 15 18:53 .conda/\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#env_list","title":"env list","text":"<p>\u521b\u5efa\u4e86\u65b0\u7684\u5b50\u73af\u5883\u540e\uff0c\u518d\u6267\u884c <code>conda env list</code> \u53ef\u4ee5\u770b\u5230\u73af\u5883\u5217\u8868\u591a\u4e86\u4e00\u9879\uff1a</p> <pre><code>$ conda env list\n# conda environments:\n#\nbase                  *  /usr/local/anaconda3\nPy376                    /usr/local/anaconda3/envs/Py376\n\n(base)\n</code></pre> <p>environment location: <code>/Users/faner/.conda/environments.txt</code></p> <pre><code>$ cat ~/.conda/environments.txt\n/usr/local/anaconda3\n/usr/local/anaconda3/envs/Py376\n</code></pre> <p>\u65b0\u5efa\u7684 Anaconda \u5b50\u73af\u5883\u88ab\u5b89\u88c5\u5728 <code>/usr/local/anaconda3/envs</code> \u76ee\u5f55\u4e0b\u3002</p>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#activate_1","title":"activate","text":"<p>\u521b\u5efa\u597d\u5b50\u73af\u5883\u4e4b\u540e\uff0c\u6309\u7167\u63d0\u793a\u6267\u884c <code>conda activate Py376</code>\uff0c\u6fc0\u6d3b\u540d\u4e3a Py376 \u7684\u5b50\u73af\u5883\u3002</p> <p>\u5fc5\u987b\u6267\u884c\u8fc7 <code>conda init</code>\uff0c\u5426\u5219\u6267\u884c activate \u65f6\u63d0\u793a\u62a5\u9519 <code>CommandNotFoundError</code>\uff01</p> <p>\u6b64\u65f6\u6267\u884c <code>conda activate Py376</code> \u5207\u6362\u5230 Py376 \u5b50\u73af\u5883\uff0c\u53ef\u518d\u6b21\u6267\u884c <code>conda info</code> \u786e\u8ba4\u76f8\u5173\u914d\u7f6e\u4fe1\u606f\uff1a</p> <pre><code>$ conda activate Py376\n(Py376)\n\n$ conda info\n\n     active environment : Py376\n    active env location : /usr/local/anaconda3/envs/Py376\n</code></pre> <p>\u7528\u5b8c\u4e4b\u540e\u6267\u884c <code>conda deactivate</code> \u9000\u56de base \u73af\u5883\u3002</p> <pre><code>$ conda deactivate\n(base)\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#install_1","title":"install","text":"<p>\u6267\u884c <code>conda install -h</code> \u67e5\u770b install \u5b50\u547d\u4ee4\u5e2e\u52a9\u3002</p> <pre><code>usage: conda install [-h] [--revision REVISION] [-n ENVIRONMENT | -p PATH]\n                     [--freeze-installed | --update-deps | -S | --update-all | --update-specs]\n                     [package_spec [package_spec ...]]\n</code></pre> <p>\u5728 Py376 \u4e0b\u6267\u884c conda list | grep 'pandas' \u53ef\u77e5\uff0c\u65b0\u5efa\u7684\u5b50\u73af\u5883\u5e76\u6ca1\u6709\u81ea\u5e26 base \u4e0b\u7684 pandas \u7b49 Toolset Suite\uff0c\u9700\u8981\u81ea\u884c\u6309\u9700\u5b89\u88c5\u3002</p> <pre><code>conda install -n Py376 pandas\n</code></pre> <p>\u5e38\u7528\u5305\u7ba1\u7406\u76f8\u5173\u7684\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code># \u641c\u7d22\u67d0\u4e2a\u5305\uff0c\u4f1a\u5217\u4e3e\u6240\u6709\u53ef\u5b89\u88c5\u7248\u672c\nconda search [package_name]\n# \u4e3a\u6307\u5b9a\u73af\u5883\u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684\u5305\nconda install [-n ENVIRONMENT] [package_spec] [--revision REVISION]\n# \u67e5\u770b\u5df2\u5b89\u88c5\u5217\u8868\nconda list\n# \u66f4\u65b0\u67d0\u4e2a\u5305\nconda update [package_name]\n# \u66f4\u65b0\u6240\u6709\u5305\nconda update --all\n# \u5220\u9664\u5df2\u5b89\u88c5\u7684\u5305\nconda remove [package_name] # remove alias as uninstall\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/5-Anaconda/#conda_update","title":"conda update","text":"<p>\u6267\u884c <code>conda update -h</code> \u67e5\u770b update \u5b50\u547d\u4ee4\u5e2e\u52a9\u3002</p> <p>\u5728 base \u73af\u5883\u4e0b\u6267\u884c <code>conda update</code> \u63d0\u793a\u6ca1\u6709\u63d0\u4f9b\u8981\u5347\u7ea7\u7684\u5305\u540d\uff0c\u5e76\u7ed9\u51fa\u4e86\u5347\u7ea7 anaconda \u81ea\u8eab\u7684\u547d\u4ee4\u3002</p> <pre><code>$ conda update\n\nCondaValueError: no package names supplied\n# If you want to update to a newer version of Anaconda, type:\n#\n# $ conda update --prefix /usr/local/anaconda3 anaconda\n</code></pre> <ul> <li>\u6267\u884c <code>conda update -n Py376 scipy</code> \u66f4\u65b0 Py376 \u4e0b\u7684 scipy \u5305\u3002  </li> <li>\u6267\u884c <code>conda update python</code> \u66f4\u65b0\u5f53\u524d\u5b50\u73af\u5883\uff08base\uff09\u4e0b\u7684 python \u5305\u3002  </li> <li>\u6267\u884c <code>conda update --all</code> \u66f4\u65b0\u5f53\u524d\u5b50\u73af\u5883\uff08base\uff09\u4e0b\u7684\u6240\u6709\u5305\u3002  </li> </ul> <pre><code>$ conda update --all\nCollecting package metadata (current_repodata.json): done\nSolving environment: done\n\n# All requested packages already installed.\n</code></pre>","tags":["Anaconda"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/","title":"Jupyter Notebook & JupyterLab","text":"<p>Jupyter Notebook &amp; JupyterLab \u7b80\u4ecb\u3002</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#jupyter_notebook","title":"Jupyter Notebook","text":"<p><code>Jupyter Notebook</code>: The Classic Notebook Interface</p> <p>The Jupyter Notebook is the original web application for creating and sharing computational documents. It offers a simple, streamlined, document-centric experience.</p> <p>Python\u7684\u505a\u7b14\u8bb0\u795e\u5668</p> <p>Jupyter Notebook \u76f8\u5f53\u4e8e\u5728\u6d4f\u89c8\u5668\u4e2d\u5b8c\u6210python\u7f16\u7a0b\u4efb\u52a1\uff0c\u4e0d\u4ec5\u53ef\u4ee5\u5199\u4ee3\u7801\u3001\u505a\u7b14\u8bb0\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u5f97\u5230\u6bcf\u4e00\u6b65\u7684\u6267\u884c\u7ed3\u679c\uff0c\u6548\u679c\u975e\u5e38\u597d\u3002</p> <p>\u81ea\u4eceJupyter Notebook 1.0\u53d1\u5e03\u4ee5\u6765\uff0c\u8d8a\u6765\u8d8a\u591a\u79d1\u5b66\u5bb6\u3001\u7814\u7a76\u8005\u3001\u6559\u5e08\u4f7f\u7528IPython Notebook\u5904\u7406\u6570\u636e\u3001\u5199\u7814\u7a76\u62a5\u544a\u3001\u751a\u81f3\u7f16\u5199\u4e66\u7c4d\u3002</p> <p>\u63a8\u8350\u4f7f\u7528 Anaconda\uff0c\u81ea\u5e26\u4e86 Numpy\u3001Scipy\u3001Matplotlib \u7b49\u591a\u79cd python \u5f00\u53d1\u5305\u548c Jupyter Notebook\uff01</p> <p>jupyter notebook\u5b89\u88c5\u4e0e\u914d\u7f6e Python Jupyter Notebook\u5404\u79cd\u4f7f\u7528\u65b9\u6cd5\u8bb0\u5f55 python\u73af\u5883\u642d\u5efa\u4ee5\u53cajupyter notebook\u7684\u5b89\u88c5\u548c\u542f\u52a8 </p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#launch","title":"launch","text":"<p>\u5728 Anaconda Navigator \u4e2d\u70b9\u51fb\u542f\u52a8 Jupyter Notebook \u4f1a\u5f00\u4e00\u4e2a\u7ec8\u7aefTerminal\u5e76\u542f\u52a8 python webServer\u3002</p> <pre><code>$ /usr/local/anaconda3/bin/jupyter_mac.command ; exit;\n[I 2022-06-03 10:17:13.200 LabApp] JupyterLab extension loaded from /usr/local/anaconda3/lib/python3.9/site-packages/jupyterlab\n[I 2022-06-03 10:17:13.200 LabApp] JupyterLab application directory is /usr/local/anaconda3/share/jupyter/lab\n[I 10:17:13.206 NotebookApp] Serving notebooks from local directory: /Users/faner\n[I 10:17:13.206 NotebookApp] Jupyter Notebook 6.4.5 is running at:\n[I 10:17:13.206 NotebookApp] http://localhost:8888/?token=b4f7fcc120abf0c978c105a14aa675b4f9326000da7519f4\n[I 10:17:13.206 NotebookApp]  or http://127.0.0.1:8888/?token=b4f7fcc120abf0c978c105a14aa675b4f9326000da7519f4\n[I 10:17:13.207 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).\n[C 10:17:13.220 NotebookApp] \n</code></pre> <p>\u5c06\u4f1a\u5728\u9ed8\u8ba4\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 http://localhost:8890/tree \u3002</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#usage","title":"usage","text":"<p>New | Notebook - Python 3 (ipykernel)\uff0c\u5c06\u65b0\u5efa\u4e00\u4e2a Notebook Tab\u9875\u9762\uff1a</p> <p></p> <p>\u5728\u6253\u5f00\u7684 Jupyter Notebook \u4e2d\u7684\u5355\u5143\u683c\u4e2d\u8f93\u5165 Python \u4ee3\u7801\uff0c\u6309\u4e0b control+command\uff08^\u2318\uff09\u5feb\u6377\u952e\u5373\u53ef\u6267\u884c\uff1a</p> <p></p> <p>\u6309\u4e0b\u7ec4\u5408\u952e shift+command\uff08\u21e7\u2318\uff09\u5c06\u5728\u6267\u884c\u5f53\u524d\u5355\u5143\u683c\u540e\uff0c\u5728\u4e0b\u9762\u65b0\u5f00\u4e00\u4e2aCell\u5e76\u805a\u7126\u8f93\u5165\u3002</p> <p>\u70b9\u51fb <code>\u2795</code> \u53ef\u5728\u4e0b\u9762\u63d2\u5165\u65b0\u5355\u5143\u683c\u3002</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#nbextensions","title":"nbextensions","text":"<p>jupyter notebook\u4e2d\u8bbe\u7f6e\u4ee3\u7801\u7684\u81ea\u52a8\u8865\u5168\u529f\u80fd</p> <pre><code># \u5b89\u88c5\u5bf9\u5e94\u6240\u9700\u6a21\u5757\npip install jupyter_contrib_nbextensions\n\n# \u542f\u7528\u7528\u6237\u914d\u7f6e\njupyter contrib nbextension install --user\n</code></pre> <p>JupyterNotebook\u4ee3\u7801\u63d0\u793a\u4e0e\u81ea\u52a8\u8865\u9f50</p> <pre><code>pip install jupyter_contrib_nbextensions\njupyter contrib nbextension install --user\n\npip install jupyter_nbextensions_configurator\njupyter nbextensions_configurator enable --user\n</code></pre> <p>\u914d\u7f6e\u4e4b\u540e\u91cd\u542fjupyter\uff0c\u540e\u9762\u591a\u51fa\u6765\u4e00\u9879\u83dc\u5355 <code>Nbextensions</code>\uff0c\u70b9\u5f00\u52fe\u9009\u4e0a Codefolding\uff08\u6298\u53e0\u4ee3\u7801\u5757\uff09\u548c Hinterland\uff08\u4ee3\u7801\u81ea\u52a8\u8865\u5168\uff09\u5373\u53ef\u3002</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#importrun_across_cells","title":"import/run across cells","text":"<p>\u5f53\u6709\u591a\u4e2aCell\u65f6\uff0c\u7531\u4e8e\u6bcf\u4e2aCell\u90fd\u662f\u53ef\u4ee5\u72ec\u7acb\u6267\u884c\uff0c\u53ef\u80fd\u4f1aimport\u5bfc\u5165\u91cd\u590d\u7684\u6a21\u5757\u3002</p> <p>\u53ef\u8003\u8651\u5c06\u7b2c\u4e00\u4e2a Cell \u4e13\u7528\u4f5c import Cell\uff0c\u540e\u9762\u5176\u4ed6 Cell \u6240\u9700\u7684\u6a21\u5757\u90fd\u96c6\u4e2d\u5728\u6b64 import\u3002 \u6bcf\u5f53\u7b2c\u4e00\u4e2a Cell \u5bfc\u5165\u4e86\u65b0\u6a21\u5757\u540e\uff0c\u91cd\u65b0\u8fd0\u884c\u8be5 Cell \u5bfc\u5165\u66f4\u65b0\u751f\u6548\uff0c\u540e\u7eed\u5c31\u65e0\u9700\u91cd\u590d\u5bfc\u5165\u4e86\u3002</p> <ul> <li>Importing Jupyter Notebooks as Modules</li> </ul> <p>\u8fd0\u884c\u8fc7\u7684Cell\u4ee3\u7801\uff0c\u5df2\u7ecf\u5bfc\u5165\u5230\u540c\u4e00\u4e0a\u4e0b\u6587\u4e2d\uff0c\u56e0\u6b64\u53ef\u4ee5\u6267\u884c\u8de8Cell\u76f8\u4e92\u8c03\u7528\uff08\u7c7b/\u51fd\u6570\uff09\uff0c\u6216\u5728\u4e00\u4e2aCell\u4e2d\u4e3a\u5176\u4ed6Cell\u7f16\u5199\u5355\u5143\u6d4b\u8bd5\u3002</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#jupyterlab","title":"JupyterLab","text":"<p><code>JupyterLab</code>: A Next-Generation Notebook Interface</p> <p>JupyterLab is the latest web-based interactive development environment for notebooks, code, and data. Its flexible interface allows users to configure and arrange workflows in data science, scientific computing, computational journalism, and machine learning. A modular design invites extensions to expand and enrich functionality.</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#docs","title":"docs","text":"<p>Jupyter Project Documentation</p> <ul> <li>Docs \u00bb JupyterLab Documentation</li> <li>The Jupyter Notebook</li> </ul> <p>jupyterlab\u2014\u2014\u4e0b\u4e00\u4ee3notebook JupyterLab\u2014\u2014\u6781\u5176\u5f3a\u5927\u7684\u4e0b\u4e00\u4ee3notebook\uff01 </p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#starting","title":"Starting","text":"<p>Docs \u00bb Starting JupyterLab</p> <p>JupyterLab sessions always reside in a workspace. </p> <p>The default workspace is the main <code>/lab</code> URL:</p> <pre><code>http(s)://&lt;server:port&gt;/&lt;lab-location&gt;/lab\n</code></pre>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#launch_1","title":"launch","text":"<p>\u5728 Anaconda Navigator \u4e2d\u70b9\u51fb\u542f\u52a8 JupyterLab \u4f1a\u5f00\u4e00\u4e2a\u7ec8\u7aefTerminal\u5e76\u542f\u52a8 python webServer\u3002 \u5c06\u4f1a\u5728\u9ed8\u8ba4\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 http://localhost:8888/lab \u3002</p> <p>\u5728 JupyterLab \u4e2d New Launcher \u652f\u6301\u521b\u5efa Notebook - Python 3 (ipykernel) \u548c Console - Python 3 (ipykernel)\u3002 \u8fd8\u53ef\u521b\u5efa Other \u6587\u4ef6\u7c7b\u578b\u3002</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#urls","title":"URLs","text":"<p>Docs \u00bb JupyterLab URLs</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#file_navigation_with_tree","title":"File Navigation with <code>/tree</code>","text":"<p>JupyterLab\u2019s file navigation URLs adopts the nomenclature of the classic notebook; these URLs are <code>/tree</code> URLs:</p> <pre><code>http(s)://&lt;server:port&gt;/&lt;lab-location&gt;/lab/tree/path/to/notebook.ipynb\n</code></pre> <p>By default, the file browser will navigate to the directory containing the requested file. This behavior can be changed with the optional <code>file-browser-path</code> query parameter:</p> <pre><code>http(s)://&lt;server:port&gt;/&lt;lab-location&gt;/lab/tree/path/to/notebook.ipynb?file-browser-path=/\n</code></pre> <p>Entering the above URL will show the workspace root directory instead of the <code>/path/to/</code> directory in the file browser.</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#managing_workspaces_ui","title":"Managing Workspaces (UI)","text":"<p>JupyterLab sessions always reside in a workspace. Workspaces contain the state of JupyterLab: the <code>files</code> that are currently open, the <code>layout</code> of the application areas and tabs, etc. When the page is refreshed, the workspace is restored.</p> <p>The default workspace does not have a name and resides at the primary <code>/lab</code> URL:</p> <pre><code>http(s)://&lt;server:port&gt;/&lt;lab-location&gt;/lab\n</code></pre> <p>All other workspaces have a name that is part of the URL:</p> <pre><code>http(s)://&lt;server:port&gt;/&lt;lab-location&gt;/lab/workspaces/foo\n</code></pre> <p>Workspaces ++save their state++ on the server and can be shared between multiple users (or browsers) as long as they have access to the same server.</p> <p>A workspace should only be open in a single browser tab at a time. If JupyterLab detects that a workspace is being opened multiple times simultaneously, it will prompt for a new workspace name.</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#managing_workspaces_cli","title":"Managing Workspaces (CLI)","text":"<p>JupyterLab provides a command-line interface for workspace <code>import</code> and <code>export</code>:</p> <pre><code>$ jupyter lab workspaces export\n$ jupyter lab workspaces export &gt; ~/Downloads/jupyter_workspaces.json\n</code></pre>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#debugger","title":"Debugger","text":"<p>Debugger \u2014 JupyterLab 4.1.2 documentation</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#notebook_vs_lab","title":"Notebook vs. Lab","text":"<p>Jupyter notebook \u548c Jupyter lab \u7684\u533a\u522b Jupyter Lab\u5bf9\u6bd4Jupyter Notebook\u6709\u4ec0\u4e48\u4f18\u70b9\u548c\u4e0d\u8db3\uff1f What is the difference between Jupyter Notebook and JupyterLab? </p> <p>Jupyter Notebook \u662f\u4e00\u4e2a\u6b3e\u4ee5\u7f51\u9875\u4e3a\u57fa\u7840\u7684\u4ea4\u4e92\u8ba1\u7b97\u73af\u5883\uff0c\u53ef\u4ee5\u521b\u5efaJupyter\u7684\u6587\u6863\uff0c\u652f\u6301\u591a\u79cd\u8bed\u8a00\uff0c\u5305\u62ecPython, Julia, R\u7b49\u7b49\u3002\u5e7f\u6cdb\u7528\u4e8e\u6570\u636e\u5206\u6790\uff0c\u6570\u636e\u53ef\u89c6\u5316\u548c\u5176\u4ed6\u7684\u4ea4\u4e92\u548c\u63a2\u7d22\u6027\u8ba1\u7b97\u4e2d\u3002</p> <p>JupyterLab \u662f\u5305\u62ec\u4e86Notebook\u7684\u4e0b\u4e00\u4ee3\u7528\u6237\u754c\u9762\u3002\u6709\u6a21\u5757\u5316\u7684\u754c\u9762\uff0c\u53ef\u4ee5\u5728\u540c\u4e00\u4e2a\u7a97\u53e3\u540c\u65f6\u6253\u5f00\u597d\u51e0\u4e2anotebook\u6216\u6587\u4ef6\uff08HTML, TXT, Markdown\u7b49\u7b49\uff09\uff0c\u90fd\u4ee5\u6807\u7b7e\u7684\u5f62\u5f0f\u5c55\u793a\uff0c\u4e8e\u662f\u5c31\u66f4\u50cf\u662f\u4e00\u4e2aIDE\u3002</p> <p>\u5efa\u8bae\u4f7f\u7528 JupyterLab \u6216\u8005 vscode + Jupyter Notebook\u3002</p>","tags":["Jupyter"]},{"location":"blog/20191201/6-JupyterNotebook-JupyterLab/#jetbrains_datalore","title":"JetBrains Datalore","text":"<p>\u5728 Anaconda-Navigator \u542f\u52a8\u9762\u677f\u4e2d\uff0c\u9664\u4e86 Jupyter Notebook \u548c JupyterLab\uff0c\u8fd8\u53ef\u4f7f\u7528 JetBrains \u7684 Datalore\u3002</p> <p>https://www.anaconda.com/datalore_navigator \u91cd\u5b9a\u5411\u5230 https://www.jetbrains.com/datalore/</p> <p>\u4e2a\u4eba\u7528\u6237\u70b9\u51fb\u3010Start for free\u3011-&gt;\u3010For Yourself\u3011-&gt;\u3010Community Plan\u3011\uff0c\u7136\u540e\u4f7f\u7528Google\u8d26\u53f7\u767b\u5f55\u5373\u53ef\u3002</p> <p>Datalore \u76f8\u8f83 Jupyter Notebook \u548c JupyterLab\uff0c\u81ea\u5e26\u7684\u4ee3\u7801\u63d0\u793a\u6bd4\u8f83\u5f3a\u5927\uff01</p> <p>How to Get the Best Autocomplete in Jupyter Notebooks and More</p>","tags":["Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/","title":"vscode Jupyter Notebook","text":"<p>vscode \u4e2d Jupyter Notebook \u4f7f\u7528\u7b80\u4ecb\u3002</p>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#vscode_jupyter","title":"vscode Jupyter","text":"<p>Jupyter Notebooks in VS Code</p> <ul> <li>Setting up your environment</li> <li>Workspace Trust</li> <li>Create or open a Jupyter Notebook</li> <li>Running cells</li> <li>Save your Jupyter Notebook</li> <li>Export your Jupyter Notebook</li> <li>Work with code cells in the Notebook Editor</li> <li>Table of Contents</li> <li>IntelliSense support in the Jupyter Notebook Editor</li> <li>Variable Explorer and Data Viewer</li> <li>Saving plots</li> <li>Custom notebook diffing</li> <li>Debug a Jupyter Notebook</li> <li>Connect to a remote Jupyter server</li> <li>Data Science profile template</li> </ul> <p>Python Interactive</p> <ul> <li>Jupyter code cells</li> <li>Using the Python Interactive window</li> <li>Variables Explorer and Data Viewer</li> <li>Connect to a remote Jupyter server</li> <li>Convert Jupyter notebooks to Python code file</li> <li>Debug a Jupyter notebook</li> <li>Export a Jupyter notebook</li> </ul> <p>\u5728VS Code\u4e2d\u4f7f\u7528Jupyter Notebooks</p> <p>Jupyter \u63d2\u4ef6\u5df2\u7ecf Deprecated\uff0c\u53ea\u9700\u8981\u5b89\u88c5 Microsoft Python \u63d2\u4ef6\u5373\u53ef\uff0c\u5fae\u8f6f\u5b98\u65b9\u63d0\u4f9b\u4e86 Python \u63d2\u4ef6\u5df2\u7ecf\u5185\u5d4c\u6253\u5305\u4e86 Jupyter \u63d2\u4ef6\uff08\u53ef\u901a\u8fc7 Extension Pack \u67e5\u770b\uff09\u3002</p> <ol> <li> <p><code>Python</code>: IntelliSense (Pylance), Linting, Debugging (multi-threaded, remote), Jupyter Notebooks, code formatting, refactoring, unit tests, and more.</p> <ul> <li>Extension Pack: <code>Pylance</code>, <code>Jupyter</code> and <code>isort</code>.</li> </ul> </li> <li> <p><code>Jupyter</code>: Jupyter notebook support, interactive programming and computing that supports Intellisense, debugging and more.</p> <ul> <li>Extension Pack: <code>Jupyter Keymap</code>, <code>Jupyter Notebook Renderers</code>, <code>Jupyter Slide Show</code>, <code>Jupyter Cell Tags</code>.</li> </ul> </li> </ol> <p>\u5728 Command Palette \u4e2d\u8f93\u5165 <code>Jupyter:</code> \u53ef\u67e5\u770b\u76f8\u5173\u547d\u4ee4\u3002</p>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#jupyter_code_cells","title":"Jupyter Code Cells","text":"<p>Python Interactive - Jupyter code cells</p> <ul> <li>You define Jupyter-like code cells within Python code using a <code># %%</code> comment.</li> </ul> <p>VSCode \u7f16\u5199 Python \u652f\u6301 Jupyter notebook \u4e86 </p> <p>Jupyter notebook\u662f\u9010\u4e2acell\u4f9d\u6b21\u6267\u884c\uff0c\u90a3\u5728VS Code\u8981\u600e\u4e48\u505a\u5230\u8fd9\u70b9\u5462\uff1f</p> <p>\u5728 vscode \u63a7\u5236\u9762\u677f\u4e2d\uff0c\u70b9\u9009 <code>Jupyter: Add Empty Cell to File</code>\uff0c\u5c06\u4f1a\u5728\u5149\u6807\u5904\u63d2\u5165 <code># %%</code>\u3002</p> <p>\u5728 vscode \u4e2d\u521b\u5efa\u6587\u672c\u6587\u4ef6\uff0c\u5c06 Language Mode \u8bbe\u5b9a\u4e3a Python\uff0c\u4ee5 <code>#%%</code> \u5f00\u5934\u5373\u4f1a\u88ab\u8bc6\u522b\u4e3a\u4e00\u4e2a Jupyter Cell\uff0c\u65b9\u4fbf\u5feb\u6377\u8c03\u8bd5\u3002  </p> <pre><code>#%%\nmsg = 'hello, world'\nprint(msg)\n</code></pre> <p></p>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#jupyter_notebook","title":"Jupyter Notebook","text":"<p>\u5982\u4f55\u5728vscode\u4e2d\u4f7f\u7528Jupyter Notebook VSCode \u4e2d Jupyter Notebook \u4e92\u52a8\u7f16\u7a0b</p> <p>Jupyter Notebooks - Create or open a Jupyter Notebook</p> <p>\u5728 vscode \u63a7\u5236\u9762\u677f\u4e2d\uff0c\u70b9\u9009 <code>Create: New Jupyter Notebook</code> \u5219\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 Notebook\uff08Untitled-1.ipynb\uff09\u3002</p> <p>ipynb \u4e3a IPython Note Book \u540e\u7f00\u3002</p> <p>vscode \u4e5f\u652f\u6301\u76f4\u63a5\u6253\u5f00 Notebook \u6587\u4ef6\uff08*.ipynb\uff09\uff0c\u8fdb\u884c\u7f16\u8f91\u8fd0\u884c\u3002</p> <p>Jupyter Notebooks - Work with code cells in the Notebook Editor</p> <p>\u4ee3\u7801\u5355\u5143\u683c\u6a21\u5f0f\uff1a</p> <p>\u5728\u5904\u7406\u4ee3\u7801\u5355\u5143\u65f6\uff0c\u5355\u5143\u683c\u53ef\u4ee5\u5904\u4e8e\u4e09\u79cd\u72b6\u6001\uff1a\u672a\u9009\u5b9a\u3001\u547d\u4ee4\u6a21\u5f0f\u548c\u7f16\u8f91\u6a21\u5f0f\u3002\u5355\u5143\u683c\u7684\u5f53\u524d\u72b6\u6001\u7531\u4ee3\u7801\u5355\u5143\u548c\u7f16\u8f91\u5668\u8fb9\u6846\u5de6\u4fa7\u7684\u5782\u76f4\u6761\u8868\u793a\u3002 \u5f53\u770b\u4e0d\u5230\u5de6\u4fa7\u5782\u76f4\u6761\u548c\u805a\u7126\u8fb9\u6846\u65f6\uff0c\u5355\u5143\u683c\u662f\u672a\u9009\u5b9a\u72b6\u6001\u3002</p> <p>\u6dfb\u52a0\u5176\u4ed6\u4ee3\u7801\u5355\u5143\u683c\uff1a</p> <p>\u652f\u6301 + Code\u3001+ Markdown \u521b\u5efa\u4ee3\u7801\u6216Markdown Cell\uff0c\u65b9\u4fbf\u5199\u4ee3\u7801\u517c\u505a\u7b14\u8bb0\u3002</p> <p>InterelliSense\uff1a</p> <p>Jupyter Notebooks - IntelliSense support in the Jupyter Notebook Editor</p> <p>vscode \u4e2d\u7f16\u8f91 Jupyter Notebooks\uff0c\u63d0\u4f9b\u5b8c\u6574\u7684 InterelliSense \u652f\u6301\uff0c\u5305\u62ec\u4ee3\u7801\u81ea\u52a8\u5b8c\u6210\u3001\u6210\u5458\u5217\u8868\u3001\u65b9\u6cd5\u7684\u5feb\u901f\u4fe1\u606f\u548c\u53c2\u6570\u63d0\u793a\u3002 \u5728 Notebooks \u7f16\u8f91\u5668\u7a97\u53e3\u4e2d\uff0c\u60a8\u53ef\u4ee5\u4e0e\u5728\u4ee3\u7801\u7f16\u8f91\u5668\u4e2d\u4e00\u6837\u9ad8\u6548\u5730\u8f93\u5165\u4e66\u5199Python\u4ee3\u7801\u3002</p>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#notebook_cell_operations","title":"Notebook Cell Operations","text":"","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#\u6298\u53e0cell","title":"\u6298\u53e0cell","text":"<p>\u5f53\u6709\u591a\u4e2aCode Cell\u4e14cell\u4ee3\u7801\u5f88\u957f\u65f6\uff0c\u53ef\u8003\u8651\u5c06\u6682\u65f6\u4e0d\u770b\u7684cell\u6298\u53e0\u8d77\u6765\uff0c\u4ee5\u4fbf\u805a\u7126\u5f53\u524dcell\u3002</p> <p>\u70b9\u51fbCell\u8fb9\u6846\u5916\u62d6\u62fd\u533a\u5de6\u4fa7\u7684\u84dd\u8272bar\u53ef\u6298\u53e0\u5f53\u524dCell\u3002</p> <p>python - VS Code editing .ipynb file: How to collapse notebook cells? - Stack Overflow</p> <p>Notebook cells have a blue bar on the left side to indicate that they are focused. This bar is now interactive - you can click the top part to collapse the cell input, and the bottom part to collapse the output.</p> <p>vscode settings:</p> <p>Notebook: Show Folding Controls</p> <ul> <li>Controls when the Markdown header folding arrow is shown.</li> <li> mouseover</li> </ul>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#outline\u4e2d\u663e\u793acells","title":"outline\u4e2d\u663e\u793aCells","text":"<p>\u5f53\u6709\u591a\u4e2aCode Cell\u4e14cell\u4ee3\u7801\u5f88\u957f\u65f6\uff0c\u9664\u4e86\u53ef\u4ee5\u5728\u7f16\u8f91\u533a\u5c06\u6682\u65f6\u4e0d\u770b\u7684cell\u6298\u53e0\u8d77\u6765\uff0c\u4e5f\u53ef\u5728 Breadcrumbs(<code>\u2325M</code>) \u5bfc\u822acells\u3002</p> <p>vscode settings:</p> <p>Notebook \u203a Breadcrumbs: Show Code Cells (\"notebook.breadcrumbs.showCodeCells\": true)</p> <ul> <li> When enabled notebook breadcrumbs contain code cells.</li> </ul> <p>\u4e5f\u53ef\u914d\u7f6e\u4f7fCode Cells\u663e\u793a\u5728outline\u89c6\u56fe\u4e2d\uff0c\u7136\u540e\u5728 outline \u89c6\u56fe\u4e2d\u70b9\u51fb\u5feb\u901f\u5b9a\u4f4d\u8df3\u8f6c\u3002</p> <p>vscode settings:</p> <p>Notebook \u203a Outline: Show Code Cells (\"notebook.outline.showCodeCells\": true)</p> <ul> <li> When enabled notebook outline shows code cells.</li> </ul>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#\u9f20\u6807\u62d6\u62fd\u4e0a\u4e0b\u79fb\u52a8","title":"\u9f20\u6807\u62d6\u62fd\u4e0a\u4e0b\u79fb\u52a8","text":"<p>\u5728 Cell \u8fb9\u6846\u7ebf\u5de6\u4fa7 Gutter \u533a\u9f20\u6807\u62d6\u52a8\u652f\u6301 Move Up/Down\uff0c\u4e0a\u4e0b\u79fb\u52a8\u8c03\u6574 cell \u7684\u4f4d\u7f6e\u3002</p> <p>vscode settings:</p> <p>Notebook: Drag And Drop Enabled (\"notebook.dragAndDropEnabled\": true)</p> <ul> <li> Control whether the notebook editor should allow moving cells through drag and drop.</li> </ul>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#\u663e\u793a\u884c\u53f7","title":"\u663e\u793a\u884c\u53f7","text":"<p>Cell Toobar \u66f4\u591a\u70b9\u9009 Show Cell Line Numbers\uff0c\u663e\u793a\u884c\u53f7\u3002</p> <p>vscode settings:</p> <p>Notebook: Line Numbers (\"notebook.lineNumbers\": \"on\")</p> <p>Controls the display of line numbers in the cell editor.</p> <ul> <li> on</li> </ul>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#output","title":"output","text":"<p>Code Cell \u8fd0\u884c\u7ed3\u679c\uff08output\uff09\u53ef\u80fd\u8f93\u51fa\u884c\u5bbd\u5ea6\u8d85\u51fa\u7f16\u8f91\u5668\uff0c\u53ef\u4ee5\u6253\u5f00 <code>wordWrap</code> \u9009\u9879\uff1a</p> <p>Notebook \u203a Output: Word Wrap (\"notebook.output.wordWrap\": true)</p> <ul> <li>Controls whether the lines in output should wrap.</li> </ul> <p>Code Cell \u8fd0\u884c\u7ed3\u679c\uff08output\uff09\u9ed8\u8ba4\u8f93\u51fa30\u884c\uff0c\u5982\u679c\u8f93\u51fa\u8d85\u957f\u4f1a\u622a\u65ad\u5e76\u63d0\u793a\uff1a</p> <p>Output is truncated. View as a scrollable element or open in a text editor.</p> <p>\u53ef\u4ee5\u6253\u5f00 <code>scrolling</code> \u9009\u9879\uff0c\u652f\u6301\u7eb5\u5411\u6eda\u52a8\uff1a</p> <p>Notebook \u203a Output: Scrolling (\"notebook.output.scrolling\": true)</p> <ul> <li>Initially render notebook outputs in a scrollable region when longer than the limit.</li> </ul> <p>\u4e5f\u53ef\u4fee\u6539\u9ed8\u8ba4\u7684\u884c\u6570\u9650\u5236 <code>textLineLimit</code>\uff1a</p> <p>Notebook \u203a Output: Text Line Limit (\"notebook.output.textLineLimit\": 100)</p> <ul> <li>Controls how many lines of text are displayed in a text output.</li> </ul>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#run__debug_cell","title":"Run &amp; Debug Cell","text":"<p>Jupyter Notebooks - Running cells</p> <ul> <li>Execute Cell: <code>\u2303Enter</code></li> <li>Debug Cell: <code>\u2303\u21e7Enter</code></li> </ul>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#requires_ipykernel_package","title":"requires ipykernel package","text":"<p>vscode \u6253\u5f00\u666e\u901a Python File\uff0c\u7136\u540e\u5728\u53f3\u4e0a\u89d2 \u25b6\ufe0e \u6309\u94ae\u4e0b\u62c9\u9009\u62e9 <code>Run Current File in Interactive Window</code>\uff0c\u6216\u5728 Notebook \u7684\u53f3\u4e0a\u89d2\u9009\u62e9 Kernel \u4e3a\u6700\u65b0 brew \u66f4\u65b0\u7684 python3.12\uff0c\u63d0\u793a requires the ipykernel package\uff1a</p> <pre><code>Running cells with '/usr/local/bin/python3.12' requires the ipykernel package.  \nRun the following command to install 'ipykernel' into the Python environment.   \nCommand: '/usr/local/bin/python3.12 -m pip install ipykernel -U --user --force-reinstall'\n</code></pre> <p>\u5177\u4f53\u53c2\u8003 Jupyter Kernels and the Jupyter Extension \u00b7 microsoft/vscode-jupyter Wiki\u3002</p> <p>ipykernel \u662f IPython Kernel for Jupyter\uff0cbrew \u66f4\u65b0\u5b89\u88c5\u6700\u65b0\u7684 python3.12 \u9ed8\u8ba4\u6ca1\u6709\u5b89\u88c5\uff0c\u9700\u8981\u81ea\u884c\u5b89\u88c5\u3002 \u53ef\u6267\u884c <code>pip3 show ipykernel</code> \u6838\u5b9e\u662f\u5426\u5b89\u88c5\uff0c\u5728 conda base \u4e2d\u6838\u5b9e\u6709\u5b89\u88c5\uff1a</p> <pre><code># macOS \u6ca1\u6709\u5b89\u88c5\n$ pip3 show ipykernel\nWARNING: Package(s) not found: ipykernel\n\n# conda base \u4e2d\u6709\u5b89\u88c5\n$ conda list | grep ipy\n\n$ conda activate base\n$ pip3 show ipykernel\nName: ipykernel\nVersion: 6.28.0\nSummary: IPython Kernel for Jupyter\n\nLocation: /usr/local/anaconda3/lib/python3.9/site-packages\n</code></pre> <p>\u7531\u4e8eanaconda\u7684\u79d1\u5b66\u8ba1\u7b97\u5de5\u5177\u5305\u6bd4\u8f83\u9f50\u5168\uff0c\u53ef\u8003\u8651\u76f4\u63a5\u4f7f\u7528 conda base kernel \u7528\u4e8e vscode Notebook \u8c03\u8bd5\u3002</p> <p>\u5982\u679c\u60f3\u4f53\u9a8c macOS brew \u5347\u7ea7\u7684\u6700\u65b0 python3.12 \u7684\u67d0\u4e9b\u65b0\u529f\u80fd\u7279\u6027\uff0c\u53ef\u4ee5\u81ea\u884c\u4f7f\u7528 pip3 \u5b89\u88c5 ipykernel\u3002</p> <p>\u53c2\u8003\uff1a</p> <p>Vscode jupyter notebook requires ipykernel : r/learnpython</p> <p>Make sure to install the Jupyter extension, first. Then Press Command+Shift+P to open a new command pallete, Type &gt;Python: Select Intepreter to start jupyter notebook server</p> <p>ipykernel not detected ('Running cells with 3.9.13 (base) requires ipykernel package installed or requires an update') \u00b7 Issue #20306 \u00b7 microsoft/vscode-python</p> <p>visual studio code - Python requires ipykernel to be installed - Stack Overflow</p>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#importrun_across_cells","title":"import/run across cells","text":"<p>\u5f53\u6709\u591a\u4e2aCell\u65f6\uff0c\u7531\u4e8e\u6bcf\u4e2aCell\u90fd\u662f\u53ef\u4ee5\u72ec\u7acb\u6267\u884c\uff0c\u53ef\u80fd\u4f1aimport\u5bfc\u5165\u91cd\u590d\u7684\u6a21\u5757\u3002</p> <p>\u53ef\u8003\u8651\u5c06\u7b2c\u4e00\u4e2a Cell \u4e13\u7528\u4f5c import Cell\uff0c\u540e\u9762\u5176\u4ed6 Cell \u6240\u9700\u7684\u6a21\u5757\u90fd\u96c6\u4e2d\u5728\u6b64 import\u3002 \u6bcf\u5f53\u7b2c\u4e00\u4e2a Cell \u5bfc\u5165\u4e86\u65b0\u6a21\u5757\u540e\uff0c\u91cd\u65b0\u8fd0\u884c\u8be5 Cell \u5bfc\u5165\u66f4\u65b0\u751f\u6548\uff0c\u540e\u7eed\u5c31\u65e0\u9700\u91cd\u590d\u5bfc\u5165\u4e86\u3002</p> <ul> <li>Importing Jupyter Notebooks as Modules</li> </ul> <p>\u8fd0\u884c\u8fc7\u7684Cell\u4ee3\u7801\uff0c\u5df2\u7ecf\u5bfc\u5165\u5230\u540c\u4e00\u4e0a\u4e0b\u6587\u4e2d\uff0c\u56e0\u6b64\u53ef\u4ee5\u6267\u884c\u8de8Cell\u76f8\u4e92\u8c03\u7528\uff08\u7c7b/\u51fd\u6570\uff09\uff0c\u6216\u5728\u4e00\u4e2aCell\u4e2d\u4e3a\u5176\u4ed6Cell\u7f16\u5199\u5355\u5143\u6d4b\u8bd5\u3002</p> <p></p>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#debug_cell","title":"Debug Cell","text":"<ul> <li>How notebook debug cell works \u00b7 microsoft/vscode-jupyter Wiki</li> <li>Jupyter Notebooks in VS Code - Debug a Jupyter Notebook</li> <li>Python Interactive - Debug a Jupyter notebook</li> </ul> <p>There are two different ways to debug a Jupyter notebook: </p> <ul> <li>a simpler mode called <code>Run by Line</code>, first button in the cell toolbar;</li> <li>full debugging mode - <code>Debug Cell</code> adornment that appears above the cell.</li> </ul> <p>If you want to use the full set of debugging features supported in VS Code, such as breakpoints and the ability to step in to other cells and modules, you can use the full VS Code debugger.</p> <ol> <li>Start by setting any breakpoints you need by clicking in the left margin of a notebook cell.</li> <li>Then select the <code>Debug Cell</code> button in the menu next to the Run button. This will run the cell in a debug session, and will pause on your breakpoints in any code that runs, even if it is in a different cell or a <code>.py</code> file.</li> <li>You can use the Debug view, Debug Console, and all the buttons in the Debug Toolbar as you normally would in VS Code.</li> </ol> <p>\u53ef\u6267\u884c\u8de8Cell\u8c03\u7528\u65ad\u70b9\u8c03\u8bd5\u3002</p>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#notebook_diffing","title":"notebook diffing","text":"<p>Viewing Ipython Notebooks' line based diff in VS Code while using the Python extension - Stack Overflow SOLVED - Have vscode-jupyter do proper diffing in Git \u00b7 microsoft/vscode-jupyter \u00b7 Discussion #10742</p> <p>vscode \u4e2d Jupyter Notebook \u6587\u4ef6 *.ipynb \u6709\u6539\u52a8\u65f6\uff0c\u5728\u5de6\u4fa7 SOURCE CONTROL \u4e2d git changes \u53cc\u51fb\u6253\u5f00 diff\uff0c\u53ef\u80fd\u65e0\u6cd5\u5c55\u793a\u6539\u52a8\u70b9\u3002</p> <p>Custom notebook diffing</p> <ol> <li>\u66f4\u591a\u91cc\u52fe\u9009 Show Metadata Differences\uff0c\u4e0d\u52fe\u9009 Show Output Differences\uff0c\u52fe\u9009 Show Moved Code Blocks\u3002</li> <li>\u5982\u679c\u8fd8\u662f\u4e0d\u663e\u793adiff\uff0c\u70b9\u51fb\u53f3\u4e0a\u89d2\u5de5\u5177\u6761\u7684 Open Text Diff Editor \u76f4\u63a5\u6bd4\u8f83\u6587\u672c\u5185\u5bb9\u3002</li> <li>\u53ef\u70b9\u51fb\u53f3\u4e0a\u89d2\u5de5\u5177\u6761\u7684 Toggle Collapse Unchanged Regions\uff0c\u9690\u85cf\u672a\u53d8\u52a8\u7684\u90e8\u5206\u3002</li> </ol>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#conversion","title":"conversion","text":"<p>Jupyter Notebooks - Export your Jupyter Notebook</p> <ul> <li>You can export a Jupyter Notebook as a Python file (<code>.py</code>), a PDF, or an HTML file. To export, select the Export action on the main toolbar.</li> </ul> <p>Python Interactive - Convert Jupyter notebooks to Python code file: </p> <ul> <li>The notebook's cells are delimited in the Python file with\u00a0<code># %%</code>\u00a0comments;</li> <li>Markdown cells are converted wholly to comments preceded with\u00a0<code># %% [markdown]</code></li> </ul> <p>Python Interactive - Export a Jupyter notebook: Convert a Python file to a Jupyter notebook</p> <ul> <li>to export content from a Python file in VS Code to a Jupyter notebook</li> <li>using the <code># %%</code> and <code># %% [markdown]</code> delimiters to specify their respective cell types.</li> </ul>","tags":["vscode","Jupyter"]},{"location":"blog/20191201/7-vscode-jupyter-notebook/#unittest","title":"unittest","text":"<p>Unit tests - Jupyter Tutorial 1.1.0</p> <ul> <li>How to do unit test inside jupyternotebook | by Stan | Medium</li> <li>python - Unit tests for functions in a Jupyter notebook? - Stack Overflow</li> </ul> <p>\u5047\u8bbeCell 1\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a\u51fd\u6570Cell\uff1a</p> <pre><code>def add(a, b):\n    return a + b\n</code></pre> <p>\u53ef\u4ee5\u5728Cell 2\u4e2d\u7f16\u5199\u6d4b\u8bd5Cell 1\u4e2dadd\u51fd\u6570\u7684\u5355\u6d4b\u7528\u4f8b\uff1a</p> <ul> <li>\u8fd0\u884cCell2\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u8fd0\u884cCell1\u4f7f\u4e4b\u52a0\u8f7d\u3002</li> </ul> <pre><code>import unittest\n\nclass TestNotebook(unittest.TestCase):\n\n    def test_add(self):\n        self.assertEqual(add(2, 3), 5)\n\n\nunittest.main(argv=[''], verbosity=2, exit=False)\n</code></pre> <p>\u9664\u4e86\u4f7f\u7528\u5e38\u89c4\u7684 Python \u5355\u5143\u6d4b\u8bd5\u6846\u67b6 unittest\uff0c\u8fd8\u53ef\u4f7f\u7528 ipython-unittest\u3002</p> <p>After install(pip3 install ipython-unittest), please run <code>%load_ext ipython_unittest</code> in Cell to load the extension.</p> <p>ipython-unittest enables the following Cell Magics to be used in iPython:</p> <ul> <li><code>%%unittest_main</code>: executes test cases that are defined in a cell</li> <li><code>%%unittest_testcase</code>: creates a test case with the function defined in a cell and executes it</li> <li><code>%%unittestconverts</code>: Python assert to unit test functions</li> <li><code>%%external</code>: to perform external unit tests</li> <li><code>%%write</code>: {mode} to write external files</li> </ul> <p>\u4e3a\u517c\u5bb9\u671f\u95f4\uff0c\u5efa\u8bae\u4f7f\u7528 Python \u6807\u51c6\u7684\u5355\u5143\u6d4b\u8bd5\u6846\u67b6 unittest\u3002</p>","tags":["vscode","Jupyter"]},{"location":"blog/20200201/compiler-toolchain/","title":"Compiler Toolchain","text":"<p>Overview of concepts of Toolchain, Cross Compiler and Cross Compiler Toolchain.</p>"},{"location":"blog/20200201/compiler-toolchain/#toolchain","title":"Toolchain","text":"<p>Toolchain</p> <p>In software, a toolchain is a set of programming tools that are used to perform a complex software development task or to create a software product, which is typically another computer program or a set of related programs. In general, the tools forming a toolchain are executed consecutively so the output or resulting environment state of each tool becomes the input or starting environment for the next one, but the term is also used when referring to a set of related tools that are not necessarily executed consecutively.</p> <p>A simple software development toolchain often refers to the necessary tools to develop for a given operating system running a certain CPU architecture, consisting of a compiler and linker (which transform the source code into an executable program), libraries (which provide interfaces to the operating system), and a debugger (which is used to test and debug created programs). Cross-compilation toolchains are also available. A complex software product such as a video game needs tools for preparing sound effects, music, textures, 3-dimensional models and animations, together with additional tools for combining these resources into the finished product.</p> <p>What exactly is a compiler tool chain?</p> <p>Ajinkya RC</p> <p>Every program of any language is written in a high level language. This must be converted to machine understandable language. So, Compiler is the predefined set of program that does this activity. Also, there are number of different components that play important role. This whole set of components is nothing but the Compiler tool chain.</p> <p>Lets consider the simple C program: When we write a normal program <code>hello.c</code> and compile it, compiler converts it into a machine code. It creates a <code>hello.obj</code> file but its not executable at this stage.</p> <p>After this, Linker comes into the picture. It links some additional code with that <code>.obj</code> file. Linker also gives a magic number with this code and this process is called as 'Primary Header'. It also links static and dynamic library functions to this code. This additional code helps the <code>.obj</code> file to be executable.</p> <p>Now, Loader does the further work. Loader splits the code in S, T &amp; D sections. These sections are present on the RAM. Stack contains all the functions in the code. Text section contains the information of the functions and others texts present in the program and Data section contains all the data.</p> <p>Thus the execution of the code takes place when the program goes from Hard Disk to RAM.</p> <p>Here the compiler tool chain contains three basic elements, first compiler itself, second Linker and third Loader.</p>"},{"location":"blog/20200201/compiler-toolchain/#cross_compiler","title":"Cross compiler","text":"<p>Cross compiler</p> <p>A cross compiler is a compiler capable of creating executable code for a platform other than the one on which the compiler is running. For example, a compiler that runs on a PC but generates code that runs on Android devices is a cross compiler.</p> <p>A cross compiler is useful to compile code for multiple platforms from one development host. Direct compilation on the target platform might be infeasible, for example on embedded systems with limited computing resources.</p> <p>Cross compilers are distinct from source-to-source compilers. A cross compiler is for cross-platform software generation of machine code, while a source-to-source compiler translates from one coding language to another in text code. Both are programming tools.</p>"},{"location":"blog/20200201/compiler-toolchain/#elinux_toolchains","title":"eLinux Toolchains","text":"<p>Toolchains - eLinux.org</p> <p>A toolchain is a set of distinct software development tools that are linked (or chained) together by specific stages such as <code>GCC</code>, <code>binutils</code> and <code>glibc</code> (a portion of the GNU Toolchain). Optionally, a toolchain may contain other tools such as a debugger or a compiler for a specific programming language, such as C++. Quite often, the toolchain used for embedded development is a cross toolchain, or more commonly known as a cross compiler. All the programs (like GCC) run on a host system of a specific architecture (such as x86), but they produce binary code (executables) to run on a different architecture (for example, ARM). This is called cross compilation and is the typical way of building embedded software. It is possible to compile natively, running GCC on your target. Before searching for a prebuilt toolchain or building your own, it's worth checking to see if one is included with your target hardware's Board Support Package (BSP) if you have one.</p> <p>When talking about toolchains, one must distinguish three different machines:</p> <ul> <li>the <code>build</code> machine, on which the toolchain is built  </li> <li>the <code>host</code> machine, on which the toolchain is executed  </li> <li>the <code>target</code> machine, for which the toolchain generates code  </li> </ul> <p>From these three different machines, we distinguish four different types of toolchain building processes :</p> <ul> <li>A native toolchain, as can be found in normal Linux distributions, has usually been compiled on x86, runs on x86 and generates code for x86.</li> <li>A cross-compilation toolchain, which is the most interesting toolchain type for embedded development, is typically compiled on x86, runs on x86 and generates code for the target architecture (be it ARM, MIPS, PowerPC or any other architecture supported by the different toolchain components)</li> <li>A cross-native toolchain, is a toolchain that has been built on x86, but runs on your target architecture and generates code for your target architecture. It's typically needed when you want a native GCC on your target platform, without building it on your target platform.</li> <li>A Canadian build is the process of building a toolchain on machine A, so that it runs on machine B and generates code for machine C. It's usually not really necessary.</li> </ul>"},{"location":"blog/20200201/compiler-toolchain/#cross_compiler_toolchain","title":"cross compiler toolchain","text":"<p>What is cross compile and toolchain?</p> <p>What is a toolchain and a cross compiler?</p> <p>Mats Petersson</p> <p>If we define the word <code>host</code> to mean a computer on which you are compiling, and <code>target</code> as the computer on which you want to run the code, then a native compiler is one where the target and the host are the same (kind). A cross-compiler is a compiler where the target is different from the host.</p> <p>A toolchain is the set of <code>compiler + linker + librarian + any other tools</code> you need to produce the executable (+ shared libraries, etc) for the target. A debugger and/or IDE may also count as part of a toolchain.</p> <p>What exactly is a compiler tool chain?</p> <p>What exactly is a compiler tool chain?</p> <p>Greg Kemnitz</p> <p>The notion of a Toolchain is usually used in the embedded world. It is the package of software needed to compile, link, and deploy software from a development <code>host</code> to the <code>target</code> device. (In most embedded devices, the device itself doesn't have enough capability to support development directly on the device.)</p> <p>A toolchain will have some sort of Cross compiler and linker for the target, possibly a Debugger (which may allow on-device debugging), occasionally some sort of simulator that allows testing and debugging on the development host, a mechanism for deploying to the device, etc.</p> <p>Sometimes the toolchain may involve a full IDE (like Microsoft VC++ Embedded or Hitachi's IDEs), often it is a collection of command-line tools, especially if the toolchain is hosted on Unix/Linux.</p>"},{"location":"blog/20200201/compiler-toolchain/#refs","title":"refs","text":"<p>linux-gnu-gcc:</p> <ul> <li>x86_64-linux-gnu-gcc(1) - Linux man page</li> <li>arm-linux-gnu-gcc(1) - Linux man page</li> <li>aarch64-linux-gnu-gcc(1) - Linux man page</li> </ul> <p>Arm GNU Toolchain</p> <p>RISC-V GNU Compiler Toolchain</p> <p>The ELLCC Embedded Compiler Collection</p> <p>WinLibs - GCC+MinGW-w64 compiler for Windows</p> <p>Buildroot - Making Embedded Linux Easy - wiki</p> <p>Cross Compiling With CMake \u2014 Mastering CMake</p> <p>GN is a meta-build system that generates build files for Ninja @github.</p> <ul> <li>The Ninja build system</li> </ul> <p>crosstool-ng: A versatile (cross-)toolchain generator.</p> <ul> <li>Documentation - How a toolchain is constructed</li> </ul>"},{"location":"blog/20200203/dump-compiler-options/","title":"Dump Compiler Options","text":"<p>Inspect and dump mainstream compilers(gcc/clang/msvc) predefined macros, c/c++ language standard and search paths.</p>"},{"location":"blog/20200203/dump-compiler-options/#predefined_macros","title":"Predefined macros","text":"<p>Pre-defined C/C++ Compiler Macros</p> <p>Guide to predefined macros in C++ compilers (gcc, clang, msvc etc.)</p>"},{"location":"blog/20200203/dump-compiler-options/#gnugcc","title":"gnu/gcc","text":"<p>Predefined Macros (The C Preprocessor)</p> <ul> <li>Standard Predefined Macros</li> <li>Common Predefined Macros</li> </ul> <p>Invocation (The C Preprocessor): You can invoke the preprocessor either with the <code>cpp</code> command, or via <code>gcc -E</code>.</p> <p>GCC Preprocessor Options</p> <p><code>-dletters</code>: Says to make debugging dumps during compilation as specified by\u00a0letters.</p> <pre><code>-dM\nInstead of the normal output, generate a list of \u2018#define\u2019 directives for all the macros defined during the execution of the preprocessor, including predefined macros. This gives you a way of finding out what is predefined in your version of the preprocessor. Assuming you have no file foo.h, the command\n\ntouch foo.h; cpp -dM foo.h\n\nshows all the predefined macros.\n</code></pre> <p>g++ - GCC dump preprocessor defines - Stack Overflow</p> <p>echo \u7a7a\u6d41\u9884\u7f16\u8bd1\uff1a</p> <pre><code># echo | cpp -dM\n# echo | gcc -E -dM -\n# echo | g++ -E -dM -\n$ echo | gcc -x c -E -dM -\n$ echo | g++ -x c++ -E -dM -\n</code></pre> <p>\u6216\u6307\u5b9a\u7a7a\u6587\u4ef6 /dev/null \u9884\u7f16\u8bd1\uff1a</p> <pre><code># cpp -dM - &lt; /dev/null\n# gcc -E -dM - &lt; /dev/null\n$ gcc -x c -E -dM - &lt; /dev/null\n$ gcc -x c++ -E -dM - &lt; /dev/null\n# or\n$ gcc -x c -E -dM /dev/null\n$ gcc -x c++ -E -dM /dev/null\n</code></pre> <p>\u5305\u542b\u7279\u5b9a\u5934\u6587\u4ef6\uff1a</p> <pre><code>$ echo \"#include &lt;stdio.h&gt;\" | cpp -dM\n# cpp -dM -include sys/socket.h &lt; /dev/null\n$ gcc -E -dM -include sys/socket.h - &lt; /dev/null\n</code></pre> <p>\u6307\u5b9aC++\u7248\u672c\uff1a</p> <pre><code>$ echo | gcc -x c++ -E -dM -std=c++11 -\n$ gcc -x c++ -E -dM -std=c++11 /dev/null\n</code></pre>"},{"location":"blog/20200203/dump-compiler-options/#clangllvm","title":"clang/llvm","text":"<p>Clang Preprocessor options</p> <ul> <li>Dumping preprocessor state</li> </ul> <p>\u5728 macOS \u4e0a\uff0cgcc/g++ \u662f XcodeDefault.xctoolchain \u4e0b clang/clang++ \u7684 shims or wrapper executables\u3002</p> <p>clang \u517c\u5bb9 gcc \u5927\u90e8\u5206\u5e38\u89c4\u547d\u4ee4\uff0c\u53ef\u66ff\u4ee3 gcc \u6267\u884c <code>-E -dM</code> \u9884\u5904\u7406\u547d\u4ee4\uff0c\u8f93\u51fa\u9884\u5b9a\u4e49\u5b8f\u3002</p> <p>clang \u8fd8\u53ef\u901a\u8fc7 <code>-target</code> / <code>-arch</code> \u9009\u9879\u6307\u5b9a Cross-Compilation \u7684\u76ee\u6807 CPU \u67b6\u6784\uff0c\u8f93\u51fa\u5bf9\u5e94 CPU \u4e0b\u7684\u4e00\u4e9b\u9884\u5b9a\u4e49\u5b8f\u3002</p> <p>clang -print-targets \u548c <code>objdump --version</code> \u8f93\u51fa Registered Targets\u3002 clang --print-supported-cpus \u5217\u51fa\u6307\u5b9a target \u652f\u6301\u7684\u5904\u7406\u5668\u3002</p> <p>IA32\uff08_ILP32\uff09/IA64\uff08_LP64\uff09\uff1a</p> <pre><code>$ clang -x c -E -dM -arch i386 /dev/null\n$ clang -x c -E -dM -arch x86_64 /dev/null\n</code></pre> <p>ARM32\uff08_ILP32\uff09/ARM64\uff08_LP64\uff09\uff1a</p> <pre><code>$ clang -x c -E -dM -arch armv7s /dev/null\n$ clang -x c -E -dM -arch arm64 /dev/null\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7\u7ba1\u9053\u5bfc\u7ed9 grep \u8fc7\u6ee4\u4e0d\u540c CPU \u67b6\u6784\u4e0b <code>__SIZEOF_INT__</code>\uff0c<code>__SIZEOF_LONG__</code>\uff0c<code>__SIZEOF_POINTER__</code>\uff0c<code>__BYTE_ORDER__</code>\uff0c<code>__BIGGEST_ALIGNMENT__</code> \u7b49\u9884\u5b9a\u4e49\u5b8f\u3002</p>"},{"location":"blog/20200203/dump-compiler-options/#msvc","title":"msvc","text":"<p>Preprocessor Predefined macros /P (Preprocess to a File)</p> <p>Preprocesses C and C++ source files and writes the preprocessed output to a file.</p> <p>The following command line preprocesses <code>ADD.C</code>, preserves comments, adds #line directives, and writes the result to a file, <code>ADD.I</code>:</p> <pre><code>CL /P /C ADD.C\n</code></pre> <p>Provide the ability to list predefined macros and their values like gcc and Clang do with their '-E -dM' options - Developer Community</p> <p>c++ - How to find out cl.exe's built-in macros - Stack Overflow</p> <p><code>/P</code> preprocessor flag will emit the currently active macros based on the project build settings. I am not sure if it is exactly the equivalent of gcc command you have shown. The output is in <code>.I</code> file.</p> <pre><code>echo // &gt; foo.cpp; cl /Zc:preprocessor /PD foo.cpp\n\n# For C\necho // &gt; foo.cpp; cl /nologo /Zc:preprocessor /PD /EHs /TC foo.cpp | sort; rm foo.cpp, foo.obj\n\n# For C++\necho // &gt; foo.cpp; cl /nologo /Zc:preprocessor /PD /EHs /TP foo.cpp | sort; rm foo.cpp, foo.obj\n</code></pre>"},{"location":"blog/20200203/dump-compiler-options/#cc_standard","title":"c/c++ standard","text":"<p>g++ - How can I find the default version of the c++ language standard used by my compiler and change it? - Stack Overflow</p>"},{"location":"blog/20200203/dump-compiler-options/#gnugcc_1","title":"gnu/gcc","text":"<p>gcc - How can I tell what standard my C is in? - Software Engineering Stack Exchange</p> <p>Language Standards Supported by GCC</p> <p>2.1 C Language: The default, if no C language dialect options are given, is <code>-std=gnu17</code>. 2.2 C++ Language: The default, if no C++ language dialect options are given, is <code>-std=gnu++17</code>.</p> gcc -std=c++ @rpi4b-ubuntu<pre><code>$ gcc --version\ngcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\nCopyright (C) 2021 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n$ man gcc | grep -e \"-std=c++\"\n           -std=c++98.\n               GNU dialect of -std=c++98.\n               GNU dialect of -std=c++11.  The name gnu++0x is deprecated.\n               GNU dialect of -std=c++14.  The name gnu++1y is deprecated.\n               GNU dialect of -std=c++17.  This is the default for C++ code.  The name gnu++1z\n               GNU dialect of -std=c++20.  Support is experimental, and could change in\n               GNU dialect of -std=c++2b.  Support is highly experimental, and will almost\n           This flag is enabled by default for -std=c++17.\n\n$ man g++ | grep \"This is the default for C++ code\"\n               GNU dialect of -std=c++17.  This is the default for C++ code.  The name gnu++1z\n</code></pre> <p>Which C++ standard is the default when compiling with g++? - Stack Overflow</p> <p>You can also check with <code>gdb</code>:</p> <ol> <li>$ g++ -g hello.cpp : Compile program with -g flag to generate debug info</li> <li>$ gdb a.out : Debug program with gdb</li> <li>(gdb) b main : Put a breakpoint at main</li> <li>(gdb) r : Run program (will pause at breakpoint)</li> <li>(gdb) info source - lldb \u6ca1\u6709 info \u547d\u4ee4</li> </ol> <p>Prints out something like:</p> gdb info source @rpi4b-ubuntu<pre><code>(gdb) info source\nCurrent source file is hello.cpp\nCompilation directory is /home/pifan/Projects/cpp\nLocated in /home/pifan/Projects/cpp/hello.cpp\nContains 7 lines.\nSource language is c++.\nProducer is GNU C++17 11.4.0 -mlittle-endian -mabi=lp64 -g -fasynchronous-unwind-tables -fstack-protector-strong -fstack-clash-protection.\nCompiled with DWARF 5 debugging format.\nDoes not include preprocessor macro info.\n(gdb) exit\n</code></pre> <p>What is the default C -std standard version for the current GCC (especially on Ubuntu)? - Stack Overflow</p> rpi4b-ubuntu<pre><code>$ gcc -x c -E -dM /dev/null | grep -F __STDC_VERSION__\n#define __STDC_VERSION__ 201710L\n\n$ g++ -x c++ -E -dM /dev/null | grep -F __cplusplus\n#define __cplusplus 201703L\n</code></pre> <p>If you feel like finding it out empirically without reading any manuals.</p> <ul> <li>Standard Predefined Macros \u4e2d\u6709\u5173\u4e8e <code>__STDC_VERSION__</code> \u548c <code>__cplusplus</code> \u7684\u8bf4\u660e\u3002</li> <li>Common Predefined Macros \u6709\u5173\u4e8e\u5b8f <code>__STRICT_ANSI__</code> \u7684\u8bf4\u660e\u3002</li> </ul> stdc.cstdc.sh <pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n#ifdef __STDC_VERSION__\n    printf(\"__STDC_VERSION__ = %ld \\n\", __STDC_VERSION__);\n#endif\n#ifdef __STRICT_ANSI__\n    puts(\"__STRICT_ANSI__\");\n#endif\n    return 0;\n}\n</code></pre> <pre><code>#!/usr/bin/env bash\n\nuname -a\necho\ngcc --version\necho\n\noname=stdc-`arch`.out\nfor std in c89 c99 c11 c17 gnu89 gnu99 gnu11 gnu17; do\n  echo $std\n  gcc stdc.c -std=$std -o $oname &amp;&amp; ./$oname\n  echo\ndone\necho default\ngcc stdc.c -o $oname &amp;&amp; ./$oname\n</code></pre> <p>rpi4b-ubuntu \u4e0b\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> STDC_VERSION &amp; STRICT_ANSI <pre><code>./stdc.sh\nLinux rpi4b-ubuntu 5.15.0-1053-raspi #56-Ubuntu SMP PREEMPT Mon Apr 15 18:50:10 UTC 2024 aarch64 aarch64 aarch64 GNU/Linux\n\ngcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\nCopyright (C) 2021 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n\nc89\n__STRICT_ANSI__\n\nc99\n__STDC_VERSION__ = 199901\n__STRICT_ANSI__\n\nc11\n__STDC_VERSION__ = 201112\n__STRICT_ANSI__\n\nc17\n__STDC_VERSION__ = 201710\n__STRICT_ANSI__\n\ngnu89\n\ngnu99\n__STDC_VERSION__ = 199901\n\ngnu11\n__STDC_VERSION__ = 201112\n\ngnu17\n</code></pre> stdcpp.cppstdcpp.sh <pre><code>#include &lt;iostream&gt;\n\nint main(void) {\n#ifdef __cplusplus\n    std::cout &lt;&lt; __cplusplus &lt;&lt; std::endl;\n#endif\n#ifdef __STRICT_ANSI__\n    std::cout &lt;&lt; \"__STRICT_ANSI__\" &lt;&lt; std::endl;\n#endif\n    return 0;\n}\n</code></pre> <pre><code>#!/usr/bin/env bash\n\nuname -a\necho\ng++ --version\necho\n\noname=stdcpp-`arch`.out\nfor std in c++98 c++11 c++14 c++17 gnu++98 gnu++11 gnu++14 gnu++17; do\n  echo $std\n  g++ stdcpp.cpp -std=$std -o $oname &amp;&amp; ./$oname\n  echo\ndone\necho default\ng++ stdcpp.cpp -o $oname &amp;&amp; ./$oname\n</code></pre> <p>rpi4b-ubuntu \u4e0b\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> cplusplus &amp; __STRICT_ANSI <pre><code>./stdcpp.sh\nLinux rpi4b-ubuntu 5.15.0-1053-raspi #56-Ubuntu SMP PREEMPT Mon Apr 15 18:50:10 UTC 2024 aarch64 aarch64 aarch64 GNU/Linux\n\ng++ (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0\nCopyright (C) 2021 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n\nc++98\n199711\n__STRICT_ANSI__\n\nc++11\n201103\n__STRICT_ANSI__\n\nc++14\n201402\n__STRICT_ANSI__\n\nc++17\n201703\n__STRICT_ANSI__\n\ngnu++98\n199711\n\ngnu++11\n201103\n\ngnu++14\n201402\n\ngnu++17\n201703\n\ndefault\n201703\n</code></pre>"},{"location":"blog/20200203/dump-compiler-options/#clangllvm_1","title":"clang/llvm","text":"<p>C Language Features</p> <p>If no -std option is specified, clang defaults to <code>gnu17</code> mode.</p> <p>Clang - C++ Programming Language Status</p> <p>C++17 implementation status:</p> <p>Clang 5 and later implement all the features of the\u00a0ISO C++ 2017 standard. By default, Clang 16 or later builds C++ code according to the <code>C++17</code> standard.</p> clang default @mbpa2991/macOS_Sonoma<pre><code>$ man clang | grep -F default\n              The default C language standard is gnu17, except on PS4, where\n              The default C++ language standard is gnu++98.\n</code></pre> <p>libc++ woes with Xcode 14 | Apple Developer Forums</p> <p>What is the default C -std standard version for the current GCC (especially on Ubuntu)? - Stack Overflow</p> macOS clang/gcc<pre><code>gcc -E -dM -x c /dev/null | grep -F __STDC_VERSION__\n#define __STDC_VERSION__ 201710L\n\ng++ -E -dM -x c++ /dev/null | grep -F __cplusplus\n#define __cplusplus 199711L\n</code></pre> <p>mbpa2991/macOS_Sonoma \u4e0b\u6267\u884c <code>./stdc.sh</code> \u8f93\u51fa\uff1a</p> STDC_VERSION &amp; STRICT_ANSI <pre><code>$ ./stdc.sh\nDarwin mbpa2991.local 23.5.0 Darwin Kernel Version 23.5.0: Sat Apr 13 17:29:54 PDT 2024; root:xnu-10063.120.104~34/RELEASE_ARM64_T6031 arm64\n\nApple clang version 15.0.0 (clang-1500.3.9.4)\nTarget: arm64-apple-darwin23.5.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n\nc89\n__STRICT_ANSI__\n\nc99\n__STDC_VERSION__ = 199901\n__STRICT_ANSI__\n\nc11\n__STDC_VERSION__ = 201112\n__STRICT_ANSI__\n\nc17\n__STDC_VERSION__ = 201710\n__STRICT_ANSI__\n\ngnu89\n\ngnu99\n__STDC_VERSION__ = 199901\n\ngnu11\n__STDC_VERSION__ = 201112\n\ngnu17\n__STDC_VERSION__ = 201710\n\ndefault\n__STDC_VERSION__ = 201710\n</code></pre> <p>mbpa2991/macOS_Sonoma \u4e0b\u6267\u884c <code>./stdcpp.sh</code> \u8f93\u51fa\uff1a</p> cplusplus &amp; __STRICT_ANSI <pre><code>$ ./stdcpp.sh\nDarwin mbpa2991.local 23.5.0 Darwin Kernel Version 23.5.0: Sat Apr 13 17:29:54 PDT 2024; root:xnu-10063.120.104~34/RELEASE_ARM64_T6031 arm64\n\nApple clang version 15.0.0 (clang-1500.3.9.4)\nTarget: arm64-apple-darwin23.5.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n\nc++98\n199711\n__STRICT_ANSI__\n\nc++11\n201103\n__STRICT_ANSI__\n\nc++14\n201402\n__STRICT_ANSI__\n\nc++17\n201703\n__STRICT_ANSI__\n\ngnu++98\n199711\n\ngnu++11\n201103\n\ngnu++14\n201402\n\ngnu++17\n201703\n\ndefault\n199711\n</code></pre>"},{"location":"blog/20200203/dump-compiler-options/#_libcpp_version","title":"_LIBCPP_VERSION","text":"<p>\u2699 D134187 [libc++] Document the format of _LIBCPP_VERSION</p> <ul> <li>llvm-project/libcxx/include/__config</li> </ul> <p><code>_LIBCPP_VERSION</code> represents the version of libc++, which matches the version of LLVM. Given a LLVM release LLVM XX.Y.ZZ (e.g. LLVM 16.0.1 == 16.0.01), _LIBCPP_VERSION is defined to XXYZZ.</p> <p>\u2699 D26062 Alternative solution for detecting libc++'s version.</p> <p>XCode now defaults to C++20 : r/cpp</p> <p>\u6267\u884c grep \u641c\u7d22 <code>_LIBCPP_VERSION</code> \u7684\u5b9a\u4e49\uff1a</p> <pre><code>grep -R -H \"#define _LIBCPP_VERSION\" --include=__config --exclude-dir=System / 2&gt;/dev/null\n</code></pre> _LIBCPP_VERSION <pre><code>$ cmdpath=/Library/Developer/CommandLineTools\n$ grep -R -H \"#define _LIBCPP_VERSION\" $cmdpath 2&gt;/dev/null\n\n/Library/Developer/CommandLineTools/usr/include/c++/v1/__config:#define _LIBCPP_VERSION 11000\n/Library/Developer/CommandLineTools/usr/include/c++/v1/version:#define _LIBCPP_VERSIONH\n/Library/Developer/CommandLineTools/usr/include/c++/v1/__cxx_version:#define _LIBCPP_VERSIONH\n\n/Library/Developer/CommandLineTools/SDKs/MacOSX11.3.sdk/usr/include/c++/v1/__config:#define _LIBCPP_VERSION 12000\n/Library/Developer/CommandLineTools/SDKs/MacOSX11.3.sdk/usr/include/c++/v1/version:#define _LIBCPP_VERSIONH\n/Library/Developer/CommandLineTools/SDKs/MacOSX13.3.sdk/usr/include/c++/v1/version:#define _LIBCPP_VERSIONH\n/Library/Developer/CommandLineTools/SDKs/MacOSX14.4.sdk/usr/include/c++/v1/version:#define _LIBCPP_VERSIONH\n\n$ xcdevpath=`xcode-select -p`\n$ grep -R -H \"#define _LIBCPP_VERSION\" $xcdevpath 2&gt;/dev/null\n\n/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/include/c++/v1/version:#define _LIBCPP_VERSIONH\n/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/c++/v1/version:#define _LIBCPP_VERSIONH\n</code></pre> <p>c++ - How to detect the libstdc++ version in Clang? - Stack Overflow</p> libcpp_version.cpp<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n\nusing namespace std;\n\nint main(int argc, const char * argv[])\n{\n    cout&lt;&lt;\"_LIBCPP_VERSION = \"&lt;&lt;_LIBCPP_VERSION&lt;&lt;endl;\n    return 0;\n}\n</code></pre> <p>clang 15.0.0 \u4e0b\u8f93\u51fa _LIBCPP_VERSION = 170006\u3002</p> <pre><code># c++/g++/clang++\n$ clang++ libcpp_version.cpp -o libcpp_version &amp;&amp; ./libcpp_version\n_LIBCPP_VERSION = 170006\n</code></pre>"},{"location":"blog/20200203/dump-compiler-options/#msvc_1","title":"msvc","text":"<p>Predefined macros</p> <p><code>_MSVC_LANG</code> Defined as an integer literal that specifies the C++ language standard targeted by the compiler. It's set only in code compiled as C++. The macro is the integer literal value <code>201402L</code> by default, or when the <code>/std:c++14</code> compiler option is specified. .</p> <p>/std (Specify Language Standard Version)</p> <p>C standards support: You can invoke the Microsoft C compiler by using the /TC or /Tc compiler option. It's used by default for code that has a <code>.c</code> file extension, unless overridden by a <code>/TP</code> or <code>/Tp</code> option. The default C compiler (that is, the compiler when <code>/std:c11</code> or <code>/std:c17</code> isn't specified) implements ANSI C89, but includes several Microsoft extensions, some of which are part of ISO C99.</p> <p>C++ standards support: The <code>/std</code> option in effect during a C++ compilation can be detected by use of the _MSVC_LANG preprocessor macro. For more information, see Preprocessor Macros.</p> <p>Important</p> <p>Because some existing code depends on the value of the macro <code>__cplusplus</code> being <code>199711L</code>, the MSVC compiler doesn't change the value of this macro unless you explicitly opt in by setting /Zc:__cplusplus. Specify <code>/Zc:__cplusplus</code> and the <code>/std</code> option to set <code>__cplusplus</code> to the appropriate value.</p> <p>Predefined macros: __cplusplus - cppreference.com</p> <p>The <code>/std:c++14</code> option enables C++14 standard-specific features implemented by the MSVC compiler. This option is the default for code compiled as C++. It's available starting in Visual Studio 2015 Update 3.</p>"},{"location":"blog/20200203/dump-compiler-options/#search_paths","title":"Search Paths","text":""},{"location":"blog/20200203/dump-compiler-options/#header_search_paths","title":"Header Search Paths","text":"<p>Preprocessor Options: <code>-dI</code> : Output \u2018#include\u2019 directives in addition to the result of preprocessing.</p> macOS cpp -dIrpi4b-ubuntu cpp -dI <pre><code>$ echo | cpp -dI\n# 1 \"&lt;stdin&gt;\"\n# 1 \"&lt;built-in&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 3\n# 417 \"&lt;built-in&gt;\" 3\n# 1 \"&lt;command line&gt;\" 1\n# 1 \"&lt;built-in&gt;\" 2\n# 1 \"&lt;stdin&gt;\" 2\n\n# \u67e5\u770b\u5bfc\u5165 &lt;stdio.h&gt; \u7684\u4f9d\u8d56\u5c55\u5f00\n$ echo \"#include &lt;stdio.h&gt;\" | cpp -dI\n</code></pre> <pre><code>$ echo | cpp -dI\n# 0 \"&lt;stdin&gt;\"\n# 0 \"&lt;built-in&gt;\"\n# 0 \"&lt;command-line&gt;\"\n# 1 \"/usr/include/stdc-predef.h\" 1 3 4\n# 0 \"&lt;command-line&gt;\" 2\n# 1 \"&lt;stdin&gt;\"\n\n# \u67e5\u770b\u5bfc\u5165 &lt;stdio.h&gt; \u7684\u4f9d\u8d56\u5c55\u5f00\n$ echo \"#include &lt;stdio.h&gt;\" | cpp -dI\n</code></pre> <p>\u8fd0\u884c <code>clang -v -x c -E /dev/null</code> \u6216 <code>clang -v -x c++ -E /dev/null</code> \u6267\u884c\u9884\u5904\u7406\uff0c\u53ef\u4ee5\u67e5\u770b C/C++ \u8bed\u8a00\u7684 Header Search Paths\u3002</p> <pre><code>#include \"...\" search starts here:\n#include &lt;...&gt; search starts here:\n /usr/local/include\n /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/15.0.0/include\n /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include\n /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include\n /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory)\nEnd of search list.\n</code></pre> <p>If you want to see your header include paths for <code>libstdc++</code> and <code>libc++</code>, do this:</p> <pre><code># GNU C++ runtime\n$ echo | clang -x c++ -Wp,-v -stdlib=libstdc++ -fsyntax-only -\n\n# LLVM C++ runtime\n$ echo | clang -x c++ -Wp,-v -stdlib=libc++ -fsyntax-only -\n</code></pre> <p>\u6d89\u53ca\u5230\u4e24\u4e2a\u9009\u9879\uff1a</p> <ol> <li>Preprocessor Options - <code>-Wp,option</code> : to bypass the compiler driver and pass option directly through to the preprocessor.</li> <li>Warning Options - <code>-fsyntax-only</code> : Check the code for syntax errors, but don\u2019t do anything beyond that.</li> </ol> macOS &lt;stdio.h&gt; / &lt;iostream&gt;rpi4b-ubuntu &lt;stdio.h&gt; / &lt;iostream&gt; <pre><code># gcc stdc.c -E -### : llvm-gcc \u8c03\u7528 clang -cc1 \u9884\u5904\u7406\n$ gcc stdc.c -E -v\n/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/stdio.h\n\n# g++ stdcpp.cpp -E -### : llvm-g++ \u4e5f\u662f\u8c03\u7528 clang -cc1 \u9884\u5904\u7406\n$ g++ stdcpp.cpp -E -v\n/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/c++/v1/iostream\n</code></pre> <pre><code># gcc stdc.c -E -### : \u8c03\u7528 /usr/lib/gcc/aarch64-linux-gnu/11/cc1 -E \u9884\u5904\u7406\n$ gcc stdc.c -E -v\n\n#include \"...\" search starts here:\n#include &lt;...&gt; search starts here:\n /usr/lib/gcc/aarch64-linux-gnu/11/include\n /usr/local/include\n /usr/include/aarch64-linux-gnu\n /usr/include\nEnd of search list.\n\n/usr/include/stdio.h\n\nCOMPILER_PATH=/usr/lib/gcc/aarch64-linux-gnu/11/:/usr/lib/gcc/aarch64-linux-gnu/11/:/usr/lib/gcc/aarch64-linux-gnu/:/usr/lib/gcc/aarch64-linux-gnu/11/:/usr/lib/gcc/aarch64-linux-gnu/\nLIBRARY_PATH=/usr/lib/gcc/aarch64-linux-gnu/11/:/usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/:/usr/lib/gcc/aarch64-linux-gnu/11/../../../../lib/:/lib/aarch64-linux-gnu/:/lib/../lib/:/usr/lib/aarch64-linux-gnu/:/usr/lib/../lib/:/usr/lib/gcc/aarch64-linux-gnu/11/../../../:/lib/:/usr/lib/\nCOLLECT_GCC_OPTIONS='-E' '-v' '-mlittle-endian' '-mabi=lp64'\n\n# g++ stdcpp.cpp -E -### : \u8c03\u7528 /usr/lib/gcc/aarch64-linux-gnu/11/cc1plus -E \u9884\u5904\u7406\n$ g++ stdcpp.cpp -E -v\n\n/usr/include/c++/11/iostream\n\nCOMPILER_PATH=/usr/lib/gcc/aarch64-linux-gnu/11/:/usr/lib/gcc/aarch64-linux-gnu/11/:/usr/lib/gcc/aarch64-linux-gnu/:/usr/lib/gcc/aarch64-linux-gnu/11/:/usr/lib/gcc/aarch64-linux-gnu/\nLIBRARY_PATH=/usr/lib/gcc/aarch64-linux-gnu/11/:/usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/:/usr/lib/gcc/aarch64-linux-gnu/11/../../../../lib/:/lib/aarch64-linux-gnu/:/lib/../lib/:/usr/lib/aarch64-linux-gnu/:/usr/lib/../lib/:/usr/lib/gcc/aarch64-linux-gnu/11/../../../:/lib/:/usr/lib/\nCOLLECT_GCC_OPTIONS='-E' '-v' '-shared-libgcc' '-mlittle-endian' '-mabi=lp64'\n</code></pre> <p>VC2015 \u7684\u5934\u6587\u4ef6 INCLUDE \u8def\u5f84\u4e3a\uff1a</p> <ul> <li>C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\include</li> <li>C:\\Program Files (x86)\\Windows Kits\\10\\Include\\10.0.10150.0\\ucrt</li> </ul>"},{"location":"blog/20200203/dump-compiler-options/#library_search_paths","title":"Library Search Paths","text":"<p>\u6267\u884c <code>clang -Xlinker -v</code> \u6307\u5b9a\u94fe\u63a5\u9009\u9879\uff0c\u4e0d\u6307\u5b9a\u94fe\u63a5\u76ee\u6807\uff0c\u5219\u53ea\u663e\u793a configured to support archs \u4fe1\u606f\uff1a</p> <ul> <li>Options for Linking - <code>-Xlinker option</code> : Pass option as an option to the linker.</li> </ul> <pre><code>$ clang -Xlinker -v\n@(#)PROGRAM:ld PROJECT:ld-1053.12\nBUILD 15:45:29 Feb  3 2024\nconfigured to support archs: armv6 armv7 armv7s arm64 arm64e arm64_32 i386 x86_64 x86_64h armv6m armv7k armv7m armv7em\nwill use ld-classic for: armv6 armv7 armv7s arm64_32 i386 armv6m armv7k armv7m armv7em\nLTO support using: LLVM version 15.0.0 (static support for 29, runtime is 29)\nTAPI support using: Apple TAPI version 15.0.0 (tapi-1500.3.2.2)\n</code></pre> <p>\u4e5f\u53ef\u6267\u884c <code>clang -print-targets</code> \u67e5\u770b Registered Targets\uff0c\u53c2\u8003 How to list supported target architectures in clang?\u3002</p> <p>\u6307\u5b9a\u94fe\u63a5\u7a7a\u6587\u4ef6 /dev/null\uff0c\u53ef\u4ee5\u67e5\u770b Library/Framework search paths\uff0c\u76f4\u63a5\u62a5\u9519\uff1a</p> clang -Xlinker -v @mbpa2991/macOS_Sonoma<pre><code>$ clang -Xlinker -v /dev/null\n@(#)PROGRAM:ld PROJECT:ld-1053.12\nBUILD 15:45:29 Feb  3 2024\nconfigured to support archs: armv6 armv7 armv7s arm64 arm64e arm64_32 i386 x86_64 x86_64h armv6m armv7k armv7m armv7em\nwill use ld-classic for: armv6 armv7 armv7s arm64_32 i386 armv6m armv7k armv7m armv7em\nLTO support using: LLVM version 15.0.0 (static support for 29, runtime is 29)\nTAPI support using: Apple TAPI version 15.0.0 (tapi-1500.3.2.2)\nLibrary search paths:\n        /usr/local/lib\n        /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/lib\n        /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/lib/swift\nFramework search paths:\n        /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/System/Library/Frameworks\nclang: error: unable to execute command: Segmentation fault: 11\nclang: error: linker command failed due to signal (use -v to see invocation)\n</code></pre> <p>macOS \u7f16\u8bd1\u94fe\u63a5 C/C++</p> <p>macOS \u4e0a\u7f16\u8bd1\u94fe\u63a5 C \u4ee3\u7801\uff1adry-run: <code>gcc stdc.c -###</code>\uff1bcompile: <code>gcc stdc.c -o c.out -v</code>\u3002 macOS \u4e0a\u7f16\u8bd1\u94fe\u63a5 C++ \u4ee3\u7801\uff1adry-run: <code>g++ stdcpp.cpp -###</code>\uff1bcompile: <code>g++ stdcpp.cpp -o cpp.out -v</code>\u3002</p> <ul> <li>gcc/g++ \u90fd\u53ea\u8c03\u7528\u4e86 <code>clang cc1</code> \u548c <code>ld</code> \u4e24\u6b65\u547d\u4ee4\u3002</li> <li>gcc std.c \u94fe\u63a5 <code>libLTO.dylib</code>\u3001<code>-lSystem</code> \u548c <code>libclang_rt.osx.a</code>\uff1bg++ stdcpp.cpp \u5728 -lSystem \u524d\u9762\u63d2\u589e\u94fe\u63a5\u9009\u9879 <code>-lc++</code>\u3002</li> <li>\u6267\u884c <code>otool -L c.out</code> / <code>otool -L cpp.out</code> \u53ef\u67e5\u770b\u4f9d\u8d56\u7684\u52a8\u6001\u5e93\uff08dylib\uff09\u3002</li> </ul> <p>Ubuntu \u4e0b\u6267\u884c gcc/g++ \u547d\u4ee4\uff0c\u8c03\u7528 collect2 \u548c ld \u94fe\u63a5\uff0c\u6700\u7ec8\u62a5\u9519\uff1a</p> gcc collect2 -lcg++ collect2 -lstdc++ <pre><code>$ gcc -Xlinker -v /dev/null\ncollect2 version 11.4.0\n/usr/bin/ld -plugin /usr/lib/gcc/aarch64-linux-gnu/11/liblto_plugin.so -plugin-opt=/usr/lib/gcc/aarch64-linux-gnu/11/lto-wrapper -plugin-opt=-fresolution=/tmp/cc2Mlb39.res -plugin-opt=-pass-through=-lgcc -plugin-opt=-pass-through=-lgcc_s -plugin-opt=-pass-through=-lc -plugin-opt=-pass-through=-lgcc -plugin-opt=-pass-through=-lgcc_s --build-id --eh-frame-hdr --hash-style=gnu --as-needed -dynamic-linker /lib/ld-linux-aarch64.so.1 -X -EL -maarch64linux --fix-cortex-a53-843419 -pie -z now -z relro /usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/Scrt1.o /usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/crti.o /usr/lib/gcc/aarch64-linux-gnu/11/crtbeginS.o -L/usr/lib/gcc/aarch64-linux-gnu/11 -L/usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu -L/usr/lib/gcc/aarch64-linux-gnu/11/../../../../lib -L/lib/aarch64-linux-gnu -L/lib/../lib -L/usr/lib/aarch64-linux-gnu -L/usr/lib/../lib -L/usr/lib/gcc/aarch64-linux-gnu/11/../../.. -v -lgcc --push-state --as-needed -lgcc_s --pop-state -lc -lgcc --push-state --as-needed -lgcc_s --pop-state /usr/lib/gcc/aarch64-linux-gnu/11/crtendS.o /usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/crtn.o\nGNU ld (GNU Binutils for Ubuntu) 2.38\n/usr/bin/ld: /usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/Scrt1.o: in function `_start':\n(.text+0x1c): undefined reference to `main'\n/usr/bin/ld: (.text+0x20): undefined reference to `main'\ncollect2: error: ld returned 1 exit status\n</code></pre> <pre><code>$ g++ -x c++ -Xlinker -v /dev/null\ncollect2 version 11.4.0\n/usr/bin/ld -plugin /usr/lib/gcc/aarch64-linux-gnu/11/liblto_plugin.so -plugin-opt=/usr/lib/gcc/aarch64-linux-gnu/11/lto-wrapper -plugin-opt=-fresolution=/tmp/ccx8f9Ks.res -plugin-opt=-pass-through=-lgcc_s -plugin-opt=-pass-through=-lgcc -plugin-opt=-pass-through=-lc -plugin-opt=-pass-through=-lgcc_s -plugin-opt=-pass-through=-lgcc --build-id --eh-frame-hdr --hash-style=gnu --as-needed -dynamic-linker /lib/ld-linux-aarch64.so.1 -X -EL -maarch64linux --fix-cortex-a53-843419 -pie -z now -z relro /usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/Scrt1.o /usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/crti.o /usr/lib/gcc/aarch64-linux-gnu/11/crtbeginS.o -L/usr/lib/gcc/aarch64-linux-gnu/11 -L/usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu -L/usr/lib/gcc/aarch64-linux-gnu/11/../../../../lib -L/lib/aarch64-linux-gnu -L/lib/../lib -L/usr/lib/aarch64-linux-gnu -L/usr/lib/../lib -L/usr/lib/gcc/aarch64-linux-gnu/11/../../.. -v /tmp/ccqgv1oL.o -lstdc++ -lm -lgcc_s -lgcc -lc -lgcc_s -lgcc /usr/lib/gcc/aarch64-linux-gnu/11/crtendS.o /usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/crtn.o\nGNU ld (GNU Binutils for Ubuntu) 2.38\n/usr/bin/ld: /usr/lib/gcc/aarch64-linux-gnu/11/../../../aarch64-linux-gnu/Scrt1.o: in function `_start':\n(.text+0x1c): undefined reference to `main'\n/usr/bin/ld: (.text+0x20): undefined reference to `main'\ncollect2: error: ld returned 1 exit status\n</code></pre> <p>Ubuntu \u7f16\u8bd1\u94fe\u63a5 C/C++</p> <p>ubuntu \u4e0a\u7f16\u8bd1\u94fe\u63a5 C \u4ee3\u7801\uff1adry-run: <code>gcc stdc.c -###</code>\uff1bcompile: <code>gcc stdc.c -o c.out -v</code>\u3002</p> <ul> <li>gcc \u4f9d\u6b21\u8c03\u7528 cc1-&gt;as-&gt;collect2\uff0c\u94fe\u63a5 Scrt1.o,crti.o,crtbeginS.o,<code>-lc</code>\uff08[g]libc\uff09,crtendS.o,crtn.o\u3002</li> </ul> <p>ubuntu \u4e0a\u7f16\u8bd1\u94fe\u63a5 C++ \u4ee3\u7801\uff1adry-run: <code>g++ stdcpp.cpp -###</code>\uff1bcompile: <code>g++ stdcpp.cpp -o cpp.out -v</code>\u3002</p> <ul> <li>g++ \u4f9d\u6b21\u8c03\u7528 cc1plus-&gt;as-&gt;collect2\uff0c\u94fe\u63a5 Scrt1.o,crti.o,crtbeginS.o,<code>-lstdc++</code>\uff08libstdc++\uff09,crtendS.o,crtn.o\u3002</li> </ul> <p>\u8bf4\u660e\uff1a</p> <ul> <li>gcc \u7684 <code>cc1</code> \u5df2\u7ecf\u96c6\u6210\u4e86 cpp \u9884\u5904\u7406\u3002</li> <li>collect2 \u5185\u90e8\u8c03\u7528 real <code>ld</code> \u5b8c\u6210\u6700\u7ec8\u7684\u94fe\u63a5\u5de5\u4f5c\u3002</li> <li>\u5173\u4e8e crt(C Runtime)\uff0c\u53c2\u8003 crtbegin.o vs. crtbeginS.o \u548c Mini FAQ about the misc libc/gcc crt files.\u3002</li> </ul> <p>VC2015 \u7684\u5e93\u6587\u4ef6 LIB \u8def\u5f84\u4e3a\uff1a</p> <ul> <li>C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\lib</li> <li>C:\\Program Files (x86)\\Windows Kits\\10\\Lib\\10.0.10150.0\\ucrt\\x86</li> </ul>"},{"location":"blog/20200203/dump-compiler-options/#library_dependencies","title":"Library Dependencies","text":"<p>\u6267\u884c gcc/g++ \u7f16\u8bd1\u94fe\u63a5\u65f6\uff0c\u53ef\u6307\u5b9a <code>-###</code> dry-run\uff0c\u67e5\u770b\u5b8c\u6574\u7f16\u8bd1\u94fe\u63a5\u6d41\u7a0b\uff1a</p> <ul> <li>gcc stdc.c -###</li> <li>g++ stdcpp.cpp -###</li> </ul> <p>ABI Policy and Guidelines - Checking Active</p> <ul> <li>elf - Determine direct shared object dependencies of a Linux binary? - Stack Overflow</li> <li>windows - Discovery of Dynamic library dependency on Mac OS &amp; Linux - Stack Overflow</li> <li>How to find out the dynamic libraries executables loads when run? - Unix &amp; Linux Stack Exchange</li> </ul> <p>c++ - How do you find what version of libstdc++ library is installed on your linux machine? - Stack Overflow</p>"},{"location":"blog/20200203/dump-compiler-options/#ldd","title":"ldd","text":"<p><code>ldd</code> - print shared object dependencies.</p> <p>ldd \u6253\u5370\u4f9d\u8d56\u7684\u52a8\u6001\u5171\u4eab\u5e93\uff1alibc.so.6, libstdc++.so.6\u3002</p> ldd c.outldd cpp.out <pre><code>rpi4b-ubuntu $ ldd c.out\n    linux-vdso.so.1 (0x0000ffffa4f6c000)\n    libc.so.6 =&gt; /lib/aarch64-linux-gnu/libc.so.6 (0x0000ffffa4d70000)\n    /lib/ld-linux-aarch64.so.1 (0x0000ffffa4f33000)\n</code></pre> <pre><code>rpi4b-ubuntu $ ldd cpp.out\n    linux-vdso.so.1 (0x0000ffff968c5000)\n    libstdc++.so.6 =&gt; /lib/aarch64-linux-gnu/libstdc++.so.6 (0x0000ffff96640000)\n    libc.so.6 =&gt; /lib/aarch64-linux-gnu/libc.so.6 (0x0000ffff96490000)\n    libm.so.6 =&gt; /lib/aarch64-linux-gnu/libm.so.6 (0x0000ffff963f0000)\n    /lib/ld-linux-aarch64.so.1 (0x0000ffff9688c000)\n    libgcc_s.so.1 =&gt; /lib/aarch64-linux-gnu/libgcc_s.so.1 (0x0000ffff963c0000)\n</code></pre> <p>macOS \u4e0e Linux \u4e0a\u7684 ldd \u5bf9\u5e94\u7684\u547d\u4ee4\u662f <code>otool -L</code>\uff1a</p> <pre><code>mbpa2991 $ otool -L c.out\nc.out:\n    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1345.100.2)\n\nmbpa2991 $ otool -L cpp.out\ncpp.out:\n    /usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 1700.255.0)\n    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1345.100.2)\n</code></pre> <p>\u4f46 /usr/lib \u4e0b\u5e76\u6ca1\u6709\u627e\u5230\u8fd9\u4e24\u4e2a dylib\uff0c\u53c2\u8003\uff1a</p> <ul> <li>Why are my system libraries and frameworks not visible in macOS Monterey?</li> <li>Missing librairies in /usr/lib on Big Sur?: Since Big Sur, it somehow all became virtual.</li> </ul> <p>\u5728 macOS \u4e0a\u7684 Library search paths \u4e2d\u8fc7\u6ee4 libSystem \u548c libc++\uff0c\u53ea\u641c\u5230\u4e86 libSystem.B.tbd \u548c libc++.1.tbd \u53ca\u4e00\u5806\u8f6f\u94fe\u66ff\u8eab\uff08\u5982 libc.tbd\u3001libc++.tbd\uff09\uff1a</p> <pre><code>$ ls -l /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/lib | grep -E \"lib(System|c\\+\\+)\"\n-rw-r--r--    1 root  wheel  309826 Nov 17  2021 libSystem.B.tbd\nlrwxr-xr-x    1 root  wheel      15 Oct  7  2021 libSystem.tbd -&gt; libSystem.B.tbd\n-rw-r--r--    1 root  wheel  145622 Nov 13  2021 libc++.1.tbd\nlrwxr-xr-x    1 root  wheel      12 Oct  7  2021 libc++.tbd -&gt; libc++.1.tbd\n-rw-r--r--    1 root  wheel   10571 Nov 13  2021 libc++abi.tbd\nlrwxr-xr-x    1 root  wheel      13 Oct  7  2021 libc.tbd -&gt; libSystem.tbd\nlrwxr-xr-x    1 root  wheel      13 Oct  7  2021 libdl.tbd -&gt; libSystem.tbd\nlrwxr-xr-x    1 root  wheel      13 Oct  7  2021 libgcc_s.1.tbd -&gt; libSystem.tbd\nlrwxr-xr-x    1 root  wheel      13 Oct  7  2021 libm.tbd -&gt; libSystem.tbd\nlrwxr-xr-x    1 root  wheel      13 Oct  7  2021 libpoll.tbd -&gt; libSystem.tbd\nlrwxr-xr-x    1 root  wheel      13 Oct  7  2021 libproc.tbd -&gt; libSystem.tbd\nlrwxr-xr-x    1 root  wheel      13 Oct  7  2021 libpthread.tbd -&gt; libSystem.tbd\n</code></pre> <p>\u67e5\u770b libSystem.B.tbd \u53ef\u77e5\uff0clibSystem \u4e0d\u63d0\u4f9b\u4efb\u4f55\u7b26\u53f7\u548c\u4ee3\u7801\uff0c\u5b83\u94fe\u63a5\u4e86 /usr/lib/system \u4e2d\u7684\u8bb8\u591a\u5176\u4ed6 dylib\uff0c\u5e76\u5c06\u5b83\u4eec\u7684\u7b26\u53f7\u4f5c\u4e3a\u81ea\u5df1\u7684\u7b26\u53f7\u91cd\u65b0\u5bfc\u51fa\uff08reexported-libraries\uff09\u3002</p> <pre><code>$ tree /usr/lib/system\n/usr/lib/system\n\u251c\u2500\u2500 introspection\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 libdispatch.dylib\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 libsystem_pthread.dylib\n\u251c\u2500\u2500 libsystem_kernel.dylib\n\u251c\u2500\u2500 libsystem_platform.dylib\n\u251c\u2500\u2500 libsystem_pthread.dylib\n\u2514\u2500\u2500 wordexp-helper\n\n2 directories, 6 files\n</code></pre> <p>tdb vs. dylib</p> <p>\u5173\u4e8e tdb \u548c dylib \u7684\u5173\u7cfb\uff0c\u53c2\u8003\uff1a</p> <ul> <li>Why Xcode 7 shows *.tbd instead of *.dylib?</li> <li>macOS/iOS dylib\u3001tbd \u548c Framework \u5e93\u8be6\u89e3</li> </ul> <p><code>*.dylib</code> is the compiled binary that contains the machine code. <code>TDB</code> is the acronym for \"Text Based Dylib stubs\". <code>*.tbd</code> is a smaller text file, similar to a cross-platform module map.</p>"},{"location":"blog/20200203/dump-compiler-options/#ldconfig","title":"ldconfig","text":"<p><code>ldconfig</code> - configure dynamic linker run-time bindings.</p> <ul> <li><code>-p</code> / --print-cache: Print the lists of directories and candidate libraries stored in the current cache.</li> </ul> <p>ldconfig -p \u6253\u5370\u7f13\u5b58\u4e2d\u7684\u52a8\u6001\u5171\u4eab\u5e93 libc.so.6, libstdc++.so.6\u3002</p> ldconfig -p | grep libc.soldconfig -p | grep libstdc++ <pre><code>rpi4b-ubuntu $ ldconfig -p | grep libc.so\n    libc.so.6 (libc6,AArch64, OS ABI: Linux 3.7.0) =&gt; /lib/aarch64-linux-gnu/libc.so.6\n</code></pre> <pre><code>rpi4b-ubuntu $ ldconfig -p | grep libstdc++\n    libstdc++.so.6 (libc6,AArch64) =&gt; /lib/aarch64-linux-gnu/libstdc++.so.6\n</code></pre>"},{"location":"blog/20200203/dump-compiler-options/#objdump","title":"objdump","text":""},{"location":"blog/20200203/dump-compiler-options/#-f","title":"-f","text":"<p>\u6267\u884c <code>file</code> \u547d\u4ee4\u67e5\u770b libc.so \u6587\u4ef6\u5c5e\u6027\uff08determine file type\uff09\uff1a</p> <pre><code>$ file /lib/aarch64-linux-gnu/libc.so.6\n/lib/aarch64-linux-gnu/libc.so.6: ELF 64-bit LSB shared object, ARM aarch64, version 1 (GNU/Linux), dynamically linked, interpreter /lib/ld-linux-aarch64.so.1, BuildID[sha1]=9e27cf97f03940293c6df3b107674ceda9c825d8, for GNU/Linux 3.7.0, stripped\n</code></pre> <p>\u6267\u884c <code>file</code> \u547d\u4ee4\u67e5\u770b libstdc++.so \u6587\u4ef6\u5c5e\u6027\uff1a</p> <pre><code>$ file /lib/aarch64-linux-gnu/libstdc++.so.6\n/lib/aarch64-linux-gnu/libstdc++.so.6: symbolic link to libstdc++.so.6.0.30\n\n$ file /lib/aarch64-linux-gnu/libstdc++.so.6.0.30\n/lib/aarch64-linux-gnu/libstdc++.so.6.0.30: ELF 64-bit LSB shared object, ARM aarch64, version 1 (GNU/Linux), dynamically linked, BuildID[sha1]=a012b2bb77110e84b266cd7425b50e57427abb02, stripped\n</code></pre> <p><code>objdump -a</code> \u67e5\u770b archive header\uff1b<code>objdump -f</code> \u67e5\u770b file header\u3002</p> <ul> <li><code>-a</code>, --archive-headers    Display archive header information</li> <li><code>-f</code>, --file-headers       Display the contents of the overall file header</li> </ul> <pre><code>objdump -f /lib/aarch64-linux-gnu/libc.so.6\n\n/lib/aarch64-linux-gnu/libc.so.6:     file format elf64-littleaarch64\narchitecture: aarch64, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x00000000000275e0\n\nobjdump -f /lib/aarch64-linux-gnu/libstdc++.so.6\n\n/lib/aarch64-linux-gnu/libstdc++.so.6:     file format elf64-littleaarch64\narchitecture: aarch64, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x0000000000000000\n</code></pre>"},{"location":"blog/20200203/dump-compiler-options/#-x","title":"-x","text":"<p><code>objdump -x</code>\uff08--all-headers\uff09: Display all available header information, including the symbol table and relocation entries.</p> <ol> <li>Dynamic Section: \u4e2d\u7684 NEEDED \u4e3a\u4f9d\u8d56\u7684\uff08\u52a8\u6001\uff09\u5e93\uff1alibc.so.6, libstdc++.so.6\u3002</li> <li>Version References: \u4e2d\u7684 required \u4e3a\u4f9d\u8d56\u7684\uff08\u52a8\u6001\uff09\u5e93\uff1aGLIBC_2.17/GLIBC_2.34,GLIBCXX_3.4\u3002</li> <li>\u4f9d\u8d56\u7684\u7b26\u53f7\u540e\u9762\u4e5f\u6709 @GLIBC_2.17/@GLIBC_2.34,@GLIBCXX_3.4 \u6807\u8bb0\u3002</li> </ol> objdump -x c.outobjdump -x cpp.out <pre><code>rpi4b-ubuntu $ objdump -x c.out\n\nDynamic Section:\n  NEEDED               libc.so.6\n\nVersion References:\n  required from libc.so.6:\n    0x06969197 0x00 03 GLIBC_2.17\n    0x069691b4 0x00 02 GLIBC_2.34\n\nSYMBOL TABLE:\n\n0000000000000000       F *UND*  0000000000000000              __libc_start_main@GLIBC_2.34\n0000000000000000       F *UND*  0000000000000000              printf@GLIBC_2.17\n</code></pre> <pre><code>rpi4b-ubuntu $ objdump -x cpp.out\n\nDynamic Section:\n  NEEDED               libstdc++.so.6\n  NEEDED               libc.so.6\n\nVersion References:\n  required from libc.so.6:\n    0x069691b4 0x00 04 GLIBC_2.34\n    0x06969197 0x00 03 GLIBC_2.17\n  required from libstdc++.so.6:\n    0x08922974 0x00 02 GLIBCXX_3.4\n\nSYMBOL TABLE:\n\n0000000000000000       O *UND*  0000000000000000              _ZSt4cout@GLIBCXX_3.4\n</code></pre>"},{"location":"blog/20200203/dump-compiler-options/#readelf","title":"readelf","text":"<p><code>readelf -h</code>: Display the ELF file header. <code>readelf -l</code>(--program-headers, --segments): Display the program headers <code>readelf -S</code>(--section-headers, --sections): Display the sections' header <code>readelf -e</code>(--headers): Equivalent to: -h -l -S <code>readelf -s</code>(--syms): Display the symbol table. <code>readelf -d</code>(--dynamic): Displays the contents of the file's dynamic section, if it has one. <code>readelf -a</code>(--all): Displays the complete structure of an object \ufb01le.</p> readelf -d c.outreadelf -d cpp.out <pre><code>rpi4b-ubuntu $ readelf -d c.out\n\nDynamic section at offset 0xda0 contains 27 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n</code></pre> <pre><code>rpi4b-ubuntu $ readelf -d cpp.out\n\nDynamic section at offset 0xd60 contains 28 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n</code></pre> <p>\u5176\u4e2d NEEDED \u6807\u8bb0\u8868\u793a\u4f9d\u8d56\uff08\u52a8\u6001\uff09\u5e93\uff1alibc.so.6, libstdc++.so.6\u3002</p>"},{"location":"blog/20200203/dump-compiler-options/#nm","title":"nm","text":"<p><code>nm</code> - list symbols from object files.</p> <p>\u4f9d\u8d56\u7684\u7b26\u53f7\u540e\u9762\u4e5f\u6709 @GLIBC_2.17/@GLIBC_2.34,@GLIBCXX_3.4 \u6807\u8bb0\u3002</p> nm c.outnm cpp.out <pre><code>rpi4b-ubuntu $ nm c.out\n\n0000000000000790 R _IO_stdin_used\n                 w _ITM_deregisterTMCloneTable\n                 w _ITM_registerTMCloneTable\n                 U __libc_start_main@GLIBC_2.34\n0000000000000754 T main\n                 U printf@GLIBC_2.17\n</code></pre> <pre><code>rpi4b-ubuntu $ nm cpp.out\n0000000000000a10 t _Z41__static_initialization_and_destruction_0ii\n                 U _ZNSolsEl@GLIBCXX_3.4\n                 U _ZNSolsEPFRSoS_E@GLIBCXX_3.4\n                 U _ZNSt8ios_base4InitC1Ev@GLIBCXX_3.4\n                 U _ZNSt8ios_base4InitD1Ev@GLIBCXX_3.4\n                 U _ZSt4cout@GLIBCXX_3.4\n                 U _ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_@GLIBCXX_3.4\n</code></pre> <p>man nm \u67e5\u770b nm(1) - Linux manual page\uff0c\u5176\u4e2d\u6709\u5173\u4e8e symbol type \u7684\u8be6\u7ec6\u8bf4\u660e\u3002</p>"},{"location":"blog/20200202/mainstream-compiler/","title":"Mainstream Compiler - gcc/clang/msvc","text":"<p>Try and tease out mainstream compilers(GNU/GCC, Clang/LLVM, Microsoft Visual Studio) architecture/framework, toolchain, binutils and language(C/C++) standards.</p> <p>The following concepts/topics will be involved:</p> <ol> <li>gcc/g++, glibc/libstdc++, gdb</li> <li>clang/clang++, llvm-gcc/llvm-g++, libc/libc++, lldb</li> <li>msvc/cl, windbg</li> </ol>"},{"location":"blog/20200202/mainstream-compiler/#gnugcc","title":"GNU/GCC","text":"<p>The GNU Operating System and the Free Software Movement</p> <p>What is GNU?</p> <p>GNU is an operating system that is free software\u2014that is, it respects users' freedom. The GNU operating system consists of GNU packages (programs specifically released by the GNU Project) as well as free software released by third parties. The development of GNU made it possible to use a computer without software that would trample your freedom.</p> <p>We recommend installable versions of GNU (more precisely, GNU/Linux distributions) which are entirely free software.</p> <p>GCC, the GNU Compiler Collection</p> <p>What is GCC?</p> <p>The GNU Compiler Collection includes front ends for , C++, Objective-C, Fortran, Ada, Go, and D, as well as libraries for these languages (libstdc++,...). GCC was originally written as the compiler for the GNU operating system. The GNU system was developed to be 100% free software, free in the sense that it respects the user's freedom.</p> <p>We strive to provide regular, high quality releases, which we want to work well on a variety of native and cross targets (including GNU/Linux), and encourage everyone to contribute changes or help testing GCC.</p> <p>GCC, the GNU Compiler Collection @git - wiki</p> <p>GCC online documentation</p> <ul> <li>Option Summary</li> <li>Overall Options</li> </ul> <p>GCC Internals)</p>"},{"location":"blog/20200202/mainstream-compiler/#architecture","title":"Architecture","text":"<p>GNU C Compiler Internals/Architecture</p> <p>For a C source file they are the preprocessor and compiler <code>cc1</code>, the assembler <code>as</code>, and the linker <code>collect2</code>. The first and the third programs come with a GCC distribution, the assembler is a part of the GNU binutils package.</p> <p></p> <p>Developer Options: <code>-dumpspecs</code> : Print the compiler\u2019s built-in Spec Files:</p> <ul> <li>cpp : Options to pass to the C preprocessor</li> <li>cc1 : Options to pass to the C compiler</li> <li>cc1plus : Options to pass to the C++ compiler</li> </ul> <p>cpp - The C Preprocessor</p> <ul> <li>Invocation: the preprocessor is actually integrated with the compiler rather than a separate program.</li> <li>Preprocessor Options: <code>-no-integrated-cpp</code>: Perform preprocessing as a separate pass before compilation.</li> </ul> <p>FAQ - GCC Wiki: the GCC C compiler (<code>cc1</code>) and C++ compiler (<code>cc1cplus</code>)</p> <p>Why cc1 is called cc1? Relationship between cc1 and gcc?</p> <p>The 1 in <code>cc1</code> indicates that it is the first stage of the build process. The second stage is <code>collect2</code>.</p> <p>Collect2 (GCC Internals): The program <code>collect2</code> is installed as <code>ld</code> in the directory where the passes of the compiler are installed.</p>"},{"location":"blog/20200202/mainstream-compiler/#gcc_and_g","title":"gcc and g++","text":"<p>GNU C Compiler: <code>gcc</code> / <code>cc</code></p> <ul> <li><code>c89</code> - ANSI (1989) C compiler</li> <li><code>c99</code> - ANSI (1999) C compiler</li> </ul> <p>GNU C++ Compiler: <code>g++</code> / <code>c++</code></p> <p>Invoking G++ - Compiling C++ Programs</p> <p>GCC recognizes C++ header/source files with these names and compiles them as C++ programs even if you call the compiler the same way as for compiling C programs (usually with the name <code>gcc</code>).</p> <p>However, the use of <code>gcc</code> does not add the C++ library. <code>g++</code> is a program that calls GCC and automatically specifies linking against the C++ library. It treats \u2018.c\u2019, \u2018.h\u2019 and \u2018.i\u2019 files as C++ source files instead of C source files unless <code>-x</code> is used. This program is also useful when precompiling a C header file with a \u2018.h\u2019 extension for use in C++ compilations. On many systems, <code>g++</code> is also installed with the name <code>c++</code>.</p> <p>What is the difference between g++ and gcc?</p> <p><code>g++</code> is roughly equivalent to <code>gcc -xc++ -lstdc++ -shared-libgcc</code> (the 1st is a compiler option, the 2nd two are linker options).</p> <ul> <li><code>-xc++</code>: Specify explicitly the language</li> <li><code>-lstdc++</code>: Search the library named <code>stdc++</code>(libstdc++) when linking</li> <li><code>-shared-libgcc</code>: G++ driver automatically adds this to use exceptions for C++ programs</li> </ul> <p>Difference between GCC and G++</p> g++ gcc g++ is used to compile C++ program. gcc is used to compile C program. g++ can compile any .c or .cpp files but they will be treated as C++ files only. gcc can compile any .c or .cpp files but they will be treated as C and C++ respectively. Command to compile C++ program through g++ is <code>g++ fileName.cpp -o binary</code> command to compile C program through gcc is <code>gcc fileName.c -o binary</code> Using g++ to link the object files, files automatically links in the std C++ libraries. gcc does not do this. g++ compiles with more predefined macros. gcc compiles C++ files with more number of predefined macros. Some of them are <code>#define __GXX_WEAK__ 1</code>, <code>#define __cplusplus 1</code>, <code>#define __DEPRECATED 1</code>, etc <p>\u4e0b\u9762\u662f rpi4b-ubuntu \u7684 /usr/bin \u4e0b <code>cpp</code>\u3001<code>gcc</code>\u3001<code>g++</code> \u547d\u4ee4\uff0c\u771f\u8eab\u5206\u522b\u4e3a aarch64-linux-gnu-cpp-11\u3001aarch64-linux-gnu-gcc-11\u3001aarch64-linux-gnu-g++-11\u3002</p> <ul> <li>aarch64-linux-gnu-gcc-11\u3001aarch64-linux-gnu-g++-11 \u8fd9\u4e24\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6 size \u4e00\u6837\uff0c\u4f46\u662f md5sum \u4e0d\u4e00\u81f4\u3002</li> </ul> <pre><code>$ ls -l /usr/bin | grep -E \"cpp|cc|[g|c]\\+\\+\"\n-rwxr-xr-x 1 root root         428 Nov 18  2020 c89-gcc\n-rwxr-xr-x 1 root root         454 Nov 18  2020 c99-gcc\n\n-rwxr-xr-x 1 root root      876656 May 13  2023 aarch64-linux-gnu-cpp-11\nlrwxrwxrwx 1 root root          24 May 13  2023 cpp-11 -&gt; aarch64-linux-gnu-cpp-11\nlrwxrwxrwx 1 root root           6 Aug  5  2021 aarch64-linux-gnu-cpp -&gt; cpp-11\nlrwxrwxrwx 1 root root           6 Aug  5  2021 cpp -&gt; cpp-11\n\n-rwxr-xr-x 1 root root      872560 May 13  2023 aarch64-linux-gnu-gcc-11\nlrwxrwxrwx 1 root root          24 May 13  2023 gcc-11 -&gt; aarch64-linux-gnu-gcc-11\nlrwxrwxrwx 1 root root           6 Aug  5  2021 aarch64-linux-gnu-gcc -&gt; gcc-11\nlrwxrwxrwx 1 root root           6 Aug  5  2021 gcc -&gt; gcc-11\n\n-rwxr-xr-x 1 root root      872560 May 13  2023 aarch64-linux-gnu-g++-11\nlrwxrwxrwx 1 root root          24 May 13  2023 g++-11 -&gt; aarch64-linux-gnu-g++-11\nlrwxrwxrwx 1 root root           6 Aug  5  2021 aarch64-linux-gnu-g++ -&gt; g++-11\nlrwxrwxrwx 1 root root           6 Aug  5  2021 g++ -&gt; g++-11\n\nlrwxrwxrwx 1 root root          20 Feb 21 10:59 cc -&gt; /etc/alternatives/cc\nlrwxrwxrwx 1 root root          21 Feb 21 10:59 c++ -&gt; /etc/alternatives/c++\n</code></pre> <p>\u8fdb\u4e00\u6b65\u9a8c\u8bc1\uff0c<code>cc</code>\u3001<code>c++</code> \u5206\u522b\u662f gcc\u3001g++ \u7684\u8f6f\u94fe\u3002</p> <pre><code>$ ls -l /etc/alternatives/cc\nlrwxrwxrwx 1 root root 12 Feb 21 10:59 /etc/alternatives/cc -&gt; /usr/bin/gcc\n\n$ ls -l /etc/alternatives/c++\nlrwxrwxrwx 1 root root 12 Feb 21 10:59 /etc/alternatives/c++ -&gt; /usr/bin/g++\n</code></pre>"},{"location":"blog/20200202/mainstream-compiler/#gnu_binutils","title":"GNU binutils","text":"<p>GNU Hurd / GNU Binutils - GNU Binutils</p> <p>Computer Systems - A Programmer\u2019s Perspective | Chapter 7: Linking - 7.14 Tools for Manipulating Object Files:</p> <p>There are a number of tools available on Linux systems to help you understand and manipulate object \ufb01les. In particular, the GNU binutils package is especially helpful and runs on every Linux platform.</p> <p>The GNU Binutils are a collection of binary tools. The main ones are:</p> <ul> <li><code>ld</code> - the GNU linker.</li> <li><code>as</code> - the GNU assembler.</li> <li><code>gold</code> - a new, faster, ELF only linker.</li> </ul> <p>But they also include:</p> <ul> <li><code>addr2line</code> - Converts addresses into filenames and line numbers.</li> <li><code>ar</code> - A utility for creating, modifying and extracting from archives.</li> <li><code>c++filt</code> - Filter to demangle encoded C++ symbols.</li> <li><code>dlltool</code> - Creates files for building and using DLLs.</li> <li><code>elfedit</code> - Allows alteration of ELF format files.</li> <li><code>nm</code> - Lists symbols from object files.</li> <li><code>objcopy</code> - Copies and translates object files.</li> <li> <p><code>objdump</code> - Displays information from object files.</p> <ul> <li>The mother of all binary tools.</li> <li>Can display all of the information in an object \ufb01le.</li> <li><code>-f</code>/<code>-a</code>/<code>-h</code>/<code>-x</code>: display file/archive/section/all headers.</li> <li>Its most useful function is disassembling the binary instructions in the <code>.text</code> section.</li> </ul> </li> <li> <p><code>ranlib</code> - Generates an index to the contents of an archive.</p> </li> <li><code>readelf</code> - Displays information from any ELF format object file.<ul> <li>Subsumes the functionality of <code>size</code> and <code>nm</code>.</li> </ul> </li> <li><code>size</code> - Lists the section sizes of an object or archive file.</li> <li><code>strip</code> - Discards symbols.</li> </ul> <p>Linux systems also provide the ldd program for manipulating shared libraries:</p> <ul> <li><code>ldd</code> - print shared object dependencies. Lists the shared libraries that an executable needs at run time.</li> </ul> <p>\u5728 Linux(Ubuntu) \u4e0b\uff0c\u8fd9\u4e9b GNU Binutils \u4e00\u822c\u9884\u88c5\u5728 <code>/usr/bin/</code> \u76ee\u5f55\u4e0b\u3002</p>"},{"location":"blog/20200202/mainstream-compiler/#language_standards","title":"Language Standards","text":"<p>Language Standards Supported by GCC</p> <p>Options Controlling the Kind of Output</p> <pre><code>-x language\nSpecify explicitly the language for the following input files (rather than letting the compiler choose a default based on the file name suffix). This option applies to all following input files until the next -x option.\n</code></pre> <p>Options Controlling C Dialect</p> <pre><code>-ansi\nIn C mode, this is equivalent to -std=c90. In C++ mode, it is equivalent to -std=c++98.\n\n-std=\nDetermine the language standard. See Language Standards Supported by GCC, for details of these standard versions. This option is currently only supported when compiling C or C++.\n</code></pre> <p>Options Controlling C++ Dialect</p> <pre><code>-stdlib=libstdc++,libc++\nWhen G++ is configured to support this option, it allows specification of alternate C++ runtime libraries. Two options are available: libstdc++ (the default, native C++ runtime for G++) and libc++ which is the C++ runtime installed on some operating systems (e.g. Darwin versions from Darwin11 onwards). The option switches G++ to use the headers from the specified library and to emit -lstdc++ or -lc++ respectively, when a C++ runtime is required for linking.\n</code></pre> <p>c++11/gnu++11 \u6709\u4ec0\u4e48\u533a\u522b\uff1f</p> <p>-std=<code>c++11</code>: The 2011 ISO C++ standard plus amendments. -std=<code>gnu++11</code>: GNU dialect of -std=c++11. ISO C 2011 with GNU extensions.</p> <p>What are the differences between -std=c++11 and -std=gnu++11? </p> <p>the difference between the two options is whether GNU extensions that violates the C++ standard are enabled or not. The GNU extensions are described here.</p> <p>\u4f7f\u7528 gcc \u7f16\u8bd1\u94fe\u63a5\u7684\u65f6\u5019\uff0c\u9ed8\u8ba4\u662f\u91c7\u7528\u52a8\u6001\u94fe\u63a5\u7684\u65b9\u5f0f\u3002\u5982\u679c\u8981\u6307\u5b9a\u9759\u6001\u94fe\u63a5\uff0c\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ol> <li>\u4f7f\u7528 <code>-static</code> \u9009\u9879\uff0c\u5f00\u542f\u5168\u9759\u6001\u94fe\u63a5\u3002</li> <li>\u4f7f\u7528 <code>-Wl,-Bstatic</code>\uff0c<code>-Wl,-Bdynamic</code> \u9009\u9879\uff0c\u5c06\u90e8\u5206\u52a8\u6001\u5e93\u8bbe\u7f6e\u4e3a\u9759\u6001\u94fe\u63a5\u3002</li> </ol> <p>\u53c2\u8003 gcc \u5168\u9759\u6001\u94fe\u63a5\uff0cQ: linker \"-static\" flag usage \u548c GCC Link Options \u4e2d\u7684\u76f8\u5173\u9009\u9879\u8bf4\u660e\u3002</p> <ul> <li>-static</li> <li>-static-libgcc</li> <li>-static-libstdc++</li> </ul> <p>\u4e00\u4e9b\u6291\u5236/\u5b9a\u5236\u9ed8\u8ba4\u94fe\u63a5\u7684\u9009\u9879\uff1a</p> <pre><code>-nostartfiles\nDo not use the standard system startup files when linking.\n\n-nodefaultlibs\nDo not use the standard system libraries when linking.\n\n-nolibc\nDo not use the C library or system libraries tightly coupled with it when linking.\n\n-nostdlib\nDo not use the standard system startup files or libraries when linking.\n\n-nostdlib++\nDo not implicitly link with standard C++ libraries.\n</code></pre>"},{"location":"blog/20200202/mainstream-compiler/#glibc","title":"glibc","text":"<p>The GNU C Library - wiki</p> <ul> <li>Documentation for the GNU C Library</li> <li>The GNU C Reference Manual</li> </ul> <p>GNU C sourceware:</p> <ul> <li>@sourceware, git</li> <li>Index of /gnu/libc</li> </ul> <p>Linux\u7684libc\u5e93\uff0clibc\u3001glibc \u548c glib \u7684\u5173\u7cfb What is the role of libc(glibc) in our linux app? Is the development of libc tied with Linux?</p> <p>There is GNU Libc and the C standard library. The former is an implementation of the latter, but there are many other implementations. Even on Linux glibc is not the only option.</p> <p>Linux/ubuntu \u4e0b\u53ef\u6267\u884c <code>man libc</code> \u6216 <code>info libc</code> \u67e5\u770b libc(7) - Linux manual page\u3002</p> <ul> <li>Ubuntu Manpage: libc - overview of standard C libraries on Linux</li> </ul> <p>libc vs. glibc</p> <p>The term <code>libc</code> is commonly used as a shorthand for the \u201cstandard C library\u201d.</p> <p>By far the most widely used C library on Linux is the GNU C Library, often referred to as <code>glibc</code>.</p> <p>In the early to mid 1990s, there was for a while Linux libc, a fork of glibc 1.x created by Linux developers who felt that glibc development at the time was not sufficing for the needs of Linux. Often, this library was referred to (ambiguously) as just <code>libc</code>.</p> <p>However, notwithstanding the original motivations of the Linux libc effort, by the time glibc 2.0 was released (in 1997), it was clearly superior to Linux libc, and all major Linux distributions that had been using Linux libc soon switched back to <code>glibc</code>.</p> <p>GNU/Linux Options \u4e2d\u652f\u6301\u914d\u7f6e C library \u7684\u9009\u9879\uff1a</p> <ul> <li><code>-mglibc</code></li> <li><code>-muclibc</code>(--linux-uclibc)</li> <li><code>-mmusl</code>(--linux-musl)</li> <li><code>-mbionic</code>(--linux-android)</li> </ul> \u83b7\u53d6\u67e5\u770b glibc \u7248\u672c\u53f7 <p>glibc \u67e5\u770b\u7248\u672c\u53f7, Linux(Ubuntu/CentOS) \u4e0b\u67e5\u770b GLIBC \u7248\u672c</p> <p>\u901a\u8fc7 <code>getconf</code> \u547d\u4ee4\u83b7\u53d6 GNU_LIBC_VERSION\uff1a</p> <pre><code>$ getconf GNU_LIBC_VERSION\nglibc 2.35\n</code></pre> <p><code>ldd</code> \u662f glibc \u63d0\u4f9b\u7684\u547d\u4ee4\uff0c\u6267\u884c <code>ldd --version</code> \u4f1a\u8f93\u51fa glibc \u7684\u7248\u672c\u53f7\uff1a</p> <pre><code>$ ldd --version\nldd (Ubuntu GLIBC 2.35-0ubuntu3.7) 2.35\nCopyright (C) 2022 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\nWritten by Roland McGrath and Ulrich Drepper.\n</code></pre> <p>\u76f4\u63a5\u6267\u884c libc.so\uff0c\u53ef\u4ee5\u770b\u5230 GLIBC \u7248\u672c\u4e3a 2.35\uff1a</p> <pre><code>$ /lib/aarch64-linux-gnu/libc.so.6\nGNU C Library (Ubuntu GLIBC 2.35-0ubuntu3.7) stable release version 2.35.\nCopyright (C) 2022 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.\nThere is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A\nPARTICULAR PURPOSE.\nCompiled by GNU CC version 11.4.0.\nlibc ABIs: UNIQUE ABSOLUTE\nFor bug reporting instructions, please see:\n&lt;https://bugs.launchpad.net/ubuntu/+source/glibc/+bugs&gt;.\n</code></pre>"},{"location":"blog/20200202/mainstream-compiler/#libstdc","title":"libstdc++","text":"<p>The GNU C++ Library</p> <p>The GNU C++ Library Manual</p> <p>The GCC project includes an implementation of the C++ Standard Library called <code>libstdc++</code>, licensed under the GPLv3 License with an exception to link non-GPL applications when sources are built with GCC.</p> <p>\u5398\u6e05 gcc\u3001glibc\u3001libstdc++ \u7684\u5173\u7cfb</p> <p>\u5982\u4f55\u5347\u7ea7linux\u7684libstdc++.so - \u77e5\u4e4e</p>"},{"location":"blog/20200202/mainstream-compiler/#gdb","title":"GDB","text":"<p>GCC Debugging Options</p> <p>GNU Hurd / GNU GDB - wiki</p> <p>GDB: The GNU Project Debugger</p> <ul> <li>GDB\u2019s Obsolete Annotations</li> <li>Debugging with GDB: integrated, index/toc</li> <li>@sourceware, git</li> </ul> <p>VisualGDB - GDB Command Reference \u7528GDB\u8c03\u8bd5\u7a0b\u5e8f\uff1a\uff08\u4e00\uff09 \uff5e \uff08\u4e03\uff09</p> <p>GDB online Debugger</p>"},{"location":"blog/20200202/mainstream-compiler/#clangllvm","title":"Clang/LLVM","text":"<p>In 2006, Chris Lattner started working on a new project named Clang. The combination of Clang frontend and LLVM backend is named Clang/LLVM or simply Clang.</p> <p>The LLVM Compiler Infrastructure Project - wiki @github</p> <ul> <li>LLVM's Documentation</li> </ul> <p>Clang C Language Family Frontend for LLVM - wiki</p> <ul> <li>Clang's documentation</li> <li>Clang Compiler User\u2019s Manual</li> <li>clang - the Clang C, C++, and Objective-C compiler</li> <li>Clang command line argument reference</li> <li>Preprocessor options</li> </ul> <p>\u4f5c\u4e3a Apple Developer\uff0c\u5f80\u5f80\u9996\u5148\u9700\u8981\u5728 macOS \u5f00\u53d1\u673a\u4e0a\u5b89\u88c5 Xcode IDE\uff0cClang/LLVM \u7f16\u8bd1\u5668\u5de5\u5177\u94fe\u5305\u542b\u5728 Xcode command-line tools \u4e2d\u3002</p> <p>What is the Command Line Tools Package?</p> <p>Technical Note TN2339: Building from the Command Line with Xcode FAQ</p> <p>The Command Line Tools Package is a small self-contained package available for download separately from Xcode and that allows you to do command line development in macOS. It consists of the macOS SDK and command-line tools such as Clang, which are installed in the <code>/Library/Developer/CommandLineTools</code> directory.</p> <p>In macOS 10.9 and later, the Downloads pane of Xcode Preferences does not support downloading command-line tools.</p> <p>\u5982\u679c\u4e0d\u662f Apple Native Developer\uff0c\u53ea\u662f\u628a macOS \u5f53\u505a User-friendly \u7684 Unix-like \u5f00\u53d1\u673a\u4f7f\u7528\uff0c\u53ef\u4ee5\u81ea\u884c\u524d\u5f80 Download for Apple Developers page \u4e0b\u8f7d\u5b89\u88c5 Command Line Tools\u3002\u5728 macOS \u4e0a\u5b89\u88c5 homebrew \u4e5f\u4f1a\u63d0\u793a\u9700\u8981\u5b89\u88c5 Xcode Command Line Tools\u3002</p> <p>Command Line Tools for Xcode</p> <p>This package enables UNIX-style development via Terminal by installing command line developer tools, as well as macOS SDK frameworks and headers. Many useful tools are included, such as the Apple LLVM compiler, linker, and Make. If you use Xcode, these tools are also embedded within the Xcode IDE.</p>"},{"location":"blog/20200202/mainstream-compiler/#architecture_1","title":"Architecture","text":"<p>Introduction to the LLVM Compiler System</p> <p>The Architecture of Open Source Applications (Volume 1) LLVM</p> <p>Three Major Components of a Three-Phase Compiler:</p> <p>Implications of this Design - Retargetablity:</p> <p>LLVM's Implementation of Three-Phase Design:</p> <p>LLVM Linker</p> <p>The <code>lld</code> subproject is an attempt to develop a built-in, platform-independent linker for LLVM. lld aims to remove dependence on a third-party linker. As of May 2017, lld supports ELF, PE/COFF, Mach-O, and WebAssembly in descending order of completeness. lld is faster than both flavors of GNU ld.</p> <p>Unlike the GNU linkers, lld has built-in support for link-time optimization (LTO). This allows for faster code generation as it bypasses the use of a linker plugin, but on the other hand prohibits interoperability with other flavors of LTO.</p>"},{"location":"blog/20200202/mainstream-compiler/#gcc_compatibility","title":"GCC compatibility","text":"<p>xcode - Why can't I check my version of GCC compiler on OS X - Stack Overflow</p> <p>Apple no longer distributes GCC with Xcode. They now use <code>Clang</code> as the default (and only!) compiler on Mac OS X. cc, gcc, and clang (as well as the C++ variants, c++, g++, and clang++) are now all linked to run clang under current versions of Xcode.</p> <p>installation compiler cc or gcc in Mac OS 10.13.3 - Apple Community</p> <p>Apple no longer includes GNU products due to their GPL3 licensing issues. The clang/llvm compiler technology does have limited, legacy (older) GNU C/C++ compatibility \u2014 even down to the gcc/g++ commands (linked to clang/llvm GNU compatibility mode) which can compile well-written C/C++ code that does not have specific GNU dependencies.</p> <p>Clang Performance and GCC compatibility</p> <p>Clang Compiler Driver (Drop-in Substitute for GCC): The clang tool is the compiler driver and front-end, which is designed to be a drop-in replacement for the gcc command.</p> <p>GCC compatibility</p> <p>Clang is compatible with GCC. Its command-line interface shares many of GCC's flags and options. Clang implements many GNU language extensions and compiler intrinsics, some of which are purely for compatibility. For example, even though Clang implements atomic intrinsics which correspond exactly with C11 atomics, it also implements GCC's __sync_* intrinsics for compatibility with GCC and libstdc++. Clang also maintains ABI compatibility with GCC-generated object code. In practice, Clang is a drop-in replacement for GCC.</p> <p>gcc - Is there a binutils for llvm? - Stack Overflow</p>"},{"location":"blog/20200202/mainstream-compiler/#llvm-gccllvm-g","title":"llvm-gcc/llvm-g++","text":"<p>\u5728 macOS \u4e0a\u6267\u884c <code>which clang</code> \u548c <code>clang --version</code> \u68c0\u67e5 clang \u7684\u4f4d\u7f6e\u548c\u7248\u672c\u3002</p> <pre><code>$ which clang\n/usr/bin/clang\n\n# /usr/bin/clang --version\n$ clang --version\nApple clang version 15.0.0 (clang-1500.3.9.4)\nTarget: arm64-apple-darwin23.5.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n</code></pre> <p>\u5728 XcodeDefault.xctoolchain/usr/bin \u4e0b\uff0cclang \u8fd8\u6709\u4e2a\u8f6f\u94fe\u66ff\u8eab\uff08symbolic link\uff09\u2014\u2014clang++\u3002</p> <p>Clang is the name of the whole compiler. However, from a command-line point of view:</p> <ul> <li><code>clang</code> is the C compiler</li> <li><code>clang++</code> is the C++ compiler</li> </ul> <p>Clang is compatible with GCC. Its command-line interface shares many of GCC's flags and options.</p> <p>\u5728 macOS \u4e2d\uff0cclang/gcc \u4ee5\u67d0\u79cd\u65b9\u5f0f\u6307\u5411 <code>llvm-gcc</code> \u7f16\u8bd1\u5668\u3002</p> <p>llvm-gcc is a C, C++, Objective-C and Objective-C++ compiler. llvm-gcc uses gcc front-end and gcc's command line interface. In Apple's version of GCC, both cc and gcc are actually symbolic links to the llvm-gcc compiler.</p> <p>\u800c clang/g++ \u5219\u4ee5\u67d0\u79cd\u65b9\u5f0f\u6307\u5411 <code>llvm-g++</code> \u7f16\u8bd1\u5668\u3002</p> <p>llvm-g++ is a compiler driver for C++. Similarly, c++ and g++ are links to llvm-g++.</p> <p>llvmgcc: llvm-gcc - LLVM C front-end</p> <p>llvm-gcc</p> <p>The llvm-gcc command is the LLVM C front end. It is a modified version of gcc that compiles C/ObjC programs into native objects, LLVM bitcode or LLVM assembly language, depending upon the options.</p> <p>By default, llvm-gcc compiles to native objects just like GCC does. If the<code>-emit-llvm</code> and <code>-c</code> options are given then it will generate LLVM bitcode files instead. If <code>-emit-llvm</code> and <code>-S</code> are given, then it will generate LLVM assembly.</p> <p>Being derived from the GNU Compiler Collection, llvm-gcc has many of gcc's features and accepts most of gcc's options. It handles a number of gcc's extensions to the C programming language. See the gcc documentation for details.</p> <p>llvmgxx: llvm-g++ - LLVM C++ front-end</p> <p>llvm-g++</p> <p>The llvm-g++ command is the LLVM C++ front end. It is a modified version of g++ that compiles C++/ObjC++ programs into native code, LLVM bitcode or assembly language, depending upon the options.</p> <p>By default, llvm-g++ compiles to native objects just like GCC does. If the <code>-emit-llvm</code> option is given then it will generate LLVM bitcode files instead. If <code>-S</code> (assembly) is also given, then it will generate LLVM assembly.</p> <p>Being derived from the GNU Compiler Collection, llvm-g++ has many of g++'s features and accepts most of g++'s options. It handles a number of g++'s extensions to the C++ programming language.</p> <p><code>which gcc</code> \u548c <code>which g++</code> \u8f93\u51fa\u4f4d\u7f6e\u4e3a <code>/usr/bin</code>\uff1b\u4f46\u662f <code>gcc --version</code> \u548c <code>g++ --version</code> \u8f93\u51fa\u7684 InstalledDir \u76ee\u5f55\u4e3a <code>$(xcode-select -p)/Toolchains/XcodeDefault.xctoolchain/usr/bin</code>\u3002</p> gcc --versiong++ --version <pre><code>$ which llvm-gcc\n/usr/bin/llvm-gcc\n\n$ which gcc\n/usr/bin/gcc\n\n# llvm-gcc --version\n$ gcc --version\nApple clang version 15.0.0 (clang-1500.3.9.4)\nTarget: arm64-apple-darwin23.5.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n</code></pre> <pre><code>$ which llvm-g++\n/usr/bin/llvm-g++\n\n$ which g++\n/usr/bin/g++\n\n# llvm-g++ --version\n$ g++ --version\nApple clang version 15.0.0 (clang-1500.3.9.4)\nTarget: arm64-apple-darwin23.5.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n</code></pre> <p>\u8fd9\u4e24\u4e2a\u76ee\u5f55\u6709\u4ec0\u4e48\u5173\u8054\uff08\u732b\u817b\uff09\u5462\uff1f</p> <p>\u5728 macOS \u4e0b\u6267\u884c <code>cat /etc/paths</code> \u53ef\u4ee5\u770b\u5230\u73af\u5883\u53d8\u91cf\u4e2d\u6709 <code>/usr/local/bin</code> \u548c <code>/usr/bin</code>\uff0c\u6ca1\u6709 Xcode \u6216 CommandLineTools \u76f8\u5173\u7684 /usr/bin \u76ee\u5f55\u3002\u6267\u884c <code>echo $PATH</code> \u67e5\u770b PATH\uff0c\u5176\u4e2d\u4e5f\u6ca1\u6709\u8fd9\u4e9b Xcode Compiler Toolchain \u76ee\u5f55\u3002</p> <p>\u53ef\u4ee5\u786e\u5b9a\u7684\u662f\uff0cllvm-gcc/llvm-g++ \u6765\u81ea /usr/bin\uff0c\u81f3\u5c11\u4ece\u547d\u4ee4\u884c\u6267\u884c\u5c42\u9762\u6765\u770b\u662f\u8fd9\u6837\u7684\u3002</p>"},{"location":"blog/20200202/mainstream-compiler/#clangllvm_binutils","title":"clang/llvm binutils","text":"<p>Technical Note TN2339: Building from the Command Line with Xcode FAQ</p> <p>xcode command-line tools bundled shims or wrapper in /usr/bin</p> <p>If Xcode is installed on your machine, then there is no need to install them. Xcode comes bundled with all your command-line tools. macOS 10.9 and later includes shims or wrapper executables. These shims, installed in <code>/usr/bin</code>, can map any tool included in <code>/usr/bin</code> to the corresponding one inside Xcode. <code>xcrun</code> is one of such shims, which allows you to find or run any tool inside Xcode from the command line. Use it to invoke any tool within Xcode from the command line.</p> <p>\u6267\u884c <code>man xcode-select</code> \u67e5\u770b\u5e2e\u52a9\uff0c\u624b\u518c\u4e2d\u7684 Usage \u90e8\u5206\u548c FILES \u6709\u76f8\u5173\u8bf4\u660e\uff1a</p> <pre><code>man xcode-select\n\nUsage\n\n       After setting a developer directory, all of the xcode-select provided developer tool shims (see\n       FILES) will automatically invoke the version of the tool inside the selected developer directory.\n       Your own scripts, makefiles, and other tools can also use xcrun(1) to easily lookup tools inside\n       the active developer directory, making it easy to switch them between different versions of the\n       Xcode tools and allowing them to function properly on systems where the Xcode application has\n       been installed to a non-default location.\n\nFILES\n\n       /usr/bin/git /usr/bin/make\n\n       /usr/bin/c89 /usr/bin/c99\n       /usr/bin/clang++ /usr/bin/clang\n       /usr/bin/cpp /usr/bin/ctags\n       /usr/bin/g++ /usr/bin/gcc\n\n       /usr/bin/as /usr/bin/ar\n       /usr/bin/ld /usr/bin/lldb\n       /usr/bin/nm /usr/bin/objdump\n       /usr/bin/ranlib /usr/bin/size\n       /usr/bin/strings /usr/bin/strip\n       Runs the matching BSD tool from with the active developer directory.\n</code></pre> <p>xcode-select \u548c xcrun \u547d\u4ee4\uff1a</p> <ul> <li><code>xcode-select -s</code>: Sets the active developer directory to the given path, for example /Applications/Xcode-beta.app.</li> <li><code>xcode-select -p</code>: Prints the path to the currently selected developer directory.</li> <li><code>xcrun</code> - Run or locate development tools and properties.</li> </ul>"},{"location":"blog/20200202/mainstream-compiler/#xcode_selecttool-shim","title":"xcode_select.tool-shim","text":"<p>use <code>xcrun</code> to easily lookup tools inside the active developer directory:</p> <pre><code># xcrun provide the absolute path\n$ xcrun -f gcc\n/Applications/Xcode.app/Contents/Developer/usr/bin/gcc\n# xcrun gcc --version\n\n$ xcrun -f g++\n/Applications/Xcode.app/Contents/Developer/usr/bin/g++\n# xcrun g++ --version\n\n$ xcrun -f cc\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cc\n$ xcrun -f c++\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/c++\n$ xcrun -f cpp\n/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/cpp\n</code></pre> <p>\u7efc\u4e0a\u53ef\u77e5\uff0cmacOS \u4e0b clang/llvm \u7684 compiler toolchain Binutils \u5206\u5e03\u5728\u56db\u4e2a /usr/bin \u76ee\u5f55\u4e0b\uff1a</p> <ol> <li>/usr/bin</li> <li>/Library/Developer/CommandLineTools/usr/bin</li> <li>/Applications/Xcode.app/Contents/Developer/usr/bin</li> <li>/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin</li> </ol> <p>\u5bf9\u56db\u4e2a /usr/bin \u76ee\u5f55\u5206\u652f\u6267\u884c <code>ls -l</code> \u8fc7\u6ee4\u51fa clang/clang++, gcc/cc, g++/c++ \u76f8\u5173\u547d\u4ee4\u3002</p> <pre><code>usrbin=/usr/bin\ncmdbin=/Library/Developer/CommandLineTools/usr/bin\nxcdevpath=`xcode-select -p` # /Applications/Xcode.app/Contents/Developer\nxcdevbin=$xcdevpath/usr/bin\nxctcbin=$xcdevpath/Toolchains/XcodeDefault.xctoolchain/usr/bin\n\nls -l $usrbin | grep -E \"clang|(cc|gcc)$|[g|c]\\+\\+\"\nls -l $cmdbin | grep -E \"clang|(cc|gcc)$|[g|c]\\+\\+\"\nls -l $xcdevbin | grep -E \"clang|(cc|gcc)$|[g|c]\\+\\+\"\nls -l $xctcbin | grep -E \"clang|(cc|gcc)$|[g|c]\\+\\+\"\n\n# \u53ef\u4ee5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u76ee\u5f55\u4e4b\u95f4\u7684\u516c\u5171\u5206\u5e03\ncomm -12 &lt;(ls $usrbin) &lt;(ls $cmdbin)\ncomm -12 &lt;(ls $usrbin) &lt;(ls $xcdevbin)\ncomm -12 &lt;(ls $usrbin) &lt;(ls $xctcbin)\n</code></pre> usrbincmdbinxcdevbinxctcbin <pre><code>$ ls -l $usrbin | grep -E \"clang|cpp|(cc|gcc)$|[g|c]\\+\\+\"\n-rwxr-xr-x  77 root   wheel    119008 Apr 20 12:52 c++\n-rwxr-xr-x  77 root   wheel    119008 Apr 20 12:52 cc\n-rwxr-xr-x  77 root   wheel    119008 Apr 20 12:52 clang\n-rwxr-xr-x  77 root   wheel    119008 Apr 20 12:52 clang++\n-rwxr-xr-x  77 root   wheel    119008 Apr 20 12:52 cpp\n-rwxr-xr-x  77 root   wheel    119008 Apr 20 12:52 g++\n-rwxr-xr-x  77 root   wheel    119008 Apr 20 12:52 gcc\n-rwxr-xr-x  77 root   wheel    119008 Apr 20 12:52 llvm-g++\n-rwxr-xr-x  77 root   wheel    119008 Apr 20 12:52 llvm-gcc\n</code></pre> <pre><code>$ ls -l $cmdbin | grep -E \"clang|cpp|(cc|gcc)$|[g|c]\\+\\+\"\nlrwxr-xr-x  1 root  wheel          5 Mar  8 00:55 c++ -&gt; clang\nlrwxr-xr-x  1 root  wheel          5 Mar  8 00:55 cc -&gt; clang\n-rwxr-xr-x  1 root  wheel  251484800 Feb 23 10:06 clang\nlrwxr-xr-x  1 root  wheel          5 Mar  8 00:55 clang++ -&gt; clang\nlrwxr-xr-x  1 root  wheel          3 Mar  8 00:55 g++ -&gt; gcc\n-rwxr-xr-x  1 root  admin       3344 Feb  3 02:02 cpp\n-rwxr-xr-x  1 root  admin     101088 Feb 23 10:06 gcc\n</code></pre> <pre><code>$ ls -l $xcdevbin | grep -E \"clang|cpp|(cc|gcc)$|[g|c]\\+\\+\"\nlrwxr-xr-x  1 root  wheel         3 Mar  6 13:05 g++ -&gt; gcc\n-rwxr-xr-x  1 root  wheel    101088 Feb 23 10:06 gcc\n</code></pre> <pre><code>$ ls -l $xctcbin | grep -E \"clang|cpp|(cc|gcc)$|[g|c]\\+\\+\"\nlrwxr-xr-x  1 root  wheel          5 Mar  6 13:04 c++ -&gt; clang\nlrwxr-xr-x  1 root  wheel          5 Mar  6 13:04 cc -&gt; clang\n-rwxr-xr-x  1 root  wheel  251484800 Feb 23 10:06 clang\nlrwxr-xr-x  1 root  wheel          5 Mar  6 13:04 clang++ -&gt; clang\n-rwxr-xr-x  1 root  wheel       3344 Feb  3 02:01 cpp\n</code></pre> <p>\u4ece\u8f93\u51fa\u7ed3\u679c\u6765\u770b\uff0c\u6709\u4e9b\u662f\u5b9e\u4f53\u6587\u4ef6\uff0c\u6709\u4e9b\u662f\u8f6f\u94fe\u66ff\u8eab\uff1a</p> <ol> <li>\u7cfb\u7edf /usr/bin \u4e0b\u7684 clang/clang++, cpp, gcc/cc, g++/c++ \u7b49 size \u548c md5 \u4e00\u81f4\u3002\u6267\u884c <code>strings</code> \u547d\u4ee4\u6216 <code>otool -P</code> \u67e5\u770b\u5176\u4e2d\u7684 plist \u53ef\u77e5\uff0c\u5b83\u4eec\u5747\u4e3a xcode_select.tool-shim\u3002</li> <li>CommandLineTools\uff08cmdbin\uff09\u548c <code>xcode-select -p</code>\uff08xcdevbin\uff09\u4e0b\u7684 clang++ \u548c cc/c++ \u5747\u6307\u5411 clang \uff0cg++ \u6307\u5411 gcc\uff08\u8c8c\u4f3c\u8fd8\u662f xcode_select.tool-shim\uff1f\uff09\u3002</li> </ol>"},{"location":"blog/20200202/mainstream-compiler/#corresponding_to_gnu","title":"corresponding to GNU","text":"<p>\u9664\u4e86 llvm-gcc/llvm-g++ \u7f16\u8bd1\u5668\uff0c\u4ece <code>man xcode-select</code> \u7684 FILES \u90e8\u5206\uff0c\u53ef\u4ee5\u770b\u5230 /usr/bin \u4e0b\u7684 as\u3001ar\u3001ld\u3001lldb\u3001nm\u3001objdump\u3001ranlib\u3001strings\u3001size\u3001strip \u7b49 GNU compatible \u540c\u540d binutils \u4e5f\u662f xcode_select.tool-shim\u3002\u5f53\u6211\u4eec\u5728\u6267\u884c <code>objdump</code> \u65f6\uff0c\u5b9e\u9645\u4e0a\u7b49\u4ef7\u4e8e <code>xcrun objdump</code>\u3002</p> <p>\u4e0b\u9762\u7a0d\u5fae\u68b3\u7406\u5bf9\u6bd4\u4e00\u4e0b clang \u548c gcc \u63d0\u4f9b\u7684\u5e38\u7528\u5de5\u5177\u96c6\uff08binutils\uff09\u3002</p> <p>clang \u76f8\u6bd4 gcc \u5c11\u4e86\u4ee5\u4e0b\u547d\u4ee4\uff0c\u6709\u4e9b\u5b98\u65b9\u63d0\u4f9b\u4e86 drop-in replacement\uff1a</p> <ul> <li><code>gold</code>: The LLVM gold plugin</li> <li><code>addr2line</code>: llvm-addr2line - a drop-in replacement for addr2line</li> <li><code>elfedit</code>: segedit</li> <li><code>objcopy</code>: llvm-objcopy - object copying and editing tool</li> <li><code>readelf</code>: llvm-readelf - GNU-style LLVM Object Reader</li> </ul> <p>clang \u76f8\u6bd4 gcc \u591a\u4e86\u4ee5\u4e0b\u547d\u4ee4\uff0c\u6709\u4e9b\u662f\u9488\u5bf9 Mach-O\uff08\u53c2\u8003 Overview\uff0cReference\uff09\u683c\u5f0f\u7279\u6709\u7684\u64cd\u4f5c\u5de5\u5177\uff1a</p> <ul> <li><code>cmpdylib</code> - compare two dynamic shared libraries for compatibility</li> <li><code>dsymutil</code> - manipulate archived DWARF debug symbol files</li> <li><code>dwarfdump</code> - dump and verify DWARF debug information</li> <li><code>indent</code> \u2013 indent and format C program source</li> <li><code>install_name_tool</code> - change dynamic shared library install names</li> <li><code>libtool</code> - create libraries</li> <li> <p><code>lipo</code> - create or operate on universal files</p> <ul> <li><code>lipo -info</code>: Display a brief description</li> </ul> </li> <li> <p><code>lorder</code> \u2013 list dependencies for object files</p> </li> <li><code>nmedit</code> - change global symbols to local symbols</li> <li> <p><code>otool</code>(-classic) - object file displaying tool</p> <ul> <li><code>otool -h</code>: Display the Mach header</li> <li><code>otool -L</code>: Display the shared libraries uses - \u5bf9\u5e94 Linux \u4e0b\u7684 <code>ldd</code></li> </ul> </li> <li> <p><code>segedit</code> - extract and replace sections from object files</p> </li> <li><code>unifdef</code>, unifdefall \u2013 remove preprocessor conditionals from code</li> <li><code>vtool</code> \u2013 Mach-O version number utility</li> </ul> <p>Cross-compilation using Clang Building Linux with Clang/LLVM \u2014 The Linux Kernel documentation</p> <pre><code>make CC=clang LD=ld.lld AR=llvm-ar NM=llvm-nm STRIP=llvm-strip \\\n  OBJCOPY=llvm-objcopy OBJDUMP=llvm-objdump READELF=llvm-readelf \\\n  HOSTCC=clang HOSTCXX=clang++ HOSTAR=llvm-ar HOSTLD=ld.lld\n</code></pre>"},{"location":"blog/20200202/mainstream-compiler/#language_standards_1","title":"Language Standards","text":"<p>LLVM Language Reference Manual</p> <p>Clang - C Programming Language Status Clang - C++ Programming Language Status</p> <p>clang - the Clang C, C++, and Objective-C compiler</p> <p>OPTIONS | Language Selection and Mode Options:</p> <pre><code>-x &lt;language&gt;\nTreat subsequent input files as having type language.\n\n-ansi\nSame as -std=c89.\n\n-std=&lt;standard&gt;\nSpecify the c/c++ language standard to compile for.\n\nThe default C language standard is gnu17, except on PS4, where it is gnu99.\nThe default C++ language standard is gnu++17.\n\n-stdlib=&lt;library&gt;\nSpecify the C++ standard library to use; supported options are libstdc++ (GNU GCC) and libc++ (Clang). If not specified, platform default will be used.\n</code></pre> <p>Clang command line argument reference</p> <p>Introduction:</p> <pre><code>-std-default=&lt;arg&gt;\n-stdlib=&lt;arg&gt;, --stdlib=&lt;arg&gt;, --stdlib &lt;arg&gt;\nC++ standard library to use. &lt;arg&gt; must be \u2018libc++\u2019, \u2018libstdc++\u2019 or \u2018platform\u2019.\n</code></pre> <p>Compilation options:</p> <pre><code>-std=&lt;arg&gt;, --std=&lt;arg&gt;, --std &lt;arg&gt;\nLanguage standard to compile for\n</code></pre> <p>Compiler Specifics \u2014 alpaka 1.0.0-rc1 documentation</p> <p>C++ Language Support - Xcode - Apple Developer</p> <p>Apple supports C++ with the Apple <code>Clang</code> compiler (included in Xcode) and the <code>libc++</code> C++ standard library runtime (included in SDKs and operating systems). The compiler and runtime are regularly updated to offer new functionality, including many leading-edge features specified by the ISO C++ standard.</p> <p>\u5173\u4e8e\u9759\u6001\u94fe\u63a5\uff0c\u53c2\u8003 Clang command line argument reference \u76f8\u5173\u9009\u9879\uff1a</p> <ul> <li>-static-libgcc</li> <li>-static-libstdc++</li> </ul>"},{"location":"blog/20200202/mainstream-compiler/#libc","title":"libc","text":"<p>C Language Features</p> <p>The LLVM C Library is an incomplete, upcoming, ABI independent C standard library designed by and for the LLVM project.</p> <p>libc incompleteness</p> <p>The <code>libc</code> is not complete. If you need a fully functioning C library right now, you should continue to use your standard system libraries.</p> <p>Xcode Project Settings | Language | C Language Dialect \u5bf9\u5e94 project.pbxproj \u4e2d buildSettings \u5b57\u5178\u7684 key = <code>GCC_C_LANGUAGE_STANDARD</code>\u3002</p>"},{"location":"blog/20200202/mainstream-compiler/#libc_1","title":"libc++","text":"<p>C++ Language Features</p> <p>The LLVM project includes an implementation of the C++ Standard Library named <code>libc++</code>, dual-licensed under the MIT License and the UIUC license.</p> <p>\u201clibc++\u201d C++ Standard Library \u2014 libc++ documentation</p> <p><code>libc++</code> is a new implementation of the C++ standard library, targeting C++11 and above.</p> <p>Xcode Project Settings | Language - C++:</p> <ul> <li>C++ Language Dialect \u5bf9\u5e94 project.pbxproj \u4e2d buildSettings \u5b57\u5178\u7684 key = <code>CLANG_CXX_LANGUAGE_STANDARD</code>\u3002</li> <li>C++ Standard Library \u5bf9\u5e94 project.pbxproj \u4e2d buildSettings \u5b57\u5178\u7684 key = <code>CLANG_CXX_LIBRARY</code>\u3002</li> </ul>"},{"location":"blog/20200202/mainstream-compiler/#lldb","title":"LLDB","text":"<p>Controlling Debug Information Debug information generation</p> <p>LLDB - wiki</p> <ul> <li>GDB to LLDB command map</li> <li>Tutorial</li> <li>Debugging</li> </ul> <p>Getting Started with LLDB GDB and LLDB Command Examples</p> <p>Dancing in the Debugger \u2014 A Waltz with LLDB ObjC \u4e2d\u56fd - \u4e0e\u8c03\u8bd5\u5668\u5171\u821e - LLDB \u7684\u534e\u5c14\u5179</p>"},{"location":"blog/20200202/mainstream-compiler/#msvc","title":"MSVC","text":"<p>MSVC</p> <p>Install Visual Studio Visual Studio documentation</p>"},{"location":"blog/20200202/mainstream-compiler/#binutils","title":"Binutils","text":"<p>C/C++ projects and build systems in Visual Studio</p> <p>Compiler and build tools reference - C/C++ Building Reference - Visual Studio</p> <p>Use the Microsoft C++ toolset from the command line</p> <p>Win10 \u4e0b\u5b89\u88c5\u7684 VS2015\uff0cVC Binutils \u5728 <code>C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\bin</code> \u76ee\u5f55\u4e0b\uff1a</p> <ul> <li>CL: Use the compiler (<code>cl.exe</code>) to compile and link source code files into apps, libraries, and DLLs.</li> <li> <p>Link: Use the linker (<code>link.exe</code>) to link compiled object files and libraries into apps and DLLs.</p> </li> <li> <p>LIB.EXE\u00a0is used to create and manage a library of Common Object File Format (COFF) object files. It can also be used to create export files and import libraries to reference exported definitions.</p> </li> <li>EDITBIN.EXE\u00a0is used to modify COFF binary files.</li> <li>DUMPBIN.EXE\u00a0displays information (such as a symbol table) about COFF binary files.</li> <li>Decorated names - Viewing undecorated names: You can use <code>undname.exe</code> to convert a decorated name to its undecorated form. ref to Demangling in MSVC - c++.</li> </ul> <p>NMAKE: Use NMAKE (<code>nmake.exe</code>) reads and executes makefiles, to build C++ projects by using a traditional makefile.</p> <p>CMake: CMake (<code>cmake.exe</code>) is a cross-platform, open-source tool for defining build processes that run on multiple platforms.</p> <p>CMake projects in Visual Studio</p> <ul> <li>Walkthrough: Build and Debug C++ with Microsoft Windows Subsystem for Linux 2 (WSL 2) and Visual Studio 2022</li> <li>Clang/LLVM support in Visual Studio CMake projects</li> </ul>"},{"location":"blog/20200202/mainstream-compiler/#language_standards_2","title":"Language Standards","text":"<p>/std (Specify Language Standard Version)</p> <p>Microsoft C++ compiler versions</p> <p>C and C++ in Visual Studio Microsoft C/C++ language conformance C++ conformance improvements in Visual Studio 2022</p> <p>Microsoft C/C++ Documentation: C++, C, and Assembler C runtime library reference Universal C runtime routines by category</p> <p>C/C++ language and standard libraries reference</p>"},{"location":"blog/20200202/mainstream-compiler/#windbg","title":"WinDbg","text":"<p>First look at the debugger - Visual Studio (Windows)</p> <p>Debugging Tools for Windows - Windows drivers</p> <p>WinDbg - wiki</p> <p>Install WinDbg</p>"},{"location":"blog/20200202/mainstream-compiler/#refs","title":"refs","text":"<p>The Edge of C++</p> <p>Top C++ Compilers - Incredibuild</p> <p>List of Top 10 C/C++ Compilers</p> <p>GCC vs. Clang/LLVM: An In-Depth Comparison of C/C++ Compilers</p>"},{"location":"blog/20200204/0-gdb-man-help/","title":"GDB manual & help","text":"<p>This initial piece introduces how to use the gdb help system.</p> <ol> <li>GDB onlinedocs, concept index.</li> <li>Help within GDB, search command class and detailed command name.</li> <li>Take the breakpoints search as an example to exemplify help usage.</li> </ol>","tags":["gdb"]},{"location":"blog/20200204/0-gdb-man-help/#gdb_online","title":"gdb online","text":"<p>GDB: The GNU Project Debugger</p> <ul> <li>GDB\u2019s Obsolete Annotations</li> <li>Debugging with GDB: integrated, index/toc</li> </ul> <p>VisualGDB - GDB Command Reference: an incomplete reference of most frequently used GDB commands.</p> <p>\u67e5\u770b Debugging with GDB - index/toc\uff0c\u53ef\u4ee5\u641c\u7d22\u76f8\u5173\u8bdd\u9898\u7ae0\u8282\u3002</p> <p>\u53ef\u4ee5\u5728 Concept Index \u7d22\u5f15\u9875\u9762\u641c\u7d22\u67e5\u627e\u67d0\u4e2a\u611f\u5174\u8da3\u7684\u5173\u952e\u8bcd\u3002</p> <p>\u641c\u7d22 <code>info</code> \u76f8\u5173\u7684\u8bdd\u9898\uff1a</p> <ul> <li>process info via\u00a0/proc</li> <li>info line, repeated calls</li> <li>info proc files</li> </ul> <p>\u641c\u7d22 <code>examin</code> \u76f8\u5173\u7684\u8bdd\u9898\uff1a</p> <ul> <li>examine process image</li> <li>examining data</li> <li>examining memory</li> </ul> <p>\u5728 index/toc \u548c Concept Index \u4e2d\u90fd\u641c\u7d22\u4e0d\u5230\u67d0\u4e2a\u611f\u5174\u8da3\u7684\u5173\u952e\u8bcd\u65f6\uff0c\u53ef\u4ee5\u501f\u52a9\u672c\u673a GDB \u5b9e\u65f6 help \u547d\u4ee4\u67e5\u627e\u76f8\u5173\u8bdd\u9898\u3002</p>","tags":["gdb"]},{"location":"blog/20200204/0-gdb-man-help/#man_gdb","title":"man gdb","text":"<p>\u672c\u673a\u6267\u884c <code>gdb --help</code> \u53ef\u4ee5\u67e5\u770b gdb \u7684 usage \u5e2e\u52a9\u6982\u8981\uff1a</p> <pre><code>$ gdb --help\nThis is the GNU debugger.  Usage:\n\n    gdb [options] [executable-file [core-file or process-id]]\n    gdb [options] --args executable-file [inferior-arguments ...]\n\nFor more information, type \"help\" from within GDB, or consult the\nGDB manual (available as on-line info or a printed manual).\n</code></pre> <p>\u672c\u673a\u6267\u884c <code>man gdb</code> \u6216 <code>info gdb</code> \u53ef\u67e5\u770b gdb \u8c03\u8bd5\u5668\u7684\u8be6\u7ec6\u53c2\u8003\u624b\u518c\u3002</p>","tags":["gdb"]},{"location":"blog/20200204/0-gdb-man-help/#help_within_gdb","title":"help within GDB","text":"<p>\u6267\u884c <code>gdb</code> \u542f\u52a8 gdb \u6267\u884c\u73af\u5883\uff08REPL\uff09\uff0c\u6216 <code>gdb &lt;program&gt;</code> \u542f\u52a8 gdb \u8c03\u8bd5 program\u3002</p> <p>type \"help\" from within GDB, or consult the GDB manual</p> <p>\u5728 gdb REPL \u4e2d\u8f93\u5165 <code>help</code> \u67e5\u770b gdb \u5e2e\u52a9\uff0c\u5217\u51fa\u547d\u4ee4\u5206\u7c7b\uff08List of classes of commands\uff09\u3002</p> <pre><code>(gdb) help\nList of classes of commands:\n\naliases -- User-defined aliases of other commands.\nbreakpoints -- Making program stop at certain points.\ndata -- Examining data.\nfiles -- Specifying and examining files.\ninternals -- Maintenance commands.\nobscure -- Obscure features.\nrunning -- Running the program.\nstack -- Examining the stack.\nstatus -- Status inquiries.\nsupport -- Support facilities.\ntext-user-interface -- TUI is the GDB text based interface.\ntracepoints -- Tracing of program execution without stopping the program.\nuser-defined -- User-defined commands.\n\nType \"help\" followed by a class name for a list of commands in that class.\nType \"help all\" for the list of all commands.\nType \"help\" followed by command name for full documentation.\nType \"apropos word\" to search for commands related to \"word\".\nType \"apropos -v word\" for full documentation of commands related to \"word\".\nCommand name abbreviations are allowed if unambiguous.\n</code></pre>","tags":["gdb"]},{"location":"blog/20200204/0-gdb-man-help/#help","title":"help &lt;command-class&gt;","text":"<p>Type \"help\" followed by a class name for a list of commands in that class.</p> <p>\u5728 gdb REPL \u4e2d\u8f93\u5165 <code>help &lt;comman-class&gt;</code> \u67e5\u770b\u5177\u4f53\u5206\u7c7b\u547d\u4ee4\u7684\u5e2e\u52a9\u3002</p> <p>\u4f8b\u5982\uff0c\u8f93\u5165 <code>help breakpoints</code> \u67e5\u770b\u8bbe\u7f6e\u65ad\u70b9\u76f8\u5173\u547d\u4ee4\u3002\u4ee5\u4e0b\u6458\u5f55\u65ad\u70b9\u76f8\u5173\u5e38\u7528\u547d\u4ee4\u3002</p> <pre><code>(gdb) help breakpoints\nMaking program stop at certain points.\n\nList of commands:\n\nbreak, brea, bre, br, b -- Set breakpoint at specified location.\nbreak-range -- Set a breakpoint for an address range.\n\nclear, cl -- Clear breakpoint at specified location.\ncommands -- Set commands to be executed when the given breakpoints are hit.\ncondition -- Specify breakpoint number N to break only if COND is true.\ndelete, del, d -- Delete all or some breakpoints.\n\ndelete breakpoints -- Delete all or some breakpoints or auto-display expressions.\n\ndelete display -- Cancel some expressions to be displayed when program stops.\n\ndisable, disa, dis -- Disable all or some breakpoints.\ndisable breakpoints -- Disable all or some breakpoints.\ndisable display -- Disable some expressions to be displayed when program stops.\n\nenable, en -- Enable all or some breakpoints.\nenable breakpoints -- Enable all or some breakpoints.\nenable breakpoints count -- Enable some breakpoints for COUNT hits.\nenable breakpoints delete -- Enable some breakpoints and delete when hit.\nenable breakpoints once -- Enable some breakpoints for one hit.\nenable count -- Enable some breakpoints for COUNT hits.\nenable delete -- Enable some breakpoints and delete when hit.\nenable display -- Enable some expressions to be displayed when program stops.\n\nrbreak -- Set a breakpoint for all functions matching REGEXP.\nrwatch -- Set a read watchpoint for EXPRESSION.\n\nskip -- Ignore a function while stepping.\nskip delete -- Delete skip entries.\nskip disable -- Disable skip entries.\nskip enable -- Enable skip entries.\nskip file -- Ignore a file while stepping.\nskip function -- Ignore a function while stepping.\nstrace -- Set a static tracepoint at location or marker.\ntbreak -- Set a temporary breakpoint.\n\ntrace, trac, tra, tr, tp -- Set a tracepoint at specified location.\nwatch -- Set a watchpoint for EXPRESSION.\n\n--Type &lt;RET&gt; for more, q to quit, c to continue without paging--\n</code></pre> <p>\u6309\u56de\u8f66\u952e\uff08<code>RET</code>\uff09\u7ffb\u9875\u67e5\u770b more\uff0c\u6309 <code>q</code> \u9000\u51fa\uff0c\u6309 <code>c</code> \u4e0d\u5206\u9875\u5c55\u5f00\u5269\u4e0b\u7684\u90e8\u5206\u3002</p>","tags":["gdb"]},{"location":"blog/20200204/0-gdb-man-help/#help_1","title":"help &lt;command-name&gt;","text":"<p>Type \"help\" followed by command name for full documentation.</p>","tags":["gdb"]},{"location":"blog/20200204/0-gdb-man-help/#help_break","title":"help break","text":"<p>\u8f93\u5165 <code>help break</code>\uff0c\u67e5\u770b\u5982\u4f55\u5728\u7279\u5b9a\u4f4d\u7f6e\u8bbe\u7f6e\u65ad\u70b9\uff08Set breakpoint at specified location.\uff09\u3002</p> <pre><code>(gdb) help break\nbreak, brea, bre, br, b\nSet breakpoint at specified location.\nbreak [PROBE_MODIFIER] [LOCATION] [thread THREADNUM]\n    [-force-condition] [if CONDITION]\nPROBE_MODIFIER shall be present if the command is to be placed in a\nprobe point.  Accepted values are `-probe' (for a generic, automatically\nguessed probe type), `-probe-stap' (for a SystemTap probe) or\n`-probe-dtrace' (for a DTrace probe).\nLOCATION may be a linespec, address, or explicit location as described\nbelow.\n\nWith no LOCATION, uses current execution address of the selected\nstack frame.  This is useful for breaking on return to a stack frame.\n\n...\n</code></pre> <p>\u7531\u5e2e\u52a9\u8bf4\u660e\u53ef\u77e5\uff0c\u8bbe\u7f6e\u65ad\u70b9\u6709\u4ee5\u4e0b\u51e0\u79cd\u5e38\u89c1\u65b9\u6cd5\uff1a</p> command description comment break \u4e0d\u5e26\u4efb\u4f55\u53c2\u6570\uff0c\u8868\u793a\u5728\u4e0b\u4e00\u6761\u6307\u4ee4\u5904\u505c\u4f4f\u3002 \u7f29\u7565\u5199\u6cd5 <code>b</code> break \\ \u5728\u8fdb\u5165\u6307\u5b9a\u51fd\u6570\u540e\u505c\u4f4f C++\u4e2d\u53ef\u4ee5\u4f7f\u7528 class::function \u6216 function(type,type) \u683c\u5f0f\u6765\u6307\u5b9a\u51fd\u6570\u540d\u3002 break \\ \u5728\u6307\u5b9a\u884c\u53f7\u505c\u4f4f\u3002 break +offset  break -offset \u5728\u5f53\u524d\u884c\u53f7\u7684\u524d/\u540e\u504f\u79fboffset\u884c\u5904\u505c\u4f4f offiset\u4e3a\u81ea\u7136\u6570 break filename:linenum \u5728\u6e90\u6587\u4ef6filename\u7684linenum\u884c\u5904\u505c\u4f4f\u3002 break filename:function \u5728\u6e90\u6587\u4ef6filename\u7684function\u51fd\u6570\u7684\u5165\u53e3\u5904\u505c\u4f4f\u3002 break *address \u5728\u7a0b\u5e8f\u8fd0\u884c\u7684\u5185\u5b58\u5730\u5740\u5904\u505c\u4f4f\u3002 *main + 4: fourth byte past main() break ... if \\ ...\u53ef\u4ee5\u662f\u4e0a\u8ff0\u7684\u53c2\u6570\u3002condition\u8868\u793a\u6761\u4ef6\uff0c\u5728\u6761\u4ef6\u6210\u7acb\u65f6\u505c\u4f4f\u3002 \u6bd4\u5982\u5728\u5faa\u73af\u5883\u4f53\u4e2d\uff0c\u53ef\u4ee5\u8bbe\u7f6e break if i=100\uff0c\u8868\u793a\u5f53i\u4e3a100\u65f6\u505c\u4f4f\u7a0b\u5e8f\u3002 <p>\u53ef\u4f7f\u7528info\u547d\u4ee4\uff0c\u67e5\u770b\u5df2\u7ecf\u914d\u7f6e\u7684\u65ad\u70b9\u4fe1\u606f\uff1a</p> <ul> <li>info breakpoints [n]</li> <li>info break [n]</li> <li>i b [n]</li> </ul> <p>\u6ce8\uff1an \u8868\u793a\u65ad\u70b9\u53f7\uff0c\u53ef\u9009\u3002\u6ca1\u6709\u6307\u5b9a\u65ad\u70b9\u53f7\uff0c\u5217\u51fa\u6240\u6709\u65ad\u70b9\uff1b\u5426\u5219\u53ea\u663e\u793a\u6307\u5b9a\u5e8f\u53f7\u7684\u65ad\u70b9\u4fe1\u606f\u3002</p>","tags":["gdb"]},{"location":"blog/20200204/0-gdb-man-help/#help_disable_breakpoints","title":"help disable breakpoints","text":"<p>\u8f93\u5165 <code>help disable</code> \u5217\u51fa\u4e86\u6240\u6709 disable \u76f8\u5173\u7684\u5b50\u547d\u4ee4\uff08List of disable subcommands\uff09\uff1a</p> <pre><code>(gdb) help disable\ndisable, disa, dis\nDisable all or some breakpoints.\nUsage: disable [BREAKPOINTNUM]...\nArguments are breakpoint numbers with spaces in between.\nTo disable all breakpoints, give no argument.\nA disabled breakpoint is not forgotten, but has no effect until re-enabled.\n\nList of disable subcommands:\n\ndisable breakpoints -- Disable all or some breakpoints.\ndisable display -- Disable some expressions to be displayed when program stops.\ndisable frame-filter -- GDB command to disable the specified frame-filter.\ndisable mem -- Disable memory region.\ndisable pretty-printer -- GDB command to disable the specified pretty-printer.\ndisable probes -- Disable probes.\ndisable type-printer -- GDB command to disable the specified type-printer.\ndisable unwinder -- GDB command to disable the specified unwinder.\ndisable xmethod -- GDB command to disable a specified (group of) xmethod(s).\n\nType \"help disable\" followed by disable subcommand name for full documentation.\nType \"apropos word\" to search for commands related to \"word\".\nType \"apropos -v word\" for full documentation of commands related to \"word\".\nCommand name abbreviations are allowed if unambiguous.\n</code></pre> <p>Type \"help disable\" followed by disable subcommand name for full documentation.</p> <p>\u8fdb\u4e00\u6b65\u8f93\u5165 <code>help disable breakpoints</code> \u67e5\u770b\u600e\u4e48\u7981\u7528\u65ad\u70b9\uff1a</p> <pre><code>(gdb) help disable breakpoints\nDisable all or some breakpoints.\nUsage: disable breakpoints [BREAKPOINTNUM]...\nArguments are breakpoint numbers with spaces in between.\nTo disable all breakpoints, give no argument.\nA disabled breakpoint is not forgotten, but has no effect until re-enabled.\nThis command may be abbreviated \"disable\".\n</code></pre> <p>\u7531\u5e2e\u52a9\u8bf4\u660e\u53ef\u77e5\uff0c<code>disable breakpoints</code> \u540e\u63a5\u65ad\u70b9\u53f7\uff08BREAKPOINTNUM\uff09\u5373\u53ef\u7981\u7528\u6307\u5b9a\u65ad\u70b9\u3002</p> <p>\u6267\u884c <code>i b</code> \u5217\u51fa\u6240\u6709\u65ad\u70b9\u4fe1\u606f\uff0c\u53ef\u67e5\u770b\u65ad\u70b9\u53f7\uff08Num\uff09\u548c\u65ad\u70b9\u542f\u7528\u72b6\u6001\uff08Enb\uff09\u3002</p>","tags":["gdb"]},{"location":"blog/20200204/0-gdb-man-help/#help_enable_breakpoints","title":"help enable breakpoints","text":"<p>\u8f93\u5165 <code>help enable</code> \u5217\u51fa\u4e86\u6240\u6709 enable \u76f8\u5173\u7684\u5b50\u547d\u4ee4\uff08List of enable subcommands\uff09\u3002</p> <p>Type \"help enable\" followed by enable subcommand name for full documentation.</p> <p>\u8fdb\u4e00\u6b65\u8f93\u5165 <code>help enable breakpoints</code> \u67e5\u770b\u600e\u4e48\u4f7f\u80fd\u65ad\u70b9\uff1a</p> <pre><code>(gdb) help enable breakpoints\nEnable all or some breakpoints.\nUsage: enable breakpoints [BREAKPOINTNUM]...\nGive breakpoint numbers (separated by spaces) as arguments.\nThis is used to cancel the effect of the \"disable\" command.\nMay be abbreviated to simply \"enable\".\n\nList of enable breakpoints subcommands:\n\nenable breakpoints count -- Enable some breakpoints for COUNT hits.\nenable breakpoints delete -- Enable some breakpoints and delete when hit.\nenable breakpoints once -- Enable some breakpoints for one hit.\n\nType \"help enable breakpoints\" followed by enable breakpoints subcommand name for full\ndocumentation.\nType \"apropos word\" to search for commands related to \"word\".\nType \"apropos -v word\" for full documentation of commands related to \"word\".\nCommand name abbreviations are allowed if unambiguous.\n</code></pre>","tags":["gdb"]},{"location":"blog/20200204/0-gdb-man-help/#apropos_word","title":"apropos word","text":"<p>\u5982\u679c\u60f3\u6a21\u7cca\u641c\u7d22\u67d0\u4e2a\u611f\u5174\u8da3\u7684\u8bdd\u9898\uff0c\u53ef\u4ee5\u501f\u52a9 <code>apropos</code> \u547d\u4ee4\u67e5\u627e\u5173\u952e\u5b57\u3002</p> <p>Type \"apropos word\" to search for commands related to \"word\".</p> <p><code>apropos compile</code>: \u67e5\u770b compile \u76f8\u5173\u7684\u8bdd\u9898\u3002 <code>apropos file</code>: \u67e5\u770b file \u76f8\u5173\u7684\u8bdd\u9898\u3002</p>","tags":["gdb"]},{"location":"blog/20200204/1-gdb-precondition/","title":"compiling for debugging with GDB","text":"<p>Compilation (Debugging with GDB)</p> <p>In order to debug a program effectively, you need to generate debugging information when you compile it. This debugging information is stored in the object file; it describes the data type of each variable or function and the correspondence between source line numbers and addresses in the executable code.</p> <p>To request debugging information, specify the <code>-g</code> option when you run the compiler.</p>","tags":["gcc","gdb"]},{"location":"blog/20200204/1-gdb-precondition/#produce_debugging_information","title":"Produce debugging information","text":"<p>Debugging Options (Using the GNU Compiler Collection (GCC))</p> <p>To tell GCC to emit extra information for use by a debugger, in almost all cases you need only to add <code>-g</code> to your other options.</p> <pre><code>    -g\n    Produce debugging information in the operating system\u2019s native format (stabs, COFF, XCOFF, or DWARF). GDB can work with this debugging information.\n\n    On most systems that use stabs format, -g enables use of extra debugging information that only GDB can use; this extra information makes debugging work better in GDB but probably makes other debuggers crash or refuse to read the program. If you want to control for certain whether to generate the extra information, use -gvms (see below).\n\n    -ggdb\n    Produce debugging information for use by GDB. This means to use the most expressive format available (DWARF, stabs, or the native format if neither of those are supported), including GDB extensions if at all possible.\n\n    -gdwarf\n    -gdwarf-version\n    Produce debugging information in DWARF format (if that is supported). The value of version may be either 2, 3, 4 or 5; the default version for most targets is 5 (with the exception of VxWorks, TPF and Darwin / macOS, which default to version 2, and AIX, which defaults to version 4).\n\n    Note that with DWARF Version 2, some ports require and always use some non-conflicting DWARF 3 extensions in the unwind tables.\n\n    Version 4 may require GDB 7.0 and -fvar-tracking-assignments for maximum benefit. Version 5 requires GDB 8.0 or higher.\n\n    GCC no longer supports DWARF Version 1, which is substantially different than Version 2 and later. For historical reasons, some other DWARF-related options such as -fno-dwarf2-cfi-asm) retain a reference to DWARF Version 2 in their names, but apply to all currently-supported versions of DWARF.\n</code></pre> <p>gcc \u7f16\u8bd1\u94fe\u63a5 C \u4ee3\u7801\uff0c\u6dfb\u52a0 <code>-g</code> \u9009\u9879\u751f\u6210\u8c03\u8bd5\u4fe1\u606f\uff0c\u624d\u80fd\u591f\u4f7f\u7528 GDB \u8fdb\u884c\u8c03\u8bd5\u3002</p> <pre><code>$ cc helloc.c -o helloc -g\n$ c++ hellocpp.cpp -o hellocpp -g\n</code></pre>","tags":["gcc","gdb"]},{"location":"blog/20200204/1-gdb-precondition/#display_debugging_information","title":"Display debugging information","text":"","tags":["gcc","gdb"]},{"location":"blog/20200204/1-gdb-precondition/#readelf_-w","title":"readelf -w","text":"<p><code>-w</code> / --debug-dump: Displays the contents of the DWARF debug sections in the file, if any are present.</p> <pre><code>           -w[lLiaprmfFsOoRtUuTgAckK]\n           --debug-dump[=rawline,=decodedline,=info,=abbrev,=pubnames,=aranges,=macro,=frames,=frames-interp,=str,=str-offsets,=loc,=Ranges,=pubtypes,=trace_info,=trace_abbrev,=trace_aranges,=gdb_index,=addr,=cu_index,=links,=follow-links]\n               Displays the contents of the DWARF debug sections in the\n               file, if any are present.\n               \"l\"\n               \"=rawline\"\n                   Displays the contents of the .debug_line section in a raw\n                   format.\n\n           \"l\"\n           \"=rawline\"\n               Displays the contents of the .debug_line section in a raw\n               format.\n\n           \"L\"\n           \"=decodedline\"\n               Displays the interpreted contents of the .debug_line\n               section.\n</code></pre> <p><code>-wl</code>\uff08--debug-dump=rawline\uff09\u6253\u5370 .debug_line section\u3002</p> <pre><code>pifan@rpi4b-ubuntu $ readelf -wl helloc\nRaw dump of debug contents of section .debug_line:\n\n  Offset:                      0x0\n  Length:                      78\n  DWARF Version:               5\n  Address size (bytes):        8\n  Segment selector (bytes):    0\n  Prologue Length:             42\n  Minimum Instruction Length:  4\n  Maximum Ops per Instruction: 1\n  Initial value of 'is_stmt':  1\n  Line Base:                   -5\n  Line Range:                  14\n  Opcode Base:                 13\n\n...\n</code></pre> <p>\u5176\u4ed6\u76f8\u5173\u9009\u9879\uff1a<code>--dwarf-depth</code>, <code>--dwarf-start</code></p> <pre><code>       --dwarf-depth=n\n           Limit the dump of the \".debug_info\" section to n children.\n           This is only useful with --debug-dump=info.  The default is\n           to print all DIEs; the special value 0 for n will also have\n           this effect.\n\n           With a non-zero value for n, DIEs at or deeper than n levels\n           will not be printed.  The range for n is zero-based.\n\n       --dwarf-start=n\n           Print only DIEs beginning with the DIE numbered n.  This is\n           only useful with --debug-dump=info.\n</code></pre>","tags":["gcc","gdb"]},{"location":"blog/20200204/1-gdb-precondition/#objdump","title":"objdump","text":"","tags":["gcc","gdb"]},{"location":"blog/20200204/1-gdb-precondition/#-g","title":"-g","text":"<pre><code>       -g\n       --debugging\n           Display debugging information.  This attempts to parse STABS\n           debugging format information stored in the file and print it\n           out using a C like syntax.  If no STABS debugging was found\n           this option falls back on the -W option to print any DWARF\n           information in the file.\n</code></pre>","tags":["gcc","gdb"]},{"location":"blog/20200204/1-gdb-precondition/#-w","title":"-W","text":"<p><code>objdump -W</code> \u540c <code>readelf -w</code>\u3002</p> <pre><code>       -W[lLiaprmfFsoORtUuTgAckK]\n       --dwarf[=rawline,=decodedline,=info,=abbrev,=pubnames,=aranges,=macro,=frames,=frames-interp,=str,=str-offsets,=loc,=Ranges,=pubtypes,=trace_info,=trace_abbrev,=trace_aranges,=gdb_index,=addr,=cu_index,=links,=follow-links]\n           Displays the contents of the DWARF debug sections in the\n           file, if any are present.\n\n           \"l\"\n           \"=rawline\"\n               Displays the contents of the .debug_line section in a raw\n               format.\n\n           \"L\"\n           \"=decodedline\"\n               Displays the interpreted contents of the .debug_line\n               section.\n</code></pre> <p><code>-Wl</code>\uff08--dwarf=rawline\uff09\u6253\u5370 .debug_line section\u3002</p> <pre><code>pifan@rpi4b-ubuntu $ objdump -Wl helloc\n\nhelloc:     file format elf64-littleaarch64\n\nRaw dump of debug contents of section .debug_line:\n\n  Offset:                      0x0\n  Length:                      78\n  DWARF Version:               5\n  Address size (bytes):        8\n  Segment selector (bytes):    0\n  Prologue Length:             42\n  Minimum Instruction Length:  4\n  Maximum Ops per Instruction: 1\n  Initial value of 'is_stmt':  1\n  Line Base:                   -5\n  Line Range:                  14\n  Opcode Base:                 13\n\n...\n</code></pre>","tags":["gcc","gdb"]},{"location":"blog/20200204/1-gdb-precondition/#misc","title":"misc","text":"<pre><code>       -G\n       --stabs\n           Display the full contents of any sections requested.  Display\n           the contents of the .stab and .stab.index and .stab.excl\n           sections from an ELF file.  This is only useful on systems\n           (such as Solaris 2.0) in which \".stab\" debugging symbol-table\n           entries are carried in an ELF section.  In most other file\n           formats, debugging symbol-table entries are interleaved with\n           linkage symbols, and are visible in the --syms output.\n</code></pre>","tags":["gcc","gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/","title":"GDB Invocation & Quitting","text":"<p>Invocation (Debugging with GDB)</p> <p>This article discusses how to start GDB, and how to get out of it.</p> <ul> <li>type <code>gdb</code> to start GDB.</li> <li>Use <code>file</code> to change and load debugging FILE.</li> <li>Use <code>info</code>/<code>list</code> to show info/src about the program.</li> <li>Use the <code>run</code> command to start your program under GDB.</li> <li>Use the <code>start</code> command to start debugging and to stop at main.</li> <li>type <code>quit</code>, <code>exit</code> or ctrl+d to exit GDB console.</li> </ul>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#invoking","title":"Invoking","text":"<p>Invoking GDB (Debugging with GDB)</p> helloc.chellocpp.cpp <pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) {\n    printf(\"Hello world from c!\\n\");\n\n    return 0;\n}\n</code></pre> <pre><code>#include &lt;iostream&gt;\n\nclass Hello {\npublic:\n    Hello() {\n        std::cout &lt;&lt; \"Hello()\" &lt;&lt; std::endl;\n    }\n\n    ~Hello() {\n        std::cout &lt;&lt; \"~Hello()\" &lt;&lt; std::endl;\n    }\n} h;\n\nint main(int argc, char *argv[]) {\n    printf(\"Hello world from cpp!\\n\");\n\n    return 0;\n}\n</code></pre> <p>gcc \u7f16\u8bd1\u94fe\u63a5 C/C++ \u4ee3\u7801\uff0c\u6dfb\u52a0 <code>-g</code> \u9009\u9879\u751f\u6210\u8c03\u8bd5\u4fe1\u606f\u3002 \u6267\u884c <code>objdump -f</code> \u67e5\u770b file header\uff0c\u6267\u884c <code>file</code> \u67e5\u770b file type info\u3002</p> cc -g helloc.cc++ -g helloc.c <pre><code>$ cc helloc.c -o helloc -g\n\n$ objdump -f helloc\n\nhelloc:     file format elf64-littleaarch64\narchitecture: aarch64, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x0000000000000640\n\n$ file helloc\nhelloc: ELF 64-bit LSB pie executable, ARM aarch64, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux-aarch64.so.1, BuildID[sha1]=62f7c3d231acd23080c08c38a3734b466c3e4f28, for GNU/Linux 3.7.0, with debug_info, not stripped\n</code></pre> <pre><code>$ c++ hellocpp.cpp -o hellocpp -g\n\n$ objdump -f hellocpp\n\nhellocpp:     file format elf64-littleaarch64\narchitecture: aarch64, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x00000000000009c0\n\n$ file hellocpp\nhellocpp: ELF 64-bit LSB pie executable, ARM aarch64, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux-aarch64.so.1, BuildID[sha1]=9bf3258ef5383b9fb42b6f6c017205d12c38b3cb, for GNU/Linux 3.7.0, with debug_info, not stripped\n</code></pre> <p>\u6267\u884c <code>gdb helloc</code> / <code>gdb hellocpp</code> \u542f\u52a8 gdb \u8c03\u8bd5 helloc/hellocpp\u3002</p>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#show","title":"show","text":"<p>show \u663e\u793a\u8c03\u8bd5\u5668\u672c\u8eab\u7684\u4e00\u4e9b\u8bbe\u7f6e/\u914d\u7f6e\u4fe1\u606f\uff0c\u548c set \u547d\u4ee4\u5bf9\u5e94\uff0c\u76f8\u5f53\u4e8e get\u3002 \u4ee5\u4e0b\u6458\u53d6\u4e86\u4e00\u4e9b\u770b\u8d77\u6765\u6bd4\u8f83\u6709\u7528\u7684\u5b50\u547d\u4ee4\uff0c\u5177\u4f53\u6709\u5f85\u540e\u7eed\u5b9e\u8df5\u6309\u9700\u53d6\u7528\u3002</p> <pre><code>(gdb) help show\nshow, info set\nGeneric command for showing things about the debugger.\n\nList of show subcommands:\n\nshow args -- Show argument list to give program being debugged when it is started.\nshow breakpoint -- Breakpoint specific settings.\nshow commands -- Show the history of commands you typed.\nshow convenience, show conv -- Debugger convenience (\"$foo\") variables and functions.\nshow cwd -- Show the current working directory that is used when the inferior is started.\nshow data-directory -- Show GDB's data directory.\nshow debug-file-directory -- Show the directories where separate debug symbols are searched for.\nshow directories -- Show the search path for finding source files.\nshow disassembler-options -- Show the disassembler options.\nshow endian -- Show endianness of target.\nshow environment -- The environment to give the program, or one variable's value.\nshow language -- Show the current source language.\nshow listsize -- Show number of source lines gdb will list by default.\nshow paths -- Current search path for finding object files.\nshow print, show pr, show p -- Generic command for showing print settings.\nshow source -- Generic command for showing source settings.\nshow step-mode -- Show mode of the step operation.\nshow substitute-path -- Show one or all substitution rules rewriting the source directories.\nshow tui -- TUI configuration variables.\n</code></pre> <p>\u4ee5\u4e0b\u8c03\u7528\u90e8\u5206 show subcommand \u786e\u8ba4\u8c03\u8bd5\u5668\u7684\u4e00\u4e9b\u914d\u7f6e\u4fe1\u606f\uff1a</p> <pre><code>(gdb) show language\nThe current source language is \"auto; currently c\".\n(gdb) show endian\nThe target endianness is set automatically (currently little endian).\n(gdb) show listsize\nNumber of source lines gdb will list by default is 10.\n(gdb) show step-mode\nMode of the step operation is off.\n</code></pre>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#file","title":"file","text":"<p>18 GDB Files | 18.1 Commands to Specify Files</p> <pre><code>(gdb) help file\nUse FILE as program to be debugged.\n</code></pre> <p>\u5982\u679c\u4e0d\u5e26\u53c2\u6570\u6267\u884c <code>gdb</code> \u542f\u52a8 REPL\uff0c\u672a\u6307\u5b9a executable file \u548c symbol file\u3002</p> <pre><code>(gdb) r\nStarting program:\nNo executable file specified.\nUse the \"file\" or \"exec-file\" command.\n\n(gdb) file\nNo executable file now.\nNo symbol file now.\n</code></pre> <p>\u53ef\u6267\u884c <code>file</code> \u6307\u5b9a\u8981\u8c03\u8bd5\u7684\u6587\u4ef6\uff1a</p> <pre><code>(gdb) file helloc\nReading symbols from helloc...\n</code></pre> <p>\u4e2d\u9014\u53ef\u4ee5\u4f7f\u7528\u8be5\u547d\u4ee4\u52a0\u8f7d\u5207\u6362\u65b0\u7684\u8c03\u8bd5\u76ee\u6807\u6587\u4ef6\uff08Load new symbol table\uff09\u3002</p> <p>\u5176\u4ed6\u53c2\u8003\uff1a17.7 Compiling and injecting code in GDB</p>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#attach_process","title":"attach process","text":"<p>You can, instead, specify a process ID as a second argument or use option <code>-p</code>, if you want to debug a running process:</p> <pre><code>gdb program 1234\n</code></pre> <p><code>gdb -p 1234</code> would attach GDB to process 1234. With option <code>-p</code> you can omit the program filename.</p> <p>Attach (Debugging with GDB)</p>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#info__list","title":"info &amp;&amp; list","text":"","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#info","title":"info","text":"<p>16 Examining the Symbol Table 18 GDB Files | 18.1 Commands to Specify Files</p> <p><code>show</code> \u547d\u4ee4\u7528\u4e8e\u663e\u793a\u8c03\u8bd5\u5668\u672c\u8eab\u7684\u4fe1\u606f\uff0c\u800c <code>info</code> \u547d\u4ee4\u5219\u53ef\u7528\u4e8e\u663e\u793a\u88ab\u8c03\u8bd5\u4efb\u52a1\u7684\u4fe1\u606f\u3002</p> <pre><code>(gdb) help info\ninfo, inf, i\nGeneric command for showing things about the program being debugged.\n\nList of info subcommands:\n\ninfo files -- Names of targets and files being debugged.\n\ninfo line -- Core addresses of the code for a source line.\n\ninfo proc -- Show additional information about a process.\ninfo program -- Execution status of the program.\n\ninfo source -- Information about the current source file.\ninfo sources -- All source files in the program or those matching REGEXP.\n</code></pre> <p>Execute <code>info program</code> to show the execution status.</p> <pre><code>(gdb) info program\nThe program being debugged is not being run.\n</code></pre>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#info_file","title":"info file","text":"<p>\u6267\u884c <code>info files</code> \u5217\u4e3e\u5f53\u524d\u5df2\u52a0\u8f7d\u7b26\u53f7\u7684\u8c03\u8bd5\u6587\u4ef6\uff1a</p> <pre><code>(gdb) help info files\nNames of targets and files being debugged.\nShows the entire stack of targets currently in use (including the exec-file,\ncore-file, and process, if any), as well as the symbol file name.\n\n(gdb) info files\nSymbols from \"/home/pifan/Projects/cpp/helloc\".\nLocal exec file:\n    `/home/pifan/Projects/cpp/helloc', file type elf64-littleaarch64.\n    Entry point: 0x640\n\n...\n</code></pre> <p>run/start \u8fd0\u884c\u8d77\u6765\u540e\uff0cEntry point \u4f1a\u53d8\u6210\u865a\u62df\u5730\u5740\uff08VMA\uff09\u3002</p>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#info_source","title":"info source","text":"<p>\u6267\u884c <code>info source</code> \u67e5\u770b\u6b63\u5728\u8c03\u8bd5\u7684\u6e90\u4ee3\u7801\u6587\u4ef6\u4fe1\u606f\uff1a</p> <pre><code>(gdb) info source\nCurrent source file is helloc.c\nCompilation directory is /home/pifan/Projects/cpp\nLocated in /home/pifan/Projects/cpp/helloc.c\nContains 7 lines.\nSource language is c.\nProducer is GNU C17 11.4.0 -mlittle-endian -mabi=lp64 -g -fasynchronous-unwind-tables -fstack-protector-strong -fstack-clash-protection.\nCompiled with DWARF 5 debugging format.\nDoes not include preprocessor macro info.\n\n(gdb) info sources\n/home/pifan/Projects/cpp/helloc:\n\n/home/pifan/Projects/cpp/helloc.c\n</code></pre> <p>run/start \u8fd0\u884c\u8d77\u6765\u540e\uff0cinfo sources \u5217\u8868\u4f1a\u591a\u51fa\u5f88\u591a\u8fd0\u884c\u65f6\u4f9d\u8d56\u6587\u4ef6\u548c libc.so.6\u3002</p>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#list","title":"list","text":"<p>Source (Debugging with GDB)</p> <p>\u6267\u884c <code>list</code> / <code>l</code> \u547d\u4ee4\u6253\u5370\u7a0b\u5e8f\u7684\u6e90\u4ee3\u7801\uff08List specified function or line\uff09\uff0c\u53ef\u6307\u5b9a\u51fd\u6570\u540d\u6216\u884c\u53f7\u3002</p> <pre><code>(gdb) help list\nlist, l\nList specified function or line.\nWith no argument, lists ten more lines after or around previous listing.\n\"list -\" lists the ten lines before a previous ten-line listing.\nOne argument specifies a line, and ten lines are listed around that line.\nTwo arguments with comma between specify starting and ending lines to list.\nLines can be specified in these ways:\n  LINENUM, to list around that line in current file,\n  FILE:LINENUM, to list around that line in that file,\n  FUNCTION, to list around beginning of that function,\n  FILE:FUNCTION, to distinguish among like-named static functions.\n  *ADDRESS, to list around the line containing that address.\nWith two args, if one is empty, it stands for ten lines away from\nthe other arg.\n\nBy default, when a single location is given, display ten lines.\nThis can be changed using \"set listsize\", and the current value\ncan be shown using \"show listsize\".\n</code></pre> <p><code>list 0</code> \u4ece\u7b2c 1 \u884c\u5f00\u59cb\u663e\u793a\u6e90\u7a0b\u5e8f\u3002 <code>list +</code> \u663e\u793a\u5f53\u524d\u65ad\u70b9\u884c\u540e\u9762\u7684\u6e90\u7a0b\u5e8f\u3002 <code>list -</code> \u663e\u793a\u5f53\u524d\u65ad\u70b9\u884c\u524d\u9762\u7684\u6e90\u7a0b\u5e8f\u3002</p> <ul> <li>\u6bcf\u6b21\u663e\u793a 10 \u884c\uff08\u7531 listsize \u63a7\u5236\uff09\u3002</li> </ul> <pre><code># \u7f3a\u7701\u4e3a list +\n(gdb) list\n1   #include &lt;stdio.h&gt;\n2   \n3   int main(int argc, char *argv[]) {\n4       printf(\"Hello world from c!\\n\");\n5   \n6       return 0;\n7   }\n</code></pre> <p>\u6309\u56de\u8f66\u952e\u91cd\u590d\u4e0a\u4e00\u6b21\u7684\u547d\u4ee4\uff0c\u5373\u7ee7\u7eed list \u663e\u793a\u4e0b\u4e00\u4e2a 10 \u884c\u3002</p> <p>\u5f53\u663e\u793a\u5230\u6587\u4ef6\u6700\u540e\u4e00\u884c\uff08EOF\uff09\uff0c\u4f1a\u63d0\u793a out of range\uff1a</p> <pre><code>(gdb)\nLine number 8 out of range; helloc.c has 7 lines.\n</code></pre> <p>\u6b64\u65f6\u53ef\u6267\u884c <code>l 0</code> \u4ece\u5934\u5f00\u59cb\u663e\u793a\u3002</p> <p><code>list &lt;linenum&gt;</code>\uff1a\u663e\u793a\u7a0b\u5e8f\u7b2clinenum\u884c\u4e0a\u4e0b\u5404 5 \u884c\u6e90\u7a0b\u5e8f\u3002 <code>list &lt;function&gt;</code>\uff1a\u663e\u793a\u6307\u5b9a\u540d\u79f0\u51fd\u6570\u7684\u6e90\u7a0b\u5e8f\u3002</p>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#run__start","title":"run / start","text":"<p>4 Running Programs Under GDB | 4.2 Starting your Program</p>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#run","title":"run","text":"<p><code>run</code> / <code>r</code>: Use the <code>run</code> command to start your program under GDB. You must first specify the program name with an argument to GDB (see Getting In and Out of GDB), or by using the file or exec-file command (see Commands to Specify Files).</p> <pre><code>(gdb) help run\nrun, r\nStart debugged program.\nYou may specify arguments to give it.\nArgs may include \"*\", or \"[...]\"; they are expanded using the\nshell that will start the program (specified by the \"$SHELL\" environment\nvariable).  Input and output redirection with \"&gt;\", \"&lt;\", or \"&gt;&gt;\"\nare also allowed.\n\nWith no arguments, uses arguments last specified (with \"run\" or\n\"set args\").  To cancel previous arguments and run with no arguments,\nuse \"set args\" without arguments.\n\nTo start the inferior without using a shell, use \"set startup-with-shell off\".\n</code></pre> <p>\u6267\u884c <code>gdb helloc</code> \u542f\u52a8 gdb \u8c03\u8bd5 gcc \u7f16\u8bd1\u597d\u7684 helloc\u3002 \u6216\u4e2d\u9014\u6267\u884c <code>file</code> \u547d\u4ee4\u52a0\u8f7d\u5207\u6362\u65b0\u7684\u8c03\u8bd5\u76ee\u6807\u540e\uff0c\u5373\u53ef\u6267\u884c <code>run</code> \u547d\u4ee4\u542f\u52a8\u8fd0\u884c\u3002 \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5219\u9ed8\u8ba4\u6267\u884c\u5b8c\u6574\u4e2a\u7a0b\u5e8f\u3002</p> <pre><code>(gdb) r\nStarting program: /home/pifan/Projects/cpp/helloc\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/aarch64-linux-gnu/libthread_db.so.1\".\nHello world from c!\n[Inferior 1 (process 145910) exited normally]\n</code></pre> <p>When you issue the\u00a0<code>run</code>\u00a0command, your program begins to execute immediately. See\u00a0Stopping and Continuing, for discussion of how to arrange for your program to stop. Once your program has stopped, you may call functions in your program, using the\u00a0<code>print</code>\u00a0or\u00a0<code>call</code>\u00a0commands. See\u00a0Examining Data.</p>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#start","title":"start","text":"<p><code>start</code>: The debugger provides a convenient way to start the execution of the program and to stop at the beginning of the <code>main</code> procedure, depending on the language used.</p> <p>The \u2018start\u2019 command does the equivalent of setting a temporary breakpoint at the beginning of the main procedure and then invoking the \u2018run\u2019 command.</p> <p><code>starti</code>: The \u2018starti\u2019 command does the equivalent of setting a temporary breakpoint at the first instruction of a program\u2019s execution and then invoking the \u2018run\u2019 command. For programs containing an elaboration phase, the starti command will stop execution at the start of the elaboration phase.</p> <pre><code>(gdb) help start\nStart the debugged program stopping at the beginning of the main procedure.\nYou may specify arguments to give it.\nArgs may include \"*\", or \"[...]\"; they are expanded using the\nshell that will start the program (specified by the \"$SHELL\" environment\nvariable).  Input and output redirection with \"&gt;\", \"&lt;\", or \"&gt;&gt;\"\nare also allowed.\n\nWith no arguments, uses arguments last specified (with \"run\" or\n\"set args\").  To cancel previous arguments and run with no arguments,\nuse \"set args\" without arguments.\n\nTo start the inferior without using a shell, use \"set startup-with-shell off\".\n</code></pre> <p>\u6267\u884c <code>gdb helloc</code> \u542f\u52a8 gdb \u8fdb\u5165\u8c03\u8bd5 REPL \u540e\uff0c\u8f93\u5165 start \u5c06\u542f\u52a8\u8fd0\u884c\uff0c\u5728\u5165\u53e3\u51fd\u6570 main \u5904\u7684\u4e34\u65f6\u65ad\u70b9\uff08tbreak\uff09\u505c\u4e0b\uff0c\u76f8\u5f53\u4e8e tb main + run\u3002</p> <pre><code>(gdb) start\nTemporary breakpoint 1 at 0x764: file helloc.c, line 4.\nStarting program: /home/pifan/Projects/cpp/helloc\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/aarch64-linux-gnu/libthread_db.so.1\".\n\nTemporary breakpoint 1, main (argc=1, argv=0xfffffffff248) at helloc.c:4\n4       printf(\"Hello world from c!\\n\");\n</code></pre> <p>Execute <code>info program</code> to check the execution status.</p> <pre><code>(gdb) info program\n    Using the running image of child Thread 0xfffff7ff7e60 (LWP 203218).\nProgram stopped at 0xaaaaaaaa0764.\nIt stopped at a breakpoint that has since been deleted.\nType \"info stack\" or \"info registers\" for more information.\n</code></pre>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#restart","title":"restart","text":"<p>\u8c03\u8bd5\u8fc7\u7a0b\u4e2d\uff0c\u968f\u65f6\u53ef\u4ee5\u8f93\u5165 <code>run</code> \u6216 <code>start</code> \u4ece\u5934\u5f00\u59cb\u6267\u884c\u3002</p> <pre><code>(gdb) r\nThe program being debugged has been started already.\nStart it from the beginning? (y or n)\n\n(gdb) start\nThe program being debugged has been started already.\nStart it from the beginning? (y or n)\n</code></pre>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#info_proc","title":"info proc","text":"<p>Process Information (Debugging with GDB)</p> <p>\u6267\u884c <code>info proc</code> \u547d\u4ee4\u53ef\u67e5\u770b\u8fdb\u7a0b\u4fe1\u606f\uff1a</p> <pre><code>(gdb) help info proc\nShow additional information about a process.\n\n(gdb) i proc\nprocess 147173\ncmdline = '/home/pifan/Projects/cpp/helloc'\ncwd = '/home/pifan/Projects/cpp'\nexe = '/home/pifan/Projects/cpp/helloc'\n</code></pre> <p>\u6b64\u65f6\uff0c\u5728\u53e6\u5916\u4e00\u4e2a\u7ec8\u7aef\u7a97\u53e3\u952e\u5165 <code>cat /proc/147173/maps</code> \u53ef\u4ee5\u67e5\u770b\u7cfb\u7edf\u7ed9\u8fdb\u7a0b\uff08PID \u4e3a147173\uff09\u5206\u914d\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u3002</p> <p>\u6267\u884c <code>info share</code> \u547d\u4ee4\u53ef\u67e5\u770b\u52a0\u8f7d\u7684\u52a8\u6001\u5e93\u4fe1\u606f\uff1a</p> <pre><code>(gdb) help info sharedlibrary\ninfo sharedlibrary, info dll\nStatus of loaded shared object libraries.\n\n(gdb) i share\nFrom                To                  Syms Read   Shared Object Library\n0x0000fffff7fc3c40  0x0000fffff7fe20a4  Yes         /lib/ld-linux-aarch64.so.1\n0x0000fffff7e37040  0x0000fffff7f43090  Yes         /lib/aarch64-linux-gnu/libc.so.6\n</code></pre>","tags":["gdb"]},{"location":"blog/20200205/2-gdb-in-and-out/#quitting","title":"Quitting","text":"<p>Quitting GDB (Debugging with GDB)</p> <ul> <li>quit [expression]</li> <li>exit [expression]</li> <li>q</li> </ul> <p>To exit GDB, use the quit command (abbreviated <code>q</code>), the <code>exit</code> command, or type an end-of-file character (usually <code>Ctrl-d</code>). If you do not supply expression, GDB will terminate normally; otherwise it will terminate using the result of expression as the error code.</p> <p>An interrupt (often <code>Ctrl-c</code>) does not exit from GDB, but rather terminates the action of any GDB command that is in progress and returns to GDB command level.</p>","tags":["gdb"]},{"location":"blog/20200206/3-gdb-stop-and-continue/","title":"GDB Stop & Continue","text":"<p>5 Stopping and Continuing</p> <p>\u5728\u8c03\u8bd5\u7a0b\u5e8f\u65f6\uff0c\u4e2d\u65ad\u7a0b\u5e8f\u7684\u8fd0\u884c\u662f\u5fc5\u987b\u7684\u3002GDB \u53ef\u4ee5\u65b9\u4fbf\u5730\u6682\u505c/\u7ee7\u7eed\u7a0b\u5e8f\u7684\u8fd0\u884c\u3002</p> <p>\u901a\u8fc7\u8bbe\u7f6e\u65ad\u70b9\uff0c\u53ef\u4ee5\u51b3\u5b9a\u7a0b\u5e8f\u5728\u54ea\u884c\uff0c\u5728\u4ec0\u4e48\u6761\u4ef6\u4e0b\uff0c\u6216\u8005\u5728\u6536\u5230\u4ec0\u4e48\u4fe1\u53f7\u65f6\u6682\u505c\uff0c\u4ee5\u4fbf\u67e5\u9a8c\u7a0b\u5e8f\u8fd0\u884c\u7684\u6d41\u7a0b\u548c\u72b6\u6001\u3002</p> <p>\u7a0b\u5e8f\u6682\u505c\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u76f8\u5173\u547d\u4ee4\u63a7\u5236\u7a0b\u5e8f\u7ee7\u7eed\u8fd0\u884c\u5230\u4e0b\u4e00\u4e2a\u9884\u8bbe\u7684\u4e2d\u65ad\u70b9\uff0c\u5728\u8fd9\u79cd\u201c\u6682\u505c-\u7ee7\u7eed\u201d\u5f80\u590d\u4e2d\u8c03\u8bd5\u9a8c\u8bc1\u7a0b\u5e8f\u8bbe\u8ba1\u7684\u6b63\u786e\u6027\u3002</p>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#compile_test_program_for_debugging","title":"compile test program for debugging","text":"test-gdb.c <pre><code>#include &lt;stdio.h&gt;\n\nint func(int n)\n{\n    int sum=0,i;\n    for(i=0; i&lt;n; i++)\n    {\n        sum+=i;\n    }\n    return sum;\n}\n\nint main(int argc, char* argv[])\n{\n    int i;\n    long result = 0;\n    for(i=1; i&lt;=100; i++)\n    {\n        result += i;\n    }\n\n    printf(\"result[1-100] = %ld\\n\", result );\n    printf(\"result[1-250] = %d\\n\", func(250) );\n\n    return 0;\n}\n</code></pre> <p>gcc \u7f16\u8bd1\u547d\u4ee4\uff1a<code>cc test-gdb.c -o test-gdb -g</code></p> test-gdb file format<pre><code>$ objdump -f test-gdb\n\ntest-gdb:     file format elf64-littleaarch64\narchitecture: aarch64, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x0000000000000640\n\n$ file test-gdb\ntest-gdb: ELF 64-bit LSB pie executable, ARM aarch64, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux-aarch64.so.1, BuildID[sha1]=65f667a433bbb8c27eeb9bab8db76816d07292dd, for GNU/Linux 3.7.0, with debug_info, not stripped\n</code></pre> <p>\u542f\u52a8 gdb \u8c03\u8bd5\uff1a<code>gdb test-gdb</code></p> <p>\u5728 gdb \u4e2d\u8f93\u5165 <code>list</code> \u67e5\u770b\u6e90\u4ee3\u7801\uff0c\u786e\u8ba4\u884c\u53f7\u4ee5\u4fbf\u4e0b\u65ad\u70b9\u3002</p> <pre><code>(gdb) l 0\n1   #include &lt;stdio.h&gt;\n2   \n3   int func(int n)\n4   {\n5       int sum=0,i;\n6       for(i=0; i&lt;n; i++)\n7       {\n8           sum+=i;\n9       }\n10      return sum;\n(gdb)\n11  }\n12  \n13  int main(int argc, char* argv[])\n14  {\n15      int i;\n16      long result = 0;\n17      for(i=1; i&lt;=100; i++)\n18      {\n19          result += i;\n20      }\n(gdb)\n21  \n22      printf(\"result[1-100] = %ld\\n\", result );\n23      printf(\"result[1-250] = %d\\n\", func(250) );\n24  \n25      return 0;\n26  }\n(gdb)\nLine number 27 out of range; test-gdb.c has 26 lines.\n</code></pre>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#breakpoints_watchpoints_and_catchpoints","title":"Breakpoints, Watchpoints, and Catchpoints","text":"<p>5.1 Breakpoints, Watchpoints, and Catchpoints</p>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#breakpoints","title":"breakpoints","text":"<p>5.1.1 Setting Breakpoints 5.1.6 Break Conditions</p> <p>\u8f93\u5165 <code>help breakpoints</code> \u67e5\u770b\u8bbe\u7f6e\u65ad\u70b9\u76f8\u5173\u547d\u4ee4\u3002\u4ee5\u4e0b\u6458\u5f55\u65ad\u70b9\u76f8\u5173\u5e38\u7528\u547d\u4ee4\u3002</p> <p>\u8f93\u5165 <code>help break</code>\uff0c\u67e5\u770b\u5982\u4f55\u5728\u7279\u5b9a\u4f4d\u7f6e\u8bbe\u7f6e\u65ad\u70b9\uff08Set breakpoint at specified location.\uff09\u3002</p> <p><code>break</code> : b \u4e0d\u5e26\u4efb\u4f55\u53c2\u6570\uff0c\u8868\u793a\u5728\u4e0b\u4e00\u6761\u6307\u4ee4\u5904\u505c\u4f4f\u3002</p> <p>When called without any arguments,\u00a0<code>break</code>\u00a0sets a breakpoint at the next instruction to be executed in the selected stack frame (see\u00a0Examining the Stack).</p> <p><code>break\u00a0locspec</code> : \u5728\u6307\u5b9a\u4f4d\u7f6e\u8bbe\u7f6e\u65ad\u70b9\u3002</p> <p>Set a breakpoint at all the code locations in your program that result from resolving the given\u00a0locspec.\u00a0locspec\u00a0can specify a function name, a line number, an address of an instruction, and more. See\u00a0Location Specifications, for the various forms of\u00a0locspec.\u00a0</p> command description comment break &lt;function&gt; \u5728\u8fdb\u5165\u6307\u5b9a\u51fd\u6570\u540e\u505c\u4f4f C++\u4e2d\u53ef\u4ee5\u4f7f\u7528 class::function \u6216 function(type,type) \u683c\u5f0f\u6765\u6307\u5b9a\u51fd\u6570\u540d\u3002 break &lt;linenum&gt; \u5728\u6307\u5b9a\u884c\u53f7\u505c\u4f4f\u3002 break +offset  break -offset \u5728\u5f53\u524d\u884c\u53f7\u7684\u524d/\u540e\u504f\u79fboffset\u884c\u5904\u505c\u4f4f offiset\u4e3a\u81ea\u7136\u6570 break filename:linenum \u5728\u6e90\u6587\u4ef6filename\u7684linenum\u884c\u5904\u505c\u4f4f\u3002 break filename:function \u5728\u6e90\u6587\u4ef6filename\u7684function\u51fd\u6570\u7684\u5165\u53e3\u5904\u505c\u4f4f\u3002 break *address \u5728\u7a0b\u5e8f\u8fd0\u884c\u7684\u5185\u5b58\u5730\u5740\u5904\u505c\u4f4f\u3002 *main + 4: fourth byte past main() break \u2026 if cond ...\u53ef\u4ee5\u662f\u4e0a\u8ff0\u7684\u53c2\u6570\u3002condition\u8868\u793a\u6761\u4ef6\uff0c\u5728\u6761\u4ef6\u6210\u7acb\u65f6\u505c\u4f4f\u3002 \u6bd4\u5982\u5728\u5faa\u73af\u5883\u4f53\u4e2d\uff0c\u53ef\u4ee5\u8bbe\u7f6e break if i==100\uff0c\u8868\u793a\u5f53i\u4e3a100\u65f6\u505c\u4f4f\u7a0b\u5e8f\u3002 <p>\u4e34\u65f6\u65ad\u70b9\uff08temp break\uff09\uff1a\u53ea\u547d\u4e2d\u4e00\u6b21\u3002</p> <ul> <li><code>tbreak args</code>: Set a breakpoint enabled only for one stop. The args are the same as for the break command.</li> </ul> <p>\u6b63\u5219\u65ad\u70b9\uff08regex break\uff09\uff1a\u6b63\u5219\u5339\u914d\u65ad\u70b9\u3002</p> <ul> <li><code>rbreak regex</code>: Set breakpoints on all functions matching the regular expression regex.</li> <li><code>rbreak file:regex</code>: If rbreak is called with a filename qualification, it limits the search for functions matching the given regular expression to the specified file.</li> </ul> <p>\u5728 main \u51fd\u6570\u3001\u7b2c 22 \u884c\u3001func \u51fd\u6570\u4ee5\u53ca\u7b2c 8 \u884c\u4e0b\u65ad\u70b9\uff0c\u5176\u4e2d\u7b2c 8 \u884c\u4e3a\u6761\u4ef6\u65ad\u70b9\u3002</p> <pre><code>(gdb) b main\nBreakpoint 1 at 0x7b0: file test-gdb.c, line 16.\n(gdb) b 22\nBreakpoint 2 at 0x7e8: file test-gdb.c, line 22.\n(gdb) b func\nBreakpoint 3 at 0x75c: file test-gdb.c, line 5.\n(gdb) b 8 if i==50\nBreakpoint 4 at 0x768: file test-gdb.c, line 8.\n</code></pre> <p>\u53ef\u4f7f\u7528 info \u547d\u4ee4\uff0c\u67e5\u770b\u5df2\u7ecf\u914d\u7f6e\u7684\u65ad\u70b9\u4fe1\u606f\uff1a</p> <ul> <li>info breakpoints [list\u2026]</li> <li>info break [list\u2026]</li> </ul> <p>Print a table of all breakpoints, watchpoints, tracepoints, and catchpoints set and not deleted. Optional argument <code>n</code> means print information only about the specified breakpoint(s) (or watchpoint(s) or tracepoint(s) or catchpoint(s)).</p> <p>\u4e0d\u6307\u5b9a\u65ad\u70b9\u53f7\u65f6\uff0c\u5217\u51fa\u6240\u6709\u65ad\u70b9\uff1b\u5426\u5219\u53ea\u663e\u793a\u6307\u5b9a\u5e8f\u53f7\u7684\u65ad\u70b9\u4fe1\u606f\uff0c\u591a\u4e2a\u65ad\u70b9\u53f7\u4e4b\u95f4\u4ee5\u7a7a\u683c\u5206\u5f00\u3002</p> <p>\u6267\u884c <code>i b</code> \u67e5\u770b\u6240\u6709\u65ad\u70b9\uff1a</p> <pre><code>(gdb) i b\nNum     Type           Disp Enb Address            What\n1       breakpoint     keep y   0x00000000000007b0 in main at test-gdb.c:16\n2       breakpoint     keep y   0x00000000000007e8 in main at test-gdb.c:22\n3       breakpoint     keep y   0x000000000000075c in func at test-gdb.c:5\n4       breakpoint     keep y   0x0000000000000768 in func at test-gdb.c:8\n    stop only if i==50\n</code></pre> <p>\u6267\u884c <code>i b 1 3</code> \u67e5\u770b 1 \u53f7\u548c 3 \u53f7\u65ad\u70b9\uff1a</p> <pre><code>(gdb) i b 1 3\nNum     Type           Disp Enb Address            What\n1       breakpoint     keep y   0x00000000000007b0 in main at test-gdb.c:16\n3       breakpoint     keep y   0x000000000000075c in func at test-gdb.c:5\n</code></pre> <p>\u8bbe\u7f6e\u597d\u65ad\u70b9\u540e\uff0c\u6267\u884c <code>run</code> \u542f\u52a8\u8fd0\u884c\u8c03\u8bd5\uff0c\u6d4b\u8bd5\u65ad\u70b9\u7684\u547d\u4e2d\u60c5\u51b5\u3002</p> <p>\u9996\u5148\u547d\u4e2d 1 \u53f7\u65ad\u70b9\uff0c\u5728 main \u51fd\u6570\u7684\u7b2c\u4e00\u6761\u8bed\u53e5/\u6307\u4ee4\u505c\u4e0b\u3002</p> <p>\u6ce8\u610f\uff1aint i \u4e3a\u6682\u65f6\u5b9a\u4e49\uff08tentative definition\uff09\uff0c\u5b9e\u4e3a\u58f0\u660e\uff0c\u65e0\u6307\u4ee4\u3002</p> <pre><code>(gdb) r\nStarting program: /home/pifan/Projects/cpp/test-gdb\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/aarch64-linux-gnu/libthread_db.so.1\".\n\nBreakpoint 1, main (argc=1, argv=0xfffffffff248) at test-gdb.c:16\n16      long result = 0;\n</code></pre>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#watchpoints","title":"watchpoints","text":"<p>5.1.2 Setting Watchpoints</p> <p>\u89c2\u5bdf\u70b9\u4e00\u822c\u6765\u89c2\u5bdf\u67d0\u4e2a\u8868\u8fbe\u5f0f\uff08\u53d8\u91cf\u4e5f\u662f\u4e00\u79cd\u8868\u8fbe\u5f0f\uff09\u7684\u503c\u662f\u5426\u6709\u53d8\u5316\u4e86\uff0c\u5982\u679c\u6709\u53d8 \u5316\uff0c\u9a6c\u4e0a\u505c\u4f4f\u7a0b\u5e8f\u3002\u6211\u4eec\u6709\u4e0b\u9762\u7684\u51e0\u79cd\u65b9\u6cd5\u6765\u8bbe\u7f6e\u89c2\u5bdf\u70b9\uff1a</p> <p><code>watch &lt;expr&gt;</code> \u4e3a\u8868\u8fbe\u5f0f\uff08\u53d8\u91cf\uff09expr\u8bbe\u7f6e\u4e00\u4e2a\u89c2\u5bdf\u70b9\u3002\u4e00\u65e6\u8868\u8fbe\u5f0f\u503c\u6709\u53d8\u5316\uff0c\u9a6c\u4e0a\u505c\u4f4f\u7a0b\u5e8f\u3002</p> <p>watch [-l|-location] expr [thread thread-id] [mask maskvalue] [task task-id] : Set a watchpoint for an expression. GDB will break when the expression expr is written into by the program and its value changes.</p> <p><code>rwatch &lt;expr&gt;</code> \u5f53\u8868\u8fbe\u5f0f\uff08\u53d8\u91cf\uff09expr\u88ab\u8bfb\u65f6\uff0c\u505c\u4f4f\u7a0b\u5e8f\u3002</p> <p>rwatch [-l|-location] expr [thread thread-id] [mask maskvalue] : Set a watchpoint that will break when the value of expr is read by the program.</p> <p><code>awatch &lt;expr&gt;</code> \u5f53\u8868\u8fbe\u5f0f\uff08\u53d8\u91cf\uff09\u7684\u503c\u88ab\u8bfb\u6216\u88ab\u5199\u65f6\uff0c\u505c\u4f4f\u7a0b\u5e8f\u3002</p> <p>awatch [-l|-location] expr [thread thread-id] [mask maskvalue] : Set a watchpoint that will break when expr is either read from or written into by the program.</p> <p><code>info watchpoints</code> \u5217\u51fa\u5f53\u524d\u6240\u8bbe\u7f6e\u4e86\u7684\u6240\u6709\u89c2\u5bdf\u70b9\u3002</p> <p>info watchpoints [list\u2026] : This command prints a list of watchpoints, using the same format as info break (see Set Breaks).</p>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#continuing_and_stepping","title":"Continuing and Stepping","text":"<p>5.2 Continuing and Stepping</p>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#next","title":"next","text":"<p><code>next [count]</code>: Continue to the next source line in the current (innermost) stack frame. This is similar to step, but function calls that appear within the line of code are executed without stopping.</p> <p>\u5728 1 \u53f7\u65ad\u70b9 main \u51fd\u6570\u5904\u505c\u4e0b\u540e\uff0c\u8f93\u5165 <code>n</code>\uff08next\uff09\u6267\u884c\u4e0b\u4e00\u6761\u8bed\u53e5\uff1a</p> <pre><code>(gdb) n\n17      for(i=1; i&lt;=100; i++)\n</code></pre> <p>\u4e0d\u65ad\u8f93\u5165 <code>n</code>\uff0c\u5728 for \u63a7\u5236\u8bed\u53e5\u548c\u5faa\u73af\u4f53\u8bed\u53e5\u4e4b\u95f4\u5faa\u73af\uff0c\u76f4\u5230\u5faa\u73af\u7ed3\u675f\uff08i=101\uff09\u3002</p> <pre><code>(gdb) n\n19          result += i;\n(gdb) n\n17      for(i=1; i&lt;=100; i++)\n</code></pre> <p>\u6267\u884c\u5b8c\u4e00\u6b21\u5faa\u73af\uff08i=1\uff09\uff0c\u5373\u5c06\u8fdb\u884c\u7b2c\u4e8c\u6b21\u5faa\u73af\u3002\u6b64\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>print</code> \u547d\u4ee4\u67e5\u770b\u5faa\u73af\u53d8\u91cf i \u7684\u503c\u3002</p> <p>10 Examining Data: The usual way to examine data in your program is with the <code>print</code> command (abbreviated <code>p</code>), or its synonym <code>inspect</code>. It evaluates and prints the value of an expression of the language your program is written.</p> <pre><code>(gdb) p i\n$6 = 1\n</code></pre> <p>\u6267\u884c <code>n 6</code>\uff0c\u8fdb\u884c\u4e09\u8f6e\u5faa\u73af\u540e\uff0ci=4\u3002</p> <pre><code>(gdb) n 6\n17      for(i=1; i&lt;=100; i++)\n(gdb) p i\n$7 = 4\n</code></pre> <p><code>next</code> \u547d\u4ee4\u662f\u9010\u884c\u6e90\u7801\uff08source line\uff09\u6267\u884c\uff0c\u5177\u4f53\u6765\u8bf4\u6bcf\u6b21\u90fd\u505c\u7559\u5728 C \u8bed\u53e5\u5bf9\u5e94\u7684\u7b2c\u4e00\u6761\u673a\u5668\u6307\u4ee4\u5904\u3002</p> <p>The next command only stops at the first instruction of a source line.</p> <p>\u5982\u679c\u60f3\u9010\u6761\u8c03\u8bd5\u6bcf\u53e5 C \u4ee3\u7801\u80cc\u540e\u7684\u673a\u5668\u6307\u4ee4\u5e8f\u5217\uff0c\u5219\u9700\u8981\u4f7f\u7528 <code>nexti</code> \u6307\u4ee4\u3002</p> <p><code>nexti</code> / <code>nexti arg</code>: Execute one machine instruction, but if it is a function call, proceed until the function returns.</p> <p>\u5728\u6267\u884c nexti \u4e4b\u524d\uff0c\u5148\u6267\u884c <code>disassemble</code> \u547d\u4ee4\u53cd\u6c47\u7f16 C \u4ee3\u7801\uff08\u51fd\u6570\uff09\uff0c\u770b\u770b\u4e00\u884c C \u6e90\u7801\u80cc\u540e\u5bf9\u5e94\u7684\u673a\u5668\u6307\u4ee4\u3002</p> <pre><code>(gdb) help disassemble\nDisassemble a specified section of memory.\nUsage: disassemble[/m|/r|/s] START [, END]\n</code></pre> <p>\u6267\u884c <code>disas /m main</code> \u53cd\u6c47\u7f16 main \u51fd\u6570\uff0c\u53ef\u4ee5\u770b\u5230\u5faa\u73af\u63a7\u5236\u6761\u4ef6\u8bed\u53e5\u5728 AARCH64 \u4e0a\u5bf9\u5e94 9 \u6761\u673a\u5668\u6307\u4ee4\uff0c\u5faa\u73af\u4f53\u8bed\u53e5 <code>result += i</code> \u5219\u5bf9\u5e94 4 \u6761\u673a\u5668\u6307\u4ee4\u3002\u7bad\u5934\u6307\u5411\u5f53\u524d pc\uff1a</p> <pre><code>(gdb) disas /m main\nDump of assembler code for function main:\n\n17      for(i=1; i&lt;=100; i++)\n   0x0000aaaaaaaa07b4 &lt;+20&gt;:    mov w0, #0x1                    // #1\n   0x0000aaaaaaaa07b8 &lt;+24&gt;:    str w0, [sp, #36]\n   0x0000aaaaaaaa07bc &lt;+28&gt;:    b   0xaaaaaaaa07dc &lt;main+60&gt;\n   0x0000aaaaaaaa07d0 &lt;+48&gt;:    ldr w0, [sp, #36]\n   0x0000aaaaaaaa07d4 &lt;+52&gt;:    add w0, w0, #0x1\n   0x0000aaaaaaaa07d8 &lt;+56&gt;:    str w0, [sp, #36]\n   0x0000aaaaaaaa07dc &lt;+60&gt;:    ldr w0, [sp, #36]\n   0x0000aaaaaaaa07e0 &lt;+64&gt;:    cmp w0, #0x64\n   0x0000aaaaaaaa07e4 &lt;+68&gt;:    b.le    0xaaaaaaaa07c0 &lt;main+32&gt;\n\n18      {\n19          result += i;\n=&gt; 0x0000aaaaaaaa07c0 &lt;+32&gt;:    ldrsw   x0, [sp, #36]\n   0x0000aaaaaaaa07c4 &lt;+36&gt;:    ldr x1, [sp, #40]\n   0x0000aaaaaaaa07c8 &lt;+40&gt;:    add x0, x1, x0\n   0x0000aaaaaaaa07cc &lt;+44&gt;:    str x0, [sp, #40]\n\n20      }\n</code></pre> <p>\u6267\u884c <code>nexti</code> \u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4\uff0cpc \u7bad\u5934\u4e0b\u79fb\u52a8\uff1a</p> <pre><code>(gdb) ni\n0x0000aaaaaaaa07c4  19          result += i;\n\n(gdb) disas /m main\nDump of assembler code for function main:\n\n18      {\n19          result += i;\n   0x0000aaaaaaaa07c0 &lt;+32&gt;:    ldrsw   x0, [sp, #36]\n=&gt; 0x0000aaaaaaaa07c4 &lt;+36&gt;:    ldr x1, [sp, #40]\n   0x0000aaaaaaaa07c8 &lt;+40&gt;:    add x0, x1, x0\n   0x0000aaaaaaaa07cc &lt;+44&gt;:    str x0, [sp, #40]\n\n20      }\n</code></pre> <p>\u6267\u884c <code>info frame</code> \u53ef\u67e5\u770b\u5f53\u524d\u6808\u5e27\u4fe1\u606f\uff08Frame Info\uff09: prints a verbose description of the selected stack frame.</p> <pre><code>(gdb) i f\nStack level 0, frame at 0xfffffffff0d0:\n pc = 0xaaaaaaaa07c4 in main (test-gdb.c:19); saved pc = 0xfffff7e373fc\n source language c.\n Arglist at 0xfffffffff0a0, args: argc=1, argv=0xfffffffff248\n Locals at 0xfffffffff0a0, Previous frame's sp is 0xfffffffff0d0\n Saved registers:\n  x29 at 0xfffffffff0a0, x30 at 0xfffffffff0a8\n</code></pre>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#continue","title":"continue","text":"<ul> <li>continue [ignore-count]</li> <li>fg [ignore-count]</li> </ul> <p>Resume program execution, at the address where your program last stopped; any breakpoints set at that address are bypassed.</p> <p>The optional argument <code>ignore-count</code> allows you to specify a further number of times to ignore a breakpoint at this location; its effect is like that of ignore.</p> <p>\u8f93\u5165 <code>c</code>\uff08continue\uff09\uff0c\u7ee7\u7eed\u6267\u884c\u5230\u4e0b\u4e00\u4e2a\u65ad\u70b9\u6216\u7ed3\u5c3e\u3002\u8fd9\u91cc\u547d\u4e2d\u7b2c 22 \u884c\u7684 2 \u53f7\u65ad\u70b9\u3002</p> <pre><code>(gdb) c\nContinuing.\n\nBreakpoint 2, main (argc=1, argv=0xfffffffff248) at test-gdb.c:22\n22      printf(\"result[1-100] = %ld\\n\", result );\n</code></pre> <p>\u7ee7\u7eed\u6267\u884c\u5230 3 \u53f7\u65ad\u70b9\uff0c\u547d\u4e2d func \u51fd\u6570\u7684\u7b2c\u4e00\u6761\u6307\u4ee4\u3002</p> <pre><code>(gdb) c\nContinuing.\nresult[1-100] = 5050\n\nBreakpoint 3, func (n=250) at test-gdb.c:5\n5       int sum=0,i;\n</code></pre> <p>\u7ee7\u7eed\u6267\u884c\u7b2c 8 \u884c\u7684 4 \u53f7\u6761\u4ef6\u65ad\u70b9\uff1a</p> <pre><code>(gdb) c\nContinuing.\n\nBreakpoint 4, func (n=250) at test-gdb.c:8\n8           sum+=i;\n(gdb) p i\n$1 = 50\n</code></pre>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#until","title":"until","text":"<p>\u5f53\u4f60\u538c\u5026\u4e86\u5728\u4e00\u4e2a\u5faa\u73af\u4f53\u5185\u5355\u6b65\u8ddf\u8e2a\u65f6\uff0c<code>until</code> \u547d\u4ee4\u53ef\u4ee5\u8fd0\u884c\u7a0b\u5e8f\u76f4\u5230\u9000\u51fa\u5faa\u73af\u4f53\u3002</p> <p><code>until</code> / u: Continue running until a source line past the current line, in the current stack frame, is reached.</p> <p>\u6267\u884c frame \u547d\u4ee4 prints a brief description of the currently selected stack frame\uff0c\u786e\u8ba4\u5f53\u524d\u8fd0\u884c\u5230\u4e86\u54ea\u91cc\uff08\u6682\u505c\u7684\u4f4d\u7f6e\uff09\u3002</p> <pre><code>(gdb) f\n#0  main (argc=1, argv=0xfffffffff248) at test-gdb.c:17\n17      for(i=1; i&lt;=100; i++)\n(gdb) l\n12  \n13  int main(int argc, char* argv[])\n14  {\n15      int i;\n16      long result = 0;\n17      for(i=1; i&lt;=100; i++)\n18      {\n19          result += i;\n20      }\n21  \n(gdb)\n22      printf(\"result[1-100] = %ld\\n\", result );\n23      printf(\"result[1-250] = %d\\n\", func(250) );\n24  \n25      return 0;\n26  }\n</code></pre> <p>\u8f93\u5165 <code>u</code>\uff08\u6216 <code>u 22</code>\uff09\uff0c\u8df3\u51fa\u7b2c 17-20 \u884c\u7684 for \u5faa\u73af\uff0c\u8fd0\u884c\u5230\u7b2c 22 \u884c\u6682\u505c\u3002</p> <pre><code>(gdb) u\nmain (argc=1, argv=0xfffffffff248) at test-gdb.c:22\n22      printf(\"result[1-100] = %ld\\n\", result );\n</code></pre> <p>\u6b64\u65f6\uff0c\u65ad\u5728\u7b2c 22 \u884c\u7684 printf \u8c03\u7528\uff0c\u6267\u884c <code>next</code> \u8fd0\u884c\u81f3\u7b2c 23 \u884c\u3002</p> <p>\u5982\u679c\u7ee7\u7eed\u6267\u884c <code>next</code> \u4e0d\u4f1a\u8fdb\u5165 func \u548c printf \u51fd\u6570\u5185\u90e8\uff0c\u76f4\u63a5\u8fd0\u884c\u81f3 return \u8bed\u53e5\u3002</p> <p>\u8981\u60f3\u8fdb\u5165 func \u51fd\u6570\u4f53\u5185\u90e8\u8fdb\u884c\u8c03\u8bd5\uff0c\u5219\u9700\u8981\u6539\u7528 <code>step</code> \u5355\u6b65\u8ddf\u8e2a\u547d\u4ee4\u3002</p>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#stepfinish","title":"step/finish","text":"<p><code>step</code>\uff1a\u5355\u6b65\u8ddf\u8e2a\uff0c\u5982\u679c\u6709\u51fd\u6570\u8c03\u7528\uff0c\u4f1a\u8fdb\u5165\u8be5\u51fd\u6570\uff0c\u7c7b\u4f3cVC\u7b49\u5de5\u5177\u4e2d\u7684 step in\u3002\u800c <code>next</code> \u9047\u5230\u51fd\u6570\u8c03\u7528\uff0c\u4e0d\u4f1a\u8fdb\u5165\u8be5\u51fd\u6570\u3002\u7c7b\u4f3cVC\u7b49\u5de5\u5177\u4e2d\u7684 step over\u3002</p> <p><code>step</code>: Continue running your program until control reaches a different source line, then stop it and return control to GDB. This command is abbreviated <code>s</code>.</p> <p><code>step count</code>: Continue running as in step, but do so count times. If a breakpoint is reached, or a signal not related to stepping occurs before count steps, stepping stops right away.</p> <p>\u4e0e nexti\uff08ni\uff09\u5bf9\u5e94\u6709 stepi\uff08si\uff09\u547d\u4ee4\uff0c\u652f\u6301\u673a\u5668\u6307\u4ee4\u7ea7\u522b\u7684\u5355\u6b65\u8c03\u8bd5\u3002</p> <p>\u6267\u884c <code>step</code> \u8ddf\u8e2a\u8fdb\u5165 func \u51fd\u6570\u4f53\u7b2c 5 \u884c\u4ee3\u7801\u3002</p> <pre><code>(gdb) s\nfunc (n=250) at test-gdb.c:5\n5       int sum=0,i;\n</code></pre> <p>\u5982\u679c\u4e0d\u60f3\u5728 func \u4e2d\u9017\u7559\uff0c\u53ef\u4ee5\u6267\u884c <code>finish</code> \u547d\u4ee4\u8fd0\u884c\u81f3\u5f53\u524d\u51fd\u6570\u8fd4\u56de\uff0c\u5e76\u6253\u5370\u51fd\u6570\u8fd4\u56de\u65f6\u7684\u5806\u6808\u5730\u5740\u548c\u8fd4\u56de\u503c\u53ca\u53c2\u6570\u503c\u7b49\u4fe1\u606f\u3002\u7c7b\u4f3c VC \u7b49\u5de5\u5177\u4e2d\u7684 step out\u3002</p> <p><code>finish</code>: Continue running until just after function in the selected stack frame returns. Print the returned value (if any). This command can be abbreviated as <code>fin</code>.</p> <pre><code>(gdb) fin\nRun till exit from #0  func (n=250) at test-gdb.c:5\n0x0000aaaaaaaa0800 in main (argc=1, argv=0xfffffffff248) at test-gdb.c:23\n23      printf(\"result[1-250] = %d\\n\", func(250) );\nValue returned is $10 = 31125\n</code></pre> <p>\u4ece func \u8fd4\u56de\u5230\u7b2c 23 \u884c\u7684 printf \u8bed\u53e5\uff0c\u5982\u679c\u7ee7\u7eed <code>step</code> \u5c06\u6df1\u5165 printf \u51fd\u6570\u5185\u90e8\uff0c\u63d0\u793a\u627e\u4e0d\u5230\u6e90\u4ee3\u7801\u3002 \u6267\u884c finish \u9000\u51fa printf \u51fd\u6570\u4f53\uff0c\u8fd4\u56de\u5230\u7b2c 25 \u884c\u7684 return \u8bed\u53e5\u3002</p> <pre><code>(gdb) s\n__printf (format=0xaaaaaaaa0850 \"result[1-250] = %d\\n\") at ./stdio-common/printf.c:28\n28  ./stdio-common/printf.c: No such file or directory.\n\n(gdb) fin\nRun till exit from #0  __printf (format=0xaaaaaaaa0850 \"result[1-250] = %d\\n\") at ./stdio-common/printf.c:28\nresult[1-250] = 31125\nmain (argc=1, argv=0xfffffffff248) at test-gdb.c:25\n25      return 0;\nValue returned is $11 = 22\n</code></pre>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#skip","title":"skip","text":"<p>5.3 Skipping Over Functions and Files</p> <p>The program you are debugging may contain some functions which are uninteresting to debug. The <code>skip</code> command lets you tell GDB to skip a function, all functions in a file or a particular function in a particular file when stepping.</p> <p>For example, consider the following C function:</p> <pre><code>int func()\n{\n    foo(boring());\n    bar(boring());\n}\n</code></pre> <p>Suppose you wish to step into the functions foo and bar, but you are not interested in stepping through boring. If you run step at line 103, you\u2019ll enter boring(), but if you run next, you\u2019ll step over both foo and boring!</p> <p>One solution is to <code>step</code> into boring and use the <code>finish</code> command to immediately exit it. But this can become tedious if boring is called from many places.</p> <p>A more flexible solution is to execute <code>skip boring</code>. This instructs GDB never to step into boring. Now when you execute step at line 103, you\u2019ll step over boring and directly into foo.</p> <p>\u5728\u4e0a\u9762\u6267\u884c step \u5355\u6b65\u8ddf\u8e2a\u7684\u4f8b\u5b50\u4e2d\uff0c\u53ef\u4ee5 <code>skip printf</code> \u4e0d\u8ddf\u8e2a\u8fdb\u5165 printf \u51fd\u6570\u4f53\u3002</p> <p>\u548c breakpoints/watchpoints \u4e00\u6837\uff0cskip points \u4e5f\u652f\u6301 info \u67e5\u770b\u548c enable/disable/delete \u7ba1\u7406\u64cd\u4f5c\uff1a</p> <ul> <li><code>info skip [range]</code>: Print details about the specified skip(s).</li> <li><code>skip delete [range]</code>:  Delete the specified skip(s). If range is not specified, delete all skips.</li> <li><code>skip enable [range]</code>: Enable the specified skip(s). If range is not specified, enable all skips.</li> <li><code>skip disable [range]</code>: Disable the specified skip(s). If range is not specified, disable all skips.</li> </ul>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#manage_breakpoints","title":"Manage Breakpoints","text":"<p>\u5bf9\u4e8e\u8bbe\u7f6e\u7684\u505c\u6b62\u70b9\uff0c\u53ef\u4ee5 disable \u7981\u7528\uff0c\u4e5f\u53ef\u4ee5 enable \u91cd\u65b0\u542f\u7528\uff0c\u6216\u8005 delete \u5220\u9664\u3002</p>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#enabledisable","title":"enable/disable","text":"<p>5.1.5 Disabling Breakpoints</p> <p>You can use the following commands to enable or disable breakpoints, watchpoints, tracepoints, and catchpoints:</p> <pre><code>disable [breakpoints] [list\u2026]\nDisable the specified breakpoints\u2014or all breakpoints, if none are listed. A disabled breakpoint has no effect but is not forgotten. All options such as ignore-counts, conditions and commands are remembered in case the breakpoint is enabled again later. You may abbreviate disable as dis.\n\nenable [breakpoints] [list\u2026]\nEnable the specified breakpoints (or all defined breakpoints). They become effective once again in stopping your program.\n\nenable [breakpoints] once list\u2026\nEnable the specified breakpoints temporarily. GDB disables any of these breakpoints immediately after stopping your program.\n\nenable [breakpoints] count count list\u2026\nEnable the specified breakpoints temporarily. GDB records count with each of the specified breakpoints, and decrements a breakpoint\u2019s count when it is hit. When any count reaches 0, GDB disables that breakpoint. If a breakpoint has an ignore count (see Break Conditions), that will be decremented to 0 before count is affected.\n\nenable [breakpoints] delete list\u2026\nEnable the specified breakpoints to work once, then die. GDB deletes any of these breakpoints as soon as your program stops there. Breakpoints set by the tbreak command start out in this state.\n</code></pre>","tags":["gdb","breakpoint"]},{"location":"blog/20200206/3-gdb-stop-and-continue/#delete","title":"delete","text":"<p>5.1.4 Deleting Breakpoints</p> <p><code>clear</code>: \u6e05\u9664\u4e0b\u4e00\u4e2a\u505c\u6b62\u70b9\u3002</p> <p>Delete any breakpoints at the next instruction to be executed in the selected stack frame (see\u00a0Selecting a Frame). When the innermost frame is selected, this is a good way to delete a breakpoint where your program just stopped.</p> <p><code>clear\u00a0locspec</code>\uff0c\u4e0e <code>break locspec</code> \u5bf9\u5e94\uff0c\u652f\u6301\u6e05\u9664\u6307\u5b9a\u884c\u53f7\u3001\u51fd\u6570\u548c\u5730\u5740\u5904\u7684\u505c\u6b62\u70b9\u3002</p> <p>Delete any breakpoint with a code location that corresponds to\u00a0locspec. See\u00a0Location Specifications, for the various forms of\u00a0locspec.</p> <ul> <li>linenum</li> <li>filename:linenum</li> <li>-line linenum</li> <li>-source filename -line linenum</li> <li>*address</li> <li>function / -function function</li> </ul> <p><code>delete\u00a0[breakpoints]\u00a0[list\u2026]</code></p> <p>Delete the breakpoints, watchpoints, tracepoints, or catchpoints of the breakpoint list specified as argument. If no argument is specified, delete all breakpoints, watchpoints, tracepoints, and catchpoints (GDB\u00a0asks confirmation, unless you have\u00a0<code>set confirm off</code>). You can abbreviate this command as\u00a0<code>d</code>.</p> <p>\u5220\u9664\u6307\u5b9a\u7684\u65ad\u70b9\uff0cbreakpoints\u4e3a\u65ad\u70b9\u53f7\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u65ad\u70b9\u53f7\uff0c\u5219\u8868\u793a\u5220\u9664\u6240\u6709\u7684\u65ad\u70b9\u3002</p> <pre><code>(gdb) i b\nNum     Type           Disp Enb Address            What\n1       breakpoint     keep y   0x0000aaaaaaaa07b0 in main at test-gdb.c:16\n    breakpoint already hit 1 time\n2       breakpoint     keep y   0x0000aaaaaaaa07e8 in main at test-gdb.c:22\n3       breakpoint     keep y   0x0000aaaaaaaa075c in func at test-gdb.c:5\n4       breakpoint     keep y   0x0000aaaaaaaa0768 in func at test-gdb.c:8\n    stop only if i==50\n\n# \u6e05\u9664\u4e0b\u4e00\u4e2a\u65ad\u70b9\uff081 \u53f7\u65ad\u70b9\uff09\n(gdb) clear\nDeleted breakpoint 1\n\n# \u5220\u9664 2 \u53f7\u65ad\u70b9\n(gdb) d 2\n\n# \u5220\u9664\u7b2c 8 \u884c\u7684\u505c\u6b62\u70b9\uff084 \u53f7\u65ad\u70b9\uff09\n(gdb) clear 8\nDeleted breakpoint 4\n\n(gdb) i b\nNum     Type           Disp Enb Address            What\n3       breakpoint     keep y   0x0000aaaaaaaa075c in func at test-gdb.c:5\n\n(gdb) d\nDelete all breakpoints? (y or n) y\n</code></pre>","tags":["gdb","breakpoint"]},{"location":"blog/20200207/4-gdb-examining-data/","title":"GDB Examining Data","text":"<p>10 Examining Data</p> <ul> <li>10.3 Program Variables</li> <li>10.4 Artificial Arrays</li> <li>10.6 Examining Memory</li> <li>10.8 Automatic Display</li> <li>10.14 Registers</li> </ul> <p>The usual way to examine data in your program is with the <code>print</code> command (abbreviated <code>p</code>), or its synonym <code>inspect</code>. It evaluates and prints the value of an expression.</p> <p>print [[options] --] expr print [[options] --] /f expr</p> <p>expr is an expression. By default the value of expr is printed in a format appropriate to its data type; you can choose a different format by specifying <code>/f</code>, where f is a letter specifying the format; see Output Formats.</p> <p>GDB\u7684\u6570\u636e\u663e\u793a\u683c\u5f0f\uff1a</p> <ul> <li><code>x</code>: \u6309\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u53d8\u91cf\u3002</li> <li><code>d</code>: \u6309\u5341\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u53d8\u91cf\u3002</li> <li><code>u</code>: \u6309\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u65e0\u7b26\u53f7\u6574\u578b\u3002</li> <li><code>o</code>: \u6309\u516b\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u53d8\u91cf\u3002</li> <li><code>t</code>: \u6309\u4e8c\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u53d8\u91cf\u3002</li> <li><code>a</code>: \u6309\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u663e\u793a\u53d8\u91cf\u3002</li> <li><code>c</code>: \u6309\u5b57\u7b26\u683c\u5f0f\u663e\u793a\u53d8\u91cf\u3002</li> <li><code>f</code>: \u6309\u6d6e\u70b9\u6570\u683c\u5f0f\u663e\u793a\u53d8\u91cf\u3002</li> </ul> <pre><code>(gdb) p i\n$1 = 101\n(gdb) p/a i\n$2 = 0x65\n(gdb) p/c i\n$3 = 101 'e'\n(gdb) p/t i\n$4 = 1100101\n</code></pre>","tags":["gdb","examine"]},{"location":"blog/20200207/4-gdb-examining-data/#array","title":"array","text":"<p>\u6709\u65f6\u5019\uff0c\u4f60\u9700\u8981\u67e5\u770b\u4e00\u6bb5\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\u7684\u503c\u3002\u6bd4\u5982\u6570\u7ec4\u7684\u4e00\u6bb5\uff0c\u6216\u662f\u52a8\u6001\u5206\u914d\u7684\u6570\u636e\u7684\u5927\u5c0f\u3002</p> <p>\u6b64\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528GDB\u7684 <code>@</code> \u64cd\u4f5c\u7b26\u3002<code>@</code> \u7684\u5de6\u8fb9\u662f\u7b2c\u4e00\u4e2a\u5185\u5b58\u7684\u5730\u5740\uff0c<code>@</code>\u7684\u53f3\u8fb9\u662f\u6b32\u67e5\u770b\u7684\u5185\u5b58\u7684\u957f\u5ea6\uff08\u5b57\u8282\u6570\uff09\u3002</p> <p>\u4f8b\u5982\uff0c\u4f60\u7684\u7a0b\u5e8f\u4e2d\u6709\u8fd9\u6837\u7684\u8bed\u53e5\uff1a</p> <pre><code>int *array = (int *) malloc (len * sizeof (int));\n</code></pre> <p>\u4e8e\u662f\uff0c\u5728GDB\u8c03\u8bd5\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u4ee5\u4ee5\u5982\u4e0b\u547d\u4ee4\u663e\u793a\u51fa\u8fd9\u4e2a\u52a8\u6001\u6570\u7ec4\u7684\u53d6\u503c\uff1a</p> <pre><code>p *array@len\n</code></pre> <p>@\u7684\u5de6\u8fb9\u662f\u6570\u7ec4\u7684\u9996\u5730\u5740\u7684\u503c\uff0c\u4e5f\u5c31\u662f\u53d8\u91cfarray\u6240\u6307\u5411\u7684\u5185\u5bb9\uff0c\u53f3\u8fb9\u5219\u662f\u6570\u636e\u7684\u957f\u5ea6 len\u3002 </p> <p>\u5176\u8f93\u51fa\u7ed3\u679c\uff0c\u5927\u7ea6\u662f\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\u7684\uff1a</p> <pre><code>(gdb) p *array@len\n$1 = {2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40}\n</code></pre> <p>\u5982\u679c\u662f\u9759\u6001\u6570\u7ec4\u7684\u8bdd\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528 print \u6570\u7ec4\u540d\uff0c\u5c31\u53ef\u4ee5\u663e\u793a\u6570\u7ec4\u4e2d\u6240\u6709\u6570\u636e\u7684\u5185\u5bb9\u4e86\u3002</p>","tags":["gdb","examine"]},{"location":"blog/20200207/4-gdb-examining-data/#memory","title":"memory","text":"<p>\u53ef\u4ee5\u4f7f\u7528 <code>examine</code> \u547d\u4ee4\uff08\u7b80\u5199\u662f <code>x</code>\uff09\u6765\u67e5\u770b\u5185\u5b58\u5730\u5740\u4e2d\u7684\u503c\uff0c\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>x/&lt;n/f/u&gt; &lt;addr&gt;\n</code></pre> <p>n\u3001f\u3001u \u662f\u53ef\u9009\u7684\u53c2\u6570\u3002</p> <ul> <li> <p>n \u662f\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u8868\u793a\u663e\u793a\u5185\u5b58\u7684\u957f\u5ea6\uff0c\u4e5f\u5c31\u662f\u8bf4\u4ece\u5f53\u524d\u5730\u5740\u5411\u540e\u663e\u793a\u51e0\u4e2a\u5730\u5740\u7684\u5185\u5bb9\u3002</p> </li> <li> <p>f \u8868\u793a\u663e\u793a\u7684\u683c\u5f0f\uff0c\u53c2\u89c1\u4e0a\u9762\u3002\u5982\u679c\u5730\u5740\u6240\u6307\u7684\u662f\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u683c\u5f0f\u53ef\u4ee5\u662fs\uff0c\u5982\u679c\u5730\u5740\u662f\u6307\u4ee4\u5730\u5740\uff0c\u90a3\u4e48\u683c\u5f0f\u53ef\u4ee5\u662fi\u3002</p> </li> <li> <p>u \u8868\u793a\u4ece\u5f53\u524d\u5730\u5740\u5f80\u540e\u8bf7\u6c42\u7684\u5b57\u8282\u6570\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u7684\u8bdd\uff0cGDB\u9ed8\u8ba4\u662f4\u4e2abytes\u3002</p> <ul> <li> <p>u \u53c2\u6570\u53ef\u4ee5\u7528\u4ee5\u4e0b\u5b57\u7b26\u6765\u4ee3\u66ff\uff1ab\u8868\u793a\u5355\u5b57\u8282\uff0ch\u8868\u793a\u53cc\u5b57\u8282\uff0cw\u8868\u793a\u56db\u5b57\u8282\uff0cg\u8868\u793a\u516b\u5b57\u8282\u3002</p> </li> <li> <p>\u5f53\u6211\u4eec\u6307\u5b9a\u4e86\u5b57\u8282\u957f\u5ea6\u540e\uff0cGDB\u4f1a\u4ece\u6307\u5185\u5b58\u5b9a\u7684\u5185\u5b58\u5730\u5740\u5f00\u59cb\uff0c\u8bfb\u5199\u6307\u5b9a\u5b57\u8282\uff0c\u5e76\u628a\u5176\u5f53\u4f5c\u4e00\u4e2a\u503c\u53d6\u51fa\u6765\u3002</p> </li> </ul> </li> <li> <p><code>&lt;addr&gt;</code>: \u8868\u793a\u4e00\u4e2a\u5185\u5b58\u5730\u5740\u3002</p> </li> </ul> <p>n/f/u\u4e09\u4e2a\u53c2\u6570\u53ef\u4ee5\u4e00\u8d77\u4f7f\u7528\u3002\u4f8b\u5982\uff0c\u547d\u4ee4 <code>x/3uh 0x54320</code> \u8868\u793a\u4ece\u5185\u5b58\u5730\u57400x54320\u8bfb\u53d6\u5185\u5bb9\uff0ch\u8868\u793a\u4ee5\u53cc\u5b57\u8282\u4e3a\u4e00\u4e2a\u5355\u4f4d\uff0c3\u8868\u793a\u4e09\u4e2a\u5355\u4f4d\uff0cu\u8868\u793a\u6309\u5341\u516d\u8fdb\u5236\u663e\u793a\u3002</p>","tags":["gdb","examine"]},{"location":"blog/20200207/4-gdb-examining-data/#display","title":"display","text":"<p>\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e9b\u81ea\u52a8\u663e\u793a\u7684\u53d8\u91cf\uff0c\u5f53\u7a0b\u5e8f\u505c\u4f4f\u65f6\uff0c\u6216\u662f\u5728\u4f60\u5355\u6b65\u8ddf\u8e2a\u65f6\uff0c\u8fd9\u4e9b\u53d8\u91cf\u4f1a\u81ea\u52a8\u663e\u793a\u3002\u76f8\u5173\u7684GDB\u547d\u4ee4\u662f <code>display</code>\u3002</p> <ul> <li><code>display &lt;expr&gt;</code></li> <li><code>display/&lt;fmt&gt; &lt;expr&gt;</code></li> <li><code>display/&lt;fmt&gt; &lt;addr&gt;</code></li> </ul> <p>expr \u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0cfmt \u8868\u793a\u663e\u793a\u7684\u683c\u5f0f\uff0caddr \u8868\u793a\u5185\u5b58\u5730\u5740\u3002</p> <p>\u5f53\u4f60\u7528display\u8bbe\u5b9a\u597d\u4e86\u4e00\u4e2a\u6216\u591a\u4e2a\u8868\u8fbe\u5f0f\u540e\uff0c\u53ea\u8981\u4f60\u7684\u7a0b\u5e8f\u88ab\u505c\u4e0b\u6765\uff0cGDB\u4f1a\u81ea\u52a8\u663e\u793a\u4f60\u6240\u8bbe\u7f6e\u7684\u8fd9\u4e9b\u8868\u8fbe\u5f0f\u7684\u503c\u3002</p> <p>\u53ef\u6267\u884c <code>info display</code> \u5217\u4e3e\u67e5\u770b\u5df2\u7ecf\u8bbe\u7f6e\u7684 display points\u3002\u6b64\u5916\uff0cGDB \u8fd8\u63d0\u4f9b\u4e86\u5220\u9664\u547d\u4ee4\uff1a</p> <ul> <li><code>undisplay &lt;dnums...&gt;</code></li> <li><code>delete display &lt;dnums...&gt;</code></li> </ul> <p>dnums \u4e3a\u81ea\u52a8\u663e\u793a\u7684\u7f16\u53f7\uff0c\u591a\u4e2a\u7f16\u53f7\u4e4b\u95f4\u7528\u7a7a\u683c\u5206\u9694\u3002</p>","tags":["gdb","examine"]},{"location":"blog/20200207/4-gdb-examining-data/#registers","title":"registers","text":"<p>\u8981\u67e5\u770b\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\uff1a</p> <p><code>info registers</code>\uff1a\u67e5\u770b\u5bc4\u5b58\u5668\u7684\u60c5\u51b5\u3002\uff08\u9664\u4e86\u6d6e\u70b9\u5bc4\u5b58\u5668\uff09 <code>info all-registers</code>\uff1a\u67e5\u770b\u6240\u6709\u5bc4\u5b58\u5668\u7684\u60c5\u51b5\u3002\uff08\u5305\u62ec\u6d6e\u70b9\u5bc4\u5b58\u5668\uff09 <code>info registers &lt;regname ...&gt;</code>\uff1a\u67e5\u770b\u6307\u5b9a\u7684\u5bc4\u5b58\u5668\u7684\u60c5\u51b5\u3002</p> <p>\u5bc4\u5b58\u5668\u4e2d\u653e\u7f6e\u4e86\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u6570\u636e\uff0c\u6bd4\u5982\u7a0b\u5e8f\u5f53\u524d\u8fd0\u884c\u7684\u6307\u4ee4\u5730\u5740\uff08ip\uff09\uff0c\u7a0b\u5e8f\u7684\u5f53\u524d\u5806\u6808\u5730\u5740\uff08sp\uff09\u7b49\u7b49\u3002\u4f60\u540c\u6837\u53ef\u4ee5\u4f7f\u7528print\u547d\u4ee4\u6765\u8bbf\u95ee\u5bc4\u5b58\u5668\u7684\u60c5\u51b5\uff0c\u53ea\u9700\u8981\u5728\u5bc4\u5b58\u5668\u540d\u5b57\u524d\u52a0\u4e00\u4e2a $ \u7b26\u53f7\u5373\u53ef\uff0c\u5982 <code>p $pc</code>\u3002</p>","tags":["gdb","examine"]},{"location":"blog/20200207/4-gdb-examining-data/#symbol","title":"symbol","text":"<p>16 Examining the Symbol Table</p> <p>ptype[/flags] [arg]</p> <p>ptype accepts the same arguments as <code>whatis</code>, but prints a detailed description of the type, instead of just the name of the type. See Expressions.</p> <ul> <li><code>o</code>: Print the offsets and sizes of fields in a struct, similar to what the pahole tool does. This option implies the /tm flags.</li> </ul> <p>Issuing a <code>ptype /o [struct|union]</code> command to print offsets inside an struct/union:</p> <ul> <li>(gdb) ptype /o struct tuv</li> <li>(gdb) ptype /o union qwe</li> </ul>","tags":["gdb","examine"]},{"location":"blog/20200208/5-gdb-examining-stack/","title":"GDB Examining the Stack","text":"<p>8 Examining the Stack</p> <ul> <li>Frames: Stack frames</li> <li>Backtrace: Backtraces</li> <li>Selection: Selecting a frame</li> <li>Frame Info: Information on a frame</li> </ul>","tags":["gdb","examine","stack","frame"]},{"location":"blog/20200208/5-gdb-examining-stack/#frames","title":"Frames","text":"<p>8.1 Stack Frames</p> <p>The call stack is divided up into contiguous pieces called stack frames, or frames for short; each frame is the data associated with one call to one function. The frame contains the arguments given to the function, the function\u2019s local variables, and the address at which the function is executing.</p> <p>When your program is started, the stack has only one frame, that of the function main. This is called the initial frame or the outermost frame. Each time a function is called, a new frame is made. Each time a function returns, the frame for that function invocation is eliminated.</p> <p>Usually this address is kept in a register called the\u00a0frame pointer register\u00a0(see\u00a0$fp) while execution is going on in that frame.</p> <p>GDB\u00a0labels each existing stack frame with a\u00a0level, a number that is zero for the innermost frame, one for the frame that called it, and so on upward. These level numbers give you a way of designating stack frames in\u00a0GDB\u00a0commands. The terms\u00a0frame number\u00a0and\u00a0frame level\u00a0can be used interchangeably to describe this number.</p> <p>Some compilers provide a way to compile functions so that they operate without stack frames. (For example, the\u00a0GCC\u00a0option <code>-fomit-frame-pointer</code> generates functions without a frame.) This is occasionally done with heavily used library functions to save the frame setup time.\u00a0</p> <p>\u300aC/C++\u6df1\u5c42\u63a2\u7d22\u300b(\u59da\u65b0\u989c,2002) 03 \u8c03\u7528\u51fd\u6570\u3001\u6808\uff1a</p> <p>\uff3bFN0308\uff3d\uff1a\u53ef\u80fd\u4f1a\u6709\u8bfb\u8005\u95ee\uff1a\u4e3a\u4ec0\u4e48\u4e00\u5f00\u59cb\u4e0d\u76f4\u63a5\u7528 esp \u5bfb\u5740\ud84c\udffe\u91cc\u9762\u7684\u6570\u636e\uff0c\u7528\u5f97\u7740\u8fd9\u4e48\u8d39\u529f\u592b\uff0c\u5148\u4fdd\u5b58 ebp\uff0c\u7136\u540e\u7528 ebp \u5b58\u653e esp \u7684\u503c\uff0c\u518d\u901a\u8fc7 ebp \u6765\u5bfb\u5740\u5417\uff1f</p> <p>\u5176\u5b9e\u76f4\u63a5\u7528 esp \u5bfb\u5740\u662f\u53ef\u4ee5\u7684\uff0c\u4f46 gcc \u9ed8\u8ba4\u8f93\u51fa\u7684\u6c47\u7f16\u4ee3\u7801\u662f\u7528 ebp \u6765\u5bfb\u5740\u5417\uff1f\u7528 esp \u52fe\u753b\u51fa\u6574\u4e2a\u51fd\u6570\u7684\u6808\u7a7a\u95f4\u3002\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\u4ee3\u7801\u975e\u5e38\u6e05\u6670\uff0c\u4fbf\u4e8e\u5206\u6790\u7814\u7a76\uff0c\u6240\u4ee5\u672c\u4e66\u4e5f\u5c31\u6309\u7167\u8fd9\u6837\u7684\u4ee3\u7801\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p>\u5982\u679c\u8981\u8ffd\u6c42\u66f4\u9ad8\u7684\u8fd0\u884c\u6548\u7387\uff0c\u4f8b\u5982\u5728\u7f16\u8bd1 linux \u5185\u6838\u65f6\uff0c\u4f60\u4f1a\u53d1\u73b0\u51fd\u6570\u5185\u90e8\u7684\u786e\u662f\u76f4\u63a5\u7528 esp \u5bfb\u5740\u7684\u3002\u53ef\u4ee5\u7528\u7f16\u8bd1\u9009\u9879\u6307\u793a gcc \u76f4\u63a5\u7528 esp \u5bfb\u5740\uff0c\u4f8b\u5982\uff1a<code>gcc -fomit-frame-pointer example.c</code>\u3002</p> <p>\u300aC\u8bed\u8a00\u6807\u51c6\u4e0e\u5b9e\u73b0\u300b(\u59da\u65b0\u989c,2004) 02 P6\u5904\u7406\u5668\u7684\u6808\uff1a</p> <p>\u5982\u679c\u6211\u4eec\u660e\u786e\u8868\u793a\u4e0d\u9700\u8981 EBP \u63d0\u4f9b\u6808\u6846\u4fe1\u606f\uff0c\u7f16\u8bd1\u5668\u53ef\u4ee5\u7701\u53bb\u8fdb\u5165\u8fc7\u7a0b\u540e\u4fdd\u5b58 EBP \u4ee5\u53ca\u9000\u51fa\u8fc7\u7a0b\u524d\u6062\u590d EBP \u7684\u52a8\u4f5c\u5e76\u4e14\u76f4\u63a5\u4f7f\u7528 ESP \u6765\u5bfb\u5740\u8fc7\u7a0b\u7684\u53c2\u6570\u548c\u5185\u90e8\u53d8\u91cf\u3002</p> <p>\u5bf9\u4e8e gcc \u548c g++\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>-fomit-frame-poiter</code> \u7f16\u8bd1\u9009\u9879\u3002</p>","tags":["gdb","examine","stack","frame"]},{"location":"blog/20200208/5-gdb-examining-stack/#backtrace","title":"Backtrace","text":"<p>8.2 Backtraces</p> <p>A backtrace is a summary of how your program got where it is. It shows one line per frame, for many frames, starting with the currently executing frame (frame zero), followed by its caller (frame one), and on up the stack.</p> <p>To print a backtrace of the entire stack, use the\u00a0<code>backtrace</code>\u00a0command, or its alias\u00a0<code>bt</code>. This command will print one line per frame for frames in the stack. By default, all stack frames are printed. You can stop the backtrace at any time by typing the system interrupt character, normally\u00a0Ctrl-c.</p> <p><code>backtrace [option]\u2026 [qualifier]\u2026 [count]</code></p> <p>Print the backtrace of the entire stack, show you <code>where</code> the execution is halted.</p> <p>\u5f53\u7a0b\u5e8f\u88ab\u505c\u4f4f\u4e86\uff0c\u4f60\u9700\u8981\u505a\u7684\u7b2c\u4e00\u4ef6\u4e8b\u5c31\u662f\u67e5\u770b\u7a0b\u5e8f\u662f\u5728\u54ea\u91cc\u505c\u4f4f\u7684\u3002\u5f53\u4f60\u7684\u7a0b\u5e8f\u8c03\u7528\u4e86\u4e00\u4e2a\u51fd\u6570\uff0c\u51fd\u6570\u7684\u5730\u5740\u3001\u53c2\u6570\u4ee5\u53ca\u51fd\u6570\u5185\u7684\u5c40\u90e8\u53d8\u91cf\u90fd\u4f1a\u88ab\u538b\u5165\u201c\u6808\u201d\uff08Stack\uff09\u4e2d\u3002\u4f60\u53ef\u4ee5\u7528 GDB \u547d\u4ee4 <code>backtrace</code> \u6765\u67e5\u770b\u5f53\u524d\u6808\u4e2d\u7684\u4fe1\u606f\u3002</p> <p>\u5f53\u8c03\u7528\u6808\u8f83\u6df1\u65f6\uff0c\u53ef\u4ee5\u9650\u5b9a\u663e\u793a\u5c42\u7ea7\uff1a</p> <ul> <li><code>bt &lt;n&gt;</code>: n\u662f\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u8868\u793a\u53ea\u6253\u5370\u6808\u9876\u4e0an\u5c42\u7684\u6808\u4fe1\u606f\u3002</li> <li><code>bt &lt;-n&gt;</code>: -n\u8868\u4e00\u4e2a\u8d1f\u6574\u6570\uff0c\u8868\u793a\u53ea\u6253\u5370\u6808\u5e95\u4e0bn\u5c42\u7684\u6808\u4fe1\u606f\u3002</li> </ul> <p>backtrace \u663e\u793a\u7684\u662f Call Stack\uff0c\u6bcf\u4e00\u5c42\u51fd\u6570\u90fd\u6709\u81ea\u5df1\u7684\u6808\u5e27\uff08Stack Frame\uff09\u3002</p>","tags":["gdb","examine","stack","frame"]},{"location":"blog/20200208/5-gdb-examining-stack/#frame_info","title":"Frame Info","text":"<p>8.4 Information About a Frame</p> <p><code>frame</code>: When used without any argument, this command does not change which frame is selected, but prints a brief description of the currently selected stack frame. It can be abbreviated <code>f</code>. With an argument, this command is used to select a stack frame. See Selecting a Frame.</p> <p><code>info frame</code>: This command prints a verbose description of the selected stack frame, including:</p> <ul> <li>the address of the frame</li> <li>the address of the next frame down (called by this frame)</li> <li>the address of the next frame up (caller of this frame)</li> <li>the language in which the source code corresponding to this frame is written</li> <li>the address of the frame\u2019s arguments</li> <li>the address of the frame\u2019s local variables</li> <li>the program counter saved in it (the address of execution in the caller frame)</li> <li>which registers were saved in the frame</li> </ul> <p>\u6267\u884c <code>frame</code> / <code>info frame</code> \u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u6808\u5e27\u7684\u7b80\u8981/\u8be6\u60c5\u4fe1\u606f\u3002</p> <p>\u5982\u679c\u4f60\u8981\u67e5\u770b\u67d0\u4e00\u5c42\u7684\u4fe1\u606f\uff0c\u5219\u9700\u8981\u5207\u6362\u5f53\u524d\u7684\u6808\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u7a0b\u5e8f\u505c\u6b62\u65f6\uff0c\u6700\u9876\u5c42\u7684\u6808\u5c31\u662f\u5f53\u524d\u6808\uff0c\u5982\u679c\u4f60\u8981\u67e5\u770b\u6808\u4e0b\u9762\u5c42\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u9996\u5148\u8981\u505a\u7684\u662f\u5207\u6362\u5f53\u524d\u6808\u3002</p>","tags":["gdb","examine","stack","frame"]},{"location":"blog/20200208/5-gdb-examining-stack/#frame_switch","title":"Frame Switch","text":"<p>8.3 Selecting a Frame</p> <p>Most commands for examining the stack and other data in your program work on whichever stack frame is selected at the moment. Here are the commands for selecting a stack frame; all of them finish by printing a brief description of the stack frame just selected.</p> <p><code>frame [ frame-selection-spec ]</code> : The frame command allows different stack frames to be selected. The <code>frame-selection-spec</code> can be any of the following:</p> <p>num / level num: num \u662f\u6808\u4e2d\u7684\u5c42\u7f16\u53f7</p> <p>Select frame level num. Recall that frame zero is the innermost (currently executing) frame, frame one is the frame that called the innermost one, and so on. The highest level frame is usually the one for main.</p> <p>function function-name</p> <p>Select the stack frame for function function-name. If there are multiple stack frames for function function-name then the inner most stack frame is selected.</p> <p>up n: \u8868\u793a\u5411\u6808\u7684\u4e0a\u9762\u79fb\u52a8n\u5c42\uff08\u9ed8\u8ba4 n=1\uff09\u3002</p> <p>Move n frames up the stack; n defaults to 1. For positive numbers n, this advances toward the outermost frame, to higher frame numbers, to frames that have existed longer.</p> <p>down n: \u8868\u793a\u5411\u6808\u7684\u4e0b\u9762\u79fb\u52a8n\u5c42\uff08\u9ed8\u8ba4 n=1\uff09\u3002</p> <p>Move n frames down the stack; n defaults to 1. For positive numbers n, this advances toward the innermost frame, to lower frame numbers, to frames that were created more recently. You may abbreviate down as do.</p>","tags":["gdb","examine","stack","frame"]},{"location":"blog/20200209/6-gdb-debug-assembly/","title":"GDB debug assembly","text":"<p>This article involves the following topics:</p> <ol> <li>How to disassemble source code to machine code?</li> <li>How to dump machine instruction along with source line?</li> <li>How to layout src and asm side by side in a single gdb window?</li> </ol> <p>linux - How to debug assembly? - Stack Overflow</p>","tags":["gdb","disassemble"]},{"location":"blog/20200209/6-gdb-debug-assembly/#disassemble","title":"disassemble","text":"<p>9.6 Source and Machine Code</p> <p>help disassemble:</p> <pre><code>(gdb) help disas\nDisassemble a specified section of memory.\nUsage: disassemble[/m|/r|/s] START [, END]\nDefault is the function surrounding the pc of the selected frame.\n\nWith a /s modifier, source lines are included (if available).\nIn this mode, the output is displayed in PC address order, and\nfile names and contents for all relevant source files are displayed.\n\nWith a /m modifier, source lines are included (if available).\nThis view is \"source centric\": the output is in source line order,\nregardless of any optimization that is present.  Only the main source file\nis displayed, not those of, e.g., any inlined functions.\nThis modifier hasn't proved useful in practice and is deprecated\nin favor of /s.\n\nWith a /r modifier, raw instructions in hex are included.\n\nWith a single argument, the function surrounding that address is dumped.\nTwo arguments (separated by a comma) are taken as a range of memory to dump,\n  in the form of \"start,end\", or \"start,+length\".\n\nNote that the address is interpreted as an expression, not as a location\nlike in the \"break\" command.\nSo, for example, if you want to disassemble function bar in file foo.c\nyou must type \"disassemble 'foo.c'::bar\" and not \"disassemble foo.c:bar\".\n</code></pre> <p>\u5f53\u4e0d\u5e26\u53c2\u6570\u6267\u884c <code>disassemble</code> \u547d\u4ee4\u65f6\uff0c\u9ed8\u8ba4\u53cd\u6c47\u7f16\u5f53\u524d pc \u5468\u8fb9\u7684\u4ee3\u7801\u3002</p> <p>The default memory range is the function surrounding the program counter of the selected frame.</p> <p>Show mixed source+assembly with <code>/m</code>(mixed source) or <code>/s</code>(source).</p> <p><code>/m</code> \u4e3a source line order\uff0c\u5ffd\u7565\u4e86\u4e00\u4e9b\u5185\u8054\u5c55\u5f00\uff08inlined code\uff09\u548c\u6307\u4ee4\u91cd\u6392\uff08re-ordered\uff09\u4f18\u5316\uff0c<code>/s</code> \u4e3a\u5b9e\u9645\u8fd0\u884c\u7684 PC address order\u3002</p> <p>\u521d\u6b65\u5b66\u4e60\u5bf9\u6bd4 src \u5230 asm \u7684\u76f4\u63a5\u7ffb\u8bd1\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>/m</code> \u9009\u9879\uff1b\u8003\u8651 ni/si \u5355\u6b65\u8ddf\u8e2a\u6307\u4ee4\u5e8f\u5217\u7684\u5b9e\u9645\u8fd0\u884c\uff0c\u5219\u5efa\u8bae\u4f7f\u7528 <code>/s</code> \u9009\u9879\u3002</p> <p>\u53c2\u8003\u5b98\u7f51\u5728\u7ebf\u6587\u6863\u7ed9\u51fa\u7684\u793a\u4f8b\uff0c\u5bf9\u6bd4 disas /m main \u548c disas /s main \u8f93\u51fa\uff0c\u5206\u6790\u4f18\u5316\u524d\u540e\u6307\u4ee4\u5e8f\u5217\u7684\u533a\u522b\u3002</p> <p>prefer /s to /m</p> <p>The <code>/m</code> option is deprecated as its output is not useful when there is either inlined code or re-ordered code. The <code>/s</code> option is the preferred choice. Here is an example for AMD x86-64 showing the difference between <code>/m</code> output and <code>/s</code> output. This example has one inline function defined in a header file, and the code is compiled with \u2018-O2\u2019 optimization. Note how the <code>/m</code> output is missing the disassembly of several instructions that are present in the <code>/s</code> output.</p>","tags":["gdb","disassemble"]},{"location":"blog/20200209/6-gdb-debug-assembly/#disas__start","title":"disas _start","text":"<pre><code>(gdb) b _start\nBreakpoint 1 at 0x640\n(gdb) start\nTemporary breakpoint 2 at 0x7b0: file test-gdb.c, line 16.\nStarting program: /home/pifan/Projects/cpp/test-gdb\n\nBreakpoint 1, 0x0000fffff7fd9c48 in _start () from /lib/ld-linux-aarch64.so.1\n(gdb) disas /m _start\nDump of assembler code for function _start:\n   0x0000aaaaaaaa0640 &lt;+0&gt;: nop\n   0x0000aaaaaaaa0644 &lt;+4&gt;: mov x29, #0x0                       // #0\n   0x0000aaaaaaaa0648 &lt;+8&gt;: mov x30, #0x0                       // #0\n   0x0000aaaaaaaa064c &lt;+12&gt;:    mov x5, x0\n   0x0000aaaaaaaa0650 &lt;+16&gt;:    ldr x1, [sp]\n   0x0000aaaaaaaa0654 &lt;+20&gt;:    add x2, sp, #0x8\n   0x0000aaaaaaaa0658 &lt;+24&gt;:    mov x6, sp\n   0x0000aaaaaaaa065c &lt;+28&gt;:    adrp    x0, 0xaaaaaaab0000\n   0x0000aaaaaaaa0660 &lt;+32&gt;:    ldr x0, [x0, #4080]\n   0x0000aaaaaaaa0664 &lt;+36&gt;:    mov x3, #0x0                    // #0\n   0x0000aaaaaaaa0668 &lt;+40&gt;:    mov x4, #0x0                    // #0\n   0x0000aaaaaaaa066c &lt;+44&gt;:    bl  0xaaaaaaaa05f0 &lt;__libc_start_main@plt&gt;\n   0x0000aaaaaaaa0670 &lt;+48&gt;:    bl  0xaaaaaaaa0620 &lt;abort@plt&gt;\nEnd of assembler dump.\n</code></pre>","tags":["gdb","disassemble"]},{"location":"blog/20200209/6-gdb-debug-assembly/#disas_func","title":"disas func","text":"<pre><code>(gdb) disas /m func\nDump of assembler code for function func:\n5   {\n   0x0000aaaaaaaa0754 &lt;+0&gt;: sub sp, sp, #0x20\n   0x0000aaaaaaaa0758 &lt;+4&gt;: str w0, [sp, #12]\n\n6       int sum=0,i;\n=&gt; 0x0000aaaaaaaa075c &lt;+8&gt;: str wzr, [sp, #24]\n\n7       for(i=0; i&lt;n; i++)\n   0x0000aaaaaaaa0760 &lt;+12&gt;:    str wzr, [sp, #28]\n   0x0000aaaaaaaa0764 &lt;+16&gt;:    b   0xaaaaaaaa0784 &lt;func+48&gt;\n   0x0000aaaaaaaa0778 &lt;+36&gt;:    ldr w0, [sp, #28]\n   0x0000aaaaaaaa077c &lt;+40&gt;:    add w0, w0, #0x1\n   0x0000aaaaaaaa0780 &lt;+44&gt;:    str w0, [sp, #28]\n   0x0000aaaaaaaa0784 &lt;+48&gt;:    ldr w1, [sp, #28]\n   0x0000aaaaaaaa0788 &lt;+52&gt;:    ldr w0, [sp, #12]\n   0x0000aaaaaaaa078c &lt;+56&gt;:    cmp w1, w0\n   0x0000aaaaaaaa0790 &lt;+60&gt;:    b.lt    0xaaaaaaaa0768 &lt;func+20&gt;  // b.tstop\n\n8       {\n9           sum+=i;\n   0x0000aaaaaaaa0768 &lt;+20&gt;:    ldr w1, [sp, #24]\n   0x0000aaaaaaaa076c &lt;+24&gt;:    ldr w0, [sp, #28]\n   0x0000aaaaaaaa0770 &lt;+28&gt;:    add w0, w1, w0\n   0x0000aaaaaaaa0774 &lt;+32&gt;:    str w0, [sp, #24]\n\n10      }\n11      return sum;\n   0x0000aaaaaaaa0794 &lt;+64&gt;:    ldr w0, [sp, #24]\n\n12  }\n   0x0000aaaaaaaa0798 &lt;+68&gt;:    add sp, sp, #0x20\n   0x0000aaaaaaaa079c &lt;+72&gt;:    ret\n\nEnd of assembler dump.\n</code></pre> <p><code>-r</code> \u9009\u9879\u4ee5\u5341\u516d\u8fdb\u5236\u663e\u793a\u539f\u59cb\u673a\u5668\u6307\u4ee4\uff08raw instructions\uff09\uff0c\u4e0d\u663e\u793a\u6e90\u4ee3\u7801\uff1a</p> <pre><code>(gdb) disas /r func\nDump of assembler code for function func:\n   0x0000000000000754 &lt;+0&gt;: ff 83 00 d1 sub sp, sp, #0x20\n   0x0000000000000758 &lt;+4&gt;: e0 0f 00 b9 str w0, [sp, #12]\n   0x000000000000075c &lt;+8&gt;: ff 1b 00 b9 str wzr, [sp, #24]\n   0x0000000000000760 &lt;+12&gt;:    ff 1f 00 b9 str wzr, [sp, #28]\n   0x0000000000000764 &lt;+16&gt;:    08 00 00 14 b   0x784 &lt;func+48&gt;\n   0x0000000000000768 &lt;+20&gt;:    e1 1b 40 b9 ldr w1, [sp, #24]\n   0x000000000000076c &lt;+24&gt;:    e0 1f 40 b9 ldr w0, [sp, #28]\n   0x0000000000000770 &lt;+28&gt;:    20 00 00 0b add w0, w1, w0\n   0x0000000000000774 &lt;+32&gt;:    e0 1b 00 b9 str w0, [sp, #24]\n   0x0000000000000778 &lt;+36&gt;:    e0 1f 40 b9 ldr w0, [sp, #28]\n   0x000000000000077c &lt;+40&gt;:    00 04 00 11 add w0, w0, #0x1\n   0x0000000000000780 &lt;+44&gt;:    e0 1f 00 b9 str w0, [sp, #28]\n   0x0000000000000784 &lt;+48&gt;:    e1 1f 40 b9 ldr w1, [sp, #28]\n   0x0000000000000788 &lt;+52&gt;:    e0 0f 40 b9 ldr w0, [sp, #12]\n   0x000000000000078c &lt;+56&gt;:    3f 00 00 6b cmp w1, w0\n   0x0000000000000790 &lt;+60&gt;:    cb fe ff 54 b.lt    0x768 &lt;func+20&gt;  // b.tstop\n   0x0000000000000794 &lt;+64&gt;:    e0 1b 40 b9 ldr w0, [sp, #24]\n   0x0000000000000798 &lt;+68&gt;:    ff 83 00 91 add sp, sp, #0x20\n   0x000000000000079c &lt;+72&gt;:    c0 03 5f d6 ret\n</code></pre>","tags":["gdb","disassemble"]},{"location":"blog/20200209/6-gdb-debug-assembly/#auto_display","title":"auto display","text":"<p>10 Examining Data - 10.8 Automatic Display</p> <p>Using gdb for Assembly Language Debugging</p> <p>\u5728 Stopping and Continuing \u4e2d\uff0c\u6211\u4eec\u60f3\u5355\u6b65\u8ddf\u8e2a\u8c03\u8bd5\u7b2c 19 \u884c for \u5faa\u73af\u4f53\u7684\u673a\u5668\u6307\u4ee4\uff0c\u6bcf\u6b21 si \u540e\u90fd\u8981\u6267\u884c <code>disas /m func</code> \u67e5\u770b pc \u7bad\u5934\u6307\u5411\u5f53\u524d\u8fd0\u884c\u5230\u4e86\u90a3\u4e00\u6761\u673a\u5668\u6307\u4ee4\u3002\u6709\u6ca1\u6709\u529e\u6cd5\u5728 GDB \u63a7\u5236\u53f0\u4e2d\u540c\u6b65\u663e\u793a\u5f53\u524d\u6e90\u7801\u53ca\u5176\u5bf9\u5e94\u7684\u673a\u5668\u6307\u4ee4\u5462\uff1f</p> <p>\u683c\u5f0f i \u548c s \u540c\u6837\u88ab display \u652f\u6301\uff0c\u4e00\u4e2a\u975e\u5e38\u6709\u7528\u7684\u547d\u4ee4\u662f\uff1a</p> <pre><code>display/i $pc\n</code></pre> <p>$pc \u662f GDB \u7684\u73af\u5883\u53d8\u91cf\uff0c\u8868\u793a\u7740\u6307\u4ee4\u7684\u5730\u5740\uff0c/i \u5219\u8868\u793a\u8f93\u51fa\u683c\u5f0f\u4e3a\u673a\u5668\u6307\u4ee4\u7801\uff0c\u4e5f\u5c31\u662f\u6c47\u7f16\u3002</p> <p>\u4e8e\u662f\uff0c\u5f53\u7a0b\u5e8f\u505c\u4e0b\u540e\uff0c\u5c31\u4f1a\u51fa\u73b0\u6e90\u4ee3\u7801\u548c\u673a\u5668\u6307\u4ee4\u7801\u76f8\u5bf9\u5e94\u7684\u60c5\u5f62\uff0c\u8fd9\u662f\u4e00\u4e2a\u5f88\u6709\u610f\u601d\u7684\u529f\u80fd\u3002</p> <p>gdb test-gdb \u540e\uff0c\u8bbe\u7f6e\u81ea\u52a8\u6253\u5370 pc\uff0c\u8bbe\u7f6e\u51fd\u6570\u65ad\u70b9\uff08b func\uff09\uff0c\u7136\u540e\u6267\u884c <code>start</code> \u542f\u52a8\u8fd0\u884c\uff08\u505c\u6b62\u5728 main \u51fd\u6570\uff09\u3002</p> <pre><code># \u8bbe\u7f6e\u81ea\u52a8\u6253\u5370 pc\n(gdb) display/i $pc\n1: x/i $pc\n&lt;error: No registers.&gt;\n\n# \u8bbe\u7f6e\u51fd\u6570\u65ad\u70b9\n(gdb) b func\nBreakpoint 1 at 0x75c: file test-gdb.c, line 5.\n\n# \u542f\u52a8\u8fd0\u884c\uff08tbreak main\uff09\n(gdb) start\nTemporary breakpoint 2 at 0x7b0: file test-gdb.c, line 16.\nStarting program: /home/pifan/Projects/cpp/test-gdb\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/aarch64-linux-gnu/libthread_db.so.1\".\n\nTemporary breakpoint 2, main (argc=1, argv=0xfffffffff358) at test-gdb.c:16\n16      long result = 0;\n1: x/i $pc\n=&gt; 0xaaaaaaaa07b0 &lt;main+16&gt;:    str xzr, [sp, #40]\n</code></pre> <p>\u6267\u884c <code>continue</code> \u8fd0\u884c\u5230\u4e0b\u4e00\u4e2a\u65ad\u70b9\uff0c\u5373 func \u51fd\u6570\u65ad\u70b9\uff0c\u8fd0\u884c\u81f3\u51fd\u6570\u4f53\u4e2d\u7684\u7b2c\u4e00\u6761\u8bed\u53e5\u3002</p> <pre><code># continue to next breakpoint\n(gdb) c\nContinuing.\nresult[1-100] = 5050\n\nBreakpoint 1, func (n=250) at test-gdb.c:5\n5       int sum=0,i;\n1: x/i $pc\n=&gt; 0xaaaaaaaa075c &lt;func+8&gt;: str wzr, [sp, #24]\n</code></pre> <p>\u6267\u884c <code>next</code> \u8fd0\u884c\u5230 func \u51fd\u6570\u4e2d\u7684 for \u5faa\u73af\u6761\u4ef6\u8bed\u53e5\u3002</p> <pre><code># execute for-control instruction 1\n(gdb) n\n6       for(i=0; i&lt;n; i++)\n1: x/i $pc\n=&gt; 0xaaaaaaaa0760 &lt;func+12&gt;:    str wzr, [sp, #28]\n\n# next to for-body, execute instruction 1\n</code></pre> <p>\u518d\u6267\u884c <code>next</code> \u8fd0\u884c\u5230 func \u51fd\u6570\u4e2d\u7684 for \u5faa\u73af\u4f53\u8bed\u53e5\uff08\u6682\u505c\u5728\u7b2c 1 \u6761\u6307\u4ee4\uff09\uff0c\u7136\u540e si 3 \u6b21\u6267\u884c\u5b8c\u5faa\u73af\u4f53\u5269\u4e0b\u7684\u6307\u4ee4\u3002</p> <pre><code># next stops at the first instruction of for-body source line\n(gdb) n\n8           sum+=i;\n1: x/i $pc\n=&gt; 0xaaaaaaaa0768 &lt;func+20&gt;:    ldr w1, [sp, #24]\n\n# si execute for-body instruction 2\n(gdb) si\n0x0000aaaaaaaa076c  8           sum+=i;\n1: x/i $pc\n=&gt; 0xaaaaaaaa076c &lt;func+24&gt;:    ldr w0, [sp, #28]\n\n# si execute for-body instruction 3\n(gdb)\n0x0000aaaaaaaa0770  8           sum+=i;\n1: x/i $pc\n=&gt; 0xaaaaaaaa0770 &lt;func+28&gt;:    add w0, w1, w0\n\n# si execute for-body instruction 4\n(gdb)\n0x0000aaaaaaaa0774  8           sum+=i;\n1: x/i $pc\n=&gt; 0xaaaaaaaa0774 &lt;func+32&gt;:    str w0, [sp, #24]\n\n# si execute for-control instruction 1\n(gdb)\n6       for(i=0; i&lt;n; i++)\n1: x/i $pc\n=&gt; 0xaaaaaaaa0778 &lt;func+36&gt;:    ldr w0, [sp, #28]\n</code></pre> <p>si \u5355\u6b65\u8ddf\u8e2a C \u8bed\u53e5 <code>sum += i</code>\uff0c\u6bcf\u6b21\u81ea\u52a8\u6253\u5370\u8be5\u6b65\u8fd0\u884c\u7684\u673a\u5668\u6307\u4ee4\uff0c\u8fd9\u6b63\u662f\u6211\u4eec\u9884\u671f\u7684\u8c03\u8bd5\u6548\u679c\u3002</p>","tags":["gdb","disassemble"]},{"location":"blog/20200209/6-gdb-debug-assembly/#tui_layout","title":"tui layout","text":"<p>25.5 TUI-specific Commands</p> <p>gdb\u8c03\u8bd5\u7684layout\u4f7f\u7528</p> <p><code>show tui</code> \u53ef\u4ee5\u67e5\u770b TUI \u914d\u7f6e\u53d8\u91cf\uff08configuration variables\uff09\u3002</p> <p><code>tui enable</code> / <code>tui disable</code>: \u5f00\u542f\u8fdb\u5165 / \u7981\u7528\u9000\u51fa TUI \u6a21\u5f0f\u3002</p> <pre><code>(gdb) help tui\nText User Interface commands.\n\nList of tui subcommands:\n\ntui disable -- Disable TUI display mode.\ntui enable -- Enable TUI display mode.\ntui new-layout -- Create a new TUI layout.\ntui reg -- TUI command to control the register window.\n\nType \"help tui\" followed by tui subcommand name for full documentation.\nType \"apropos word\" to search for commands related to \"word\".\nType \"apropos -v word\" for full documentation of commands related to \"word\".\nCommand name abbreviations are allowed if unambiguous.\n</code></pre> <p>\u6267\u884c <code>tui enable</code> \u8fdb\u5165 TUI \u6a21\u5f0f\uff0c\u8be5\u6a21\u5f0f\u4e3b\u8981\u6d89\u53ca\u5230 src\uff08\u6e90\u7801\uff09\u3001asm\uff08\u6c47\u7f16\uff09\u3001status\uff08\u72b6\u6001\u6761\uff09 \u548c cmd\uff08\u547d\u4ee4\uff09\u56db\u4e2a\u7a97\u53e3\uff08win\uff09\u3002</p> <p>\u6267\u884c <code>info win</code> \u53ef\u4ee5\u5217\u4e3e\u5f53\u524d\u663e\u793a\u7684\u7a97\u53e3\uff08win\uff09\uff0c\u9ed8\u8ba4\u6253\u5f00 src \u6e90\u7801\u7a97\u53e3\uff0c\u4e2d\u95f4\u662f status \u72b6\u6001\u680f\uff0c\u5e95\u4e0b\u662f cmd \u7a97\u53e3\u90e8\u5206\u3002</p> <pre><code>(gdb) info win\nName   Lines Columns Focus\nsrc    34    100     (has focus)\nstatus 1     100\ncmd    18    100\n</code></pre> <p>\u6267\u884c <code>layout</code> \u547d\u4ee4\u53ef\u4ee5\u5207\u6362\u7a97\u53e3\u5e03\u5c40\uff1a</p> <pre><code>(gdb) help layout\nChange the layout of windows.\nUsage: layout prev | next | LAYOUT-NAME\n\nList of layout subcommands:\n\nlayout asm -- Apply the \"asm\" layout.\nlayout next -- Apply the next TUI layout.\nlayout prev -- Apply the previous TUI layout.\nlayout regs -- Apply the TUI register layout.\nlayout split -- Apply the \"split\" layout.\nlayout src -- Apply the \"src\" layout.\n\nType \"help layout\" followed by layout subcommand name for full documentation.\nType \"apropos word\" to search for commands related to \"word\".\nType \"apropos -v word\" for full documentation of commands related to \"word\".\nCommand name abbreviations are allowed if unambiguous.\n</code></pre> <p><code>tui enable</code> \u4f7f\u80fd TUI \u6a21\u5f0f\u540e\uff0c\u76f8\u5f53\u4e8e <code>layout src</code>\u3002\u6211\u4eec\u53ef\u4ee5\u6539\u53d8\u7a97\u53e3\u5e03\u5c40\uff1a</p> <ul> <li><code>layout asm</code> \u6253\u5f00\u6c47\u7f16\u4ee3\u7801\u3002</li> <li><code>layout split</code> \u540c\u65f6\u6253\u5f00 src \u548c asm\uff08\u4e0a\u4e0b\u7a97\u683c\u5e03\u5c40\uff09\u3002</li> </ul> <p>\u5728 src \u7a97\u53e3\uff0c<code>layout next</code> \u4f9d\u6b21\u5207\u6362\u5230 asm\u3001src+asm\uff08\u4e0a\u4e0b\u5e03\u5c40\uff09\u3001regs+src\uff08\u4e0a\u4e0b\u5e03\u5c40\uff09\u3001regs+asm\uff08\u4e0a\u4e0b\u5e03\u5c40\uff09\u3002</p> <p>\u5728 split \u6a21\u5f0f\u4e0b\uff0c\u540c\u6b65\u663e\u793a src+asm\uff0c\u975e\u5e38\u65b9\u4fbf ni/si \u5355\u6b65\u8ddf\u8e2a\u8c03\u8bd5\u673a\u5668\u6307\u4ee4\u3002</p> <p>\u5728 TUI \u6a21\u5f0f\u4e0b\uff0c\u53ef\u4ee5\u6267\u884c <code>[tui] focus name</code> \u5207\u6362\u7a97\u53e3\u7126\u70b9\u3002</p> <p>Changes which TUI window is currently active for scrolling.</p> <p>\u6267\u884c <code>tui disable</code> \u9000\u51fa TUI \u6a21\u5f0f\uff0c\u8fd4\u56de GDB \u63a7\u5236\u53f0\uff08console interpreter\uff09\u3002</p> <ul> <li>ctrl + l(ell)\uff1a\u5237\u65b0\u7a97\u53e3</li> <li>ctrl + x\uff0c\u518d\u63091\uff1a\u5355\u7a97\u53e3\u6a21\u5f0f</li> <li>ctrl + x\uff0c\u518d\u63092\uff1a\u53cc\u7a97\u53e3\u6a21\u5f0f</li> <li>ctrl + x\uff0c\u518d\u6309a\uff1a\u9000\u51fa TUI \u6a21\u5f0f</li> </ul>","tags":["gdb","disassemble"]},{"location":"blog/20171018/000-vim-references/","title":"vim\u53c2\u8003","text":"<p>Mac OS X\u4e0b\u63a8\u8350\u539f\u751fvim</p> <p>macOS \u81ea\u5e26\u7684 Terminal + screen + vim\u3002</p> <p>Terminal \u662f\u4ee3\u66ff iTerm2\uff0cscreen \u662f\u4ee3\u66ff tmux \uff0cvim \u662f\u4ee3\u66ff MacVim\u3002</p> <p>\u81f3\u4e8e shell \u7528\u7684\u662f\u9ed8\u8ba4\u7684 <code>bash</code>\uff08\u4ee3\u66ff <code>zsh</code>\uff0c\u6216\u8005 <code>fishshell</code>\uff09\uff0cscreen \u548c vim \u7684\u914d\u7f6e\u90fd\u662f\u9ed8\u8ba4\u7684\u3002</p> <p>\u5173\u4e8e vim \u7684\u63d2\u4ef6\u7ba1\u7406\uff0c\u53ef\u9009 <code>Vundle.vim</code>\u3002</p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#vim","title":"vim","text":"<p>vim.org vim docs Vim Tips Wiki </p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#macvim","title":"MacVim","text":"<p>MBP\u7cfb\u7edf\u91cd\u88c5\u8bb0\u5f55 Mac\u4e2d\u5b89\u88c5Vim7.4 \u7f16\u8bd1\u5347\u7ea7Mac\u4e0a\u7684vim\u52307.4 huge\u7248 </p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#vi\u4e2d\u6587\u4e71\u7801\u95ee\u9898","title":"vi\u4e2d\u6587\u4e71\u7801\u95ee\u9898","text":"<p>Vi/Vim\u4e2d\u6587\u4e71\u7801\u95ee\u9898 vim\u7ec8\u7aef\u4e0b\u4e2d\u6587\u4e71\u7801\u95ee\u9898 vi \u4e2d\u6587\u663e\u793a\u4e71\u7801-\u95ee\u9898\u89e3\u51b3 linux\u4e2dvi\u663e\u793a\u4e2d\u6587\u4e71\u7801\u7684\u95ee\u9898 Vim \u4e2d\u6587\u4e71\u7801\u5904\u7406\u8fc7\u7a0b \u5f7b\u5e95\u89e3\u51b3Git\u4e2d\u6587\u4e71\u7801\u95ee\u9898</p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#\u5de5\u5177\u6bd4\u8f83","title":"\u5de5\u5177\u6bd4\u8f83","text":"<p>The Vim repository at GitHub Sublime Text 2\u548c\u5bf9Vim\u7684\u7814\u7a76 Windows\u4e0bvim\u65b9\u5f0f\u64cd\u4f5c\u8f6f\u4ef6+Gvim\u4f7f\u7528 ViEmu - Vi/vim emulation for Visual Studio, Xcode, Word, Outlook &amp; SQL Server </p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#\u914d\u8272\u4e3b\u9898","title":"\u914d\u8272\u4e3b\u9898","text":"<p>10 \u4e2a\u4f60\u503c\u5f97\u62e5\u6709\u7684 Vim \u914d\u8272\u65b9\u6848 The Ultimate Vim Distribution vgod/vimrc kaochenlong/eddie-vim </p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#vim_plugin","title":"vim plugin","text":"<p>vim-addon-manager vim addon manager \u5b89\u88c5\u4f7f\u7528 vim-addon-manager - \u6709\u6548\u7684\u7ba1\u7406\u4f60\u7684vim\u63d2\u4ef6 </p> <p>pathogen \u4f7f\u7528pathogen\u7ba1\u7406Vim\u63d2\u4ef6\u5e76\u6258\u7ba1\u5230Github </p> <p>vundle vim-plug </p> <p>Vim\u5341\u5927\u5fc5\u5907\u63d2\u4ef6 \u6709\u54ea\u4e9b\u597d\u7528\u5230\u7206\u7684vim\u63d2\u4ef6\uff1f Vim \u5b9e\u7528\u63d2\u4ef6\u63a8\u8350\uff082017\uff09 </p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#vim-instant-markdown","title":"vim-instant-markdown","text":"<p>Vim\u6742\u8bb0\uff1amarkdown\u63d2\u4ef6 Vim \u73af\u5883\u4e0b Markdown \u63d2\u4ef6\u63a8\u8350 vim-instant-markdown \u4f7f\u7528vim\u7f16\u5199markdown\u6587\u6863 \u5728vim\u4e2d\u914d\u7f6emarkdown\u8bed\u6cd5\u9ad8\u4eae VST : Vim reStructured Text </p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#vim\u6559\u7a0b","title":"vim\u6559\u7a0b","text":"<p>Linux\u4e2dvi/vim\u64cd\u4f5c \u666e\u901a\u4eba\u7684\u7f16\u8f91\u5229\u5668\u2014\u2014Vim </p> <p>Vim\u5165\u95e8\u6559\u7a0b vim \u7684\u4f7f\u7528\u65b9\u6cd5 </p> <p>Vim zh-cn:\u6253\u5b57\u6280\u5de7 </p> <p>vi\u547d\u4ee4\u8be6\u89e3 vim\u4f7f\u7528\u6280\u5de7 \u6700\u4f73vim\u6280\u5de7 \u9ad8\u6548\u7387\u5730\u4f7f\u7528VIM \u7b80\u660e VIM \u7ec3\u7ea7\u653b\u7565 VIM\u7ec8\u6781\u4f7f\u7528\u6280\u5de7 \u8ddf\u6211\u4e00\u8d77\u5b66\u4e60VIM - vim\u63d2\u4ef6\u5408\u96c6 \u6280\u5de7\uff1a\u5feb\u901f\u63d0\u9ad8 Vi/Vim \u4f7f\u7528\u6548\u7387\u7684\u539f\u5219\u4e0e\u9014\u5f84 </p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#vim\u4e13\u9898","title":"vim\u4e13\u9898","text":"<p>Vimer\u7684\u7a0b\u5e8f\u4e16\u754c vim\u9ad8\u7ea7\u7f16\u8f91 Daily Vim Devotional \u6bcf\u65e5\u4e00Vim vi/vim\u4f7f\u7528\u8fdb\u9636 \u8001\u53f8\u673a\u4e71\u8c08\u7f16\u8f91\u5668\u4e4b\u795e\u2014\u2014vim </p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#vim\u914d\u7f6eide","title":"vim\u914d\u7f6eIDE","text":"<p>SpaceVim @github</p> <p>\u50cf IDE \u4e00\u6837\u4f7f\u7528 vim \u8c01\u8bf4Vim\u4e0d\u662fIDE\uff1f\uff08\u4e00\uff09\uff08\u4e8c\uff09\uff08\u4e09\uff09 \u914d\u7f6evim\u8ba9\u7f16\u7a0b\u66f4\u968f\u610f\uff1a1 2 vim\u4e4bIDE\u8fdb\u5316\u5b9e\u5f55 \u624b\u628a\u624b\u6559\u4f60\u628aVim\u6539\u88c5\u6210\u4e00\u4e2aIDE\u7f16\u7a0b\u73af\u5883(\u56fe\u6587) 10\u6b3e\u4f18\u79c0Vim\u63d2\u4ef6\u5e2e\u4f60\u6253\u9020\u5b8c\u7f8eIDE </p> <p>\u628aVIM\u6253\u9020\u6210\u4e00\u4e2a\u771f\u6b63\u7684IDE(1) \u628aVIM\u6253\u9020\u6210\u4e00\u4e2a\u771f\u6b63\u7684IDE(2) \u628aVIM\u6253\u9020\u6210\u4e00\u4e2a\u771f\u6b63\u7684IDE(3) </p>","tags":["vim"]},{"location":"blog/20171018/000-vim-references/#vim\u53c2\u8003\u4e66\u7c4d","title":"vim\u53c2\u8003\u4e66\u7c4d","text":"<p>A Byte of Vim\uff1a@github / @gitbook /\u300a\u54c1\u5473Vim\u300b\u300a\u7b80\u660eVim\u6559\u7a0b\u300b Practical Vim\uff1a\u300aVim\u5b9e\u7528\u6280\u5de7\u300b\u300aVim\u5b9e\u7528\u6280\u5de7\u300b \u9ce5\u54e5\u7684 Linux \u79c1\u623f\u83dc\uff1a\u7b2c\u4e5d\u7ae0\u3001vim \u7a0b\u5f0f\u7de8\u8f2f\u5668 </p>","tags":["vim"]},{"location":"blog/20171018/001-vim-key-notation/","title":"vim\u952e\u4f4d","text":"<p>\u5728 vim \u5e95\u884c\u6a21\u5f0f\u8f93\u5165 <code>:h key-notation</code> \u53ef\u4ee5\u67e5\u770b vimdoc \u7684\u6807\u8bb0\u4f53\u4f8b\uff08intro.txt\uff09\u3002</p> <p>\u672c\u6587\u5305\u62ec\u7ed9\u7a0b\u5f0f\u8bbe\u8ba1\u5e08\u7684Vim\u5165\u95e8\u56fe\u89e3\u8bf4\u660e\u3001Vi/Vim \u952e\u76d8\u56fe\u7b49 Cheat-Sheet\u3002</p> <pre><code>                                        *key-notation* *key-codes* *keycodes*\nThese names for keys are used in the documentation.  They can also be used\nwith the \":map\" command (insert the key name by pressing CTRL-K and then the\nkey you want the name for).\n\nnotation        meaning             equivalent  decimal value(s)      \n-----------------------------------------------------------------------\n&lt;Nul&gt;           zero                    CTRL-@    0 (stored as 10) *&lt;Nul&gt;*\n&lt;BS&gt;            backspace               CTRL-H    8     *backspace*\n&lt;Tab&gt;           tab                     CTRL-I    9     *tab* *Tab*\n                                                        *linefeed*\n&lt;NL&gt;            linefeed                CTRL-J   10 (used for &lt;Nul&gt;)\n&lt;FF&gt;            formfeed                CTRL-L   12     *formfeed*\n&lt;CR&gt;            carriage return         CTRL-M   13     *carriage-return*\n&lt;Return&gt;        same as &lt;CR&gt;                            *&lt;Return&gt;*\n&lt;Enter&gt;         same as &lt;CR&gt;                            *&lt;Enter&gt;*\n&lt;Esc&gt;           escape                  CTRL-[   27     *escape* *&lt;Esc&gt;*\n\n&lt;Up&gt;            cursor-up                       *cursor-up* *cursor_up*\n&lt;Down&gt;          cursor-down                     *cursor-down* *cursor_down*\n&lt;Left&gt;          cursor-left                     *cursor-left* *cursor_left*\n&lt;Right&gt;         cursor-right                    *cursor-right* *cursor_right*\n\n&lt;S-...&gt;         shift-key                       *shift* *&lt;S-*\n&lt;C-...&gt;         control-key                     *control* *ctrl* *&lt;C-*\n&lt;M-...&gt;         alt-key or meta-key             *meta* *alt* *&lt;M-*\n&lt;A-...&gt;         same as &lt;M-...&gt;                 *&lt;A-*\n</code></pre> <p>\u5728 vim \u5e2e\u52a9 txt \u6587\u6863\u4e2d\uff0c\u4ee5 <code>*</code> \u6807\u6ce8\u7684\u4e3a\u7d22\u5f15\u5173\u952e\u5b57\uff0c\u4f8b\u5982\u53f3\u4e0a\u89d2\u7684 <code>*key-notation*</code>\u3001<code>*key-codes*</code>\u3001<code>*keycodes*</code>\uff0c\u4ee5\u53ca <code>*&lt;Return&gt;*</code>\u3001 <code>*&lt;Enter&gt;*</code>\u3001 <code>*&lt;Esc&gt;*</code>\u3001 <code>*cursor-up*</code>\u3001 <code>*shift* *</code>\u3001 <code>*control*</code>\u3001 <code>*meta*</code>\u3002</p> <p>\u8f93\u5165 <code>:h h</code>\u3001<code>:h j</code>\u3001<code>:h k</code>\u3001<code>:h l</code> \u5206\u522b\u67e5\u770b\u5e38\u89c4\u6a21\u5f0f\u4e0b h/j/k/l \u5355\u6309\u952e\u7684\u4f5c\u7528\uff0c\u5b9a\u4f4d\u5230\u5149\u6807\u79fb\u52a8\u6240\u5728\u8bf4\u660e\u6587\u6863 motion.txt \u4e2d\u3002  </p> <p><code>CTRL-W_w</code>\uff08\u540c\u65f6\u6309\u4e0b Ctrl \u548c w\uff0c\u518d\u6309\u4e0b w\uff09\u53ef\u7b80\u5199\u6807\u8bb0\u4e3a<code>&lt;C-w&gt;w</code>\uff08bash manual page \u4e2d\u4e5f\u60ef\u7528\u6b64\u7c7b emacs \u98ce\u683c\u6807\u8bb0\u7ec4\u5408\u5feb\u6377\u952e\uff09\u3002 \u4f46\u662f\u53ea\u80fd\u901a\u8fc7\u8f93\u5165 <code>:h CTRL-W_w</code>\uff08\u7b49\u4ef7\u4e8e <code>:h CTRL-W_CTRL-W</code>\uff09\u6765\u67e5\u770b\u8be5\u547d\u4ee4\u7684\u5e2e\u52a9\u8bf4\u660e\uff08windows.txt\uff09\uff0c\u800c\u65e0\u6cd5\u901a\u8fc7 <code>:h &lt;C-w&gt;w</code> \u6765\u67e5\u770b\u5e2e\u52a9\u3002 </p> <p>\u53e6\u5916 <code>:h CTRL-R</code> \u53ef\u67e5\u770b normal \u6a21\u5f0f\u4e0b\u7684\u7ec4\u5408\u952e\u5e2e\u52a9\u8bf4\u660e\uff08undo.txt\uff09\uff1b\u800c\u901a\u8fc7 <code>:h c_CTRL-R</code>\uff08\u7b49\u6548 <code>:h c_&lt;C-R&gt;</code>\uff09\u5219\u67e5\u770b\u7684\u662f commandline \u6a21\u5f0f\u4e0b\u7684\u7ec4\u5408\u952e\u5e2e\u52a9\u8bf4\u660e\u3002   </p>","tags":["vim"]},{"location":"blog/20171018/001-vim-key-notation/#cheat-sheet","title":"Cheat-Sheet","text":"<p>Vim cheatsheet Vim Commands Cheat Sheet VIM QUICK REFERENCE CARD </p> <p>Vim Cheat Sheet Vim Cheat Sheet A Great Vim Cheat Sheet </p>","tags":["vim"]},{"location":"blog/20171018/001-vim-key-notation/#\u7ed9\u7a0b\u5f0f\u8bbe\u8ba1\u5e08\u7684vim\u5165\u95e8\u56fe\u89e3\u8bf4\u660e","title":"\u7ed9\u7a0b\u5f0f\u8bbe\u8ba1\u5e08\u7684Vim\u5165\u95e8\u56fe\u89e3\u8bf4\u660e","text":"<p>Graphical vi-vim Cheat Sheet and Tutorial</p>","tags":["vim"]},{"location":"blog/20171018/001-vim-key-notation/#vivim_\u952e\u76d8\u56fe","title":"Vi/Vim \u952e\u76d8\u56fe","text":"<p>vim\u952e\u76d8\u56fe</p> <p></p> <p></p>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/","title":"vim\u521d\u8bc6","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 vim \u7684\u914d\u7f6e\u6587\u4ef6\u53ca\u73af\u5883\u53d8\u91cf\u4ee5\u53ca\u4f7f\u7528 vim \u6253\u5f00\u6587\u4ef6\u548c\u7f16\u8f91\u6587\u4ef6\u7684\u57fa\u7840\u64cd\u4f5c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#where_is_vimon_macos","title":"Where is vim\uff08on macOS\uff09","text":"<pre><code>$ whereis vim\n/usr/bin/vim\n$ ls /usr/bin/vim*              \n/usr/bin/vim      /usr/bin/vimdiff  /usr/bin/vimtutor\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#vim_version","title":"vim version","text":"<p>vim \u4e00\u5171\u6709\u4e94\u79cd\u7248\u672c</p> \u7f29\u5199 \u5168\u79f0 T tiny S small N normal B big H huge <pre><code># macOS\n$ vim --version\nVIM - Vi IMproved 8.0 (2016 Sep 12, compiled Jul 26 2017 19:10:24)\nIncluded patches: 1-503, 505-642\nCompiled by root@apple.com\nNormal version without GUI.  Features included (+) or not (-):\n</code></pre> <p>\u5728 vim \u7f16\u8f91\u6a21\u5f0f\u4e0b\uff0c\u5e95\u884c\u6a21\u5f0f\u8f93\u5165 <code>:version</code> \u4e5f\u53ef\u67e5\u770b vim \u7248\u672c\u4fe1\u606f\u3002</p> <p>macOS \u9ed8\u8ba4\u5b89\u88c5\u7684\u7248\u672c\u662f <code>normal version</code>\uff0c\u540e\u9762\u5217\u51fa\u4e86\u5305\u542b\uff08+\uff09\u548c\u672a\u5305\u542b\uff08-\uff09\u7684features\u3002</p> <p></p> <p>\u56e0\u4e3a vim \u4e2d\u6709\u4e9b\u63d2\u4ef6\u4f1a\u4f7f\u7528 python \u548c ruby\uff0c\u6211\u4eec\u53ef\u4ee5\u7f16\u8bd1\u5347\u7ea7 Mac \u4e0a\u7684 vim \u52307.4 huge\u7248\uff0c\u542f\u7528 python \u548c ruby \u7684\u652f\u6301\u7279\u6027\u3002</p> <p>raspbian \u548c CentOS \u9ed8\u8ba4\u5b89\u88c5\u7684 Huge \u7248\u672c\u3002</p> <pre><code># raspbian\npi@raspberrypi:~ $ vim --version\nVIM - Vi IMproved 8.0 (2016 Sep 12, compiled Sep 30 2017 18:21:38)\nIncluded patches: 1-197, 322, 377-378, 550, 703, 706-707\nModified by pkg-vim-maintainers@lists.alioth.debian.org\nCompiled by pkg-vim-maintainers@lists.alioth.debian.org\nHuge version without GUI.  Features included (+) or not (-):\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#\u914d\u7f6e\u6587\u4ef6\u53ca\u73af\u5883\u53d8\u91cf","title":"\u914d\u7f6e\u6587\u4ef6\u53ca\u73af\u5883\u53d8\u91cf","text":"<p><code>vim --version</code> \u7ed3\u5c3e\u90e8\u5206\u7ed9\u51fa\u4e86\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\uff1a</p> <pre><code># macOS/raspbian\n   system vimrc file: \"$VIM/vimrc\"\n     user vimrc file: \"$HOME/.vimrc\"\n 2nd user vimrc file: \"~/.vim/vimrc\"\n      user exrc file: \"$HOME/.exrc\"\n       defaults file: \"$VIMRUNTIME/defaults.vim\"\n  fall-back for $VIM: \"/usr/share/vim\"\n</code></pre> <ul> <li>fall-back\uff1a\u7f16\u8bd1\u65f6\u6307\u5b9a\u7684\u5b89\u88c5\u8def\u5f84\uff0c\u5373 <code>$VIM</code>=<code>/usr/share/vim</code>\uff1b  </li> <li>\u7cfb\u7edf\u7ea7\u522b\u7684 vim \u914d\u7f6e\u6587\u4ef6\uff1a<code>$VIM/vimrc</code>\uff1b  </li> <li>\u7528\u6237\u7ea7\u522b\u9996\u9009 vim \u914d\u7f6e\u6587\u4ef6\uff1a<code>$HOME/.vimrc</code>\uff1b  </li> <li>\u7528\u6237\u7ea7\u522b\u53ef\u9009 vim \u914d\u7f6e\u6587\u4ef6\uff1a<code>~/.vim/vimrc</code>\uff1b  </li> <li>\u7528\u6237\u7ea7\u522b ex \u914d\u7f6e\u6587\u4ef6\uff1a<code>$HOME/.exrc</code>\uff1b  </li> <li>vim \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff1a<code>$VIMRUNTIME/defaults.vim</code> </li> </ul>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#\u914d\u7f6e\u6587\u4ef6vimrc","title":"\u914d\u7f6e\u6587\u4ef6\uff08vimrc\uff09","text":"<p>\u8bf4\u660e\u6587\u6863 <code>/usr/share/vim/vim[0-9][0-9]/doc/usr_05.txt</code> \u4e2d\u6709\u5173\u4e8e vimrc \u6587\u4ef6\u683c\u5f0f\u8bf4\u660e\u53ca\u914d\u7f6e\u8303\u4f8b\u53ef\u4f9b\u53c2\u8003\uff1a</p> <ul> <li>|05.1|  The vimrc file - <code>:h vimrc-intro</code> </li> <li>|05.2|  The example vimrc file explained : <code>:h vimrc_example.vim</code> </li> </ul> <p>\u8bf4\u660e\u6587\u6863 <code>/usr/share/vim/vim[0-9][0-9]/doc/starting.txt</code> \u4e2d\u7684 4. Initialization\uff08\u5e2e\u52a9\u5173\u952e\u8bcd\u4e3a initialization, startup\uff09\u7ae0\u8282\u4e2d\u6709\u5173\u4e8e\u542f\u52a8\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\uff08<code>vimrc</code>\uff09\u7684\u5e2e\u52a9\u8bf4\u660e\u3002</p> <ul> <li><code>:h vimrc</code>\uff1a\u67e5\u770b vimrc \u76f8\u5173\u7684\u5e2e\u52a9\uff1b  </li> </ul> <p><code>vim[0-9][0-9]</code>\uff1a\u6b64\u5904\u91c7\u7528\u4e24\u4f4d\u5341\u8fdb\u5236\u6570\u5b57\u901a\u914d\u7b26\uff08wildcard\uff09\u6765\u4ee3\u8868\u52a8\u6001\u53d1\u5c55\u7684vim\u7248\u672c\uff0c\u56e0\u4e3avim\u7248\u672c\u662f\u4e0d\u65ad\u5347\u7ea7\u7684\uff0c\u5982 vim73\u3001vim74\u3001vim80\u3002</p>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#\u73af\u5883\u53d8\u91cfvim_\u548c_vimruntime","title":"\u73af\u5883\u53d8\u91cf\uff08<code>$VIM</code> \u548c <code>$VIMRUNTIME</code>\uff09","text":"<p>\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\u4e2d\u5f15\u7528\u4e86 <code>HOME</code> \u548c <code>VIM</code> \u53ca <code>VIMRUNTIME</code> \u8fd9\u4e09\u4e2a\u73af\u5883\u53d8\u91cf\u3002</p> <p><code>HOME</code> \u5373\u901a\u5e38\u6240\u8bf4\u7684\u5f53\u524d\u7528\u6237\u5bb6\u76ee\u5f55\uff08~\uff09\uff0c<code>VIM</code> \u53ef\u5728 vim \u7f16\u8f91\u5668\u5e95\u884c\u6a21\u5f0f\u4e0b\u5229\u7528 echo \u547d\u4ee4\u67e5\u770b\u3002 \u5173\u4e8e <code>$VIM</code> \u548c <code>$VIMRUNTIME</code> \u76f8\u5173\u7684\u8bf4\u660e\u53ef\u53c2\u8003 <code>/usr/share/vim/vim[0-9][0-9]/doc/starting.txt</code> \u4e2d\u7684 4. Initialization\uff08\u5e2e\u52a9\u5173\u952e\u8bcd\u4e3a initialization, startup\uff09\u3002</p> <ul> <li><code>:h $VIM</code>\uff1a\u67e5\u770b\u73af\u5883\u53d8\u91cf <code>$VIM</code> \u76f8\u5173\u7684\u8bf4\u660e\uff1b  </li> <li><code>:h $VIMRUNTIME</code>\uff1a\u67e5\u770b\u73af\u5883\u53d8\u91cf <code>$VIMRUNTIME</code> \u76f8\u5173\u7684\u8bf4\u660e\u3002  </li> </ul> <p>\u5728\u7ec8\u7aef\u8f93\u5165 <code>vim</code>\uff08vim doc\uff09\u8fdb\u5165 vim \u7f16\u8f91\u5668\uff0c\u7136\u540e\u6309\u4e0b Q\uff08<code>&lt;S-q&gt;</code>\uff09\u8fdb\u5165 Ex \u591a\u884c\u547d\u4ee4\u884c\u6a21\u5f0f\uff0c\u4f9d\u6b21\u8f93\u5165 <code>echo $VIM</code> \u548c <code>echo $VIMRUNTIME</code> \u5373\u53ef\u68c0\u67e5 vim \u73af\u5883\u53d8\u91cf\u3002</p> <pre><code># macOS or raspbian\nEntering Ex mode.  Type \"visual\" to go to Normal mode.                        \n:echo $VIM\n/usr/share/vim\n:echo $VIMRUNTIME\n/usr/share/vim/vim80\n</code></pre> <p>\u8f93\u5165 <code>visual</code> \u9000\u51fa Ex \u6a21\u5f0f\uff0c\u56de\u5230\u6b63\u5e38\u6a21\u5f0f\uff1b\u6216\u76f4\u63a5\u8f93\u5165 q \u9000\u51fa vim\u3002</p> <p>\u4e5f\u53ef\u5728 vim \u5e95\u884c\u6a21\u5f0f\u8f93\u5165 <code>:! echo $VIM</code> \u6216 <code>:! echo $VIMRUNTIME</code> \u6253\u5370\u8fd9\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\u7684\u503c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#vim_files","title":"vim FILES","text":"<pre><code># macOS\n/usr/share/vim|\u21d2  ls\nvim80 vimrc\n\n# raspbian\npi@raspberrypi:/usr/share/vim $ ls\naddons  registry  vim80  vimfiles  vimrc\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#files","title":"FILES","text":"<p><code>man vim</code> \u7684 FILES \u7ae0\u8282\u5217\u4e3e\u4e86 vim \u914d\u7f6e\u53ca\u8bf4\u660e\u76f8\u5173\u7684\u4e3b\u8981\u6587\u4ef6\uff1a</p> <pre><code># macOS \u7684 man pages \u592a\u8fc7\u9648\u65e7\uff0c\u4ee5\u4e0b\u6458\u81ea raspbian \u7684\u6700\u65b0 vim man page\nFILES\n       /usr/share/vim/vim80/doc/*.txt\n                      The Vim documentation files.  Use \":help doc-file-list\" to get the com\u2010\n                      plete list.\n\n       /usr/share/vim/vim80/doc/tags\n                      The tags file used for finding information in the documentation files.\n\n       /usr/share/vim/vim80/syntax/syntax.vim\n                      System wide syntax initializations.\n\n       /usr/share/vim/vim80/syntax/*.vim\n                      Syntax files for various languages.\n\n       /usr/share/vim/vimrc\n                      System wide Vim initializations.\n\n       ~/.vimrc       Your personal Vim initializations.\n\n       /usr/share/vim/gvimrc\n                      System wide gvim initializations.\n\n       ~/.gvimrc      Your personal gvim initializations.\n\n       /usr/share/vim/vim80/optwin.vim\n                      Script used for the \":options\" command, a nice  way  to  view  and  set\n                      options.\n\n       /usr/share/vim/vim80/menu.vim\n                      System wide menu initializations for gvim.\n\n       /usr/share/vim/vim80/bugreport.vim\n                      Script to generate a bug report.  See \":help bugs\".\n\n       /usr/share/vim/vim80/filetype.vim\n                      Script  to  detect  the  type of a file by its name.  See \":help 'file\u2010\n                      type'\".\n\n       /usr/share/vim/vim80/scripts.vim\n                      Script to detect the type of a file by its contents.  See \":help 'file\u2010\n                      type'\".\n\n       /usr/share/vim/vim80/print/*.ps\n                      Files used for PostScript printing.\n\n       For recent info read the VIM home page:\n       &lt;URL:http://www.vim.org/&gt;\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#directories","title":"directories","text":"<p>\u4ee5\u4e0b\u5217\u4e3e\u4e86 <code>$VIMRUNTIME</code>\uff08vim80\uff09 \u4e0b\u7684\u76ee\u5f55\uff1a</p> <pre><code># ls -al | grep '^d'\n/usr/share/vim/vim80|\u21d2  ls -d */\nautoload/ compiler/ ftplugin/ keymap/   macros/   plugin/   spell/    tools/\ncolors/   doc/      indent/   lang/     pack/     print/    syntax/   tutor/\n\n/usr/share/vim/vim80|\u21d2  tree -d -L 1\n.\n\u251c\u2500\u2500 autoload\n\u251c\u2500\u2500 colors\n\u251c\u2500\u2500 compiler\n\u251c\u2500\u2500 doc\n\u251c\u2500\u2500 ftplugin\n\u251c\u2500\u2500 indent\n\u251c\u2500\u2500 keymap\n\u251c\u2500\u2500 lang\n\u251c\u2500\u2500 macros\n\u251c\u2500\u2500 pack\n\u251c\u2500\u2500 plugin\n\u251c\u2500\u2500 print\n\u251c\u2500\u2500 spell\n\u251c\u2500\u2500 syntax\n\u251c\u2500\u2500 tools\n\u2514\u2500\u2500 tutor\n\n16 directories\n</code></pre> \u76ee\u5f55 \u4f5c\u7528 \u8bf4\u660e tutor \u5165\u95e8\u6559\u7a0b vimtutor doc \u5e2e\u52a9\u6587\u6863 :help colors \u914d\u8272\u65b9\u6848 :colorscheme plugin \u63d2\u4ef6\u76ee\u5f55 Vim Script\u811a\u672c\u683c\u5f0f <p>\u5176\u4e2d <code>*.vim</code> \u4e3a Vim Script \u811a\u672c\u683c\u5f0f\u6587\u4ef6\uff0c\u4f8b\u5982\uff1a</p> <ol> <li> <p>filetype: \u6587\u4ef6\u7c7b\u578b\u68c0\u67e5</p> <p>filetype.vim: detect file types ftoff.vim:    switch off detection of file types</p> </li> <li> <p>ftplugin: \u6587\u4ef6\u7c7b\u578b\u68c0\u67e5\u63d2\u4ef6</p> <p>ftplugin.vim: switch on loading plugins for file types ftplugof.vim: switch off loading plugins for file types</p> </li> <li> <p>indent: \u4e0d\u540c\u8bed\u8a00\u8bed\u6cd5\u7f29\u8fdb</p> <p>indent.vim:   switch on loading indent files for file types indoff.vim:   switch off loading indent files for file types</p> </li> <li> <p>syntax\uff1a\u4e0d\u540c\u8bed\u8a00\u8bed\u6cd5\u9ad8\u4eae\u68c0\u6d4b\u63d2\u4ef6</p> <p>syntax:       c.vim / cpp.vim / objc.vim / objcpp.vim / markdown.vim</p> </li> </ol>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#hi_vim","title":"hi, vim","text":"","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#vim_\u547d\u4ee4\u9009\u9879","title":"vim \u547d\u4ee4\u9009\u9879","text":"<p>\u901a\u5e38\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u4ee5\u6253\u5f00\u7ec8\u7aef\uff0c\u8f93\u5165\ufe30</p> <pre><code>vim tutor &lt;\u56de\u8eca&gt;\n</code></pre> <p>\u9019\u88e1\u7684 vim \u8868\u793a\u9032\u5165vim\u7de8\u8f2f\u5668\u7684\u542f\u52a8\u547d\u4ee4\uff08start the Vim editor\uff09\uff0c\u800c tutor \u5247\u662f\u60a8\u6e96\u5099\u8981\u7de8\u8f2f\u7684\u6587\u4ef6\uff08the file you wish to edit\uff09\u3002</p> <p>\u6267\u884c <code>vim --help</code> \u53ef\u67e5\u770b vim \u547d\u4ee4\u542f\u52a8\u53c2\u6570\u53ca\u9009\u9879\uff1a</p> <pre><code>$ vim -h\nVIM - Vi IMproved 8.0 (2016 Sep 12, compiled Jul 26 2017 19:10:24)\n\nusage: vim [arguments] [file ..]       edit specified file(s)\n   or: vim [arguments] -               read text from stdin\n   or: vim [arguments] -t tag          edit file where tag is defined\n   or: vim [arguments] -q [errorfile]  edit file with first error\n\nArguments:\n   --           Only file names after this\n   -v           Vi mode (like \"vi\")\n   -e           Ex mode (like \"ex\")\n   -E           Improved Ex mode\n   -s           Silent (batch) mode (only for \"ex\")\n   -d           Diff mode (like \"vimdiff\")\n   -y           Easy mode (like \"evim\", modeless)\n   -R           Readonly mode (like \"view\")\n   -Z           Restricted mode (like \"rvim\")\n   -m           Modifications (writing files) not allowed\n   -M           Modifications in text not allowed\n   -b           Binary mode\n   -l           Lisp mode\n   -C           Compatible with Vi: 'compatible'\n   -N           Not fully Vi compatible: 'nocompatible'\n   -V[N][fname]     Be verbose [level N] [log messages to fname]\n   -D           Debugging mode\n   -n           No swap file, use memory only\n   -r           List swap files and exit\n   -r (with file name)  Recover crashed session\n   -L           Same as -r\n   -T &lt;terminal&gt;    Set terminal type to &lt;terminal&gt;\n   --not-a-term     Skip warning for input/output not being a terminal\n   --ttyfail        Exit if input or output is not a terminal\n   -u &lt;vimrc&gt;       Use &lt;vimrc&gt; instead of any .vimrc\n   --noplugin       Don't load plugin scripts\n   -p[N]        Open N tab pages (default: one for each file)\n   -o[N]        Open N windows (default: one for each file)\n   -O[N]        Like -o but split vertically\n   +            Start at end of file\n   +&lt;lnum&gt;      Start at line &lt;lnum&gt;\n   --cmd &lt;command&gt;  Execute &lt;command&gt; before loading any vimrc file\n   -c &lt;command&gt;     Execute &lt;command&gt; after loading the first file\n   -S &lt;session&gt;     Source file &lt;session&gt; after loading the first file\n   -s &lt;scriptin&gt;    Read Normal mode commands from file &lt;scriptin&gt;\n   -w &lt;scriptout&gt;   Append all typed commands to file &lt;scriptout&gt;\n   -W &lt;scriptout&gt;   Write all typed commands to file &lt;scriptout&gt;\n   -x           Edit encrypted files\n   --startuptime &lt;file&gt; Write startup timing messages to &lt;file&gt;\n   -i &lt;viminfo&gt;     Use &lt;viminfo&gt; instead of .viminfo\n   -h  or  --help   Print Help (this message) and exit\n   --version        Print version information and exit\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#_end","title":"+ end","text":"<p>\u8fd0\u884c vim \u5e26 <code>+</code> \u9009\u9879\uff0c\u6253\u5f00\u6587\u4ef6\u5b9a\u4f4d\u5230\u672b\u5c3e\uff0c\u8fd9\u5728\u6d4f\u89c8\u65e5\u5fd7\u6587\u4ef6\u65f6\u6bd4\u8f83\u6709\u7528\u3002</p> <pre><code># \u6253\u5f00\u7cfb\u7edf\u65e5\u5fd7\nvim + /var/log/syslog\nvim + /var/log/cloud-init.log\n\n# \u6253\u5f00nginx\u65e5\u5fd7\nvim + /var/log/nginx/access.log\nvim + /var/log/nginx/error.log\n\n# \u6253\u5f00rclone\u65e5\u5fd7\nvim + ~/.config/rclone/rclone.log\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#vim_\u6253\u5f00\u65b0\u5efa\u7f16\u8f91","title":"vim \u6253\u5f00\uff08\u65b0\u5efa\uff09\u7f16\u8f91","text":"<ol> <li>\u6253\u5f00\u7ec8\u7aef\uff0c\u8f93\u5165 <code>vim hivim.txt</code>\uff08\u5047\u8bbe\u5f53\u524d\u5bb6\u76ee\u5f55\u4e0b\u5c1a\u4e0d\u5b58\u5728 hivim.txt \u6587\u4ef6\uff09\uff0cvim\u9ed8\u8ba4\u4e3a\u666e\u901a\u6a21\u5f0f\uff08normal mode\uff09\u3002vim\u5c06\u4e3a New File\uff08<code>hivim.txt</code>\uff09\u65b0\u5efa\u4e00\u4e2a buffer\uff0c\u6b64\u65f6\u5c1a\u4e0d\u5b58\u5728\u6587\u4ef6 <code>~/hivim.txt</code>\u3002\u5149\u6807\u505c\u7559\u5728\u7b2c\u4e00\u884c\uff0c\u4e0b\u9762\u7684\u6ce2\u6d6a\u7ebf <code>~</code> \u8868\u793a\u7a7a\u884c\u3002     &gt; \u8f93\u5165 CTRL-G \u6216 :f / :fi / :file \u53ef\u5728\u5e95\u90e8\u67e5\u770b\u5f53\u524d\u6253\u5f00\u6587\u6863\u7684\u8def\u5f84\u3002  </li> <li>\u6309\u952e <code>i</code> \u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f\uff08insert mode\uff09\uff0c\u8f93\u5165 <code>hello world from vim!</code>\u3002  </li> <li>\u6309\u4e0b <code>esc</code> \u952e\u76d8\u5207\u56de\u666e\u901a\u6a21\u5f0f\uff0c\u8f93\u5165 <code>:wq</code> \u4fdd\u5b58\u9000\u51fa\uff08write and quit\uff09\u3002  </li> <li>\u8f93\u5165 <code>cat hivim.txt</code> <sup>1</sup> \u67e5\u770b\u521a\u624d\u4f7f\u7528 vim \u65b0\u5efa-\u7f16\u8f91-\u4fdd\u5b58 \u7684\u6587\u4ef6\u3002  </li> </ol> <pre><code>\u279c  ~  cat hivim.txt\ncat: hivim.txt: No such file or directory\n\u279c  ~  vim hivim.txt\n\u279c  ~  cat hivim.txt\nhello world from vim!\n\u279c  ~  \n</code></pre>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#write","title":"write","text":"<p>\u4f7f\u7528 vim \u6253\u5f00 \\&lt;vimfile&gt; \u8fdb\u884c\u7f16\u8f91\u65f6\uff0cvim \u4f1a\u81ea\u52a8\u5728\u5f53\u524d\u6587\u4ef6\u8def\u5f84\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a<code>.&lt;vimfile&gt;.swp</code> \u7684\u7f13\u5b58\u526f\u672c\uff08swap buffer\uff09\uff0c\u6700\u7ec8\u9700\u8981\u8c03\u7528 <code>:w</code>\uff08<code>:write</code>\uff09\u547d\u4ee4\u5c06\u526f\u672c\u4e2d\u7684\u7f16\u8f91\uff08diff\uff09\u5199\u5165\uff08patch\uff09\u6587\u4ef6\u4fdd\u5b58\u3002</p> <p>\u8c03\u7528 <code>vim</code> \u547d\u4ee4\u6253\u5f00\u6587\u4ef6\u65f6\uff0c\u53ef\u4ee5\u6307\u5b9a <code>-n</code> \u9009\u9879\uff0c\u6b64\u65f6\u65e0\u9700\u521b\u5efaswp\u6587\u4ef6\uff0c\u76f4\u63a5\u5728\u5185\u5b58\u4e2d\u9488\u5bf9\u6e90\u6587\u4ef6\u7f16\u8f91\u4fdd\u5b58\u3002</p> <pre><code>   -n           No swap file, use memory only\n</code></pre> <p>\u8c03\u7528 <code>vim -r</code> \u6216 <code>:! vim -r</code> \u547d\u4ee4\u53ef\u4ee5\u5217\u4e3e\u67e5\u770b\u5f53\u524d\u6240\u6709\u7684 swap files\u3002</p> <pre><code>   -r           List swap files and exit\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#vim_\u6253\u5f00\u9605\u8bfb","title":"vim \u6253\u5f00\u9605\u8bfb","text":"","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#\u53ea\u8bfb\u53ef\u5f3a\u5236\u7f16\u8f91\u53ef\u5f3a\u5236\u5199\u5165-r","title":"\u53ea\u8bfb\uff0c\u53ef\u5f3a\u5236\u7f16\u8f91\uff0c\u53ef\u5f3a\u5236\u5199\u5165\uff08-R\uff09","text":"<p><code>vim -R</code> \u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00 <code>/usr/share/vim/vim[0-9][0-9]/tutor/tutor.utf-8</code>\uff1a</p> <pre><code>\u279c  ~  cd /usr/share/vim/vim[0-9][0-9]/tutor\n\u279c  tutor  vim -R tutor.utf-8\n\n\u279c  ~  vim + -R ~/.config/rclone/rclone.log\n</code></pre> <p>\u5f53 vim \u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00\u6587\u4ef6\u65f6\uff1a</p> <ul> <li>\u82e5\u5c1d\u8bd5\u901a\u8fc7<code>i</code>\u3001<code>a</code>\u3001<code>o</code>\u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f\uff0c\u4f1a\u63d0\u793a\uff1a     &gt; Warning: Changing a readonly file  </li> <li>\u7f16\u8f91\u540e\uff0c\u82e5\u5c1d\u8bd5\u901a\u8fc7<code>:q</code>\u9000\u51fa\uff0c\u4f1a\u63d0\u793a\uff1a     &gt; No write since last change (add ! to override)  </li> <li>\u7f16\u8f91\u540e\uff0c\u82e5\u5c1d\u8bd5\u901a\u8fc7<code>:w</code>\u4fdd\u5b58\uff0c\u4f1a\u63d0\u793a\uff1a     &gt; 'readonly' option is set (add ! to override)  </li> </ul> <p>\u4f46\u662f\uff0c\u8fd8\u662f\u53ef\u4ee5\u901a\u8fc7 <code>:wq!</code> \u5f3a\u5236\u5199\u5165\u4fdd\u5b58\u9000\u51fa\u3002</p>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#\u53ef\u7f16\u8f91\u4e0d\u53ef\u5f3a\u5236\u5199\u5165-m","title":"\u53ef\u7f16\u8f91\uff0c\u4e0d\u53ef\u5f3a\u5236\u5199\u5165\uff08-m\uff09","text":"<p>\u5728\u4f7f\u7528 vim \u6253\u5f00\u6587\u6863\u65f6\uff0c\u82e5\u60f3\u9488\u5bf9\u7f13\u51b2\u526f\u672c\uff08*.swp \u6587\u4ef6\uff09\u8fdb\u884c\u7f16\u8f91\uff0c\u4ee5\u4fbf\u8fb9\u5b66\u4e60\u8fb9\u5b9e\u8df5\uff0c\u4f46\u7981\u6b62\u6700\u7ec8\u5199\u5165\u4fdd\u5b58\uff0c\u53ef\u4ee5 <code>-m</code> \u9009\u9879\u6267\u884c vim \u547d\u4ee4\u3002</p> <pre><code>   -m           Modifications (writing files) not allowed\n</code></pre> <p>\u82e5\u5c1d\u8bd5\u901a\u8fc7 <code>:w</code> \u5199\u5165\u6587\u4ef6\uff0c\u4f1a\u63d0\u793a\uff1a</p> <p>File not written: Writing is disabled by 'write' option</p> <p>\u4f8b\u5982\uff0c\u4ee5\u4e0b\u901a\u8fc7 <code>vim -m</code> \u547d\u4ee4\u5bf9\u7167\u9605\u8bfb\u82f1\u6587\u7248 vimtutor\uff08<code>tutor.utf-8</code>\uff09\uff0c\u53ef\u8fb9\u9605\u8bfb\u8fb9\u5b9e\u8df5\uff1a</p> <pre><code>\u279c  ~  vim -m /usr/share/vim/vim[0-9][0-9]/tutor/tutor.utf-8\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/002-vim-gettting-started/#\u53ea\u8bfb\u4e0d\u53ef\u7f16\u8f91\u4e0d\u53ef\u5f3a\u5236\u5199\u5165-m","title":"\u53ea\u8bfb\uff0c\u4e0d\u53ef\u7f16\u8f91\uff0c\u4e0d\u53ef\u5f3a\u5236\u5199\u5165\uff08-M\uff09","text":"<p>\u5982\u679c\u4ec5\u4ec5\u4f7f\u7528 vim \u6253\u5f00\u6587\u6863\u8fdb\u884c\u9605\u8bfb\uff08\u7c7b\u4f3c <code>less</code> \u547d\u4ee4\uff09\uff0c\u4e0d\u53ef\u7f16\u8f91\u4e5f\u4e0d\u53ef\u5199\u5165\uff0c\u5219\u53ef\u4ee5 <code>-M</code> \u9009\u9879\u6267\u884c vim \u547d\u4ee4\u3002</p> <pre><code>   -M           Modifications in text not allowed\n</code></pre> <p>\u82e5\u5c1d\u8bd5\u901a\u8fc7 <code>i</code>\u3001<code>a</code>\u3001<code>o</code> \u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f\uff0c\u4f1a\u63d0\u793a\uff1a</p> <p>Cannot make changes, 'modifiable' is off</p> <p>\u4f8b\u5982\uff0c\u4ee5\u4e0b\u901a\u8fc7 <code>vim -M</code> \u547d\u4ee4\u4ee5\u53ea\u8bfb\u65b9\u5f0f\uff08\u4e0d\u53ef\u7f16\u8f91\uff09\u5bf9\u7167\u9605\u8bfb\u82f1\u6587\u7248vimtutor\uff08<code>tutor.utf-8</code>\uff09\uff1a</p> <pre><code>\u279c  ~  vim -M /usr/share/vim/vim[0-9][0-9]/tutor/tutor.utf-8\n</code></pre> <p>macOS/ubuntu\u4e0b\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00nginx\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code># \u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00nginx\u9ed8\u8ba4\u914d\u7f6e(macOS, ubuntu)\n$ vim -M /usr/local/etc/nginx/nginx.conf.default\n$ vim -M /etc/nginx/nginx.conf\n</code></pre> <p>macOS/ubuntu\u4e0b\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00\u7cfb\u7edf\u65e5\u5fd7\u6587\u4ef6\uff1a</p> <pre><code># \u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00\u7cfb\u7edf\u65e5\u5fd7(macOS, ubuntu)\n$ vim + -M /var/log/system.log\n$ vim + -M /var/log/syslog\n</code></pre> <p>ubuntu\u4e0b\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00\u5176\u4ed6\u7cfb\u7edf\u65e5\u5fd7\uff1a</p> <pre><code># boot.log, kern.log, cron.log, cloud-init.log, etc.\n$ vim + -M /var/log/dmesg\n</code></pre> <p>macOS\u4e0b\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00apache\u65e5\u5fd7\uff1a</p> <pre><code>$ vim + -M /var/log/apache2/access_log\n$ vim + -M /var/log/apache2/error_log\n</code></pre> <p>macOS/ubuntu\u4e0b\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00nginx\u65e5\u5fd7\uff1a</p> <pre><code>$ vim + -M /usr/local/var/log/nginx/access.log\n$ vim + -M /usr/local/var/log/nginx/error.log\n\n$ vim + -M /var/log/nginx/access.log\n$ vim + -M /var/log/nginx/error.log\n</code></pre> <ol> <li> <p>The cat (short for \u201cconcatenate\u201c) command reads one or more files and prints them to standard output.\u00a0\u21a9</p> </li> </ol>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/","title":"vim\u5e2e\u52a9","text":"<p>\u672c\u6587\u68b3\u7406\u4e86\u5982\u4f55\u67e5\u770b vim \u5e2e\u52a9\u624b\u518c\u4ee5\u53ca\u67e5\u8be2\u5e2e\u52a9\u793a\u4f8b\u3002</p>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/#vimtutor","title":"vimtutor","text":"<p>\u7ec8\u7aef\u8f93\u5165 <code>vimtutor</code> \u547d\u4ee4\u53ef\u67e5\u770b vim \u5165\u95e8\u6559\u7a0b\uff1a</p> <pre><code>$ vimtutor \n</code></pre> <p></p> <p>\u8f93\u5165 <code>:q</code> \u9000\u51fa\u3002</p> <p>\u8bf4\u660e\uff1a</p> <p>\u901a\u904e\"vimtutor\"\u4f86\u555f\u52d5\u6559\u7a0b\uff0c\u6bcf\u6b21\u90fd\u4f1a\u751f\u6210\u4e00\u4efd\u526f\u672c\uff0c\u65b9\u4fbf\u8fb9\u5b66\u4e60\u8fb9\u5b9e\u8df5\u3002 \u5e95\u884c\u8f93\u5165 :f / :fi / :file \u5373\u53ef\u67e5\u770b\u5f53\u524d\u6253\u5f00\u7684 tutor \u526f\u672c\u7684\u8def\u5f84\uff1a  </p> <p>/private/var/folders/k6/7f8bh1ws4ygfg9pcq48w5tk00000gn/T/tutor***</p> <p>\u9000\u51fa tutor \u65f6\uff0c\u8be5\u526f\u672c<code>tutor***</code>\u5c06\u4f1a\u88ab\u5220\u9664\u3002</p> <p><code>/usr/share/vim/vim[0-9][0-9]/tutor</code> \u76ee\u5f55\u4e0b\u5b58\u653e\u7740\u591a\u8bed\u8a00\u7248\u672c\u7684\u5e2e\u52a9\u6559\u7a0b\uff0c\u4e2d\u6587 macOS \u7cfb\u7edf\u7ec8\u7aef\u8f93\u5165 <code>vimtutor</code> \u547d\u4ee4\uff0c\u5c06\u6253\u5f00\u5bf9\u5e94\u7e41\u4f53\u4e2d\u6587\u7248\u672c\u300atutor.zh.utf-8\u300b\uff08<code>vimtutor zh</code>\uff09\u7684\u526f\u672c\uff1a</p> <pre><code>\u279c  ~  cd /usr/share/vim/vim[0-9][0-9]/tutor\n\u279c  tutor  vim tutor.zh.utf-8\n\n===============================================================================\n=      \u6b61     \u8fce     \u95b1     \u8b80   \u300a V I M  \u6559  \u7a0b \u300b   \u2500\u2500     \u7248\u672c 1.5      =\n===============================================================================\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>vimtutor en</code> \u6307\u5b9a\u6253\u5f00en\u82f1\u6587\u7248\u300atutor.utf-8\u300b\u6559\u7a0b\uff1a</p> <pre><code>===============================================================================\n=    W e l c o m e   t o   t h e   V I M   T u t o r    -    Version 1.7      =\n===============================================================================\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/#vim_manual","title":"vim manual","text":"<p>\u4ee5\u4e0b\u8282\u9009 vim manual page \u7684\u6982\u8981\uff08SYNOPSIS\uff09\u548c\u63cf\u8ff0\uff08DESCRIPTION\uff09\u7ae0\u8282\uff1a</p> <pre><code>pi@raspberrypi:~ $ man vim\n\nVIM(1)                             General Commands Manual                             VIM(1)\n\nNAME\n       vim - Vi IMproved, a programmers text editor\n\nSYNOPSIS\n       vim [options] [file ..]\n       vim [options] -\n       vim [options] -t tag\n       vim [options] -q [errorfile]\n\n       ex\n       view\n       gvim gview evim eview\n       rvim rview rgvim rgview\n\nDESCRIPTION\n       Vim  is  a  text  editor that is upwards compatible to Vi.  It can be used to edit all\n       kinds of plain text.  It is especially useful for editing programs.\n\n       There are a lot of enhancements above Vi: multi level undo, multi windows and buffers,\n       syntax  highlighting,  command line editing, filename completion, on-line help, visual\n       selection, etc..  See \":help vi_diff.txt\" for a summary of the differences between Vim\n       and Vi.\n\n       While running Vim a lot of help can be obtained from the on-line help system, with the\n       \":help\" command.  See the ON-LINE HELP section below.\n\n       Most often Vim is started to edit a single file with the command\n\n            vim file\n\n       More generally Vim is started with:\n\n            vim [options] [filelist]\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/#vim_doc","title":"vim doc","text":"<p>vim \u7684\u5e2e\u52a9\u8bf4\u660e\u6587\u6863\u5b58\u653e\u5728 <code>/usr/share/vim/vim[0-9][0-9]/doc</code> \u76ee\u5f55\u4e0b\u3002</p> <p>\u53ef\u6267\u884c <code>ls /usr/share/vim/vim[0-9][0-9]/doc</code> \u4e00\u89c8\u5176\u4e0b\u7684\u6240\u6709\u5e2e\u52a9\u6587\u6863\uff08*.txt\uff09\u3002</p> <p>\u5f53\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u7ec8\u7aef Shell Prompt \u4e2d\u8f93\u5165 <code>vim -R /usr/share/vim/vim[0-9][0-9]/doc/*.txt</code>\uff08<code>-R</code>\u9009\u9879\u8868\u793a readonly\uff09\uff0c\u6253\u5f00\u67e5\u770b\u6211\u4eec\u611f\u5174\u8da3\u7684 vim \u8bdd\u9898\u3002</p>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/#\u5143\u5e2e\u52a9\u6587\u6863helphelp","title":"\u5143\u5e2e\u52a9\u6587\u6863\uff08helphelp\uff09","text":"<p>\u6216\u5728 vim \u5e95\u884c\u6a21\u5f0f\u4e0b\u8f93\u5165 <code>:h help</code> \u6216 <code>:help help</code>\uff0cvim \u5c06\u65b0\u8d77\u5206\u5c4f\uff08window\uff09\u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00 <code>/usr/share/vim/vim[0-9][0-9]/doc</code> \u4e2d\u5982\u4f55\u4f7f\u7528\u5e2e\u52a9\u7684\u8bf4\u660e\u6587\u6863 <code>helphelp.txt</code>\uff08\u5e2e\u52a9\u6587\u6863\u7684\u5e2e\u52a9\u6587\u6863\uff09\u3002  </p> <p>\u5173\u4e8e\u201d\u5e95\u884c\u6a21\u5f0f\u201d\uff0c\u53c2\u8003\u4e0b\u4e00\u8282\u3002</p>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/#\u5e2e\u52a9\u6587\u6863help","title":"\u5e2e\u52a9\u6587\u6863\uff08help\uff09","text":"<p>\u6309\u4e0b <code>&lt;F1&gt;</code> \u952e\u6216\u5728 vim \u5e95\u884c\u6a21\u5f0f\u8f93\u5165 <code>:help</code>\uff08<code>:h</code>\uff09\uff0c\u53ef\u4ee5\u67e5\u770b\u5e2e\u52a9\u6587\u6863\u3002 vim \u5c06\u65b0\u8d77\u5206\u5c4f\uff08window\uff09\u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00 <code>/usr/share/vim/vim[0-9][0-9]/doc/help.txt</code> \u6587\u4ef6\u3002  </p> <p>Open a window and display the help file in read-only mode.</p> <p>\u6309\u4e0b\u7ec4\u5408\u952e <code>CTRL-W_w</code>\uff08\u53ef\u7b80\u8bb0\u4e3a<code>&lt;C-w&gt;w</code>\uff1a\u6309\u4e0b <code>ctrl+w</code>\uff0c\u518d\u6309\u4e00\u6b21 <code>w</code>\uff09\uff0c\u53ef\u5728\u5f53\u524d vim \u7a97\u53e3\u548c help \u5206\u5c4f\u7a97\u53e3\u4e4b\u95f4\u5207\u6362\uff1b\u8f93\u5165 <code>\uff1aq</code> \u6216 <code>:close</code> \u53ef\u4ee5\u5173\u95ed\u5e2e\u52a9\u7a97\u53e3\u3002</p> <p>\u5728 VIM - main help file\uff08<code>help.txt</code>\uff09\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u5230 vim \u5e2e\u52a9\u7cfb\u7edf\u7684\u7ec4\u7ec7\u5c42\u6b21\u3002 \u5176\u4e2d\u4e3b\u8981\u5206 <code>USER MANUAL</code> \u548c <code>REFERENCE MANUAL</code> \u4e24\u4e2a\u90e8\u5206\uff1a</p> <ol> <li> <p>USER MANUAL: These files explain how to accomplish an editing task.  </p> <p>Getting Started ~: <code>usr_1*.txt</code> Editing Effectively ~: <code>usr_2*.txt</code> Tuning Vim ~: <code>usr_4*.txt</code> Making Vim Run ~(Installing Vim): <code>usr_90.txt</code> </p> </li> <li> <p>REFERENCE MANUAL: These files explain every detail of Vim.  reference_toc </p> </li> </ol> <p>\u4ee5\u4e0b\u8282\u9009 REFERENCE MANUAL \u90e8\u5206\u8bae\u9898\uff1a</p> <pre><code>General subjects ~\n\n- |intro.txt| general introduction to Vim; notation used in help files  \n- |help.txt|  overview and quick reference (this file)  \n- |helphelp.txt|  about using the help files  \n\nBasic editing ~\n\n- |starting.txt|  starting Vim, Vim command arguments, initialisation  \n- |editing.txt|   editing and writing files  \n- |motion.txt|    commands for moving around  \n</code></pre> <p>\u53ef\u6267\u884c <code>cat</code> \u6216 <code>vim -R</code> \u547d\u4ee4\u6253\u5f00 intro.txt \u6587\u4ef6\u67e5\u770b vim \u4ecb\u7ecd\uff1a</p> <pre><code>Introduction to Vim                                     *ref* *reference*                       \n\n1. Introduction                 |intro|\n2. Vim on the internet          |internet|\n3. Credits                      |credits|\n4. Notation                     |notation|\n5. Modes, introduction          |vim-modes-intro|\n6. Switching from mode to mode  |mode-switching|\n7. The window contents          |window-contents|\n8. Definitions                  |definitions|\n\n==============================================================================\n1. Introduction                                         *intro*\n</code></pre> <p>\u53ef\u6267\u884c <code>cat</code> \u6216 <code>vim -R</code> \u547d\u4ee4\u6253\u5f00 starting.txt \u6587\u4ef6\u67e5\u770b vim \u542f\u52a8\u8bf4\u660e\uff1a</p> <pre><code>Starting Vim                                            *starting*                              \n\n1. Vim arguments                |vim-arguments|\n2. Vim on the Amiga             |starting-amiga|\n3. Running eVim                 |evim-keys|\n4. Initialization               |initialization|\n5. $VIM and $VIMRUNTIME         |$VIM|\n6. Suspending                   |suspend|\n7. Saving settings              |save-settings|\n8. Views and Sessions           |views-sessions|\n9. The viminfo file             |viminfo-file|\n\n==============================================================================\n1. Vim arguments                                        *vim-arguments*\n</code></pre> <p>\u5728 vim txt \u6587\u6863\u4e2d\uff0c\u6bcf\u8282\u6807\u9898\u7684\u53f3\u4fa7\u4ee5 <code>*</code> \u6807\u6ce8\u7684\u4e3a\u7d22\u5f15\u5173\u952e\u5b57\uff0c\u4f8b\u5982 ref\u3001intro\uff0cstarting\u3001vim-arguments\u3002</p>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/#\u641c\u7d22\u5e2e\u52a9search_for_help","title":"\u641c\u7d22\u5e2e\u52a9\uff08Search for help\uff09","text":"<p>help.txt \u4e2d\u4ecb\u7ecd\u4e86\u641c\u7d22\u5e2e\u52a9\u7684\u65b9\u6cd5\uff1a</p> <p>Search for help:  Type \"<code>:help word</code>\", then hit <code>CTRL-D</code> to see matching help entries for \"word\". Or use \"<code>:helpgrep word</code>\".</p> <p>\u5728 vim \u5e95\u884c\u6a21\u5f0f\u8f93\u5165 <code>:h[elp] word</code>\uff0c\u53ef\u641c\u7d22 vim \u4e2d\u5339\u914d\u5173\u952e\u5b57 word \u7684\u547d\u4ee4\u6216\u9009\u9879\u7684\u8bf4\u660e\u6587\u6863\u3002</p>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/#\u67e5\u8be2\u5e2e\u52a9\u793a\u4f8b","title":"\u67e5\u8be2\u5e2e\u52a9\u793a\u4f8b","text":"<ul> <li> <p>\u67e5\u770b <code>vimrc</code> \u76f8\u5173\u7684\u8bdd\u9898\uff1a</p> <p>:h <code>vimrc</code></p> </li> <li> <p>\u67e5\u770b\u5982\u4f55\u4f7f\u7528\u5e2e\u52a9\uff1a</p> <p>:help <code>help</code></p> </li> <li> <p>\u67e5\u770b vimdoc \u7684\u6807\u8bb0\u4f53\u4f8b\uff1a</p> <p>:h <code>key-notation</code></p> </li> <li> <p>\u67e5\u770b <code>h</code> \u6309\u952e\u7684\u4f5c\u7528\uff08motion left\uff09</p> <p>:h <code>h</code></p> </li> <li> <p>\u67e5\u770b <code>w</code> \u6309\u952e\u7684\u4f5c\u7528\uff08words forward\uff09</p> <p>:h <code>w</code></p> </li> <li> <p>\u67e5\u770b\u5e95\u884c\u6a21\u5f0f\u4e0b <code>w</code> \u547d\u4ee4\u7684\u4f5c\u7528\uff08<code>:w</code>/<code>:write</code>\uff09</p> <p>:h <code>:w</code></p> </li> <li> <p>\u67e5\u770b <code>noh</code> \u547d\u4ee4\u7684\u4f5c\u7528\uff08<code>:noh</code>/<code>:nohlsearch</code>\uff09</p> <p>:h <code>noh</code></p> </li> <li> <p>\u67e5\u770b\u590d\u5408\u6309\u952e <code>[[</code> \uff08\u8fde\u6309 [\uff09\u7684\u4f5c\u7528\uff08sections backward\uff09</p> <p>:h <code>[[</code></p> </li> <li> <p>\u67e5\u770b\u6a21\u5f0f\u5207\u6362\u76f8\u5173\u7684\u8bdd\u9898\uff1a</p> <p>:h <code>mode-switching</code> </p> </li> <li> <p>\u67e5\u770b\u591a\u7a97\u683c\u5207\u6362 <code>CTRL-W</code> \u76f8\u5173\u547d\u4ee4\uff1a</p> <p>:h <code>CTRL-W_j[khl]</code> \u6216 :h <code>CTRL-W_CTRL-J[KHL]</code> \uff1aMove cursor to Nth window below/above/left/right current one.  </p> </li> <li> <p>\u5206\u522b\u67e5\u770b <code>CTRL-C</code> \u7ec4\u5408\u6309\u952e\uff08Ctrl+c\uff0c\u53ef\u7b80\u8bb0\u4e3a <code>&lt;C-c&gt;</code>\uff09\u547d\u4ee4\u5728 normal\u3001insert\u3001visual\u3001command-line \u6a21\u5f0f\u4e0b\u7684\u4f5c\u7528\uff1a</p> <p>:help <code>CTRL-C</code> :help <code>i_CTRL-C</code> :help <code>v_CTRL-C</code> :help <code>c_CTRL-C</code> </p> </li> </ul>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/#vimman","title":"vimman","text":"<p>vimman - View vim plugin manuals (help) like man in zsh</p> <p>git clone \u5230 <code>$ZSH_CUSTOM/scripts/vimman</code> \u540e\uff0c\u5728 <code>~/.zshrc</code> \u4e2d source \u8be5 zsh \u811a\u672c\u91cd\u542f\u751f\u6548\u3002</p> <p>\u793a\u4f8b\uff1a<code>vimman number</code> \u67e5\u770b <code>number</code> \u76f8\u5173\u5e2e\u52a9\u4e3b\u9898\uff1a</p> <pre><code>MBP-FAN ~ \u00bb vimman CTRL-W\n:help CTRL-W\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/003-vim-help/#vim\u5728\u7ebf\u5e2e\u52a9","title":"vim\u5728\u7ebf\u5e2e\u52a9","text":"<p>VI(1P) @ Linux man pages online Vim documentations Vim documentation: help </p> <p>\u5982\u4f55\u4f7f\u7528 Vim \u7684 help \u5982\u4f55\u9ad8\u6548\u7684\u4f7f\u7528vim\u7684\u5e2e\u52a9 </p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/","title":"vim\u6a21\u5f0f","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 vim \u7684\u5e38\u7528\u5de5\u4f5c\u6a21\u5f0f\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u4e92\u76f8\u5207\u6362\u3002</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#vim_\u7684\u51e0\u79cd\u6a21\u5f0f","title":"vim \u7684\u51e0\u79cd\u6a21\u5f0f","text":"<p><code>:h vim-modes</code> \u53ef\u67e5\u770b intro.txt \u4e2d vim \u6a21\u5f0f\u76f8\u5173\u7684\u8bf4\u660e\uff1b  </p> <p>vim \u7684\u6a21\u5f0f\u4f17\u591a\uff0c\u4f46\u901a\u5e38\u88ab\u63d0\u53ca\u7684\u4e3b\u8981\u6709\u4ee5\u4e0b\u51e0\u79cd\u3002</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#normal-moden","title":"Normal-mode\uff08n\uff09","text":"<p>\u4e5f\u5c31\u662f\u6700\u4e00\u822c\u7684\u666e\u901a\u6a21\u5f0f\uff0c\u8fdb\u5165 vim \u4e4b\u540e\uff0c\u9ed8\u8ba4\u5904\u4e8e\u8fd9\u79cd\u9605\u8bfb\u6a21\u5f0f\u3002</p> <p>\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\uff0c\u901a\u8fc7\u8f93\u5165\u6307\u4ee4\u53ef\u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f\uff0c\u56e0\u6b64\u6709\u4e9b\u6587\u6863\u4e2d\u4e5f\u5e38\u79f0\u4e3a\uff08\u7b49\u5f85\uff09\u6307\u4ee4\u6a21\u5f0f\uff08command mode\uff09\u3002</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#visual-modev","title":"Visual-mode\uff08v\uff09","text":"<p>\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\uff0c\u6309\u4e0b <code>v</code> \u952e\u8fdb\u5165\u53ef\u89c6\u6a21\u5f0f\uff0c\u5728\u8be5\u6a21\u5f0f\u4e0b\u53ef\u5229\u7528\u65b9\u5411\u952e\u57fa\u4e8e\u5f53\u524d\u5149\u6807\u6269\u6563 \u9009\u5b9a\u9ad8\u4eae \u4e00\u4e9b\u5b57\u7b26\u3001\u884c\u3001\u5217\u3002  </p> <p>\u666e\u901a\u6a21\u5f0f\u4e00\u822c\u53ef\u9488\u5bf9 char\u3001word\u3001line \u8fdb\u884c\u57fa\u672c\u9009\u62e9\u7f16\u8f91/\u5220\u9664\u64cd\u4f5c\uff1b \u53ef\u89c6\u6a21\u5f0f\u53ef\u770b\u505a\u662f \u53ef\u9488\u5bf9\u9009\u5b9a\u5757\u8fdb\u884c\u64cd\u4f5c \u7684\u589e\u5f3a\u6a21\u5f0f\u3002  </p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#insert-modei","title":"Insert-mode\uff08i\uff09","text":"<p>\u63d2\u5165\u6a21\u5f0f\uff0c\u5176\u5b9e\u5c31\u662f\u6307\u53ef\u7f16\u8f91\u8f93\u5165\u72b6\u6001\u3002</p> <p>\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\uff0c\u6309\u4e0b <code>a/A</code>\u3001<code>i/I</code>\u3001<code>o/O</code> \u7b49\u6307\u4ee4\u5373\u53ef\u5207\u6362\u5230\u63d2\u5165\u6a21\u5f0f\uff08Insert Mode\uff09\u3002</p> <p></p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#select-mode_s","title":"Select-mode (s)","text":"<p>gvim \u5e38\u7528\u6a21\u5f0f\uff0c\u59d1\u4e14\u79f0\u4f5c\u9009\u62e9\u6a21\u5f0f\u5427\u3002</p> <p>\u548c\u53ef\u89c6\u6a21\u5f0f\u4e0d\u540c\u7684\u662f\uff0c\u5728\u8fd9\u4e2a\u6a21\u5f0f\u4e0b\uff0c\u9009\u62e9\u5b8c\u4e86\u9ad8\u4eae\u533a\u57df\u540e\uff0c\u6572\u4efb\u4f55\u6309\u952e\u5c31\u76f4\u63a5\u8f93\u5165\u5e76\u66ff\u6362\u9009\u62e9\u7684\u6587\u672c\u4e86\uff0c\u7c7b\u4f3c GUI \u7f16\u8f91\u5668\u4e0b\u57fa\u4e8e\u9f20\u6807\u62d6\u9009\u5757\u66ff\u6362\u7f16\u8f91\u7684\u6548\u679c\u3002  </p> <p>\u7528\u9f20\u6807\u62d6\u9009\u533a\u57df\u7684\u65f6\u5019\uff0c\u5c31\u8fdb\u5165\u4e86\u9009\u62e9\u6a21\u5f0f\u3002 </p> <p>\u666e\u901a\u6a21\u5f0f\u4e0b\u901a\u8fc7 <code>gh</code> \u7ec4\u5408\u952e\u53ef\u8fdb\u5165\u9009\u62e9\u6a21\u5f0f\uff0c\u6309\u4e0b <code>&lt;esc&gt;</code> \u9000\u56de\u5230\u666e\u901a\u6a21\u5f0f\u3002</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#command-line_modecmdline-modec","title":"Command-line mode(Cmdline-mode)\uff08c\uff09","text":"<p>\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\uff0c\u6309\u4e0b <code>:</code>\uff0c<code>/</code>/<code>?</code>\uff0c<code>!</code> \u5c06\u8fdb\u5165\u547d\u4ee4\u884c\u6a21\u5f0f\u3002</p> <p>\u56e0\u4e3a\u662f\u5728\u7a97\u53e3\u5e95\u90e8\uff08bottom prompt\uff09\u652f\u6301\u8f93\u5165\u4e00\u884c\u547d\u4ee4\u8c03\u7528 vim \u7684\u5404\u79cd\u5f3a\u5927\u529f\u80fd\uff0c\u56e0\u6b64\u4e5f\u88ab\u79f0\u4e3a\u5e95\u884c\u6a21\u5f0f\uff08Last-line mode\uff09\u3002</p> <ul> <li><code>:</code>\uff1a\u53ef\u6267\u884c vim \u5185\u7f6e\u547d\u4ee4\uff08Ex commands\uff09\uff0c\u6216 <code>:!</code> \u4e34\u65f6\u6267\u884c bash \u547d\u4ee4\uff1b  </li> <li><code>/</code>,<code>?</code>\uff1a\u53ef\u6267\u884c\u6a21\u5f0f\u5339\u914d\u547d\u4ee4\uff08the pattern search commands\uff09\uff1b  </li> <li><code>!</code>\uff1a\u6267\u884c\u5916\u90e8 shell \u547d\u4ee4\uff08the filter command\uff1f\uff09  </li> </ul> <p>\u6309\u4e0b <code>&lt;Enter&gt;</code> \u952e\u6267\u884c\u547d\u4ee4\u540e\uff0c\u6216\u6309\u4e0b <code>&lt;Esc&gt;</code> / <code>CTRL-C</code>\uff08<code>&lt;C-c&gt;</code>\uff09\uff0c\u5373\u53ef\u9000\u51fa\u5e95\u884c\u6a21\u5f0f\u3002</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#ex-mode","title":"Ex-mode","text":"<p>\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\uff0c\u6309 <code>Q</code>\uff08<code>&lt;S-q&gt;</code>\uff09\u952e\u8fdb\u5165 Ex \u6a21\u5f0f\uff0c\u6267\u884c\u5b8c\u4e00\u884c\u547d\u4ee4\u540e\uff0c\u4f9d\u65e7\u505c\u7559\u5728 Ex-mode\u3002</p> <p>\u8f93\u5165 <code>vi</code>\uff08<code>visual</code>\uff09\u53ef\u5207\u56de\u666e\u901a\u6a21\u5f0f\u3002</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#command-line_history","title":"command-line history","text":"<p>\u5728\u6b63\u5e38\u6a21\u5f0f\u4e0b\uff0c\u8f93\u5165 <code>q:</code> \u5c06\u5728\u6e90\u6587\u6863\u4e0b\u65b9\u3001[Command Line] \u4e0a\u65b9\u6253\u5f00\u4e00\u4e2a vim \u547d\u4ee4\u884c\u5386\u53f2\u5206\u5c4f\u7a97\u683c\uff08command-line history\uff09\uff0c\u540c\u65f6\u8fdb\u5165\u5e95\u884c\u547d\u4ee4\u6a21\u5f0f\u3002</p> <p>\u8f93\u5165 <code>q/</code> \u6216 <code>q?</code> \u5c06\u5bf9\u5e94\u6253\u5f00\u641c\u7d22\u5386\u53f2\u5206\u5c4f\u7a97\u683c\u3002</p> <p>\u9ed8\u8ba4\u5149\u6807\u805a\u7126\u4e8e vim \u5386\u53f2\u547d\u4ee4\u7a97\u683c\uff0c\u901a\u8fc7 <code>j</code>/<code>k</code> \u53ef\u4e0a\u4e0b\u7ffb\u770b\u9009\u62e9\u5386\u53f2\u547d\u4ee4\uff0c\u6309\u4e0b <code>&lt;Enter&gt;</code> \u952e\u6267\u884c\uff1b\u6216\u6309\u4e0b <code>:</code> \u5207\u6362\u805a\u7126\u5e95\u884c\u8f93\u5165\u3002</p> <p>\u8f93\u5165 <code>:q</code> \u6216\u8fde\u6309\u4e24\u6b21 <code>CTRL-C</code> \u5373\u53ef\u5173\u95ed\u547d\u4ee4\u5386\u53f2\u5206\u5c4f\u7a97\u683c\uff0c\u5207\u56de\u666e\u901a\u6a21\u5f0f\u3002</p> <p>\u6267\u884c <code>:his</code> (<code>:history</code>) \u53ef\u4ee5\u67e5\u770b\u6267\u884c\u547d\u4ee4\u7684\u5386\u53f2\uff0c\u6309 q \u952e\u9000\u51fa\u3002  </p> <p><code>:his :</code> \u53ef\u67e5\u770b cmd history <code>:his /</code> \u6216 <code>:his ?</code> \u53ef\u67e5\u770b search history  </p> <p>\u8f93\u5165 <code>@:</code> \u53ef\u6267\u884c\u6700\u8fd1\u4e00\u6761\u547d\u4ee4\uff08 Repeat last command-line\uff09\u3002  </p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#vim_\u6a21\u5f0f\u5207\u6362","title":"vim \u6a21\u5f0f\u5207\u6362","text":"<p><code>:h mode-switching</code> \u53ef\u67e5\u770b intro.txt \u4e2d\u7684\u6a21\u5f0f\u5207\u6362\uff08Switching from mode to mode\uff09\u76f8\u5173\u7684\u8bf4\u660e\u3002  </p> <p>vi/vim \u5178\u578b\u7684\u4e09\u79cd\u6a21\u5f0f\u5207\u6362\u5173\u7cfb\uff1a</p> <p></p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#normal_-_visual","title":"NORMAL -&gt; VISUAL","text":"<p>\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/visual.txt</code>\u3002</p> \u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>v</code> \u666e\u901a\u6a21\u5f0f\u5207\u6362\u5230\u53ef\u89c6\u6a21\u5f0f \u4ece\u5f53\u524d\u5149\u6807\u5f00\u59cb\u9009\u62e9\uff1a- \u901a\u8fc7 <code>h</code>/<code>l</code> \u6216 <code>b</code>/<code>w</code> \u5c55\u5f00\u884c\u5185\u9009\u62e9- \u901a\u8fc7<code>j</code>/<code>k</code>\u6269\u5c55\u884c\u95f4\u9009\u62e9 <code>V</code>(<code>&lt;S-v&gt;</code>) \u666e\u901a\u6a21\u5f0f\u5207\u6362\u5230\u53ef\u89c6\u884c\u6a21\u5f0f VISUAL LINE\uff1a\u9488\u5bf9\u6574\u884c\u9009\u5b9a\u6a21\u5f0f <code>&lt;C-v&gt;</code> \u666e\u901a\u6a21\u5f0f\u5207\u6362\u5230\u53ef\u89c6\u5757\u6a21\u5f0f VISUAL BLOCK\uff1a\u9488\u5bf9\u5217\u5757\u9009\u5b9a\u6a21\u5f0f <p>\u8bf4\u660e\uff1a</p> <p>\u5bf9\u9009\u4e2d\u90e8\u5206\u53ef\u4ee5 <code>:w [FILENAME]</code> \u53e6\u5b58\u4e3a\u6587\u4ef6\uff08SELECTING TEXT TO WRITE\uff1asaves the Visually selected lines in file FILENAME\uff09\u3002</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#normal_-_replace","title":"NORMAL -&gt; REPLACE","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>R</code> \u4e00\u76f4\u66ff\u6362\u5149\u6807\u6240\u5728\u7684\u5b57\u7b26 replace mode <p><code>r</code>\uff1a\u66ff\u6362\u5149\u6807\u6240\u5728\u7684\u5b57\u7b26\uff08replace char\uff09\uff0c\u53ea\u66ff\u6362\u4e00\u6b21\u3002\u66ff\u6362\u540e\u6062\u590d\u6307\u4ee4\u6a21\u5f0f\u3002  </p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#normal_-_insert","title":"NORMAL -&gt; INSERT","text":"<p>\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/insert.txt</code>\u3002</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#\u5f53\u524d\u5149\u6807_\u6240\u5728\u4f4d\u7f6e\u884c\u9996_\u5b57\u7b26\u524d\u63d2\u5165","title":"\u5f53\u524d\u5149\u6807 \u6240\u5728\u4f4d\u7f6e/\u884c\u9996 \u5b57\u7b26\u524d\u63d2\u5165","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>i</code> \u4ece\u5f53\u524d\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\u63d2\u5165 insert before cursor <code>I</code> \u4ece\u672c\u884c\u884c\u9996\uff08\u7b2c\u4e00\u4e2a\u975e\u7a7a\u767d\u5b57\u5143\u524d\u9762\uff09\u5f00\u59cb\u63d2\u5165 Insert text before the first non-blank in the line\u7b49\u6548\u4e8e <code>^i</code>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#\u5f53\u524d\u5149\u6807_\u6240\u5728\u4f4d\u7f6e\u884c\u672a_\u5b57\u7b26\u540e\u63d2\u5165","title":"\u5f53\u524d\u5149\u6807 \u6240\u5728\u4f4d\u7f6e/\u884c\u672a \u5b57\u7b26\u540e\u63d2\u5165","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>a</code> \u5728\u5f53\u524d\u5b57\u7b26\u540e\u8ffd\u52a0 append after cursor <code>A</code> \u4ece\u672c\u884c\u884c\u5c3e\u5f00\u59cb\u8ffd\u52a0 Append text at the end of the line\u7b49\u6548\u4e8e <code>$a</code> <p><code>ea</code> \u2013 insert (append) at the end of the word</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#\u5f53\u524d\u5149\u6807\u6240\u5728\u884c_\u4e0a\u4e0b_\u63d2\u5165\u65b0\u884c","title":"\u5f53\u524d\u5149\u6807\u6240\u5728\u884c \u4e0a/\u4e0b \u63d2\u5165\u65b0\u884c","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>o</code> \u5728\u672c\u884c\u4e0b\u9762\u589e\u4e00\u884c\u5f00\u59cb\u7f16\u8f91 open below <code>O</code> \u5728\u672c\u884c\u4e0a\u9762\u589e\u4e00\u884c\u5f00\u59cb\u7f16\u8f91 Open above","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#normal_-_command_line","title":"NORMAL -&gt; COMMAND LINE","text":"<p>\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/cmdline.txt</code>\u3002</p> <p>\u5728\u666e\u901a\u6a21\u5f0f\u4e2d\uff0c\u8f38\u5165\u300e : / ? \u300f\u4e09\u500b\u4e2d\u7684\u4efb\u4f55\u4e00\u500b\u952e\uff0c\u5373\u53ef\u5c07\u5149\u6807\u79fb\u52d5\u5230\u5f53\u524d\u5c4f\u5e55\u6700\u5e95\u4e0b\u90a3\u4e00\u884c\uff0c\u5373\u8fdb\u5165\u5e95\u884c\u6a21\u5f0f\u3002</p> \u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>:</code> \u5207\u5165\u5e95\u884c\u6a21\u5f0f\uff08Last Line Mode\uff09 <code>&lt;C-d&gt;</code>\uff1alist possible completions\uff1b\u53ef\u901a\u8fc7\u4e0a\u4e0b\u65b9\u5411\u952e\u7ffb\u9605\u5386\u53f2\u547d\u4ee4 <code>q:</code> \u6253\u5f00Command Line\u5206\u5c4f\u7a97\u53e3 \u53ef\u4f7f\u7528\u65b9\u5411\u952e\u7ffb\u770b\u547d\u4ee4\u884c\u5386\u53f2\u8bb0\u5f55\uff08\u53ef\u7f16\u8f91\uff09\u6309\u4e0b <code>&lt;CR&gt;</code> \u952e\u6267\u884c\uff1b\u6309\u4e0b <code>&lt;C-c&gt;</code> \u53ef\u5207\u56de\u3002 <code>Q</code> Ex Mode \u591a\u884c\u7684 Command-Line \u6a21\u5f0f\u8f93\u5165<code>visual</code>(<code>vi</code>)\u53ef\u5207\u56de\u3002 <code>:! {command}</code> \u6682\u65f6\u79bb\u5f00 vim \u8fd0\u884c\u67d0\u4e2a\u7ec8\u7aef\u547d\u4ee4\uff08EXECUTE EXTERNAL SHELL COMMAND\uff09 \u4f8b\u5982 <code>:! pwd</code> \u6682\u65f6\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u6309\u4e0b <code>&lt;CR&gt;</code> \u952e\u53ef\u5207\u56de\u5230 vim\u3002 <p>\u5e95\u884c\u6a21\u5f0f\u8f93\u5165 :linenumber \u53ef\u8df3\u8f6c\u5230\u6307\u5b9a\u884c\u3002     &gt; \u8f93\u5165 :f / :fi / :file \u53ef\u5728\u5e95\u90e8\u67e5\u770b\u5f53\u524d\u6253\u5f00\u6587\u6863\u7684\u8def\u5f84\u3002 <code>:</code> \u8fdb\u5165 vim \u5185\u90e8 Ex \u547d\u4ee4\u6267\u884c\u73af\u5883\uff1b<code>!</code> \u5219\u53ef\u4e34\u65f6\u5207\u6362\u6267\u884c\u5916\u90e8 shell \u547d\u4ee4\u3002   </p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#jobs","title":"jobs","text":"<p>Understanding the job control commands in Linux How To Use Bash's Job Control to Manage Foreground and Background Processes </p> <p><code>Ctrl-z</code> \u547d\u4ee4\u5c06\u5f53\u524d\u7684 Vi/Vim \u8fdb\u7a0b\u653e\u5230\u540e\u53f0\u6267\u884c\uff0c\u4e4b\u540e shell \u73af\u5883\u5373\u53ef\u4e3a\u4f60\u6240\u7528\uff1b \u5728 shell prompt \u4e2d\u6267\u884c <code>fg</code> \u547d\u4ee4\u5219\u5c06\u4f4d\u4e8e\u540e\u53f0\u7684 Vi/Vim \u8fdb\u7a0b\u5207\u5230\u524d\u53f0\u6062\u590d\u6267\u884c\u3002  </p> <p>vim \u6253\u5f00\u7b2c1\u4e2a\u6587\u4ef6\u540e\u6309\u4e0b  \u4e34\u65f6\u5207\u51fa\uff0c\u518d\u6253\u5f00\u7b2c2\u4e2a\u6587\u4ef6\uff1a <pre><code># vim \u6253\u5f00\u7f16\u8f91\u7b2c1\u4e2a\u6587\u4ef6\uff0c\u6309\u4e0b &lt;C-z&gt; \u4e34\u65f6\u5207\u51fa\n$ vim mars/build_ios.py\n\n[1]  + 20091 suspended  vim mars/build_ios.py\n\n# vim \u6253\u5f00\u7f16\u8f91\u7b2c2\u4e2a\u6587\u4ef6\uff0c\u6309\u4e0b &lt;C-z&gt; \u4e34\u65f6\u5207\u51fa\n$ vim mars/build_android.py\n\n[2]  + 20133 suspended  vim mars/build_android.py\n</code></pre> <p>\u8f93\u5165 <code>jobs</code> \u67e5\u770b\u540e\u53f0\u4efb\u52a1\u5217\u8868\uff1a</p> <pre><code>$ jobs\n[1]  - suspended  vim mars/build_ios.py\n[2]  + suspended  vim mars/build_android.py\n</code></pre> <p>\u8f93\u5165 <code>jobs -</code> \u518d\u6309\u4e0b tab \u53ef\u67e5\u770b jobs \u547d\u4ee4\u652f\u6301\u7684\u53ef\u9009\u9879\u3002</p> <p>vim \u6253\u5f00\u7f16\u8f91\u7b2c3\u4e2a\u6587\u4ef6\uff0c\u6309\u4e0b  \u4e34\u65f6\u5207\u51fa <pre><code>$ vim mars/build_osx.py\n\n[3]  + 20233 suspended  vim mars/build_osx.py\n\n$ jobs\n[1]    suspended  vim mars/build_ios.py\n[2]  - suspended  vim mars/build_android.py\n[3]  + suspended  vim mars/build_osx.py\n</code></pre> <p>\u8f93\u5165 <code>fg</code>\uff0c\u7b49\u6548\u4e8e <code>fg %+</code> \u548c <code>fg %%</code>\uff0c\u5c06\u6700\u540e\u4e00\u6b21\u6302\u8d77\u7684\u4efb\u52a1\u5207\u56de\u524d\u53f0\u6267\u884c\u3002</p> <pre><code>$ fg\n[3]    20233 continued  vim mars/build_osx.py\n\n[3]  + 20233 suspended  vim mars/build_osx.py\n</code></pre> <p>\u8f93\u5165 <code>fg %-</code> \u6216 <code>fg %2</code> \u5207\u6362\u6062\u590d\u7b2c2\u4e2a\u4efb\u52a1\uff1a</p> <pre><code>$ fg %-\n[2]    20133 continued  vim mars/build_android.py\n\n[2]  + 20133 suspended  vim mars/build_android.py\n</code></pre> <pre><code>$ fg %+ # fg %%\n[2]    20133 continued  vim mars/build_android.py\n\n[2]  + 20133 suspended  vim mars/build_android.py\n</code></pre> <p>\u6267\u884c <code>fg %1</code> \u6307\u5b9a\u5207\u6362\u6062\u590d\u7b2c1\u4e2a\u4efb\u52a1\uff1a</p> <pre><code>$ fg %1\n[1]    20091 continued  vim mars/build_ios.py\n\n[1]  + 20091 suspended  vim mars/build_ios.py\n\n$ jobs\n[1]  + suspended  vim mars/build_ios.py\n[2]  - suspended  vim mars/build_android.py\n[3]    suspended  vim mars/build_osx.py\n</code></pre> <p>\u6267\u884c <code>disown %N</code> \u547d\u4ee4\uff0c\u5c06\u4efb\u52a1N\u4ece\u6d3b\u52a8jobs\u5217\u8868\u79fb\u52a8\uff0c\u76f8\u5f53\u4e8e\u975e\u6b63\u5e38\u5173\u95edvim\u3002</p> <pre><code>$ disown %-\ndisown: warning: job is suspended, use `kill -CONT -20133' to resume\n$ jobs\n[1]  + suspended  vim mars/build_ios.py\n[3]  - suspended  vim mars/build_osx.py\n</code></pre> <p>\u91cd\u65b0\u6267\u884c <code>vim mars/build_android.py</code> \u5c06\u63d0\u793a\u6062\u590d\u5efa\u8bae\uff1a</p> <pre><code>Swap file \"mars/.build_android.py.swp\" already exists!\n[O]pen Read-Only, (E)dit anyway, (R)ecover, (Q)uit, (A)bort:\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#shell","title":"shell","text":"<p>\u5728 Vi/Vim \u7684\u6b63\u5e38\u6a21\u5f0f\u4e0b\u8f93\u5165 <code>:sh</code> \u521b\u5efa shell \u7a97\u53e3\u3002 \u5728 shell prompt \u4e2d\u6267\u884c <code>exit</code> \u547d\u4ee4\u5373\u53ef\u8fd4\u56de\u5230 Vi/Vim \u7ee7\u7eed\u7f16\u8f91\u3002  </p> <pre><code>:sh[ell]                This command starts a shell.  When the shell exits\n                        (after the \"exit\" command) you return to Vim.  The\n                        name for the shell command comes from 'shell' option.\n</code></pre> <pre><code># \u6309\u4e0b &lt;C-z&gt; \u4e34\u65f6\u9000\u51fa man/less/vi \u8fd4\u56de\u7ec8\u7aef\n$ man less\n[1]  + 2100 suspended  man less\n\n# \u6267\u884c shell \u547d\u4ee4\n$ echo $PAGER\nless\n\n# \u8f93\u5165 fg \u8fd4\u56de man/less/vi\n$ fg\n[1]  + 2100 continued  man less\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#_1","title":"!","text":"<p>\u5e95\u884c\u6a21\u5f0f\u8f93\u5165 <code>:!{cmd}</code> \u4e34\u65f6\u6267\u884c shell \u547d\u4ee4 cmd\uff0c\u6839\u636e\u63d0\u793a <code>Press ENTER or type command to continue</code> \u6309\u4e0b\u56de\u8f66\u952e\u8fd4\u56de vim\u3002</p> <p>\u8f93\u5165 <code>:!!</code> \u6267\u884c\u4e0a\u4e00\u6761\u547d\u4ee4\uff0c\u7c7b\u4f3c <code>//</code>\u3001<code>??</code>\u3002</p> <pre><code>                                                        :!cmd :! E34\n:!{cmd}                 Execute {cmd} with the shell.  See also the 'shell'\n                        and 'shelltype' option.\n\n                        If {cmd} contains \"%\" it is expanded to the current\n                        file name.  Special characters are not escaped, use\n                        quotes to avoid their special meaning:\n                                :!ls \"%\"\n                        If the file name contains a \"$\" single quotes might\n                        work better (but a single quote causes trouble):\n                                :!ls '%'\n                        This should always work, but it's more typing:\n                                :exe \"!ls \" . shellescape(expand(\"%\"))\n\n                        A newline character ends {cmd}, what follows is\n                        interpreted as a following \":\" command.  However, if\n                        there is a backslash before the newline it is removed\n                        and {cmd} continues.  It doesn't matter how many\n                        backslashes are before the newline, only one is\n                        removed.\n\n                                                        :!!\n:!!                     Repeat last \":!{cmd}\".\n</code></pre> <p>\u5f53\u6211\u4eec\u6b63\u5728\u7f16\u8f91\u4e00\u4e2a shell \u811a\u672c\uff08<code>*.sh</code>\uff09\u65f6\uff0c\u53ef\u5e95\u884c\u6267\u884c <code>:!/bin/bash %</code> \u6765\u8fd0\u884c\u5f53\u524d\u811a\u672c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#terminal","title":"terminal","text":"<p>\u5e95\u884c\u6a21\u5f0f\u8f93\u5165 <code>:ter</code> \u5728\u5f53\u524d\u7f16\u8f91\u7a97\u683c\u7684\u9876\u90e8\u521b\u5efa\u4e00\u4e2a\u5e38\u9a7b\u7684\u96c6\u6210\u7ec8\u7aef\u7a97\u53e3\uff0c\u9ed8\u8ba4 cd \u8fdb\u5165\u5f53\u524d\u7f16\u8f91\u6587\u6863\u6240\u5728\u7684\u76ee\u5f55\u4f5c\u4e3a\u5de5\u4f5c\u76ee\u5f55\u3002</p> <p>\u7ec8\u7aef\u7a97\u53e3\u9ed8\u8ba4\u662f INSERT \u63d2\u5165\u6a21\u5f0f\uff0c\u53ef\u4ee5\u8f93\u5165 <code>&lt;C-\\&gt;&lt;C-N&gt;</code> \u5207\u6362\u5230\u666e\u901a\u6a21\u5f0f\u3002</p> <pre><code>:[range]ter[minal] [options] [command]                  :ter :terminal\n                        Open a new terminal window.\n</code></pre> <p>\u4ea6\u53ef\u6267\u884c <code>:tab :ter</code> \u5728\u53f3\u4fa7\u65b0\u5efa\u7684 tab \u9875\u6253\u5f00\u7ec8\u7aef\u7a97\u53e3\u3002</p> <ul> <li><code>:0tab :ter</code>: \u5728\u6700\u5de6\u4fa7\u65b0\u5efa tab \u6253\u5f00\u7ec8\u7aef\uff1b  </li> <li><code>:$tab :ter</code>: \u5728\u6700\u53f3\u4fa7\u65b0\u5efa tab \u6253\u5f00\u7ec8\u7aef\uff1b  </li> </ul> <p>Vim \u5185\u7f6e\u7ec8\u7aef\u8c03\u6559\u8bb0</p>","tags":["vim"]},{"location":"blog/20171018/004-vim-mode/#\u8fd4\u56de_normal_\u6a21\u5f0f","title":"\u8fd4\u56de NORMAL \u6a21\u5f0f","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>&lt;C-c&gt;</code> CTRL-C:Interrupt current (search) command; i_CTRL-C: Quit insert mode, go back to Normal mode. CTRL-Ci_CTRL-C <code>&lt;Esc&gt;</code> / <code>&lt;C-[&gt;</code> End insert or Replace mode, go back to Normal mode. i_\\&lt;Esc&gt;i_CTRL-[","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/","title":"vim\u5149\u6807","text":"<p>\u5149\u6807\u5b9a\u4f4d\u53ef\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/motion.txt</code> \u53ef\u901a\u8fc7 <code>:help h</code> \u6216 <code>:h CTRL-N</code> \u641c\u7d22\u5e2e\u52a9\u3002</p>","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u79fb\u52a8\u5149\u6807","title":"\u79fb\u52a8\u5149\u6807","text":"<p>\u203b\u203b \u8981\u79fb\u52d5\u5149\u6a19\uff0c\u8acb\u4f9d\u7167\u8aaa\u660e\u5206\u5225\u6309\u4e0b <code>h</code>\u3001<code>j</code>\u3001<code>k</code>\u3001<code>l</code> \u9375\u3002 \u203b\u203b</p> <pre><code>         ^\n         k              \u63d0\u793a\ufe30 h \u7684\u9375\u4f4d\u4e8e\u5de6\u908a\uff0c\u6bcf\u6b21\u6309\u4e0b\u5c31\u6703\u5411\u5de6\u79fb\u52d5\u3002\n   &lt; h       l &gt;               l \u7684\u9375\u4f4d\u4e8e\u53f3\u908a\uff0c\u6bcf\u6b21\u6309\u4e0b\u5c31\u6703\u5411\u53f3\u79fb\u52d5\u3002\n         j                     j \u9375\u770b\u8d77\u4f86\u5f88\u8c61\u4e00\u652f\u5c16\u7aef\u65b9\u5411\u671d\u4e0b\u7684\u7bad\u982d\uff08down arrow\uff09\u3002\n         v\n</code></pre> <p>\u5728 Normal Mode \u4e0b\uff0c\u4f60\u5f53\u7136\u4e5f\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u65b9\u5411\u952e\uff08\u2190\u2193\u2191\u2192\uff09\u6765\u5b9e\u73b0\u5149\u6807\u7684\u79fb\u52a8\uff0c\u4f46 vi/vim \u7684\u5b97\u65e8\u662f\u624b\u6307\u5c3d\u91cf\u96c6\u4e2d\u5728\u952e\u76d8\u4e2d\u95f4\u6392\uff0c\u4ee5\u6700\u5c0f\u5e45\u5ea6\u7684\u6309\u952e\u64cd\u4f5c\u5b8c\u6210\u5927\u90e8\u5206\u5b9a\u4f4d\u53ca\u7f16\u8f91\u5de5\u4f5c\u3002</p> \u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>h</code> \u2190 <code>&lt;Left&gt;</code> <code>j</code> / <code>&lt;C-n&gt;</code> \u2193 <code>&lt;Down&gt;</code>\uff0cnext <code>k</code> / <code>&lt;C-p&gt;</code> \u2191 <code>&lt;Up&gt;</code>\uff0cprevious <code>l</code> \u2192 <code>&lt;Right&gt;</code> <p>\u5728 Insert Mode \u4e0b\uff0c\u6309\u4e0b <code>hjkl</code> \u5c06\u8f93\u5165\u666e\u901a\u7684\u5b57\u6bcd\uff0c\u6b64\u65f6\u53ea\u80fd\u901a\u8fc7\u65b9\u5411\u952e\u6765\u79fb\u52a8\u5149\u6807\uff0c\u6216  \u5207\u56de Normal Mode \u5b9a\u4f4d\u5149\u6807\u518d\u5207\u6362\u56de\u7ee7\u7eed\u7f16\u8f91\u3002 <p>5h\uff1a\u5149\u6807\u5411\u5de6\u79fb\u52a85\u4e2a\u5b57\u7b26\u4f4d\u7f6e\uff1b5k\uff1a\u5149\u6807\u5411\u4e0a\u79fb\u52a85\u4e2a\u5b57\u7b26\u3002</p> <p><code>j</code>\u3001<code>k</code> \u9ed8\u8ba4\u6309\u7167\u81ea\u7136\u884c\u4e0a\u4e0b\u79fb\u52a8\u5149\u6807\uff1b<code>gj</code>\u3001<code>gk</code> \u5219\u6309\u7167\u5c4f\u5e55\u884c\u4e0a\u4e0b\u79fb\u52a8\u5149\u6807\u3002</p>","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u4f4d\u7f6e\u56de\u6eaf","title":"\u4f4d\u7f6e\u56de\u6eaf","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>&lt;C-o&gt;</code> \u5149\u6807\u56de\u5230\u4e0a\u6b21\u4f4d\u7f6e takes back to older positions <code>&lt;C-i&gt;</code> \u5149\u6807\u56de\u5230\u4e0b\u6b21\u4f4d\u7f6e takes to newer positions <p>vim \u6253\u5f00\u6587\u4ef6\u4e4b\u540e\uff0c\u5149\u6807\u4e00\u822c\u90fd\u5728\u6587\u4ef6\u5f00\u5934\uff0c\u60f3\u8981\u8df3\u5230\u4e0a\u6b21\u5173\u95ed\u6587\u4ef6\u524d\u7684\u4f4d\u7f6e\u53ef\u6309\u4e0b <code>'0</code> \u3002</p> <p>`. \uff1a\u8df3\u8f6c\u5230\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u4f4d\u7f6e\u5e76\u5b9a\u4f4d\u7f16\u8f91\u70b9\uff1b '. \uff1a\u8df3\u8f6c\u5230\u6700\u8fd1\u4fee\u6539\u8fc7\u7684\u4f4d\u7f6e\u4f46\u4e0d\u5b9a\u4f4d\u7f16\u8f91\u70b9\u3002  </p>","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u5355\u8bcd\u5b9a\u4f4d","title":"\u5355\u8bcd\u5b9a\u4f4d","text":"\u6309\u952e \u8bf4\u660e <code>b</code> / <code>&lt;S-Left&gt;</code> \u79fb\u52a8\u5230\u4e0a\u4e00\u5355\u8bcd\u9996 <code>w</code> / <code>&lt;S-Right&gt;</code> \u79fb\u52a8\u5230\u4e0b\u4e00\u5355\u8bcd\u9996\uff08\u5355\u8bcd\u5b57\u6bcd\u524d\uff09 <code>e</code> \u79fb\u52a8\u5230\u5f53\u524d\u5355\u8bcd\u5c3e\uff08\u5149\u6807\u79fb\u5230\u5f53\u524d\u5355\u8bcd\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u6bcd\u524d\uff09 <code>ge</code> \u79fb\u52a8\u5230\u524d\u4e00\u4e2a\u5355\u8bcd\u5c3e\uff08\u5149\u6807\u79fb\u5230\u5f53\u524d\u5355\u8bcd\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u6bcd\u524d\uff09 <p>5w\uff1a\u5149\u6807\u4ece\u5f53\u524d\u5355\u8bcd\u5411\u53f3\u79fb\u52a8\u5230\u7b2c5\u4e2a\u5355\u8bcd\u7684\u9996\u5b57\u7b26\u4f4d\u7f6e\uff1b5ge\uff1a\u5149\u6807\u4ece\u5f53\u524d\u5355\u8bcd\u5411\u5de6\u79fb\u52a8\u5230\u7b2c5\u4e2a\u5355\u8bcd\u7684\u672b\u5b57\u7b26\u4f4d\u7f6e\u3002</p> <p><code>W</code>\u3001<code>B</code>\u3001<code>E</code> \u547d\u4ee4\u64cd\u4f5c\u7684\u5355\u8bcd\u662f\u4ee5\u7a7a\u767d\u5b57\u7b26\uff08\u7a7a\u683c\u3001Tab\uff09\u5206\u9694\u7684\u5b57\u4e32\u3002  </p> <p>\u793a\u4f8b1\uff1a\u4ee5\u4e0b\u6458\u81ea <code>~/.zhsrc</code>\uff1a</p> <pre><code> 26 # Uncomment the following line to disable auto-setting terminal title.\n</code></pre> <p>\u5047\u8bbe\u5f53\u524d\u5149\u6807\u4f4d\u4e8e auto-setting \u7684\u5b57\u7b26 a \u524d\uff0c\u63093\u6b21 <code>w</code> \u6216 1\u6b21 <code>W</code> \u90fd\u5c06\u8df3\u5230 <code>terminal</code> \u524d\u3002</p> <p>\u793a\u4f8b2\uff1a\u4ee5\u4e0b\u6458\u81ea <code>vimtutor</code> Lesson 4.4: THE SUBSTITUTE COMMAND\uff1a</p> <pre><code>Type   :%s/old/new/g      to change every occurrence in the whole file.\n</code></pre> <p>\u5047\u8bbe\u5f53\u524d\u5149\u6807\u4f4d\u4e8e to \u524d\uff0c\u63098\u6b21 <code>b</code> \u6216 1\u6b21 <code>B</code> \u90fd\u5c06\u8df3\u5230 <code>:</code> \u524d\u3002  </p>","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u884c\u5185\u5b9a\u4f4d","title":"\u884c\u5185\u5b9a\u4f4d","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>0</code> / <code>|</code> \u79fb\u5230\u884c\u9996\uff08<code>Home</code>\uff09 \"hard\" BOL(Begin Of Line) <code>^</code> / <code>_</code> \u79fb\u5230\u884c\u9996\uff08\u975e\u7a7a\u767d\u5b57\u7b26\uff09 \"soft\" BOL <code>$</code> \u79fb\u5230\u884c\u5c3e\uff08<code>End</code>\uff09 EOL(End Of Line) <code>{n}\u2423</code> \u5411\u53f3\uff08\u4e0b\uff09\u79fb\u52a8n\u4e2a\u5b57\u7b26 \u6570\u5b57+\u7a7a\u683c <code>%</code> \u8df3\u5230\u5339\u914d\u7684\u62ec\u53f7\u5904 MATCHING PARENTHESES SEARCH: \"{}\"\u3001\"[]\"\u3001\"()\"","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u884c\u95f4\u5b9a\u4f4d","title":"\u884c\u95f4\u5b9a\u4f4d","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>-</code> \u79fb\u52a8\u5230\u4e0a\u4e00\u884c\u9996 \u975e\u7a7a\u767d\u5b57\u5143 <code>+</code> \u79fb\u52a8\u5230\u4e0b\u4e00\u884c\u9996 \u975e\u7a7a\u767d\u5b57\u5143 <code>{n}&lt;CR&gt;</code> \u5411\u4e0b\u79fb\u52a8n\u884c \u6570\u5b57+\u56de\u8f66","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u884c\u8df3\u8f6c\u5b9a\u4f4d","title":"\u884c\u8df3\u8f6c\u5b9a\u4f4d","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>gg</code> / <code>:0</code> \u79fb\u5230\u6587\u4ef6\u7b2c\u4e00\u884c\u9996 \u7b2c\u4e00\u884c BOL\uff1amove to the start of the file <code>G</code> / <code>:$</code> \u79fb\u5230\u6587\u4ef6\u672b\u5c3e\u884c\u9996 \u6700\u540e\u4e00\u884c\u7684 EOL\uff1amove to the bottom of the file <code>{n}gg</code> / <code>{n}G</code> / <code>:{n}</code> \u79fb\u5230\u7b2cn\u884c n\u4e3a\u884c\u6570 <p>vim\u5728\u6253\u5f00\u6587\u4ef6\u65f6\uff0c\u5149\u6807\u9ed8\u8ba4\u5b9a\u4f4d\u5728\u7b2c\u4e00\u884c\u884c\u9996\uff0c\u5b9e\u9645\u4e0a\u53ef\u901a\u8fc7 <code>+</code> \u9009\u9879\u5e26\u53c2\u6570\u6307\u5b9a\u6253\u5f00\u65f6\u5b9a\u4f4d\u8df3\u8f6c\u5230\u6307\u5b9a\u884c\u3002</p> <pre><code>\u279c  ~  vim --help\nusage: vim [arguments] [file ..]       edit specified file(s)\n\nArguments:\n   --           Only file names after this\n\n   +            Start at end of file\n   +&lt;lnum&gt;      Start at line &lt;lnum&gt;\n</code></pre> <ol> <li><code>+&lt;num&gt;</code>\u6307\u5b9a\u6253\u5f00\u65f6\u5149\u6807\u6240\u5728\u884c\uff1a     &gt; \u279c  ~  vim +39 /usr/share/vim/vim[0-9][0-9]/doc/motion.txt</li> <li><code>+</code>\u6253\u5f00\u6587\u4ef6\u65f6\u5149\u6807\u5b9a\u4f4d\u5230\u6700\u540e\u4e00\u884c\uff0c\u65b9\u4fbfappend\u7f16\u8f91\uff1a     &gt; \u279c  ~  vim + /usr/share/vim/vim[0-9][0-9]/doc/motion.txt</li> </ol>","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u53e5\u6bb5\u5b9a\u4f4d","title":"\u53e5\u6bb5\u5b9a\u4f4d","text":"<p>\u65b9\u4fbf\u4ee5\u53e5\u3001\u6bb5\u4e3a\u5355\u4f4d\u56de\u6eaf/\u63a8\u8fdb\u9605\u8bfb\uff1a</p> \u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>(</code> \u79fb\u5230\u4e0a\u4e00\u53e5\u9996 sentences backward <code>)</code> \u79fb\u5230\u4e0b\u4e00\u53e5\u9996 sentences forward <code>{</code> \u79fb\u5230\u4e0a\u4e00\u6bb5\u9996 paragraphs backward <code>}</code> \u79fb\u5230\u4e0b\u4e00\u6bb5\u9996 paragraphs forward <code>[[</code> \u79fb\u5230\u4e0a\u4e00\u53e5\u9996{ [count] sections backward or to the previous '{' in the first column. <code>]]</code> \u79fb\u5230\u4e0b\u4e00\u53e5\u9996{ [count] sections forward or to the next '{' in the first column. <code>[]</code> \u79fb\u5230\u4e0a\u4e00\u53e5\u9996} [count] sections backward or to the previous '}' in the first column. <code>][</code> \u79fb\u5230\u4e0b\u4e00\u53e5\u9996} [count] sections forward or to the next '}' in the first column. <p>\u8bf4\u660e\uff1a</p> <p><code>[[</code> \u8df3\u8f6c\u81f3\u4e0a\u4e00\u4e2a\u51fd\u6570\uff08\u8981\u6c42\u4ee3\u7801\u5757\u4e2d { \u5fc5\u987b\u5355\u72ec\u5360\u4e00\u884c\uff09 <code>]]</code> \u8df3\u8f6c\u81f3\u4e0b\u4e00\u4e2a\u51fd\u6570\uff08\u8981\u6c42\u4ee3\u7801\u5757\u4e2d { \u5fc5\u987b\u5355\u72ec\u5360\u4e00\u884c\uff09  </p>","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u5c4f\u663e\u5b9a\u4f4d","title":"\u5c4f\u663e\u5b9a\u4f4d","text":"\u6309\u952e \u8bf4\u660e <code>H</code> (<code>&lt;S-h&gt;</code>) \u79fb\u5230\u5f53\u524d\u5c4f\u5e55\u7684\u9996\u884c <code>M</code> (<code>&lt;S-m&gt;</code>) \u79fb\u5230\u5f53\u524d\u5c4f\u5e55\u7684\u4e2d\u95f4\u884c <code>L</code> (<code>&lt;S-l&gt;</code>) \u79fb\u5230\u5f53\u524d\u5c4f\u5e55\u7684\u672b\u884c <p>\u8bf4\u660e\uff1a</p> <p>\u8fd9\u4e09\u4e2a\u952e\u63a7\u5c4f\u79fb\u4ec5\u9488\u5bf9\u5f53\u524d\u5c4f\u5e55\u663e\u793a\u8303\u56f4\u8fdb\u884c\u4e0a\u4e2d\u4e0b\u4e09\u70b9\u5b9a\u4f4d\uff0c\u65b9\u4fbf\u5f53\u524d\u663e\u793a\u533a\u57df\u9605\u8bfb\uff0c\u800c\u975e\u5168\u6587\u5b9a\u4f4d\u3002 \u7ed3\u5408 jk \u53ef\u8fdb\u884c\u66f4\u7ec6\u9897\u7c92\u5ea6\u7684\u884c\u8df3\u8f6c\u5b9a\u4f4d\u3002  </p> <p>\u8fd8\u6709\u4e00\u4e9b\u5feb\u6377\u6307\u4ee4\u53ef\u4ee5\u57fa\u4e8e\u5f53\u524d\u5149\u6807\u6240\u5728\u4f4d\u7f6e\uff08\u884c\uff09\u6eda\u52a8\u5c4f\u5e55\uff0c\u4ee5\u805a\u7126\u7f16\u8f91\u3002</p> \u6309\u952e \u8bf4\u660e <code>zz</code> Center this line <code>z.</code> Center the screen on the cursor <code>zt</code> Scroll the screen so the cursor is at the top <code>zb</code> Scroll the screen so the cursor is at the bottom","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u6eda\u5c4f\u5b9a\u4f4d","title":"\u6eda\u5c4f\u5b9a\u4f4d","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>&lt;C-e&gt;</code> \u5c4f\u5e55\u5411\u4e0b\u79fb\u52a8\u4e00\u884c move forward one-line <code>&lt;C-y&gt;</code> \u5c4f\u5e55\u5411\u4e0a\u56de\u6eda\u4e00\u884c move backward one-line <code>&lt;C-d&gt;</code> \u5c4f\u5e55\u5411\u4e0b\u6eda\u52a8\u534a\u9875 move down half-page <code>&lt;C-u&gt;</code> \u5c4f\u5e55\u5411\u4e0a\u56de\u6eda\u534a\u9875 move up half-page <code>&lt;C-f&gt;</code> \u5c4f\u5e55\u5411\u4e0b\u6eda\u52a8\u4e00\u9875(<code>PgDn</code>) forward <code>&lt;C-b&gt;</code> \u5c4f\u5e55\u5411\u4e0a\u56de\u6eda\u4e00\u9875(<code>PgUp</code>) backward <p>\u6eda\u5c4f\u5b9a\u4f4d\u53ef\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/scroll.txt</code> \u53ef\u901a\u8fc7 <code>:help CTRL-D</code> \u6216 <code>:h CTRL-U</code> \u641c\u7d22\u5e2e\u52a9\u3002</p> <p>\\&lt;C-f&gt; / \\&lt;C-b&gt; \u5728 bash shell \u547d\u4ee4\u884c\u8f93\u5165\u4e2d\u662f\u5411\u524d/\u540e\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26\u3002 \\&lt;C-d&gt; \u5728 bash shell \u547d\u4ee4\u884c\u8f93\u5165\u4e2d\u662f\u5411\u524d\u5220\u9664\u4e00\u4e2a\u5b57\u7b26\uff1b\\&lt;C-u&gt; \u5219\u662f\u5411\u540e\u5220\u9664\u5230\u884c\u9996\u6216\u6574\u884c\u3002  </p> <p>\u7b49\u6548\u5b9e\u73b0\uff1a</p> <ul> <li><code>Lzt</code> \u5b9e\u73b0 <code>&lt;C-f&gt;</code> \u7684\u6548\u679c\uff1b  </li> <li><code>Hzb</code> \u5b9e\u73b0 <code>&lt;C-b&gt;</code> \u7684\u6548\u679c\uff1b  </li> </ul>","tags":["vim"]},{"location":"blog/20171018/005-vim-cursor/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>VIM\u8df3\u8f6c\u6280\u5de7 \u5728vim\u4e0a\u5b9e\u73b0\u8df3\u8f6c\u5230\u5b9a\u4e49\u5904\u7684\u65b9\u6cd5 vim\u62ec\u53f7\u5339\u914d\u7b49\u8df3\u8f6c\u6280\u5de7 </p>","tags":["vim"]},{"location":"blog/20171018/006-vim-text-object/","title":"vim\u5bf9\u8c61","text":"<p>\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/motion.txt</code></p> <p>\u6587\u672c\u5bf9\u8c61\u7684\u5b58\u5728\u4f7f\u5f97\u4f60\u53ef\u4ee5\u9009\u62e9\u6216\u64cd\u4f5c\u66f4\u52a0\u590d\u6742\u7684\u5bf9\u8c61\u3002\u6bd4\u8d77\u9009\u4e2d\u67d0\u4e2a\u5355\u8bcd\u5e76\u5220\u9664\u3001\u8df3\u8f6c\u5230\u53e5\u9996\u5e76\u5220\u9664\u53e5\u5b50\u7b49\u7b80\u5355\u64cd\u4f5c\u6765\u8bf4\uff0c\u4e0d\u7ba1\u4f60\u5728\u4f55\u79cd\u6587\u672c\u5bf9\u8c61\u7684\u533a\u57df\u5185\uff0c\u4f60\u90fd\u53ef\u4ee5\u5bf9\u5b83\u4eec\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\u3002</p> <p>This is a series of commands that can only be used while in Visual mode or after an operator. The commands that start with \"a\" select \"a\"n object including white space, the commands starting with \"i\" select an \"inner\" object without white space, or just the white space. Thus the \"inner\" commands always select less text than the \"a\" commands. These commands are not available when the |+textobjects| feature has been disabled at compile time.  </p> <p><code>a</code>\u548c<code>i</code>\u7684\u533a\u522b\uff1a</p> <p><code>an</code> object\uff1a\u5305\u542b\u5c3e\u90e8\u95f4\u9694\u7a7a\u683c <code>inner</code> object\uff1a\u53ea\u662f\u5185\u5bb9\u672c\u8eab\uff0c\u4e0d\u5305\u542b\u5c3e\u90e8\u5355\u8bcd\u95f4\u9694\u7a7a\u683c</p>","tags":["vim"]},{"location":"blog/20171018/006-vim-text-object/#word__sentence__paragraph","title":"word / sentence / paragraph","text":"textobject \u8bf4\u660e <code>w</code> word <code>s</code> sentence <code>p</code> paragraph","tags":["vim"]},{"location":"blog/20171018/006-vim-text-object/#block__block","title":"block / Block","text":"textobject \u8bf4\u660e <code>]</code>/<code>[</code> [] block <code>)</code>/<code>(</code>\u3001<code>b</code> block <code>&gt;</code>/<code>&lt;</code> &lt;&gt; block <code>}</code>/<code>{</code>\u3001<code>B</code> Block <code>t</code> tag block\uff1a&lt;&gt;","tags":["vim"]},{"location":"blog/20171018/006-vim-text-object/#quoted_string","title":"quoted string","text":"textobject \u8bf4\u660e <code>\"</code> / <code>'</code> / <code>`</code> quoted string","tags":["vim"]},{"location":"blog/20171018/006-vim-text-object/#visual_mode","title":"visual mode","text":"<p>\u5728\u53ef\u89c6\u9009\u62e9\u6a21\u5f0f\u4e0b\uff0c\u53ef\u4ee5\u4ee5 <code>v</code> \u505a\u524d\u7f00\uff0c<code>a</code> \u6216 <code>i</code> \u9650\u5b9a\u8fb9\u754c\uff0c\u540e\u7eed\u6307\u5b9a\u64cd\u4f5c\u5bf9\u8c61\uff0c\u6765\u5b9e\u73b0\u9488\u5bf9\u6587\u672c\u5bf9\u8c61\u7684\u9009\u62e9\uff1a </p> \u6307\u4ee4 \u8bf4\u660e <code>viw</code> \u9009\u4e2d\u5355\u8bcd <code>vis</code> \u9009\u4e2d\u53e5\u5b50 <code>vip</code> \u9009\u4e2d\u6bb5\u843d <code>vi(</code> \u9009\u4e2d\u5706\u62ec\u53f7\u4e2d\u7684\u5185\u5bb9 <code>vi[</code> \u9009\u4e2d\u4e2d\u62ec\u53f7\u4e4b\u95f4\u7684\u5185\u5bb9 <code>v2i{</code> \u9009\u4e2d\u4e24\u5c42\u5927\u62ec\u53f7\u4e4b\u95f4\u7684\u6240\u6709\u5185\u5bb9\u6570\u5b57\u9650\u5b9a\u9009\u62e9\u7684\u5d4c\u5957\u5c42\u6570 <code>v3aw</code> \u9009\u62e9\u4e09\u4e2a\u5355\u8bcd\uff08\u5305\u542b\u4e2d\u95f4\u76842\u4e2a\u95f4\u9694\u7a7a\u683c\uff09 <code>v3iw</code> \u9009\u62e9\u4e09\u4e2a\u5355\u8bcd\uff082\u4e2a\u5355\u8bcd+\u95f4\u9694\u7a7a\u683c\uff09 <p>\u53e6\u5916\uff0c\u53ef\u5c06 <code>v</code> \u9009\u62e9\u64cd\u4f5c\u6307\u4ee4\u66ff\u6362\u4e3a <code>x</code>\u3001<code>d</code>\u3001<code>y</code> \u7b49\u64cd\u4f5c\u7b26(operator)\uff0c\u6765\u9488\u5bf9\u6587\u672c\u5bf9\u8c61\u64cd\u4f5c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/","title":"vim\u7f16\u8f91","text":"<p>\u672c\u6587\u68b3\u7406\u4e86\u4f7f\u7528 vim \u8fdb\u884c\u64a4\u9500\u3001\u91cd\u505a\uff0c\u4fee\u6539\u3001\u590d\u5236\u3001\u5220\u9664\uff0c\u884c\u7f29\u8fdb\u3001\u884c\u5408\u5e76\uff0c\u6279\u91cf\u7f16\u8f91\u548c\u4fdd\u5b58\u3001\u9000\u51fa\u7b49\u65e5\u5e38\u57fa\u7840\u64cd\u4f5c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u64a4\u9500\u91cd\u505a","title":"\u64a4\u9500\u3001\u91cd\u505a","text":"","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u64a4\u9500undo_previous_actions","title":"\u64a4\u9500\uff08undo previous actions\uff09","text":"<p>\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/undo.txt</code></p> \u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>u</code> \u64a4\u9500\uff08undo\uff09 \u76f4\u5230<code>Already at oldest change</code> <code>U</code> \u64a4\u9500\uff08undo\uff09 \u64a4\u9500\u9488\u5bf9\u5149\u6807\u6240\u5728\u884c\u7684\u64cd\u4f5c\uff1aundo all the changes on a line <pre><code>**Undo branches**\uff1a                                *undo-branches* *undo-tree*\n\nAbove we only discussed **one line** of undo/redo.  But it is also possible to **branch off**.  \nThis happens when you undo a few changes and then make a new change.  The undone changes become a branch.  \nYou can go to that branch with the following commands.\n</code></pre> \u6309\u952e \u8bf4\u660e <code>:undol[ist]</code> List the leafs in the tree of changes. <code>g-</code> / <code>:ea</code>/<code>:earlier</code> Go to older text state. <code>g+</code> / <code>:lat</code>/<code>:later</code> Go to newer text state. <p><code>:undol[ist]</code> Example:</p> number changes time saved 8 8 06:30:15 10 9 06:30:30 11 9 06:30:34 12 9 06:30:37 <p>The \"number\" column is the change number. This number continuously increases and can be used to identify a specific undo-able change</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u91cd\u505aredo__undo_the_undos","title":"\u91cd\u505a\uff08redo = undo the undo's\uff09","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>&lt;C-r&gt;</code> \u91cd\u505a\uff08redo\uff09 \u76f4\u5230 <code>Already at newest change</code>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u91cd\u590drepeat_last_changecmd","title":"\u91cd\u590d\uff08repeat last change/cmd\uff09","text":"<p>\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/repeat.txt</code></p> \u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>.</code> \u91cd\u590d\u6267\u884c\u521a\u624d\u7684\u547d\u4ee4 \u4e0d\u5305\u62ec<code>undo</code>\u548c<code>redo</code>\u547d\u4ee4 <p>\u8bf4\u660e\uff1a \u82e5\u5148\u6309\u4e0b\u6570\u5b57\uff081~9\uff09\uff0c\u518d\u6309\u4e0b<code>.</code>\uff0c\u53ef\u91cd\u590d\u6267\u884c\u6307\u5b9a\u6b21\u6570\u3002</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u4fee\u6539change","title":"\u4fee\u6539\uff08change\uff09","text":"<p>\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/change.txt</code></p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u66ff\u6362\u5b57\u7b26replace_char","title":"\u66ff\u6362\u5b57\u7b26\uff08replace char\uff09","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>r</code> \u66ff\u6362\u5149\u6807\u6240\u5728\u7684\u5b57\u7b26 replace char\uff0c\u53ea\u66ff\u6362\u4e00\u6b21\u66ff\u6362\u540e\u6062\u590d\u6307\u4ee4\u6a21\u5f0f <code>R</code> \u8fdb\u5165REPLACE MODE \u8fde\u7eed\u4fee\u6539\u66ff\u6362\uff0c<code>&lt;Esc&gt;</code> \u9000\u51fa\u3002","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#case","title":"case","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>~</code> switch uppper/lower case Toggle case (Case =&gt; cASE) <code>gU</code> Uppercase \u5148\u9009\u5b9a\u518d\u6267\u884c\uff1b\u6216\u540e\u63a5 motion\uff0c\u4f8b\u5982 <code>w</code> <code>gu</code> Lowercase \u5148\u9009\u5b9a\u518d\u6267\u884c\uff1b\u6216\u540e\u63a5 motion\uff0c\u4f8b\u5982 <code>w</code> <code>gUU</code> Uppercase current line also <code>gUgU</code> <code>guu</code> Lowercase current line also <code>gugu</code>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u590d\u5236yankcopy","title":"\u590d\u5236\uff08yank/copy\uff09","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>y</code> \u6309\u4e0b<code>l</code>\uff0c\u5411\u53f3\u590d\u5236\u4e00\u4e2a\u5b57\u7b26\u6309\u4e0b<code>h</code>\uff0c\u5411\u5de6\u590d\u5236\u4e00\u4e2a\u5b57\u7b26\u6309\u4e0b<code>w</code>\uff0c\u5411\u53f3\u590d\u5236\u4e00\u4e2a\u5355\u8bcd \u6309\u4e0b<code>e</code>\uff0c\u5411\u53f3\u590d\u5236\u81f3\u5355\u8bcd\u672b \u6309\u4e0b<code>b</code>\uff0c\u5411\u5de6\u590d\u5236\u4e00\u4e2a\u5355\u8bcd copy char forwardcopy char backwardcopy word forward\uff0c\u5305\u62ec\u7a7a\u683c copy word forward\uff0c\u4e0d\u5305\u62ec\u7a7a\u683c copy word backward <code>y0</code> \u590d\u5236\u5230\u884c\u9996 copy to BOL <code>y$</code> \u590d\u5236\u5230\u884c\u672b copy to EOL <p>\u8bf4\u660e\uff1a</p> <p>\u82e5\u5148\u6309\u4e0b\u6570\u5b57\uff081~9\uff09\uff0c\u518d\u6309\u4e0b <code>y</code>\u3001<code>Y</code> \u6216 <code>yy</code>\uff0c\u5219\u8868\u793a\u590d\u5236\u6307\u5b9a\u6570\u91cf\u7684\u5b57\u7b26\u3001\u5355\u8bcd\u6216\u884c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u590d\u5236\u884c","title":"\u590d\u5236\u884c","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>Y</code>/<code>yy</code> \u590d\u5236\u672c\u884c copy/Yank line\u6309<code>p</code>\u4f1a\u63d2\u5165\u7c98\u8d34\u5230\u65b0\u8d77\u4e0b\u4e00\u884c <code>y1G</code> \u590d\u5236\u672c\u884c\u5230\u9996\u884c copy to BOF <code>yG</code> \u590d\u5236\u672c\u884c\u5230\u672b\u884c copy to EOF <code>y-</code>/<code>yk</code> \u590d\u5236\u5f53\u524d\u53ca\u4e0a\u4e00\u884c copy line above <code>y+</code> \u590d\u5236\u5f53\u524d\u53ca\u4e0b\u4e00\u884c copy line below <p>\u4ee5\u4e0b\u4e3a\u590d\u5236\u5f53\u524d\u884c\u53ca\u5176\u4e0b4\u884c\uff08\u5171\u590d\u52365\u884c\uff09\u7684\u64cd\u4f5c\u65b9\u6cd5\uff1a</p> <ol> <li><code>y4k</code> \u590d\u5236\u5f53\u524d\u884c\u53ca\u5176\u4e0a4\u884c\uff1b<code>y4+</code> \u590d\u5236\u5f53\u524d\u884c\u53ca\u5176\u4e0b4\u884c\uff1b  </li> <li>\u666e\u901a\u6a21\u5f0f\u6267\u884c <code>5yy</code>: \u590d\u5236\u5f53\u524d\u5149\u6807\u6240\u5728\u53ca\u5176\u4e0b\u603b\u51715\u884c\uff1b  </li> <li>\u5047\u8bbe\u5f53\u524d\u5149\u6807\u5728\u7b2c4\u884c\uff0c\u666e\u901a\u6a21\u5f0f\u6267\u884c <code>y8G</code>(\u6216 <code>y8gg</code>)\uff0c\u590d\u5236\u7b2c4\u52308\u51715\u884c\uff1b  </li> <li>\u5e95\u884c\u6a21\u5f0f\u6267\u884c <code>:4,8y</code> \u590d\u5236\u7b2c4\u52308\u51715\u884c\uff1b  </li> <li>\u5047\u8bbe\u5f53\u524d\u5149\u6807\u5728\u7b2c4\u884c\uff0c<code>V4j</code> \u5411\u4e0b\u9009\u4e2d\u7b2c4\u52308\u884c\uff0c\u518d\u6267\u884c <code>y</code> \u5373\u53ef\u590d\u5236\u3002\u6309\u4e0b <code>.</code> \u53ef\u91cd\u590d\u5411\u4e0b\u590d\u52365\u884c\u3002  </li> </ol>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u7c98\u8d34pasteput_back","title":"\u7c98\u8d34\uff08paste/put back\uff09","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>p</code> \u5411\u540e\u7c98\u8d34 paste forward\u5728\u5f53\u524d\u5149\u6807\u6240\u5728\u5b57\u7b26\u7684\u540e\u9762\u7c98\u8d34 <code>P</code>(<code>&lt;S-p&gt;</code>) \u5411\u524d\u7c98\u8d34 paste backward\u5728\u5f53\u524d\u5149\u6807\u6240\u5728\u5b57\u7b26\u7684\u524d\u9762\u7c98\u8d34 <code>:r [filename]</code> \u5728\u5f53\u524d\u5149\u6807\u6240\u5728\u884c\u7684\u4e0b\u9762\u8bfb\u5165filename\u6587\u6863\u7684\u5185\u5bb9 <code>:r !date</code> \u5c06<code>date</code>\u547d\u4ee4\u6267\u884c\u7ed3\u679c\uff08\u5f53\u524d\u65e5\u671f\uff09\u5199\u5165\u5f53\u524dvim\u5149\u6807\u5904 reads the output of the <code>date</code> command and puts it below the cursor <p>\u8bf4\u660e\uff1a</p> <ol> <li><code>P</code>\u548c<code>p</code>\u7684\u533a\u522b\uff0c\u76f8\u5f53\u4e8e<code>i</code>\u548c<code>a</code>\u3002  </li> <li><code>y</code>\u548c<code>p</code>\u7684\u590d\u5236\u7c98\u8d34\u53ea\u9488\u5bf9vim\u7f16\u8f91\u5668\u6709\u6548\uff0c<code>y</code>\uff08\u5305\u62ec\u4e0b\u6587\u4e2d\u7684<code>d</code>\u526a\u5207\u64cd\u4f5c\uff09\u590d\u5236\u7684\u5185\u5bb9\u4e0d\u5728\u7cfb\u7edf\u526a\u5207\u677f\u4e2d\uff0c\u5728vim\u5916\u65e0\u6cd5\u4f7f\u7528<code>&lt;C-v&gt;</code>\u8fdb\u884c\u7c98\u8d34\u3002  </li> <li>\u82e5\u5148\u6309\u4e0b\u6570\u5b57\uff081~9\uff09\uff0c\u518d\u6309\u4e0b<code>p</code>\u6216<code>P</code>\uff0c\u5219\u8868\u793a\u91cd\u590d\u7c98\u8d34\u6307\u5b9a\u6b21\u6570\u3002  </li> </ol> <p><code>2yy</code>\uff1a\u590d\u5236\u4e24\u884c\u3002</p> <p>vim \u7c98\u8d34\u81ea\u52a8\u7f29\u8fdb\u5bfc\u81f4\u683c\u5f0f\u6df7\u4e71\u95ee\u9898\u89e3\u51b3\u65b9\u6848\uff1a</p> <p>configuration - Turning off auto indent when pasting text into vim - Stack Overflow</p> <p>\u5728 ~/.vimrc \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u884c:</p> <pre><code>let &amp;t_SI .= \"\\&lt;Esc&gt;[?2004h\"\nlet &amp;t_EI .= \"\\&lt;Esc&gt;[?2004l\"\n\ninoremap &lt;special&gt; &lt;expr&gt; &lt;Esc&gt;[200~ XTermPasteBegin()\n\nfunction! XTermPasteBegin()\n  set pastetoggle=&lt;Esc&gt;[201~\n  set paste\n  return \"\"\nendfunction\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u5220\u9664delete","title":"\u5220\u9664\uff08delete\uff09","text":"","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#xsdelete_char","title":"x/s\uff08delete char\uff09","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>x</code> \u5411\u53f3\u5220\u9664\u4e00\u4e2a\u5b57\u7b26(<code>dl</code>) delete char forward <code>X</code>\uff08<code>&lt;S-x&gt;</code>\uff09 \u9000\u683c\u5220\u9664\u4e00\u4e2a\u5b57\u7b26(<code>dh</code>) delete char backward/backspace <code>s</code> \u5411\u53f3\u5220\u9664\u4e00\u4e2a\u5b57\u7b26(<code>cl</code>)\uff0c\u5e76\u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f delete char forward and enter inset mode <code>S</code> \u5220\u9664\u672c\u884c(<code>cc</code>)\uff0c\u5e76\u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f Delete [count] lines and start insert. <p>\u8bf4\u660e\uff1a</p> <ul> <li>\u5b9e\u9645\u4e0a\u8fd9\u91cc\u7684\u5220\u9664\u90fd\u662f <code>delete [into register x]</code>\uff0c\u7b49\u6548\u4e8e\u526a\u5207\uff0c\u53ef\u4f7f\u7528 <code>p</code>/<code>P</code> \u7c98\u8d34\u56de\u6765\u3002  </li> <li>\u82e5\u5148\u6309\u4e0b\u6570\u5b57\uff081~9\uff09\uff0c\u518d\u6309\u4e0b <code>x</code>/<code>X</code> \u6216 <code>d</code>/<code>dd</code>\uff0c\u5219\u8868\u793a\u5220\u9664\u6307\u5b9a\u6570\u91cf\u7684\u5b57\u7b26\u3001\u5355\u8bcd\u6216\u884c\u3002  </li> <li>\u7ec4\u5408\u547d\u4ee4\u6548\u679c\uff1a<code>xp</code> \u76f8\u5f53\u4e8e\u4ea4\u6362\u4e24\u4e2a\u5b57\u7b26\u7684\u4f4d\u7f6e\u3002  </li> <li>\u53ef\u6309\u952e <code>v</code> \u8fdb\u5165\u53ef\u89c6\u6a21\u5f0f\uff08Visual Mode\uff09\uff0c\u9488\u5bf9\u9009\u5b9a\u5185\u5bb9\u4f5c\u590d\u5236\u3001\u5220\u9664\u64cd\u4f5c\u3002  </li> </ul>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#dcdelete_motionobject","title":"d/c\uff08delete motion/object\uff09","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>d</code> \u6309\u4e0b<code>l</code>\uff0c\u76f8\u5f53\u4e8e<code>x</code>\u6309\u4e0b<code>h</code>\uff0c\u76f8\u5f53\u4e8e<code>X</code> \u6309\u4e0b<code>w</code>\uff0c\u5411\u53f3\u5220\u9664\u4e00\u4e2a\u5355\u8bcd \u6309\u4e0b<code>e</code>\uff0c\u5411\u53f3\u5220\u9664\u81f3\u5355\u8bcd\u672b\u6309\u4e0b<code>b</code>\uff0c\u5411\u5de6\u5220\u9664\u4e00\u4e2a\u5355\u8bcd \u6309\u4e0b<code>j</code>\uff0c\u5220\u9664\u672c\u884c\u53ca\u4e0b\u4e00\u884c \u6309\u4e0b<code>k</code>\uff0c\u5220\u9664\u672c\u884c\u53ca\u4e0a\u4e00\u884c delete char forwarddelete char backward/backspacedelete word forward\uff0c\u4e0d\u5305\u62ec\u4e0b\u4e00\u4e2a\u5355\u8bcd\u9996\u5b57\uff0c\u5220\u9664\u7a7a\u683cdelete to the end of the word\uff0c\u5305\u62ec\u4e0b\u4e00\u4e2a\u5355\u8bcd\u9996\u5b57\uff0c\u4fdd\u7559\u8bcd\u95f4\u7a7a\u683cdelete word backwarddelete current line and belowdelete current line and above <code>d0</code> \u5220\u9664\u81f3\u884c\u9996 delete to BOL <code>D</code>/<code>d$</code> \u5220\u9664\u81f3\u884c\u672b delete to EOL <p><code>d*</code> \u8fd9\u79cd\u8bed\u6cd5\u683c\u5f0f\u79f0\u4e3a\uff1a<code>operator + motion</code> / <code>operator + object</code>\u3002</p> <p>\u5220\u9664\u540e\u7f16\u8f91\uff1a</p> <p>\u4e0e<code>d</code>\u3001<code>D</code>/<code>d$</code>\u3001<code>dd</code>\u3001<code>dG</code>\u5bf9\u5e94\u7684\u6709<code>c</code>\u3001<code>C</code>/<code>c$</code>\u3001<code>cc</code>/<code>S</code>\u3001<code>cG</code>\u3002 <code>c</code>\u547d\u4ee4\u76f8\u5bf9<code>d</code>\u547d\u4ee4\u4e0d\u540c\u7684\u662f\u5220\u9664\u540e\u8fdb\u5165insert\u6a21\u5f0f\uff0c\u76f8\u5f53\u4e8e\u4fee\u6539\uff08 <code>c</code> \u610f\u5373 change \uff09\u3002</p> <p>\u8bf4\u660e\uff1a</p> <ul> <li>\u5b9e\u9645\u4e0a\u8fd9\u91cc\u7684\u5220\u9664\u90fd\u662f <code>delete [into register x]</code>\uff0c\u7b49\u6548\u4e8e\u526a\u5207\uff0c\u53ef\u4f7f\u7528 <code>p</code>/<code>P</code> \u7c98\u8d34\u56de\u6765\u3002</li> <li> <p>\u5728operator\u548cmotion\u4e4b\u95f4\u6216\u4e4b\u524d\u589e\u52a0\u6570\u5b57\uff08prepend motion with a number:\uff09\uff1a <code>d [number] motion</code>\u6216<code>[number] d motion</code></p> <p><code>d2w</code>\u6216<code>2dw</code>\uff1a\u5220\u9664\u5149\u6807\u6240\u5728\uff08\u4e4b\u540e\uff09\u7684\u4e24\u4e2a\u5355\u8bcd\uff08word\uff09\u3002</p> </li> <li> <p>\u7ec4\u5408\u547d\u4ee4\u6548\u679c\uff1a</p> <p><code>dt.</code> \u8868\u793a\u5220\u9664\u5f53\u524d\u4f4d\u7f6e\u5230\u4e0b\u4e00\u4e2a\u53e5\u53f7\u4e4b\u95f4\u7684\u5185\u5bb9\u3002</p> </li> <li> <p>\u53ef\u6309\u952e <code>v</code> \u8fdb\u5165\u53ef\u89c6\u6a21\u5f0f\uff08Visual Mode\uff09\uff0c\u9488\u5bf9\u9009\u5b9a\u5185\u5bb9\u4f5c\u590d\u5236\u3001\u5220\u9664\u64cd\u4f5c\u3002</p> </li> </ul>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u5220\u9664\u884cdelete_line","title":"\u5220\u9664\u884c\uff08delete line\uff09","text":"<p>\u7ed3\u5408\u884c\u95f4\u79fb\u52a8\u7684 motion\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u6f14\u7ec4\u5408\u56f4\u7ed5\u5f53\u524d\u884c\u8fdb\u884c\u4e0a\u4e0b\u884c\u7684\u5220\u9664\u3002</p> \u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>dd</code> \u5220\u9664\u672c\u884c delete line\uff0c\u4e0b\u884c\u4e0a\u79fb <code>dgg</code> / <code>d1G</code> \u5220\u9664\u672c\u884c\u5230\u9996\u884c delete current line to first line <code>dG</code> \u5220\u9664\u672c\u884c\u5230\u672b\u884c delete current line to last line <code>d-</code> \u5220\u9664\u5230\u4e0a\u4e00\u884c\u9996 \u5220\u9664\u5f53\u524d\u884c\u548c\u4e0a\u4e00\u884c <code>d+</code> \u5220\u9664\u5230\u4e0b\u4e00\u884c\u9996 \u5220\u9664\u5f53\u524d\u884c\u548c\u4e0b\u4e00\u884c <p>\u5728\u64cd\u4f5c\u7b26\uff08operator\uff09\u548c\u79fb\u52a8\uff08motion\uff09 \u4e4b\u95f4\u63d2\u5165\u6570\u5b57\uff0c\u5219\u8868\u793a\u5220\u9664\u5411\u4e0a/\u4e0b\u7684\u51e0\u884c\u3002</p> <p><code>d3-</code>\uff1a\u5220\u9664\u5f53\u524d\u884c\u53ca\u5411\u4e0a\u76843\u884c\uff0c\u603b\u5171\u5220\u96644\u884c\uff1b <code>d3+</code>\uff1a\u5220\u9664\u5f53\u524d\u884c\u53ca\u5411\u4e0b\u76843\u884c\uff0c\u603b\u5171\u5220\u96644\u884c\u3002 <code>d2d</code>\u6216<code>2dd</code>\uff1a\u5220\u9664\u4e24\u884c\u3002 <code>ddp</code> \u76f8\u5f53\u4e8e\u4ea4\u6362\u4e24\u884c\u7684\u4f4d\u7f6e\u3002  </p> <p>\u5220\u9664\u591a\u884c\u7684\u64cd\u4f5c\u65b9\u6cd5\u53c2\u8003\u590d\u5236\u3002</p> <p>How can I delete multiple lines in vi? How to Delete Line in VIM on Linux How to delete lines in Vim</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u884c\u7f29\u8fdb","title":"\u884c\u7f29\u8fdb","text":"<p>The \"&gt;\" and \"&lt;\" commands are handy for changing the indentation within programs. Use the 'shiftwidth' option to set the size of the white space which these commands insert or delete.  Normally the 'shiftwidth' option is 8.</p> \u6307\u4ee4 \u8bf4\u660e <code>&lt;</code> Shift {motion} lines one 'shiftwidth' leftwards. <code>&lt;&lt;</code> Shift [count] lines one 'shiftwidth' leftwards. {Visual}[count]<code>&lt;</code> Shift the highlighted lines [count] 'shiftwidth' leftwards. <code>&gt;</code> Shift {motion} lines one 'shiftwidth' rightwards. <code>&gt;&gt;</code> Shift [count] lines one 'shiftwidth' rightwards. {Visual}[count]<code>&gt;</code> Shift the highlighted lines [count] 'shiftwidth' rightwards. \u547d\u4ee4 \u8bf4\u660e <code>:[range]&lt;</code> Shift [range] lines one \\'shiftwidth\\' left. Repeat <code>&lt;</code> for shifting multiple \\'shiftwidth\\'s. <code>:[range]&lt; {count}</code> Shift {count} lines one \\'shiftwidth\\' left, starting with [range].Repeat <code>&lt;</code> for shifting multiple 'shiftwidth's. <code>:[range]le[ft] [indent]</code> left align lines in [range].  Sets the indent in the lines to [indent] (default 0). <code>:[range]&gt; [flags]</code> Shift {count} [range] lines one 'shiftwidth' right.Repeat <code>&gt;</code> for shifting multiple 'shiftwidth's. <code>:[range]&gt; {count} [flags]</code> Shift {count} lines one 'shiftwidth' right, starting with [range].Repeat <code>&gt;</code> for shifting multiple 'shiftwidth's. <p>\u8bf4\u660e\uff1a</p> <p>See |ex-flags| for [flags].</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u884c\u5408\u5e76","title":"\u884c\u5408\u5e76","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>J</code> \u5408\u5e76\u4e24\u884c\uff08Join Lines\uff09 \u5c06\u4e0b\u4e00\u884c\u5408\u5e76\u5230\u5f53\u524d\u884c\u3002","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u6279\u91cf\u7f16\u8f91","title":"\u6279\u91cf\u7f16\u8f91","text":"<p>vi/vim \u4e2d\u5982\u4f55\u5728\u6bcf\u884c\u884c\u9996\u6216\u884c\u5c3e\u63d2\u5165\u6307\u5b9a\u5b57\u7b26\u4e32 </p> <p>\u53ef\u524d\u5411\u53c2\u8003 \u300a010 - vim \u641c\u7d22\u300b\u4e2d\u7684 <code>:s</code> \u6279\u91cf\u67e5\u627e\u66ff\u6362\u793a\u4f8b\u3002</p> <p>\u6280\u5de7\uff1aVim \u7684\u7eb5\u5411\u7f16\u8f91\u6a21\u5f0f</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u884c\u7f16\u8f91\u590d\u5236\u7c98\u8d34\u548c\u5220\u9664","title":"\u884c\u7f16\u8f91\u590d\u5236\u7c98\u8d34\u548c\u5220\u9664","text":"<p><code>v</code>               | \u666e\u901a\u6a21\u5f0f\u5207\u6362\u5230\u53ef\u89c6\u6a21\u5f0f       | \u4ece\u5f53\u524d\u5149\u6807\u5f00\u59cb\u9009\u62e9\uff1a- \u901a\u8fc7 <code>h</code>/<code>l</code> \u6216 <code>b</code>/<code>w</code> \u5c55\u5f00\u884c\u5185\u9009\u62e9- \u901a\u8fc7<code>j</code>/<code>k</code>\u6269\u5c55\u884c\u95f4\u9009\u62e9 <code>V</code>(<code>&lt;S-v&gt;</code>)      | \u666e\u901a\u6a21\u5f0f\u5207\u6362\u5230\u53ef\u89c6\u884c\u6a21\u5f0f | VISUAL LINE\uff1a\u9488\u5bf9\u6574\u884c\u9009\u5b9a\u6a21\u5f0f</p> <p>\u6572 <code>v</code> \u4ece\u666e\u901a\u6a21\u5f0f\u5207\u6362\u5230\u53ef\u89c6\u6a21\u5f0f\uff0c\u7136\u540e\u53ef\u5229\u7528\u65b9\u5411\u952e\u5c55\u5f00\u884c\u5185/\u884c\u95f4\u9009\u62e9\uff0c\u6216\u6572 <code>V</code>(<code>&lt;S-v&gt;</code>) \u5207\u6362\u5230\u53ef\u89c6\u884c\u6a21\u5f0f\u652f\u6301\u6574\u884c\u9009\u5b9a\u3002 \u7136\u540e\u518d\u5bf9\u9009\u5b9a\u7684\u5185\u5bb9\u6267\u884c\u590d\u5236\uff08y\uff09\u3001\u7c98\u8d34\uff08p\uff09\u6216\u5220\u9664\uff08d\uff09\u3002</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u5217\u7f16\u8f91\u63d2\u5165","title":"\u5217\u7f16\u8f91\u63d2\u5165","text":"<ol> <li>\u6309 0\uff08\u6216 ^\uff09\u5c06\u9f20\u6807\u79fb\u52a8\u5230\u884c\u9996\uff08\u975e\u7a7a\u767d\u5b57\u5143\uff09\uff0c\u6309 <code>CTRL-V</code> \u5feb\u6377\u952e\u8fdb\u5165 VISUAL BLOCK \u5217\u9009\u6a21\u5f0f\uff1b  </li> <li>\u901a\u8fc7\u4e0a\u4e0b\u65b9\u5411\u952e\uff08j\u3001k\uff09\u79fb\u52a8\u5149\u6807\uff0c\u5c06\u9700\u8981\u6ce8\u91ca\u7684\u884c\u7684\u5f00\u5934\u6807\u8bb0\u8d77\u6765\uff1b  </li> <li>\u6309\u4e0b\u5927\u5199\u7684 I\uff08<code>&lt;S-i&gt;</code>\uff09\u8fdb\u5165\u884c\u9996\u63d2\u5165\u6a21\u5f0f\uff0c\u8f93\u5165\u6ce8\u91ca\u7b26\uff08<code>//</code> \u6216 <code>#</code>\uff09\uff0c\u7136\u540e\u6309\u4e0b Esc \u9000\u51fa\u63d2\u5165\u6a21\u5f0f\uff0c\u8fd4\u56de\u666e\u901a\u6a21\u5f0f\u67e5\u770b\u5217\u63d2\u5165\u7ed3\u679c\u3002  </li> </ol> <p>\u4e3a\u5f53\u524d\u884c\u53ca\u5176\u4e0b5\u884c\uff08\u51716\u884c\uff09\u7684\u884c\u9996\u6dfb\u52a0 <code>//</code> \u6ce8\u91ca\u7b26\u53f7\u7684\u64cd\u4f5c\u7cfb\u5217\uff1a</p> <pre><code>0        \"\u5b9a\u4f4d\u5230\u884c\u9996\n&lt;C-v&gt;    \"\u8fdb\u5165 VISUAL BLOCK \u6a21\u5f0f\n5j       \"\u5149\u6807\u5217\u4f4d\u5411\u4e0b\u6269\u5c555\u884c\nI        \"\u8fdb\u5165\u5217\u5757\u7684\u884c\u9996\u63d2\u5165\u6a21\u5f0f\n//       \"\u8f93\u5165\u8981\u63d2\u5165\u7684\u6ce8\u91ca\u7b26\u53f7\nesc      \"\u9000\u51fa INSERT \u6a21\u5f0f\uff0c\u8fd4\u56de\u666e\u901a\u6a21\u5f0f\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5229\u7528 <code>.</code> \u91cd\u590d\u64cd\u4f5c\uff1a<code>I// &lt;esc&gt;</code>\uff0c\u7136\u540e\u6309 <code>j.</code> \u91cd\u590d\u5728\u4e0b\u9762\u7684\u5404\u884c\u9996\u63d2\u5165\u3002</p> <p>\u5982\u679c\u60f3\u4e3a\u5f53\u524d\u884c\u53ca\u5176\u4e0b5\u884c\uff08\u51716\u884c\uff09\u7684\u884c\u5c3e\u6dfb\u52a0 <code>//</code> \u6ce8\u91ca\u7b26\u53f7\u5462\uff1f\u8fd9\u91cc\u7684\u95ee\u9898\u5728\u4e8e\u6bcf\u4e00\u884c\u7684\u957f\u77ed\u4e0d\u4e00\u3002\u64cd\u4f5c\u7cfb\u5217\u5982\u4e0b\uff1a</p> <pre><code>&lt;C-v&gt;    \"\u8fdb\u5165 VISUAL BLOCK \u6a21\u5f0f\n5j$      \"\u5149\u6807\u5217\u4f4d\u5411\u4e0b\u6269\u5c555\u884c\uff0c\u6269\u5c55\u81f3\u884c\u5c3e\nA        \"\u8fdb\u5165\u5217\u5757\u7684\u884c\u5c3e\u8ffd\u52a0\u6a21\u5f0f\n//       \"\u8f93\u5165\u8981\u63d2\u5165\u7684\u6ce8\u91ca\u7b26\u53f7\nesc      \"\u9000\u51fa INSERT \u6a21\u5f0f\uff0c\u8fd4\u56de\u666e\u901a\u6a21\u5f0f\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5229\u7528 <code>.</code> \u91cd\u590d\u64cd\u4f5c\uff1a<code>A// &lt;esc&gt;</code>\uff0c\u7136\u540e\u6309 <code>j.</code> \u91cd\u590d\u5728\u4e0b\u9762\u7684\u5404\u884c\u9996\u63d2\u5165\u3002</p> <p>\u5982\u679c\u60f3\u5728\u5f53\u524d\u884c\u53ca\u5176\u4e0b5\u884c\uff08\u51716\u884c\uff09\u7684\u884c\u5c3e\u7684 <code>;</code> \u4e4b\u540e\u6dfb\u52a0 <code>//</code>\uff0c\u53ef\u4ee5\u5229\u7528 <code>.</code> \u91cd\u590d\u64cd\u4f5c\uff1a<code>f;A // &lt;esc&gt;</code>\uff0c\u7136\u540e\u6309 <code>j.</code> \u91cd\u590d\u5728\u4e0b\u9762\u7684\u5404\u884c\u9996\u63d2\u5165\u3002</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u5217\u7f16\u8f91\u5220\u9664","title":"\u5217\u7f16\u8f91\u5220\u9664","text":"<p>\u5982\u679c\u4e0a\u4e00\u6b65\u7684\u6ce8\u91ca\u662f\u5355\u4e2a\u5b57\u7b26 <code>#</code>\uff0c\u53ef\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u79fb\u9664\uff1a</p> <ol> <li>\u6309 <code>CTRL-V</code> \u5feb\u6377\u952e\u8fdb\u5165 VISUAL BLOCK \u5217\u9009\u6a21\u5f0f\uff1b  </li> <li>\u901a\u8fc7\u4e0a\u4e0b\u65b9\u5411\u952e\uff08j\u3001k\uff09\u79fb\u52a8\u5149\u6807\uff0c\u5c06\u9700\u8981\u53cd\u6ce8\u91ca\u7684\u884c\u7684\u5f00\u5934\u5b57\u7b26 <code>#</code> \u6807\u8bb0\u8d77\u6765\uff1b  </li> <li>\u6309 x \u952e\u6279\u91cf\u5220\u9664\u5217\u9009\u7684 <code>#</code> \u5b57\u7b26\u3002  </li> </ol> <p>\u5982\u679c\u4e0a\u4e00\u6b65\u7684\u6ce8\u91ca\u662f\u53cc\u5b57\u7b26 <code>//</code>\uff0c\u5219\u7b2c2\u6b65\u9700\u6309\u4e0b <code>l</code> \u5148\u5411\u53f3\u6269\u9009\u4e00\u5217\uff0c\u518d\u6309 <code>j</code> \u5411\u4e0b\u6269\u9009\u884c\u8303\u56f4\uff0c\u7136\u540e\u518d\u6309\u4e0b d \u952e\u5220\u9664\u5217\u9009\u3002</p> <p>\u5f53\u7136\u4e5f\u53ef\u4ee5\u5148\u6309 <code>j</code> \u5411\u4e0b\u6269\u9009\u884c\uff0c\u518d <code>l</code> \u5411\u53f3\u6269\u90091\u5217\u3002</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u63d2\u5165\u884c\u53f7","title":"\u63d2\u5165\u884c\u53f7","text":"<p>\u5982\u4f55\u4f7f\u7528Vim\u4e3a\u6bcf\u4e00\u884c\u81ea\u52a8\u7f16\u53f7\uff1f </p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#nl","title":"nl","text":"<p><code>:%!nl</code> : \u5728\u6240\u6709\u975e\u7a7a\u884c\u524d\u52a0\u5165\u884c\u53f7 <code>:%!nl -ba</code> : \u5728\u6240\u6709\u884c\u524d\u52a0\u5165\u884c\u53f7 \u5229\u7528 Linux \u547d\u4ee4 nl \u6765\u5b9e\u73b0\u7684  </p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#line","title":"line","text":"<p>\u5982\u4f55\u4f7f\u7528Vim\u4e3a\u6bcf\u4e00\u884c\u81ea\u52a8\u7f16\u53f7\uff1f</p> <p>\u6bcf\u884c\uff08\u5305\u62ec\u7a7a\u767d\u884c\uff09\u524d\u9762\u63d2\u5165\u884c\u53f7\uff1a</p> <pre><code>:%s/^/\\=line(\".\")/\n</code></pre> <p>\u5f53 <code>:s</code> \u547d\u4ee4\u7684\u66ff\u6362\u5b57\u7b26\u4e32\u4ee5 <code>\\=</code> \u5f00\u5934\u65f6\uff0c\u8868\u793a\u4ee5\u8868\u8fbe\u5f0f\u7684\u8ba1\u7b97\u7ed3\u679c\u4f5c\u4e3a\u66ff\u6362\u503c\u3002</p> <p>\u4ee5\u4e0b\u5728\u6bcf\u884c\u524d\u9762\u6dfb\u52a0 <code>\u884c\u53f7,</code>\uff1a</p> <pre><code>:%s/^/\\=line('.').','/\n</code></pre> <p>\u4ee5\u4e0b\u5728\u6bcf\u884c\u524d\u9762\u6dfb\u52a0 <code>\u884c\u53f7,TAB</code>\uff1a</p> <pre><code>:%s/^/\\=line(\".\").\",\\t\"/\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u4fdd\u5b58\u9000\u51fasave__exit","title":"\u4fdd\u5b58\u9000\u51fa\uff08save &amp; exit\uff09","text":"<p>\u8be6\u60c5\u53c2\u8003 <code>/usr/share/vim/vim[0-9][0-9]/doc/editing.txt</code> \u7ae0\u8282\u3002</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#discardrecover","title":"Discard(recover)","text":"<p>\u5173\u952e\u5b57\uff1a<code>:edit!</code> discard \u547d\u4ee4\uff1a<code>:e[dit]! [++opt] [+cmd]</code> \u4f5c\u7528\uff1a\u4ece\u78c1\u76d8\u91cd\u65b0\u52a0\u8f7d\uff0c\u8986\u76d6\u5f53\u524d\u7f13\u5b58\u7684\u4fee\u6539\u3002</p> <pre><code>Edit the current file always.\nDiscard any changes to the current buffer.\nThis is useful if you want to start all over again.\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#writingwupsav","title":"Writing(w,up,sav)","text":"<p>\u5173\u952e\u5b57\uff1awriting, save-file </p> <p>\u5173\u952e\u5b57\uff1a<code>:w</code>, :write \u547d\u4ee4\uff1a<code>:w[rite][!] [++opt]</code> \u5e2e\u52a9\uff1a<code>:h :w[rite]</code> \u4f5c\u7528\uff1a\u5c06 vim \u7f16\u8f91\u7f13\u5b58\u56de\u5199\u6587\u4ef6\u3002  </p> <pre><code>Write the whole buffer to the current file.  \n'!' forcefully write when 'readonly' is set  \n</code></pre> <p>\u5173\u952e\u5b57\uff1a<code>:up</code>, :update \u547d\u4ee4\uff1a<code>:[range]up[date][!] [++opt] [&gt;&gt;] [file]</code> \u5e2e\u52a9\uff1a<code>:h :up[date]</code> \u4f5c\u7528\uff1a\u5f53\u6709\u7f16\u8f91\u65f6\uff0c\u5c06\u6539\u52a8\u56de\u5199\u6587\u4ef6\u3002  </p> <pre><code>Like \":write\", but only write when the buffer has been modified.  \n</code></pre> <p>\u5173\u952e\u5b57\uff1a<code>:sav</code>, :saveas \u547d\u4ee4\uff1a<code>:sav[eas][!] [++opt] {file}</code> \u5e2e\u52a9\uff1a<code>:h :sav[eas]</code> \u4f5c\u7528\uff1a\u5c06 vim \u7f16\u8f91\u7f13\u5b58\u53e6\u5b58\u4e3a\u6307\u5b9a\u6587\u4ef6\u3002  </p> <pre><code>Save the current buffer under the name {file} and set the filename of the current buffer to {file}.  \nThe [!] is needed to overwrite an existing file.  \n</code></pre>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#mkdir","title":"mkdir","text":"<p>\u5f53\u6267\u884c <code>vim filepath</code> \u6216 <code>:edit filepath</code> \u4e2d\u95f4\u7684\u76ee\u5f55\u4e0d\u5b58\u5728\u65f6\uff0c\u5c1d\u8bd5\u56de\u5199\u4fdd\u5b58\u5c06\u63d0\u793a\u76ee\u5f55\u4e0d\u5b58\u5728\u7684\u51fa\u9519\u4fe1\u606f\u3002 \u6b64\u65f6\uff0c\u53ef\u4ee5\u8c03\u7528 shell \u547d\u4ee4 <code>mkdir -p</code> \u6309\u9700\u521b\u5efa\u4e2d\u95f4\u76ee\u5f55\u8fdb\u884c\u8865\u6551\uff1a</p> <pre><code>:!mkdir -p %:h\n:write\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#sudo","title":"sudo","text":"<p>\u5982\u679c vim \u4ee5\u666e\u901a\u8eab\u4efd\u6253\u5f00\u4e86 root \u7528\u6237\u7684\u6587\u4ef6\uff08\u4f8b\u5982 <code>/etc/hosts</code>\uff09\uff0c\u5c1d\u8bd5\u5c06\u4fee\u6539\u540e\u7684 buffer \u56de\u5199\u78c1\u76d8\uff0c\u5219\u63d0\u793a\u6ca1\u6709\u6743\u9650\uff1a</p> <pre><code>:write\nE45: 'readonly' option is set(add ! to override)\n</code></pre> <p><code>:w!</code> \u5c1d\u8bd5\u5f3a\u5236\u5199\u5165\uff1a</p> <pre><code>:w!\n\"etc/hosts\" E212: Can`t open file for writing\n</code></pre> <p>\u73b0\u5728\u7684\u95ee\u9898\u5728\u4e8e\uff0c\u6211\u4eec\u6ca1\u6709\u5199 <code>/etc/hosts</code> \u6587\u4ef6\u7684\u6743\u9650\u3002</p> <p>\u8fd9\u4e2a\u6587\u4ef6\u662f\u7531 root \u7528\u6237\u62e5\u6709\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u8fd9\u6761\u602a\u6a21\u602a\u6837\u7684\u547d\u4ee4\u8865\u6551\uff1a</p> <pre><code>:w !sudo tee % &gt; /dev/null\n</code></pre> <p><code>:write !{cmd}</code> \u8fd9\u6761\u547d\u4ee4\u4f1a\u628a\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u4f5c\u4e3a\u6807\u51c6\u8f93\u5165\u4f20\u7ed9\u6307\u5b9a\u7684 <code>{cmd}</code>\u3002 \u4ee5\u4e0a\u547d\u4ee4\u4f1a\u628a\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u5f53\u4f5c\u6807\u51c6\u8f93\u5165\uff0c\u5e76\u7528\u5b83\u6765\u8986\u76d6 <code>/etc/hosts</code> \u7684\u5185\u5bb9\u3002</p>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#writing_with_multiple_bufferswa","title":"WRITING WITH MULTIPLE BUFFERS(wa)","text":"<p>\u5173\u952e\u5b57\uff1abuffer-write </p> <p>\u5173\u952e\u5b57\uff1a<code>:wa</code>, :wall \u547d\u4ee4\uff1a<code>:wa[ll][!]</code> \u5e2e\u52a9\uff1a<code>:h :wa[ll]</code> \u4f5c\u7528\uff1a\u5c06 vim \u6240\u6709\u7f16\u8f91\u7f13\u5b58\u56de\u5199\u5230\u5bf9\u5e94\u6587\u4ef6\u3002  </p> <pre><code>Write all changed buffers.  \nwith suffix '!': forcefully write even the ones that are readonly.  \n</code></pre>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#writing_and_quittingwq","title":"Writing and quitting(wq)","text":"<p>\u5173\u952e\u5b57\uff1awrite-quit </p> <p>\u5173\u952e\u5b57\uff1a<code>:q</code>, :quit \u547d\u4ee4\uff1a<code>:q[uit][!]</code> \u5e2e\u52a9\uff1a<code>:h :q[uit]</code> \u4f5c\u7528\uff1a\u5173\u95ed\u9000\u51fa\u5f53\u524d vim \u7a97\u53e3\uff1b\u5982\u6709\u6539\u52a8\u53ef\u8ffd\u52a0 <code>!</code> \u653e\u5f03\u4fee\u6539\u5f3a\u5236\u9000\u51fa\u3002  </p> <pre><code>Quit the current window. Quit Vim if this is the last window.  \nwith suffix '!': Quit without writing, also when currently visible buffers have changes.  \n</code></pre> <p>\u5173\u952e\u5b57\uff1a<code>:confirm</code>, :conf \u547d\u4ee4\uff1a<code>:conf[irm] {command}</code> \u5e2e\u52a9\uff1a<code>:h conf[irm]</code> \u4f5c\u7528\uff1a\u9000\u51fa\u65f6\uff0c\u5982\u6709\u9700\u8981\u5f39\u51fa\u786e\u8ba4\u6846\u3002</p> <pre><code>Quit, but give prompt when changes have been made  \n</code></pre> <p>\u4f8b\u5982\uff1a\u5982\u679c\u5f53\u524d\u6587\u6863\u6709\u6539\u52a8\u4f46\u672a\u4fdd\u5b58\uff0c\u8f93\u5165 <code>:conf[irm] q[uit]</code>\uff0c\u5c06\u5f39\u51fa confirm \u6587\u672c\u63d0\u793a\uff1a</p> <pre><code>Save changes to \"/tmp/*\"?\n[Y]es, (N)o, (C)ancel: \n</code></pre> <p>\u5173\u952e\u5b57\uff1a<code>:wq</code> \u547d\u4ee4\uff1a<code>:wq[!] [++opt] {file}</code> \u5e2e\u52a9\uff1a<code>:h :wq</code> \u4f5c\u7528\uff1a\u5c06 vim \u7f16\u8f91\u7f13\u5b58\u56de\u5199\u4fdd\u5b58\u5230\u6587\u4ef6\u5e76\u9000\u51fa\u3002\u5982\u679c\u662f <code>vim -R</code> \u6253\u5f00\u7684\u6587\u6863\u6216 <code>sudo vim</code> \u6253\u5f00\u7684\u65e0\u5199\u6743\u9650\u6587\u6863\uff0c\u53ef\u8ffd\u52a0 <code>!</code> \u5f3a\u5236\u4fdd\u5b58\u9000\u51fa\u3002</p> <pre><code>Write the current file to {file} and quit.  \nwith suffix '!': forcefully write when 'readonly'.  \n</code></pre>","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#last_line_mode","title":"Last Line Mode","text":"\u547d\u4ee4 \u8bf4\u660e \u5907\u6ce8 <code>:q</code> \u9000\u51fa\uff08quit\uff09 \u5982\u679c\u65e0\u4fee\u6539\u76f4\u63a5\u9000\u51fa\uff1b\u5426\u5219\u63d0\u793a<code>No write since last change (add ! to override)</code> <code>:q!</code> / <code>ZQ</code> \u5f3a\u5236\u9000\u51fa \u653e\u5f03\u4fee\u6539 <code>:w</code>/<code>:write</code> / <code>:up</code>/<code>:update</code> \u5199\u5165\uff08write\uff09\u4fdd\u5b58 \u4eceswap buffer\u5199\u5165\u6587\u4ef6\uff1b\u82e5\u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00\uff0c\u5219\u63d0\u793a'readonly' option is set (add ! to override)\uff1b\u4e5f\u53ef\u53e6\u5b58\u4e3a\uff1a<code>:w [filename]</code> <code>:w!</code> \u82e5\u6587\u672c\u5c5e\u6027\u4e3a\u53ea\u8bfb\u65f6\uff0c\u5f3a\u5236\u4fdd\u5b58 <code>:wq</code> / <code>ZZ</code> / <code>:x</code>/<code>:exit</code> \u4fdd\u5b58\u5e76\u9000\u51fa <code>:wq!</code> \u5f3a\u5236\u4fdd\u5b58\u5e76\u9000\u51fa","tags":["vim"]},{"location":"blog/20171018/007-vim-editing/#\u4fdd\u5b58\u90e8\u5206\u6587\u4ef6","title":"\u4fdd\u5b58\u90e8\u5206\u6587\u4ef6","text":"<p><code>:m,n w &lt;file&gt;</code>: \u5c06 m \u884c\u5230 n \u884c\u90e8\u5206\u7684\u5185\u5bb9\u4fdd\u5b58\u5230\u6587\u4ef6 file \u4e2d\uff1b <code>:m,n w &gt;&gt; &lt;file&gt;</code>: \u5c06 m \u884c\u5230 n \u884c\u7684\u5185\u5bb9\u8ffd\u52a0\u5230\u6587\u4ef6 file \u672b\u5c3e  </p> <p>To write a range of lines to another file you can use: Where <code>&lt;m&gt;</code> and <code>&lt;n&gt;</code> are numbers (or symbols) that designate a range of lines. For using the desktop clipboard, take a look at the <code>+g</code> commands.  </p> <p>While editing the file, make marks where you want the start and end to be using</p> <p><code>ma</code> - sets the a mark <code>mb</code> - sets the b mark  </p> <p>Then, to copy that into another file, just use the w command:</p> <pre><code>:'a,'b w /name/of/output/file.txt\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/","title":"vim\u914d\u7f6e","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 vim \u914d\u7f6e\u76f8\u5173\u57fa\u7840\u77e5\u8bc6\u5e76\u5217\u51fa\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u914d\u7f6e\u793a\u4f8b\u3002</p> <p>\u6267\u884c <code>vim --version</code> \u5c3e\u90e8\u6709\u5173\u4e8e vimrc \u7684\u4f4d\u7f6e\u8bf4\u660e:</p> <pre><code>\u03bb ~/ vim --version\nVIM - Vi IMproved 8.0 (2016 Sep 12, compiled Aug 17 2018 17:24:51)\nIncluded patches: 1-503, 505-680, 682-1283\nCompiled by root@apple.com\nNormal version without GUI.  Features included (+) or not (-):\n\n   system vimrc file: \"$VIM/vimrc\"\n     user vimrc file: \"$HOME/.vimrc\"\n 2nd user vimrc file: \"~/.vim/vimrc\"\n      user exrc file: \"$HOME/.exrc\"\n       defaults file: \"$VIMRUNTIME/defaults.vim\"\n  fall-back for $VIM: \"/usr/share/vim\"\nCompilation: gcc -c -I. -Iproto -DHAVE_CONFIG_H   -DMACOS_X_UNIX  -g -O2 -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=1\nLinking: gcc   -L/usr/local/lib -o vim        -lm -lncurses  -liconv -framework Cocoa\n</code></pre> <ol> <li>\u7cfb\u7edf\u7ea7\u914d\u7f6e\uff0c\u5bf9\u6240\u6709\u7528\u6237\u751f\u6548\uff1a<code>$VIM/vimrc</code> =  <code>/usr/share/vim/vimrc</code>\uff1b  </li> <li>\u7528\u6237\u7ea7\u914d\u7f6e1\uff0c\u5bf9\u5f53\u524d\u7528\u6237\u751f\u6548\uff1a<code>$HOME/.vimrc</code> = <code>~/.vimrc</code>\uff1b  </li> <li>\u7528\u6237\u7ea7\u914d\u7f6e2\uff0c\u5bf9\u5f53\u524d\u7528\u6237\u751f\u6548\uff1a<code>~/.vim/vimrc</code>\u3002  </li> </ol> <p>\u5728\u6bcf\u4e2a\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u4e0b\uff0c\u90fd\u6709\u4e00\u4e2a vi \u914d\u7f6e\u6587\u4ef6\".vimrc\"\u6216\".exrc\"\uff0c\u6ca1\u6709\u7684\u53ef\u4ee5\u65b0\u5efa\u4e00\u4e2a\u3002 \u7528\u6237\u53ef\u4ee5\u7f16\u8f91\u5b83\uff0c\u4f7f\u8fd9\u4e9b\u8bbe\u7f6e\u5728\u6bcf\u6b21\u542f\u52a8 vi \u65f6\u90fd\u6709\u6548\u3002</p> <p>vim\u914d\u7f6e\u53ef\u4ee5\u5728\u5e95\u884c\u6a21\u5f0f\u9488\u5bf9\u5f53\u524d\u6587\u6863\u7f16\u8f91\u8bbe\u5b9a\uff0c\u4f8b\u5982 <code>:set ai</code> \u8bbe\u5b9a <code>autoindent</code>\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d\uff08\u53ef\u7701\u6389\u5f00\u5934\u7684\u5192\u53f7\uff09\u3002</p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u914d\u7f6e\u8bed\u6cd5","title":"\u914d\u7f6e\u8bed\u6cd5","text":"","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#optionsfeatures","title":"options/features","text":"<p>\u53ef\u901a\u8fc7 <code>:help vimrc-intro</code> \u67e5\u770b vimrc \u914d\u7f6e\u5e2e\u52a9\u3002</p> <p>\u5177\u4f53\u914d\u7f6e\u9009\u9879\u53ef\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/options.txt</code></p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#setenable","title":"set/enable","text":"<p>Typing \":set xxx\" sets the option \"xxx\", or configure to <code>.vimrc</code>.</p> short long\uff08origin\uff09 comment 'ic' 'ignorecase' ignore upper/lower case when searching 'is' 'incsearch' show partial matches for a search phrase 'hls' 'hlsearch' highlight all matching phrases","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#unsetdisable","title":"unset/disable","text":"<p>Prepend \"no\" to switch an option off:</p> <p>:set noic</p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u65b0\u5efa_vimrc_\u6216_exrc","title":"\u65b0\u5efa .vimrc \u6216 .exrc","text":"<pre><code>\u279c  ~  cd ~\n\u279c  ~  touch .vimrc\n\u279c  ~  vi .vimrc\n</code></pre> <p>vim \u914d\u7f6e\u683c\u5f0f\u53ef\u53c2\u8003 <code>/usr/share/vim/vim[0-9][0-9]/vimrc_example.vim</code>\u3002</p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u8bbe\u7f6e\u793a\u4f8b","title":"\u8bbe\u7f6e\u793a\u4f8b","text":"","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u6ce8\u91ca","title":"\u6ce8\u91ca","text":"<p>\u5728C++\u8bed\u8a00\u4e2d\uff0c\u4ee5 <code>//</code> \u5f00\u5934\u7684\u884c\u89c6\u4e3a\u6ce8\u91ca\uff1b\u5728 vim \u811a\u672c\u4e2d\uff0c\u4ee5 <code>\"</code> \u5f00\u5934\u7684\u884c\u89c6\u4e3a\u6ce8\u91ca\u3002</p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u8bbe\u7f6e\u663e\u793a\u884c\u53f7nunonu","title":"\u8bbe\u7f6e\u663e\u793a\u884c\u53f7\uff08nu/nonu\uff09","text":"<p>\u5728\u6253\u5f00 .vimrc\uff08.exrc\uff09 \u7684 vim \u7f16\u8f91\u7a97\u53e3\u4e2d\u6572 <code>i</code> \u952e\u8fdb\u5165 insert \u6a21\u5f0f\uff0c\u6253\u5f00\u5e03\u5c14\u5f00\u5173 <code>nu</code>:</p> <pre><code>\"\u663e\u793a\u884c\u53f7\nset nu \"set number\n</code></pre> <p>\u6309\u4e0b <code>&lt;Esc&gt;</code> \u9000\u56de normal \u6a21\u5f0f\uff0c\u518d\u6572\u5165 <code>:wq</code>\uff08\u6216 <code>ZZ</code> \uff09\u4fdd\u5b58\u9000\u51fa\u3002 \u4e4b\u540e\u6bcf\u6b21\u6253\u5f00 vi/vim \u65f6\u90fd\u4f1a\u663e\u793a\u884c\u53f7\u3002</p> <p>\u82e5\u4e0d\u663e\u793a\u884c\u53f7\uff0c\u76f4\u63a5\u5220\u9664\u6216\u6ce8\u91ca <code>set nu</code> \u8fd9\u4e00\u914d\u7f6e\u884c\u5373\u53ef\u6062\u590d\u9ed8\u8ba4\uff1b\u6216\u8005\u4f7f\u80fd <code>nu</code> \u5bf9\u5e94\u7684\u5e03\u5c14\u5f00\u5173 <code>nonu</code>\uff1a</p> <pre><code>\"\u4e0d\u663e\u793a\u884c\u53f7\nset nonu \"set no number \u6216 set no nu\n</code></pre> <p>\u8bf4\u660e\uff1a</p> <p>\u5728 <code>~/.vimrc</code> \u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u7f6e\u67d0\u9879\u914d\u7f6e\u540e\uff0c\u5c06\u5bf9\u6240\u6709 vim \u6253\u5f00\u7684\u6587\u4ef6\u5168\u5c40\u6709\u6548\u3002 \u82e5\u60f3\u5728\u67d0\u6b21 vim \u6253\u5f00\u7684\u6587\u6863\u4e2d\u4e34\u65f6\u5173\u95ed\u884c\u53f7\u663e\u793a\uff0c\u53ef\u5728\u5e95\u884c\u6a21\u5f0f\u8f93\u5165 <code>:set nonu</code> \u4e34\u65f6\u5173\u95ed\u884c\u53f7\u3002  </p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u8bbe\u7f6etab\u5bbd\u5ea6\u4e3a4tstabstop","title":"\u8bbe\u7f6etab\u5bbd\u5ea6\u4e3a4\uff08ts/tabstop\uff09","text":"<p>vi \u4e2dtab\u5bbd\u5ea6\u9ed8\u8ba4\u4e3a8\uff0c\u53ef\u4ee5\u901a\u8fc7<code>set tabstop</code>\u8d4b\u503c\u66f4\u6539\uff1a</p> <pre><code>\"\u8bbe\u7f6etab\u5bbd\u5ea6\u4e3a4\nset ts=4 \"tabstop\n</code></pre> <p>\u4f60\u4e5f\u53ef\u4ee5\u6839\u636e\u9700\u8981\uff0c\u5f00\u542fsofttabs\uff0c\u5373\u75284\u4e2a\u7a7a\u683c\u5c55\u5f00tab\uff08expandtab\uff09\uff1a</p> <pre><code>\"tab\u7528\u7a7a\u683c\u5c55\u5f00\nset et \"expandtab\n</code></pre> <p>whitespace - Tab key == 4 spaces and auto-indent after curly braces in Vim vi - Replace tabs with spaces in vim</p> <pre><code>filetype plugin indent on\n\" show existing tab with 4 spaces width\nset tabstop=4\n\" when indenting with '&gt;', use 4 spaces width\nset shiftwidth=4\n\" On pressing tab, insert 4 spaces\nset expandtab\n\" NOT to use smartindent\n\"set smartindent\n</code></pre> <p>linux - vim\u6280\u5de7\uff1a\u8be6\u89e3tabstop\u3001softtabstop\u3001expandtab\u4e09\u4e2a\u9009\u9879\u7684\u533a\u522b</p> <pre><code>\" \u503c\u4e3a\u8d1f\u6570\uff0c\u4e0eshiftwidth\u4fdd\u6301\u540c\u6b65\u4e00\u81f4\uff0c\u65b9\u4fbf\u7edf\u4e00\u7f29\u8fdb\u3002\nset softtabstop=-1\n</code></pre> <p>\u4fee\u6539\u914d\u7f6e\u5f00\u542f expandtab \u540e\uff0cvim \u6253\u5f00\u539f\u6765\u5305\u542b tab \u7684\u6587\u4ef6\uff0c\u6267\u884c <code>:%retab</code> \u5373\u53ef\u5c06\u6240\u6709\u7684 tab \u5236\u8868\u7b26\u5c55\u5f00\u4e3a 4 \u4e2a\u7a7a\u683c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u8bbe\u7f6e\u81ea\u52a8\u7f29\u8fdbautoaudient","title":"\u8bbe\u7f6e\u81ea\u52a8\u7f29\u8fdb\uff08autoaudient\uff09","text":"<pre><code> \"\u81ea\u52a8\u5bf9\u9f50\uff0c\u628a\u5f53\u524d\u884c\u7684\u5bf9\u9f50\u683c\u5f0f\u5e94\u7528\u5230\u4e0b\u4e00\u884c\nset ai \"autoindent\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u8bfb\u53d6\u8bbe\u7f6e","title":"\u8bfb\u53d6\u8bbe\u7f6e","text":"<p>vim\u67e5\u770b\u914d\u7f6e\u9879\u7684\u503c\u4ee5\u53ca\u67e5\u770b\u73af\u5883\u53d8\u91cf\u7684\u503c</p> <p>\u8981\u67e5\u8be2\u67d0\u4e2a\u914d\u7f6e\u5f00\u5173\u6216\u9009\u9879\u7684\u503c\uff0c\u53ef\u4ee5 set \u8be5\u53d8\u91cf\u4e3a\u95ee\u53f7(?)\u5373\u53ef\u67e5\u8be2\u3002  </p> <p><code>:set &lt;option&gt; ?</code>\uff1a\u67e5\u770b\u7279\u5b9a\u9009\u9879  </p> <p>What's the difference between let and set?</p> <p><code>:let g:netrw_liststyle</code>\uff1a\u8bfb\u53d6\u67e5\u770b\u5168\u5c40 let \u53d8\u91cf\u7684\u503c\u3002  </p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#fileencodings","title":"fileencodings","text":"<p>fileencodings \u4e3a\u6587\u4ef6\u7f16\u7801\u683c\u5f0f\uff1a</p> <pre><code>                                *'fileencoding'* *'fenc'* *E213*\n\n        Sets the character encoding for the file of this buffer.\n\n        When 'fileencoding' is different from 'encoding', conversion will be\n        done when writing the file.\n\n        See 'encoding' for the possible values.\n</code></pre> <p>\u5177\u4f53\u7f16\u7801\u683c\u5f0f\u53ef\u67e5\u8be2\u5173\u952e\u5b57 encoding-names \u548c encoding-values\u3002</p> <p>\u67e5\u770b fileencodings \u7684\u503c\uff1a</p> <pre><code>:set fileencodings ?\n</code></pre> <p>vim \u5e2e\u52a9\u6587\u6863\u7684\u7f16\u7801\u683c\u5f0f\u4e3a\uff1a</p> <p>fileencodings=ucs-bom,utf-8,default,latin1</p> <p>Xcode \u53f3\u4fa7\u7684 File Inspector \u4e2d\u7684 Text Settings | Text Encoding \u53ef\u4e0b\u62c9\u9009\u62e9\u5f53\u524d\u4ee3\u7801\u6587\u4ef6\u7684\u7f16\u7801\u683c\u5f0f\u3002</p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#fileformat","title":"fileformat","text":"<p>fileformat \u4e3a\u6362\u884c\u683c\u5f0f\uff08Line Endings\uff09\uff1a</p> <pre><code>                                        *'fileformat'* *'ff'*\n\nThis gives the &lt;EOL&gt; of the current buffer, which is used for\n        reading/writing the buffer from/to a file:\n            dos     &lt;CR&gt; &lt;NL&gt;\n            unix    &lt;NL&gt;\n            mac     &lt;CR&gt;\n</code></pre> <p>\u67e5\u770b fileformat \u7684\u503c\uff1a</p> <pre><code>:set fileformat ?\n</code></pre> <p>vim \u5e2e\u52a9\u6587\u6863\u7684\u6362\u884c\u683c\u5f0f\u4e3a\uff1a</p> <p>fileformat=unix</p> <p>\u300avi\u4e0b\u663e\u793a\u56de\u8f66\u6362\u884c\u7b26\u7b49\u7279\u6b8a\u7b26\u53f7\u300b \u300awindows\u548clinux\u6587\u4ef6CRLF\u8f6c\u6362\u300b \u300aDifference between CR LF, LF and CR line break types?\u300b crlf.py: Replace CRLF (windows) line endings with LF (unix) line endings in files.  </p> <p>CR(Carriage Return): \u56de\u8f66\uff0c\u5bf9\u5e94 ASCII \u7801\u4e3a 0x13\uff0c\u53ef\u89c6\u8f6c\u4e49\u5b57\u7b26\u4e3a <code>\\r</code>\uff1b LF(Line Feeding)\uff1a\u6362\u884c\uff0c\u5bf9\u5e94 ASCII \u7801\u4e3a 0x10\uff0c\u53ef\u89c6\u8f6c\u4e49\u5b57\u7b26\u4e3a <code>\\n</code>\u3002  </p> <p>Windows \u4e0b\u4f7f\u7528 <code>\\r\\n</code> \u6362\u884c\uff1bUNIX \u5219\u4f7f\u7528 <code>\\n</code> \u6362\u884c\u3002</p> <p>\u5728 vim \u4e2d <code>:set list</code> \u663e\u793a\u7684\u4e0d\u53ef\u89c1\u5b57\u7b26\u4e2d\uff0cWindows \u884c\u5c3e\u65ad\u884c\u7b26\u6807\u8bb0\u4e3a <code>^M$</code>\uff0cUNIX \u884c\u5c3e\u65ad\u884c\u7b26\u6807\u8bb0\u4e3a <code>$</code>\u3002  </p> <p>Xcode \u53f3\u4fa7\u7684 File Inspector \u4e2d\u7684 Text Settings | Line Endings \u67093\u4e2d\u9009\u9879\uff1a</p> <ul> <li>macOS/Unix(LF)</li> <li>Classic Mac OS(CR)</li> <li>Windows(CRLF)</li> </ul> <p>Sublime Text \u7684 <code>~/Library/Application Support/Sublime Text 3/Packages/Default/Preferences.sublime-settings</code></p> <pre><code>    // Determines what character(s) are used to terminate each line in new files.\n    // Valid values are 'system' (whatever the OS uses), 'windows' (CRLF) and\n    // 'unix' (LF only).\n    \"default_line_ending\": \"system\",\n</code></pre> <p><code>default_line_ending</code>: \u9ed8\u8ba4 line ending \u8ddf\u968f\u7cfb\u7edf\uff0cmacOS \u4e0b\u662f LF\u3002 <code>show_line_endings</code>: \u9ed8\u8ba4\u4e0d\u5728\u72b6\u6001\u680f\u663e\u793a\u5f53\u524d Line Ending\u3002</p> <p>\u5e95\u90e8\u72b6\u6001\u680f\u5c06\u663e\u793a\u5f53\u524d Line Ending\uff1a</p> <ul> <li>Windows\uff1aWindows Line Endings(CRLF)</li> <li>Unix\uff1aUnix Line Endings(LF)</li> <li>CR\uff1aMac OS 9 Line Endings(CR)</li> </ul>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#ubuntu","title":"ubuntu","text":"<p>ubuntu \u4e0b man vim\uff0cFILES \u90e8\u5206\u5217\u51fa\u4e86\u914d\u7f6e\u6587\u4ef6\u548c\u8bf4\u660e\u6587\u6863\u76f8\u5173\u7684\u6587\u4ef6\u8def\u5f84\uff1a</p> <pre><code>$ man vim\n\nFILES\n\n       /usr/share/vim/vimrc\n                      System wide Vim initializations.\n\n       ~/.vimrc       Your personal Vim initializations.\n</code></pre> <p>\u800c /usr/share/vim/vimrc \u6307\u5411 /etc/vim/vimrc\uff1a</p> <pre><code>$ ls -l /usr/share/vim/\n\nlrwxrwxrwx  1 root root   14 Mar 14 09:05 vimrc -&gt; /etc/vim/vimrc\n\n$ readlink /usr/share/vim/vimrc\n/etc/vim/vimrc\n</code></pre> <p>\u5982\u679c\u53ea\u4fee\u6539\u5bb6\u76ee\u5f55\u4e0b\u7684 ~/.vimrc \u7684\u8bdd\uff0c\u53ea\u5bf9\u5f53\u524d\u7528\u6237\u6709\u6548\u3002 \u5f53 <code>sudo vim</code> \u65f6\uff0c\u4f7f\u7528\u7684\u662f /etc/vim/vimrc \u4e2d\u7684\u5168\u5c40\u914d\u7f6e\u3002 \u56e0\u6b64\uff0c\u8981\u60f3\u4fee\u6539\u914d\u7f6e\uff0c\u5bf9\u6240\u6709\u7528\u6237\u5168\u5c40\u751f\u6548\uff0c\u9700\u8981\u4fee\u6539 /etc/vim/vimrc\u3002</p> /etc/vim/vimrc<pre><code>runtime! debian.vim\n\nif has(\"syntax\")\n  syntax on\nendif\n\n\" Source a global configuration file if available\nif filereadable(\"/etc/vim/vimrc.local\")\n  source /etc/vim/vimrc.local\nendif\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u65b0\u5efa /etc/vim/vimrc.local\uff0c\u8fd9\u6837\u914d\u7f6e\u5bf9 vim \u548c sudo vim \u5168\u5c40\u751f\u6548\u3002</p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u67e5\u770b\u4e0d\u53ef\u89c1\u5b57\u7b26","title":"\u67e5\u770b\u4e0d\u53ef\u89c1\u5b57\u7b26","text":"<p>Show invisibles Vim: Show invisible characters How to Display Hidden Characters in vim? Make Vim show ALL white spaces as a character </p> <p><code>:set list</code> / <code>:set nolist</code>\uff1a\u663e\u793a/\u53d6\u6d88\u663e\u793a\u4e0d\u53ef\u89c1\u5b57\u7b26\u3002</p> <p>\u5728\u663e\u793a\u4e0d\u53ef\u89c1\u5b57\u7b26\u7684\u60c5\u51b5\u4e0b\uff0cTAB \u952e\u663e\u793a\u4e3a <code>^I</code>\uff1b\u800c\u6362\u884c\u7b26(LF)\u663e\u793a\u4e3a <code>$</code>\u3002</p> <p>\u4e5f\u53ef\u8bbe\u7f6e listchars \u9009\u9879\u5b9a\u5236\u7279\u6b8a\u5b57\u7b26\u7684\u663e\u793a\uff0c\u4ee5\u4e0b\u5c06 TAB \u663e\u793a\u6210 <code>&gt;\u2014</code>\uff0c\u800c\u884c\u5c3e\u591a\u4f59\u7684\u7a7a\u767d\u5b57\u7b26\u663e\u793a\u6210 <code>-</code>\u3002</p> <pre><code>:set listchars=tab:&gt;-,trail:-\n:set list\n</code></pre> <p>\u67d0\u5929\u91cd\u542f\u6811\u8393\u6d3e\uff08rpi4b-ubuntu\uff09\u540e\uff0c\u53d1\u73b0\u5de5\u4f5c\u4e0d\u6b63\u5e38\uff0cssh \u4e5f\u8fde\u63a5\u4e0d\u4e0a\uff0c\u65e0\u5948\u53ea\u5f97\u63d2\u4e0a microHDMI \u548c\u65e0\u7ebf\u952e\u9f20\u3002</p> <p>\u770b\u5230\u63a7\u5236\u53f0\u63d0\u793a\u8fdb\u5165\u7d27\u6025\u6a21\u5f0f\uff0c\u9700\u8981\u4ee5 root \u8eab\u4efd\u767b\u5f55\u8fdb\u53bb\u7ef4\u62a4\u3002</p> <p>You are in emergency mode.</p> <p>After logging in, type \"journalctl -xb\" to view system logs, \"systemctl reboot\" to reboot, or \"exit\" to boot into default mode. Give root password for maintenance</p> <p></p> <p>\u6839\u636e\u4e0a\u4e0b\u6587\u662f Cloud-init \u542f\u52a8\u662f\u52a0\u8f7d\u67d0\u4e2a YAML \u914d\u7f6e\u6587\u4ef6\u5931\u8d25\uff08Failed loading yaml blob.\uff09\uff0c\u53ef\u80fd\u662f\u683c\u5f0f\u6709\u95ee\u9898\uff08Invalid format\uff09\u3002</p> <p>\u53c2\u8003 cloud-init \u4ecb\u7ecd\uff0c\u5176\u91c7\u7528 YAML \u683c\u5f0f\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5176\u914d\u7f6e\u6587\u4ef6\u4e3a <code>/etc/cloud/cloud.cfg</code>\u3002</p> <p>YAML \u683c\u5f0f\u7684\u5177\u4f53\u8bf4\u660e\u53c2\u89c1 YAML \u8bed\u8a00\u6559\u7a0b\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f YAML \u4e0d\u652f\u6301tab\u952e\uff0c\u4f46\u652f\u6301\u7a7a\u683c\u3002</p> <p>\u63a7\u5236\u53f0\u663e\u793a <code>found character '\\t' that cannot start any token</code>\uff0c\u8fd9\u4e2a tab \u952e\uff08<code>\\t</code>\uff09\u5c31\u662f\u95ee\u9898\u7684\u5143\u51f6\u3002\u4e4b\u524d\u5df2\u6709\u56fd\u9645\u53cb\u4eba\u8e29\u8fc7\u5751 I'm getting \"found character that cannot start any token while scanning for the next token\"\u3002</p> <p>\u63a7\u5236\u53f0\u663e\u793a\u7684\u5185\u5bb9\u53ef\u4ee5\u5728\u7cfb\u7edf\u65e5\u5fd7 /var/log/syslog \u4e2d\u67e5\u770b\uff0c\u63a5\u4e0b\u6765\u67e5\u770b cloud-init \u65e5\u5fd7\u6587\u4ef6 <code>/var/log/cloud-init.log</code>\uff0c\u5b9a\u4f4d\u663e\u793a\u662f\u52a0\u8f7d\u89e3\u6790 <code>/boot/firmware/network-config</code> \u51fa\u9519\u3002</p> /var/log/cloud-init.log<pre><code>2024-04-11 00:50:03,529 - util.py[DEBUG]: Read 1590 bytes from /boot/firmware//network-config\n2024-04-11 00:50:03,530 - util.py[DEBUG]: Attempting to load yaml from string of length 240 with allowed root types (&lt;class 'dict'&gt;,)\n2024-04-11 00:50:03,536 - util.py[DEBUG]: Attempting to load yaml from string of length 1590 with allowed root types (&lt;class 'dict'&gt;,)\n2024-04-11 00:50:03,553 - util.py[WARNING]: Failed loading yaml blob. Invalid format at line 44 column 1: \"while scanning for the next token\nfound character '\\t' that cannot start any token\n  in \"&lt;unicode string&gt;\", line 44, column 1:\n        optional: true\n    ^\"\n</code></pre> <p><code>vim /boot/firmware/network-config</code> \u6253\u5f00 boot \u7f51\u7edc\u914d\u7f6e\u6587\u4ef6\uff0c\u770b\u8d77\u6765\u7b2c 44 \u884c\u5bf9\u9f50\u548c\u7f29\u8fdb\u6ca1\u5565\u95ee\u9898\uff1a</p> <p></p> <p>\u8f93\u5165 <code>:set list</code> \u663e\u793a tab \u952e\uff0c\u518d\u770b\u53d1\u73b0\u786e\u5b9e\u6709\u975e\u6cd5\u7684 tab \u952e\uff1a</p> <p></p> <p>\u624b\u5203 tab \u66ff\u6362\u4e3a\u4e24\u4e2a\u7a7a\u683c\uff0c\u6216\u8005 <code>:%s/\\t/  /g</code> \u89e3\u51b3\u95ee\u9898\u3002\u9700\u8981\u683c\u5916\u6ce8\u610f\u5bf9\u9f50\u5c42\u7ea7\u3002</p> <p>\u540e\u6765\u7ffb\u770b\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5176\u5b9e\u8fd9\u4e2a\u95ee\u9898\u7531\u6765\u5df2\u4e45\u3002\u5f53\u521d\u5236\u4f5c rpi4b-ubuntu \u955c\u50cf\u65f6\u8bd5\u56fe\u914d\u7f6e\u65e0\u7ebf WiFi \u9759\u6001 IP\uff0c\u5f53\u65f6\u8fd8\u7eb3\u95f7\u4e3a\u5565\u4e0d\u6210\u529f\u3002</p> <p>\u91cd\u542f\u540e\u95ee\u9898\u4f9d\u65e7\uff0ccloud-init \u65e5\u5fd7\u663e\u793a <code>schema.py[DEPRECATED]: Deprecated cloud-config provided</code>\uff08refer to askubuntu\uff09\u3002</p> <p>\u539f\u6765\u6700\u8fd1\u4f7f\u7528\u6811\u8393\u6d3e\u6302\u8f7d\u786c\u76d8\uff0c\u5728 /etc/fstab \u4e2d\u914d\u7f6e\u4e86\u5f00\u673a auto mount \u9879\u3002\u540e\u6765\u5c06\u786c\u76d8\u62d4\u4e0b\u6765\u91cd\u65b0\u683c\u5f0f\u5316\u4e86\u67d0\u4e2a\u5206\u533a\uff0c\u53ef\u80fd mount \u53c2\u6570\u6709\u95ee\u9898\u6291\u6216 UUID \u6709\u53d8\u3002</p> <p>\u67e5\u770b\u7cfb\u7edf\u65e5\u5fd7\uff0c\u770b\u5230\u6709\u4e00\u4e9b systemd-udevd \u6a21\u5757\u7684\u62a5\u9519\uff1a</p> /var/log/syslog<pre><code>Apr 11 10:19:06 rpi4b-ubuntu systemd-udevd[462]: sda1: Process '/usr/bin/unshare -m /usr/bin/snap auto-import --mount=/dev/sda1' failed with exit code 1.\nApr 11 10:19:06 rpi4b-ubuntu systemd-udevd[473]: sda3: Process '/usr/bin/unshare -m /usr/bin/snap auto-import --mount=/dev/sda3' failed with exit code 1.\nApr 11 10:19:06 rpi4b-ubuntu systemd-udevd[463]: sda2: Process '/usr/bin/unshare -m /usr/bin/snap auto-import --mount=/dev/sda2' failed with exit code 1.\n</code></pre> <p>\u5220\u9664 /etc/fstab \u4e2d\u65b0\u8fd1\u914d\u7f6e\u7684 mount \u6761\u76ee\uff0c\u91cd\u542f\u6210\u529f\u8fdb\u5165\u7cfb\u7edf\u3002\u540e\u7eed\u4fee\u6b63\u4e86 /etc/fstab \u4e2d\u7684 mount \u6761\u76ee\uff0c\u5177\u4f53\u53c2\u8003 rpi4b-ubuntu\u5916\u6302\u786c\u76d8\u914d\u7f6esamba\u5171\u4eab\u670d\u52a1\u3002</p>","tags":["vim"]},{"location":"blog/20171018/008-vim-config/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>\u5b9e\u8df5\u4e2d\u5b66\u4e60vim\u4e4bvim\u914d\u7f6e\u6587\u4ef6\u3001\u63d2\u4ef6\u6587\u4ef6\u52a0\u8f7d\u8def\u5f84 \u4f18\u96c5\u7684\u914d\u7f6e Vim vim set \u529f\u80fd\u8bbe\u5b9a \u67d0\u4eba\u7684.vimrc\uff1a\u52a0\u8be6\u7ec6\u6ce8\u91ca \u4e00\u5957\u5f3a\u5927\u7684vim\u914d\u7f6e\u6587\u4ef6+\u8be6\u7ec6\u6ce8\u91ca \u5f88\u597d\u5f88\u5f3a\u5927\u7684vimrc\uff08\u5e26\u6ce8\u91ca\u7248\uff09 Vim \u914d\u7f6e\u8be6\u89e3 vim\u914d\u7f6e\u7684\u4e00\u4e9b\u5efa\u8bae\uff08\u9644\u8be6\u7ec6\u6ce8\u91ca\u7684vimrc\uff09 Linux\u5927\u68da\u7248vimrc\u914d\u7f6e Vim \u914d\u7f6e\u5165\u95e8 - \u962e\u4e00\u5cf0  </p> <p>The Ultimate Vim Distribution vgod/vimrc kaochenlong/eddie-vim </p>","tags":["vim"]},{"location":"blog/20171018/009-vim-mapping/","title":"vim\u6620\u5c04","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86\u5982\u4f55\u914d\u7f6e vim \u952e\u4f4d\u6620\u5c04\u3002</p> <p>vim\u6309\u952e\u6620\u5c04</p>","tags":["vim"]},{"location":"blog/20171018/009-vim-mapping/#map\u524d\u7f00","title":"map\u524d\u7f00","text":"<p>\u5bf9vim map\u800c\u8a00\uff0c\u524d\u7f00\u4f5c\u4e3a\u547d\u4ee4\u672c\u8eab\u7684\u4fee\u9970\u7b26\uff0c\u5fae\u8c03\u547d\u4ee4\u7684\u4f5c\u7528\u6a21\u5f0f\u548c\u6548\u679c\u3002 vim map\u9488\u5bf9\u6a21\u5f0f\u548c\u9012\u5f52\u6548\u679c\u53ef\u80fd\u6709\u8fd9\u4e48\u51e0\u79cd\u524d\u7f00\uff1a</p> \u524d\u7f00 \u610f\u4e49 nore \u8868\u793a\u975e\u9012\u5f52\uff0c\u9ed8\u8ba4\u9012\u5f52\uff08Recursive Mapping\uff09 n \u8868\u793a\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\u751f\u6548 i \u8868\u793a\u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u751f\u6548 c \u8868\u793a\u5728\u547d\u4ee4\u884c\u6a21\u5f0f\u4e0b\u751f\u6548 v \u8868\u793a\u5728\u53ef\u89c6\u6a21\u5f0f\u4e0b\u751f\u6548","tags":["vim"]},{"location":"blog/20171018/009-vim-mapping/#recursive_mapping","title":"Recursive Mapping","text":"<p>\u9012\u5f52\u7684\u6620\u5c04\uff0c\u5176\u5b9e\u5f88\u597d\u7406\u89e3\uff1a</p> <pre><code>\"\u952e`a`\u88ab\u6620\u5c04\u6210\u4e86`b`\n:map a b\n</code></pre> <pre><code>\"`c`\u53c8\u88ab\u6620\u5c04\u6210\u4e86`a`\n:map c a\n</code></pre> <p>\u4e0a\u8ff0map\u9ed8\u8ba4\u6ca1\u52a0<code>nore</code>\u524d\u7f00\uff0c\u5373\u9012\u5f52\u6620\u5c04\uff0c\u90a3\u4e48<code>c</code>\u6700\u7ec8\u5c31\u88ab\u6620\u5c04\u6210\u4e86<code>b</code>\u3002\u5bf9\u4e8e\u6309\u952e<code>c</code>\u7b49\u6548\u4e8e\uff1a</p> <pre><code>:map c b\n</code></pre> <p>\u8bf4\u660e\uff1a</p> <p>\u9ed8\u8ba4map\u547d\u4ee4\u5f71\u54cd\u5230\u666e\u901a\u6a21\u5f0f\u548c\u53ef\u89c6\u6a21\u5f0f\u3002 \u5728\u81ea\u5b9a\u4e49\u6620\u5c04\u65f6\uff0c\u9012\u5f52\u8fc2\u56de\u4e00\u822c\u90fd\u662f\u975e\u9884\u671f\u7684\uff0c\u6545\u901a\u5e38\u4f7f\u7528\u975e\u9012\u5f52\uff08<code>noremamp</code>\uff09\u3002</p> <p>\u5982\u679c\u4e0d\u662f\u7279\u6b8a\u60c5\u51b5\uff0c\u5728\u4f7f\u7528vim\u65f6\uff0c\u624b\u6307\u5e94\u5c3d\u91cf\u96c6\u4e2d\u5728\u952e\u76d8\u4e2d\u95f4\u6392\u3002\u53ef\u4ee5\u5c06\u8f83\u5c11\u4f7f\u7528\u7684<code>CapsLock</code>\u952e\u6620\u5c04\u4e3a\u8f83\u96be\u89e6\u6478\u7684\u5de6\u4e0a\u89d2<code>&lt;Esc&gt;</code>\u952e\uff1a</p>","tags":["vim"]},{"location":"blog/20171018/009-vim-mapping/#unmap","title":"unmap","text":"<p>unmap\u540e\u9762\u8ddf\u4e00\u4e2a\u6309\u952e\uff08\u7ec4\u5408\uff09\uff0c\u8868\u793a\u5220\u9664\u8fd9\u4e2a\u6309\u952e\uff08\u7ec4\u5408\uff09\u7684\u6620\u5c04\u3002\u6709\u70b9\u7c7b\u4f3cC\u8bed\u8a00\u9884\u7f16\u8bd1\u5b8f\u4e2d\u7684\u53d6\u6d88\u5b8f\u5b9a\u4e49\u7b26\u53f7 <code>#undef</code>\u3002 \u5728map\u751f\u6548\u6a21\u5f0f\u4e0b\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u89e3\u9664<code>c</code>\u5230<code>a</code>\u7684\u6620\u5c04\uff1a</p> <pre><code>\"\u89e3\u9664c\u952e\u6620\u5c04\n:unmap c\n</code></pre> <p>\u540c\u6837\uff0cunmap\u53ef\u4ee5\u52a0\u5404\u79cd\u524d\u7f00\uff0c\u8868\u793a\u5f71\u54cd\u5230\u7684\u6a21\u5f0f\u3002</p>","tags":["vim"]},{"location":"blog/20171018/009-vim-mapping/#mapclear","title":"mapclear","text":"<p>mapclear\u76f4\u63a5\u6e05\u9664\u76f8\u5173\u6a21\u5f0f\u4e0b\u7684\u6240\u6709\u6620\u5c04\u3002 \u540c\u6837\uff0cmapclear\u53ef\u4ee5\u52a0\u5404\u79cd\u524d\u7f00\uff0c\u8868\u793a\u5f71\u54cd\u5230\u7684\u6a21\u5f0f\u3002</p>","tags":["vim"]},{"location":"blog/20171018/009-vim-mapping/#\u5e38\u7528map\u547d\u4ee4","title":"\u5e38\u7528map\u547d\u4ee4","text":"prefix map noremap unmap mapclear - :map :noremap :unmap :mapclear n :nmap :nnoremap :nunmap :nmapclear v :vmap :vnoremap :vunmap :vmapclear i :imap :inoremap :iunmap :imapclear c :cmap :cnoremap :cunmap :cmapclear <p>vim\u7684map\u6a21\u5f0f\u7684\u76f8\u5173\u547d\u4ee4\uff1a</p> <p></p>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/","title":"vim\u6298\u53e0","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 vim \u6298\u53e0\u76f8\u5173\u7684\u64cd\u4f5c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#vim_fold","title":"vim fold","text":"<p>\u6700\u8fd1\u9700\u8981\u6298\u53e0\uff0c\u4e8e\u662f\u627e\u4e86\u4e00\u4e0b\u3002\u5176\u5b9e\u624b\u518c\u91cc\u9762\u6709\uff0c\u4e0d\u8fc7\u624b\u518c\u505a\u7684\u592a\u597d\u592a\u8be6\u7ec6\u7684\u540e\u679c\u5f80\u5f80\u5c31\u662f\u8ba9\u4eba\u61d2\u5f97\u770b\u4e86\u3002\u5199\u7684\u4e1c\u897f\u8d85\u8fc7\u4e94\u516d\u5c4f\u4ee5\u540e\uff0c\u611f\u89c9\u7ffb\u6765\u7ffb\u53bb\u5c31\u4e0d\u600e\u4e48\u65b9\u4fbf\u4e86\uff0c\u770b\u8d77\u6765\u4e5f\u5f88\u6df7\u4e71\u3002\u8fd9\u4e2a\u65f6\u5019\u6700\u597d\u5c31\u80fd\u6298\u53e0\u8d77\u6765\u3002VIM\u91cc\u9762\u4e5f\u6709VS\u91cc\u9762\u90a3\u6837\u7684\u6298\u53e0\u529f\u80fd\uff0c\u800c\u4e14\u4e0d\u9700\u8981\u7528\u9f20\u6807\u53bb\u70b9\u90a3\u4e2a\u51cf\u53f7\u548c\u52a0\u53f7\u3002</p>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#foldenable","title":"foldenable","text":"<p>This option can be used to quickly switch between showing all text unfolded and viewing the text with folds (including manually opened or closed folds). It can be toggled with the |<code>zi</code>| command. </p> <p>\u6298\u53e0\u529f\u80fd\u53ef\u4ee5\u901a\u8fc7\u5e95\u884c\u6a21\u5f0f\u547d\u4ee4 <code>:set foldenable</code>/<code>:set nofoldenable</code> \u6765\u5f00\u542f/\u7981\u7528\uff0c\u4e5f\u53ef\u901a\u8fc7 <code>zi</code> \u6307\u4ee4\u5f00\u542f\u3002</p> <p>\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5c06 <code>foldenable</code> \u914d\u7f6e\u5230 <code>.vimrc</code> \u6587\u4ef6\u4e2d\uff1a</p> <pre><code>\"\u542f\u7528\u6298\u53e0\nset fen \"foldenable\n</code></pre> <p>\u540e\u671f\uff0c\u9488\u5bf9\u5177\u4f53\u7684 vim \u7f16\u8f91\u7a97\u53e3\uff0c\u4f60\u4e5f\u53ef\u4ee5\u5728\u5e95\u884c\u6a21\u5f0f\u4e0b\u901a\u8fc7\u547d\u4ee4 <code>:set nofoldenable</code> \u4e34\u65f6\u7981\u7528\u3002</p>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#foldmethod","title":"foldmethod","text":"<p>\u53ef\u4ee5\u8ba9 VIM \u6839\u636e\u8bed\u6cd5\u7f29\u8fdb\uff0c\u6807\u8bb0\u81ea\u52a8\u6298\u53e0\u3002\u7528 <code>set foldmethod=foldoption</code> \u6765\u8bbe\u5b9a\u3002 \u53ef\u4ee5 <code>:h fold-methods</code> \u67e5\u770b\u4e00\u4e0b foldmethod \u8bf4\u660e\u3002</p> <pre><code>The folding method can be set with the 'foldmethod' option.\n\nThere are six methods to select folds:\n        manual          manually define folds\n        indent          more indent means a higher fold level\n        expr            specify an expression to define folds\n        syntax          folds defined by syntax highlighting\n        diff            folds for unchanged text\n        marker          folds defined by markers in the text\n\nMANUAL                                          *fold-manual*\n\nUse commands to manually define the fold regions.  This can also be used by a script that parses text to find folds.\n\nINDENT                                          *fold-indent*\n\nThe folds are automatically defined by the indent of the lines.\n\nThe foldlevel is computed from the indent of the line, divided by the\n'shiftwidth' (rounded down).  A sequence of lines with the same or higher fold level form a fold, with the lines with a higher level forming a nested fold.\n\nThe nesting of folds is limited with 'foldnestmax'.\n</code></pre> <p>\u53ef\u7528\u9009\u9879 'foldmethod' \u6765\u8bbe\u5b9a\u6298\u53e0\u65b9\u5f0f\uff1a<code>:set fdm=xxx</code>\uff0cfdm \u662f foldmethod \u7684\u7f29\u5199\u3002 \u4e5f\u53ef\u76f4\u63a5\u5728\u6e90\u4ee3\u7801\u6587\u4ef6\u4e2d\u4f7f\u7528\u6ce8\u91ca\u8c03\u7528 vim \u547d\u4ee4\uff1a </p> <pre><code>/* vim: set fdm=XXX: */\n</code></pre> <p>\u6709 6 \u79cd\u65b9\u5f0f\u9009\u5b9a\u6298\u53e0\uff1a</p> \u6298\u53e0\u65b9\u5f0f \u8bf4\u660e \u624b\u5de5\u6298\u53e0 / manual Folds are created manually. \u7f29\u8fdb\u6298\u53e0 / indent Lines with equal indent form a fold. \u8303\u5f0f\u6298\u53e0 / expr 'foldexpr' gives the fold level of a line. \u6807\u8bb0\u6298\u53e0 / marker Markers are used to specify folds. \u8bed\u6cd5\u6298\u53e0 / syntax Syntax highlighting items specify folds. \u5dee\u5f02\u6298\u53e0 / diff Fold text that is not changed. <p>\u53ef\u9488\u5bf9\u5f53\u524d vim \u7f16\u8f91\u6587\u6863\uff0c\u5728\u5e95\u884c\u6a21\u5f0f\u4f7f\u7528 <code>:set fdm=marker</code> \u547d\u4ee4\u6765\u8bbe\u7f6e\u6210 <code>marker</code> \u6298\u53e0\u65b9\u5f0f\u3002 \u5f53\u4f7f\u7528 marker \u65b9\u5f0f\u65f6\uff0c\u9700\u8981\u7528\u6807\u8ba1\u6765\u6807\u8bc6\u4ee3\u7801\u7684\u6298\u53e0\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u662f {{{ \u548c }}}\uff0c\u5373\u57fa\u4e8e Block \u6587\u672c\u5bf9\u8c61\u6298\u53e0\uff0c\u6700\u597d\u4e0d\u8981\u6539\u52a8\u3002 \u53ef\u4ee5\u6bcf\u6b21\u9488\u5bf9\u5f53\u524d vim \u7f16\u8f91\u7a97\u53e3\uff0c\u5728\u5e95\u884c\u6a21\u5f0f\u901a\u8fc7 <code>:set fdm=XXX</code> \u6765\u8bbe\u7f6e\u6298\u53e0\u65b9\u5f0f\uff0c\u4e5f\u53ef\u5c06\u5176\u914d\u7f6e\u5230 .vimrc \u6587\u4ef6\u4e2d\u3002\u540e\u9762\u9488\u5bf9\u7279\u5b9a\u6587\u4ef6\u4e5f\u53ef\u5728\u5e95\u884c\u6a21\u5f0f\u52a8\u6001\u53d8\u66f4\u6298\u53e0\u65b9\u5f0f\u3002</p> <p>\u6ce8\u610f\uff1a</p> <p>\u6bcf\u4e00\u79cd\u6298\u53e0\u65b9\u5f0f\u4e0d\u517c\u5bb9\uff0c\u5982\u4e0d\u80fd\u65e2\u7528 <code>expr</code> \u53c8\u7528 <code>marker</code> \u65b9\u5f0f\uff0c\u53ef\u4ee5\u8f6e\u6d41\u4f7f\u7528 <code>indent</code> \u548c<code>marker</code> \u65b9\u5f0f\u8fdb\u884c\u6298\u53e0\u3002</p>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#indent_tabstop","title":"indent tabstop","text":"<p>vim\u7684shiftwidth\u3001tabstop\u3001softtabstop\u8bbe\u7f6e vim\u4e2dtabstop\u3001shiftwidth\u3001softtabstop\u4ee5\u53caexpandtab\u7684\u5173\u7cfb</p> <p>\u5efa\u8bae <code>.vimrc</code> \u4e2d\u914d\u7f6e\u4f7f\u7528 hardtabs\uff1a</p> <pre><code>\"\u4e0d\u4f7f\u7528\u7a7a\u683c\u4ee3\u66ff\u5236\u8868\u7b26\uff0c\u4f7f\u7528\u539f\u751fhardtabs\uff1b\n\"\u82e5\u5f00\u542fet\uff0c\u63d2\u5165\u771f\u6b63\u7684\u5236\u8868\u7b26\uff0c\u9700\u8981\u4f7f\u7528CTRL-V&lt;Tab&gt;\u3002\nset noet \"noexpandtab\n\n\"\u5236\u8868\u7b26\u4ee5\u7a7a\u683c\u5ea6\u91cf\u7684\u4f4d\u5bbd\nset ts=4 \"tabstop\n\n\"\u81ea\u52a8\u7f29\u8fdb\u6240\u4f7f\u7528\u7684\u7a7a\u767d\u957f\u5ea6\u6307\u793a\nset sw=4 \"shiftwidth\n\n\"\u4e00\u65e6\u8bbe\u7f6e\u4e86softtabstop\u7684\u503c\uff0c\u6309\u4e0btab\u952e\u5c06\u667a\u80fd\u63d2\u5165\u7a7a\u683c\u548c\u5236\u8868\u7b26\u7684\u6df7\u5408\nset sts=4 \"softtabstop\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#manual_space","title":"manual space","text":"<pre><code>\"\u542f\u7528\u6298\u53e0\nset foldenable\n\"\u624b\u52a8\u6298\u53e0\nset foldmethod=manual\n\"\u7528\u7a7a\u683c\u952e\u6765\u5f00\u5173\u6298\u53e0\nnnoremap &lt;space&gt; @=((foldclosed(line('.')) &lt; 0) ? 'zc':'zo')&lt;CR&gt; \n</code></pre>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#fold-commands","title":"fold-commands","text":"","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#enabledisable_folds","title":"ENABLE/DISABLE FOLDS","text":"command function <code>zn</code> Fold none: reset 'foldenable'.All folds will be open. <code>zN</code> Fold normal: set 'foldenable'.All folds will be as they were before. <code>zi</code> Invert 'foldenable'.","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#opening_and_closing_folds","title":"OPENING AND CLOSING FOLDS","text":"<p>\u6240\u6709\u7684\u6298\u53e0\u76f8\u5173\u7684\u6307\u4ee4\u90fd\u662f\u4ee5 <code>z</code> \u5f00\u5934\uff0c<code>z</code> \u5982\u5176\u5f62\uff0c\u770b\u7740\u5c31\u50cf\u6298\u7eb8\u3002 <code>f</code> \u7684\u610f\u601d\u662f fold\uff0c\u6240\u4ee5 <code>zf</code> \u5c31\u662f\u6298\u53e0\u3002\u4f60\u53ef\u4ee5\u5728 visual \u6a21\u5f0f\u4e0b\u9009\u5b9a\uff0c\u518d\u6309 <code>zf</code> \u6307\u4ee4\uff0c\u53ef\u4ee5\u5c06\u9009\u5b9a\u5185\u5bb9\u8fdb\u884c\u6298\u53e0\u3002  </p> <p><code>zf</code>}  or {Visual<code>zf</code>\uff1a</p> <ul> <li>Operator to create a fold.</li> <li>This only works when 'foldmethod' is \"manual\" or \"marker\".</li> <li>The new fold will be closed for the \"manual\" method.</li> <li>'foldenable' will be set.</li> </ul> command function <code>zo</code> Open one fold under the cursor. <code>zO</code> Open all folds under the cursor recursively. <code>zc</code> Close one fold under the cursor. <code>zC</code> Close all folds under the cursor recursively. <code>za</code> When on a closed fold: open it;when on an open fold: close it.When folds are nested, you may have to use \"za\" several times. <code>zA</code> When on a closed fold: open it recursively.When on an open fold: close it recursively and set 'foldenable'. <p><code>zm</code>      | Fold more: Subtract one from 'foldlevel'.If 'foldlevel' was already zero nothing happens.'foldenable' will be set. <code>zM</code>      | Close all folds: set 'foldlevel' to 0.'foldenable' will be set. <code>zr</code>      | Reduce folding: Add one to 'foldlevel'. <code>zR</code>      | Open all folds. This sets 'foldlevel' to highest fold level.</p>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#moving_over_folds","title":"MOVING OVER FOLDS","text":"command function <code>[z</code> Move to the start of the current open fold. <code>]z</code> Move to the end of the current open fold. <code>zj</code> Move downwards to the start of the next fold.A closed fold is counted as one fold. <code>zk</code> Move upwards to the end of the previous fold.A closed fold is counted as one fold. <p>\u6298\u53e0\u53ef\u4ee5\u5d4c\u5957\uff0c<code>zr</code> \u53ef\u4ee5\u6253\u5f00\u7b2c\u4e00\u5c42\u7684\u6298\u53e0\uff0c<code>zR</code> \u53ef\u4ee5\u6253\u5f00\u6240\u6709\u5c42\u7684\u6298\u53e0\u3002\u4e0e\u4e4b\u5bf9\u5e94\u7684\u662f <code>zm</code> \u548c<code>zM</code>\uff0c\u662f\u6309\u5c42\u5173\u4e0a\u6298\u53e0\u3002 \u6bd4\u5982\u8bf4\u6309 <code>zm</code>\uff0c\u4f1a\u4ece\u6700\u91cc\u5c42\u7684\u5c42\u53e0\u5173\u8d77\uff1b\u8fde\u7eedzm\u5c31\u4f1a\u4e00\u76f4\u5173\u5230\u6700\u4e0a\u5c42\u7684\u6298\u53e0\u3002 \u67e5\u627e\u5230\u4e86\u6298\u53e0\u91cc\u9762\u4f1a\u5c06\u6298\u53e0\u6253\u5f00\uff0c\u5904\u7406\u5b8c\u4e86\u4e4b\u540e\u8981\u81ea\u5df1\u5c06\u6298\u53e0\u5173\u4e0a\u3002</p>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#folding_patterns","title":"Folding Patterns","text":"<ul> <li>\u53ef\u4ee5\u7528\u666e\u901a\u7684\u5b9a\u4f4d\u65b9\u6cd5\u6765\u544a\u8bc9VIM\u4f60\u8981\u6298\u53e0\u54ea\u4e9b\u5730\u65b9\uff0c\u6bd4\u5982 <code>zj</code> \u5c06\u8df3\u5230\u4e0b\u4e00\u4e2a\u53ef\u6298\u53e0\u70b9\uff0c<code>zk</code> \u5c06\u8df3\u5230\u4e0a\u4e00\u4e2a\u53ef\u6298\u53e0\u70b9\u3002  </li> <li>\u53ef\u4ee5\u590d\u5408\u6570\u5b57 [count] \u6307\u5b9a fold depth \u6216 repeat times\uff0c\u4f8b\u5982 <code>zf9j</code> \u5c06\u4e0b\u97629\u884c\u7684\u5185\u5bb9\u6298\u8d77\u6765\u3002  </li> <li>\u53ef\u4ee5\u7528 marker\uff0c\u8fd8\u53ef\u4ee5\u7528\u884c\u53f7:20,50\uff0c\u5c31\u53ef\u4ee5\u628a20\u884c\u523050\u884c\u6298\u53e0\u8d77\u6765\u3002  </li> <li>\u4e5f\u53ef\u4ee5\u9488\u5bf9 text object \u8fdb\u884c\u6298\u53e0\uff0c\u4f8b\u5982 <code>zfa}</code> \u6307\u4ee4\u53ef\u4ee5\u5c06\u4e0b\u9762\u5339\u914d\u7684\u82b1\u62ec\u53f7\u4e4b\u95f4\u7684 Block \u6298\u53e0\u8d77\u6765\uff0c\u8fd9\u6837\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u6298\u53e0\u51fd\u6570\u3002  </li> <li>\u5176\u4ed6\u7684\u6298\u53e0\u65b9\u6cd5\u8fd8\u6709 <code>zf/string</code>\uff0c\u53ef\u4ee5\u6298\u53e0\u5230\u4e0b\u4e00\u4e2a\u5339\u914d\u7684string\uff0c\u4e0d\u8fc7\u597d\u50cf\u4e0d\u592a\u5b9e\u7528\u3002</li> </ul>","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#restoreload_folding","title":"restore/load folding","text":"<p>\u8981\u5728\u4e0b\u4e00\u6b21\u6253\u5f00\u7684\u65f6\u5019\u8fd8\u4fdd\u7559\u6298\u53e0\uff0c\u53ef\u4ee5\u5728\u79bb\u5f00\u7684\u65f6\u5019 <code>:mkview</code> \uff0c\u518d\u8fdb\u6765\u7684\u65f6\u5019 <code>:loadview</code> \u5c31\u53ef\u4ee5\u4e86\u3002 \u5f53\u7136\u4e5f\u53ef\u4ee5\u5c06\u8fd9\u4e24\u53e5\u914d\u7f6e\u5230 <code>vimrc</code> \u91cc\u9762\u8ba9\u5176\u81ea\u52a8\u5b8c\u6210\u3002 \u8fd9\u6837\u6bcf\u6b21\u5c31\u53ef\u4ee5\u770b\u5230\u4e0a\u6b21\u7684\u6298\u53e0\u4e86\u3002</p> command function <code>:mkvie[w][!] [file]</code> Write a Vim script that restores the contents of the current window. <code>:lo[adview] [nr]</code> Load the view for the current file.When [nr] is omitted, the view stored with \":mkview\" is loaded.When [nr] is specified, the view stored with \":mkview[nr]\" is loaded.","tags":["vim"]},{"location":"blog/20171018/010-vim-folding/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>VIM fold \u6298\u53e0 VIM\u8bbe\u7f6e\u4ee3\u7801\u6298\u53e0 VIM\u5b66\u4e60\u7b14\u8bb0\u4e4b\u6298\u53e0 \u539f\u6765Vim\u7684fold\u53ef\u4ee5\u8fd9\u4e48\u62c9\u98ce\uff01 </p>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/","title":"vim\u641c\u7d22","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 vim \u641c\u7d22\u67e5\u627e\u548c\u66ff\u6362\u7684\u57fa\u672c\u64cd\u4f5c\u3002</p> <p>\u53c2\u8003\uff1a<code>/usr/share/vim/vim[0-9][0-9]/doc/change.txt</code></p> <p>Search and replace </p>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#ft_\u641c\u7d22\u5b57\u7b26","title":"f,t \u641c\u7d22\u5b57\u7b26","text":"\u6307\u4ee4 \u8bf4\u660e <code>t{char}</code> Till before [count]'th occurrence of {char} to right. <code>T{char}</code> Till before [count]'th occurrence of {char} to left. <code>f{char}</code> To [count]'th occurrence of {char} to the right. <code>F{char}</code> To the [count]'th occurrence of {char} to the left.","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#repeat","title":"repeat","text":"\u6307\u4ee4 \u8bf4\u660e <code>;</code> Repeat latest f, t, F or T [count] times. <code>,</code> Repeat latest f, t, F or T in opposite direction [count] times. <p>\u5bf9\u5e94\u5e2e\u52a9\u6587\u6863\uff1amotion.txt</p>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#_\u641c\u7d22\u67e5\u627e","title":"/,* \u641c\u7d22\u67e5\u627e","text":"<p>\u5bf9\u5e94\u5e2e\u52a9\u6587\u6863\uff1apattern.txt\uff0c\u5e2e\u52a9\u547d\u4ee4 <code>:h pattern-overview</code>\u3001<code>:h regexp</code> \u6216 <code>:h vimgrep</code>\u3002</p> \u547d\u4ee4 \u8bf4\u660e \u5907\u6ce8 <code>/phrase</code> searches FORWARD for the phrase <code>\\c</code>\u53ef\u4ee5\u5ffd\u7565\u5927\u5c0f\u5199\uff08ignore case\uff09\uff0c<code>\\C</code>\u5219\u533a\u5206\u5927\u5c0f\u5199 <code>?phrase</code> searches BACKWARD for the phrase <code>\\c</code>\u53ef\u4ee5\u5ffd\u7565\u5927\u5c0f\u5199\uff08ignore case\uff09\uff0c<code>\\C</code>\u5219\u533a\u5206\u5927\u5c0f\u5199 <code>*phrase</code> search forward : <code>/\\&lt;phrase\\&gt;</code> \u5411\u4e0b\u67e5\u627e\u5f53\u524d\u5149\u6807\u6240\u5728\u5355\u8bcd <code>#phrase</code> search backward : <code>?\\&lt;phrase\\&gt;</code> \u5411\u4e0a\u67e5\u627e\u5f53\u524d\u5149\u6807\u6240\u5728\u5355\u8bcd <p>\u5728 <code>/</code> \u6216 <code>?</code> \u540e\u8f93\u5165\u5173\u952e\u5b57\u540e\uff0c\u6309\u56de\u8f66\u952e\u5f00\u59cb\u641c\u7d22\uff0c\u7136\u540e\u6309 n/N \u67e5\u627e\u4e0b/\u4e0a\u4e00\u4e2a\u3002</p> <ul> <li><code>n</code>: to find the next occurrence in the same direction  </li> <li><code>N</code>: to search in the opposite direction  </li> <li><code>gn</code>: Search forward for the last used search pattern, and start Visual mode to select the match.  </li> </ul> <p>\u5bf9\u4e8e\u6587\u672c <code>This is his idea</code>\uff0c\u6267\u884c <code>/his</code> \u5c06\u4f1a\u547d\u4e2d This \u548c his\uff1b\u6267\u884c <code>/\\&lt;his\\&gt;</code> \u5c06\u53ea\u547d\u4e2d his\u3002</p> <p>\u53c2\u8003 VI(1P) \u7684 EXTENDED DESCRIPTION \u7684\u4ee5\u4e0b\u7ae0\u8282\uff1a</p> <ul> <li>Find Regular Expression\uff08Synopsis: <code>/</code>\uff09  </li> <li>Scan Backwards for Regular Expression\uff08Synopsis: <code>?</code>\uff09  </li> <li>Repeat Regular Expression Find (Forward)\uff08Synopsis: <code>n</code>\uff09  </li> <li>Repeat Regular Expression Find (Reverse)\uff08Synopsis: <code>N</code>\uff09  </li> </ul> <p>Vi and Vim Editor: 12 Powerful Find and Replace Examples </p> <p>\u7531\u4e8e\u914d\u7f6e\u4e86\u67e5\u627e\u5339\u914d\u9ad8\u4eae\u663e\u793a\uff08hls/hlsearch\uff09\uff0c\u67e5\u627e\u5230\u7684\u5339\u914d\u7ed3\u679c\u4f1a\u9ad8\u4eae\u663e\u793a\uff0c\u5982\u679c\u60f3\u53bb\u9664\u641c\u7d22\u7ed3\u679c\u9ad8\u4eae\uff0c\u53ef\u4ee5\u53c2\u8003 vim-pattern\u3002</p>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#repeat_1","title":"repeat","text":"<p><code>/phrase</code> \u548c <code>?phrase</code> \u5c3e\u90e8\u53ef\u6dfb\u52a0 <code>/</code> \u548c <code>?</code> \u8fdb\u884c\u95ed\u5408\uff0c\u540e\u9762\u53ef\u4ee5\u6dfb\u52a0\u5176\u4ed6\u9009\u9879\uff0c\u4f8b\u5982 <code>/phrase/e</code> \u5b9a\u4f4d\u5230\u7ed3\u5c3e\u5b57\u7b26\u524d\u3002</p> <p><code>/&lt;CR&gt;</code>(<code>//&lt;CR&gt;</code>) \u548c <code>?&lt;CR&gt;</code>(<code>??&lt;CR&gt;</code>) \u5747\u6309\u4e0a\u6b21\u7684\u5173\u952e\u8bcd\u8fdb\u884c\u67e5\u627e\u3002</p> <p><code>q/</code> \u548c <code>q?</code> \u53ef\u67e5\u770b\u67e5\u627e\u5386\u53f2\u3002</p>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#visual","title":"visual","text":"<p>\u67e5\u627e\u547d\u4ee4\u4e0d\u4ec5\u9650\u4e8e\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\u4f7f\u7528\uff0c\u8fd8\u53ef\u4ee5\u5728\u53ef\u89c6\u6a21\u5f0f\u53ca\u64cd\u4f5c\u7b26\u5f85\u51b3\u6a21\u5f0f\u4e2d\u4f7f\u7528\u5b83\u3002</p> <p>\u4f8b\u53e5\uff1a<code>This phrase takes time but eventually gets to the point.</code></p> <p>\u5047\u8bbe\u5f53\u524d\u5149\u6807\u5728\u5355\u8bcd <code>takes</code> \u7684\u9996\u5b57\u6bcd\uff0c\u5220\u9664 <code>takes time but eventually</code> \u7684\u64cd\u4f5c\u5e8f\u5217\u5982\u4e0b\uff1a</p> <ol> <li><code>v</code>: \u8fdb\u5165\u53ef\u89c6\u6a21\u5f0f\uff1b  </li> <li><code>/ge</code>\uff1a\u6269\u5927\u9009\u53d6\u5230 gets \u7684 <code>g</code>\uff1b  </li> <li><code>h</code>\uff1a\u5149\u6807\u56de\u9000\u5230\u7a7a\u683c\uff1b  </li> <li><code>d</code>\uff1a\u5220\u9664\u9009\u4e2d\u7684 <code>takes time but eventually</code>\uff1b  </li> </ol>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#g_\u901a\u914d","title":"<code>:g</code> \u901a\u914d","text":"<pre><code>                                                :g :global E148\n:[range]g[lobal]/{pattern}/[cmd]\n                        Execute the Ex command [cmd] (default \":p\") on the\n                        lines within [range] where {pattern} matches.\n\n:[range]g[lobal]!/{pattern}/[cmd]\n                        Execute the Ex command [cmd] (default \":p\") on the\n                        lines within [range] where {pattern} does NOT match.\n</code></pre> <p>\u5728 vim \u4e2d\u8f93\u5165 <code>:g/{pattern}</code> \u547d\u4ee4\u53ef\u5217\u51fa\u6240\u6709\u901a\u914d\u6a21\u5f0f <code>pattern</code> \u7684\u884c\u3002  </p> <ul> <li>\u6267\u884c <code>:g/{pattern}/d</code> \u5220\u9664\u6240\u6709\u5339\u914d\u884c\u3002  </li> <li>\u6267\u884c <code>:g/{pattern}/m0</code> \u6216 <code>:g/{pattern}/m$</code> \u8df3\u8f6c\u5230\u7b2c\u4e00\u4e2a\u6216\u6700\u540e\u4e00\u4e2a\u5339\u914d\u884c\u3002  </li> </ul>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#permute_lines_reverse","title":"Permute Lines: Reverse","text":"<p>\u7ecf\u5178\u6848\u4f8b\uff1aReverse order of lines</p> <p>reverse all lines in the current buffer:</p> <pre><code>:g/^/m0\n</code></pre> <ol> <li><code>:</code> start command-line mode.  </li> <li><code>g</code> means you'll take an action on any lines where a regular expression matches  </li> <li><code>/</code> begins the regular expression (could have used any valid delimiter)  </li> <li><code>^</code> matches the start of a line (which matches all lines in the buffer)  </li> <li>the second <code>/</code> ends the regular expression; the rest is an Ex command to execute on all matched lines (i.e. all lines in buffer)  </li> <li><code>m</code> means move (<code>:help :move</code>)  </li> <li><code>0</code> is the destination line (beginning of buffer)  </li> </ol> <p>\u5728 Unix-like \u7cfb\u7edf\u4e0a\uff0c\u5982\u679c\u6709 <code>tac</code> \u547d\u4ee4\uff0c\u53ef\u4ee5\u6267\u884c <code>:%!tac</code> \u5229\u7528\u5916\u90e8\u547d\u4ee4\u5b9e\u73b0\u884c\u5e8f\u7ffb\u8f6c\u3002</p> <p>\u4ee5\u4e0b\u4e3a /share/vim/vim82/doc/change.txt \u4e2d\u5173\u4e8e <code>:move</code> \u5e2e\u52a9\u7684\u90e8\u5206\u6587\u5b57\uff1a</p> <pre><code>1346 :[range]m[ove] {address}                        :m :mo :move E134\n1347                         Move the lines given by [range] to below the line\n1348                         given by {address}.\n1349\n1350 ==============================================================================\n1351 6. Formatting text                                      formatting\n1352\n1353 :[range]ce[nter] [width]                                :ce :center\n1354                         Center lines in [range] between [width] columns\n1355                         (default 'textwidth' or 80 when 'textwidth' is 0).\n</code></pre> <p>\u6267\u884c <code>:1350,1353g/^/m1349</code>\uff0c\u53ef\u5c06 1350~1353 \u8fd94\u884c\u79fb\u52a8\u5230 1349 \u884c\u4e0b\u9762\uff08\u76841350\u884c\uff09\uff0c\u5b9e\u73b0\u884c\u5e8f\u7ffb\u8f6c\uff1a</p> <pre><code>1346 :[range]m[ove] {address}                        :m :mo :move E134\n1347                         Move the lines given by [range] to below the line\n1348                         given by {address}.\n1349\n1350 :[range]ce[nter] [width]                                :ce :center\n1351\n1352 6. Formatting text                                      formatting\n1353 ==============================================================================\n1354                         Center lines in [range] between [width] columns\n1355                         (default 'textwidth' or 80 when 'textwidth' is 0).\n</code></pre> <p>\u53ef\u5206\u6b65\u6267\u884c\u67e5\u770b\u9010\u884c\u79fb\u52a8\u7684\u64cd\u4f5c\u7ed3\u679c\uff1a</p> <ol> <li><code>:1350m1349</code>\uff1a\u5c061350\u884c\u79fb\u52a8\u52301350\u884c\uff0c\u4e0d\u53d8\uff1b  </li> <li><code>:1351m1349</code>\uff1a\u5c061351\u884c\u79fb\u52a8\u52301350\u884c\uff0c\u539f1350\u884c\u4e0b\u79fb\u81f31351\u884c\uff1b  </li> <li><code>:1352m1349</code>\uff1a\u5c061352\u884c\u79fb\u52a8\u52301350\u884c\uff0c1350\u884c\uff08\u539f1351\u884c\uff09\u4e0b\u79fb\u81f31351\u884c\uff1b  </li> <li><code>:1353m1349</code>\uff1a\u5c061353\u884c\u79fb\u52a8\u52301350\u884c\uff0c1350\u884c\uff08\u539f1352\u884c\uff09\u4e0b\u79fb\u81f31351\u884c\uff1b  </li> </ol> <p>\u5728 Unix-like \u7cfb\u7edf\u4e0a\uff0c\u5982\u679c\u6709 <code>tac</code> \u547d\u4ee4\uff0c\u53ef\u4ee5\u6267\u884c <code>:1350,1353!tac</code> \u5229\u7528\u5916\u90e8\u547d\u4ee4\u5b9e\u73b0\u884c\u5e8f\u7ffb\u8f6c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#regex","title":"regex","text":"<p>http://vimregex.com/</p> <p>\u53c2\u8003 VI(1P) \u7684 EXTENDED DESCRIPTION \u7684\u4ee5\u4e0b\u7ae0\u8282\uff1a</p> <ul> <li>Find Regular Expression\uff08Synopsis: <code>/</code>\uff09  </li> </ul>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#vimgrep","title":"vimgrep","text":"<p>Show only matching lines? How to filter text matched by global command? </p> <p>\u5728 vim \u4e2d\u67e5\u627e\u8fc7\u6ee4\u5305\u542b\u5173\u952e\u5b57\u7684\u884c\uff08filter lines\uff09\uff0c\u9664\u4e86\u6267\u884c\u7684 global pattern match \u4e4b\u5916\uff0c\u4e5f\u53ef\u6267\u884c vimgrep \u547d\u4ee4\u6267\u884c\u9ad8\u7ea7\u67e5\u627e\u8fc7\u6ee4\u3002</p> <ol> <li> <p>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u67e5\u627e\u6574\u4e2a\u6587\u4ef6\u5185\u7684\u5173\u952e\u5b57 <code>{pattern}</code>\uff1a</p> <p><code>:vimgrep {pattern} %</code></p> </li> </ol> <ul> <li><code>:cn</code> - jump to the next match  </li> <li><code>:cp</code> - jump to the previous match  </li> <li><code>:cwin</code>/<code>:copen</code> - open a window containing the list of matches  </li> </ul> <ol> <li> <p>\u6267\u884c <code>:cwin</code> \u6253\u5f00\u67e5\u627e\u7ed3\u679c buffer\u3002\u5728\u5176\u4e2d\u53ef\u4f7f\u7528\u4e0a\u4e0b\u65b9\u5411\u952e\u6216jk\u5b9a\u4f4d\uff0c\u6309\u4e0benter\u952e\u8df3\u8f6c\u5230\u539f\u6587\u5339\u914d\u884c\u3002  </p> </li> <li> <p>\u6267\u884c <code>:sav filterlines.txt</code> \u53ef\u5c06\u7ed3\u679c buffer \u4fdd\u5b58\u5230\u6307\u5b9a\u6587\u4ef6\uff08filterlines.txt\uff09\u4e2d\u3002  </p> </li> </ol>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#s_\u67e5\u627e\u66ff\u6362the_substitute_command","title":"<code>:s</code> \u67e5\u627e\u66ff\u6362\uff08THE SUBSTITUTE COMMAND\uff09","text":"<p>\u5bf9\u5e94\u5e2e\u52a9\u6587\u6863\uff1achange.txt</p> \u6309\u952e \u8bf4\u660e <code>:s/old/new</code> only changes the first occurrence of \"old\" in the line. <code>:s/old/new/g</code> Adding the <code>g</code> flag means to substitute globally in the line, change all occurrences of \"old\" in the line. <code>:#,#s/old/new/g</code> where #,# are the line numbers of the range of lines where the substitution is to be done. <code>:%s/old/new/g</code> to change every occurrence in the whole file. <code>:%s/old/new/gc</code> to find every occurrence in the whole file, with a prompt whether to substitute or not. <ul> <li><code>/g</code> \u5c3e\u7f00\uff08suffix\uff09\u4ee3\u8868\u5bf9\u884c\u5185\u6240\u6709\u5339\u914d\u90fd\u6267\u884c\uff08\u66ff\u6362\uff09\u64cd\u4f5c\uff1b  </li> <li><code>/c</code> \u5c3e\u7f00\uff08suffix\uff09\u4ee3\u8868\u6267\u884c\u64cd\u4f5c\u524d\u5f39\u51fa\u786e\u8ba4\uff08confirm prompt\uff09\uff1b  </li> <li><code>%</code> \u524d\u7f00\uff08prefix\uff09\u4ee3\u8868\u9488\u5bf9\u88ab\u7f16\u8f91\u6587\u4ef6\u7684\u6240\u6709\u884c\u90fd\u6267\u884c\u540e\u7eed\u64cd\u4f5c\uff1b  </li> </ul> <pre><code>[i]     Ignore case for the pattern.\n[I]     Don't ignore case for the pattern.\n</code></pre> <p>\u53ef\u4ee5\u53c2\u8003\u5206\u6790\u5e2e\u52a9\u6587\u6863\u4e2d\u7684\u793a\u4f8b\uff1a</p> <pre><code>Examples: &gt;\n# \\0: replaced with the whole matched pattern\n  :s/a\\|b/xxx\\0xxx/g             modifies \"a b\"      to \"xxxaxxx xxxbxxx\"\n\n  :s/\\([abc]\\)\\([efg]\\)/\\2\\1/g   modifies \"af fa bg\" to \"fa fa gb\"\n\n# \u4e2d\u95f4\u63d2\u5165\u6362\u884c\u7b26\uff0c\u76f8\u5f53\u4e8e\u5207\u5272\u5206\u884c\n  :s/abcde/abc^Mde/              modifies \"abcde\"    to \"abc\", \"de\" (two lines)\n\n# \u8f6c\u4e49\u4e3a\u539f\u59cb\u7b26\u53f7\uff0c\u53ea\u662f\u5728\u5f53\u524d\u884c\u672b\u6dfb\u52a0\u4e24\u4e2a\u5b57\u7b26(^M)\n  :s/$/\\^M/                      modifies \"abcde\"    to \"abcde^M\"\n\n\n  :s/\\w\\+/\\u\\0/g                 modifies \"bla bla\"  to \"Bla Bla\"\n  :s/\\w\\+/\\L\\u\\0/g               modifies \"BLA bla\"  to \"Bla Bla\"\n\ncommand         text    result ~\n:s/aa/a^Ma/     aa      a&lt;line-break&gt;a\n:s/aa/a\\^Ma/    aa      a^Ma\n:s/aa/a\\\\^Ma/   aa      a\\&lt;line-break&gt;a\n\n(you need to type CTRL-V &lt;CR&gt; to get a ^M here)\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/011-vim-search/#\u793a\u4f8b","title":"\u793a\u4f8b","text":"<p>VIM\u591a\u884c\u6ce8\u91ca/\u53cd\u6ce8\u91ca vim\u591a\u884c\u6ce8\u91ca\u548c\u53d6\u6d88\u6ce8\u91ca vim\u884c\u9996\u52a0\u5165\u67d0\u5b57\u7b26 vi/vim \u4e2d\u5982\u4f55\u5728\u6bcf\u884c\u884c\u9996\u6216\u884c\u5c3e\u63d2\u5165\u6307\u5b9a\u5b57\u7b26\u4e32 </p> <ol> <li>\u5728\u6240\u6709\u884c\u9996\u6dfb\u52a0\u6ce8\u91ca\u7b26\u53f7\uff08//\uff09\uff1a  </li> </ol> <p><code>:%s/^/\\/\\//g</code> <code>:%s#^#//#g</code>\uff08\u7528 <code>#</code> \u6216 <code>+</code> \u4ee3\u66ff <code>/</code>\uff0cold \u6216 new \u4e2d\u7684 <code>/</code> \u4e0d\u7528\u8f6c\u4e49\uff09  </p> <p>\u8bf4\u660e\uff1a\u884c\u9996\uff08old=<code>^</code>\uff09\u66ff\u6362\u4e3a\u6ce8\u91ca\u7b26\u53f7\uff08new=<code>//</code>\uff09\u3002  </p> <p>\u82e5\u5c06 <code>^</code> \u66ff\u6362\u4e3a <code>$</code> \u5219\u9488\u5bf9\u884c\u5c3e\u64cd\u4f5c\u3002  </p> <ol> <li>\u4e3a 20~50 \u884c\u9996\u6dfb\u52a0\u6ce8\u91ca\u7b26\u53f7\uff08//\uff09\uff1a  </li> </ol> <p><code>:20,50 s/^/\\/\\//g</code> <code>:20,50s#^#//#g</code> </p> <p>\u5728 markdown \u6587\u6863\u7684 143~145\u8fd93\u884c\u9996\u63d2\u5165 <code>-</code>\uff0c\u4f7f\u4e4b\u6210\u4e3a Unordered List\uff1a<code>143,145s#^#- #</code> </p> <p>\u5982\u679c\u662f\u884c\u5c3e\u7684\u8bdd\uff0c\u5c06 <code>^</code> \u6362\u6210 <code>$</code>\u3002  </p> <ol> <li>\u4e3a 20~50 \u884c\u9996\u79fb\u9664\u6ce8\u91ca\u7b26\u53f7\uff08//\uff09\uff1a</li> </ol> <p><code>:20,50 s/^\\/\\///g</code> <code>:20,50s#^//##g</code> </p> <p>\u884c\u9996\u7684\u6ce8\u91ca\u7b26\u53f7\uff08old=<code>^//</code>\uff09\u66ff\u6362\u4e3a\u7a7a\uff08new=\u7a7a\uff09\uff0c\u76f8\u5f53\u4e8e\u5220\u9664\u3002  </p> <ol> <li>\u5c06\u7a7a\u884c\u5220\u9664\uff1a</li> </ol> <p><code>:1,$s/^$\\n//g</code></p> <p>\u5c06\u9996\u884c\u5230\u672b\u884c\uff08\u5168\u6587\uff09\u4e2d\u5185\u5bb9\u4e3a\u6362\u884c\u7b26\uff08old=<code>^$\\n</code>\uff09\u7684\u7a7a\u884c\u66ff\u6362\u4e3a\u7a7a\uff08new=\u7a7a\uff09\uff0c\u76f8\u5f53\u4e8e\u79fb\u9664\u7a7a\u884c\u3002  </p> <p><code>:%s/\\n//g</code>\uff1a\u5220\u9664\u6362\u884c\u7b26\uff1b <code>:%s/\\r//g</code>\uff1a\u5220\u9664DOS\u6587\u4ef6\u4e2d\u7684\u56de\u8f66\u7b26<code>^M</code>\uff1b  </p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/","title":"vim\u7a97\u683c","text":"<p>\u672c\u6587\u68b3\u7406\u4e86 vim \u4e2d\u590d\u7528\u7a97\u53e3\u3001\u5206\u5c4f\u7a97\u53e3\u548c\u591a\u6807\u7b7e\u7b49\u57fa\u672c\u64cd\u4f5c\u3002</p> <p>vim\u5728\u591a\u4e2a\u6587\u4ef6\u4e4b\u95f4\u5207\u6362 vim\u6253\u5f00\u6587\u6863\u548c\u591a\u6587\u6863\u7f16\u8f91</p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u67e5\u770b\u6587\u4ef6\u4fe1\u606f","title":"\u67e5\u770b\u6587\u4ef6\u4fe1\u606f","text":"\u6309\u952e \u8bf4\u660e \u5907\u6ce8 <code>:f</code> / <code>&lt;C-g&gt;</code> \u67e5\u770b\u5f53\u524d\u6587\u4ef6\u4fe1\u606f \u5305\u62ec\u6587\u4ef6\u540d\u3001\u5c5e\u6027\u3001\u884c\u6570\u3001\u9605\u8bfb\u8fdb\u5ea6\u3001\u5149\u6807\u4f4d\u7f6e\u7b49\u4fe1\u606f <code>1&lt;C-g&gt;</code> \u67e5\u770b\u5f53\u524d\u6587\u4ef6\u4fe1\u606f \u7edd\u5bf9\u8def\u5f84 \u6587\u4ef6\u540d <code>:f {filename}</code> \u62f7\u8d1d\u5f53\u524d\u6587\u6863 \u7c7b\u4f3c<code>:w {filename}</code>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u590d\u7528\u7a97\u53e3","title":"\u590d\u7528\u7a97\u53e3","text":"<p>\u590d\u7528\u4e00\u4e2a\u7a97\u53e3\u6253\u5f00\u7f16\u8f91\u591a\u4e2a\u6587\u6863\uff08buffer\uff09\u3002</p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#openedit","title":"open(edit)","text":"<p>\u5f53\u524dvim\u7a97\u53e3\u518d\u6253\u5f00/\u65b0\u5efa\u6587\u4ef6</p> <p>\u524d\u9762\u6211\u4eec\u5728\u8c03\u7528vim\u6253\u5f00\u6587\u4ef6\u65f6\uff0c\u53ea\u5e26\u4e86\u4e00\u4e2a\u6587\u4ef6\u53c2\u6570\u3002\u5b9e\u9645\u4e0a\uff0c\u5728\u7f16\u8f91\u4e00\u4e2a\u6587\u4ef6\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u5e95\u884c\u6a21\u5f0f\u6307\u4ee4\u5728\u5f53\u524d\u7a97\u53e3\u518d\u6253\u5f00\u6216\u65b0\u5efa\u6587\u4ef6\u3002</p> \u547d\u4ee4 \u4f5c\u7528 \u5907\u6ce8 <code>:e {filename}</code> / <code>:open {filename}</code> \u5f53\u524d\u7a97\u53e3\u7f16\u8f91\uff08edit\uff09\u6587\u4ef6\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u65b0\u5efa\u3002\u5982\u679c\u5f53\u524d\u6587\u4ef6\u6709\u8fc7\u4fee\u6539\u4f1a\u63d0\u793a<code>No write since last change (add ! to override)</code>\uff0c\u9700\u5148\u4fdd\u5b58\u6216<code>!</code>\u5f3a\u5236\u8986\u76d6\u3002 editing.txt <code>:n {filename}</code> \u5f53\u524d\u7a97\u53e3\u65b0\u5efa\u6587\u4ef6\uff0c\u5982\u679c\u5df2\u5b58\u5728\u76f4\u63a5\u6253\u5f00\u3002\u5982\u679c\u5f53\u524d\u6587\u4ef6\u6709\u8fc7\u4fee\u6539\u4f1a\u63d0\u793a<code>No write since last change (add ! to override)</code>\uff0c\u9700\u5148\u4fdd\u5b58\u6216<code>!</code>\u5f3a\u5236\u8986\u76d6\u3002 editing.txt <code>:files</code> / <code>:buffers</code> / <code>:ls</code> \u5217\u51fa\u76ee\u524d\u7f13\u51b2\u533a\u4e2d\u7684\u6240\u6709\u6587\u6863\u3002 <code>+</code> \u8868\u793a\u7f13\u51b2\u533a\u5df2\u7ecf\u88ab\u4fee\u6539\u8fc7\u4e86\uff1b <code>\uff03</code> \u4ee3\u8868\u4e0a\u4e00\u6b21\u7f16\u8f91\u7684\u6587\u6863\uff1b <code>%</code> \u662f\u5f53\u524d\u6b63\u5728\u7f16\u8f91\u7684\u6587\u6863\u3002 windows.txt","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#workdir","title":"workdir","text":"<p>\u76f8\u5bf9\u4e8e\u6d3b\u52a8\u6587\u4ef6\u76ee\u5f55\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6</p> <p><code>:e %:h</code>: \u5f53\u524d\u6587\u4ef6\uff08%\uff09\u5b8c\u6574\u8def\u5f84\u53bb\u9664\u6587\u4ef6\u540d\uff08<code>:h</code>\uff09\uff0c\u5373\u6253\u5f00\u6240\u5728\u76ee\u5f55\u7684\u8def\u5f84\u3002 \u6309\u4e0b <code>&lt;C-^&gt;</code> \u5207\u56de\u521a\u624d\u6b63\u5728\u7f16\u8f91\u7684\u6587\u6863\u3002  </p> <p>\u4e5f\u53ef\u901a\u8fc7 <code>:E</code> &amp; <code>:Re</code> \u5b9e\u73b0\u540c\u6837\u7684\u6548\u679c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#path","title":"path","text":"<p><code>path</code> \u9009\u9879\u5141\u8bb8\u6211\u4eec\u6307\u5b9a\u4e00\u4e9b\u76ee\u5f55\uff0c\u5f53\u8c03\u7528 <code>:find</code> \u547d\u4ee4\u65f6\uff0cvim \u4f1a\u5728\u8fd9\u4e9b\u76ee\u5f55\u4e2d\u8fdb\u884c\u67e5\u627e\u3002</p> <p><code>:find</code> \u547d\u4ee4\u7684\u4f5c\u7528\uff1a<code>Find {file} in 'path' and then :edit it.</code></p> <p>\u5e95\u884c\u8f93\u5165\u6267\u884c <code>:set path ?</code>\uff0c\u67e5\u770b path \u7684\u9ed8\u8ba4\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>path=.,/usr/include,,\n</code></pre> <ol> <li><code>.</code> \u4e3a\u5f53\u524d\u6587\u4ef6\u6240\u5728\u76ee\u5f55\uff1b  </li> <li><code>/usr/include</code> \u4e3a\u7cfb\u7edf\u5934\u6587\u4ef6\u5305\u542b\u76ee\u5f55\uff1b  </li> </ol> <p>\u591a\u4e2a\u76ee\u5f55\u4e4b\u95f4\u4ee5\u9017\u53f7\uff08<code>,</code>\uff09\u5206\u5272\u3002</p> <p>\u5982\u679c\u5de5\u4f5c\u7684\u5de5\u7a0b\u4e2d\u5305\u542b\u591a\u7ea7\u5d4c\u5957\u76ee\u5f55\u5462\uff1f\u6bcf\u6b21\u6253\u5f00\u6587\u4ef6\u90fd\u9700\u8981\u8f93\u5165\u5b8c\u6574\u8def\u5f84\uff0c\u786e\u8ba4\u5f88\u9ebb\u70e6\u3002 \u6b64\u65f6\uff0c\u53ef\u4ee5\u8003\u8651\u6dfb\u52a0\u67e5\u627e\u8def\u5f84\uff1a</p> <pre><code>:set path+=app/**\n</code></pre> <p><code>**</code> \u901a\u914d\u7b26\u4f1a\u5339\u914d <code>app/</code> \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u5b50\u76ee\u5f55\u3002</p> <p>\u914d\u7f6e\u67e5\u627e\u76ee\u5f55\u540e\uff0c<code>:find</code> \u547d\u4ee4\u53ef\u5728\u76ee\u5f55\u4e2d\u67e5\u627e\u5339\u914d\u7684\u6587\u4ef6\u5e76\u6253\u5f00\u3002</p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#switch","title":"switch","text":"<p>vim\u53ef\u4ee5\u63a5\u591a\u4e2a\u6587\u4ef6\u540d\u4f5c\u4e3a\u53c2\u6570\u5217\u8868\uff08argument list\uff09\uff0c\u540c\u65f6\u6253\u5f00\u591a\u4e2a\u6587\u4ef6\uff1a</p> <pre><code>\u279c  ~  cd /usr/share/vim/vim[0-9][0-9]/doc\n\u279c  doc  vim usr_01.txt usr_02.txt usr_03.txt\n</code></pre> <p>\u6253\u5f00\u7684\u8fd9\u51e0\u4e2a\u6587\u4ef6\u5404\u81ea\u6709\u5bf9\u5e94\u7684 swap buffer\uff0c\u4f46\u5171\u7528\u5f53\u524d\u8fd9\u4e00\u4e2a\u7f16\u8f91\u7a97\u53e3\uff0c\u9700\u8981\u6267\u884c\u547d\u4ee4\u5207\u6362\u6587\u4ef6\u3002</p> <p>\u591a\u6587\u6863\u5207\u6362</p> \u547d\u4ee4 \u8bf4\u660e \u5907\u6ce8 <code>:n</code> \u7f16\u8f91\u4e0b\u4e00\u4e2a\u6587\u6863 \u9488\u5bf9argument list\uff0c\u53ef\u53c2\u8003editing.txt <code>:N</code> \u7f16\u8f91\u4e0a\u4e00\u4e2a\u6587\u6863 \u9488\u5bf9argument list\uff0c\u53ef\u53c2\u8003editing.txt <code>:b {n}</code> \u79fb\u81f3\u7b2cn\u4e2a\u6587\u6863\uff08buffer\uff09 n\u4e3a<code>:files</code>/<code>:buffers</code>\u4e2d\u7684\u5e8f\u53f7\uff0c\u53ef\u53c2\u8003 windows.txt <code>:bd {n}</code> \u5173\u95ed\uff08delete\uff09\u7b2cn\u4e2a\u6587\u6863\uff08buffer\uff09 n\u4e3a<code>:files</code>/<code>:buffers</code>\u4e2d\u7684\u5e8f\u53f7\uff0c\u53ef\u53c2\u8003 windows.txt <code>:bn</code> \u7f16\u8f91\u4e0b\u4e00\u4e2a\u6587\u6863 \u9488\u5bf9buffers\uff0c\u53ef\u53c2\u8003editing.txt <code>:bN</code> / <code>:bp</code> \u7f16\u8f91\u4e0a\u4e00\u4e2a\u6587\u6863 \u9488\u5bf9buffers\uff0c\u53ef\u53c2\u8003editing.txt <p>\u8bf4\u660e\uff1a</p> <p><code>:n</code>\u548c<code>:N</code>\u53ea\u80fd\u9488\u5bf9 argument list \u6253\u5f00\u7684\u591a\u6587\u4ef6\u95f4\u8fdb\u884c\u5207\u6362\uff0cvim\u6253\u5f00\u5355\u6587\u4ef6\u6216\u540e\u671f\u8ffd\u52a0\u6253\u5f00/\u7f16\u8f91\u6587\u4ef6\u7684\u5c06\u63d0\u793a <code>There is only one file to edit</code>\u3002 \u5bf9\u4e8e\u591a\u4e2a\u6b63\u5728\u7f16\u8f91\u7684file buffer\uff0c\u9700\u8981\u9010\u4e2a <code>:w</code> \u4fdd\u5b58\uff0c\u6216\u8005\u6267\u884c <code>:qa</code>/<code>:qa!</code> \u5173\u95ed\u5168\u90e8\u9000\u51fa vim\u3002</p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u5206\u5c4f\u7a97\u53e3","title":"\u5206\u5c4f\u7a97\u53e3","text":"<p>\u53c2\u8003\uff1a <code>/usr/share/vim/vim[0-9][0-9]/doc/windows.txt</code></p> <pre><code>\u279c  ~  vim --help\nusage: vim [arguments] [file ..]       edit specified file(s)\n\nArguments:\n   --           Only file names after this\n\n   -o[N]        Open N windows (default: one for each file)\n   -O[N]        Like -o but split vertically\n</code></pre> <p>\u4ee5\u4e0b\u8c03\u7528 <code>vim -o</code> \u540c\u65f6\u6253\u5f003\u4e2a\u6587\u4ef6\uff0c\u6c34\u5e73\u5206\u5c4f\uff1a</p> <pre><code>\u279c  doc  vim -o usr_01.txt usr_02.txt usr_03.txt\n</code></pre> <p></p> <p>\u4ee5\u4e0b\u8c03\u7528 <code>vim -O</code> \u540c\u65f6\u6253\u5f003\u4e2a\u6587\u4ef6\uff0c\u5782\u76f4\u5206\u5c4f\uff1a</p> <pre><code>\u279c  doc  vim -O usr_01.txt usr_02.txt usr_03.txt\n</code></pre> <p></p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u65b0\u5efa\u5206\u5c4f","title":"\u65b0\u5efa\u5206\u5c4f","text":"\u547d\u4ee4 \u4f5c\u7528 <code>:new</code>/<code>:vnew</code> \u5728\u9876\u7aef/\u5de6\u4fa7\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5206\u5c4f\u7a97\u53e3 <code>:split</code>(<code>:sp</code>) / <code>:vsplit</code>(<code>:vs</code>) \u5728\u9876\u7aef/\u5de6\u4fa7\u65b0\u5efa\u5206\u5c4f\u5c06\u5f53\u524d\u6587\u6863\u8fdb\u884c\u591a\u5c4f\u663e\u793a <code>:sf {filename}</code> \u5728\u65b0\u7a97\u53e3\u4e2d\u6253\u5f00\u6307\u5b9a\u6587\u4ef6(\u5fc5\u987b\u5df2\u5b58\u5728) <code>:close</code> / <code>:q</code> \u5173\u95ed\u5f53\u524d\u7a97\u53e3 <code>:only</code> \u5173\u95ed\u9664\u5f53\u524d\u7a97\u53e3\u5916\u6240\u6709\u7a97\u53e3 <p>\u8bf4\u660e\uff1a</p> <ol> <li><code>:new</code>/<code>:vnew</code> \u5728\u9876\u7aef/\u5de6\u4fa7\u65b0\u5efa\u5206\u5c4f\uff0c\u9ed8\u8ba4\u6253\u5f00\u7a7a\u767d\u6587\u4ef6\uff0c\u4e5f\u53ef\u643a\u5e26 file \u53c2\u6570\u5728\u65b0\u5c4f\u6253\u5f00\u6307\u5b9a\u6587\u4ef6\u3002  </li> <li><code>:sp</code>/<code>:vs</code> \u5728\u9876\u7aef/\u5de6\u4fa7\u65b0\u5efa\u5206\u5c4f\uff0c\u9ed8\u8ba4\u9488\u5bf9\u5f53\u524d\u6587\u4ef6\u8fdb\u884c\u5206\u5c4f\uff0c\u4e5f\u53ef\u643a\u5e26 file \u53c2\u6570\u5728\u65b0\u5c4f\u6253\u5f00\u6307\u5b9a\u6587\u4ef6\u3002  </li> </ol> <pre><code>CTRL-W n                                                CTRL-W_n\nCTRL-W CTRL_N                                           CTRL-W_CTRL-N\n:[N]new [++opt] [+cmd]                                  :new\n                Create a new window and start editing an empty file in it.\n\n:[N]new [++opt] [+cmd] {file}\n:[N]sp[lit] [++opt] [+cmd] {file}                       :split_f\n                Create a new window and start editing file {file} in it.  This\n                behaves like a \":split\" first, and then an \":e\" command.\n\n[N]vne[w] [++opt] [+cmd] [file]                        :vne :vnew\n                Like :new, but split vertically.\n\nCTRL-W s                                                CTRL-W_s\nCTRL-W S                                                CTRL-W_S\nCTRL-W CTRL-S                                           CTRL-W_CTRL-S\n:[N]sp[lit] [++opt] [+cmd] [file]                       :sp :split\n                Split current window in two.  The result is two viewports on\n                the same file.\n\nCTRL-W CTRL-V                                           CTRL-W_CTRL-V\nCTRL-W v                                                CTRL-W_v\n:[N]vs[plit] [++opt] [+cmd] [file]                      :vs :vsplit\n                Like :split, but split vertically.\n</code></pre> <p>\u5728\u5e95\u884c\u8f93\u5165 <code>:h :new</code> \u5b9e\u9645\u4e0a\u662f\u5728\u5f53\u524d\u6587\u6863\u7a97\u683c\u7684\u9876\u90e8\u65b0\u5f00\u4e00\u4e2a\u7a97\u683c\u6253\u5f00\u5e2e\u52a9\u6587\u6863\u3002</p> <p>\u4ee5\u4e0b\u4e3a\u6c34\u5e73\u5206\u5c4f <code>:sp</code>\uff08CTRL-W_s\uff09\u548c\u5782\u76f4\u5206\u5c4f <code>:vs</code>\uff08CTRL-W_v\uff09\u7684\u6548\u679c\u6f14\u793a\uff1a</p> <p></p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#position","title":"position","text":"<p>\u5e95\u884c\u8f93\u5165 <code>:h :split</code> \u9ed8\u8ba4\u4f1a\u5728\u5f53\u524d\u7f16\u8f91\u6587\u6863\u7684\u9876\u90e8\u65b0\u5f00\u7a97\u683c\u663e\u793a\u5e2e\u52a9\u3002</p> <p>How can I make Vim open help in a vertical split?</p> \u547d\u4ee4 \u4f5c\u7528 <code>:bo h :bo</code>        \uff5c \u5728\u5f53\u524d\u7a97\u683c\u4e0b\u9762\u65b0\u5efa\u5206\u5c4f\u7a97\u683c\u6253\u5f00\u5e2e\u52a9 <code>:vert h :vert</code>    \uff5c \u5728\u5f53\u524d\u7a97\u683c\u5de6\u4fa7\u65b0\u5efa\u5206\u5c4f\u7a97\u683c\u6253\u5f00\u5e2e\u52a9 <pre><code>Note that the 'splitbelow' and 'splitright' options influence where a new\nwindow will appear.\n\n                                                :vert :vertical\n:vert[ical] {cmd}\n                Execute {cmd}.  If it contains a command that splits a window,\n                it will be split vertically.\n                Doesn't work for :execute and :normal.\n\n:lefta[bove] {cmd}                              :lefta :leftabove\n:abo[veleft] {cmd}                              :abo :aboveleft\n                Execute {cmd}.  If it contains a command that splits a window,\n                it will be opened left (vertical split) or above (horizontal\n                split) the current window.  Overrules 'splitbelow' and\n                'splitright'.\n                Doesn't work for :execute and :normal.\n\n:rightb[elow] {cmd}                             :rightb :rightbelow\n:bel[owright] {cmd}                             :bel :belowright\n                Execute {cmd}.  If it contains a command that splits a window,\n                it will be opened right (vertical split) or below (horizontal\n                split) the current window.  Overrules 'splitbelow' and\n                'splitright'.\n                Doesn't work for :execute and :normal.\n\n                                                :topleft E442\n:to[pleft] {cmd}\n                Execute {cmd}.  If it contains a command that splits a window,\n                it will appear at the top and occupy the full width of the Vim\n                window.  When the split is vertical the window appears at the\n                far left and occupies the full height of the Vim window.\n                Doesn't work for :execute and :normal.\n\n                                                :bo :botright\n:bo[tright] {cmd}\n                Execute {cmd}.  If it contains a command that splits a window,\n                it will appear at the bottom and occupy the full width of the\n                Vim window.  When the split is vertical the window appears at\n                the far right and occupies the full height of the Vim window.\n                Doesn't work for :execute and :normal.\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u5207\u6362\u5206\u5c4f","title":"\u5207\u6362\u5206\u5c4f","text":"<p>\u8f93\u5165 <code>:h CTRL-W</code> \u53ef\u67e5\u770b index.txt \u4e2d\u7684 Window commands \u5217\u8868\u3002 \u8f93\u5165 <code>:h window-move-cursor</code> \u6216 <code>:h CTRL-W_{arg}</code> \u53ef\u67e5\u770b windows.txt \u4e2d\u5177\u4f53\u7684\u5207\u6362\u7a97\u683c\u6309\u952e\u5e2e\u52a9\u3002  </p> \u6307\u4ee4 \u4f5c\u7528 <code>&lt;C-w&gt;h</code> \u5207\u6362\u7126\u70b9\u5230\u5de6\u9762\u7684\u7a97\u53e3 <code>&lt;C-w&gt;j</code> \u5207\u6362\u7126\u70b9\u5230\u4e0b\u9762\u7684\u7a97\u53e3 <code>&lt;C-w&gt;k</code> \u5207\u6362\u7126\u70b9\u5230\u4e0a\u9762\u7684\u7a97\u53e3 <code>&lt;C-w&gt;l</code> \u5207\u6362\u7126\u70b9\u5230\u53f3\u9762\u7684\u7a97\u53e3 <code>&lt;C-w&gt;w</code> \u987a\u5e8f\u7126\u70b9\u5faa\u73af\u5207\u6362\u7a97\u53e3 <code>&lt;C-w&gt;t</code> \u5207\u6362\u7126\u70b9\u5230\u9876\u90e8\u7684\u7a97\u53e3 <code>&lt;C-w&gt;b</code> \u5207\u6362\u7126\u70b9\u5230\u5e95\u90e8\u7684\u7a97\u53e3 <code>&lt;C-w&gt;p</code> \u5207\u6362\u7126\u70b9\u5230\u524d\u4e00\u4e2a\u7a97\u53e3 <code>&lt;C-w&gt;q</code> \u5173\u95ed\u5f53\u524d\u7a97\u53e3\uff0c\u76f8\u5f53\u4e8e <code>:q</code> / <code>:close</code> <p>\u9664\u4e86\u4f7f\u7528 <code>CTRL-W [count] {arg}</code> \u5feb\u6377\u952e\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5e95\u884c\u547d\u4ee4 <code>:wincmd {arg}</code> \u5207\u6362\u7a97\u683c\u3002</p> <p>arg \u53ef\u53d6 j\u3001k\u3001h\u3001l\u3001w\u3001t\u3001b\u3001p\u3001q\u3002</p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u79fb\u52a8\u7a97\u683c","title":"\u79fb\u52a8\u7a97\u683c","text":"\u6307\u4ee4 \u4f5c\u7528 <code>&lt;C-w&gt;H</code>(CTRL-W_H) move current window to the far left <code>&lt;C-w&gt;J</code>(CTRL-W_J) move current window to the very bottom <code>&lt;C-w&gt;K</code>(CTRL-W_K) move current window to the very top <code>&lt;C-w&gt;L</code>(CTRL-W_L) move current window to the far right","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u5206\u5c4f\u793a\u4f8b","title":"\u5206\u5c4f\u793a\u4f8b","text":"<p>\u4ee5\u4e0b\u57fa\u4e8e <code>vim -O</code> \u6253\u5f003\u4e2a\u6587\u4ef6\u7684\u5782\u76f4\u4e09\u5217\u5206\u5c4f\u518d\u8fdb\u884c\u6c34\u5e73\u5206\u5c4f\uff1a</p> <ol> <li>\u5c06\u5149\u6807\u5207\u6362\u805a\u7126\u5230\u7b2c\u4e00\u4e2a\u7a97\u53e3 <code>usr_01.txt</code> \u4e0a\uff0c\u6267\u884c <code>:sp usr_04.txt</code> \u5728\u4e0a\u9762\u6c34\u5e73\u5207\u5272\u51fa\u7684\u65b0\u7a97\u53e3\u6253\u5f00 <code>usr_04.txt</code>\u3002</li> <li><code>&lt;C-w&gt;l</code>\u5207\u6362\u5230 <code>usr_02.txt</code> \u7a97\u53e3\uff0c\u6267\u884c <code>:sp usr_05.txt</code> \u5728\u4e0a\u9762\u6c34\u5e73\u5207\u5272\u51fa\u7684\u65b0\u7a97\u53e3\u6253\u5f00 <code>usr_05.txt</code>\u3002</li> <li><code>&lt;C-w&gt;l</code>\u5207\u6362\u5230 <code>usr_03.txt</code> \u7a97\u53e3\uff0c\u6267\u884c <code>:sp usr_06.txt</code> \u5728\u4e0a\u9762\u6c34\u5e73\u5207\u5272\u51fa\u7684\u65b0\u7a97\u53e3\u6253\u5f00 <code>usr_06.txt</code>\u3002</li> </ol> <p>\u6700\u7ec8\u5206\u5272\u51fa\u516d\u5bab\u683c\u5e03\u5c40\uff1a</p> <p></p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u5c3a\u5bf8\u8c03\u6574","title":"\u5c3a\u5bf8\u8c03\u6574","text":"<p>\u5982\u679c\u7a97\u683c\u8fc7\u77ee\uff0c\u53ef\u901a\u8fc7 <code>:resize +N</code> \u589e\u5927 N \u4e2a\u5b57\u7b26\u9ad8\u5ea6\u3002 \u5982\u679c\u7a97\u683c\u8fc7\u7a84\uff0c\u53ef\u901a\u8fc7 <code>:vertical resize +N</code> \u589e\u5927 N \u4e2a\u5b57\u7b26\u5bbd\u5ea6\u3002  </p> <p><code>:h window-resize</code> \u67e5\u770b\u76f8\u5173\u8bae\u9898\u5e2e\u52a9\u3002</p> \u547d\u4ee4 \u4f5c\u7528 CTRL-W_= make all windows the same height &amp; width CTRL-W_+ increase current window height N lines CTRL-W_- decrease current window height N lines CTRL-W_&lt; decrease current window width N columns CTRL-W_&gt; increase current window width N columns <pre><code>1. Window resizing                                      window-resize\n\n                                                CTRL-W_=\nCTRL-W =        Make all windows (almost) equally high and wide, but use\n                'winheight' and 'winwidth' for the current window.\n                Windows with 'winfixheight' set keep their height and windows\n                with 'winfixwidth' set keep their width.\n\n:res[ize] -N                                    :res :resize CTRL-W_-\nCTRL-W -        Decrease current window height by N (default 1).\n                If used after :vertical: decrease width by N.\n\n:res[ize] +N                                    CTRL-W_+\nCTRL-W +        Increase current window height by N (default 1).\n                If used after :vertical: increase width by N.\n\n:res[ize] [N]\nCTRL-W CTRL-_                                   CTRL-W_CTRL-_ CTRL-W__\nCTRL-W _        Set current window height to N (default: highest possible).\n\n:{winnr}res[ize] [+-]N\n                Like :resize above, but apply the size to window {winnr}\n                instead of the current window.\n\nz{nr}&lt;CR&gt;       Set current window height to {nr}.\n\n                                                CTRL-W_&lt;\nCTRL-W &lt;        Decrease current window width by N (default 1).\n\n                                                CTRL-W_&gt;\nCTRL-W &gt;        Increase current window width by N (default 1).\n\n:vertical res[ize] [N]                  :vertical-resize CTRL-W_bar\nCTRL-W |        Set current window width to N (default: widest possible).\n</code></pre> <p>vim \u6539\u53d8\u7a97\u53e3\u7684\u5927\u5c0f vim\u7a97\u53e3\u8c03\u6574\u9ad8\u5ea6\u548c\u5bbd\u5ea6 vim: vs sp \u8c03\u6574\u7a97\u53e3\u9ad8\u5ea6\u548c\u5bbd\u5ea6 </p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u591a\u6807\u7b7e","title":"\u591a\u6807\u7b7e","text":"<p>REFERENCE MANUAL: <code>/usr/share/vim/vim[0-9][0-9]/doc/tabpage.txt</code> topic: Editing with windows in multiple tab pages. keyword: tab-page tabpage</p> <pre><code>\u279c  ~  vim --help\nusage: vim [arguments] [file ..]       edit specified file(s)\n\nArguments:\n   --           Only file names after this\n\n   -p[N]        Open N tab pages (default: one for each file)\n</code></pre> <p>\u4ee5\u4e0b\u8c03\u7528 <code>vim -p</code> \u540c\u65f6\u6253\u5f003\u4e2a\u6587\u4ef6\uff0c\u5206\u5e03\u5728\u540c\u4e00\u7a97\u53e3\u76843\u5404\u6807\u7b7e\uff08tab page\uff09\uff1a</p> <pre><code>\u279c  ~  cd /usr/share/vim/vim[0-9][0-9]/doc\n\u279c  doc  vim -p usr_01.txt usr_02.txt usr_03.txt\n</code></pre> <p></p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u65b0\u5efa\u5173\u95ed\u6807\u7b7e","title":"\u65b0\u5efa/\u5173\u95ed\u6807\u7b7e","text":"\u547d\u4ee4 \u8bf4\u660e <code>:tabnew</code> Open a new tab page with an empty window <code>:tabe</code> / <code>:tabedit</code> Open a new tab page with an empty window <code>:tabs</code> List the tab pages and the windows they contain. - Shows a \"&gt;\" for the current window; - Shows a \"+\" for modified buffers. <code>:tabc</code> / <code>:tabclose</code> Close current tab page  you can specify the tab index that want to close. <code>:tabo</code> / <code>:tabonly</code> Close all other tab pages.","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#tab","title":":tab","text":"<p><code>:tab</code> \u5b8c\u6574\u547d\u4ee4\u683c\u5f0f\uff1a<code>:[count]tab {cmd}</code></p> <p>Execute {cmd} and when it opens a new window open a new tab page instead.</p> <p>\u4e00\u822c\u540e\u7eed\u63a5 cmd\uff0c\u4f8b\u5982 <code>:tab split</code> : \u65b0\u5efatab\u6253\u5f00\u5f53\u524d\u6587\u6863\uff08opens current buffer in new tab page\uff09</p> <p>\u5728 tab \u9875\u4e2d\u642d\u914d\u4f7f\u7528 <code>:new</code>/<code>:vnew</code>\u3001<code>:sp</code>/<code>:vs</code> \u53ef\u5728 tab \u9875\u4e2d\u8fdb\u884c\u5206\u5c4f\u3002</p> <p>\u5728\u5e95\u884c\u8f93\u5165 <code>:h :new</code> \u662f\u5728\u5f53\u524d\u6587\u6863\u7a97\u683c\u7684\u9876\u90e8\u65b0\u5f00\u4e00\u4e2a\u7a97\u683c\u6253\u5f00\u5e2e\u52a9\u6587\u6863\u3002</p> <p>\u4e5f\u53ef\u8003\u8651\u65b0\u5efa\u4e00\u4e2a\u4e13\u95e8\u7684\u6807\u7b7e\u9875\u7528\u6765\u9605\u8bfb\u67e5\u770b\u5e2e\u52a9\u6587\u6863\u3002</p> \u547d\u4ee4 \u8bf4\u660e <code>:tab help gt</code> opens tab page with help for \"gt\" <code>:.tab help gt</code> as above <code>:+tab help</code> opens tab page with help after the next tab page <code>:-tab help</code> opens tab page with help before the current one <code>:0tab help</code> opens tab page with help before the first one <code>:$tab help :tab</code> opens tab page with help for <code>:tab</code> after the last one","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#tabnew","title":":tabnew","text":"<p><code>:h :tabnew</code> \u67e5\u770b\u65b0\u5efa\u7a7a\u767d tab \u7684\u547d\u4ee4 <code>tabnew</code>\uff1a</p> <pre><code>:[count]tabe[dit]                               :tabe :tabedit :tabnew\n:[count]tabnew\n                Open a new tab page with an empty window, after the current\n                tab page.  If [count] is given the new tab page appears after\n                the tab page [count] otherwise the new tab page will appear\n                after the current one.\n                    :tabnew     \" opens tabpage after the current one\n                    :.tabnew    \" as above\n                    :+tabnew    \" opens tabpage after the next tab page\n                                \" note: it is one further than :tabnew\n                    :-tabnew    \" opens tabpage before the current one\n                    :0tabnew    \" opens tabpage before the first one\n                    :$tabnew    \" opens tabpage after the last one\n</code></pre> <p><code>:tabnew</code> \u547d\u4ee4\u540e\u9762\u4e5f\u53ef\u6307\u5b9a file \u53c2\u6570\uff0c\u65b0\u5f00tab\u6253\u5f00\u6307\u5b9a\u6587\u4ef6\u3002</p> <pre><code>:[count]tabe[dit] [++opt] [+cmd] {file}\n:[count]tabnew [++opt] [+cmd] {file}\n                Open a new tab page and edit {file}, like with :edit.\n                For [count] see :tabnew above.\n\n:[count]tabf[ind] [++opt] [+cmd] {file}                 :tabf :tabfind\n                Open a new tab page and edit {file} in 'path', like with\n                :find.  For [count] see :tabnew above.\n                {not available when the +file_in_path feature was disabled\n                at compile time}\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#tabclose","title":":tabclose","text":"<p><code>:h :tabclose</code> \u67e5\u770b\u5173\u95ed tab \u7684\u547d\u4ee4 <code>tabclose</code>\uff1a</p> <pre><code>                    :tabclose       \" close the current tab page\n\n:{count}tabc[lose][!]\n:tabc[lose][!] {count}\n                Close tab page {count}.  Fails in the same way as :tabclose\n                above.\n                    :-tabclose      \" close the previous tab page\n                    :+tabclose      \" close the next tab page\n                    :1tabclose      \" close the first tab page\n                    :$tabclose      \" close the last tab page\n                    :tabclose -2    \" close the two previous tab page\n                    :tabclose +     \" close the next tab page\n                    :tabclose 3     \" close the third tab page\n                    :tabclose $     \" close the last tab page\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u5207\u6362\u6807\u7b7e","title":"\u5207\u6362\u6807\u7b7e","text":"\u547d\u4ee4 \u8bf4\u660e \u5907\u6ce8 <code>tabfir</code> / <code>:tabr</code> Go to the first tab page. <code>:tabfirst</code> / <code>:tabrewind</code> <code>:tabl</code> Go to the last tab page. <code>:tablast</code> <code>:tabn</code> / <code>:tabnext</code> / <code>gt</code> Go to the next tab page. Wraps around from the last to the first one.you can specify the tab index that want to jump. <code>:tabN</code> / <code>:tabp</code> / <code>:tabprevious</code> / <code>gT</code> Go to the previous tab page. Wraps around from the first one to the last one.you can specify the tab index that want to jump back. <p><code>{count}gt</code>: Go to tab page {count}.</p>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#tabnext","title":":tabnext","text":"<p><code>:h :tabnext</code> \u67e5\u770b\u5207\u6362\u6807\u7b7e\u7684\u547d\u4ee4 <code>tabnext</code>\uff1a</p> <pre><code>:tabn[ext]                              :tabn :tabnext gt\n&lt;C-PageDown&gt;                            CTRL-&lt;PageDown&gt; &lt;C-PageDown&gt;\ngt                                      i_CTRL-&lt;PageDown&gt; i_&lt;C-PageDown&gt;\n                Go to the next tab page.  Wraps around from the last to the\n                first one.\n\n:{count}tabn[ext]\n:tabn[ext] {count}\n                Go to tab page {count}.  The first tab page has number one.\n                    :-tabnext   \" go to the previous tab page\n                    :+tabnext   \" go to the next tab page\n                    :+2tabnext  \" go to the two next tab page\n                    :1tabnext   \" go to the first tab page\n                    :$tabnext   \" go to the last tab page\n                    :tabnext $  \" as above\n                    :tabnext -  \" go to the previous tab page\n                    :tabnext -1 \" as above\n                    :tabnext +  \" go to the next tab page\n                    :tabnext +1 \" as above\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/012-vim-win-tab/#\u79fb\u52a8\u6807\u7b7e","title":"\u79fb\u52a8\u6807\u7b7e","text":"<p><code>tabmove</code> \u547d\u4ee4\u79fb\u52a8 tab \u4f4d\u7f6e\u3002</p> <pre><code>:tabm[ove] [N]                                          :tabm :tabmove\n:[N]tabm[ove]\n                Move the current tab page to after tab page N.  Use zero to\n                make the current tab page the first one.  N is counted before\n                the move, thus if the second tab is the current one,\n                :tabmove 1 and :tabmove 2  have no effect.\n                Without N the tab page is made the last one.\n                    :.tabmove   \" do nothing\n                    :-tabmove   \" move the tab page to the left\n                    :+tabmove   \" move the tab page to the right\n                    :0tabmove   \" move the tab page to the beginning of the tab\n                                \" list\n                    :tabmove 0  \" as above\n                    :tabmove    \" move the tab page to the last\n                    :$tabmove   \" as above\n                    :tabmove $  \" as above\n\n:tabm[ove] +[N]\n:tabm[ove] -[N]\n                Move the current tab page N places to the right (with +) or to\n                the left (with -).\n                    :tabmove -  \" move the tab page to the left\n                    :tabmove -1 \" as above\n                    :tabmove +  \" move the tab page to the right\n                    :tabmove +1 \" as above\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/","title":"vim\u5bfc\u822a","text":"<p>\u9664\u4e86\u67e5\u770b\u548c\u7f16\u8f91\u6587\u4ef6\u5185\u5bb9\u4ee5\u5916\uff0cvim \u8fd8\u5141\u8bb8\u67e5\u770b\u5bfc\u822a\u76ee\u5f55\u7684\u5185\u5bb9\u3002</p> <p>vim \u53d1\u884c\u7248\u4e2d\u81ea\u5e26\u7684 <code>netrw</code> \u63d2\u4ef6\u5141\u8bb8\u6211\u4eec\u5bf9\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u7ba1\u7406\u3002</p> <pre><code>Netrw makes reading files, writing files, browsing over a network, and\nlocal browsing easy!  First, make sure that you have plugins enabled, so\nyou'll need to have at least the following in your &lt;.vimrc&gt;:\n(or see netrw-activate)\n\n        set nocp                    \" 'compatible' is not set\n        filetype plugin on          \" plugins are enabled\n\n(see 'cp' and :filetype-plugin-on)\n</code></pre> <p>\u5728 <code>~/.vimrc</code> \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\uff0c\u786e\u4fdd vim \u5df2\u88ab\u914d\u7f6e\u4e3a\u53ef\u52a0\u8f7d\u63d2\u4ef6\uff1a</p> <pre><code>\"\u53bb\u6389\u6709\u5173vi\u4e00\u81f4\u6027\u6a21\u5f0f\uff0c\u907f\u514d\u4ee5\u524d\u7248\u672c\u7684\u4e00\u4e9bbug\u548c\u5c40\u9650\nset nocp \"nocompatible\n\"\u5141\u8bb8vim\u52a0\u8f7d\u6587\u4ef6\u7c7b\u578b\u63d2\u4ef6($VIMRUNTIME/ftplugin.vim)\nfiletype plugin on\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/#netrw-explore","title":"netrw-explore","text":"<p><code>netrw-explore</code>: Directory Exploring Commands</p> <p>Vim: you don't need NERDtree or (maybe) netrw </p> <p>vim \u5185\u7f6e\u7684 netrw \u7684 <code>:Explore</code> \u53ca <code>:*explore</code> \u7cfb\u5217\u547d\u4ee4\u652f\u6301\u6587\u4ef6\u6d4f\u89c8\u5bfc\u822a\u529f\u80fd\u3002</p> <p>\u8f93\u5165 <code>:h netrw</code> \u6216 <code>:h netrw-explore</code> \u67e5\u770b\u76f8\u5173\u5e2e\u52a9\u3002</p> <pre><code>netrw-explore  netrw-hexplore netrw-nexplore netrw-pexplore\nnetrw-rexplore netrw-sexplore netrw-texplore netrw-vexplore netrw-lexplore\nDIRECTORY EXPLORATION COMMANDS  {{{2\n\n     :[N]Explore[!]  [dir]... Explore directory of current file      :Explore\n     :[N]Hexplore[!] [dir]... Horizontal Split &amp; Explore             :Hexplore\n     :[N]Lexplore[!] [dir]... Left Explorer Toggle                   :Lexplore\n     :[N]Sexplore[!] [dir]... Split&amp;Explore current file's directory :Sexplore\n     :[N]Vexplore[!] [dir]... Vertical   Split &amp; Explore             :Vexplore\n     :Texplore       [dir]... Tab &amp; Explore                          :Texplore\n     :Rexplore            ... Return to/from Explorer                :Rexplore\n\n     Used with :Explore **/pattern : (also see netrw-starstar)\n     :Nexplore............. go to next matching file                :Nexplore\n     :Pexplore............. go to previous matching file            :Pexplore\n</code></pre> <p>\u622a\u6b62\u76ee\u524d\uff0c\u6211\u4eec\u67093\u79cd\u5e38\u89c1\u7684\u591a\u6587\u4ef6\u5de5\u4f5c\u6d41\uff1a</p> <ol> <li>\u590d\u7528\u540c\u4e00\u7a97\u53e3</li> </ol> <pre><code>                                                        :edit_f\n:e[dit] [++opt] [+cmd] {file}\n</code></pre> <ol> <li>\u5206\u5c4f\u7a97\u53e3</li> </ol> <pre><code>:[N]new [++opt] [+cmd] {file}\n[N]vne[w] [++opt] [+cmd] [file]                        :vne :vnew\n\n:[N]sp[lit] [++opt] [+cmd] {file}                       :split_f\n:[N]sp[lit] [++opt] [+cmd] [file]                       :sp :split\n</code></pre> <ol> <li>\u6807\u7b7e\u9875</li> </ol> <pre><code>:[count]tabe[dit] [++opt] [+cmd] {file}\n:[count]tabnew [++opt] [+cmd] {file}\n</code></pre> <p>\u5982\u679c\u60f3\u5bfc\u822a\u6d4f\u89c8\u5de5\u4f5c\u76ee\u5f55\u9009\u62e9\u6253\u5f00\u66f4\u591a\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u53ef\u4ee5\u7ed3\u5408 vim \u5185\u7f6e\u7684\u5bfc\u822a\u63d2\u4ef6\u3002</p>","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/#explore","title":"Ex(plore)","text":"<p><code>:Explore</code>\uff08\u7b80\u5199\u4e3a <code>:Ex</code>/<code>:E</code>\uff09\uff0c\u5728\u5f53\u524d\u7a97\u683c\u6253\u5f00\u5f53\u524d\u6587\u6863\u6240\u5728\u7684\u76ee\u5f55\uff0c\u53ef\u6267\u884c <code>:Rexplore</code>\uff08\u7b80\u5199\u4e3a <code>:Rex</code>/<code>Re</code>\uff09\u968f\u65f6\u8fd4\u56de\u7f16\u8f91\u6587\u6863\uff1b \u6216\u6d4f\u89c8\u9009\u62e9\u6253\u5f00\u65b0\u7684\u6587\u4ef6\uff08\u590d\u7528\u5f53\u524d\u7a97\u53e3\uff09\uff0c\u7136\u540e\u901a\u8fc7 <code>:bn</code>/<code>:bN</code> \u5207\u6362buffer\u3002</p> <pre><code>                                                netrw-:Explore\n:Explore  will open the local-directory browser on the current file's\n          directory (or on directory [dir] if specified).  The window will be\n          split only if the file has been modified and 'hidden' is not set,\n          otherwise the browsing window will take over that window.  Normally\n          the splitting is taken horizontally.\n          Also see: netrw-:Rexplore\n:Explore! is like :Explore, but will use vertical splitting.\n\n                                                netrw-:Rexplore\n:Rexplore  This command is a little different from the other Explore commands\n           as it doesn't necessarily open an Explorer window.\n</code></pre> <p>\u6309\u4e0b <code>-</code> \u53ef\u8fd4\u56de\u4e0a\u4e00\u7ea7\u76ee\u5f55\uff08\u4e5f\u53ef\u79fb\u52a8\u5230 <code>..</code> \u518d\u6309\u4e0b <code>&lt;CR&gt;</code>\uff09\u3002</p> <p><code>netrw--</code> : Going Up</p> <p>\u5728\u5bfc\u822a\u7a97\u683c\u4e2d\uff0c\u6309\u4e0b <code>qf</code> \u53ef\u67e5\u770b\u5149\u6807\u6240\u5728\u672c\u5730\u6587\u4ef6\u7684\u5c5e\u6027\u4fe1\u606f\uff1a</p> <p><code>netrw-qf</code> : Displaying Information About File</p>","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/#lexplore","title":"Lex(plore)","text":"<p><code>:Lexplore</code>\uff08\u7b80\u5199\u4e3a <code>:Lex</code>/<code>:Le</code>\uff09 \u4e0e <code>:Explore</code>\uff08\u7b80\u5199\u4e3a <code>:Ex</code>\uff09 \u7684\u552f\u4e00\u533a\u522b\u662f\uff0c\u5728\u5de6\u4fa7\u6253\u5f00\u5f53\u524d\u6587\u6863\u6240\u5728\u7684\u76ee\u5f55\u3002 \u70b9\u51fb\u76ee\u5f55\u4e2d\u7684\u7684\u8282\u70b9\uff0c\u6253\u5f00\u6d4f\u89c8\u6587\u6863\u65f6\uff0c\u590d\u7528\u8986\u76d6\u53f3\u4fa7\u7a97\u53e3\uff0c\u4f46\u662f\u4fdd\u7559\u5de6\u4fa7\u5bfc\u822a\u7a97\u683c\u3002</p> <pre><code>                                                netrw-:Lexplore\n:[N]Lexplore [dir] toggles a full height Explorer window on the left hand side\n          of the current tab.  It will open a netrw window on the current\n          directory if [dir] is omitted; a :Lexplore [dir] will show the\n          specified directory in the left-hand side browser display no matter\n          from which window the command is issued.\n\n          By default, :Lexplore will change an uninitialized g:netrw_chgwin\n          to 2; edits will thus preferentially be made in window#2.\n\n          The [N] specifies a g:netrw_winsize just for the new :Lexplore\n          window.\n\n          Those who like this method often also like tree style displays;\n          see g:netrw_liststyle.\n\n:[N]Lexplore! [dir] is similar to :Lexplore, except that the full-height\n          Explorer window will open on the right hand side and an\n          uninitialized g:netrw_chgwin will be set to 1 (eg. edits will\n          preferentially occur in the leftmost window).\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/#op","title":"op","text":"<p>\u5f53\u5149\u6807\u505c\u7559\u5728\u5bfc\u822a\u7a97\u683c\u65f6\uff0c\u8fd8\u53ef\u4ee5\u6309\u4e0b <code>d</code>/<code>R</code>/<code>D</code> \u5feb\u6377\u5b9e\u73b0\u521b\u5efa\u6587\u4ef6\u5939\u3001\u91cd\u547d\u540d/\u5220\u9664\u6587\u4ef6\uff08\u5939\uff09\u7b49\u64cd\u4f5c\u3002</p> cmd desc netrw-<code>d</code> Making A New Directory netrw-<code>R</code> Renaming Files Or Directories netrw-<code>D</code> Deleting Files Or Directories","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/#sexplore","title":"Sex(plore)","text":"<p>\u53ef\u4ee5\u57fa\u4e8e <code>:Sexplore</code>/<code>:Hexplore</code>/<code>:Vexplore</code>\uff08<code>:Sex</code>/<code>:Hex</code>/<code>:Vex</code>\uff09\u6253\u5f00\u72ec\u7acb\u7684\u5bfc\u822a\u7a97\u53e3\uff0c\u5b9e\u73b0split\u5206\u5c4f\u6d4f\u89c8\u6253\u5f00\u65b0\u6587\u4ef6\u3002</p> <pre><code>                                                netrw-:Sexplore\n:[N]Sexplore will always split the window before invoking the local-directory\n          browser.  As with Explore, the splitting is normally done\n          horizontally.\n:[N]Sexplore! [dir] is like :Sexplore, but the splitting will be done vertically.\n\n                                                netrw-:Hexplore\n:Hexplore  [dir] does an :Explore with :belowright horizontal splitting.\n:Hexplore! [dir] does an :Explore with :aboveleft  horizontal splitting.\n\n                                                netrw-:Vexplore\n:[N]Vexplore  [dir] does an :Explore with :leftabove  vertical splitting.\n:[N]Vexplore! [dir] does an :Explore with :rightbelow vertical splitting.\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/#texplore","title":"Tex(plore)","text":"<p>\u53ef\u4ee5\u57fa\u4e8e <code>:Te</code> \u6253\u5f00\u72ec\u7acb\u7684\u5bfc\u822a\u6807\u7b7e\u9875\uff0c\u5b9e\u73b0tab\u5206\u9875\u6d4f\u89c8\u6253\u5f00\u65b0\u6587\u4ef6\u3002</p> <pre><code>                                                netrw-:Texplore\n:Texplore  [dir] does a :tabnew before generating the browser window\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/#browsing-item","title":"browsing-item","text":"<p>\u5728 <code>Ex</code> \u6216 <code>Ve</code> \u5bfc\u822a\u7a97\u683c\u4e2d\u6309\u4e0b <code>&lt;CR&gt;</code> \u65f6\uff0c\u4f1a\u590d\u7528\u5f53\u524d\u7a97\u53e3\u6253\u5f00\u5149\u6807\u6240\u5728\u7684\u6587\u4ef6 item\uff08\u76ee\u5f55\u5bfc\u822a\u5c06\u88ab\u8986\u76d6\uff09\u3002</p> <p>\u5982\u679c\u60f3\u5bfc\u822a\u7a97\u683c\u5e38\u9a7b\uff0c\u53ef\u901a\u8fc7 <code>:Le</code> \u6253\u5f00\u7a97\u683c\u5e38\u9a7b\u5de6\u4fa7\uff1b\u6216\u5728 <code>Ex</code>/<code>Ve</code> \u5bfc\u822a\u7a97\u683c\u4e2d\u6309 <code>o</code>/<code>v</code>/<code>t</code>\uff0c\u65b0\u5f00\u5206\u5c4f\u6216\u6807\u7b7e\u9875\u6253\u5f00\u6587\u4ef6\u3002</p> cmd desc netrw-<code>o</code> Browsing With A Horizontally Split Window netrw-<code>v</code> Browsing With A Vertically Split Window netrw-<code>t</code> Browsing With A New Tab <p>\u53ef\u4fee\u6539\u6253\u5f00\u65b9\u5f0f\u7684\u914d\u7f6e\u9879\u4e3a 1/2/3\uff0c\u9ed8\u8ba4\u4ee5 <code>o</code>/<code>v</code>/<code>t</code> \u6253\u5f00\u6d4f\u89c8\u3002</p> <pre><code>  g:netrw_browse_split          when browsing, &lt;cr&gt; will open the file by:\n                                =0: re-using the same window  (default)\n                                =1: horizontally splitting the window first\n                                =2: vertically   splitting the window first\n                                =3: open file in new tab\n                                =4: act like \"P\" (ie. open previous window)\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/#settings","title":"settings","text":"<p><code>:NetrwSettings</code>: \u6253\u5f00 Netrw Settings Window \u914d\u7f6e\u7a97\u53e3\uff0c\u53ef\u67e5\u770b\u5f53\u524d\u914d\u7f6e\u503c\uff0c\u4e5f\u53ef\u4fee\u6539\u3002</p> <pre><code>With the NetrwSettings.vim plugin,\n        :NetrwSettings\nwill bring up a window with the many variables that netrw uses for its\nsettings.  You may change any of their values; when you save the file, the\nsettings therein will be used.  One may also press \"?\" on any of the lines for\nhelp on what each of the variables do.\n\n(also see: netrw-browser-var netrw-protocol netrw-variables)\n</code></pre> <p>NETRW BROWSER VARIABLES \u76f8\u5173\u8bae\u9898\uff1a<code>netrw-browser-settings</code>(netrw-browser-options, netrw-browser-var)</p> <p>\u4ee5\u4e0b\u4e3a netrw \u90e8\u5206\u5b9a\u5236\u914d\u7f6e\uff1a</p> <pre><code>\"==============================================================================\n\" // netrw-browser-settings\n\"==============================================================================\n\n\"change from above splitting to below splitting\nlet g:netrw_alto              = 1\n\"change from left splitting to right splitting\nlet g:netrw_altv              = 1\n\n\"vertically splitting when browsing\nlet g:netrw_browse_split      = 2\n\n\"tree style listing\nlet g:netrw_liststyle         = 3\n\n\"specify initial size of new windows made with o/v\nlet g:netrw_winsize           = 25 \"percentage\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/013-vim-navigation/#voom","title":"VOoM","text":"<p>github mirror\uff1avoom.vim </p> <p>\u4f7f\u7528 pathogen \u5b89\u88c5 Voom \u63d2\u4ef6\u540e\uff0c\u4f7f\u7528 vim \u6253\u5f00 <code>*.md</code> \u6587\u6863\uff0c\u7136\u540e\u8f93\u5165 <code>:Voom markdown</code> \u5373\u53ef\u5de6\u4fa7\u65b0\u5efa\u5206\u5c4f\u7a97\u53e3\u5c55\u793a markdown \u6587\u6863\u5927\u7eb2\uff08TOC\uff09\u3002\u8f93\u5165 <code>:q</code> \u5373\u53ef\u5173\u95ed TOC \u5bfc\u822a\u7a97\u683c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/014-vim-pattern/","title":"vim\u5339\u914d","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 vim \u641c\u7d22\u5339\u914d\u6a21\u5f0f\uff0c\u76f8\u5173\u8bae\u9898 <code>:h pattern</code>\u3002</p>","tags":["vim"]},{"location":"blog/20171018/014-vim-pattern/#\u5982\u4f55\u53bb\u6389\u5f53\u6b21\u641c\u7d22\u9ad8\u4eae","title":"\u5982\u4f55\u53bb\u6389\u5f53\u6b21\u641c\u7d22\u9ad8\u4eae\uff1f","text":"<p>highlight - Vim clear last search highlighting - Stack Overflow</p> <p>After doing a search in Vim, I get all the occurrences highlighted. How can I disable that? I now do another search for something gibberish that can't be found. Is there a way to just temporarily disable the highlight and then re-enable it when needed again?</p> <ol> <li>To turn off highlighting until the next search: <code>:noh</code>/<code>:nohl</code>/<code>:nohls</code>/<code>:nohlsearch</code>.</li> <li>Or turn off highlighting completely: <code>:set nohlsearch</code>; type <code>:set hlsearch</code> to turn on again.</li> <li>From the VIM Documentation\uff0cto clear the last used search pattern: <code>:let @/ = \"\"</code></li> </ol> <p>Clear Search Highlight in Vim \u2014 tech.serhatteker.com</p> <p>I personally use \u2019temporarily disable\u2019 with key mapping. I mapped :noh to  key. Since hitting  is a very common and intuitive situtation in Vim. <pre><code>\" noh - no highlight\nmap &lt;esc&gt; :noh &lt;CR&gt;\n</code></pre> <p>Clear search highlight - VimTricks</p>","tags":["vim"]},{"location":"blog/20171018/014-vim-pattern/#incsearch","title":"incsearch","text":"<p><code>incsearch.vim</code> incrementally highlights ALL pattern matches unlike default 'incsearch'.</p>","tags":["vim"]},{"location":"blog/20171018/014-vim-pattern/#search_across_multiple_lines","title":"Search across multiple lines","text":"<p>How to substitute text across line breaks? How to do a multiline search in vim How to search and delete literal text spanning multiple lines? </p> <p>Multiline Search and Replace Multi-line regex support in Vim </p> <p>The search <code>/^abcd</code> finds <code>abcd</code> at the beginning of a line, and <code>/abcd$</code> finds abcd at the end of a line. However, in <code>/abcd^efgh</code> and <code>/abcd$efgh</code> the <code>^</code> and <code>$</code> are just ordinary characters with no special meaning. By contrast, each of the following has a special meaning anywhere in a search pattern.</p> meta pattern <code>\\n</code> a newline character (line ending) <code>\\_s</code> a whitespace (space or tab) or newline character <code>\\_^</code> the beginning of a line (zero width) <code>\\_$</code> the end of a line (zero width) <code>\\_.</code> any character including a newline","tags":["vim"]},{"location":"blog/20171018/014-vim-pattern/#\u975e\u8d2a\u5a6a\u6a21\u5f0f","title":"\u975e\u8d2a\u5a6a\u6a21\u5f0f","text":"<p>\u76f8\u5173\u8bae\u9898\uff1a<code>:h non-greedy</code></p> <p>vim\u4e0b\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u975e\u8d2a\u5a6a\u5339\u914d VIM\u4e2d\u6b63\u5219\u7684\u975e\u8d2a\u5a6a\u5339\u914d </p> <p>\u6267\u884c <code>git merge origin/master</code> \u540e\uff0c\u60f3\u5220\u9664\u672c\u5730 ours HEAD \u90e8\u5206\uff0c\u91c7\u7528 theirs MERGE_HEAD\uff1a</p> <p>\u9996\u5148\u67e5\u627e\u6240\u6709 conflict \u7684 ours \u90e8\u5206\uff1a</p> <pre><code>/^&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\\_$\\_.\\{-}\\_^=======\\_$\n</code></pre> <p>\u66ff\u6362\u4e3a\u7a7a\u884c\uff1a</p> <pre><code>:%s/^&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\\_$\\_.\\{-}\\_^=======\\_$//gc\n</code></pre> <p>\u4f46\u8fd9\u5e76\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\uff0c\u7a7a\u884c\u8fd8\u662f\u975e\u9884\u671f\u5360\u4f4d\u4e00\u884c\u3002</p>","tags":["vim"]},{"location":"blog/20171018/014-vim-pattern/#delete_all_lines_containing_a_pattern","title":"Delete all lines containing a pattern","text":"<p>How to delete a multi-line match? Efficient way to delete line containing certain text in vim with prompt </p> <p><code>:g</code> \u53ef\u4ee5\u5220\u9664 theirs \u90e8\u5206\u7684\u5355\u884c\u7ed3\u5c3e\u6807\u8bb0\uff1a</p> <pre><code>:g/^&gt;&gt;&gt;&gt;&gt;&gt;&gt; origin\\/master$/d\n</code></pre> <p>\u4f46\u662f\u5bf9\u4e8e\u8de8\u884c\u5339\u914d\u7684\u7ed3\u679c\uff0c<code>:g</code> \u53ea\u5220\u9664\u4e86\u7b2c1\u884c\uff1f</p> <pre><code>:g/^&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\\_$\\_.\\{-}\\_^=======\\_$/d\n</code></pre> <p>global \u547d\u4ee4\u5148\u626b\u63cf <code>[range]</code> \u754c\u5b9a\u7684\u884c\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u5339\u914d\u7684\u884c\u8fdb\u884c\u6807\u8bb0 (\u5bf9\u4e8e\u4e00\u4e2a\u8de8\u884c\u7684\u5339\u914d\uff0c\u5219\u53ea\u9488\u5bf9\u5f00\u59cb\u7684\u4e00\u884c)\u3002</p> <p>\u53e6\u4e00\u79cd\u65b9\u6cd5\uff1a\u57fa\u4e8e <code>gn</code> \u9009\u4e2d search pattern \u547d\u4e2d\u9ad8\u4eae\u90e8\u5206\uff08select text highlighted by search\uff09\uff0c\u518d\u6267\u884c\u5220\u9664\u3002</p> <p>\u5148\u6267\u884c\u67e5\u627e\uff1a</p> <pre><code>/^&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD\\_$\\_.\\{-}\\_^=======\\_$\n</code></pre> <p>\u518d\u6267\u884c <code>gn$d</code>\uff0c\u7136\u540e\u91cd\u590d <code>gn$d</code>\u3002</p> <p><code>gn</code> \u540e\u5982\u679c\u4e0d\u6dfb\u52a0 <code>$</code>\uff0c\u6267\u884c\u5220\u9664\u540e\u6362\u884c\u5206\u9694\u7b26\u5c06\u5360\u4f4d\u4e00\u884c\u3002</p> <p>\u53c2\u8003 VIM\u63d0\u53d6/\u5220\u9664\u5339\u914d\u884c\u7684\u65b9\u6cd5\uff0c\u5b9e\u73b0 KeepLines(pattern) \u51fd\u6570\u3002</p> <p>\u5bf9\u4e8e\u5927\u578b\u7684\u6587\u672c\u5904\u7406\uff0c\u5efa\u8bae\u4f7f\u7528 sed/awk \u547d\u4ee4\u3002</p> <p>\u5176\u4ed6\u65b9\u6848</p> <ol> <li>vscode \u6b63\u5219\u641c\u7d22  </li> <li>sed/awk  </li> </ol>","tags":["vim"]},{"location":"blog/20171018/015-vim-pbcopy/","title":"vim\u62f7\u8d1d","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 macOS \u4e0b vim \u590d\u5236\u5185\u5bb9\u5230\u7cfb\u7edf\u526a\u5207\u677f\u3002</p>","tags":["vim"]},{"location":"blog/20171018/015-vim-pbcopy/#vim-pbcopy","title":"vim-pbcopy","text":"<p>How to copy to clipboard in Vim? Vim copy to system clipboard on a Mac </p> <p>macOS \u4e0b\u7684 pbcopy \u548c pbpaste \u547d\u4ee4\u63d0\u4f9b\u4e86\u5bf9\u526a\u8d34\u677f\u7684\u590d\u5236\u7c98\u8d34\u652f\u6301\u3002</p> <pre><code>pbcopy, pbpaste - provide copying and pasting to the pasteboard (the Clipboard) from command line\n</code></pre> <p>On macOS, copy lines to system clipboard:</p> <ol> <li>copy line m: <code>:&lt;m&gt; w !pbcopy</code> </li> <li>copy line m to n: <code>:&lt;m&gt;,&lt;n&gt; w !pbcopy</code> </li> <li>copy the whole file <code>:%w !pbcopy</code> </li> <li>paste from the clipboard <code>:r !pbpaste</code> </li> </ol> <p>copy selected part: visually select text(type <code>v</code> or <code>V</code> in normal mode) and type <code>:w !pbcopy</code></p> <ol> <li>Visually select the text and type: <code>ggVG</code>\uff1b  </li> <li>\u8f93\u5165 <code>:</code>\uff0c\u5e95\u884c\u5c06\u63d0\u793a <code>:'&lt;,'&gt;</code>\uff08range \u4e3a\u9009\u4e2d\u533a\u6bb5\uff09\uff1b  </li> <li>\u5176\u540e\u8f93\u5165 <code>!tee &gt;(pbcopy)</code>\uff08 or <code>w !pbcopy</code>\uff09\u5373\u53ef\u62f7\u8d1d\u5230\u7cfb\u7edf\u526a\u8d34\u677f\u3002  </li> </ol> <p>On most Linux Distros, you can substitute:</p> <ol> <li>pbcopy above with <code>xclip -i -sel c</code> or <code>xsel -i -b</code> </li> <li>pbpaste using <code>xclip -o -sel -c</code> or <code>xsel -o -b</code> </li> <li>visual select and copy  </li> </ol>","tags":["vim"]},{"location":"blog/20171018/015-vim-pbcopy/#remap","title":"remap","text":"<pre><code>map &lt;C-x&gt; :!pbcopy&lt;CR&gt;\nvmap &lt;C-c&gt; :w !pbcopy&lt;CR&gt;&lt;CR&gt;\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/","title":"vim\u526a\u5207","text":"<p>\u672c\u6587\u7b80\u5355\u68b3\u7406\u4e86 vim \u5982\u4f55\u5f00\u542f <code>+clipboard</code> \u53ca\u901a\u8fc7\u5bc4\u5b58\u5668\u4e0e\u7cfb\u7edf\u526a\u8d34\u677f\u8fdb\u884c\u4ea4\u4e92\u3002</p> <p>os x \u4e0b vim \u65e0\u6cd5\u590d\u5236\u5230\u7cfb\u7edf\u526a\u8d34\u677f\u7684\u95ee\u9898 \u5982\u4f55\u5c06 Vim \u526a\u8d34\u677f\u91cc\u9762\u7684\u4e1c\u897f\u7c98\u8d34\u5230 Vim \u4e4b\u5916\u7684\u5730\u65b9\uff1f </p>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/#reg","title":"reg","text":"<p>vim \u8f93\u5165 <code>:h reg</code> \u67e5\u770b\u5bc4\u5b58\u5668\u76f8\u5173\u5185\u5bb9\uff1a</p> <pre><code>5. Copying and moving text                              copy-move\n\n                                                        quote\n\"{a-zA-Z0-9.%#:-\"}      Use register {a-zA-Z0-9.%#:-\"} for next delete, yank\n                        or put (use uppercase character to append with\n                        delete and yank) ({.%#:} only work with put).\n\n                                                        :reg :registers\n:reg[isters]            Display the type and contents of all numbered and\n                        named registers.  If a register is written to for\n                        :redir it will not be listed.\n                        Type can be one of:\n                        \"c\"     for characterwise text\n                        \"l\"     for linewise text\n                        \"b\"     for blockwise-visual text\n\n\n:reg[isters] {arg}      Display the contents of the numbered and named\n                        registers that are mentioned in {arg}.  For example:\n                                :reg 1a\n                        to display registers '1' and 'a'.  Spaces are allowed\n                        in {arg}.\n\n                                                        y yank\n[\"x]y{motion}           Yank {motion} text [into register x].  When no\n                        characters are to be yanked (e.g., \"y0\" in column 1),\n                        this is an error when 'cpoptions' includes the 'E'\n                        flag.\n\n                                                        yy\n[\"x]yy                  Yank [count] lines [into register x] linewise.\n\n                                                        p put E353\n[\"x]p                   Put the text [from register x] after the cursor\n                        [count] times.\n</code></pre> <p>Special registers:</p> <pre><code>'\"'     the unnamed register, containing the text of the last delete or yank\n'%'     the current file name\n'#'     the alternate file name\n'*'     the clipboard contents (X11: primary selection)\n'+'     the clipboard contents\n'/'     the last search pattern\n':'     the last command-line\n'-'     the last small (less than a line) delete\n'.'     the last inserted text\n</code></pre> <p>\u5e95\u884c\u6a21\u5f0f\u8f93\u5165 <code>:reg</code> \u53ef\u5217\u4e3e\u67e5\u770b\u5bc4\u5b58\u5668\uff0c\u8f93\u5165 <code>:reg %</code> \u67e5\u770b\u5f53\u524d\u6587\u4ef6\u540d\uff0c\u8f93\u5165 <code>:reg +</code>\uff08\u6216 <code>:reg *</code>\uff09\u67e5\u770b\u526a\u8d34\u677f\u5bc4\u5b58\u5668\u3002</p> <p><code>%</code> \u53ef\u4f5c\u4e3a\u5f88\u591a\u547d\u4ee4\u7684 range\uff0c\u4f8b\u5982 <code>:%d</code> \u5220\u9664\u6240\u6709\u884c\uff0c<code>:%s/foo/bar/gc</code> \u67e5\u627e\u66ff\u6362\u5168\u6587\u3002</p> <p>\u5bc4\u5b58\u5668\u662f\u5b8c\u6210\u8fd9\u4e00\u8fc7\u7a0b\u7684 \u4e2d\u8f6c\u7ad9\u3002Vim \u652f\u6301\u7684\u5bc4\u5b58\u5668\u975e\u5e38\u591a\uff0c\u5176\u4e2d\u5e38\u7528\u7684\u6709 <code>a-zA-Z0-9+\"</code>\u3002</p> <ul> <li><code>0-9</code>\uff1a\u8868\u793a\u6570\u5b57\u5bc4\u5b58\u5668\uff0c\u662f Vim \u7528\u6765\u4fdd\u5b58\u6700\u8fd1\u590d\u5236\u3001\u5220\u9664\u7b49\u64cd\u4f5c\u7684\u5185\u5bb9\uff0c\u5176\u4e2d 0 \u53f7\u5bc4\u5b58\u5668\u4fdd\u5b58\u7684\u662f\u6700\u8fd1\u4e00\u6b21\u7684\u64cd\u4f5c\u5185\u5bb9\u3002  </li> <li><code>a-zA-Z</code>\uff1a\u8868\u793a\u7528\u6237\u5bc4\u5b58\u5668\uff0cVim \u4e0d\u4f1a\u8bfb\u5199\u8fd9\u90e8\u5206\u5bc4\u5b58\u5668\uff1b  </li> <li><code>\"</code>\uff08\u5355\u4e2a\u53cc\u5f15\u53f7\uff09\uff1a\u672a\u547d\u540d\u7684\u5bc4\u5b58\u5668\uff0c\u662f Vim \u7684\u9ed8\u8ba4\u5bc4\u5b58\u5668\uff0c\u4f8b\u5982\u5220\u9664\u3001\u590d\u5236\u7b49\u64cd\u4f5c\u7684\u5185\u5bb9\u90fd\u4f1a\u88ab\u4fdd\u5b58\u5230\u8fd9\u91cc\u3002  </li> <li><code>+</code>\uff1a\u526a\u8d34\u677f\u5bc4\u5b58\u5668\uff0c\u5173\u8054\u7cfb\u7edf\u526a\u8d34\u677f\uff0c\u4fdd\u5b58\u5728\u8fd9\u4e2a\u5bc4\u5b58\u5668\u4e2d\u7684\u5185\u5bb9\u53ef\u4ee5\u88ab\u7cfb\u7edf\u5176\u4ed6\u7a0b\u5e8f\u8bbf\u95ee\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5bc4\u5b58\u5668\u8bbf\u95ee\u5176\u4ed6\u7a0b\u5e8f\u4fdd\u5b58\u5230\u526a\u8d34\u677f\u4e2d\u7684\u5185\u5bb9\u3002  </li> </ul> <p>vim \u5bc4\u5b58\u5668\u7684\u6570\u636e\u4f5c\u7528\u57df\u4ec5\u9650\u4e8evim\u672c\u5730\uff0c\u751a\u81f3\u5982\u679c\u5f00\u591a\u4e2avim\u7a97\u53e3\uff0c\u6bcf\u4e2a\u7a97\u53e3\u90fd\u6709\u4e00\u5957\u81ea\u5df1\u5b8c\u6574\u7684\u5bc4\u5b58\u5668\uff0c\u4e92\u76f8\u4e0d\u5f71\u54cd\u3002</p>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/#__0","title":"\"\" &amp; \"0","text":"<p>Vim \u4e2d\u6267\u884c\u5220\u9664\uff08d,x,c\uff09\u7684\u5185\u5bb9\u90fd\u4f1a\u88ab\u5b58\u653e\u5230\u9ed8\u8ba4\u7684\u672a\u547d\u540d\u5bc4\u5b58\u5668\uff08unnamed register,<code>\"\"</code>\uff09\u4e2d\uff0c\u4e4b\u540e\u53ef\u4ee5\u8bfb\u53d6\u9ed8\u8ba4\u5bc4\u5b58\u5668\u4e2d\u7684\u5185\u5bb9\u8fdb\u884c\u7c98\u8d34\u64cd\u4f5c\u3002 Vim \u4e2d\u6267\u884c\u590d\u5236\uff08y[ank]\uff09\u547d\u4ee4\u65f6\uff0c\u8981\u590d\u5236\u7684\u6587\u672c\u4e0d\u4ec5\u4f1a\u88ab\u62f7\u8d1d\u5230\u65e0\u540d\u5bc4\u5b58\u5668\u4e2d\uff08<code>\"\"</code>\uff09\uff0c\u8fd8\u4f1a\u62f7\u8d1d\u5230\u590d\u5236 \u4e13\u7528\u5bc4\u5b58\u5668\uff08<code>\"0</code>\uff09\u4e2d\u3002 \u8fd9\u6837\uff0c\u5f53\u6211\u4eec\u5728\u6267\u884c\u590d\u5236\u64cd\u4f5c\u540e\uff0c\u5982\u679c\u6267\u884c\u4e86\u5220\u9664\u64cd\u4f5c\uff0c\u8fd8\u53ef\u4ee5\u6267\u884c <code>\"0p</code> \u4ece\u590d\u5236\u4e13\u7528\u5bc4\u5b58\u5668\u4e2d\u627e\u56de\u4e0a\u6b21\u590d\u5236\u7684\u5185\u5bb9\u8fdb\u884c\u7c98\u8d34\u3002</p>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/#general","title":"general","text":"<p>Using vi buffers to copy lines</p> <p>The vi editor allows you to copy text from your file into <code>temporary buffers</code> for use in other places in the file during your current vi work session. Each buffer acts like temporary memory, or, as some programs call it, a \"clipboard\" where you can temporarily store information.</p> <ul> <li><code>u</code>: undo;  </li> <li><code>yy</code>: yank;  </li> </ul> <p><code>\"ayy</code>  Copy the current line into a buffer named <code>a</code>. <code>\"b7yy</code> Copy 7 lines into a buffer named <code>b</code>. <code>\"bp</code>   Put the information in the buffer named <code>b</code> after the current cursor position. <code>\"bP</code>   Put the information in the buffer named <code>b</code> before the current cursor position.  </p> <p>\u666e\u901a\u6a21\u5f0f\u4e0b\uff0c\u8f93\u5165 <code>\"%p</code> \u5728\u5f53\u524d\u5149\u6807\u540e\u63d2\u5165\u5f53\u524d\u6587\u4ef6\u540d\u3002</p>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/#uppercase","title":"uppercase","text":"<p>\u5047\u8bbe\u6211\u4eec\u60f3\u641c\u7d22\u6587\u6863\u5185\u6240\u6709\u7684 <code>TODO</code> \u5e76\u5c06\u5176\u6536\u96c6\u5230\u4e00\u8d77\uff0c\u53ef\u53c2\u8003\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li>\u6267\u884c <code>qaq</code> \u5f55\u5236\u7a7a\u5b8f\uff0c\u6e05\u9664\u5bc4\u5b58\u5668 <code>\"a</code>\uff1b  </li> <li>\u6267\u884c <code>:g/TODO/yank A</code>\uff0c\u5c06\u5339\u914d\u7684\u5185\u5bb9\u8ffd\u52a0\uff08\u800c\u975e\u8986\u76d6\uff09\u5230\u6307\u5b9a\u5bc4\u5b58\u5668\u3002  </li> </ol> <p>use uppercase character to append with delete and yank</p>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/#c-r","title":"C-r","text":"<p>\u5728\u63d2\u5165\uff08\u7f16\u8f91\uff09\u6a21\u5f0f\u4e0b\uff0c\u6309\u4e0b <code>&lt;C-r&gt;</code>\uff0c\u5f53\u524d\u5149\u6807\u5904\u5c06\u4f1a\u663e\u793a <code>\"</code> \u63d0\u793a\u8f93\u5165\u5bc4\u5b58\u5668\u3002 \u7d27\u63a5\u7740\u8f93\u5165\u5bc4\u5b58\u5668\u7f16\u53f7\u5373\u53ef\u7c98\u8d34\u5bc4\u5b58\u5668\u5185\u5bb9\uff0c\u4f8b\u5982\u8f93\u5165 <code>%</code> \u63d2\u5165\u5f53\u524d\u6587\u4ef6\u540d\u3002</p> <pre><code>:h &lt;C-r&gt;\n\nCTRL-R {register}                                       c_CTRL-R c_&lt;C-R&gt;\n                Insert the contents of a numbered or named register.  Between\n                typing CTRL-R and the second character '\"' will be displayed\n                to indicate that you are expected to enter the name of a\n                register.\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/#clipboardunnamed","title":"clipboard=unnamed","text":"<p>\u6267\u884c <code>:set clipboard ?</code> \u67e5\u770b clipboard \u7684\u503c\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u3002</p> <p>\u5728 <code>vim ~/.vimrc</code> \u6dfb\u52a0 <code>set clipboard=unnamed</code> \u4e4b\u540e\uff0cy\uff0cd\uff0cx\uff0cp \u548c ctrl-c/ctrl-v \u4e00\u6837\uff0c\u76f4\u63a5\u628a\u5185\u5bb9\u590d\u5236\u5230\u7cfb\u7edf\u526a\u8d34\u677f\u3002</p> <p>\u4e0d\u5efa\u8bae\u8fd9\u4e48\u914d\u7f6e\uff0c\u56e0\u4e3a vim \u6ca1\u6709\u81ea\u5df1\u7684 reg buffer \u4e86\uff0c\u4f1a\u5e26\u6765\u8bf8\u591a\u4e0d\u4fbf\u3002 \u5efa\u8bae\u5f00\u542f <code>+clipboard</code> \u5bc4\u5b58\u5668\u4e0e\u7cfb\u7edf\u526a\u8d34\u677f\u8fdb\u884c\u4ea4\u4e92\u3002</p> <p>I just found that if you add following line into your <code>~/.vimrc</code> file,</p> <pre><code>set clipboard=unnamed\n</code></pre> <p>then VIM is using system clipboard</p> <p>In your <code>~/.vimrc</code> file you can specify to automatically use the system clipboard for copy and paste.</p> <p>On Windows set:</p> <pre><code>set clipboard=unnamed\n</code></pre> <p>On Linux set (vim 7.3.74+):</p> <pre><code>set clipboard=unnamedplus\n</code></pre> <p>On macOS:</p> <p><code>brew install vim</code>, and then append the following line to <code>~/.vimrc</code></p> <pre><code>set clipboard=unnamed\n</code></pre> <p>now you can copy the line in vim with <code>yy</code> and paste it system-wide</p>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/#clipboard","title":"+clipboard","text":"<p>\u6253\u5f00 vim \u7684 clipboard \u5c5e\u6027\u540e\uff0cvim \u624d\u4f1a\u591a\u51fa <code>\"+</code> \u5bc4\u5b58\u5668\uff0c\u6620\u5c04\u4e3a\u7cfb\u7edf\u526a\u8d34\u677f\u3002</p> <p>Vim: copy selection to OS X clipboard </p> <p>The vim that ships with OSX doesn't have <code>+clipboard</code> or <code>+xterm-clipboard</code>. You can verify this with <code>vim --version | grep clipboard</code>. It's possible to resolve this with <code>brew install vim --with-client-server</code></p> <pre><code>faner$ which vim\n/usr/bin/vim\n\nfaner$ vim --version | head -n 4\nVIM - Vi IMproved 8.1 (2018 May 18, compiled Nov 13 2019 20:55:32)\nIncluded patches: 1-503, 505-680, 682-1312\nCompiled by root@apple.com\nNormal version without GUI.  Features included (+) or not (-):\n\nfaner$ vim --version | grep clipboard\n-clipboard         +jumplist          +persistent_undo   -vartabs\n+eval              -mouse_gpm         +syntax            -xterm_clipboard\n</code></pre> <ol> <li> <p>double-quote asterisk (<code>\"*</code>) before any yank command will yank the results into the copy buffer. That works for Windows and Linux too.</p> </li> <li> <p>On macos 10.8, vim is compiled with <code>-clipboard</code> so to use <code>\"*y</code> you'll need to recompile. Luckily <code>brew install vim</code> would compile a new version easily for you and it will be <code>+clipboard</code>.</p> </li> </ol> <p>\u901a\u8fc7 brew \u5b89\u88c5 vim \u4e4b\u540e\uff0c\u5c06\u4f1a\u652f\u6301 <code>+clipboard</code>\uff1a</p> <pre><code>$  which vim\n/usr/local/bin/vim\n\n$  readlink `which vim`\n../Cellar/vim/8.2.0/bin/vim\n\n$  vim --version | grep clipboard\n+clipboard         +keymap            +printer           +vertsplit\n+emacs_tags        -mouse_gpm         -sun_workshop      -xterm_clipboard\n</code></pre>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/#_1","title":"\"+","text":"<p>\u65e5\u5e38\u7684 <code>&lt;C-c&gt;</code>\u3001<code>&lt;C-v&gt;</code> \u4f7f\u7528\u7684\u662f\u7cfb\u7edf\u526a\u8d34\u677f\uff08system clipboard\uff09\u3002\u7cfb\u7edf\u526a\u8d34\u677f\u4f5c\u4e3a\u7cfb\u7edf\u7ea7\u522b\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u4e24\u8fb9\u5f53\u7136\u4e0d\u80fd\u6df7\u7528\u3002 \u6240\u4ee5 vim \u4e13\u95e8\u63d0\u4f9b\u4e86 <code>\"+</code> \u5bc4\u5b58\u5668\u4f5c\u4e3a\u5bf9\u7cfb\u7edf\u526a\u8d34\u677f\u7684\u6620\u5c04\uff0c\u53ef\u4ee5\u7406\u89e3\u6210\u81ea\u52a8\u628a <code>\"+</code> \u5bc4\u5b58\u5668\u7684\u5185\u5bb9\u518d\u590d\u5236\u4e00\u4efd\u5230\u7cfb\u7edf\u526a\u8d34\u677f\u3002  </p> <p>\u975e\u7f16\u8f91\u6a21\u5f0f\u4e0b\uff0c\u8f93\u5165 <code>\"+yy</code> \u590d\u5236\u5149\u6807\u6240\u5728\u884c\u5230\u7cfb\u7edf\u526a\u8d34\u677f\uff0c\u518d\u6267\u884c <code>\"+p</code> \u5c06\u7cfb\u7edf\u526a\u8d34\u677f\u7684\u5185\u5bb9\u7c98\u8d34\u5230 vim \u5f53\u524d\u5149\u6807\u5904\u3002</p>","tags":["vim"]},{"location":"blog/20171018/016-vim-clipboard/#copypaste","title":"copy/paste","text":"<p>Copy and paste content from one file to another file in vi</p> <p>When using <code>\"*</code> register under X11, also see x11-selection. This also explains the related <code>\"+</code> register.</p> <p>requires <code>+clipboard</code> out of <code>vim --version</code></p> <p>If you are using VIM in Windows, you can get access to the clipboard (MS copy/paste) using:</p> <p><code>\"*dd</code> -- cut a line (or 3dd to cut 3 lines)</p> <p><code>\"*yy</code> -- copy a line (or 3yy to copy 3 lines)</p> <p><code>\"*p</code> -- paste line(s) on line after the cursor</p> <p><code>\"*P</code> -- paste line(s) on line before the cursor</p> <p>The lets you paste between separate VIM windows or between VIM and PC applications (notepad, word, etc).</p>","tags":["vim"]},{"location":"blog/20240317/cmd-mount-webdav/","title":"\u4f7f\u7528\u547d\u4ee4\u884c\u6302\u8f7d\u64cd\u4f5cWebDav\u4e91\u76d8","text":"<p>\u5728 macOS \u548c linux \u4e0a\u53ef\u4ee5\u901a\u8fc7 mount \u547d\u4ee4\u6302\u8f7d\u4e91\u76d8\u5230\u672c\u5730\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 curl \u547d\u4ee4\u8bbf\u95ee\u64cd\u4f5c WebDav\u3002</p>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#macos_\u4e0b\u4f7f\u7528\u547d\u4ee4\u884c\u6302\u8f7d_webdav_\u4e91\u76d8","title":"macOS \u4e0b\u4f7f\u7528\u547d\u4ee4\u884c\u6302\u8f7d WebDAV \u4e91\u76d8","text":"<p>\u9664\u4e86\u5728 Finder \u4e2d\u624b\u52a8\u8fde\u63a5\u670d\u52a1\u5668\uff08Connect to Server\uff09\uff0c\u4e5f\u53ef\u8003\u8651\u6539\u7528\u5185\u7f6e\u7684 mount \u7cfb\u5217\u547d\u4ee4\u884c\u6302\u8f7d/\u5378\u8f7d WebDAV\uff1a</p> macOS \u4e0b\u4f7f\u7528 mount_webdav \u5b50\u547d\u4ee4\u6302\u8f7d webdav<pre><code># \u521b\u5efa\u672c\u5730\u6302\u8f7d\u70b9\u76ee\u5f55\n$ sudo mkdir /Volumes/webdav\n# \u4fee\u6539\u7528\u6237\u540d\u548c\u7528\u6237\u7ec4\u4e3a\u4f60\u81ea\u5df1\u7684\u7528\u6237\uff08\u7ec4\uff09\n$ sudo chown -R faner:staff /Volumes/webdav\n# \u4f7f\u7528 mount_webdav \u547d\u4ee4\u52a0\u8f7d WebDAV\uff0c\u6309\u7167\u63d0\u793a\u8f93\u5165 username:password\n$ mount_webdav -i http://mbpa1398.local/webdav/ /Volumes/webdav\n# \u4f7f\u7528 diskutil umount \u547d\u4ee4\u5378\u8f7d WebDAV\n$ diskutil umount /Volumes/webdav\n</code></pre> <p>Success</p> <p>\u6302\u8f7d\u6210\u529f\u540e\uff0c\u6267\u884c <code>df -h</code> \u547d\u4ee4\u4f1a\u8f93\u51fa\u4e00\u6761 Filesystem=http://mbpa1398.local/webdav\uff0cMounted on /Volumes/webdav \u7684\u6761\u76ee\u3002</p> <p>\u65e0\u8bba\u54ea\u79cd\u65b9\u5f0f\uff0c\u6302\u8f7d\u6210\u529f\u540e\uff0cFinder \u4fa7\u8fb9\u680f\u7684 Locations/Network \u4e2d\u90fd\u4f1a\u51fa\u73b0\u76f8\u5e94\u7f51\u76d8\u6620\u5c04\u3002</p>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#linux_\u4e0b\u4f7f\u7528\u547d\u4ee4\u884c\u6302\u8f7d_webdav_\u4e91\u76d8","title":"linux \u4e0b\u4f7f\u7528\u547d\u4ee4\u884c\u6302\u8f7d WebDAV \u4e91\u76d8","text":"<p>\u5728 Ubuntu \u6216 CentOS \u4e0b\u53ef\u4ee5\u5c06 WebDAV \u6302\u8f7d\u4e3a\u672c\u5730\u78c1\u76d8\uff0c\u53ef\u91c7\u7528 rclone \u4e91\u540c\u6b65\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u6216\u5b89\u88c5 davfs2 \u6587\u4ef6\u7cfb\u7edf\u6269\u5c55\u3002</p> <ol> <li>\u5b89\u88c5 davfs2\uff1a</li> </ol> <pre><code># Ubuntu\n$ sudo apt-get install davfs2 -y\n# CentOS\n$ sudo yum install davfs2 -y\n</code></pre> <ol> <li>\u521b\u5efa\u672c\u5730\u6302\u8f7d\u70b9\u76ee\u5f55\uff1a</li> </ol> <pre><code>$ mkdir /mnt/webdav@mbpa1398\n</code></pre> <ol> <li>\u6267\u884c mount \u547d\u4ee4\u6302\u8f7d WebDAV\uff1a</li> </ol> <pre><code>$ sudo mount -t davfs http://mbpa1398.local/webdav /mnt/webdav@mbpa1398\nPlease enter the username to authenticate with server\nhttp://mbpa1398.local/webdav or hit enter for none.\n  Username: $username\nPlease enter the password to authenticate user $username with server\nhttp://mbpa1398.local/webdav or hit enter for none.\n  Password: $password\n</code></pre> <p>Success</p> <p>\u6302\u8f7d\u6210\u529f\u540e\uff0c\u6267\u884c <code>df -h</code> \u547d\u4ee4\u4f1a\u8f93\u51fa\u4e00\u6761 Filesystem=http://mbpa1398.local/webdav\uff0cMounted on /mnt/webdav@mbpa1398 \u7684\u6761\u76ee\u3002</p> <ol> <li>\u76f4\u63a5\u7f16\u8f91 WebDAV \u4e0a\u7684\u6587\u4ef6\uff0c\u7136\u540e\u4fdd\u5b58\u540c\u6b65\uff1a</li> </ol> <pre><code>$ sudo vim /mnt/webdav@mbpa1398/test/test.c\n</code></pre> <ol> <li>\u7528\u5b8c\u4e4b\u540e\uff0c\u8bb0\u5f97\u89e3\u9664\u6302\u8f7d\uff1a</li> </ol> <pre><code>$ sudo umount /mnt/webdav@mbpa1398\n</code></pre> <ol> <li> <p>\u53ef\u8003\u8651\u914d\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d\uff0c\u6d89\u53ca\u4ee5\u4e0b\u914d\u7f6e\u6587\u4ef6\uff1a</p> <ul> <li>davfs2\u914d\u7f6e\u6587\u4ef6\uff1a/etc/davfs2/davfs2.conf</li> <li>davfs2\u5bc6\u7801\u914d\u7f6e\uff1a/etc/davfs2/secrets</li> <li>\u81ea\u52a8\u6302\u8f7d\u914d\u7f6e\u6587\u4ef6\uff1a/etc/fstab</li> </ul> </li> </ol>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#webdav_collaborative_authoring_verbs","title":"WebDAV collaborative authoring verbs","text":"<p>RFC 4918 - HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV) @RFC Reader</p> <p>WebDAV extends the set of standard HTTP verbs and headers allowed for request methods. The added verbs include:</p> Verb Action COPY copy a resource from one uniform resource identifier (URI) to another LOCK put a lock on a resource. WebDAV supports both shared and exclusive locks. MKCOL create collections (also known as a directory) MOVE move a resource from one URI to another PROPFIND retrieve properties, stored as XML, from a web resource. It is also overloaded to allow one to retrieve the collection structure (also known as directory hierarchy) of a remote system. PROPPATCH change and delete multiple properties on a resource in a single atomic act UNLOCK remove a lock from a resource <p>WebDAV collaborative authoring in a compatible HTTP server:</p> <p></p>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#curl_\u547d\u4ee4\u884c\u8bbf\u95ee\u64cd\u4f5c_webdav","title":"curl \u547d\u4ee4\u884c\u8bbf\u95ee\u64cd\u4f5c WebDAV","text":"<p>BTW: \u4e13\u4e1a\u547d\u4ee4\u884c\u5de5\u5177 rclone\uff0c\u88ab\u8a89\u4e3a\u201c\u4e91\u5b58\u50a8\u7684\u745e\u58eb\u519b\u5200\u201d\uff0c\u53c2\u8003 \u4f7f\u7528rclone\u6302\u8f7d\u64cd\u4f5cWebDav\u4e91\u76d8\u3002</p> <ol> <li>\u8ba4\u8bc1\u65b9\u5f0f\u53ef\u9009 <code>--basic</code>\uff0c<code>--digest</code>\uff0c\u4e0d\u6307\u5b9a\u76f8\u5f53\u4e8e <code>--anyauth</code>\uff0c\u8ba9 cURL \u81ea\u52a8\u9009\u62e9\u3002</li> <li>-u(--user) \u540e\u9762\u53ef\u53ea\u6307\u5b9a\u7528\u6237\u540d <code>-u $username</code>\uff0c\u5c06\u63d0\u793a\u8f93\u5165\u5bc6\u7801\uff1b\u4e5f\u53ef\u8fde\u5e26\u6307\u5b9a\u5bc6\u7801 <code>-u $username:$password</code>\u3002</li> </ol>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#\u62c9\u53d6\u6587\u4ef6\u5217\u8868","title":"\u62c9\u53d6\u6587\u4ef6\u5217\u8868","text":"<p>\u62c9\u53d6\u6587\u4ef6\u5217\u8868\uff0c\u4e5f\u53ef\u6307\u5b9a\u5176\u4ed6\u76ee\u5f55\uff08\u4ee5/\u7ed3\u5c3e\uff09\uff1a</p> <pre><code>$ curl -i --basic -u $username -X PROPFIND http://mbpa1398.local/webdav/ --upload-file - -H \"Depth: 1\" &lt;&lt;end\n&lt;?xml version=\"1.0\"?&gt;\n&lt;a:propfind xmlns:a=\"DAV:\"&gt;\n&lt;a:prop&gt;&lt;a:resourcetype/&gt;&lt;/a:prop&gt;\n&lt;/a:propfind&gt;\nend\n</code></pre> <p>\u53ef\u4f7f\u7528 python -m pip \u5b89\u88c5 xmltojson \u652f\u6301\u5c06 xml \u8f6c\u6362\u4e3a json\u3002</p> <p>xmltojson</p> <p>xmltojson\uff08\u4f9d\u8d56 utils\uff09: Python library and cli tool for converting XML to JSON.</p> <p>\u8fd8\u53ef\u4ee5\u5b89\u88c5 jq \u547d\u4ee4\u884c\u5de5\u5177\uff08macOS: <code>brew install jq</code>\uff09\uff0c\u5c06\u538b\u7f29/\u8f6c\u4e49\u7684 json \u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u683c\u5f0f\u5316\u7684 JSON \u5bf9\u8c61\u3002</p> <p>jq</p> <p>jq is a lightweight and flexible command-line JSON processor.</p> <p>\u4ee5\u4e0b\u547d\u4ee4\u62c9\u53d6\u6839\u76ee\u5f55xml\uff0c\u5e76\u4f9d\u6b21\u7ba1\u4f20\u7ed9 xmltojson \u548c jq\uff0c\u8f93\u51fa\u683c\u5f0f\u5316\u826f\u597d\u7684 json\uff1a</p> <pre><code>$ curl -i --basic -u $username -X PROPFIND http://mbpa1398.local/webdav/ -H \"Depth: 1\" | xmltojson --stdin | jq\n</code></pre>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#\u65b0\u5efa\u76ee\u5f55","title":"\u65b0\u5efa\u76ee\u5f55","text":"<p>\u5728\u6839\u76ee\u5f55 /webdav \u4e0b\u65b0\u5efa\u6587\u4ef6\u5939 curltest\uff1a</p> <pre><code>$ curl -v -u $username -X MKCOL http://mbpa1398.local/webdav/curltest/\n</code></pre>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#\u4e0a\u4f20\u6587\u4ef6","title":"\u4e0a\u4f20\u6587\u4ef6","text":"<p>\u4e0a\u4f20\u6587\u4ef6 test.txt \u5230\u76ee\u5f55 /webdav/curltest \u4e0b\uff1a</p> <pre><code>$ curl -v -u $username -T test.txt http://mbpa1398.local/webdav/curltest/\n</code></pre> <p>\u4e5f\u53ef\u5728 url \u540e\u7eed\u63a5\u81ea\u5b9a\u4e49\u7684\u76ee\u6807\u6587\u4ef6\u540d\uff0c\u5c06 test.txt \u4e0a\u4f20\u4e3a /webdav/curltest/upload.txt\uff1a</p> <pre><code>$ curl -v -u $username -T test.txt http://mbpa1398.local/webdav/curltest/upload.txt\n</code></pre>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#\u79fb\u52a8\u6587\u4ef6","title":"\u79fb\u52a8\u6587\u4ef6","text":"<p>\u4e0d\u540c\u76ee\u5f55\u4e3a\u79fb\u52a8\uff0c\u76f8\u540c\u76ee\u5f55\u76f8\u5f53\u4e8e\u91cd\u547d\u540d\uff1a</p> <pre><code>$ curl -v -u $username -X MOVE http://mbpa1398.local/webdav/curltest/test.txt --header 'Destination: http://mbpa1398.local/webdav/curltest/test2.txt'\n</code></pre>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#\u590d\u5236\u6587\u4ef6","title":"\u590d\u5236\u6587\u4ef6","text":"<p>\u5c06 curltest/test2.txt \u590d\u5236\u4e00\u4efd\u4e3a curltest/test3.txt\uff1a</p> <pre><code>$ curl -v -u $username -X COPY http://mbpa1398.local/webdav/curltest/test2.txt --header 'Destination: http://mbpa1398.local/webdav/curltest/test3.txt'\n</code></pre>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#\u4e0b\u8f7d\u6587\u4ef6","title":"\u4e0b\u8f7d\u6587\u4ef6","text":"<p>\u6216 &gt; test2.txt\uff0c\u91cd\u5b9a\u5411 stdout \u5230\u6587\u4ef6\uff08-v \u8f93\u51fa\u5230 stderr\uff09\uff1a</p> <pre><code>$ curl -v -u $username http://mbpa1398.local/webdav/curltest/test3.txt -o test3.txt\n</code></pre>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#\u5220\u9664\u6587\u4ef6\u5939","title":"\u5220\u9664\u6587\u4ef6(\u5939)","text":"<p>\u5220\u9664 curltest \u76ee\u5f55\u4e0b\u7684 test3.txt \u6587\u4ef6\uff1a</p> <pre><code>$ curl -v -u $username -X DELETE http://mbpa1398.local/webdav/curltest/test3.txt\n</code></pre>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240317/cmd-mount-webdav/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>WebDAVDevs/awesome-webdav</p> <ul> <li>webdav-browser-extension</li> <li>File Management - WebDav</li> </ul> <p>WEBDAV WITH CURL, stokito/webdav_curl</p> <p>\u5b66\u4e60 WebDav, curl \u6d4b\u8bd5 webdav</p> <p>\u5982\u4f55\u5728Ubuntu\u6216CentOS\u5c06WebDAV\u6302\u8f7d\u4e3a\u672c\u5730\u78c1\u76d8 Linux \u6302\u8f7d WEBDAV\uff0cLinux\u5c06WebDAV\u4e3a\u672c\u5730\u78c1\u76d8</p>","tags":["webDAV","davfs2","curl"]},{"location":"blog/20240318/cron-auto-rclone/","title":"\u57fa\u4e8ecron\u914d\u7f6erclone\u81ea\u52a8\u540c\u6b65\u4efb\u52a1","text":"<p>\u5728\u4e0a\u4e00\u7bc7\u300a\u4f7f\u7528rclone\u8bbf\u95ee\u64cd\u4f5cWebDav\u4e91\u76d8\u300b\u4e2d\uff0c\u6211\u4eec\u7cfb\u7edf\u68b3\u7406\u4e86\u5f3a\u5927\u7684 rclone \u547d\u4ee4\u884c\u5de5\u5177\u5e38\u7528\u547d\u4ee4\u548c\u60ef\u7528\u6cd5\u3002</p> <p>\u672c\u7bc7\u4ecb\u7ecd\u5728 macOS/ubuntu \u4e0b\u4f7f\u7528 cron \u914d\u7f6e\u5b9a\u65f6\u4efb\u52a1\uff08crontab\uff09\uff0c\u5b9e\u73b0\u672c\u5730\u4e0e\u4e91\u76d8\u4e4b\u95f4\u540c\u6b65\u5907\u4efd\u81ea\u52a8\u5316\u3002</p>","tags":["rclone","crontab"]},{"location":"blog/20240318/cron-auto-rclone/#croncrontab","title":"cron/crontab","text":"<p>Bisync: On Linux or Mac, consider setting up a crontab entry. <code>bisync</code> can safely run in concurrent cron jobs thanks to lock files it maintains.</p> <p>cron, crontab, and cronjob</p> <p>Difference between cron, crontab, and cronjob?</p> <ul> <li><code>Cron</code>: Cron comes from chron, the Greek prefix for \u2018time\u2019. Cron is a daemon which runs at the times of system boot.</li> <li><code>Crontab</code>: Crontab (CRON TABle) is a file which contains the schedule of cron entries to be run and at specified times. File location varies by operating systems.</li> <li><code>Cron job</code> or <code>cron schedule</code>: Cron job or cron schedule is a specific set of execution instructions specifying day, time and command to execute. crontab can have multiple execution statements.</li> </ul> <p>\u53ef\u4ee5\u901a\u8fc7 cron / crontab - tables for driving systemd-cron \u914d\u7f6e\u5b9a\u65f6\u4efb\u52a1\uff0c\u6bcf\u5929\u81ea\u52a8\u6267\u884c\u540c\u6b65\u3002</p> <p>\u53c2\u8003 How to Use Cron to Automate Linux Jobs on Ubuntu 20.04 \u548c How do I set up a Cron job? - Ask Ubuntu\u3002</p> <p>ubuntu \u7cfb\u7edf\u7ea7\u522b\u7684 crontab \u914d\u7f6e\u6587\u4ef6\u5728 /etc/ \u76ee\u5f55\u4e0b\uff08cron*\uff09\uff1a</p> <pre><code># ls -l /etc/cron*\n$ ls -l /etc | grep cron\ndrwxr-xr-x 2 root root       4096 Nov  6  2022 cron.d\ndrwxr-xr-x 2 root root       4096 Apr  7 05:00 cron.daily\ndrwxr-xr-x 2 root root       4096 Nov  6  2022 cron.hourly\ndrwxr-xr-x 2 root root       4096 Nov  6  2022 cron.monthly\n-rw-r--r-- 1 root root       1136 Aug  6  2021 crontab\ndrwxr-xr-x 2 root root       4096 Nov  6  2022 cron.weekly\n</code></pre> <p>\u6bcf\u4e2a\u7528\u6237\u6709\u4e00\u4e2a\u4ee5\u7528\u6237\u540d\u547d\u540d\u7684 crontab \u914d\u7f6e\u6587\u4ef6\uff0c\u5b58\u653e\u5728 <code>/var/spool/cron/crontabs</code> \u76ee\u5f55\u4e0b\u3002</p> <p>macOS \u4e0b\u6267\u884c <code>man cron</code>\uff0cFILES \u663e\u793a Directory for personal crontab files \u4e3a <code>/usr/lib/cron/tabs</code>\u3002</p> <pre><code>$ sudo ls -l /usr/lib/cron/\ntotal 0\n-rw-r--r--  1 root    wheel   0 Mar 30 15:19 at.deny\n-rw-r--r--  1 root    wheel   6 Mar 30 15:19 cron.deny\ndrwxr-xr-x  2 daemon  wheel  64 Mar 30 15:19 jobs\ndrwxr-xr-x  2 daemon  wheel  64 Mar 30 15:19 spool\ndrwx------  3 root    wheel  96 Mar 30 15:19 tabs\ndrwx------  2 root    wheel  64 Mar 30 15:19 tmp\n\n$ sudo ls -l /usr/lib/cron/tabs\n</code></pre>","tags":["rclone","crontab"]},{"location":"blog/20240318/cron-auto-rclone/#cronubuntu","title":"cron/ubuntu","text":"<p>\u7528\u6237\u53ef\u6267\u884c <code>crontab -e</code> \u6253\u5f00\u4e00\u4e2a\u7c7b\u4f3c <code>/tmp/crontab.CNG0fm/crontab</code> \u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u7f16\u8f91 personal crontab\u3002</p> <p>\u5728 rpi4b-ubuntu \u4e0a\u9996\u6b21\u6267\u884c <code>crontab -e</code>\uff08\u6ce8\u610f\u4e0d\u8981 sudo\uff09\uff0c\u63d0\u793a\u9009\u62e9\u7f16\u8f91\u5668\uff0c\u9009\u62e9 vim \u6253\u5f00\u7f16\u8f91\uff1a</p> <pre><code>$ pifan@rpi4b-ubuntu ~\ncrontab -e\nno crontab for pifan - using an empty one\n\nSelect an editor.  To change later, run 'select-editor'.\n  1. /usr/bin/vim.gtk3\n  2. /bin/nano        &lt;---- easiest\n  3. /usr/bin/vim.basic\n  4. /usr/bin/vim.tiny\n  5. /bin/ed\n\nChoose 1-5 [2]: 3\n</code></pre> <p>\u6587\u6863\u6ce8\u91ca\u4e2d\u6709\u5173\u4e8e\u914d\u7f6e\u9879\u7684\u8bf4\u660e\uff1a</p> crontab -e Cron Syntax<pre><code># To define the time you can provide concrete values for\n# minute (m), hour (h), day of month (dom), month (mon),\n# and day of week (dow) or use '*' in these fields (for 'any').\n#\n# For more information see the manual pages of crontab(5) and cron(8)\n#\n# m h  dom mon dow   command\n</code></pre> man 5 crontab <pre><code>Instead of the first five fields, one of eight special strings may appear:\n\n    string         meaning\n    ------         -------\n    @reboot        Run once, at startup.\n    @yearly        Run once a year, \"0 0 1 1 *\".\n    @annually      (same as @yearly)\n    @monthly       Run once a month, \"0 0 1 * *\".\n    @weekly        Run once a week, \"0 0 * * 0\".\n    @daily         Run once a day, \"0 0 * * *\".\n    @midnight      (same as @daily)\n    @hourly        Run once an hour, \"0 * * * *\".\n\n`8-11` for an hours entry specifies execution at hours 8, 9, 10 and 11.\n\nA list is a set of numbers (or ranges) separated by commas. Examples: `1,2,5,9`, `0-4,8-12`.\n\n`0-23/2` can be used in the hours field to specify command execution every other hour\n\nif you want to say ``every two hours'', just use `*/2`.\n\nEXAMPLE CRON FILE\n       # run five minutes after midnight, every day\n       5 0 * * *       $HOME/bin/daily.job &gt;&gt; $HOME/tmp/out 2&gt;&amp;1\n       # run at 2:15pm on the first of every month \u2014 output mailed to paul\n       15 14 1 * *     $HOME/bin/monthly\n       # run at 10 pm on weekdays, annoy Joe\n       0 22 * * 1-5    mail -s \"It's 10pm\" joe%Joe,%%Where are your kids?%\n       23 0-23/2 * * * echo \"run 23 minutes after midn, 2am, 4am ..., everyday\"\n       5 4 * * sun     echo \"run at 5 after 4 every Sunday\"\n       0 */4 1 * mon   echo \"run every 4th hour on the 1st and on every Monday\"\n       0 0 */2 * sun   echo \"run at midn on every Sunday that's an uneven date\"\n       # Run on every second Saturday of the month\n       0 4 8-14 * *    test $(date +\\%u) -eq 6 &amp;&amp; echo \"2nd Saturday\"\n\n       # Execute a program and run a notification every day at 10:00 am\n       0 10 * * *  $HOME/bin/program | DISPLAY=:0 notify-send \"Program run\" \"$(cat)\"\n</code></pre> <p>\u6267\u884c <code>crontab -e</code> \u5728\u672b\u5c3e\u65b0\u589e\u4e00\u6761\u6d4b\u8bd5\u4efb\u52a1\uff0c\u6bcf\u5206\u949f\u6267\u884c echo \u5199\u5165\u6587\u4ef6 crontab.log\u3002</p> crontab -e test<pre><code>*/1 * * * * echo \"echo from crontab.\" &gt;&gt; $HOME/Downloads/output/crontab.log\n# */1 * * * * echo \"$(date) : echo from crontab.\" &gt;&gt; $HOME/Downloads/output/crontab.log\n</code></pre> <p><code>tail -f crontab.log</code>\uff0c\u6574\u70b9\u5206\u949f\u89c2\u5bdf crontab.log \u662f\u5426\u6709\u8ffd\u52a0\u5185\u5bb9\uff0c\u4ee5\u9a8c\u8bc1 cron \u4efb\u52a1\u6b63\u5e38\u8c03\u5ea6\u3002</p> <p>\u786e\u8ba4 cron \u4efb\u52a1\u8c03\u5ea6\u6b63\u5e38\u540e\uff0c\u5728 cron table \u672b\u5c3e\u65b0\u589e\u4e00\u6761 rclone \u547d\u4ee4\u6d4b\u8bd5\u4efb\u52a1\uff1a</p> crontab -e test rclone<pre><code>*/1 * * * * rclone version &gt;&gt; $HOME/Downloads/output/crontab.log\n</code></pre> <p>\u6574\u70b9\u5206\u949f\uff0c\u89c2\u5bdf crontab.log\uff0c\u786e\u8ba4 rclone version \u88ab cron \u6b63\u5e38\u8c03\u5ea6\u6267\u884c\u3002</p> <p>\u6bcf\u5929\u5b9a\u70b9\u6267\u884c rclone sync\uff0c\u5c06 webdav \u4e91\u76d8\u81ea\u52a8\u540c\u6b65\u5230\u5916\u6302\u786c\u76d8\uff08<code>/media/WDHD/</code>\uff09\u3002</p> crontab -e hourly<pre><code># auto backup every two hours(0,2,4,6,8,10,12,14,16,18,20,22)\n# 0 */2 * * * rclone sync -v webdav-rpi4b: /media/WDHD/webdav@rpi4b &gt;&gt; /var/log/rclone.log 2&gt;&amp;1\n0 */2 * * * rclone sync -v webdav-rpi4b: /media/WDHD/webdav@rpi4b --log-file=/home/pifan/.config/rclone/rclone-`date +\\%Y\\%m\\%d`.log\n</code></pre> <p>\u5982\u679c\u540e\u7eed\u6587\u4ef6\u6539\u52a8\u4e0d\u662f\u90a3\u4e48\u9891\u7e41\uff0c\u53ef\u4ee5\u6539\u4e3a\u6bcf\u5929\u540c\u6b65\u4e00\u6b21\uff0c\u65e5\u5fd7\u6587\u4ef6\u6309\u6708\u547d\u540d\u3002</p> crontab -e daily<pre><code># \u6bcf\u5929\u51cc\u66681\u70b9\u540c\u6b65\u5907\u4efd\n0 1 * * * rclone sync -v webdav-rpi4b: /media/WDHD/webdav@rpi4b --log-file=/home/pifan/.config/rclone/rclone-`date +\\%Y\\%m`.log\n</code></pre> <p>\u8f93\u5165 <code>:wq</code> \u4fdd\u5b58\u9000\u51fa vim\uff0c\u547d\u4ee4\u884c\u63d0\u793a <code>crontab: installing new crontab</code>\u3002</p> <p>webdav \u7f16\u8f91\u5927\u6587\u4ef6\u65f6\u7ecf\u5e38\u51fa\u73b0\u540c\u6b65\u95ee\u9898\u5bfc\u81f4\u6587\u4ef6\u635f\u574f\uff0c\u53ef\u6307\u5b9a <code>--min-size SizeSuffix</code> \u9009\u9879\uff0c\u53ea\u5907\u4efd\u5927\u4e8e SizeSuffix\uff08\u4f8b\u5982 10M\uff09\u7684\u5927\u6587\u4ef6\u3002</p> <p>\u5173\u4e8e rclone \u8fd0\u884c\u65e5\u5fd7\u8def\u5f84</p> <p>\u53ef\u901a\u8fc7 <code>--log-file=FILE</code> \u9009\u9879\u6307\u5b9a\u7528\u6237\u7ea7\u522b\u7684\u65e5\u5fd7\u8def\u5f84\u3002 \u53c2\u8003 Sending cron output to a file with a timestamp in its name\uff0c\u65e5\u5fd7\u6587\u4ef6\u6309\u5929\u6216\u6708\u547d\u540d\u3002 \u5982\u82e5\u4f7f\u7528\u5168\u5c40\u65e5\u5fd7\u8def\u5f84 /var/log/rclone.log\uff0c\u5219\u9700\u5148 <code>sudo touch</code> \u518d <code>sudo chown</code> \u4e3a\u5f53\u524d\u7528\u6237\u7ec4\u3002 macOS \u4e0b\u7684 rclone \u8fd0\u884c\u65e5\u5fd7\u53ef\u8003\u8651\u653e\u5230\u5168\u5c40\u65e5\u5fd7\u8def\u5f84 /usr/local/var/log \u4e0b\uff0c\u6216\u653e\u5728\u5bb6\u76ee\u5f55\u914d\u7f6e\u6587\u4ef6\u5939\u4e0b\u3002</p> <p>\u7f16\u8f91\u7684 personal crontab \u5c06\u81ea\u52a8\u8ffd\u52a0\u5230 <code>/var/spool/cron/crontabs/$USER</code> \u6587\u4ef6\u4e2d\u3002</p> <p>\u6267\u884c <code>sudo systemctl restart cron.service</code> \u91cd\u542f cron \u670d\u52a1\uff08\u53ef\u9009\uff09\u3002</p> <p>crontab list &amp; remove</p> <p>\u6267\u884c <code>crontab -l</code> \u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u7528\u6237\u7684\u4efb\u52a1\u5217\u8868\uff0c\u6216\u901a\u8fc7 <code>-u</code> \u9009\u9879\u67e5\u770b\u6307\u5b9a\u7528\u6237\u7684\u4efb\u52a1\u5217\u8868 <code>crontab -l -u pifan</code>\u3002 \u6267\u884c <code>crontab -r</code> \u53ef\u4ee5\u79fb\u9664\u5f53\u524d\u7528\u6237\u914d\u7f6e\u7684\u4efb\u52a1\u5217\u8868\uff0c\u6216 <code>crontab -ri</code> \u5e26 interactive prompt \u786e\u8ba4\u3002</p>","tags":["rclone","crontab"]},{"location":"blog/20240318/cron-auto-rclone/#cron_run_sh","title":"cron run sh","text":"<p>\u4ee5\u4e0a crontab \u76f4\u63a5\u914d\u7f6e\u547d\u4ee4\u884c\u8fd0\u884c rclone \u6267\u884c\u7f51\u76d8\u540c\u6b65\uff0c\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a crontab \u914d\u7f6e\u8fd0\u884c Shell \u811a\u672c\u7684\u8303\u4f8b\u3002</p> <ol> <li> <p>\u521b\u5efa\u7528\u6237\u811a\u672c\u6587\u4ef6 <code>touch ~/Scripts/cp-config-to-smb.sh</code>\uff0c\u6bcf\u5929\u96f6\u70b9\u6267\u884c <code>cp</code> \u547d\u4ee4\u5c06 zsh\u3001vim \u914d\u7f6e\u6587\u4ef6\u540c\u6b65\u5230\u5916\u6302\u786c\u76d8\u5907\u4efd\u6587\u4ef6\u5939\u3002</p> cp-config-to-smb.sh <pre><code>#!/usr/bin/env bash\n\nbackup_config() {\n  # config filepath\n  config=$1\n  # folder=${config%/*}\n  filename=${config##*/}\n  name=${filename%.*}\n  ext=${filename##*.}\n\n  filedate=$(date -r \"$config\" +%Y%m%d)\n\n  dstfile=\"\"\n  if [ -z \"$name\" ]; then\n    dstfile=\"$dstpath/$host-$filedate.$ext\"\n  else\n    dstfile=\"$dstpath/$host-$filedate-$name.$ext\"\n  fi\n\n  # -u: copy only when the SOURCE file is newer than the destination file\n  #            or when the destination file is missing\n  echo -e \"$(date +%Y/%m/%d\\ %H:%M:%S): cp sync config $filename\" &gt;&gt; \"$logfile\"\n  if cp -v -u \"$config\" \"$dstfile\" &amp;&gt;&gt; \"$logfile\"; then\n    echo -e \"$(date +%Y/%m/%d\\ %H:%M:%S): cp sync success.\\n\" &gt;&gt; \"$logfile\"\n  else\n    echo -e \"$(date +%Y/%m/%d\\ %H:%M:%S): cp sync failed.\\n\" &gt;&gt; \"$logfile\"\n  fi\n}\n\nmain() {\n  backup_config \"$HOME/.zshrc\"\n  backup_config \"$HOME/.vimrc\"\n  backup_config \"/etc/vim/vimrc.local\"\n}\n\n############################################################\n# main entry\n############################################################\n# echo \"param count = $#\"\n# echo \"params = $@\"\n\n# 1. make path for logfile\n# echo \"dirname = $(dirname $0)\"\ndir=$(dirname $0)\n# echo \"basename = $(basename $0)\"\nname=$(basename $0)\nname=${name%.*}\nlogfile=$dir/$name\".log\"\n\n# 2. extract hostname, ignore domain\n# echo $HOST\nhostname=$(hostname)\nhost=${hostname%%.*}\n\n# 3. backup destination: mount_smbfs\ndstpath=\"/media/WDHD/backups/config\"\n\n# 4. main routine entry\nmain \"$@\" # $*\n</code></pre> </li> <li> <p>\u4fdd\u5b58\u811a\u672c\u6587\u4ef6\u540e\uff0c\u6267\u884c <code>chmod +x ~/Scripts/cp-config-to-smb.sh</code> \u6dfb\u52a0\u53ef\u6267\u884c\u6743\u9650\u3002</p> </li> <li>\u6267\u884c <code>crontab -e</code> \u6dfb\u52a0 cron \u5b9a\u65f6\u8c03\u5ea6\u4efb\u52a1\u3002</li> </ol> crontab -e daily<pre><code># 1. \u672c\u5730\u914d\u7f6e\u540c\u6b65\u5230 mount_smbfs, @daily @midnight\n0 0 * * * $HOME/Scripts/cp-config-to-smb.sh\n\n# 2. \u6bcf\u5929\u51cc\u66682\u70b9\u540c\u6b65\u5907\u4efd\n0 2 * * * rclone sync -v webdav-rpi4b: /media/WDHD/webdav@rpi4b --log-file=/home/pifan/.config/rclone/rclone-`date +\\%Y\\%m`.log\n</code></pre>","tags":["rclone","crontab"]},{"location":"blog/20240318/cron-auto-rclone/#cronmacos","title":"cron/macOS","text":"<p>\u5728 macOS \u4e0a\u9996\u6b21\u6267\u884c <code>crontab -e</code>\uff0c\u5c06\u4e34\u65f6\u6253\u5f00\u4e00\u4e2a\u7a7a\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4f7f\u7528\u7f16\u8f91\u5668 /usr/bin/vi\u3002 \u5728\u672b\u5c3e\u65b0\u589e\u4e00\u6761\u6d4b\u8bd5\u4efb\u52a1\uff0c\u6bcf\u5206\u949f\u6267\u884c echo(date) \u5199\u5165\u6587\u4ef6 crontab.log\u3002</p> crontab -e test<pre><code>*/1 * * * * echo \"echo from crontab.\" &gt;&gt; /Users/faner/Downloads/output/crontab.log\n# */1 * * * * echo \"$(date) : echo from crontab.\" &gt;&gt; /Users/faner/Downloads/output/crontab.log\n</code></pre> <p>\u4fdd\u5b58\u9000\u56de\u5230\u7ec8\u7aef\uff0c\u547d\u4ee4\u884c\u663e\u793a\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>$ crontab -e\ncrontab: no crontab for faner - using an empty one\ncrontab: installing new crontab\n</code></pre> <p>\u6267\u884c <code>crontab -l</code> \u53ef\u4ee5\u67e5\u770b\u914d\u7f6e\u5185\u5bb9\u3002</p> <p>personal crontab \u76ee\u5f55\u4e0b\u4f1a\u591a\u51fa\u4e00\u4e2a\u4ee5\u5f53\u524d\u7528\u6237\u540d\uff08$USER\uff09\u547d\u540d\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5982 /usr/lib/cron/tabs/faner\u3002</p> <p>\u6574\u70b9\u5206\u949f\uff0c\u89c2\u5bdf crontab.log \u662f\u5426\u6709\u8ffd\u52a0\u5185\u5bb9\uff0c\u4ee5\u9a8c\u8bc1 cron \u4efb\u52a1\u6b63\u5e38\u6267\u884c\u3002</p> <p>\u5982\u679c\u4e4b\u524d\u672a\u5728 macOS \u4e0a\u914d\u7f6e\u8fc7 cron \u670d\u52a1\uff0c\u5927\u6982\u7387\u4f1a\u5931\u8d25\uff0c\u53c2\u7167\u4e0b\u6587\u6b65\u9aa4\u914d\u7f6e\u3002</p>","tags":["rclone","crontab"]},{"location":"blog/20240318/cron-auto-rclone/#config_cron_service","title":"config cron service","text":"<p>macOS \u4e0b\u7684 cron</p> <p>macOS \u4e0b\u7684 cron \u662f\u7cfb\u7edf\u542f\u52a8\u670d\u52a1\uff08LaunchDaemons\uff09\uff0c\u6bcf\u6b21\u6267\u884c <code>crontab -e</code> \u7f16\u8f91\u4fdd\u5b58\uff0c\u90fd\u63d0\u793a\u9700\u8981\u6388\u6743\u7ec8\u7aef\u7ba1\u7406\u5458\u6743\u9650\uff01</p> <p>\u9996\u5148\u4ece launchctl list \u4e2d\u67e5\u627e cron \u670d\u52a1\uff1a</p> <pre><code>$ sudo launchctl list | grep 'cron'\n86386   0   com.vix.cron\n</code></pre> <p>\u5176\u4e2d\u7b2c\u4e00\u5217\u662f\u670d\u52a1\u8fdb\u7a0bID\uff08pid\uff09\uff1b\u7b2c\u4e8c\u5217\u662f\u670d\u52a1\u72b6\u6001\uff0c0\u4ee3\u8868\u6b63\u5e38\uff1b\u7b2c\u4e09\u5217\u662f\u670d\u52a1plist\u540d\u3002</p> <p>\u5c1d\u8bd5\u6267\u884c <code>locate com.vix.cron</code> \u5168\u5c40\u67e5\u627e cron \u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\uff1a</p> <pre><code>$ locate com.vix.cron\n\nWARNING: The locate database (/var/db/locate.database) does not exist.\nTo create the database, run the following command:\n\n  sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.locate.plist\n\nPlease be aware that the database can take some time to generate; once\nthe database has been created, this message will no longer appear.\n</code></pre> <p>\u6309\u7167\u63d0\u793a\u6267\u884c\u52a0\u8f7d <code>com.apple.locate</code> \u670d\u52a1\uff0c\u521b\u5efa\u4e00\u4e2adatabase\uff1a</p> <pre><code>$ sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.locate.plist\n</code></pre> <p>\u7136\u540e\uff0c\u518d\u6b21\u6267\u884c <code>locate com.vix.cron</code> \u67e5\u627e\u5230 cron \u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\uff1a</p> <pre><code>$ locate com.vix.cron\n/System/Library/LaunchDaemons/com.vix.cron.plist\n</code></pre> <p>\u6267\u884c cat \u6216 vim \u67e5\u770b\u8be5\u914d\u7f6e\u6587\u4ef6\uff0c\u53d1\u73b0\u5176 PathState \u4e2d\u7684 <code>/etc/crontab</code> \u914d\u7f6e\u6587\u4ef6\u9ed8\u8ba4\u4e0d\u5b58\u5728\u3002</p> com.vix.cron.plist <pre><code> &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n &lt;!DOCTYPE plist PUBLIC \"-//Apple Computer//DTD PLIST 1.0//EN\"\n    \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n &lt;plist version=\"1.0\"&gt;\n &lt;dict&gt;\n    &lt;key&gt;Label&lt;/key&gt;\n    &lt;string&gt;com.vix.cron&lt;/string&gt;\n    &lt;key&gt;ProgramArguments&lt;/key&gt;\n    &lt;array&gt;\n        &lt;string&gt;/usr/sbin/cron&lt;/string&gt;\n    &lt;/array&gt;\n    &lt;key&gt;KeepAlive&lt;/key&gt;\n    &lt;dict&gt;\n        &lt;key&gt;PathState&lt;/key&gt;\n        &lt;dict&gt;\n            &lt;key&gt;/etc/crontab&lt;/key&gt;\n            &lt;true/&gt;\n        &lt;/dict&gt;\n    &lt;/dict&gt;\n    &lt;key&gt;QueueDirectories&lt;/key&gt;\n    &lt;array&gt;\n        &lt;string&gt;/usr/lib/cron/tabs&lt;/string&gt;\n    &lt;/array&gt;\n    &lt;key&gt;EnableTransactions&lt;/key&gt;\n    &lt;true/&gt;\n &lt;/dict&gt;\n &lt;/plist&gt;\n</code></pre> <p>\u6267\u884c <code>sudo vim /etc/crontab</code> \u521b\u5efa <code>/etc/crontab</code> \u6587\u4ef6\uff0c\u53c2\u8003 ubuntu \u586b\u5165\u4ee5\u4e0b\u6a21\u7248\u5185\u5bb9\uff1a</p> /etc/crontab<pre><code>SHELL=/bin/bash\nPATH=/sbin:/bin:/usr/sbin:/usr/bin\nMAILTO=root\n\n# For details see man 4 crontabs\n\n# Example of job definition:\n# .---------------- minute (0 - 59)\n# |  .------------- hour (0 - 23)\n# |  |  .---------- day of month (1 - 31)\n# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...\n# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat\n# |  |  |  |  |\n# *  *  *  *  * user-name  command to be executed\n</code></pre> <p>macOS \u91cd\u542f cron \u670d\u52a1</p> <ol> <li> <p>cron \u670d\u52a1\u5f00\u542f\u3001\u5173\u95ed\u3001\u91cd\u542f\uff1a</p> <ul> <li>sudo /usr/sbin/cron start</li> <li>sudo /usr/sbin/cron stop</li> <li>sudo /usr/sbin/cron restart</li> </ul> </li> <li> <p>\u5982\u679c\u4fee\u6539\u4e86\u914d\u7f6e\u6587\u4ef6\uff0c\u6267\u884c launchctl load \u547d\u4ee4\uff08\u53ef\u6dfb\u52a0 -w \u9009\u9879\uff09\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\uff1a</p> <ul> <li>sudo launchctl load /System/Library/LaunchDaemons/com.vix.cron.plist</li> <li>sudo launchctl unload /System/Library/LaunchDaemons/com.vix.cron.plist</li> </ul> </li> </ol> <p>\u6267\u884c\u5b8c\u4ee5\u4e0a\u914d\u7f6e\uff0c\u518d\u89c2\u5bdf\u68c0\u67e5 crontab.log\u3002</p> <p>\u5982\u679c\u8fd8\u6ca1\u6709\u5185\u5bb9\uff0c\u53ef\u80fd\u662f\u8be5\u6d4b\u8bd5\u547d\u4ee4\u6d89\u53ca\u5230\u5199\u78c1\u76d8\u6587\u4ef6\uff0c\u9700\u8981\u7ed9 cron \u6388\u6743\u5199\u78c1\u76d8\u6743\u9650\u3002</p> <ul> <li>Crontab is not running /usr/local/bin/ script</li> <li>How to Fix Cron Permission Issues in macOS</li> <li>Fixing cron jobs in macOS</li> </ul> <p>\u6388\u6743 cron \u5199\u78c1\u76d8\u6743\u9650</p> <ol> <li>\u6267\u884c <code>which cron</code> \u67e5\u627e\u5230 cron \u547d\u4ee4\u7684\u4f4d\u7f6e\uff1a/usr/sbin/cron\u3002</li> <li>\u6253\u5f00 macOS \u8bbe\u7f6e(System Settings)\uff0c\u9690\u79c1\u4e0e\u5b89\u5168\u6027(Privacy &amp; Security)\uff0c\u70b9\u8fdb\u5b8c\u5168\u78c1\u76d8\u8bbf\u95ee\u6743\u9650(Full Disk Access)\u3002</li> <li>\u70b9\u6309\u5de6\u4e0b\u89d2\u7684 + \u53f7\uff0c\u5728\u6253\u5f00\u7684\u8bbf\u8fbe\u7a97\u53e3\u6309 Shift+Cmd+G \u8c03\u51fa\u8def\u5f84\u8bbf\u95ee\u65b9\u5f0f\uff0c\u8f93\u5165 <code>/usr/sbin/cron</code> \u56de\u8f66\uff0c\u627e\u5230 cron \u547d\u4ee4\u6dfb\u52a0\u3002</li> </ol> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5230\u8fd9\u4e00\u6b65\uff0c<code>tail -f crontab.log</code> \u5e94\u8be5\u53ef\u4ee5\u770b\u5230\u6bcf\u5206\u949f\u8ffd\u52a0\u5199\u5165\u4e86\u4e00\u884c\u5f53\u524d\u65e5\u671f\u65f6\u95f4\u3002</p>","tags":["rclone","crontab"]},{"location":"blog/20240318/cron-auto-rclone/#cron_test_rclone","title":"cron test rclone","text":"<p>\u786e\u8ba4 cron \u4efb\u52a1\u8c03\u5ea6\u6b63\u5e38\u540e\uff0c\u5728 cron table \u672b\u5c3e\u65b0\u589e\u4e00\u6761 rclone \u547d\u4ee4\u6d4b\u8bd5\u4efb\u52a1\uff1a</p> crontab -e test rclone<pre><code>*/1 * * * * rclone version &gt;&gt; /Users/faner/Downloads/output/crontab.log\n</code></pre> <p>\u8fd9\u4e00\u6b21\uff0c\u6ca1\u6709\u5728 ubuntu \u4e0a\u90a3\u4e48\u5e78\u8fd0\uff0c\u6574\u70b9\u5206\u949f\u89c2\u5bdf crontab.log\uff0crclone version \u6ca1\u6709\u88ab cron \u8c03\u5ea6\u6267\u884c\u3002</p> <p>cron \u6267\u884c\u51fa\u9519\u65f6\u9ed8\u8ba4\u4f1a\u901a\u8fc7 MTA \u670d\u52a1\u7ed9\u7cfb\u7edf\u7ba1\u7406\u5458\u53d1\u90ae\u4ef6\uff0c\u6267\u884c <code>vim /var/mail/$USER</code> \u68c0\u67e5\u5f53\u524d\u7528\u6237\u7684\u90ae\u7bb1\u3002</p> <p>\u679c\u7136\uff0c\u5176\u4e2d\u63d0\u793a\u627e\u4e0d\u5230 rclone \u547d\u4ee4\uff1a</p> <pre><code>/bin/sh: rclone: command not found\n</code></pre> <p>\u4e3a\u5565 echo/date \u548c ubuntu \u4e0b\u7684 rclone \u80fd\u627e\u5230\u5462\uff1f</p> <ol> <li>echo \u662f\u5185\u7f6e\u547d\u4ee4\uff08shell built-in command\uff09\u3002</li> <li>root \u542f\u52a8\u7684 shell \u73af\u5883\u53d8\u91cf\u9884\u5b9a\u4e49\u5728 macOS \u4e0b\u7684 <code>/etc/paths</code> \u548c ubuntu \u4e0b\u7684 <code>/etc/environment</code>\u3002</li> <li>date \u547d\u4ee4\u7684 owner \u4e3a root\uff0c\u5176\u5b89\u88c5\u8def\u5f84\u5728 macOS \u4e3a <code>/bin/date</code>\uff0c\u5728 ubuntu \u4e3a <code>/usr/bin/date</code>\uff0c\u5747\u5728 root shell PATH \u4e2d\u3002</li> <li>ubuntu \u4e0b\u6267\u884c <code>sudo apt install rclone</code> \u4ee5 root \u8eab\u4efd\u5b89\u88c5\u7684 rclone\uff0c\u5176 path \u4e3a /usr/bin/rclone\uff0c\u4ea6\u5728 root shell PATH \u4e2d\u3002</li> </ol> <p>\u5728 macOS \u4e0b\u6267\u884c <code>ls -l $(which rclone)</code> \u6216 <code>stat $(which rclone)</code> \u53ef\u4ee5\u770b\u5230\u5f53\u524d\u7528\u6237\u901a\u8fc7 brew \u5b89\u88c5\u7684 rclone \u8def\u5f84\u4e3a <code>/usr/local/bin/rclone</code>\uff0c\u4e0d\u5728 root shell PATH \u4e2d\uff0c\u6545 root \u6267\u884c cron \u65f6\u627e\u4e0d\u5230 rclone \u547d\u4ee4\u3002</p> <p>\u5c06 rclone \u547d\u4ee4\u6539\u4e3a\u7edd\u5bf9\u8def\u5f84 <code>/usr/local/bin/rclone</code>\uff0ccron \u4efb\u52a1\u8c03\u5ea6\u6b63\u5e38\u3002</p> crontab -e<pre><code>*/1 * * * * /usr/local/bin/rclone version &gt;&gt; /Users/faner/Downloads/output/crontab.log\n</code></pre>","tags":["rclone","crontab"]},{"location":"blog/20240318/cron-auto-rclone/#cron_rclone_sync","title":"cron rclone sync","text":"<p>\u9a8c\u8bc1 cron \u6b63\u5e38\u8c03\u5ea6 rclone \u540e\uff0c\u63a5\u4e0b\u6765\u5728 crontab \u4e2d\u914d\u7f6e rclone \u5b9a\u65f6\u540c\u6b65\u5907\u4efd\u4efb\u52a1\u3002</p> <p>\u7f16\u5199\u4e00\u4e2a shell \u811a\u672c /usr/local/etc/scripts/rclone-sync-linkin-words.sh\uff0c\u5b9a\u65f6\u5c06\u672c\u5730 LINKIN-WORDS-7000 \u76ee\u5f55\u4e0b\u7684 PDF \u6587\u4ef6\u540c\u6b65\u5230\u5c40\u57df\u7f51 SMB \u5171\u4eab\u76d8\uff08smbhd@rpi4b:\uff09\u4e0a\u3002</p> <p>\u9700\u5148\u6267\u884c <code>sudo chmod +x rclone-sync-linkin-words.sh</code> \u8d4b\u4e88\u5176\u4ed6\u7528\u6237\u5bf9\u8be5\u811a\u672c\u7684\u53ef\u6267\u884c\u6743\u9650\u3002</p> <p>\u5907\u4efd\u811a\u672c <code>rclone-sync-linkin-words.sh</code> \u4f7f\u7528 date \u6216 stat \u547d\u4ee4\u68c0\u67e5\u6587\u4ef6\u6700\u540e\u4fee\u6539\u65f6\u95f4\u3002</p> date -rmacOS: stat -fubuntu: stat -c <pre><code>$ date -r test.txt\nSat Mar 16 16:53:38 CST 2024\n\n$ date -r test.txt +%s\n1710579218\n\n$ date -r test.txt +%Y%m%d%H%M%S\n20240316165338\n</code></pre> <p><code>-f format</code>: Display information using the specified format.  See the Formats section for a description of valid formats.</p> <pre><code># To display a file's modification time:\n$ stat -f %m test.txt\n1710579218\n\n# To display the same modification time in a readable format\n$ stat -f %Sm test.txt\nMar 16 16:53:38 2024\n\n# To display the same modification time in a readable and sortable format\n$ stat -f %Sm -t %Y%m%d%H%M%S test.txt\n20240316165338\n</code></pre> <p><code>-c</code> / --format=FORMAT: use the specified FORMAT instead of the default; output a newline after each use of FORMAT</p> <pre><code>$ stat -c %Y test.txt\n1710579219\n\n$ stat -c %y test.txt\n2024-03-16 16:53:39.000000000 +0800\n\n$ date -d \"@$(stat -c %Y test.txt)\" '+%Y%m%d%H%M%S'\n20240316165339\n</code></pre> <p>\u5982\u679c\u5728\u6700\u540e\u4fee\u6539\u65f6\u95f4\u5230\u5f53\u524d\u65f6\u95f4\u95f4\u9694\u5185\uff08\u5f80\u524d-5s\uff09\u5df2\u7ecf\u6709\u5907\u4efd\uff0c\u8bf4\u660e\u6700\u8fd1\u6ca1\u6709\u6539\u52a8\uff0c\u6709\u6539\u52a8\u624d\u6267\u884c\u5907\u4efd\u3002 \u6bcf\u6b21\u5907\u4efd\u6210\u529f\u540e\uff0c\u6267\u884c <code>delete</code> \u6eda\u52a8\u8001\u5316\u5220\u9664\u4e00\u5929\u4e4b\u524d\uff08--min-age 24h\uff09\u7684\u65e7\u5907\u4efd\u3002</p> <p>Why not use filtering flag --max-age?</p> <p>\u5982\u679c\u6267\u884c sync \u6216 copy \u540c\u6b65\u76ee\u5f55\uff0c\u53ef\u4f7f\u7528 rclone \u63d0\u4f9b\u7684 <code>--max-age 2h</code> \u9009\u9879\u3002 \u8fd9\u91cc\u6267\u884c copyto \u547d\u4ee4\u5907\u4efd\u7279\u5b9a\u6587\u4ef6\uff0c\u4e0d\u9002\u7528 <code>--max-age</code> \u9009\u9879\uff0c\u6545\u81ea\u884c\u7b49\u6548\u5b9e\u73b0\u3002</p> rclone-sync-linkin-words.sh <pre><code>#!/usr/bin/env bash\n\n# predefined variables\nlogfile=\"/Users/faner/.config/rclone/rclone-$(date +%Y%m).log\"\nfilename=\"\u604b\u8bcd\u8003\u7814\u82f1\u8bed-\u5168\u771f\u9898\u6e90\u62a5\u520a7000\u8bcd-\u7d22\u5f15\u7ea2\u7248\"\nsrcfile=\"/Users/faner/Documents/English/LINKIN-WORDS-7000/$filename.pdf\"\ndstpath=\"smbhd@rpi4b:WDHD/backups/English\"\ndstfile=\"$dstpath/$filename-$(date +%Y%m%d%H).pdf\"\n\n# curdate=$(date +%Y/%m/%d\\ %H:%M:%S)\ncurdate_sec=\"$(date +%s)\"\n\nfiledate=$(date -r $srcfile +%Y/%m/%d\\ %H:%M:%S)\nfiledate_sec=\"$(date -r $srcfile +%s)\"\n\npassed_sec=$((curdate_sec - filedate_sec))\n\nelapsed_sec=$passed_sec\nelapsed_min=0\nelapsed_hour=0\nelapsed_day=0\n\n# calculate datediff\nif [ $elapsed_sec -ge 60 ]; then\n  elapsed_min=$((elapsed_sec / 60))\n  elapsed_sec=$((elapsed_sec % 60))\n  if [ $elapsed_min -ge 60 ]; then\n    elapsed_hour=$((elapsed_min / 60))\n    elapsed_min=$((elapsed_min % 60))\n    if [ $elapsed_hour -ge 24 ]; then\n      elapsed_day=$((elapsed_hour / 24))\n      elapsed_hour=$((elapsed_hour % 24))\n    fi\n  fi\nfi\n\n# format datediff\nelapsed_time=$(printf '%sd-%sh-%sm-%ss' \"$elapsed_day\" \"$elapsed_hour\" \"$elapsed_min\" \"$elapsed_sec\")\necho \"$(date +%Y/%m/%d\\ %H:%M:%S) DEBUG : $filename.pdf, modification: $filedate, $elapsed_time ago.\" &gt;&gt; \"$logfile\"\n\n# check copy during modification\ncheckpoint=$((passed_sec + 5)) # rewind for seconds\nlastcopy=$(/usr/local/bin/rclone lsf --max-age=$checkpoint $dstpath)\n# backupcount=$(/usr/local/bin/rclone lsf --max-age=$checkpoint $dstpath | wc -l)\n\n# check modification since last backup\nif [ ${#lastcopy} -ne 0 ]; then # remain unchanged\n  echo -e \"$(date +%Y/%m/%d\\ %H:%M:%S) DEBUG : retain latest backup: $lastcopy\\n\" &gt;&gt; \"$logfile\"\nelse # spotted gap\n  echo -e \"$(date +%Y/%m/%d\\ %H:%M:%S) DEBUG : execute backup to fill the gap.\" &gt;&gt; \"$logfile\"\n  if /usr/local/bin/rclone copyto -v \"$srcfile\" \"$dstfile\" --log-file=\"$logfile\"; then\n    /usr/local/bin/rclone delete -v \"$dstpath\" --min-age 24h --log-file=\"$logfile\"\n  else\n    echo -e \"$(date +%Y/%m/%d\\ %H:%M:%S) DEBUG : backup failed, keep old backups.\\n\" &gt;&gt; \"$logfile\"\n  fi\nfi\n</code></pre> <p>\u8c03\u8bd5\u9636\u6bb5\u53ef\u4ee5 <code>--dry-run</code> \u76f8\u5173 rclone \u540c\u6b65\u547d\u4ee4\uff0c\u5148\u5728\u7ec8\u7aef\u4ee5\u5f53\u524d\u8eab\u4efd\u6267\u884c rclone-sync-linkin-words.sh\uff0c\u786e\u4fdd\u8fd0\u884c\u548c\u8f93\u51fa\u7b26\u5408\u9884\u671f\u3002</p> <p>\u7136\u540e\uff0c\u518d\u5728 <code>crontab -e</code> \u4e2d\u914d\u7f6e\u8c03\u5ea6\u4efb\u52a1\uff0c\u5148\u6bcf\u5206\u949f\u6267\u884c\u4e00\u6b21\uff0c\u9a8c\u8bc1\u8c03\u5ea6\u6267\u884c\u60c5\u51b5\u3002</p> crontab -e test<pre><code>*/1 * * * * /usr/local/etc/scripts/rclone-sync-linkin-words.sh\n</code></pre> <p>cron \u8c03\u5ea6\u4efb\u52a1\u8c03\u8bd5\u9a8c\u8bc1 OK \u540e\uff0c\u518d\u4fee\u6539\u8c03\u5ea6\u9891\u7387\uff1a</p> crontab -e<pre><code># 1. \u672c\u5730\u540c\u6b65\u5230 SMB, \u6bcf\u9694\u4e24\u5c0f\u65f6\uff087,9,11,13,15,17,19,21,23\uff09\n0 7-23/2 * * * /usr/local/etc/scripts/rclone-sync-linkin-words.sh\n</code></pre> <p>\u4ee5\u4e0a\u811a\u672c\u6267\u884c rclone copyto\uff0ccopy from local to remote\uff08upload\uff09\uff0c\u8bfb\u672c\u5730\u5199\u8fdc\u7aef\uff0c\u4e0d\u6d89\u53ca\u672c\u5730\u5199\u78c1\u76d8\u6743\u9650\u95ee\u9898\u3002</p> <p>\u518d\u6dfb\u52a0\u4e00\u4e2a rclone sync \u540c\u6b65\u811a\u672c\uff0c\u5c06\u672c\u5730\u5f53\u524d\u7528\u6237\u7684 zsh\u3001vim\u3001vscode \u7684\u914d\u7f6e\u6bcf\u5929\u5907\u4efd\u5230\u5c40\u57df\u7f51 SMB \u5171\u4eab\u76d8\u4e0a\uff08smbhd@rpi4b:WDHD/backups/config\uff09\u3002</p> rclone-sync-config.sh <pre><code>#!/usr/bin/env bash\n\nbackup_config() {\n  # config filepath\n  config=$1\n  # folder=${config%/*}\n  filename=${config##*/}\n  name=${filename%.*}\n  ext=${filename##*.}\n\n  filedate=$(date -r \"$config\" +%Y%m%d)\n\n  if [ -z \"$name\" ]; then\n    dstfile=\"$dstpath/$host-$filedate.$ext\"\n  else\n    dstfile=\"$dstpath/$host-$filedate-$name.$ext\"\n  fi\n\n  # overwriting existing file, skipping identical files\n  # -u: Skip files that are newer on the destination\n  echo -e \"$(date +%Y/%m/%d\\ %H:%M:%S) DEBUG : execute backup $filename.\" &gt;&gt; \"$logfile\"\n  if /usr/local/bin/rclone copyto -v -u \"$config\" \"$dstfile\" --log-file=\"$logfile\"; then\n    echo -e \"$(date +%Y/%m/%d\\ %H:%M:%S) DEBUG : backup success.\\n\" &gt;&gt; \"$logfile\"\n  else\n    echo -e \"$(date +%Y/%m/%d\\ %H:%M:%S) DEBUG : backup failed, keep old backups/config.\\n\" &gt;&gt; \"$logfile\"\n  fi\n}\n\nmain() {\n  zshrc=\"/Users/faner/.zshrc\"\n  backup_config $zshrc\n  vimrc=\"/Users/faner/.vimrc\"\n  backup_config $vimrc\n  vscode_settings=\"/Users/faner/Library/Application Support/Code/User/settings.json\"\n  backup_config \"$vscode_settings\"\n}\n\n############################################################\n# main entry\n############################################################\n# echo \"param count = $#\"\n# echo \"params = $@\"\n\n# predefined variables\nlogfile=\"/Users/cliff/.config/rclone/rclone-$(date +%Y%m).log\"\ndstpath=\"smbhd@rpi4b:WDHD/backups/config\"\n\n# extract hostname, ignore domain\n# echo $HOST\nhostname=$(hostname)\nhost=${hostname%%.*}\n\nmain \"$@\" # $*\n</code></pre> <p>\u518d\u6dfb\u52a0\u4e00\u6761 rclone sync \u8c03\u5ea6\u4efb\u52a1\uff0c\u5c06\u8fdc\u7aef webdav \u4e91\u76d8\u5b9a\u65f6\u540c\u6b65\u5230\u672c\u5730\uff1a</p> crontab -e<pre><code># 1. \u672c\u5730\u914d\u7f6e\u540c\u6b65\u5230 SMB, @daily @midnight\n0 0 * * * /usr/local/etc/scripts/rclone-sync-config.sh\n\n# 2. \u672c\u5730\u6587\u4ef6\u540c\u6b65\u5230 SMB, \u6bcf\u9694\u4e24\u5c0f\u65f6\uff087,9,11,13,15,17,19,21,23\uff09\n0 7-23/2 * * * /usr/local/etc/scripts/rclone-sync-linking-words.sh\n\n# 3. webdav \u540c\u6b65\u5230\u672c\u5730, \u6bcf\u9694\u4e24\u5c0f\u65f6\uff088,10,12,14,16,18,20,22,0)\n0 0,8-23/2 * * * /usr/local/bin/rclone sync -v webdav@rpi4b: /Users/faner/Documents/webdav-backup --log-file=/Users/faner/.config/rclone/rclone-`date +\\%Y\\%m`.log\n</code></pre> <p>rclone sync from remote to local\uff08download\uff09\uff0c\u6d89\u53ca\u5199\u78c1\u76d8\u6743\u9650\u95ee\u9898\uff0c\u9700\u6309\u7167\u4e0a\u6587\u7684\u6b65\u9aa4\u6388\u6743 rclone \u5199\u78c1\u76d8\u6743\u9650\u3002</p>","tags":["rclone","crontab"]},{"location":"blog/20240318/cron-auto-rclone/#check_logs","title":"check logs","text":"<p>\u6bcf\u5929\u68c0\u67e5\u65e5\u5fd7\u6587\u4ef6\uff0c\u786e\u8ba4\u7cfb\u7edf cron \u5b9a\u65f6\u4efb\u52a1\u548c rclone sysnc \u540c\u6b65\u4efb\u52a1\u6267\u884c\u60c5\u51b5\u3002</p> <p>\u7cfb\u7edf\u65e5\u5fd7 /var/log/syslog \u4e2d\uff0c\u5e94\u8be5\u6709\u7c7b\u4f3c\u7684\u6761\u76ee\uff1a</p> <pre><code>$ grep -a CRON /var/log/syslog\nApr  7 02:30:00 rpi4b-ubuntu CRON[62328]: (pifan) CMD (rclone sync -v webdav-rpi4b: /media/WDHD/webdav@rpi4b --log-file=/home/pifan/.config/rclone/rclone.log)\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5f00\u542f cron \u72ec\u7acb\u65e5\u5fd7\uff0c\u540e\u7eed\u76f4\u63a5\u67e5\u770b /var/log/cron.log\u3002</p> <p>Use Independent Crontab Logs</p> <ol> <li><code>sudo vim /etc/rsyslog.d/50-default.conf</code></li> <li>uncomment the line starting with the <code>cron.*</code></li> <li><code>sudo systemctl restart rsyslog</code></li> </ol> <p>macOS \u7684\u7cfb\u7edf\u65e5\u5fd7 /var/log/system.log \u4e2d\u6ca1\u6709\u641c\u5230\u4efb\u4f55 cron \u76f8\u5173\u7684\u8fd0\u884c\u65e5\u5fd7\u3002</p> <p>\u53c2\u8003 macos - Mac OS X cron log / tracking\uff0c\u6267\u884c <code>log show --process cron</code> \u53ef\u4ee5\u770b\u5230 crontab/cron \u7684 Activity \u6d3b\u52a8\u65e5\u5fd7\u3002</p> <p>cron -x debugflag</p> <p>macos - Log of cron actions on OS X \u4e2d\u63d0\u5230\uff0c\u53c2\u8003 man cron \u4e2d\u7684 <code>-x debugflag</code>\uff0c\u53ef\u4fee\u6539 com.vix.cron.plist\uff0c\u4e3a ProgramArguments \u6dfb\u52a0 <code>-x</code> \u8c03\u8bd5\u9009\u9879\uff0c\u5e76\u914d\u7f6e StandardErrorPath \u4e3a /var/log/cron.log\u3002\u5c1a\u672a\u5177\u4f53\u5b9e\u8df5\u9a8c\u8bc1\u3002</p> <p>\u786e\u8ba4 cron \u5b9a\u65f6\u4efb\u52a1\u6267\u884c\u540e\uff0c\u518d\u68c0\u67e5\u914d\u7f6e\u76ee\u5f55 ~/.config/rclone/ \u4e0b\u5f53\u5929/\u6708\u7684\u8fd0\u884c\u65e5\u5fd7 rclone-<code>date</code>.log\uff0c\u67e5\u770b\u540c\u6b65\u60c5\u51b5\u3002</p>","tags":["rclone","crontab"]},{"location":"blog/20240318/cron-auto-rclone/#refs","title":"refs","text":"<p>\u8c03\u7814-\u5206\u5e03\u5f0f\u4efb\u52a1\u8c03\u5ea6\uff08CRONTAB\uff09 \u4f7f\u7528 RClone \u5b9e\u73b0 Unraid \u7684\u5f02\u5730\u5bb9\u707e \u4e00\u4e2a\u547d\u4ee4\u8ba9Linux\u5b9a\u65f6\u6253\u5305\u5907\u4efd\u6307\u5b9a\u76ee\u5f55\u6587\u4ef6\u5939\u5e76\u540c\u6b65\u5907\u4efd\u5230\u5404\u5927\u7f51\u76d8</p> <p>schedule using crontab on macOS Schedule job with crontab on macOS Linux Crontab: 15 Awesome Cron Job Examples</p> <p>\u8bb0\u5f55\u4e00\u6b21macOS\u4e0acrontab\u672a\u6210\u529f\u6267\u884c\u95ee\u9898\u7684\u6392\u67e5\u8fc7\u7a0b\uff01 macOS \u7535\u8111\u2014\u8bbe\u7f6e crontab</p> <p>online cron schedule expression generator:</p> <ul> <li>Cron Guru</li> <li>toolfk</li> <li>utils</li> </ul>","tags":["rclone","crontab"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/","title":"macOS\u91cd\u88c5nginx-full\u5e76\u914d\u7f6eWebDav","text":"<p>\u4e4b\u524d\u5728 macOS \u4e0a\u4f7f\u7528 brew \u5b89\u88c5\u8fc7 nginx\uff0c\u4f46\u662f\u7f3a\u4e4f webdav \u7684\u6269\u5c55\u652f\u6301\u6a21\u5757\u3002 \u4e3a\u4e86\u4f7f\u7528 nginx \u66ff\u6362 httpd \u6765\u642d\u5efa webDAV \u670d\u52a1\uff0c\u9700\u8981\u91cd\u65b0\u5b89\u88c5 nginx-full\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#installed_nginx","title":"installed nginx","text":"","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#which","title":"which","text":"<pre><code>$ which nginx\n/usr/local/bin/nginx\n\n$ readlink `which nginx`\n../Cellar/nginx/1.21.1/bin/nginx\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#brew_info","title":"brew info","text":"<p>\u6267\u884c <code>brew info nginx</code> \u547d\u4ee4\u53ef\u67e5\u770b nginx \u5b89\u88c5\u914d\u7f6e\u4fe1\u606f\uff1a</p> <ul> <li>Docroot: <code>/usr/local/var/www</code></li> <li>\u9ed8\u8ba4\u914d\u7f6e\uff1a<code>/usr/local/etc/nginx/nginx.conf</code></li> <li>\u9ed8\u8ba4\u7aef\u53e3\uff1a<code>8080</code></li> </ul> <pre><code>$ brew info nginx\n\n    Docroot is: /usr/local/var/www\n\n    The default port has been set in /usr/local/etc/nginx/nginx.conf to 8080 so that\n    nginx can run without sudo.\n\n    nginx will load all files in /usr/local/etc/nginx/servers/.\n\n    To restart nginx after an upgrade:\n      brew services restart nginx\n\n    Or, if you don't want/need a background service you can just run:\n      /usr/local/opt/nginx/bin/nginx -g daemon off;\n</code></pre> <p>\u53ef\u901a\u8fc7 brew services \u542f\u52a8\u670d\u52a1\uff0c\u6267\u884c <code>brew help services</code> \u53ef\u67e5\u770b\u670d\u52a1\u76f8\u5173\u63a7\u5236\u64cd\u4f5c\u3002</p> <ul> <li>[sudo] brew services [list]:</li> <li>[sudo] brew services info</li> <li>[sudo] brew services run</li> <li>[sudo] brew services start</li> <li>[sudo] brew services stop </li> <li>[sudo] brew services restart</li> </ul>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#nginx_-v","title":"nginx -V","text":"<p>\u5173\u4e8e nginx \u547d\u4ee4\u5e2e\u52a9\uff0c\u6267\u884c <code>nginx -h</code> \u6216 <code>man nginx</code>\u3002</p> <p>\u6267\u884c <code>nginx -V</code> \u53ef\u67e5\u770b\u8be6\u7ec6\u7684 configure arguments\uff0c\u5305\u62ec <code>prefix</code>\u3001<code>conf-path</code>\u3001<code>pid-path</code>\u3001<code>http-log-path</code> \u548c <code>error-log-path</code>\uff0c\u4ee5\u53ca\u4ee5 <code>with</code> \u5f00\u5934\u7684\u5df2\u5b89\u88c5\u7684\u6a21\u5757\uff08module\uff09\u3002</p> <p>nginx -V path</p> <p>\u9ed8\u8ba4\u5de5\u4f5c\u7a7a\u95f4\uff1a--prefix=/usr/local/Cellar/nginx/1.25.1_1 \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff1a--conf-path=/usr/local/etc/nginx/nginx.conf \u9ed8\u8ba4\u65e5\u5fd7\u8def\u5f84\uff1a</p> <ul> <li>--http-log-path=/usr/local/var/log/nginx/access.log</li> <li>--error-log-path=/usr/local/var/log/nginx/error.log</li> </ul> nginx -V details <pre><code>$ nginx -V\nnginx version: nginx/1.25.1\nbuilt by clang 13.0.0 (clang-1300.0.29.30)\nbuilt with OpenSSL 3.1.1 30 May 2023\nTLS SNI support enabled\nconfigure arguments: --prefix=/usr/local/Cellar/nginx/1.25.1_1 --sbin-path=/usr/local/Cellar/nginx/1.25.1_1/bin/nginx --with-cc-opt='-I/usr/local/opt/pcre2/include -I/usr/local/opt/openssl@3/include' --with-ld-opt='-L/usr/local/opt/pcre2/lib -L/usr/local/opt/openssl@3/lib' --conf-path=/usr/local/etc/nginx/nginx.conf --pid-path=/usr/local/var/run/nginx.pid --lock-path=/usr/local/var/run/nginx.lock --http-client-body-temp-path=/usr/local/var/run/nginx/client_body_temp --http-proxy-temp-path=/usr/local/var/run/nginx/proxy_temp --http-fastcgi-temp-path=/usr/local/var/run/nginx/fastcgi_temp --http-uwsgi-temp-path=/usr/local/var/run/nginx/uwsgi_temp --http-scgi-temp-path=/usr/local/var/run/nginx/scgi_temp --http-log-path=/usr/local/var/log/nginx/access.log --error-log-path=/usr/local/var/log/nginx/error.log --with-compat --with-debug --with-http_addition_module --with-http_auth_request_module --with-http_dav_module --with-http_degradation_module --with-http_flv_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_mp4_module --with-http_random_index_module --with-http_realip_module --with-http_secure_link_module --with-http_slice_module --with-http_ssl_module --with-http_stub_status_module --with-http_sub_module --with-http_v2_module --with-http_v3_module --with-ipv6 --with-mail --with-mail_ssl_module --with-pcre --with-pcre-jit --with-stream --with-stream_realip_module --with-stream_ssl_module --with-stream_ssl_preread_module\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#reinstall_nginx-full","title":"reinstall nginx-full","text":"<p>\u7531\u4e8e\u4f7f\u7528 macOS \u81ea\u5e26\u7684 Apache Httpd \u642d\u5efa\u7684 webDAV \u4f7f\u7528\u4f53\u9a8c\u4e0d\u592a\u7406\u60f3\uff0c\u56e0\u6b64\u8003\u8651\u6539\u7528 nginx \u642d\u5efa\u3002</p> <p>\u4f46\u662f\uff0c\u4e4b\u524d\u4f7f\u7528 brew \u5b89\u88c5\u7684 nginx \u53ea\u6709 http_dav \u6807\u51c6\u6a21\u5757\uff0c\u8be6\u89c1 <code>nginx -V</code> \u8f93\u51fa\u7684 <code>--with-http_dav_module</code>\u3002 \u8981\u60f3\u4f7f\u7528\u5b8c\u6574\u7684 webDAV \u670d\u52a1\uff0c\u8fd8\u5f97\u81ea\u884c\u5b89\u88c5 dav-ext \u6269\u5c55\u6a21\u5757\u3002</p> <ul> <li>The\u00a0nginx webdav module\u00a0only supports PUT, DELETE, MKCOL, COPY, and MOVE.</li> <li>The\u00a0dav_ext module\u00a0adds support for PROPFIND, OPTIONS, LOCK and UNLOCK.</li> </ul>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#brew_tap_denjihomebrew-nginx","title":"brew tap denji/homebrew-nginx","text":"<p>\u4e4b\u524d\u7684 homebrew/nginx \u8fd9\u4e2a tap \u5df2\u7ecf\u4e0d\u518d\u7ef4\u62a4\u4e86\uff0c\u6267\u884c <code>brew tap homebrew/nginx</code> \u5c06\u62a5\u9519\uff1a</p> <p>Error: <code>homebrew/nginx</code> was deprecated. This tap is now empty and all its contents were either deleted or migrated.</p> <p>\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528 <code>denji/homebrew-nginx</code> \u8fd9\u4e2a tap\uff0c\u6267\u884c<code>brew tap denji/homebrew-nginx</code> \u6dfb\u52a0\u6e90\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#brew_unlink_nginx","title":"brew unlink nginx","text":"<p>\u5728\u6b63\u5f0f\u5b89\u88c5 nginx \u4e4b\u524d\uff0c\u5148\u6267\u884c <code>brew unlink nginx</code> \u89e3\u9664\u5df2\u5b89\u88c5\u7684 nginx \u7684\u94fe\u63a5\uff1a</p> <p>What about conflicts?</p> <p>You are free to install this version alongside a current install of NGINX from\u00a0<code>Homebrew/homebrew</code>\u00a0if you wish. However, they cannot be linked at the same time. To switch between them use brew's built in linking system.</p> <pre><code>brew unlink nginx\nbrew link nginx-full\n</code></pre> <p>\u5728\u5b89\u88c5\u4e4b\u524d\uff0c\u53ef\u4ee5\u6267\u884c <code>brew info nginx-full</code> \u6216 <code>brew options nginx-full</code> \u67e5\u770b\u6709\u54ea\u4e9b\u5b89\u88c5\u9009\u9879\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#brew_install_nginx-full","title":"brew install nginx-full","text":"<p>\u7136\u540e\uff0c\u53c2\u8003 Update 'dav-ext-nginx-module.rb' from v0.1.0 to v3.0.0 \u00b7 Issue #362\uff0c\u6267\u884c brew install \u547d\u4ee4\uff0c\u6307\u5b9a\u9700\u8981\u5b89\u88c5\u7684\u6a21\u5757\uff1a</p> <ul> <li>\u79fb\u9664 --with-image-filter\uff0c\u6709\u4f9d\u8d56 --with-gd\uff1b\u8865\u5145\u6dfb\u52a0 --with-headers-more-module\uff0c\u540e\u9762 nginx \u914d\u7f6e\u4f1a\u7528\u5230\u3002</li> </ul> <pre><code>brew install nginx-full \\\n    --with-debug \\\n    --with-addition \\\n    --with-auth-req \\\n    --with-webdav \\\n    --with-dav-ext-module \\\n    --with-headers-more-module \\\n    --with-gunzip \\\n    --with-gzip-static \\\n    --with-realip \\\n    --with-slice \\\n    --with-status \\\n    --with-sub \\\n    --with-subs-filter-module \\\n    --with-http2 \\\n    --with-xslt \\\n    --with-mail \\\n    --with-mail-ssl \\\n    --with-pcre-jit \\\n    --with-stream \\\n    --with-stream-ssl \\\n    --with-stream-ssl-preread \\\n    --with-auth-pam-module \\\n    --with-echo-module\n</code></pre> <p>\u5b89\u88c5\u6210\u529f\u8f93\u51fa\u5982\u4e0b\uff0c\u4ece\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5230\u4e00\u4e9b\u6709\u7528\u7684\u5b89\u88c5\u914d\u7f6e\u4fe1\u606f\uff1a</p> Installing nginx-full from denji/nginx <pre><code>==&gt; Installing nginx-full from denji/nginx\n==&gt; ./configure --with-http_ssl_module --with-pcre --with-ipv6 --sbin-path=/usr/local/Cellar/nginx-full/1.25.4\n==&gt; make install\n==&gt; Caveats\nDocroot is: /usr/local/var/www\n\nThe default port has been set in /usr/local/etc/nginx/nginx.conf to 8080 so that\nnginx can run without sudo.\n\nnginx will load all files in /usr/local/etc/nginx/servers/.\n\n- Tips -\nRun port 80:\n $ sudo chown root:wheel /usr/local/opt/nginx-full/bin/nginx\n $ sudo chmod u+s /usr/local/opt/nginx-full/bin/nginx\nReload config:\n $ nginx -s reload\nReopen Logfile:\n $ nginx -s reopen\nStop process:\n $ nginx -s stop\nWaiting on exit process\n $ nginx -s quit\n\nTo start denji/nginx/nginx-full now and restart at startup:\n  sudo brew services start denji/nginx/nginx-full\nOr, if you don't want/need a background service you can just run:\n  /usr/local/opt/nginx-full/bin/nginx -g daemon\\ off\\;\n==&gt; Summary\n\ud83c\udf7a  /usr/local/Cellar/nginx-full/1.25.4: 9 files, 1.5MB, built in 45 seconds\n==&gt; Running `brew cleanup nginx-full`...\nDisable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.\nHide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`).\n</code></pre> <p>\u5b89\u88c5\u6210\u529f\u540e\uff0c\u6267\u884c <code>brew link nginx-full</code> \u63d0\u793a\u5df2\u7ecf\u81ea\u52a8\u94fe\u63a5\u4e0a\u4e86\u3002</p> <pre><code>brew link nginx-full\nWarning: Already linked: /usr/local/Cellar/nginx-full/1.25.4\nTo relink, run:\n  brew unlink nginx-full &amp;&amp; brew link nginx-full\n</code></pre> <p>\u540e\u7eed\u5982\u679c\u9700\u8981\u518d\u6b21\u91cd\u88c5\uff0c\u53ef\u6267\u884c <code>brew reinstall nginx-full ...</code> \u547d\u4ee4\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#nginx_-v_1","title":"nginx -V","text":"<p>\u91cd\u65b0\u6267\u884c <code>nginx -V</code>\uff0c\u68c0\u67e5\u662f\u5426\u5305\u542b\u4e86 webdav \u53ca\u5176\u6269\u5c55\u6a21\u5757\uff1a</p> <ul> <li>--with-http_dav_module</li> <li>--add-module=/usr/local/share/dav-ext-nginx-module</li> <li>--add-module=/usr/local/share/headers-more-nginx-module</li> </ul> nginx -V <pre><code>$ nginx -V\nnginx version: nginx/1.25.4\nbuilt by clang 15.0.0 (clang-1500.3.9.4)\nbuilt with OpenSSL 3.2.1 30 Jan 2024\nTLS SNI support enabled\nconfigure arguments: --prefix=/usr/local/Cellar/nginx-full/1.25.4 --with-http_ssl_module --with-pcre --with-ipv6 --sbin-path=/usr/local/Cellar/nginx-full/1.25.4/bin/nginx --with-cc-opt='-I/usr/local/include -I/usr/local/opt/pcre/include -I/usr/local/opt/openssl@3/include' --with-ld-opt='-L/usr/local/lib -L/usr/local/opt/pcre/lib -L/usr/local/opt/openssl@3/lib' --conf-path=/usr/local/etc/nginx/nginx.conf --pid-path=/usr/local/var/run/nginx.pid --lock-path=/usr/local/var/run/nginx.lock --http-client-body-temp-path=/usr/local/var/run/nginx/client_body_temp --http-proxy-temp-path=/usr/local/var/run/nginx/proxy_temp --http-fastcgi-temp-path=/usr/local/var/run/nginx/fastcgi_temp --http-uwsgi-temp-path=/usr/local/var/run/nginx/uwsgi_temp --http-scgi-temp-path=/usr/local/var/run/nginx/scgi_temp --http-log-path=/usr/local/var/log/nginx/access.log --error-log-path=/usr/local/var/log/nginx/error.log --with-http_addition_module --with-http_auth_request_module --with-debug --with-http_gunzip_module --with-http_gzip_static_module --with-http_v2_module --with-mail --with-mail_ssl_module --with-pcre-jit --with-http_realip_module --with-http_slice_module --with-http_stub_status_module --with-stream --with-stream_ssl_module --with-stream_ssl_preread_module --with-http_sub_module --with-http_dav_module --with-http_xslt_module --add-module=/usr/local/share/auth-pam-nginx-module --add-module=/usr/local/share/dav-ext-nginx-module --add-module=/usr/local/share/echo-nginx-module --add-module=/usr/local/share/headers-more-nginx-module --add-module=/usr/local/share/subs-filter-nginx-module\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#nginx_test","title":"nginx test","text":"","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#docroot","title":"Docroot","text":"<p>\u67e5\u770b Docroot <code>/usr/local/var/www/</code> \u6587\u4ef6\uff08\u5939\uff09\u5c5e\u6027\uff1a</p> <ul> <li>owner \u90fd\u662f\u5f53\u524d\u7528\u6237\uff1afaner:admin</li> </ul> <pre><code>$ ls -l /usr/local/var/\ntotal 0\ndrwxr-xr-x   3 faner  admin   96 May 13  2020 cache\ndrwxrwxr-x   4 faner  admin  128 May 28  2021 homebrew\ndrwxr-xr-x   3 faner  admin   96 Jan 22  2022 log\ndrwxr-xr-x  30 faner  admin  960 Mar  7  2021 mysql\ndrwxr-xr-x   4 faner  admin  128 Jan 28  2022 run\ndrwxr-xr-x   4 faner  admin  128 Dec 28  2021 www\n\n$ ls -l /usr/local/var/www/\ntotal 16\n-rw-r--r--  1 faner  admin  497 Dec 28  2021 50x.html\n-rw-r--r--  1 faner  admin  615 Dec 28  2021 index.html\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#nginx_-t","title":"nginx -t","text":"<p>nginx -t \u68c0\u6d4b\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff08/usr/local/etc/nginx/nginx.conf\uff09:</p> <pre><code>$ nginx -t\nnginx: the configuration file /usr/local/etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /usr/local/etc/nginx/nginx.conf test is successful\n</code></pre> <p>\u6267\u884c <code>nginx -T</code> \u67e5\u770b\u914d\u7f6e\u8be6\u60c5\uff1a</p> <pre><code>$ nginx -T\nnginx: the configuration file /usr/local/etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /usr/local/etc/nginx/nginx.conf test is successful\n# configuration file /usr/local/etc/nginx/nginx.conf:\n\n...\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#start_nginx","title":"start nginx","text":"<p>\u6309\u7167\u9ed8\u8ba4\u914d\u7f6e\u542f\u52a8 nginx\uff0c\u53ea\u9700\u8981\u6267\u884c <code>nginx</code> \u547d\u4ee4\u5373\u53ef\u3002</p> <p>\u6216\u8005\u6267\u884c <code>brew services start</code> \u542f\u52a8\u5e38\u9a7b\u670d\u52a1\uff1a</p> <pre><code>$ sudo brew services start denji/nginx/nginx-full\nWarning: Taking root:admin ownership of some nginx-full paths:\n  /usr/local/Cellar/nginx-full/1.25.4/bin\n  /usr/local/Cellar/nginx-full/1.25.4/bin/nginx\n  /usr/local/opt/nginx-full\n  /usr/local/opt/nginx-full/bin\n  /usr/local/var/homebrew/linked/nginx-full\nThis will require manual removal of these paths using `sudo rm` on\nbrew upgrade/reinstall/uninstall.\n==&gt; Successfully started `nginx-full` (label: homebrew.mxcl.nginx-full)\n</code></pre> <p>worker user</p> <p>\u6ce8\u610f\uff1asudo \u4ee5 root \u8eab\u4efd\u542f\u52a8 nginx \u7684 master process\uff0c\u7531\u4e8e nginx.conf \u4e2d\u672a\u6307\u5b9a user\uff0c\u9ed8\u8ba4\u4ee5 nobody \u542f\u52a8 worker progress\u3002\u6267\u884c <code>ps aux | grep nginx</code> \u53ef\u67e5\u770b nginx \u76f8\u5173\u8fdb\u7a0b\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#curl_localhost8080","title":"curl localhost:8080","text":"<p>\u6267\u884c <code>curl localhost:8080</code> \u8bf7\u6c42 web \u670d\u52a1\uff0c\u6b63\u5e38\u8fd4\u56de <code>Welcome to nginx!</code> \u6b22\u8fce\u9875\u9762\uff08/usr/local/var/www/index.html\uff09\uff1a</p> Welcome to nginx! <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Welcome to nginx!&lt;/title&gt;\n&lt;style&gt;\nhtml { color-scheme: light dark; }\nbody { width: 35em; margin: 0 auto;\nfont-family: Tahoma, Verdana, Arial, sans-serif; }\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;\n&lt;p&gt;If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.&lt;/p&gt;\n\n&lt;p&gt;For online documentation and support please refer to\n&lt;a href=\"http://nginx.org/\"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;\nCommercial support is available at\n&lt;a href=\"http://nginx.com/\"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#config_webdav","title":"config webdav","text":"<p>\u5b89\u88c5\u597d nginx \u540e\uff0c\u914d\u7f6e webdav \u670d\u52a1\u7684\u4e3b\u8981\u6d41\u7a0b\u548c httpd \u5dee\u4e0d\u591a\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#mkdir_for_webdav","title":"mkdir for webdav","text":"<p>nginx \u5b89\u88c5\u5b8c\u6210\u63d0\u793a\u7684 Docroot \u662f <code>/usr/local/var/www</code>\u3002</p> <p>\u5728\u5176\u540c\u7ea7\u521b\u5efa webdav \u5171\u4eab\u6587\u4ef6\u5939\uff1a<code>mkdir /usr/local/var/webdav</code>\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#htpasswd_add_user","title":"htpasswd add user","text":"<p>\u8fd9\u91cc\u4f7f\u7528 Basic \u8ba4\u8bc1\uff0c\u5177\u4f53\u914d\u7f6e\u53c2\u8003 Restricting Access with HTTP Basic Authentication\u3002</p> <pre><code>htpasswd -c /usr/local/etc/nginx/.htpasswd $username\nNew password:\nRe-type new password:\nAdding password for user $username\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#nginx_user","title":"nginx user","text":"<p>Nginx user \u914d\u7f6e\u5f15\u53d1\u7684\u8840\u6848 - \u5927\u8c61\u7b14\u8bb0 </p> <p>\u5c1d\u8bd5\u5728 nginx.conf \u4e2d\u4fee\u6539 user \u4e3a <code>_www _www</code>\uff0c\u590d\u7528 Apache Httpd \u7528\u6237\uff0c\u6267\u884c <code>nginx -t</code> \u68c0\u6d4b\u62a5\u9519\uff1a</p> <pre><code>nginx -t\nnginx: [warn] the \"user\" directive makes sense only if the master process runs with super-user privileges, ignored in /usr/local/etc/nginx/nginx.conf:3\nnginx: the configuration file /usr/local/etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /usr/local/etc/nginx/nginx.conf test is successful\n</code></pre> <p>nginx \u53ea\u6709\u8fd0\u884c\u4e8e root \u65f6\uff0c\u624d\u80fd\u5728 nginx.conf \u4e2d\u6307\u5b9a worker user\u3002</p> <p>\u6267\u884c <code>sudo brew services stop</code> \u505c\u6b62\u670d\u52a1\u540e\uff0c\u518d\u6267\u884c chown\uff1a</p> <pre><code> $ mkdir /usr/local/var/webdav\n $ sudo chown -R _www:_www /usr/local/var/webdav/\n</code></pre> <p>\u5728 nginx.conf \u4e2d\u8bbe\u7f6e <code>root /usr/local/var</code> \u6216\u6307\u5b9a alias \u4e3a <code>/usr/local/var/webdav/</code>\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#nginxconf","title":"nginx.conf","text":"<p><code>nginx -V</code> \u8f93\u51fa <code>--prefix=/usr/local/Cellar/nginx-full/1.25.4</code>\uff0c\u6b64\u4e3a macOS \u4e0b brew \u5b89\u88c5\u7684 nginx \u9ed8\u8ba4\u5de5\u4f5c\u7a7a\u95f4\u3002 \u6267\u884c <code>ls -l</code> \u53ef\u4ee5\u770b\u5230\u5176\u4e0b\u6709\u4e2a\u7b26\u53f7\u94fe\u63a5 html \u6307\u5411 <code>/usr/local/var/www</code>\uff0c\u6b64\u5373 Docroot\u3002</p> <pre><code>$ ls -l /usr/local/Cellar/nginx-full/1.25.4\n\nlrwxr-xr-x  1 faner  admin      16 Mar 24 09:10 html -&gt; ../../../var/www\n</code></pre> <p>nginx.conf \u4e2d\u9ed8\u8ba4\u6839\u8def\u5f84\u914d\u7f6e\u7684 root html \u6307\u5411 Docroot\uff0c\u540e\u7eed\u53ef\u6309\u9700\u6307\u5411\u81ea\u5df1\u7684\u7ad9\u70b9\u76ee\u5f55\u3002</p> <pre><code>            location / {\n                root html;\n                index index.html index.htm;\n            }\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#reuse_server","title":"reuse server","text":"<p>\u5728\u539f\u6709\u914d\u7f6e\u6587\u4ef6 <code>/usr/local/etc/nginx/nginx.conf</code> \u4e2d\u52a0\u5165\u65b0\u7684\u4e8c\u7ea7\u8def\u5f84\u6620\u5c04\u914d\u7f6e\uff1a</p> <p>#user  nobody; \u8868\u793a\u4ee5\u5f53\u524d\u7528\u6237\u542f\u52a8\u3002</p> <ol> <li>\u65b0\u589e dav_ext_lock_zone</li> <li>\u6307\u5b9a charset utf-8;</li> <li>\u65b0\u589e location /webdav</li> </ol> <p>\u5b8c\u6574\u7684 nginx.conf \u8bb0\u5f55\u5907\u5fd8\u5982\u4e0b\uff1a</p> nginx.conf: reuse 8080 for webdav /usr/local/etc/nginx/nginx.conf<pre><code>#user  nobody;\nuser   _www _www;\n\nhttp {\n    # config lock for macOS Client\n    dav_ext_lock_zone zone=webdav:10m;\n\n    server {\n        listen 8080;\n        server_name localhost;\n\n        #charset koi8-r;\n        # \u8bbe\u7f6e\u4f7f\u7528UTF-8\u7f16\u7801,\u9632\u6b62\u4e2d\u6587\u6587\u4ef6\u540d\u4e71\u7801\n        charset utf-8;\n\n        #access_log  logs/host.access.log  main;\n\n        location / {\n            root html;\n            index index.html index.htm;\n        }\n\n        location /webdav {\n            # webdav \u5171\u4eab\u670d\u52a1\u76ee\u5f55\uff08\u53ef\u8003\u8651\u653e\u5728 opt/ \u4e0b\uff09\n            ## \u8bf7\u6ce8\u610f chown \u4e3a nginx worker \u7528\u6237 _www:_www\n            root /usr/local/var;\n            # alias /usr/local/var/webdav;\n\n            # webdav \u7528\u6237(_www)\u7684\u9ed8\u8ba4\u6743\u9650\n            dav_access user:rw group:rw all:r;\n\n            # auth_basic \u53c2\u6570\u88ab\u7528\u4f5c\u57df\uff0c\u5e76\u5728\u6388\u6743\u5f39\u7a97\u4e2d\u663e\u793a\u3002\n            auth_basic \"webdav\";\n            # htpasswd \u7528\u6237\u5bc6\u7801\u6587\u4ef6\u5b58\u653e\u7684\u4f4d\u7f6e\n            auth_basic_user_file /usr/local/etc/nginx/.htpasswd;\n\n            # webdav \u53ca ext \u5141\u8bb8\u7684\u64cd\u4f5c\n            dav_methods PUT DELETE MKCOL COPY MOVE;\n            dav_ext_methods PROPFIND OPTIONS LOCK UNLOCK;\n            dav_ext_lock zone=webdav;\n\n            # \u5f00\u542f\u652f\u6301\u76ee\u5f55\u6d4f\u89c8\u529f\u80fd\n            autoindex on;\n            # \u663e\u793a\u51fa\u6587\u4ef6\u7684\u5927\u6982\u5927\u5c0f\uff0c\u5355\u4f4d\u662fKB\u6216\u8005MB\u6216\u8005GB\n            autoindex_exact_size off;\n\n            # \u542f\u7528\u5b8c\u6574\u7684\u521b\u5efa\u76ee\u5f55\u652f\u6301\n            ## \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cPUT\u65b9\u6cd5\u53ea\u80fd\u5728\u5df2\u5b58\u5728\u7684\u76ee\u5f55\u91cc\u521b\u5efa\u6587\u4ef6\n            create_full_put_path on;\n\n            # \u4e34\u65f6\u7f13\u5b58\u6587\u4ef6\u4f4d\u7f6e\n            client_body_temp_path /tmp;\n\n            # \u6700\u5927\u4e0a\u4f20\u6587\u4ef6\u9650\u5236, 0\u8868\u793a\u65e0\u9650\u5236\n            client_max_body_size 4G;\n\n            ########################################\n            # \u4e3a\u5404\u79cd\u65b9\u6cd5\u7684URI\u540e\u52a0\u4e0a\u659c\u6760\uff0c\u89e3\u51b3\u5404\u5e73\u53f0webdav\u5ba2\u6237\u7aef\u7684\u517c\u5bb9\u6027\u95ee\u9898\n            ########################################\n\n            # issue: ngx_http_dav_module.c \u5224\u65ad MKCOL \u6307\u4ee4\u7684 URI \u5fc5\u987b\u4ee5 / \u7ed3\u5c3e\n            # \u6ce8\u610f\uff1a\u5982\u679c\u662f alias\uff0c\u6ce8\u610f\u8c03\u6574 rewrite \u8def\u5f84\uff0c\u6216\u6362\u6210 root\uff01\n            if ($request_method ~ MKCOL) {\n                rewrite ^(.*[^/])$ $1/ break;\n            }\n\n            # issue: ngx_http_dav_module.c \u5224\u65ad MOVE \u6307\u4ee4\u7684 URI \u548c Destination URI \u7ed3\u5c3e\u7684 / \u5fc5\u987b\u5339\u914d\n            # scenario: MOVE \u6587\u4ef6\u5939 Destination URI \u672a\u4ee5 / \u7ed3\u5c3e: /webdav/test/ --&gt; /webdav/test2\n            # error log: both URI and \"Destination\" URI should be either collections or non-collections\n            set $dest $http_destination;\n            if (-d $request_filename) {\n                rewrite ^(.*[^/])$ $1/;\n                set $dest $dest/;\n            }\n\n            # \u9700\u8981\u5b89\u88c5 headers-more module\n            if ($request_method ~ (MOVE|COPY)) {\n                more_set_input_headers 'Destination: $dest';\n            }\n\n        }\n\n        # Bonus: Stopping Finder's Garbage\n        # https://www.robpeck.com/2020/06/making-webdav-actually-work-on-nginx/\n        location ~ \\.(_.*|DS_Store|Spotlight-V100|TemporaryItems|Trashes|hidden|localized)$ {\n            access_log off;\n            error_log off;\n\n            if ($request_method = PUT) {\n                return 403;\n            }\n            return 404;\n        }\n\n        location ~ \\.metadata_never_index$ {\n            return 200 \"Don't index this drive, Finder!\";\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page 500 502 503 504 /50x.html;\n        location = /50x.html {\n            root html;\n        }\n\n    }\n\n}\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#config_new_server","title":"config new server","text":"<p>\u65e0\u8bba\u662f brew info \u8fd8\u662f brew install \u8f93\u51fa\u7684\u4fe1\u606f\u4e2d\uff0c\u90fd\u6709\u4e00\u53e5\uff1a</p> <p>nginx will load all files in /usr/local/etc/nginx/servers/.</p> <p>\u9ed8\u8ba4\u914d\u7f6e nginx.conf \u6700\u540e\u6709\u4e00\u53e5 <code>include servers/*</code>\uff0c\u610f\u601d\u662f\u4f1a\u52a0\u8f7d servers \u4e0b\u7684\u6240\u6709\u914d\u7f6e\uff1a</p> /usr/local/etc/nginx/nginx.conf<pre><code>http {\n\n    # HTTPS server\n    #\n    include servers/*;\n}\n</code></pre> <p>\u56e0\u6b64\uff0c\u53ef\u4ee5\u4fdd\u7559\u9ed8\u8ba4\u7684 nginx.conf(.default)\uff0c\u5728 servers \u4e0b\u65b0\u5efa webdav.conf\uff0c\u65b0\u5efa\u4e00\u4e2a server \u76d1\u542c\u7aef\u53e3 81 \u4e13\u7528\u4e8e webdav \u670d\u52a1\u3002</p> <p>\u5b8c\u6574\u7684 webdav.conf \u8bb0\u5f55\u5907\u5fd8\u5982\u4e0b\uff1a</p> webdav.conf: listen 81 /usr/local/etc/nginx/servers/webdav.conf<pre><code># config lock for macOS Client\ndav_ext_lock_zone zone=webdav:10m;\n\nserver {\n    listen 81;\n    server_name localhost;\n\n    # \u8bbe\u7f6e\u4f7f\u7528UTF-8\u7f16\u7801,\u9632\u6b62\u4e2d\u6587\u6587\u4ef6\u540d\u4e71\u7801\n    charset utf-8;\n\n    error_log /usr/local/var/log/nginx/webdav.error.log error;\n    access_log /usr/local/var/log/nginx/webdav.access.log combined;\n\n    # [nginx\u4e0d\u6d4f\u89c8\u76f4\u63a5\u4e0b\u8f7d\u6587\u4ef6](https://www.cnblogs.com/oxspirt/p/10250744.html)\n    location / {\n        # \u8fd9\u91cc\u5148\u63d0\u4f9b\u9ed8\u8ba4\u9875\u9762\uff0c\u540e\u9762\u6309\u9700\u63d0\u4f9bwebsite\u8def\u5f84\n        root html; # prefix/html symlink to /usr/local/var/www\n        index index.html index.htm;\n\n        if ($request_filename ~* ^.*?\\.(txt|doc|pdf|rar|gz|zip|docx|exe|xlsx|ppt|pptx)$) {\n            add_header Content-Disposition: 'attachment;';\n        }\n    }\n\n    location /webdav {\n        # webdav \u5171\u4eab\u670d\u52a1\u76ee\u5f55\uff08\u53ef\u8003\u8651\u653e\u5728 opt/ \u4e0b\uff09\n        ## \u8bf7\u6ce8\u610f chown \u4e3a nginx worker \u7528\u6237 _www:_www\n        root /usr/local/var;\n        # alias /usr/local/var/webdav;\n\n        # webdav \u7528\u6237(_www)\u7684\u9ed8\u8ba4\u6743\u9650\n        dav_access user:rw group:rw all:r;\n\n        # auth_basic \u53c2\u6570\u88ab\u7528\u4f5c\u57df\uff0c\u5e76\u5728\u6388\u6743\u5f39\u7a97\u4e2d\u663e\u793a\u3002\n        auth_basic \"webdav\";\n        # htpasswd \u7528\u6237\u5bc6\u7801\u6587\u4ef6\u5b58\u653e\u7684\u4f4d\u7f6e\n        auth_basic_user_file /usr/local/etc/nginx/.htpasswd;\n\n        # webdav \u53ca ext \u5141\u8bb8\u7684\u64cd\u4f5c\n        dav_methods PUT DELETE MKCOL COPY MOVE;\n        dav_ext_methods PROPFIND OPTIONS LOCK UNLOCK;\n        dav_ext_lock zone=webdav;\n\n        # \u5f00\u542f\u652f\u6301\u76ee\u5f55\u6d4f\u89c8\u529f\u80fd\n        autoindex on;\n        # \u663e\u793a\u51fa\u6587\u4ef6\u7684\u5927\u6982\u5927\u5c0f\uff0c\u5355\u4f4d\u662fKB\u6216\u8005MB\u6216\u8005GB\n        autoindex_exact_size off;\n\n        # \u542f\u7528\u5b8c\u6574\u7684\u521b\u5efa\u76ee\u5f55\u652f\u6301\n        ## \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cPUT\u65b9\u6cd5\u53ea\u80fd\u5728\u5df2\u5b58\u5728\u7684\u76ee\u5f55\u91cc\u521b\u5efa\u6587\u4ef6\n        create_full_put_path on;\n\n        # \u4e34\u65f6\u7f13\u5b58\u6587\u4ef6\u4f4d\u7f6e\n        client_body_temp_path /tmp;\n\n        # \u6700\u5927\u4e0a\u4f20\u6587\u4ef6\u9650\u5236, 0\u8868\u793a\u65e0\u9650\u5236\n        client_max_body_size 4G;\n\n        ########################################\n        # \u4e3a\u5404\u79cd\u65b9\u6cd5\u7684URI\u540e\u52a0\u4e0a\u659c\u6760\uff0c\u89e3\u51b3\u5404\u5e73\u53f0webdav\u5ba2\u6237\u7aef\u7684\u517c\u5bb9\u6027\u95ee\u9898\n        ########################################\n\n        # issue: ngx_http_dav_module.c \u5224\u65ad MKCOL \u6307\u4ee4\u7684 URI \u5fc5\u987b\u4ee5 / \u7ed3\u5c3e\n        # \u6ce8\u610f\uff1a\u5982\u679c\u662f alias\uff0c\u6ce8\u610f\u8c03\u6574 rewrite \u8def\u5f84\uff0c\u6216\u6362\u6210 root\uff01\n        if ($request_method ~ MKCOL) {\n            rewrite ^(.*[^/])$ $1/ break;\n        }\n\n        # issue: ngx_http_dav_module.c \u5224\u65ad MOVE \u6307\u4ee4\u7684 URI \u548c Destination URI \u7ed3\u5c3e\u7684 / \u5fc5\u987b\u5339\u914d\n        # scenario: MOVE \u6587\u4ef6\u5939 Destination URI \u672a\u4ee5 / \u7ed3\u5c3e: /webdav/test/ --&gt; /webdav/test2\n        # error log: both URI and \"Destination\" URI should be either collections or non-collections\n        set $dest $http_destination;\n        if (-d $request_filename) {\n            rewrite ^(.*[^/])$ $1/;\n            set $dest $dest/;\n        }\n\n        # \u9700\u8981\u5b89\u88c5 headers-more module\n        if ($request_method ~ (MOVE|COPY)) {\n            more_set_input_headers 'Destination: $dest';\n        }\n\n    }\n\n    # Bonus: Stopping Finder's Garbage\n    # https://www.robpeck.com/2020/06/making-webdav-actually-work-on-nginx/\n    location ~ \\.(_.*|DS_Store|Spotlight-V100|TemporaryItems|Trashes|hidden|localized)$ {\n        access_log off;\n        error_log off;\n\n        if ($request_method = PUT) {\n            return 403;\n        }\n        return 404;\n    }\n\n    location ~ \\.metadata_never_index$ {\n        return 200 \"Don't index this drive, Finder!\";\n    }\n\n    #error_page  404              /404.html;\n\n    # redirect server error pages to the static page /50x.html\n    #\n    error_page 500 502 503 504 /50x.html;\n    location = /50x.html {\n        root html;\n    }\n}\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#restart_nginx_server","title":"restart nginx server","text":"<p>\u6bcf\u6b21\u4fee\u6539\u4e86 nginx \u914d\u7f6e\u6587\u4ef6\uff0c\u9700\u8981\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\uff08\u6216\u91cd\u542f\u670d\u52a1\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ol> <li><code>sudo nginx -s reload</code></li> <li><code>sudo brew services restart denji/nginx/nginx-full</code></li> </ol> <p>How to stop nginx service?</p> <pre><code>$ sudo nginx -s stop\n# keep registered\n$ sudo brew services kill denji/nginx/nginx-full\n# unregister\n$ sudo brew services stop denji/nginx/nginx-full\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#webdav_test","title":"webdav test","text":"<p>\u5173\u4e8e webdav \u7684\u8fde\u63a5\u6d4b\u8bd5\uff0c\u53c2\u8003 macOS\u4e0a\u57fa\u4e8ehttpd\u642d\u5efaWebDav\u670d\u52a1 - \u5c40\u57df\u7f51\u8fde\u63a5\u9a8c\u8bc1WebDAV\u670d\u52a1 \u548c \u4f7f\u7528\u547d\u4ee4\u884c\u6302\u8f7d\u64cd\u4f5cWebDAV\u4e91\u76d8 \u4e2d\u7684\u76f8\u5173\u8bf4\u660e\u3002</p> <ol> <li>\u6267\u884c curl localhost:81 \u9a8c\u8bc1 web \u670d\u52a1\u662f\u5426\u6b63\u5e38\uff1b</li> <li>WebDAV \u5ba2\u6237\u7aef\u8bbf\u95ee http://mbpa1398.local:81/webdav/ \u9a8c\u8bc1 webDAV \u670d\u52a1\u662f\u5426\u6b63\u5e38\u3002</li> </ol> <p>\u8c03\u8bd5\u671f\u95f4\uff0c\u53ef\u5728 nginx \u670d\u52a1\u5668\u6267\u884c <code>tail -f /usr/local/var/log/nginx/webdav.error.log</code> \u5b9e\u65f6\u67e5\u770b\u6eda\u52a8\u65e5\u5fd7\u3002</p> <p>webdav \u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u4ea7\u751f\u4e00\u4e9b cache \u6587\u4ef6\uff0c\u53ef\u4f7f\u7528 find \u547d\u4ee4\u67e5\u627e\u5e76\u6309\u9700\u6267\u884c -delete \u5220\u9664\uff1a</p> macOS cachewebdav cache <pre><code>$ find /usr/local/var/webdav/ -type f -name \"._*\" -o -name \"*.DS_Store\"\n</code></pre> <pre><code>$ find /usr/local/var/webdav/ -type f -name \".DAV\" -o -name \".*.swp\"\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/mac-install-nginx-full-config-webdav/#refs","title":"refs","text":"<p>\u4fee\u590dNginx\u7684WebDAV\u529f\u80fd</p> <ol> <li>\u4fee\u6539\u6e90\u4ee3\u7801\u81ea\u5df1\u7f16\u8bd1</li> <li>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 rewrite</li> </ol> <p>Nginx webdav \u5728 Dolphin \u4e0a\u7684\u4e00\u4e9b\u5751</p> <ol> <li>\u65e0\u6cd5\u4e0a\u4f20\u5927\u6587\u4ef6(\u72b6\u6001\u7801: 413)</li> <li>\u65e0\u6cd5\u521b\u5efa\u6587\u4ef6\u5939(\u72b6\u6001\u7801: 409)</li> <li>\u65e0\u6cd5\u5220\u9664\u6587\u4ef6\u5939(\u72b6\u6001\u7801: 409)</li> <li>\u65e0\u6cd5\u590d\u5236/\u79fb\u52a8\u6587\u4ef6\u5939(\u72b6\u6001\u7801: 409) - headers-more-nginx-module</li> </ol>","tags":["nginx","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/","title":"macOS\u4e0a\u57fa\u4e8ehttpd\u642d\u5efaWebDav\u670d\u52a1","text":"<p>\u5728\u5c40\u57df\u7f51\u4e2d\uff0c\u8981\u60f3\u5171\u4eab\u6216\u8bbf\u95ee macOS \u673a\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u901a\u8fc7\u6587\u4ef6\u5171\u4eab\u3001\u5c4f\u5e55\u5171\u4eab\u6216 \u8fdc\u7a0b\u767b\u5f55 \u8fd9\u51e0\u79cd\u65b9\u5f0f\uff1a</p> <ol> <li>FS\uff08SMB\uff09: Set up file sharing on Mac\uff0cControl access to your Public folder on Mac\u3002</li> <li>SSH+SFTP: Allow a remote computer to access your Mac</li> <li>Screen Sharing\uff08VNC\uff09: Turn Mac screen sharing on or off\uff0cShare the screen of another Mac\u3002</li> <li>RD: Enable remote management for Remote Desktop</li> </ol> <p>FS \u6a21\u5f0f\u4e00\u822c\u9ed8\u8ba4\u5f00\u653e\u7ed9 everyone \u53ea\u8bfb\uff0c\u53ef\u4ee5\u4ee5 Guest User \u8eab\u4efd\u514d\u767b\u5f55\u8bbf\u95ee\uff0c\u4f46\u662f\u4e00\u65e6\u6d89\u53ca\u5230\u8981\u5f00\u653e\u5199\u6743\u9650\uff0c\u4f1a\u6d89\u53ca\u5230\u7cfb\u7edf\u8d26\u6237\u5206\u7ea7\u5206\u7ec4\u7ba1\u7406\u548cACL\u6743\u9650\u63a7\u5236\u548c\u5206\u914d\u7c92\u5ea6\u95ee\u9898\u3002\u5c40\u57df\u7f51\u5185\u600e\u4e48\u6837\u90e8\u7f72\u7b80\u6613\u8f7b\u91cf\u7684\u5171\u4eab\u540c\u6b65\u5b58\u50a8\u7cfb\u7edf\u5462\uff1f</p> <p>\u5728\u591a\u7ec8\u7aef\u8bbe\u5907\u65f6\u4ee3\uff0c\u5f88\u591a\u4eba\u90fd\u8d2d\u4e70\u4e86\u5728\u7ebf\u7f51\u7edc\u4e91\u76d8\u670d\u52a1\uff0c\u6216\u8005\u81ea\u5df1\u52a8\u624bDIY\u642d\u5efa\u90e8\u7f72\u5bb6\u5ead\u5c40\u57df\u7f51NAS\u79c1\u6709\u4e91\u670d\u52a1\u5668\uff0c\u4f5c\u4e3a\u5bb6\u91cc\u7684\u6570\u636e\u548c\u5f71\u97f3\u4e2d\u5fc3\uff0c\u65b9\u4fbf\u6587\u4ef6\u5171\u4eab\u548c\u5b58\u50a8\u5907\u4efd\u540c\u6b65\u3002\u53e6\u4e00\u4e2a\u65e5\u76ca\u589e\u957f\u7684\u9700\u6c42\u5c31\u662f\u5206\u5e03\u5f0f\u534f\u4f5c\uff0cGoogle\u6587\u6863\u3001\u817e\u8baf\u6587\u6863\u7b49\u4ea7\u54c1\u5c31\u662f\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\u7684\u5728\u7ebf\u534f\u540c\u7f16\u8f91\u7684\u529e\u516c\u8f6f\u4ef6\u3002</p> <p>\u65e9\u57281996\u5e74\uff0c\u52a0\u5dde\u5927\u5b66\u5c14\u6e7e\u5206\u6821\u535a\u58eb\u6bd5\u4e1a\u751fJim Whitehead\u5c31\u4e0eW3C\u5171\u540c\u4e3b\u529e\u4e86\u4e24\u573a\u4f1a\u8bae\u8ba8\u8bba\u4e86\u4e07\u7ef4\u7f51\u4e0a\u7684\u5206\u5e03\u5f0f\u521b\u4f5c\u95ee\u9898\uff0c\u5e76\u6210\u7acb\u4e86WebDAV\u5de5\u4f5c\u5c0f\u7ec4\u3002</p> <p>WebDAV wiki</p> <p>WebDAV \u662f Web-based Distributed Authoring and Versioning \u7684\u7f29\u5199\uff0c\u5373\u57fa\u4e8eWeb\u7684\u5206\u5e03\u5f0f\u7f16\u5199\u548c\u7248\u672c\u63a7\u5236\u3002\u5b83\u662f\u5bf9 HTTP \u7684\u6269\u5c55\uff0c\u4e3a\u7528\u6237\u5728\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u3001\u66f4\u6539\u548c\u79fb\u52a8\u6587\u6863\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6846\u67b6\uff0c\u65b9\u4fbf\u7528\u6237\u95f4\u534f\u540c\u7f16\u8f91\u548c\u7ba1\u7406\u5b58\u50a8\u5728\u4e07\u7ef4\u7f51\u670d\u52a1\u5668\u4e0a\u7684\u6587\u6863\u3002</p> <p>\u56e0\u4e3a\u57fa\u4e8eHTTP\uff0cWebDAV \u5728\u5e7f\u57df\u7f51\u4e0a\u5171\u4eab\u6587\u4ef6\u6709\u5929\u7136\u7684\u4f18\u52bf\uff0c\u79fb\u52a8\u7aef\u6587\u4ef6\u7ba1\u7406APP\u5927\u591a\u90fd\u652f\u6301WebDAV\u534f\u8bae\uff0c\u4f7f\u7528HTTPS\u8fd8\u80fd\u4fdd\u5b89\u5168\u6027\u3002\u5fae\u8f6f\u7684Office\u548c\u81ea\u5bb6Sharepoint\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u82f9\u679c\u7684iWork\u5957\u4ef6\u4e5f\u662f\u57fa\u4e8eWebDAV\u3002Apache\u548cNginx\u90fd\u6269\u5c55\u652f\u6301WebDAV\uff0c\u53ef\u4f5c\u4e3aWebDAV\u6587\u4ef6\u5171\u4eab\u670d\u52a1\u5668\u8f6f\u4ef6\u3002</p> <p>\u672c\u6587\u8bb0\u5f55\u4e86\u5728 macOS \u4e0a\u57fa\u4e8e\u5185\u7f6e\u7684 Apache Httpd \u642d\u5efa WebDAV \u670d\u52a1\u7684\u6b65\u9aa4\u6d41\u7a0b\uff0c\u4ee5\u4f9b\u5907\u5fd8\u548c\u53c2\u8003\u3002</p>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u914d\u7f6e_apache_httpd","title":"\u914d\u7f6e Apache httpd","text":"<p>Apache Httpd \u914d\u7f6e\u6587\u4ef6\uff1a<code>/etc/apache2/httpd.conf</code>\u3002</p> <pre><code>$ cd /etc/apache2/\n//  \u5907\u4efd\u6587\u4ef6\uff0c\u4ee5\u9632\u4e0d\u6d4b\n$ sudo cp httpd.conf httpd.conf.bak\n$ sudo vim httpd.conf\n</code></pre> <p>\u5176\u4e2d\u5b9a\u4e49\u4e86\u9ed8\u8ba4\u7684\u6587\u6863\u670d\u52a1\u76ee\u5f55\uff1a</p> /etc/apache2/httpd.conf<pre><code>DocumentRoot \"/Library/WebServer/Documents\"\n&lt;Directory \"/Library/WebServer/Documents\"&gt;\n</code></pre>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u4fee\u6539_servername","title":"\u4fee\u6539 ServerName","text":"<p>macOS \u4e0a\u53ef\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u53d6\u4e3b\u673a\u540d\uff1a</p> <ul> <li>hostname</li> <li>scutil --get ComputerName</li> <li>scutil --get LocalHostName</li> </ul> <p>\u641c\u7d22 ServerName \u6ce8\u91ca\u884c\uff0c\u8bbe\u7f6e\u4e0e\u4e3b\u673a\u540d\u79f0\u4e00\u81f4</p> <pre><code>ServerName mbpa1398:80\n</code></pre>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u542f\u52a8\u9a8c\u8bc1_httpd_\u670d\u52a1","title":"\u542f\u52a8\u9a8c\u8bc1 httpd \u670d\u52a1","text":"<p>\u7531\u4e8e\u5c1a\u672a\u914d\u7f6e webdav \u6269\u5c55\u670d\u52a1\uff0c\u6682\u65f6\u5148\u4e0d\u7ba1 webDAV \u670d\u52a1\uff0c\u5148\u628a httpd server \u8dd1\u8d77\u6765\u3002</p> <p>wfsctl should be disabled</p> <p>\u8bf7\u5148\u6267\u884c <code>wfsctl status</code> \u547d\u4ee4\u68c0\u67e5 wfsctl \u662f\u5426\u4e3a\u7981\u7528\u72b6\u6001\uff1a</p> <pre><code>$ sudo wfsctl status\ndisabled\n</code></pre> <p>\u5982\u679c\u5426\uff0c\u8bf7\u6267\u884c <code>sudo wfsctl stop</code> \u505c\u6b62\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u6709\u7aef\u53e3\u51b2\u7a81\u7b49\u95ee\u9898\u5bfc\u81f4\u540e\u7eed\u65e0\u6cd5\u8bbf\u95ee\u3002</p> <p>\u6267\u884c <code>sudo apachectl -k start</code> \u542f\u52a8 Apache Httpd \u670d\u52a1\uff0c\u7136\u540e\u5728\u672c\u5730\u547d\u4ee4\u884c\u8f93\u5165 <code>curl localhost</code>\uff0c\u6b63\u5e38\u5e94\u8fd4\u56de DocumentRoot \u4e0b\u7684 index.html.en \u9875\u9762\uff1a</p> <pre><code>&lt;html&gt;&lt;body&gt;&lt;h1&gt;It works!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre> <p>\u6216\u5728\u6d4f\u89c8\u5668\u8f93\u5165 http://localhost \u6216 http://mbpa1398.local \u770b\u770b\u662f\u5426\u6b63\u5e38\u8f93\u51fa <code>It works!</code> \u3002</p> <p>Stopping and Restarting Apache HTTP Server - Apache HTTP Server Version 2.4</p>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u542f\u7528_dav_\u6269\u5c55\u670d\u52a1\u914d\u7f6e","title":"\u542f\u7528 Dav \u6269\u5c55\u670d\u52a1\u914d\u7f6e","text":"<p>\u79fb\u9664\u4ee5\u4e0b\u914d\u7f6e\u6587\u4ef6\u4e2d 5 \u884c\u884c\u9996\u7684\u6ce8\u91ca\uff1a</p> /etc/apache2/httpd.conf<pre><code> 92 #LoadModule auth_digest_module libexec/apache2/mod_auth_digest.so\n165 #LoadModule dav_module libexec/apache2/mod_dav.so\n176 #LoadModule dav_fs_module libexec/apache2/mod_dav_fs.so\n177 #LoadModule dav_lock_module libexec/apache2/mod_dav_lock.so\n\n533 #Include /private/etc/apache2/extra/httpd-dav.conf\n</code></pre> <ol> <li>LoadModule \u52a0\u8f7d mod_dav \u76f8\u5173\u7684\u4e09\u4e2a\u52a8\u6001\u5e93\u548c\u7528\u4e8e digest auth  \u9a8c\u8bc1\u7684\u52a8\u6001\u5e93\u3002</li> <li>Include \u5305\u542b\uff08\u5f15\u5165\uff09dav \u6269\u5c55\u670d\u52a1\u914d\u7f6e\uff08extra/httpd-dav.conf\uff09\u3002</li> </ol> <p>\u5982\u679c\u4f7f\u7528\u9ed8\u8ba4\u7684\u8ba4\u8bc1\u65b9\u5f0f AuthType Digest\uff0c\u5219\u9700\u52a0\u8f7d mod_auth_digest.so\u3002 \u5982\u679c\u6539\u4e3a Basic\uff0c\u9ed8\u8ba4\u5df2\u7ecf\u52a0\u8f7d\u4e86 mod_auth_basic.so\uff0c\u65e0\u9700\u52a0\u8f7d mod_auth_digest.so\u3002</p>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u914d\u7f6e_httpd_\u6269\u5c55_dav_\u670d\u52a1","title":"\u914d\u7f6e httpd \u6269\u5c55 Dav \u670d\u52a1","text":"<p>Httpd \u7684 Dav \u6269\u5c55\u670d\u52a1\u914d\u7f6e\u6587\u4ef6\uff1a/etc/apache2/extra/httpd-dav.conf\u3002</p> <pre><code>$ cd extra\n# \u5907\u4efd\u914d\u7f6e\u6587\u4ef6\n$ sudo cp httpd-dav.conf httpd-dav.conf.bak\n# \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\n$ sudo vim httpd-dav.conf\n</code></pre>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u8bbe\u7f6e\u5171\u4eab\u76ee\u5f55\u6587\u4ef6\u5939","title":"\u8bbe\u7f6e\u5171\u4eab\u76ee\u5f55\u6587\u4ef6\u5939","text":"<p>macOS \u4e0b\u81ea\u5e26\u7684 Apache Httpd \u670d\u52a1\u7684\u7ad9\u70b9\u76ee\u5f55\u6709\u4e24\u7ea7\uff1a</p> <ol> <li>\u7cfb\u7edf\u7ea7\u7684\u6839\u76ee\u5f55\uff1ahttpd.conf \u4e2d\u914d\u7f6e\u7684 DocumentRoot\uff08<code>/Libraray/WebServer/Ducuments</code>\uff09\uff0c\u5bf9\u5e94\u7f51\u5740\uff1a http://localhost/\u3002</li> <li>\u7528\u6237\u7ea7\u7684\u6839\u76ee\u5f55\uff1a\u5bf9\u5e94\u914d\u7f6e httpd-userdir.conf\uff08<code>\uff5e/Sites</code>\uff09\uff0c\u5bf9\u5e94\u7f51\u5740\uff1ahttp://localhost/~user/\u3002</li> </ol> <p>httpd.conf \u4e2d\u9ed8\u8ba4\u672a\u542f\u7528\u7528\u6237\u7ea7\u7ad9\u70b9\u914d\u7f6e httpd-userdir.conf\uff1a</p> <pre><code># User home directories\n#Include /private/etc/apache2/extra/httpd-userdir.conf\n</code></pre> <p>httpd-userdir.conf \u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>#Include /private/etc/apache2/users/*.conf\n&lt;IfModule bonjour_module&gt;\n       RegisterUserSite customized-users\n&lt;/IfModule&gt;\n</code></pre> <p>\u5728 /etc/apache2/users/ \u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u7528\u6237\u7684\u914d\u7f6e faner.conf\uff1a</p> /etc/apache2/users/faner.conf<pre><code>&lt;Directory \"/Users/faner/Sites/\"&gt;\n    Options Indexes MultiViews\n    Require all granted\n&lt;/Directory&gt;\n</code></pre> <p>\u6309\u7167 Apache \u7684\u90e8\u7f72\u7b56\u7565\uff0c\u672c\u673a\u7684\u5168\u5c40\u7ad9\u70b9\u90e8\u7f72\u5728\u7cfb\u7edf\u7ea7\u6839\u76ee\u5f55\uff0c\u7528\u6237\u7ea7\u7684\u7ad9\u70b9\u90e8\u7f72\u5728\u5bb6\u76ee\u5f55\u4e0b\u7684 Sites \u4e0b\u3002</p> <p>\u6682\u65f6\u6ca1\u6709\u4f7f\u7528 Apache \u90e8\u7f72\u4e2a\u4eba\u7ad9\u70b9\u7684\u9700\u6c42\uff0c\u6240\u4ee5\u5148\u5728 <code>~Sites</code> \u4e0b\u65b0\u5efa DAVNAS \u76ee\u5f55\u7528\u4f5c WebDAV \u5171\u4eab\u670d\u52a1\u3002</p> <p>\u7b2c19\u884c\u6307\u5b9a\u5171\u4eab\u670d\u52a1\u76ee\u5f55\uff1a/Users/faner/Sites/DAVNAS\u3002 \u7b2c17\u884c\u8bbe\u7f6e alias \u540d\u5b57\u4e3a /webdav\uff0c\u4e3a\u540e\u7eed\u8bbf\u95ee URL \u7684\u6839\u8def\u5f84\u3002</p> /etc/apache2/extra/httpd-dav.conf<pre><code> 17 Alias /webdav \"/Users/faner/Sites/DAVNAS\"\n 18\n 19 &lt;Directory \"/Users/faner/Sites/DAVNAS\"&gt;\n</code></pre> <p>httpd.conf \u4e2d\u6307\u5b9a\u4e86\u8fd0\u884c httpd daemon \u8fdb\u7a0b\u7684\u7528\u6237\u548c\u7ec4\uff1a</p> /etc/apache2/extra/httpd-dav.conf<pre><code>User _www\nGroup _www\n</code></pre> <p>macOS \u4e0b mkdir/touch \u65b0\u521b\u5efa\u7684\u6587\u4ef6\uff08\u5939\uff09\uff0c\u9ed8\u8ba4\u5bf9 staff \u5de5\u4f5c\u7ec4\u548c everyone \u90fd\u5f00\u653e\u4e86 Read Only \u6743\u9650\u3002</p> <p>\u5ba2\u6237\u7aef\u901a\u8fc7 HTTP Basic/Digest \u8ba4\u8bc1\u8bbf\u95ee web \u670d\u52a1\uff0c\u8fd0\u884c httpd \u670d\u52a1\u7684 <code>_www._www</code> \u7528\u6237\u4f5c\u4e3a everyone\uff0c\u62e5\u6709\u5bf9 Directory \u76ee\u5f55\u7684\u53ea\u8bfb\u6d4f\u89c8\u6743\u9650\u3002</p> <p>\u60f3\u8981\u8ba9 httpd \u6709\u6743\u9650\u4fee\u6539/\u5199\u5165\u5171\u4eab\u7684 Directory \u76ee\u5f55\uff0c\u9700\u8981\u5c06\u8be5\u76ee\u5f55\u66f4\u6539\u4e3a <code>_www._www</code> \u7528\u6237\u7ec4\u540d\u4e0b\u3002\u8c03\u7528 <code>chown</code> \u547d\u4ee4\u5373\u53ef\uff1a</p> \u5c06\u5171\u4eab\u76ee\u5f55 owner \u6539\u4e3a httpd \u7528\u6237<pre><code>$ sudo chown -R _www:_www /Users/faner/Sites/DAVNAS\n</code></pre> <p>\u6b64\u9879\u4fee\u6539\u5c06\u5bfc\u81f4\u672c\u5730\u7ba1\u7406\u5458\u65e0\u6cd5\u76f4\u63a5\u5199 Directory \u76ee\u5f55\uff0c\u8be6\u89c1\u540e\u7eed\u8ba8\u8bba\u3002</p>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u914d\u7f6e_davlockdb_\u76ee\u5f55","title":"\u914d\u7f6e DavLockDB \u76ee\u5f55","text":"<p>\u521b\u5efa /opt/webdav/var \u76ee\u5f55\uff1a</p> <pre><code>$ sudo mkdir -p /opt/webdav/var\n# -R?\n$ sudo chown _www:_www /opt/webdav/var\n</code></pre> <p>\u4fee\u6539 httpd-dav.conf \u7b2c 15 \u884c\u7684 DavLockDB \u8def\u5f84\u914d\u7f6e\uff1a</p> /etc/apache2/extra/httpd-dav.conf<pre><code># 15 DavLockDB \"/usr/var/DavLock\"\n15 DavLockDB /opt/webdav/var/DavLock\n</code></pre>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u521b\u5efa_webdav_\u8bbf\u5ba2\u7528\u6237","title":"\u521b\u5efa WebDAV \u8bbf\u5ba2\u7528\u6237","text":"<p>\u65b0\u5efa\u5b58\u50a8\u5bc6\u7801\u7684\u6587\u4ef6 user.passwd\uff0c\u5e76\u4fee\u6539\u6240\u5c5e\u7684\u7528\u6237\u548c\u7ec4\u3002</p> <pre><code>$ sudo touch /opt/webdav/user.passwd\n$ sudo chown _www:_www /opt/webdav/user.passwd\n</code></pre> <p>\u7d27\u63a5\u7740\uff0c\u6839\u636e\u4e0d\u540c\u7684 AuthType \u6267\u884c\u4e0d\u540c\u7684\u547d\u4ee4\uff0c\u4e3a webdav \u57df\u65b0\u589e\u7528\u6237 username\u3002</p> <p>\u5176\u4e2d\uff0c <code>-c</code> \u9009\u9879\u5c06 truncate \u5df2\u5b58\u5728\u7684\u5bc6\u7801\u6587\u4ef6\u3002</p> AuthType Digest - htdigestAuthType Basic - htpasswd <pre><code>$ sudo htdigest -c /opt/webdav/user.passwd webdav $username\n</code></pre> <pre><code>$ sudo htpasswd -c /opt/webdav/user.passwd $username\n</code></pre> <p>\u6839\u636e\u63d0\u793a\uff0c\u4e3a\u65b0\u589e\u7684\u7528\u6237\uff08username\uff09\u8bbe\u7f6e\u5bc6\u7801\u5e76\u786e\u8ba4\u3002</p> <p>Tip</p> <p>\u53ef\u4ee5\u63d0\u524d\u521b\u5efa\u591a\u4e2a\u8d26\u53f7\uff0c\u5206\u914d\u7ed9\u4e0d\u540c\u7684\u5c40\u57df\u7f51\u8bbf\u5ba2\u7528\u6237\u3002</p>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#httpd-davconf_\u4e3b\u8981\u6539\u52a8\u90e8\u5206","title":"httpd-dav.conf \u4e3b\u8981\u6539\u52a8\u90e8\u5206","text":"","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#authtype_basic","title":"AuthType Basic","text":"<ul> <li>\u6539\uff1aDavLockDB</li> <li>\u6539\uff1aAuthName</li> <li>\u6539\uff1aAuthUserFile</li> <li>\u6ce8\uff1aAuthDigestProvider</li> </ul> /etc/apache2/extra/httpd-dav.conf<pre><code>15 DavLockDB \"/opt/webdav/var/DavLock\"\n16\n17 Alias /webdav \"/Users/faner/Sites/DAVNAS\"\n18\n19 &lt;Directory \"/Users/faner/Sites/DAVNAS\"&gt;\n20     Dav On\n21\n22     AuthType Basic\n23     AuthName webdav\n24     # You can use the htdigest program to create the password database:\n25     #   htdigest -c \"/usr/user.passwd\" $AuthName $username\n26     AuthUserFile \"/opt/webdav/user.passwd\"\n27     # AuthDigestProvider file\n29\n30     # Allow universal read-access, but writes are restricted\n31     # to the admin user.\n32     &lt;RequireAny&gt;\n33        Require method GET POST OPTIONS\n34        Require user $username\n35    &lt;/RequireAny&gt;\n36 &lt;/Directory&gt;\n</code></pre>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#authtype_digest","title":"AuthType Digest","text":"<ul> <li>\u6539\uff1aDavLockDB</li> <li>\u6539\uff1aAuthName</li> <li>\u6539\uff1aAuthUserFile</li> <li>\u589e\uff1aRequire valid-user</li> <li>\u6ce8\uff1a<code>&lt;RequireAny&gt;...&lt;/RequireAny&gt;</code></li> </ul> /etc/apache2/extra/httpd-dav.conf<pre><code>15 DavLockDB \"/opt/webdav/var/DavLock\"\n16\n17 Alias /webdav \"/Users/faner/Sites/DAVNAS\"\n18\n19 &lt;Directory \"/Users/faner/Sites/DAVNAS\"&gt;\n20     Dav On\n21\n22     AuthType Digest\n23     AuthName webdav\n24     # You can use the htdigest program to create the password database:\n25     #   htdigest -c \"/usr/user.passwd\" DAV-upload admin\n26     AuthUserFile \"/opt/webdav/user.passwd\"\n27     Require valid-user\n28     AuthDigestProvider file\n29\n30     # Allow universal read-access, but writes are restricted\n31     # to the admin user.\n32 #    &lt;RequireAny&gt;\n33 #        Require method GET POST OPTIONS\n34 #        Require user admin\n35 #    &lt;/RequireAny&gt;\n36 &lt;/Directory&gt;\n</code></pre>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u914d\u7f6e\u591a\u4e2a\u5171\u4eab\u76ee\u5f55","title":"\u914d\u7f6e\u591a\u4e2a\u5171\u4eab\u76ee\u5f55","text":"<p>\u5efa\u8bae\u628a\u8981\u5171\u4eab\u7684\u5185\u5bb9\u653e\u5728\u4e00\u4e2a\u5171\u4eab\u76ee\u5f55\uff08DAVNAS\uff09\uff0c\u7136\u540e\u901a\u8fc7 /webdav \u8bbf\u95ee\u3002</p> <p>\u5982\u679c\u6709\u591a\u4e2a\u5171\u4eab\u76ee\u5f55\uff0c\u53ef\u4ee5\u590d\u5236 Alias\u3001Directory\uff0c\u5efa\u7acb\u591a\u7ec4 URL \u8def\u5f84\u6620\u5c04\u3002</p> /etc/apache2/extra/httpd-dav.conf<pre><code>Alias /webdav1 \"/Users/faner/Sites/DAVNAS1\"\n\n&lt;Directory \"/Users/faner/Sites/DAVNAS1\"&gt;\n    Dav On\n    # Dav access control\n&lt;/Directory&gt;\n\nAlias /webdav2 \"/Users/faner/Sites/DAVNAS2\"\n\n&lt;Directory \"/Users/faner/Sites/DAVNAS2\"&gt;\n    Dav On\n    # Dav access control\n&lt;/Directory&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u540e\u7eed\u5c31\u53ef\u4ee5\u901a\u8fc7 /webdav1, /webdav2 \u5206\u522b\u8bbf\u95ee\u4e0d\u540c\u7684\u5171\u4eab\u76ee\u5f55\u3002</p>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u6388\u4e88_httpd_\u5b8c\u5168\u78c1\u76d8\u8bbf\u95ee\u6743\u9650","title":"\u6388\u4e88 httpd \u5b8c\u5168\u78c1\u76d8\u8bbf\u95ee\u6743\u9650","text":"<p>\u5c06 DAVNAS \u5171\u4eab\u76ee\u5f55\u5206\u914d\u7ed9 <code>_www:_www</code> \u540e\uff0c\u8fd8\u5f97\u7ed9 httpd \u76f8\u5173 daemon \u8fdb\u7a0b\u5206\u914d\u78c1\u76d8\u8bbf\u95ee\u6743\u9650\uff0c\u8fd9\u6837\u624d\u80fd\u8bfb\u5199\u78c1\u76d8\u6587\u4ef6\u7cfb\u7edf\u3002</p> <p>\u6253\u5f00 macOS \u8bbe\u7f6e(System Settings)\uff0c\u9690\u79c1\u4e0e\u5b89\u5168\u6027(Privacy &amp; Security)\uff0c\u5b8c\u5168\u78c1\u76d8\u8bbf\u95ee\u6743\u9650(Full Disk Access)\uff0c</p> <p>\u70b9\u6309\u5de6\u4e0b\u89d2\u7684 + \u53f7\uff0c\u5728\u6253\u5f00\u7684\u8bbf\u8fbe\u7a97\u53e3\u6309 Shift+Cmd+G \u8c03\u51fa\u8def\u5f84\u8bbf\u95ee\u65b9\u5f0f\uff0c\u8f93\u5165 <code>/usr/sbin/httpd</code> \u56de\u8f66\uff0c\u627e\u5230 httpd \u547d\u4ee4\u6dfb\u52a0\u3002</p> <p>\u4f9d\u6b64\u65b9\u6cd5\uff0c\u6dfb\u52a0 <code>/usr/sbin/htdigest</code>\uff08\u6216 <code>/usr/sbin/htpasswd</code>\uff09\u3002</p>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u9a8c\u8bc1\u66f4\u65b0\u914d\u7f6e\u91cd\u542fapache_httpd","title":"\u9a8c\u8bc1\u66f4\u65b0\u914d\u7f6e\u91cd\u542fApache Httpd","text":"<p>\u67e5\u770b apache httpd \u670d\u52a1\u914d\u7f6e</p> <p>\u5728\u9a8c\u8bc1\u670d\u52a1\u4e4b\u524d\uff0c\u53ef\u4ee5\u8c03\u7528 <code>apachectl</code> \u6216 <code>httpd</code> \u547d\u4ee4\u67e5\u770b\u914d\u7f6e\uff1a</p> <pre><code>$ apachectl -t -D DUMP_INCLUDES\n$ apachectl -t -D DUMP_RUN_CFG\n</code></pre> <p>\u6267\u884c <code>apachectl -t</code>\uff08\u6216 <code>apachectl configtest</code>\uff09\u68c0\u67e5 Apache Httpd \u914d\u7f6e\u6587\u4ef6\uff1a\u5982\u679c\u4ec5\u8f93\u51fa\u4e00\u884c  <code>Syntax OK</code> \u4ee3\u8868\u914d\u7f6e\u6b63\u786e\uff1b\u5426\u5219\uff0c\u8868\u793a\u914d\u7f6e\u6709\u95ee\u9898\uff0c\u8bf7\u6309\u63d0\u793a\u68c0\u67e5\u914d\u7f6e\u6587\u4ef6\uff0c\u4e5f\u53ef\u67e5\u770b\u5206\u6790\u95ee\u9898\u65e5\u5fd7 /var/log/apache2/error_log\u3002</p> <p>\u5982\u679c configtest \u9047\u5230\u4ee5\u4e0b\u9519\u8bef\uff0c\u8bf7\u6267\u884c <code>sudo mkdir /private/var/log/apache2</code> \u521b\u5efa apache2 \u65e5\u5fd7\u6587\u4ef6\u5939\u3002</p> <pre><code>$ apachectl -t\n(2)No such file or directory: AH02291: Cannot access directory '/private/var/log/apache2/' for main error log\nAH00014: Configuration check failed\n</code></pre> <p>\u914d\u7f6e\u6587\u4ef6\u9a8c\u8bc1\u65e0\u8bef\u540e\uff0c\u6267\u884c <code>sudo apachectl graceful</code> \u91cd\u8f7d\u914d\u7f6e\u6587\u4ef6\u4f7f\u751f\u6548\u3002</p> <p>\u6700\u540e\uff0c\u91cd\u65b0\u542f\u52a8 Apache \u670d\u52a1\u5668\uff1a<code>sudo apachectl -k restart</code>\u3002</p> <p>How to stop apache service</p> <pre><code>$ sudo apachectl -k stop\n$ sudo launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist 2&gt;/dev/null\n</code></pre>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u5c40\u57df\u7f51\u8fde\u63a5\u9a8c\u8bc1webdav\u670d\u52a1","title":"\u5c40\u57df\u7f51\u8fde\u63a5\u9a8c\u8bc1WebDAV\u670d\u52a1","text":"<p>\u6253\u5f00\u672c\u673a\u8bbf\u8fbe\uff08Finder\uff09\uff0c\u6309 Command+k \u8fde\u63a5\u670d\u52a1\u5668\uff0c\u8f93\u5165 http://mbpa1398.local/webdav/\uff0c\u7136\u540e\u8f93\u5165\u5728 user.passwd \u4e2d\u914d\u7f6e\u7684\u8d26\u6237\u5bc6\u7801\uff0c\u770b\u770b\u662f\u5426\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\u3002</p> <p>\u5982\u679c\u673a\u5668\u540d\u65e0\u6cd5\u89e3\u6790\uff08unable to resolve host\uff09\uff0c\u53ef\u4ee5\u6362\u6210\u5c40\u57df\u7f51 IP \u8bbf\u95ee\uff1ahttp://192.168.0.100/webdav/ \uff0c \u6216\u8005\u8003\u8651\u5728 /etc/hosts \u4e2d\u6dfb\u52a0\u6761\u76ee\uff1a127.0.0.1 mbpa1398.local \u3002</p> <p>\u672c\u673a\u9a8c\u8bc1\u901a\u8fc7\u540e\uff0c\u5728\u5c40\u57df\u7f51\u5176\u4ed6\u7ec8\u7aef\uff08\u4f8b\u5982 Mac Finder\uff0ciPhone PDF expert\uff09\u4e0a\u5c1d\u8bd5\u8fde\u63a5 webdav \u670d\u52a1\u3002\u8fde\u63a5\u6210\u529f\u540e\uff0c\u5373\u53ef\u8fdb\u884c\u7b80\u5355\u7684\u591a\u7528\u6237\u534f\u4f5c\u3002</p> <p>\u8fd9\u6837\uff0c\u5c31\u5c06 DAVNAS \u914d\u7f6e\u4e3a\u5bb6\u5ead\u5c40\u57df\u7f51\u5185\u7684\u6570\u636e\u4e2d\u5fc3\uff0c\u652f\u6301\u591a\u8bbe\u5907\u5171\u4eab\u548c\u7f16\u8f91\u540c\u6b65\u6587\u4ef6\u3002</p> <p>\u5c06\u914d\u7f6e\u6587\u4ef6 httpd-dav.conf \u4e2d\u7684  Directory \u914d\u7f6e\u4e3a\u5916\u6302\u786c\u76d8\uff0c\u4f8b\u5982 <code>/Volumes/WDHD</code>\uff0c\u5373\u53ef\u53d8\u4e3a\u7b80\u964b\u7684 NAS\u3002</p> <p>\u6709\u6761\u4ef6\u7684\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5347\u7ea7\u652f\u6301 HTTPS \u5b89\u5168\u8bbf\u95ee\uff0c\u9700\u8981\u5728 httpd.conf \u5f15\u5165 httpd-ssl.conf \u5e76\u914d\u7f6e\u52a0\u8f7d ssl \u76f8\u5173\u6a21\u5757\uff0c\u8fd8\u5f97\u4f7f\u7528 openssl \u521b\u5efa\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002</p> <p>\u5982\u679c\u5bb6\u91cc\u7684\u5bbd\u5e26\u6709\u5206\u914d\u516c\u7f51 IP\uff0c\u53ef\u4ee5\u5728\u8def\u7531\u5668\u4e2d\u914d\u7f6e\u7aef\u53e3\u6620\u5c04\uff0c\u652f\u6301\u5916\u7f51\u8bbf\u95ee\u3002\u8fd9\u6837\uff0c\u5373\u4f7f\u8eab\u5728\u5916\u8fb9\uff0c\u4e5f\u53ef\u8fdc\u7a0b\u8bbf\u95ee\u5bb6\u91cc\u7684 WebDAV \u670d\u52a1\u3002</p> <p>\u5173\u4e8e\u98df\u7528\u4f53\u9a8c\u95ee\u9898\uff0c\u53c2\u8003 macOS\u4e0a\u4f7f\u7528httpd/WebDav\u9047\u5230\u7684\u95ee\u9898\u3002 \u73b0\u5df2\u6539\u88c5 nginx \u914d\u7f6e webdav \u670d\u52a1\uff0c\u53c2\u8003 macOS\u91cd\u88c5nginx-full\u5e76\u914d\u7f6eWebDav\u3002 \u5ba2\u6237\u7aef\u6539\u7528\u514d\u8d39\u7684 Cyberduck\uff0c\u642d\u914d rclone+crontab \u5b9a\u65f6\u81ea\u52a8\u540c\u6b65\u5907\u4efd\uff0cthey just work like a charm!</p>","tags":["httpd","webDAV"]},{"location":"blog/20240316/mac-setup-httpd-dav/#\u53c2\u8003","title":"\u53c2\u8003","text":"<p>wiki - WebDAV \u7f51\u7edc\u5b58\u50a8\u6587\u4ef6\u5171\u4eab\u4e4b WebDAV \u5728 Mac mini Server \u4e0a\u914d\u7f6e WebDAV \u6587\u4ef6\u5171\u4eab</p>","tags":["httpd","webDAV"]},{"location":"blog/20240317/mac-webdav-issues/","title":"macOS\u4e0a\u4f7f\u7528httpd/WebDav\u9047\u5230\u7684\u95ee\u9898","text":"<p>\u5728 macOS \u4e0a\u57fa\u4e8e Apache Httpd \u7684 dav \u6269\u5c55\u642d\u5efa\u8d77 webDAV \u670d\u52a1\u540e\uff0c\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u9047\u5230\u4e86\u4e00\u4e9b\u4f53\u9a8c\u95ee\u9898\uff1a</p> <ol> <li>\u672c\u5730\u7ba1\u7406\u5458\u65e0\u6cd5\u4fee\u6539\u5171\u4eab\u76ee\u5f55\u95ee\u9898</li> <li>Finder \u6302\u8f7d WebDAV \u5361\u6b7b\u95ee\u9898</li> </ol> <p>\u672c\u6587\u8bb0\u5f55\u4e86\u95ee\u9898\u5206\u6790\u548c\u65b9\u6848\u63a2\u8ba8\u3002</p>","tags":["webDAV","umask"]},{"location":"blog/20240317/mac-webdav-issues/#\u672c\u5730\u65e0\u6cd5\u4fee\u6539\u5171\u4eab\u76ee\u5f55\u95ee\u9898\u63a2\u8ba8","title":"\u672c\u5730\u65e0\u6cd5\u4fee\u6539\u5171\u4eab\u76ee\u5f55\u95ee\u9898\u63a2\u8ba8","text":"<p>\u5728\u670d\u52a1\u5668\u914d\u7f6e WebDav \u670d\u52a1\u76ee\u5f55 Directory\uff08/Users/faner/Sites/DAVNAS\uff09\u65f6\uff0c\u5c06\u5176 owner \u4fee\u6539\u4e3a\u4e86 httpd \u7528\u6237\uff08 <code>_www._www</code>\uff09\u3002</p> <p>\u8fd9\u6837\u4fee\u6539\u540e\uff0c\u672c\u5730\u5176\u4ed6\u7528\u6237\uff08\u5305\u62ec\u5f53\u524d\u7528\u6237\uff09\u5c06\u65e0\u6cd5\u518d\u76f4\u63a5\u5199\u8be5\u76ee\u5f55\u3002\u5f53\u524d\u7528\u6237 <code>faner:staff</code>  \u5c1d\u8bd5\u5199\u5165\u65f6\u8981\u6c42\u5bc6\u7801\u8ba4\u8bc1\uff0c\u8ba4\u8bc1\u540e\u53ef\u4ee5\u5f3a\u5236\u5199\u5165\uff0c\u4f46\u662f owner \u5c31\u53d8\u6210\u4e86\u5f53\u524d\u7528\u6237 faner\uff0chttpd \u7528\u6237 _www \u53c8\u6ca1\u6709\u8fd9\u4e2a\u6587\u4ef6\u7684\u5199\u5165\u6743\u9650\u4e86\uff01</p> <p>\u6240\u4ee5\uff0c\u5bf9\u4e8e WebDAV \u5171\u4eab\u670d\u52a1\u76ee\u5f55\uff0c\u9884\u671f\u6240\u6709\u7528\u6237\u90fd\u7edf\u4e00\u4ee5 WebDAV \u5ba2\u6237\u5f62\u5f0f\u8bf7\u6c42 httpd-dav \u670d\u52a1\u5668\u4ee5 <code>_www</code> \u8eab\u4efd\u5bf9\u5176\u6267\u884c\u5199\u5165\u64cd\u4f5c\u3002\u5e26\u6765\u7684\u4e0d\u4fbf\u4e4b\u5904\u5728\u4e8e\uff0c\u5373\u4f7f\u670d\u52a1\u5668\u672c\u5730\u7ba1\u7406\u5458\uff0c\u4e5f\u9700\u8fde\u63a5\u6302\u8f7d\u5230\u672c\u5730\uff08/Volumes/webdav\uff09\u4e4b\u540e\u624d\u80fd\u6267\u884c\u5199\u5165\u64cd\u4f5c\u3002</p> <p>Danger</p> <p>\u6700\u7b80\u5355\u7c97\u66b4\u7684\u65b9\u6848\uff1a\u4fee\u6539 httpd.conf \u4e2d\u7684 User:Group \u4e3a\u5f53\u524d\u7528\u6237\u7ec4 faner:staff\uff08\u5171\u4eab\u670d\u52a1\u76ee\u5f55\u76f8\u5e94\u4e5f\u9700\u8981 chown\uff09\uff0c\u5373 httpd \u4ee5\u5f53\u524d\u7528\u6237\u7684\u8eab\u4efd\u542f\u52a8\u670d\u52a1\uff0c\u5f53\u524d\u7528\u6237\u5f53\u7136\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u5199\u5165\u5171\u4eab\u670d\u52a1\u76ee\u5f55\u3002</p> <p>\u5982\u679c\u5bb3\u6015 httpd \u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u8fd0\u884c\u6743\u9650\u8fc7\u9ad8\u751a\u81f3\u4e3a\u975e\u4f5c\u6b79\uff0c\u6700\u597d\u8fd8\u662f\u7ef4\u6301 httpd.conf \u4e2d\u9ed8\u8ba4\u7684 User:Group \u914d\u7f6e\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u5c31\u5f97\u63a2\u7a76\u5176\u4ed6\u7684\u53d8\u901a\u65b9\u6848\u3002</p> <p>\u8fd9\u91cc\u6d89\u53ca\u5230 UNX \u8bfb\u5199\u6587\u4ef6\u7684\u6743\u9650\u63a7\u5236\u95ee\u9898\uff0c\u8ba9\u6211\u4eec\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u63a2\u7a76\u4e00\u4e0b\u670d\u52a1\u5668\u672c\u5730\u548c\u52a0\u8f7d\u7684\u201c\u4e91\u76d8\u201d\u4e0b\u6587\u4ef6\uff08\u5939\uff09\u7684\u6743\u9650\u3002</p> <ol> <li>\u4f7f\u7528 <code>ls -l</code> \u547d\u4ee4\uff0c\u67e5\u770b\u670d\u52a1\u5668\u672c\u5730\u5171\u4eab\u76ee\u5f55\uff08/Users/faner/Sites/DAVNAS\uff09\u7684\u6743\u9650\u662f drwxr-xr-x(755)\u3002</li> <li>\u767b\u5f55 WebDAV \u670d\u52a1\u540e\uff0c\u672c\u5730\u6302\u8f7d\u70b9 /Volumes/webdav \u4e0b\u770b\u5230\u7684\u6587\u4ef6\uff08\u5939\uff09\u6743\u9650\u662f<code>rwx------</code>\uff08700\uff09\uff0c\u5373\u5f53\u524d\u7528\u6237\u62e5\u6709\u5bf9\u8be5\u4e91\u76d8\u7684\u5168\u90e8\u6743\u9650\u3002</li> <li>\u5411\u4e91\u76d8\u7c98\u8d34\u5199\u5165\u6587\u4ef6\u540e\uff0c\u56de\u5230\u672c\u5730\u5171\u4eab\u76ee\u5f55\u67e5\u770b\uff0c\u5176\u6587\u4ef6\uff08\u5939\uff09\u7684 owner \u662f _www\uff0c\u6587\u4ef6\u5939\u6743\u9650\u662f <code>drwxr-xr-x</code>(755)\uff0c\u6587\u4ef6\u6743\u9650\u662f <code>-rw-r--r--</code>(644)\u3002</li> </ol> <p>macOS/Linux \u4e0b\uff0c\u7cfb\u7edf\u6309\u7167 <code>umask</code> \u8bbe\u7f6e\u7528\u6237\u521b\u5efa\u6587\u4ef6\uff08\u5939\uff09\u7684\u9ed8\u8ba4\u6743\u9650\u3002\u5728\u547d\u4ee4\u884c\u8f93\u5165 <code>umask</code> \u5176\u503c\u4e3a 022\uff08\u516b\u8fdb\u5236\uff09\uff0c\u5373 owner \u62e5\u6709\u5168\u90e8\u6743\u9650\uff0c\u540c\u65f6\u5c4f\u853d\u4e86\u7528\u6237\u7ec4 g \u548c\u5176\u4ed6\u7528\u6237 o \u7684\u5199\u6743\u9650\u3002</p> <p>\u5f53\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\u65f6\uff0c\u5176\u6743\u9650=777 &amp; ~umask\uff08Python\u4e0b\u8ba1\u7b97\uff1aoct(0o777 &amp; ~0o022) = '0o755'\uff09\uff0c\u6587\u4ef6\u7684\u6743\u9650\u662f <code>-rw-r--r--</code>(644)\uff0c\u5373 owner \u62e5\u6709\u8bfb\u5199\u6743\u9650\uff0c\u7528\u6237\u7ec4 g \u548c\u5176\u4ed6\u7528\u6237 o \u62e5\u6709\u53ea\u8bfb\u6743\u9650\u3002</p> <p>\u6839\u636e\u4ee5\u4e0a\u5206\u6790\uff0c\u6309\u7167 umask \u6743\u9650\u5c4f\u853d\u7b56\u7565\uff0c\u53ea\u6709 httpd \u7528\u6237\uff08_www\uff09 \u8fd9\u4e2a owner \u5bf9 WebDav \u670d\u52a1\u76ee\u5f55 Directory \u62e5\u6709\u5199\u6743\u9650\uff0c\u5176\u4ed6\u7528\u6237\uff08\u5305\u62ec\u5f53\u524d\u7528\u6237 faner:staff\uff09\u53ea\u6709\u53ea\u8bfb\u6743\u9650\u3002</p> <p>Note</p> <p>\u89e3\u51b3\u601d\u8def\uff1a\u5982\u679c\u6709\u529e\u6cd5\u4fee\u6539 httpd \u7528\u6237\uff08_www\uff09\u7684 umask \u4e3a 002\uff0c\u5373\u5f00\u653e\u5176\u6240\u5728\u7528\u6237\u7ec4\uff08_www\uff09\u7684\u5199\u6743\u9650\uff0c\u7136\u540e\u6267\u884c <code>sudo dscl . -append /Groups/_www GroupMembership faner</code> \u5c06\u5f53\u524d\u7528\u6237 faner \u52a0\u5165 _www \u7528\u6237\u7ec4\uff0c\u5f53\u524d\u7528\u6237\u5373\u6709\u6743\u9650\u76f4\u63a5\u5199\u672c\u5730 WebDav \u670d\u52a1\u76ee\u5f55 Directory\u3002</p>","tags":["webDAV","umask"]},{"location":"blog/20240317/mac-webdav-issues/#\u73b0\u6709_umask_\u4e0b\u7684\u65b9\u6848\u63a2\u7d22","title":"\u73b0\u6709 umask \u4e0b\u7684\u65b9\u6848\u63a2\u7d22","text":"<p>Webdav (Apache) \u7684\u6587\u4ef6\u6743\u9650\u95ee\u9898 \u7ed9\u51fa\u4e86\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\uff1a</p> <ol> <li>\u5c06\u5171\u4eab\u76ee\u5f55\u7684 owner \u4ece _www:_www \u4fee\u6539\u4e3a faner:_www\uff1a</li> </ol> <pre><code>sudo chown -R faner:_www /Users/faner/Sites/DAVNAS\n</code></pre> <ol> <li>\u4e3a\u7ec4\u52a0\u4e0a<code>s</code> \u6807\u5fd7\uff0c\u8fd9\u6837\u5176\u4e0b\u65b0\u5efa\u7684\u6587\u4ef6\u5c31\u4f1a\u81ea\u52a8 setgid \u4e3a <code>_www</code> \u7ec4\u7684 ID\uff1a</li> </ol> <pre><code>sudo chmod -R g+s /Users/faner/Sites/DAVNAS\n</code></pre> <p>For a directory, <code>g+s</code> overrides the group id that new files and directories will have (it is usually inherited from the creator).</p> <p>\u5728\u8fd9\u79cd\u65b9\u6848\u4e2d\uff0c\u6539\u53d8\u6587\u4ef6\u5939\u7684 owner \u548c mod\uff0c\u5f53\u524d\u7528\u6237 faner \u4e0d\u7528\u52a0\u5165 _www \u7ec4\uff0c\u5373\u53ef\u5728\u5171\u4eab\u6587\u4ef6\u5939\u65b0\u5efa\u6587\u4ef6\uff08\u5939\uff09\u3002</p> <ul> <li>\u65b0\u5efa\u6587\u4ef6\u5939\u96b6\u5c5e faner:_www\uff0c\u6743\u9650\u4e3a drwxr-xr-x</li> <li>\u65b0\u5efa\u6587\u4ef6\u96b6\u5c5e faner:_www\uff0c\u6743\u9650\u4e3a -rw-r--r--</li> </ul> <p>\u53d7\u73b0\u6709 umask=022 \u5236\u7ea6\uff0c\u65b0\u5efa\u7684\u6587\u4ef6\uff08\u5939\uff09\u7684\u7528\u6237\u7ec4\u5747\u65e0 w \u6743\u9650\u3002 webdav \u5ba2\u6237\u7aef\u5bf9\u5e94\u7684 httpd \u7528\u6237 _www \u5c06\u53ea\u6709 r \u8bfb\u6d4f\u89c8\u6743\u9650\uff0c\u65e0\u6cd5\u5199\u5165\uff01</p> <p>\u8003\u8651\u4e3a\u5171\u4eab\u76ee\u5f55\u6240\u5c5e\u7ec4 _www \u5f00\u653e\u5199\u6743\u9650\uff1a</p> <pre><code># 755 -&gt; 775\n$ sudo chmod -R g+w ~/Sites/DAVNAS\n</code></pre> <p>\u5e76\u5c06\u5f53\u524d\u7528\u6237 faner \u52a0\u5165 _www \u7ec4\uff1a</p> <pre><code># -delete \u5220\u9664\n$ sudo dscl . -append /Groups/_www GroupMembership faner\n</code></pre> <p>\u8fd9\u6837\u7684\u8bdd\uff0c\u5171\u4eab\u76ee\u5f55\u7ef4\u6301\u4e3a <code>_www:_www</code> \u6240\u6709\uff0c_www \u7ec4\u5458 faner \u53ef\u5411\u6839\u76ee\u5f55\u4fee\u6539\u5199\u5165\u6570\u636e\u3002</p> <p>\u4f46\u662f\uff0cfaner:_www \u5728\u6839\u76ee\u5f55\u65b0\u5efa\u6587\u4ef6\u5c5e\u6027\u4e3a <code>-rw-r--r--@</code>\uff0c\u4e00\u65e6\u88ab webdav \u5ba2\u6237\u7aef\u4fee\u6539\uff0c\u5176 owner \u53d8\u4e3a _www\uff0c\u5c5e\u6027\u4e2d\u7684 <code>@</code> \u6d88\u5931\uff0c\u672c\u5730\u7ba1\u7406\u5458 faner \u53c8\u65e0\u6743\u4fee\u6539\u8be5\u6587\u4ef6\uff01</p> <ul> <li>\u5ba2\u6237\u7aef\u65b0\u5efa\u7684\u6587\u4ef6 owner \u4e3a _www:_www\uff0cfaner \u5728\u672c\u5730\u65e0\u6743\u4fee\u6539\u5199\u5165\uff01</li> </ul> <p>\u5f52\u6839\u7ed3\u5e95\uff0c\u8fd8\u662f\u53d7\u73b0\u6709 umask=022 \u5236\u7ea6\uff0c\u65b0\u5efa\u7684\u6587\u4ef6\u5939\u5e76\u4e0d\u4f1a\u7ee7\u627f\u6839\u76ee\u5f55\u7684 g+w\uff0c\u5373\u7528\u6237\u7ec4\u5747\u65e0 w \u5199\u6743\u9650\u3002\u670d\u52a1\u7aef faner \u6216\u5ba2\u6237\u7aef _www \u5efa\u7684\u6587\u4ef6\u5939\uff0c\u5f7c\u6b64\u90fd\u65e0\u6743\u4fee\u6539\u5199\u5165\uff01</p> <p>\u6240\u4ee5\uff0c\u6b64\u90e8\u5206\u4ec5\u4f5c\u4e3a\u63a2\u7d22\u8bb0\u5f55\uff0c\u5947\u6280\u6deb\u5de7\u548c\u6b6a\u95e8\u90aa\u9053\u7ec8\u7a76\u4e0d\u80fd\u767b\u5802\u5165\u5ba4\u53d6\u5f97\u6b63\u679c\u3002</p>","tags":["webDAV","umask"]},{"location":"blog/20240317/mac-webdav-issues/#\u5c1d\u8bd5\u5c06_umask_\u4fee\u6539\u4e3a_002","title":"\u5c1d\u8bd5\u5c06 umask \u4fee\u6539\u4e3a 002\uff1f","text":"<p>CentOS\u3001Ubuntu \u4e0b\u7684\u65b9\u6848\u53c2\u8003 Setting the umask of the Apache user\uff1a</p> <pre><code># CentOS\n$ echo \"umask 002\" &gt;&gt; /etc/sysconfig/httpd\n$ service httpd restart\n\n# Debian and Ubuntu\necho \"umask 002\" /etc/apache2/envvars\nservice apache2 restart\n</code></pre> <p>macOS \u4e0b\uff0c\u53c2\u8003 Apache2 &amp; umasks\uff0c\u9700\u8981\u4fee\u6539 apache \u7684\u73af\u5883\u53d8\u91cf\u914d\u7f6e\u6587\u4ef6 /usr/sbin/envvars\uff1a</p> <pre><code>$ sudo vim /usr/sbin/envvars\n# set custom umask, allow group writing\numask 002\n</code></pre> <p>\u53c2\u8003 Set umask in OS X Yosemite \u548c Mac umask apache\uff0c\u4fee\u6539 org.apache.httpd.plist \u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>$ sudo vim /System/Library/LaunchDaemons/org.apache.httpd.plist\n\nadd\n\n        &lt;key&gt;Umask&lt;/key&gt;\n        &lt;integer&gt;002&lt;/integer&gt;\n\nin &lt;dict&gt; section\n\n$ sudo apachectl stop\n$ sudo apachectl start\n</code></pre> <p>\u53ef\u60dc\u7684\u662f\uff0c\u4ee5\u4e0a\u4e24\u4e2a\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u5747\u96b6\u5c5e root:wheel\uff0c \u5373\u4f7f\u6267\u884c <code>sudo -i</code> \u6216 <code>sudo su -</code> \u5207\u6362\u5230 root \u8eab\u4efd\uff0c\u8fdb\u5165\u6062\u590d\u6a21\u5f0f\u6267\u884c <code>csrutil disable</code> \u5173\u95ed SIP\uff08System Integrity Protection\uff09\uff0c\u4e5f\u8fd8\u662f\u5904\u4e8e\u53ea\u8bfb\u4fdd\u62a4\u72b6\u6001\uff0c\u65e0\u6cd5\u4fee\u6539\u3002\u81f3\u4e8e\u60f3\u901a\u8fc7 <code>sudo mount -uw /</code> \u628a\u6574\u4e2a\u78c1\u76d8\u91cd\u65b0 mount \u4e3a\u53ef\u5199\u6a21\u5f0f\u66f4\u662f\u75f4\u5fc3\u5984\u60f3\uff01</p> <p>\u7f51\u4e0a\u6709\u5f88\u591a\u6b64\u7c7b\u95ee\u9898\u7684\u8ba8\u8bba\uff0c\u968f\u7740 macOS \u7cfb\u7edf\u7684\u5b89\u5168\u7b56\u7565\u5347\u7ea7\uff0c\u6709\u4e9b\u65b9\u6848\u5df2\u7ecf\u5931\u6548\uff1a </p> <ul> <li>MAC: Root User Not Getting Edit Permissions</li> <li>Cannot add/modify system or root dir files even though I'm logged in as root user</li> <li>Can't edit read only file even when root</li> <li>Still can't edit /System/Library after disabling SIP : r/MacOS</li> </ul> <p>\u82f9\u679c\u5b98\u65b9\u76f8\u5173\u6587\u6863</p> <p>Signed system volume security in iOS, iPadOS and macOS - Apple Support (HK) About the read-only system volume in macOS Catalina or later: Apple has made changes to Catalina to lock down the system files which are now stored and mounted as a read-only volume.</p> <p>\u5728 Set a custom umask in macOS \u4e2d\uff0c\u5b98\u65b9\u7ed9\u51fa\u4e86\u4fee\u6539 umask \u7684\u65b9\u6848\uff0c\u4e0d\u8fc7\u53ea\u80fd\u9488\u5bf9 system \u548c user\uff08\u6240\u6709\u7528\u6237\uff09\u5168\u5c40\u8bbe\u7f6e\uff0c\u65e0\u6cd5\u9488\u5bf9\u5177\u4f53\u7528\u6237\uff08_www\uff09\u8bbe\u7f6e umask\u3002</p> <pre><code># user: \u6240\u6709\u7528\u6237\nsudo launchctl config user umask nnn\n# system: \u7cfb\u7edf\u7528\u6237\nsudo launchctl config system umask nnn\n</code></pre> <p>config \u76ee\u6807\u53ea\u80fd\u4e3a system | user\uff0c\u5c1d\u8bd5\u6267\u884c <code>sudo launchctl config user umask 002</code> \u62a5\u9519\uff1a</p> <pre><code>sudo launchctl config _www umask 002\n\nUsage: launchctl config &lt;system|user&gt; &lt;parameter&gt; &lt;value&gt;\nWhen given the \"system\" argument, modifies the configuration for the system\ndomain. When given the \"user\" argument on supported platforms, modifies the\nconfiguration for all user domains. You must reboot for changes to take effect.\nNote that if a service specifies a conflicting configuration, the service's\nparameter will be preferred.\n\nSupported configuration parameters are:\n\numask &lt;integer as octal&gt;\nModifies the umask(2) applied to services launched in the domain.\n\npath &lt;string&gt;\nModifies the PATH environment variable set on each service in the\ndomain.\n</code></pre> <p>\u5f53\u7136\uff0c\u5982\u679c\u4e0d\u4ecb\u610f\uff0c\u4e5f\u53ef\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u5168\u5c40\u4fee\u6539\u6240\u6709\u7528\u6237\uff08user \uff09\u7684 umask \u4e3a 002\uff0c\u5411\u540c\u4e00\u7528\u6237\u7ec4\u5f00\u653e\u5199\u6743\u9650\u3002</p> <p>\u671f\u5f85 apache \u5b98\u65b9\u672a\u6765\u9884\u7559\u4e00\u4e2a\u7528\u6237\u7ea7\u73af\u5883\u53d8\u91cf\u7684\u914d\u7f6e\u673a\u4f1a\uff0c\u6216\u8005\u91c7\u7528 nginx \u5e73\u66ff\uff08\u4e3awww-data\u7528\u6237(nginx)\u66f4\u6539umask\u503c\uff09\u3002</p> <p>\u6216\u8005\uff0c\u6682\u65f6\u5c31\u6b64\u4f5c\u7f62\uff0c\u670d\u52a1\u5668\u672c\u5730\u7ba1\u7406\u5458\u4e5f\u767b\u5f55\u6302\u8f7d WebDAV \u4e91\u76d8\u540e\uff0c\u7edf\u4e00\u4ee5 Web HTTP \u5ba2\u6237\u8eab\u4efd\u540c\u6b65\u64cd\u4f5c\u4e91\u76d8\u3002</p>","tags":["webDAV","umask"]},{"location":"blog/20240317/mac-webdav-issues/#finder_\u6302\u8f7d_webdav_\u5361\u6b7b\u95ee\u9898","title":"Finder \u6302\u8f7d WebDAV \u5361\u6b7b\u95ee\u9898","text":"<p>macOS Finder \u5bf9 WebDAV \u7684\u652f\u6301\u8c8c\u4f3c\u4e0d\u662f\u90a3\u4e48\u597d\uff0c\u53ef\u9009\u62e9 Finder \u7684\u66ff\u4ee3\u54c1 QSpace\uff0c\u6216\u4f7f\u7528\u514d\u8d39\u7684 Cyberduck\uff08Help Docs\uff09\uff0c\u6216\u8003\u8651\u4e13\u4e1a\u7684\u4e91\u76d8\u52a0\u8f7d\u5de5\u5177\u8f6f\u4ef6 Mountain Duck\u3001CloudMounter \u7b49\u3002</p> <p>WebDAVDevs/awesome-webdav</p> <p>A curated list of awesome apps that support WebDAV and tools related to it.</p> <ul> <li>Contents</li> <li>Resources</li> <li>Servers</li> <li>PWA and online apps</li> <li>Command line tools</li> <li>Desktop apps</li> <li>Mobile apps</li> <li>Libraries</li> <li>Cloud providers</li> <li>Extensions</li> <li>Contributing</li> </ul> <p>\u4ece\u5b9e\u9645\u4f53\u9a8c\u6765\u770b\uff0ciPad/iPhone \u4e0a\u7684 PDF Expert \u6302\u8f7d\u5c40\u57df\u7f51 WebDAV \u540e\uff0c\u5de5\u4f5c\u5f97\u633a\u7a33\u5b9a\uff0c\u56de\u5199\u540c\u6b65\u505a\u5f97\u6bd4\u8f83\u597d\u3002\u5728 macOS \u4e0a\u7f16\u8f91 PDF \u6587\u4ef6\uff0c\u65f6\u4e0d\u65f6\u8f6c\u83ca\u82b1\uff0c\u6709\u65f6\u5019\u7b49\u4e00\u4f1a\u80fd\u6062\u590d\uff0c\u6709\u65f6\u5019\u7b49\u4e86\u5f88\u4e45\u8fd8\u662f\u5361\u6b7b\u3002</p> <p>\u6b64\u65f6\uff0c\u4f7f\u7528 <code>\u2325+\u2318+esc</code> \u6253\u5f00\u67e5\u770b Force Quit Applications \u7a97\u53e3\uff0c\u5176\u4e2d PDF Expert \u4e3a not responding \u5361\u6b7b\u72b6\u6001\uff0c\u70b9\u51fb\u5e95\u4e0b\u7684 Relaunch \u6309\u94ae\uff0c\u4e5f\u5e76\u6ca1\u6709\u89e3\u51b3\u95ee\u9898\u3002\u8fc7\u4e00\u4f1a\u56de\u5230 Finder \u4e2d\u7684 <code>/Volumes/webdav</code>\uff0c\u70b9\u51e0\u4e0b\u4e5f\u5361\u6b7b\u3002\u5728 Force Quit Applications \u7a97\u53e3\u70b9\u9009 Finder Relaunch\uff0cFinder \u5173\u95ed\u540e\u8fdf\u8fdf\u6ca1\u6709\u91cd\u65b0\u6253\u5f00\u3002</p> <p>\u6700\u521d\uff0c\u9047\u5230\u8fd9\u79cd\u60c5\u51b5\u6ca1\u8f99\uff0c\u53ea\u80fd\u6309\u4f4f\u7535\u6e90\u952e\u5f3a\u5236\u91cd\u542f\uff0c\u4f46\u662f\u603b\u8fd9\u4e48\u641e\u4e5f\u4e0d\u662f\u529e\u6cd5\u3002\u7a0d\u5fae\u7814\u7a76\u4e86\u4e00\u4e0b\uff0c\u901a\u8fc7 macOS \u63d0\u4f9b\u7684\u8bca\u65ad\u5de5\u5177\u7bb1\uff0c\u53ef\u4ee5\u627e\u5230\u76f8\u5173\u8fdb\u7a0b\u6740\u4e4b\u3002</p> <p>\u901a\u8fc7 <code>ps aux | grep webdav</code> \u8fc7\u6ee4 webdav \u76f8\u5173\u7684\u8fdb\u7a0b\uff0c\u6216\u5229\u7528 <code>lsof</code> \u547d\u4ee4\u8fc7\u6ee4\u670d\u52a1\u5668 IP \u67e5\u627e\u51fa webdav \u7f51\u7edc\u8fde\u63a5\u548c\u8fdb\u7a0b PID\u3002</p> <p>Question</p> <p>lsof \u663e\u793a\u6709\u4e9b TCP \u8fde\u63a5\u5904\u4e8e <code>SYN_SENT</code> \u72b6\u6001\u4e00\u76f4\u7b49\u5f85\u670d\u52a1\u5668\u786e\u8ba4\uff0c\u5177\u4f53\u6709\u5f85\u8fdb\u4e00\u6b65\u7814\u7a76\u5206\u6790\u3002</p> <pre><code>$ ps aux | grep webdav\n# or\n$ lsof -nPi4 +c0 +M | grep 192.168.0.100\n</code></pre> <p>\u5047\u8bbe\u83b7\u53d6\u5230\u8fdb\u7a0b\u7684 COMMAND=<code>webdavfs_agent</code>\uff0c PID=<code>3231</code>\uff0c\u6267\u884c kill \u547d\u4ee4\u6740\u6b7b webdav \u8fdb\u7a0b\uff0cFinder \u91cd\u83b7\u65b0\u751f\u3002</p> <pre><code>$ sudo kill -9 3231\n# or\n$ sudo killall -9 webdavfs_agent\n</code></pre> <p>\u53c2\u8003\uff1a</p> <ul> <li> <p>Webdav slowness problem on catalina and Big Sur (Finder)</p> </li> <li> <p>How to forceably unmount stuck network share in Mac OS X?</p> </li> </ul> <p>\u5bf9\u4e8e\u7a0d\u5927\u4e00\u70b9\u6587\u4ef6\u7684\u7f16\u8f91\u540c\u6b65\uff0cFinder \u5361\u6b7b\u95ee\u9898\u9891\u53d1\uff0c\u786e\u5b9e\u4ee4\u4eba\u5934\u75db\u4e0d\u5df2\u3002 \u4e0d\u60f3\u6298\u817e\uff0c\u679c\u65ad\u5f03\u5751\uff0c\u73b0\u5df2\u6539\u88c5 nginx \u914d\u7f6e webdav \u670d\u52a1\uff0c\u53c2\u8003 macOS\u91cd\u88c5nginx-full\u5e76\u914d\u7f6eWebDav\u3002 \u5ba2\u6237\u7aef\u6539\u7528\u514d\u8d39\u7684 Cyberduck\uff0c\u642d\u914d rclone+crontab \u5b9a\u65f6\u81ea\u52a8\u540c\u6b65\u5907\u4efd\uff0cthey just work like a charm!</p>","tags":["webDAV","umask"]},{"location":"blog/20240318/nginx-control/","title":"nginx\u67e5\u770b\u65e5\u5fd7\u53ca\u63a7\u5236\u547d\u4ee4","text":"<p>nginx \u914d\u7f6e\u6587\u4ef6\u5728\u54ea\u91cc\uff1f\u65e5\u5fd7\u6587\u4ef6\u5728\u54ea\u91cc\uff1f\u5982\u4f55\u5b9e\u65f6\u6eda\u52a8\u67e5\u770b nginx \u65e5\u5fd7\uff1f\u5982\u4f55\u63a7\u5236\u8fd0\u884c\u4e2d\u7684 nginx \u8fdb\u7a0b\uff1f</p> <p>\u6267\u884c <code>nginx -h</code> \u67e5\u770b\u5e2e\u52a9\uff1a</p> <pre><code>$ nginx -h\nnginx version: nginx/1.18.0 (Ubuntu)\nUsage: nginx [-?hvVtTq] [-s signal] [-c filename] [-p prefix] [-g directives]\n\nOptions:\n  -?,-h         : this help\n  -v            : show version and exit\n  -V            : show version and configure options then exit\n  -t            : test configuration and exit\n  -T            : test configuration, dump it and exit\n  -q            : suppress non-error messages during configuration testing\n  -s signal     : send signal to a master process: stop, quit, reopen, reload\n  -p prefix     : set prefix path (default: /usr/share/nginx/)\n  -c filename   : set configuration file (default: /etc/nginx/nginx.conf)\n  -g directives : set global directives out of configuration file\n</code></pre> <p>\u542f\u52a8\u65f6\u53ef\u4ee5\u901a\u8fc7 <code>-p</code> \u9009\u9879\u6307\u5b9a\u5de5\u4f5c\u76ee\u5f55\uff0c\u901a\u8fc7 <code>-c</code> \u9009\u9879\u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\u3002</p>","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#start","title":"start","text":"<pre><code>$ cd ~/workspace\n$ mkdir nginx &amp;&amp; cd nginx\n$ mkdir conf &amp;&amp; cd conf\n# touch nginx.conf\n$ vim nginx.conf\n</code></pre> <p>\u5728 nginx.conf \u4e2d\u589e\u52a0\u53cd\u5411\u4ee3\u7406\u8f6c\u53d1\u914d\u7f6e\u3002</p> <ol> <li>\u68c0\u6d4b\u914d\u7f6e\u6587\u4ef6\uff1anginx -t -c <code>pwd</code>/nginx.conf</li> <li>\u542f\u52a8nginx\u670d\u52a1\uff1anginx -p <code>pwd</code>/ -c nginx.conf</li> </ol>","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#log","title":"log","text":"","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#\u65e5\u5fd7\u6587\u4ef6\u5728\u54ea\u91cc","title":"\u65e5\u5fd7\u6587\u4ef6\u5728\u54ea\u91cc\uff1f","text":"<p>Where can I find the error logs of nginx, using FastCGI and Django?</p> <p>brew install \u7684 nginx-full\uff0c/usr/local/etc/nginx/nginx.conf \u4e2d\u6ca1\u6709\u5f00\u542f access_log \u548c error_log\uff0c\u9ed8\u8ba4 log path \u5728\u54ea\u91cc\uff1f</p> <p>\u53ef\u4ee5\u6267\u884c <code>nginx -h</code>\uff0c\u5728 <code>-c filename</code> \u9009\u9879\u540e\u9762\u53ef\u4ee5\u770b\u5230 default configuration file\u3002</p> <p>You can use <code>lsof</code> (list of open files) in most cases to find open log files without knowing the configuration.</p> <pre><code># macOS\n~$ ps aux | grep nginx\nfaner            33741   0.0  0.0 35126068   3596   ??  S     7:34AM   0:00.30 nginx: worker process\nroot             33691   0.0  0.0 34425616   6392   ??  Ss    7:34AM   0:00.03 nginx: master process /usr/local/opt/nginx-full/bin/nginx -g daemon off;\n\n~$ lsof -p 33741 | grep log\nnginx   33741 faner    1u     REG              1,13        0            25121281 /usr/local/var/log/nginx.log\nnginx   33741 faner    2w     REG              1,13    51695             3821144 /usr/local/var/log/nginx/error.log\nnginx   33741 faner    4w     REG              1,13  2103983             3821142 /usr/local/var/log/nginx/access.log\nnginx   33741 faner    5w     REG              1,13    51695             3821144 /usr/local/var/log/nginx/error.log\n</code></pre>","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#\u65e5\u5fd7\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa","title":"\u65e5\u5fd7\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa","text":"<p>Nginx\u65e5\u5fd7\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa</p> <pre><code>daemon off;\nerror_log /dev/stdout warn;\naccess_log /dev/stdout main;\n</code></pre>","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#tail\u5b9e\u65f6\u6eda\u52a8\u663e\u793alog","title":"tail\u5b9e\u65f6\u6eda\u52a8\u663e\u793alog","text":"<p>tail\u5b9e\u65f6\u6eda\u52a8\u663e\u793alog\u6587\u4ef6\u5185\u5bb9</p> <p>Linux \u4e2d\u6709\u4e00\u4e2a <code>tail</code> \u547d\u4ee4\uff0c\u5e38\u7528\u6765\u663e\u793a\u4e00\u4e2a\u6587\u4ef6\u7684\u6700\u540en\u884c\u6587\u6863\u5185\u5bb9\u3002</p> <p>\u4f46\u5728\u66f4\u591a\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u8981\u5728\u670d\u52a1\u5668\u7aef\u8fd0\u884c\u7a0b\u5e8f\uff0c\u5e76\u4e14\u9700\u8981\u5b9e\u65f6\u76d1\u63a7\u8fd0\u884c\u65e5\u5fd7\uff0c\u8fd9\u65f6\u5019\u6709\u4ec0\u4e48\u529e\u6cd5\u5b9e\u65f6\u6eda\u52a8\u663e\u793alog\u6587\u4ef6\u5185\u5bb9\uff1f</p> <p><code>tail</code> \u547d\u4ee4\u52a0 <code>-f</code> \u53c2\u6570\u53ef\u4ee5\u6ee1\u8db3\u8fd9\u4e00\u9700\u6c42\uff0c\u5177\u4f53\u7528\u6cd5\u5982\u4e0b\uff1a</p> <pre><code># macOS\ntail -f /usr/local/var/log/nginx/error.log\n# ubuntu\ntail -f /var/log/nginx/webdav.error.log\n</code></pre>","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#nginx_-s","title":"nginx -s","text":"<p>Controlling NGINX Processes at Runtime</p> <p>To reload your configuration, you can stop or restart NGINX, or send signals to the master process. A signal can be sent by running the <code>nginx</code> command (invoking the NGINX executable) with the <code>-s</code> argument.</p> <pre><code>nginx -s &lt;SIGNAL&gt;\n</code></pre> <p>where <code>&lt;SIGNAL&gt;</code> can be one of the following:</p> <ul> <li><code>quit</code> \u2013 Shut down gracefully (the <code>SIGQUIT</code> signal)</li> <li><code>reload</code> \u2013 Reload the configuration file (the <code>SIGHUP</code> signal)</li> <li><code>reopen</code> \u2013 Reopen log files (the <code>SIGUSR1</code> signal)</li> <li><code>stop</code> \u2013 Shut down immediately (or fast shutdown, the <code>SIGTERM</code> singal)</li> </ul> <p>For more information about advanced signals (for performing live binary upgrades, for example), see Controlling nginx at nginx.org.</p> <p><code>nginx -s</code> \u547d\u4ee4\uff1a</p> <pre><code># Shut down gracefully (the `SIGQUIT` signal)\nnginx -s quit\n# Shut down immediately (or fast shutdown, the `SIGTERM` singal)\nnginx -s stop\n# Reload the configuration file (the `SIGHUP` signal)\nnginx -s reload\n# Reopen log files (the `SIGUSR1` signal)  \nnginx -s reopen\n</code></pre>","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#kill_-sig","title":"kill -SIG","text":"<p>The <code>kill</code> utility can also be used to send a signal directly to the master process. The process ID of the master process is written, by default, to the nginx.pid file, which is located in the /usr/local/nginx/logs or /var/run directory.</p>","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#pid","title":"pid","text":"<p>The process ID of the master process is written to the file <code>/usr/local/nginx/logs/nginx.pid</code> by default. This name may be changed at configuration time, or in <code>nginx.conf</code> using the pid directive.</p> <p>macOS \u4e0b\u901a\u8fc7 brew \u5b89\u88c5\u7684nginx \u9ed8\u8ba4pid\u5b58\u50a8\u8def\u5f84\u662f  <code>/usr/local/var/run/nginx.pid</code></p> <pre><code># \u67e5\u770bpid\u6587\u4ef6\u4e2d\u5b58\u50a8\u7684 master_pid\n$ cat /usr/local/var/run/nginx.pid\n7524\n\n# \u67e5\u8be2nginx\u8fdb\u7a0b\n$ ps -lef | grep -i nginx:\n  501  7524     1        4   0  31  0  4337568    692 -      Ss                  0 ??         0:00.00 nginx: master pr  7:32AM\n  501  7525  7524        4   0  31  0  4337628    812 -      S                   0 ??         0:00.00 nginx: worker pr  7:32AM\n\n# \u67e5\u8be2\u63d0\u53d6nginx\u8fdb\u7a0b\u53f7\n$ ps -lef | grep -i nginx: | awk '{ print $2}'\n7524\n7525\n</code></pre>","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#sig","title":"SIG","text":"<p>nginx can be controlled with signals.</p> <p>\u5173\u4e8e\u4fe1\u53f7\u91cf\uff0c\u53ef\u4ee5 man signal \u67e5\u770b\u8bf4\u660e\u6587\u6863\uff1a</p> No Name Default Action Description 1 SIGHUP terminate process terminal line hangup 2 SIGINT terminate process interrupt program 3 SIGQUIT create core image quit program 9 SIGKILL terminate process kill program 15 SIGTERM terminate process software termination signal 30 SIGUSR1 terminate process User defined signal 1 <p>nginx\u542f\u52a8\u3001\u91cd\u542f\u3001\u5173\u95ed How to stop nginx on Mac OS X nginx reload \u62a5\u9519\uff0c\u5f7b\u5e95\u6740\u6b7bnginx\u8fdb\u7a0b</p> <p>\u82e5 nginx.conf \u914d\u7f6e\u4e86\u4e3b\u8fdb\u7a0bpid\uff08master_pid\uff09\u7684\u5b58\u50a8\u8def\u5f84\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u8bfb\u53d6pid\u6267\u884ckill\u547d\u4ee4\u53d1\u9001\u4fe1\u53f7\u3002</p> <p>\u8c03\u7528 <code>kill</code> \u547d\u4ee4\u53d1\u9001\u4fe1\u53f7\u64cd\u63a7nginx\u8fdb\u7a0b\uff1a</p> <pre><code># \u4ece\u5bb9\u505c\u6b62\u4e3b\u8fdb\u7a0b\nkill -QUIT `cat /usr/local/var/run/nginx.pid`\n# \u5feb\u901f\u505c\u6b62\u4e3b\u8fdb\u7a0b\nkill -TERM `cat /usr/local/var/run/nginx.pid`\nkill -INT `cat /usr/local/var/run/nginx.pid`\n# \u5e73\u6ed1\u91cd\u542f\nkill -HUP `cat /usr/local/var/run/nginx.pid`\n# \u5f3a\u5236\u505c\u6b62\u540d\u79f0\u5305\u542bnginx\u7684\u8fdb\u7a0b\npkill -KILL nginx  \n# \u5f3a\u5236\u505c\u6b62\u6240\u6709nginx\u8fdb\u7a0b\nps -lef | grep -i nginx: | awk '{ print $2}' | xargs kill -KILL\n</code></pre>","tags":["nginx"]},{"location":"blog/20240318/nginx-control/#services","title":"services","text":"<p>\u5728\u5177\u4f53\u7684\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u4e0a\uff0c\u63d0\u4f9b\u4e86\u76f8\u5e94\u7684\u670d\u52a1\u7ba1\u7406\u5de5\u5177\uff0c\u4f8b\u5982 brew services \u5728 macOS \u4e0a\u8c03\u7528 launchctl\uff0c\u5728 linux \u4e0b\u8c03\u7528 systemctl \u6765\u7ba1\u7406\u670d\u52a1\u3002</p> <pre><code>$ brew help services\nUsage: brew services [subcommand]\n\nManage background services with macOS' launchctl(1) daemon manager or Linux's\nsystemctl(1) service manager.\n</code></pre>","tags":["nginx"]},{"location":"blog/20240318/rclone-access-webdav/","title":"\u4f7f\u7528rclone\u8bbf\u95ee\u64cd\u4f5cWebDav\u4e91\u76d8","text":"<p>\u5728\u300a\u4f7f\u7528\u547d\u4ee4\u884c\u6302\u8f7d\u64cd\u4f5cWebDav\u4e91\u76d8\u300b\u4e2d\u68b3\u7406\u4e86 macOS/Linux \u4e0b\u8c03\u7528 mount \u547d\u4ee4\u6302\u8f7d WebDAV \u4e91\u76d8\u5230\u672c\u5730\u7684\u57fa\u672c\u64cd\u4f5c\uff0c\u5e76\u4e14\u793a\u4f8b\u4e86\u5982\u4f55\u4f7f\u7528 curl \u547d\u4ee4\u884c\u8bbf\u95ee\u64cd\u4f5c WebDAV \u4e91\u76d8\u3002</p> <p>\u672c\u6587\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u770b\u5982\u4f55\u4f7f\u7528\u5f3a\u5927\u7684 rclone \u547d\u4ee4\u884c\u5de5\u5177\u914d\u7f6e\u6302\u8f7d WebDAV \u4e91\u76d8\uff0c\u5e76\u5bf9\u6807 curl \u68b3\u7406 rclone \u8bbf\u95ee\u64cd\u63a7 webDAV \u4e91\u76d8\u7684\u5e38\u7528\u547d\u4ee4\u3002</p> <p>rclone works like a charm!</p> <p>rclone: Rclone syncs your files to cloud storage</p> <p>Users call rclone \"The Swiss army knife of cloud storage\", and \"Technology indistinguishable from magic\".</p> <p>Rclone has powerful cloud equivalents to the unix commands <code>rsync</code>, <code>cp</code>, <code>mv</code>, <code>mount</code>, <code>ls</code>, <code>ncdu</code>, <code>tree</code>, <code>rm</code>, and <code>cat</code>. Rclone's familiar syntax includes shell pipeline support, and <code>--dry-run</code> protection. It is used at the command line, in scripts or via its API.</p> <p>Rclone mounts any local, cloud or virtual filesystem as a disk on Windows, macOS, linux and FreeBSD, and also serves these over SFTP, HTTP, WebDAV, FTP and DLNA.</p> <p>Rclone is mature, open-source software originally inspired by rsync and written in Go.</p>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#install","title":"install","text":"<p>macOS \u4e0b\u4f7f\u7528\u5305\u7ba1\u7406\u5668 <code>brew</code> \u641c\u7d22\u5b89\u88c5 rclone\uff1bubuntu \u4e0b\u4f7f\u7528\u5305\u7ba1\u7406\u5668 <code>apt</code> \u641c\u7d22\u5b89\u88c5 rclone\u3002</p> macOSubuntu <ul> <li><code>brew search rclone</code>: \u641c\u7d22 rclone \u5305</li> <li><code>brew info rclone</code>: \u663e\u793a rclone \u5305\u4fe1\u606f</li> <li><code>brew install rclone</code>: \u5b89\u88c5 rclone</li> </ul> <ul> <li><code>apt search rclone</code>: \u641c\u7d22 rclone \u76f8\u5173\u5305</li> <li><code>apt list rclone</code>: \u641c\u7d22\u5339\u914d\u5305\u540d rclone</li> <li><code>apt show rclone</code>: \u663e\u793a rclone \u5305\u8be6\u7ec6\u4fe1\u606f</li> <li><code>[sudo] apt install rclone</code>: \u5b89\u88c5 rclone</li> </ul> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6267\u884c <code>rclone version</code> \u67e5\u770b\u7248\u672c\u4fe1\u606f\uff1a</p> macOSubuntu <pre><code>$ rclone version\nrclone v1.66.0\n- os/version: darwin 14.5 (64 bit)\n- os/kernel: 23.5.0 (x86_64)\n- os/type: darwin\n- os/arch: amd64\n- go/version: go1.22.1\n- go/linking: dynamic\n- go/tags: none\n</code></pre> <pre><code>$ rclone version\nrclone v1.53.3-DEV\n- os/arch: linux/arm64\n- go version: go1.18.1\n</code></pre> <p>\u6267\u884c <code>rclone config paths</code>\u3001<code>rclone config show</code> \u67e5\u770b\u914d\u7f6e\u4fe1\u606f\u3002</p>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#docs","title":"docs","text":"<p>Overview of cloud storage systems</p> <ul> <li>Local Filesystem</li> <li>WebDAV</li> </ul> <p>Commands Index</p> <ul> <li>This is an index of all commands in rclone. Run <code>rclone command --help</code> to see the help for that command.</li> </ul> <p>rclone mount / nfsmount</p> <p>rclone serve - webdav</p> <p>Remote Control / API - GUI</p> <p>Usage: Filtering, Flags</p> <p>--log-file=FILE / log-level-level</p> <p>--log-level LEVEL</p> <p>This sets the log level for rclone. The default log level is NOTICE.</p> <ol> <li>DEBUG is equivalent to -vv. It outputs lots of debug info - useful for bug reports and really finding out what rclone is doing.</li> <li>INFO is equivalent to -v. It outputs information about each transfer and prints stats once a minute by default.</li> <li>NOTICE is the default log level if no logging flags are supplied. It outputs very little when things are working normally. It outputs warnings and significant events.</li> <li>ERROR is equivalent to <code>-q</code>. It only outputs error messages.</li> </ol>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#config","title":"config","text":"<p>\u5728\u547d\u4ee4\u884c\u8f93\u5165 <code>rclone config</code> \u8fdb\u5165\u4ea4\u4e92\u5f0f\u914d\u7f6e\u4f1a\u8bdd\u3002</p>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#config_webdav","title":"config webdav","text":"<p>\u4ee5\u4e0b\u4f7f\u7528 <code>rclone config</code> \u4ea4\u4e92\u5f0f\u914d\u7f6e webDAV \u670d\u52a1\uff0c\u5176\u4e2d\u9ad8\u4eae\u884c\u662f\u4ea4\u4e92\u8f93\u5165\u3002</p> rclone config webdav <pre><code>$ rclone config\nNo remotes found, make a new one?\nn) New remote\ns) Set configuration password\nq) Quit config\nn/s/q&gt; n\n\nEnter name for new remote.\nname&gt; webdav@rpi4b\n\nOption Storage.\nType of storage to configure.\nChoose a number from below, or type in your own value.\n1 / 1Fichier\n\\ (fichier)\n2 / Akamai NetStorage\n\\ (netstorage)\n3 / Alias for an existing remote\n\\ (alias)\n4 / Amazon S3 Compliant Storage Providers including AWS, Alibaba, ArvanCloud, Ceph, ChinaMobile, Cloudflare, DigitalOcean, Dreamhost, GCS, HuaweiOBS, IBMCOS, IDrive, IONOS, LyveCloud, Leviia, Liara, Linode, Minio, Netease, Petabox, RackCorp, Rclone, Scaleway, SeaweedFS, StackPath, Storj, Synology, TencentCOS, Wasabi, Qiniu and others\n\\ (s3)\n5 / Backblaze B2\n\\ (b2)\n6 / Better checksums for other remotes\n\\ (hasher)\n7 / Box\n\\ (box)\n8 / Cache a remote\n\\ (cache)\n9 / Citrix Sharefile\n\\ (sharefile)\n10 / Combine several remotes into one\n\\ (combine)\n11 / Compress a remote\n\\ (compress)\n12 / Dropbox\n\\ (dropbox)\n13 / Encrypt/Decrypt a remote\n\\ (crypt)\n14 / Enterprise File Fabric\n\\ (filefabric)\n15 / FTP\n\\ (ftp)\n16 / Google Cloud Storage (this is not Google Drive)\n\\ (google cloud storage)\n17 / Google Drive\n\\ (drive)\n18 / Google Photos\n\\ (google photos)\n19 / HTTP\n\\ (http)\n20 / Hadoop distributed file system\n\\ (hdfs)\n21 / HiDrive\n\\ (hidrive)\n22 / ImageKit.io\n\\ (imagekit)\n23 / In memory object storage system.\n\\ (memory)\n24 / Internet Archive\n\\ (internetarchive)\n25 / Jottacloud\n\\ (jottacloud)\n26 / Koofr, Digi Storage and other Koofr-compatible storage providers\n\\ (koofr)\n27 / Linkbox\n\\ (linkbox)\n28 / Local Disk\n\\ (local)\n29 / Mail.ru Cloud\n\\ (mailru)\n30 / Mega\n\\ (mega)\n31 / Microsoft Azure Blob Storage\n\\ (azureblob)\n32 / Microsoft Azure Files\n\\ (azurefiles)\n33 / Microsoft OneDrive\n\\ (onedrive)\n34 / OpenDrive\n\\ (opendrive)\n35 / OpenStack Swift (Rackspace Cloud Files, Blomp Cloud Storage, Memset Memstore, OVH)\n\\ (swift)\n36 / Oracle Cloud Infrastructure Object Storage\n\\ (oracleobjectstorage)\n37 / Pcloud\n\\ (pcloud)\n38 / PikPak\n\\ (pikpak)\n39 / Proton Drive\n\\ (protondrive)\n40 / Put.io\n\\ (putio)\n41 / QingCloud Object Storage\n\\ (qingstor)\n42 / Quatrix by Maytech\n\\ (quatrix)\n43 / SMB / CIFS\n\\ (smb)\n44 / SSH/SFTP\n\\ (sftp)\n45 / Sia Decentralized Cloud\n\\ (sia)\n46 / Storj Decentralized Cloud Storage\n\\ (storj)\n47 / Sugarsync\n\\ (sugarsync)\n48 / Transparently chunk/split large files\n\\ (chunker)\n49 / Union merges the contents of several upstream fs\n\\ (union)\n50 / Uptobox\n\\ (uptobox)\n51 / WebDAV\n\\ (webdav)\n52 / Yandex Disk\n\\ (yandex)\n53 / Zoho\n\\ (zoho)\n54 / premiumize.me\n\\ (premiumizeme)\n55 / seafile\n\\ (seafile)\nStorage&gt; 51 # \u6ce8\u91ca\uff1a\u6216\u76f4\u63a5\u8f93\u5165 webdav\n\nOption url.\nURL of http host to connect to.\nE.g. https://example.com.\nEnter a value.\nurl&gt; http://rpi4b-ubuntu.local:81/webdav/\n\nOption vendor.\nName of the WebDAV site/service/software you are using.\nChoose a number from below, or type in your own value.\nPress Enter to leave empty.\n1 / Fastmail Files\n\\ (fastmail)\n2 / Nextcloud\n\\ (nextcloud)\n3 / Owncloud\n\\ (owncloud)\n4 / Sharepoint Online, authenticated by Microsoft account\n\\ (sharepoint)\n5 / Sharepoint with NTLM authentication, usually self-hosted or on-premises\n\\ (sharepoint-ntlm)\n6 / rclone WebDAV server to serve a remote over HTTP via the WebDAV protocol\n\\ (rclone)\n7 / Other site/service or software\n\\ (other)\nvendor&gt; 7\n\nOption user.\nUser name.\nIn case NTLM authentication is used, the username should be in the format 'Domain\\User'.\nEnter a value. Press Enter to leave empty.\nuser&gt; xman\n\nOption pass.\nPassword.\nChoose an alternative below. Press Enter for the default (n).\ny) Yes, type in my own password\ng) Generate random password\nn) No, leave this optional password blank (default)\ny/g/n&gt; y\nEnter the password:\npassword:\nConfirm the password:\npassword:\n\nOption bearer_token.\nBearer token instead of user/pass (e.g. a Macaroon).\nEnter a value. Press Enter to leave empty.\nbearer_token&gt; # \u6ce8\u91ca\uff1a\u8fd9\u91cc\u6682\u65f6\u76f4\u63a5\u56de\u8f66\u5ffd\u7565\n\nEdit advanced config?\ny) Yes\nn) No (default)\ny/n&gt; n\n\nConfiguration complete.\nOptions:\n- type: webdav\n- url: http://rpi4b-ubuntu.local:81/webdav/\n- vendor: other\n- user: xman\n- pass: *** ENCRYPTED ***\nKeep this \"webdav@rpi4b\" remote?\ny) Yes this is OK (default)\ne) Edit this remote\nd) Delete this remote\ny/e/d&gt; y\n\nCurrent remotes:\n\nName                 Type\n====                 ====\nwebdav@rpi4b         webdav\n\ne) Edit existing remote\nn) New remote\nd) Delete remote\nr) Rename remote\nc) Copy remote\ns) Set configuration password\nq) Quit config\ne/n/d/r/c/s/q&gt; q\n</code></pre> <p>\u8fd9\u91cc\u793a\u4f8b\u914d\u7f6e webDAV\uff0c\u4e5f\u53ef\u9009\u62e9\u914d\u7f6e\u672c\u5730\u78c1\u76d8\uff08\u6216\u5916\u6302\u786c\u76d8/SSD\uff09\u6216\u5c40\u57df\u7f51 SMB \u7b49 FS\uff08File Sharing\uff09\u670d\u52a1\u3002</p> <ul> <li>28 / Local Disk \\ (local)</li> <li>43 / SMB / CIFS \\ (smb)</li> </ul> <p>\u5982\u679c\u4e2d\u9014\u4e0d\u5c0f\u5fc3\u8f93\u9519\u6216\u540e\u7eed\u60f3\u66f4\u6539\u914d\u7f6e\uff0c\u53ef\u8f93\u5165 <code>rclone config edit</code> \u9009\u62e9\u7f16\u8f91\u5df2\u6709\u7684\u914d\u7f6e\u3002</p> <p>\u26a0\ufe0f\uff1a\u5728 ubuntu \u4e2d\uff0cremote name \u4e2d\u4e0d\u80fd\u5305\u542b @ \u7b26\u53f7\uff0c\u53ef\u6539\u4e3a - \u66ff\u4ee3\uff1awebdav-rpi4b\u3002</p>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#config_show","title":"config show","text":"<p>rclone config \u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u53ef\u8c03\u7528\u76f8\u5173\u547d\u4ee4 dump/show \u76f8\u5173\u914d\u7f6e\u4fe1\u606f\uff1a</p> Command Description rclone config paths Show paths used for configuration, cache, temp etc. rclone config file Show path of configuration file in use. rclone config show Print (decrypted) config file, or the config for a single remote. rclone config dump Dump the config file as JSON. rclone listremotes List all the remotes in the config file and defined in environment variables. <p>\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a</p> <pre><code>$ rclone config paths\nConfig file: /Users/faner/.config/rclone/rclone.conf\nCache dir:   /Users/faner/Library/Caches/rclone\nTemp dir:    /var/folders/k6/7f8bh1ws4ygfg9pcq48w5tk00000gn/T\n\n$ rclone config file\nConfiguration file is stored at:\n/Users/faner/.config/rclone/rclone.conf\n</code></pre> <p>\u67e5\u770b\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\uff1a</p> <pre><code>$ rclone config show\n[webdav@rpi4b]\ntype = webdav\nurl = http://rpi4b-ubuntu.local:81/webdav/\nvendor = other\nuser = xman\npass = *** ENCRYPTED ***\n\n$ rclone config dump\n{\n    \"webdav@rpi4b\": {\n        \"pass\": \"*** ENCRYPTED ***\",\n        \"type\": \"webdav\",\n        \"url\": \"http://rpi4b-ubuntu.local:81/webdav/\",\n        \"user\": \"xman\",\n        \"vendor\": \"other\"\n    }\n}%\n</code></pre> <p>\u5217\u4e3e\u914d\u7f6e\u6587\u4ef6\u4e2d\u5df2\u914d\u7f6e\u7684\u8fdc\u7aef\u670d\u52a1\uff08\u540d\u79f0\uff09\uff1a</p> <pre><code>$ rclone listremotes\nwebdav@rpi4b:\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#ls","title":"ls","text":"<p><code>ls</code> \u7cfb\u5217\u547d\u4ee4\u8bed\u4e49\u540c bash shell \u4e2d\u7684 <code>ls</code>\uff0c\u62c9\u53d6\u8fdc\u7aef\u76ee\u5f55\uff08fetch remote:path\uff09\u5e76\u663e\u793a\u5217\u8868\uff08list\uff09\u3002</p> <p>Commands Index</p> Command Description rclone ls List the objects in the path with size and path. rclone lsd List all directories/containers/buckets in the path. rclone lsf List directories and objects in remote:path formatted for parsing. rclone lsjson List directories and objects in the path in JSON format. rclone lsl List the objects in path with modification time, size and path. rclone tree List the contents of the remote in a tree like fashion. rclone cat Concatenates any files and sends them to stdout. <p>There are several related list commands:</p> <ul> <li><code>ls</code>\u00a0to list size and path of objects only\uff08\u6587\u4ef6\uff09</li> <li><code>lsl</code>\u00a0to list modification time, size and path of objects only\uff08\u6587\u4ef6\uff09</li> <li><code>lsd</code>\u00a0to list directories only\uff08\u76ee\u5f55\uff09</li> <li><code>lsf</code>\u00a0to list objects and directories in easy to parse format\uff08\u76ee\u5f55+\u6587\u4ef6\uff09</li> <li><code>lsjson</code>\u00a0to list objects and directories in JSON format\uff08\u76ee\u5f55+\u6587\u4ef6\uff09</li> </ul> <p><code>ls</code>,<code>lsl</code>,<code>lsd</code>\u00a0are designed to be human-readable.\u00a0<code>lsf</code>\u00a0is designed to be human and machine-readable.\u00a0<code>lsjson</code>\u00a0is designed to be machine-readable.</p>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#ls_lsl","title":"ls, lsl","text":"<p>Note that\u00a0<code>ls</code>\u00a0and\u00a0<code>lsl</code>\u00a0recurse by default - use\u00a0<code>--max-depth 1</code>\u00a0to stop the recursion.</p> <p><code>ls</code> \u547d\u4ee4\u9012\u5f52\u5217\u4e3e\u6839\u8def\u5f84\u4e0b\u7684\u6240\u6709\u6587\u4ef6\uff08\u5927\u5c0f\u548c\u8def\u5f84\uff09\uff1a</p> <pre><code>$ rclone ls webdav@rpi4b:\n      ...\n\n$ rclone tree webdav@rpi4b:\n      ...\n</code></pre> <p><code>ls</code> \u547d\u4ee4\u9012\u5f52\u5217\u4e3e <code>/mkdocs</code> \u4e0b\u7684\u6240\u6709\u6587\u4ef6\uff08\u663e\u793a\u5927\u5c0f\u548c\u8def\u5f84\uff09\uff1a</p> <pre><code>$ rclone ls webdav@rpi4b:/mkdocs\n      310 hello-world-2.c\n      310 hello-world-3.c\n      310 hello-world-4.c\n      279 hello-world.c\n</code></pre> <p><code>lsl</code> \u547d\u4ee4\u76f8\u6bd4 <code>ls</code> \u589e\u52a0\u663e\u793a\u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\uff08modification time\uff09\uff1a</p> <pre><code>$ rclone lsl webdav@rpi4b:\n      ...\n\n# /\u8868\u793a\u6839\u8def\u5f84\uff0c\u53ef\u7701\u7565\n$ rclone lsl webdav@rpi4b:/mkdocs\n      310 2024-04-01 18:05:13.000000000 hello-world-2.c\n      310 2024-04-01 18:05:18.000000000 hello-world-3.c\n      310 2024-04-01 18:25:27.000000000 hello-world-4.c\n      279 2024-04-01 18:02:26.000000000 hello-world.c\n</code></pre> <p><code>lsl</code> \u547d\u4ee4\u9012\u5f52\u5217\u4e3e\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>--max-depth</code> \u9650\u5236\u9012\u5f52\u5c42\u7ea7\uff1a</p> <pre><code># \u53ea\u5217\u4e3e\u663e\u793a\u4e00\u7ea7\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --max-depth 2\n\n$ rclone lsl webdav@rpi4b: --include \"/*/*\"\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u4f7f\u7528 <code>--include</code> \u9009\u9879\uff0c\u8fc7\u6ee4\u5217\u4e3e\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff1a</p> <pre><code># \u53ea\u5217\u4e3e CS \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --include \"CS/*\"\n\n# \u53ea\u5217\u4e3e\u4ee5 CS- \u4e3a\u524d\u7f00\u7684\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --include \"CS-*/*\"\n\n# \u53ea\u5217\u4e3e CS-System \u548c CS-Network \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --include \"CS-{System, Network}/*\"\n\n# \u9012\u5f52\u5217\u4e3e CS \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --include \"CS/**\"\n\n# \u9012\u5f52\u5217\u4e3e\u4ee5 CS- \u4e3a\u524d\u7f00\u7684\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --include \"CS-*/**\"\n\n# \u53ea\u9012\u5f52\u5217\u4e3e CS-System \u548c CS-Network \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --include \"CS-{System, Network}/**\"\n</code></pre> <p>\u4ee5\u4e0b\u6309\u6587\u4ef6\u540e\u7f00\u8fc7\u6ee4\uff1a</p> <pre><code>rclone lsl smbhd@rpi4b:WDHD/backups/ --include \"*.DS_Store\"\n     6148 2024-04-17 15:55:15.000000000 .DS_Store\n     4096 2024-04-17 15:55:15.000000000 ._.DS_Store\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>--exclude</code> \u9009\u9879\uff0c\u6392\u9664\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff1a</p> <pre><code># \u4e0d\u9012\u5f52\u5217\u4e3e CS \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --exclude \"CS/**\"\n\n# \u4e0d\u9012\u5f52\u5217\u4e3e\u4ee5 CS- \u4e3a\u524d\u7f00\u7684\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --exclude \"CS-*/**\"\n\n# \u4e0d\u9012\u5f52\u5217\u4e3e CS-System \u548c CS-Network \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --include \"CS-{System, Network}/**\"\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>--min-age</code>/<code>--max-age</code> \u6309\u7167\u6700\u540e\u6539\u52a8\u65f6\u95f4\u8fc7\u6ee4\uff1a</p> <pre><code># \u8fc7\u6ee4\u663e\u793a\u4e00\u5e74\u524d\u6700\u540e\u6539\u52a8\uff08\u6700\u8fd1\u4e00\u5e74\u6ca1\u6709\u6539\u52a8\uff09\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --min-age 1y\n\n# \u8fc7\u6ee4\u663e\u793a 2h \u5185\u6709\u6539\u52a8\u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --max-age 2h\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u4f7f\u7528 <code>--min-size</code>/<code>--max-size</code> \u6309\u7167\u6587\u4ef6\u5927\u5c0f\u8fc7\u6ee4\uff1a</p> <pre><code># \u8fc7\u6ee4\u663e\u793a\u5927\u4e8e 10M \u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --min-size 10M\n\n# \u8fc7\u6ee4\u663e\u793a\u5c0f\u4e8e 1M \u7684\u6587\u4ef6\n$ rclone lsl webdav@rpi4b: --max-size 1M\n</code></pre> <p>Rclone Filtering</p> <p>\u5173\u4e8e\u8fc7\u6ee4\u9009\u9879\u53c2\u6570\uff0c\u53c2\u8003\u5b98\u65b9\u6587\u6863 Rclone Filtering \u4e2d\u7684\u8bb2\u89e3\u793a\u4f8b\u548c\u8bba\u575b\u4e2d\u7684\u76f8\u5173\u8ba8\u8bba\u3002</p> <ul> <li>Include-from intersection of patterns</li> <li>How to specify what folders to sync and what to exclude -- include, exclude, filter?</li> <li>Rclone copy using regex expression using include multiple expression for file name</li> </ul>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#lsd_lsf_lsjson","title":"lsd, lsf, lsjson","text":"<p>The other list commands\u00a0<code>lsd</code>,<code>lsf</code>,<code>lsjson</code>\u00a0do not recurse by default - use\u00a0<code>-R</code>\u00a0to make them recurse.</p> <p><code>lsd</code> \u547d\u4ee4\u663e\u793a\u6307\u5b9a\u8def\u5f84\uff08\u6839\u76ee\u5f55\uff09\u4e0b\u7684\u76ee\u5f55/\u5bb9\u5668/\u6876\uff1a</p> <pre><code>$ rclone lsd webdav@rpi4b:\n          -1 2024-04-05 08:34:31        -1 CS\n          -1 2024-04-03 10:53:51        -1 English_Docs\n          -1 2024-03-25 10:17:59        -1 The_Economist\n          -1 2024-04-01 18:25:31        -1 mkdocs\n</code></pre> <p><code>lsf</code> \u547d\u4ee4\u4ee5\u4e00\u79cd\u7b80\u5355\u7684\u65b9\u5f0f\u5217\u4e3e\u76ee\u5f55\uff08\u548c\u6587\u4ef6\uff09\uff1a</p> <pre><code>$ rclone lsf webdav@rpi4b:\nCS/\nEnglish_Docs/\nThe_Economist/\nmkdocs/\n\n# \u8fc7\u6ee4\u53ea\u663e\u793a CS- \u5f00\u5934\u7684\u76ee\u5f55\n$ rclone lsf webdav@rpi4b: --include \"CS-*/\"\n# $ rclone lsf webdav@rpi4b: --include \"CS-*/**\"\n\n# \u8fc7\u6ee4\u4e0d\u663e\u793a CS-System \u548c CS-Network \u76ee\u5f55\n# $ rclone lsf webdav@rpi4b: --exclude \"{CS-System/**,CS-Network/**}\"\n$ rclone lsf webdav@rpi4b: --exclude \"CS-{System, Network}/**\"\n</code></pre> <p><code>lsjson</code> \u547d\u4ee4\u4ee5 json \u683c\u5f0f\u5217\u4e3e\u76ee\u5f55\uff1a</p> <pre><code>$ rclone lsjson webdav@rpi4b:\n[\n{\"Path\":\"CS\",\"Name\":\"CS\",\"Size\":-1,\"MimeType\":\"inode/directory\",\"ModTime\":\"2024-04-05T00:34:31Z\",\"IsDir\":true},\n{\"Path\":\"English_Docs\",\"Name\":\"English_Docs\",\"Size\":-1,\"MimeType\":\"inode/directory\",\"ModTime\":\"2024-04-03T02:53:51Z\",\"IsDir\":true},\n{\"Path\":\"The_Economist\",\"Name\":\"The_Economist\",\"Size\":-1,\"MimeType\":\"inode/directory\",\"ModTime\":\"2024-03-25T02:17:59Z\",\"IsDir\":true},\n{\"Path\":\"mkdocs\",\"Name\":\"mkdocs\",\"Size\":-1,\"MimeType\":\"inode/directory\",\"ModTime\":\"2024-04-01T10:25:31Z\",\"IsDir\":true}\n]\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\uff0crclone \u8fd8\u63d0\u4f9b\u4e86 tree \u547d\u4ee4\uff0c\u652f\u6301\u4ee5\u6811\u5f62\u663e\u793a\u76ee\u5f55\u7ed3\u6784\uff1a</p> <pre><code>$ rclone tree webdav@rpi4b: --max-depth 1\n/\n\u251c\u2500\u2500 CS\n\u251c\u2500\u2500 English_Docs\n\u251c\u2500\u2500 The_Economist\n\u2514\u2500\u2500 mkdocs\n\n0 directories, 0 files\n\n$ rclone tree webdav@rpi4b: --max-depth 2\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#mkdir","title":"mkdir","text":"<p>\u8bed\u4e49\u540c bash shell \u4e2d\u7684 <code>mkdir</code>\uff0c\u521b\u5efa\u76ee\u5f55\uff08remote:path\uff09\u3002</p> Command Description rclone mkdir Make the path if it doesn't already exist. <p>\u5728\u6839\u76ee\u5f55 /webdav \u4e0b\u65b0\u5efa\u6587\u4ef6\u5939 rcdir\uff1a</p> <pre><code>$ rclone lsf webdav@rpi4b:\nCS/\nEnglish_Docs/\nThe_Economist/\nmkdocs/\n\n$ rclone mkdir webdav@rpi4b:rcdir\n\n$ rclone lsf webdav@rpi4b:\nCS/\nEnglish_Docs/\nThe_Economist/\nmkdocs/\nrcdir/\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#copy","title":"copy","text":"<p>\u57fa\u672c\u8bed\u4e49\u540c bash shell \u4e2d\u7684 <code>cp</code>\uff0c\u652f\u6301\u7aef\u5230\u7aef\u7684\u6587\u4ef6\uff08\u5939\uff09\u590d\u5236\u3002</p> Command Description rclone copy Copy files from source to dest, skipping identical files. rclone copyto Copy files from source to dest, skipping identical files. rclone copyurl Copy the contents of the URL supplied content to dest:path. <p>copy:</p> <ol> <li>If dest:path doesn't exist, it is created and the source:path contents go there.</li> <li>To copy single files, use the\u00a0copyto\u00a0command instead.</li> </ol> <p>copyto:</p> <ol> <li>If source:path is a file or directory then it copies it to a file or directory named dest:path.</li> <li>This can be used to upload single files to other than their current name.</li> <li>If the source is a directory then it acts exactly like the copy command.</li> </ol>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#upload_from_local","title":"upload from local","text":"<p>\u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\u5939 mkdocs/script/ \u4e2d\u7684\u6240\u6709\u6587\u4ef6\u590d\u5236\u5230 test/script \u76ee\u5f55\u4e0b\uff1a</p> <ul> <li>\u5982\u679c\u76ee\u6807\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u4f1a\u9010\u7ea7\u521b\u5efa\u76ee\u5f55\uff08mkdir -p test/script\uff09\u3002</li> </ul> <pre><code>$ rclone copy -v mkdocs/script/ webdav@rpi4b:test/script\n</code></pre> <p>\u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6 test.txt \u62f7\u8d1d\u4e0a\u4f20\uff08copy upload\uff09\u5230\u76ee\u5f55 rcdir \u4e0b\uff1a</p> <pre><code>$ rclone copy -v test.txt webdav@rpi4b:rcdir\n\n$ rclone lsf webdav@rpi4b:rcdir\ntest.txt\n</code></pre> <pre><code># \u4ec5\u62f7\u8d1d srcpath \u4e2d 5s \u4e4b\u5185\u6709\u53d8\u52a8\u7684\u6587\u4ef6\n$ rclone copy -v ~/Downloads/testdir webdav@mbpa2991:testdir --max-age 5\n</code></pre> <p>\u6ce8\u610f\uff1a\u5982\u679c\u4f7f\u7528 copyto \u547d\u4ee4\uff0c\u4f1a\u5c06 rcdir \u89c6\u4f5c\u6587\u4ef6\uff1a</p> <pre><code># \u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 test.txt \u6587\u4ef6\u590d\u5236\u4e3a\u8fdc\u7aef\u6587\u4ef6 rcdir\n$ rclone copyto -v test.txt webdav@rpi4b:rcdir\n</code></pre> <p>\u4f7f\u7528 copyto \u547d\u4ee4\uff0cdstpath \u90e8\u5206\u6307\u5b9a\u4e0a\u4f20\u540e\u7684\u76ee\u6807\u6587\u4ef6\u540d\u3002 \u4f8b\u5982\uff0c\u5c06 test.txt \u4e0a\u4f20\u4e3a rcdir/test2.txt\uff1a</p> <pre><code>$ rclone copyto test.txt webdav@rpi4b:rcdir/test2.txt\n\n$ rclone lsf webdav@rpi4b:rcdir\ntest.txt\ntest2.txt\n</code></pre> <p>\u5907\u4efd\u672c\u5730 zsh \u914d\u7f6e\u6587\u4ef6\u5230\u5c40\u57df\u7f51 SMB \u5171\u4eab\u76d8\uff1a</p> <pre><code>hostname=$(hostname)\nhost=${hostname%%.*}\nfiledate=$(date -r \"$config\" +%Y%m%d)\n$ rclone copyto -v ~/.zshrc smbhd@rpi4b:WDHD/backups/config/$host-$filedate.zshrc\n</code></pre> <p>\u6ce8\u610f\uff1a\u5982\u679c\u4f7f\u7528 copy \u547d\u4ee4\uff0c\u4f1a\u5c06 test2.txt \u89c6\u4f5c\u76ee\u5f55\uff1a</p> <pre><code># \u5c06\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 test.txt \u6587\u4ef6\u590d\u5236\u5230\u8fdc\u7aef\u76ee\u5f55 rcdir/test2.txt/ \u4e0b\n$ rclone copy test.txt webdav@rpi4b:rcdir/test2.txt\n\n$ rclone lsf webdav@rpi4b:rcdir\ntest.txt\ntest2.txt/\n\n$ rclone lsf webdav@rpi4b:rcdir/test2.txt\ntest.txt\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#download_from_remote","title":"download from remote","text":"<p>\u5c06 rcdir \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u4e0b\u8f7d\u5230\u5f53\u524d\u76ee\u5f55\uff08pwd\uff09\uff1a</p> <pre><code>$ rclone copy -v webdav@rpi4b:rcdir .\n</code></pre> <p>\u5c06 rcdir \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u4e0b\u8f7d\u5230\u5f53\u524d\u76ee\u5f55\u7684 rcdir \u6587\u4ef6\u5939\u4e0b\uff1a</p> <ul> <li>\u5982\u679c\u5f53\u524d\u76ee\u5f55\u4e0b\u4e0d\u5b58\u5728 rcdir \u6587\u4ef6\u5939\uff0c\u5219\u81ea\u52a8\u521b\u5efa\u3002</li> </ul> <pre><code>$ rclone copy -v webdav@rpi4b:rcdir ./rcdir\n</code></pre> <p>\u5c06\u8fdc\u7aef\u6587\u4ef6 rcdir/test2.txt \u62f7\u8d1d\u4e0b\u8f7d\u5230\u5f53\u524d\u76ee\u5f55\uff08pwd\uff09\u4e0b\uff1a</p> <pre><code>$ rclone copy -v webdav@rpi4b:rcdir/test2.txt .\n</code></pre> <p>\u5c06\u8fdc\u7aef\u6587\u4ef6\u5939 English/\u604b\u8bcd\u8003\u7814\u82f1\u8bed-\u5168\u771f\u9898\u6e90\u62a5\u520a7000\u8bcd/ \u62f7\u8d1d\u5230 Documents \u540c\u540d\u76ee\u5f55\uff1a</p> <pre><code>rclone copy -v webdav@rpi4b:English/\u604b\u8bcd\u8003\u7814\u82f1\u8bed-\u5168\u771f\u9898\u6e90\u62a5\u520a7000\u8bcd/ Documents/English/\u604b\u8bcd\u8003\u7814\u82f1\u8bed-\u5168\u771f\u9898\u6e90\u62a5\u520a7000\u8bcd/\n</code></pre> <p>\u5c06\u8fdc\u7aef\u6587\u4ef6 rcdir/test2.txt \u62f7\u8d1d\u4e0b\u8f7d\u5230\u5f53\u524d\u76ee\u5f55\uff08pwd\uff09\uff0c\u5e76\u547d\u540d\u4e3a test3.txt\uff1a</p> <pre><code>$ rclone copyto -v webdav@rpi4b:rcdir/test2.txt ./test3.txt\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#server-side_copy","title":"server-side copy","text":"<p>server-side copy \u590d\u5236\u6587\u4ef6\u5939\uff1a</p> <pre><code>$ rclone copy -v webdav@rpi4b:rcdir webdav@rpi4b:rcdir1\n\n$ rclone lsf webdav@rpi4b:\nCS/\nEnglish_Docs/\nThe_Economist/\nmkdocs/\nrcdir/\nrcdir1/\n</code></pre> <p>server-side copy \u590d\u5236\u6587\u4ef6\uff1a</p> <pre><code>$ rclone copyto -v webdav@rpi4b:rcdir/test.txt webdav@rpi4b:rcdir/test3.txt\n\n$ rclone lsf webdav@rpi4b:rcdir\ntest.txt\ntest2.txt\ntest3.txt\n\n$ rclone copyto -v webdav@rpi4b:rcdir/test.txt webdav@rpi4b:rcdir/test4.txt\n\n$ rclone lsf webdav@rpi4b:rcdir\ntest.txt\ntest2.txt\ntest3.txt\ntest4.txt\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#move","title":"move","text":"<p>\u57fa\u672c\u8bed\u4e49\u540c bash shell \u4e2d\u7684 <code>mv</code>\uff0c\u652f\u6301\u7aef\u5230\u7aef\u7684\u6587\u4ef6\uff08\u5939\uff09\u79fb\u52a8\u3002</p> Command Description rclone move Move files from source to dest. rclone moveto Move file or directory from source to dest. <p>move:</p> <ol> <li>Moves the contents of the source directory to the destination directory.</li> <li>To move single files, use the moveto command instead.</li> </ol> <p>moveto:</p> <ol> <li>If source:path is a file or directory then it moves it to a file or directory named dest:path.</li> <li>This can be used to rename files or upload single files to other than their existing name.</li> <li>If the source is a directory then it acts exactly like the move command.</li> </ol> <p>move vs. copy</p> <p>\u5728\u4e0a\u9762\u4f7f\u7528 <code>copy</code> \u7684\u573a\u5408\uff0c\u90fd\u53ef\u4ee5\u66ff\u6362\u4e3a <code>move</code>\u3002 \u533a\u522b\u5728\u4e8e <code>copy</code> \u662f\u590d\u5236-\u7c98\u8d34\uff0c\u800c <code>move</code> \u76f8\u5f53\u4e8e\u526a\u5207-\u7c98\u8d34\u3002</p> <p>server-side move\uff1a\u4e0d\u540c\u76ee\u5f55\u4e3a\u79fb\u52a8\uff0c\u76f8\u540c\u76ee\u5f55\u76f8\u5f53\u4e8e\u91cd\u547d\u540d\u3002</p> <p>\u5c06\u6587\u4ef6 rcdir1/test4.txt \u91cd\u547d\u540d rcdir1/test3.txt\uff1a</p> <pre><code>$ rclone moveto -v webdav@rpi4b:rcdir1/test4.txt webdav@rpi4b:rcdir1/test3.txt\n\nrclone lsf webdav@rpi4b:rcdir1\ntest.txt\ntest2.txt\ntest3.txt\n</code></pre> <p>\u5c06\u6839\u76ee\u5f55\u4e0b\u7684 test \u6587\u4ef6\u5939\u91cd\u547d\u540d\u4e3a test2\uff1a</p> <pre><code>$ rclone move -v webdav@rpi4b:test webdav@rpi4b:test2\n</code></pre> <p>\u5c06 rcdir/test4.txt \u79fb\u52a8\u5230 rcdir1 \u76ee\u5f55\uff1a</p> <pre><code>$ rclone move -v webdav@rpi4b:rcdir/test4.txt webdav@rpi4b:rcdir1\n\n$ rclone lsf webdav@rpi4b:rcdir\ntest.txt\ntest2.txt\ntest3.txt\n\n$ rclone lsf webdav@rpi4b:rcdir1\ntest.txt\ntest2.txt\ntest4.txt\n</code></pre> <p>\u5c06 English \u76ee\u5f55\u4e0b\u7684 mp3 \u548c pdf \u6587\u4ef6\uff08\u4e0d\u9012\u5f52\u5b50\u76ee\u5f55\uff09\u79fb\u52a8\u5230\u5b50\u6587\u4ef6\u5939 The_Economist \u4e0b\uff1a</p> <pre><code>$ rclone move -v webdav@rpi4b:English webdav@rpi4b:English/The_Economist --include \"/*.{mp3,pdf}\" --dry-run\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#deletermdirpurge","title":"delete/rmdir/purge","text":"","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#delete","title":"delete","text":"Command Description rclone deletefile Remove a single file from remote. rclone delete Remove the files in path. <p>deletefile \u8bed\u4e49\u540c bash shell \u4e2d\u7684 <code>rm -f file</code>\uff1bdelete \u8bed\u4e49\u540c bash shell \u4e2d\u7684 <code>rm -rf folder</code>\u3002</p> <p>\u5220\u9664\u8fdc\u7aef\u6587\u4ef6 rcdir1/test.txt\uff1a</p> <pre><code>$ rclone deletefile -v webdav@rpi4b:rcdir1/test.txt\n\n$ rclone lsf webdav@rpi4b:rcdir1\ntest2.txt\ntest3.txt\n</code></pre> <p>\u5220\u9664\u8fdc\u7aef\u6587\u4ef6\u5939 rcdir1 \u4e0b\u7684\u6240\u6709\u6587\u4ef6\uff1a</p> <pre><code>$ rclone delete -v webdav@rpi4b:rcdir1\n\n$ rclone lsf webdav@rpi4b:rcdir1\n</code></pre> <p>\u8fc7\u6ee4\u5220\u9664\u6307\u5b9a\u76ee\u5f55\u4e0b\u7279\u5b9a\u540e\u7f00\u7684\u6587\u4ef6\uff08\u8bf7\u5148 --dry-run \u9a8c\u8bc1\uff09\uff1a</p> <pre><code>$ rclone lsl smbhd@rpi4b:WDHD --include \"*.DS_Store\"\n$ rclone delete -v smbhd@rpi4b:WDHD --include \"*.DS_Store\"\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#rmdir","title":"rmdir","text":"Command Description rclone rmdir Remove the empty directory at path. rclone rmdirs Remove empty directories under the path. <p>\u518d\u5728\u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u4e2a2\u6587\u4ef6\u5939 rcdir2\u3001rcdir3</p> <pre><code>$ rclone mkdir webdav@rpi4b:rcdir2\n$ rclone mkdir webdav@rpi4b:rcdir3\n\n$ rclone lsf webdav@rpi4b:\nCS/\nEnglish_Docs/\nThe_Economist/\nmkdocs/\nrcdir/\nrcdir1/\nrcdir2/\nrcdir3/\n</code></pre> <p>\u4f7f\u7528 <code>rmdir</code> \u547d\u4ee4\u79fb\u9664\u6839\u76ee\u5f55\u4e0b\u7684\u7a7a\u6587\u4ef6\u5939 rcdir1\uff1a</p> <pre><code>$ rclone rmdir webdav@rpi4b:rcdir1\n\n$ rclone lsf webdav@rpi4b:\nCS/\nEnglish_Docs/\nThe_Economist/\nmkdocs/\nrcdir/\nrcdir2/\nrcdir3/\n</code></pre> <p>\u4f7f\u7528 <code>rmdirs</code> \u5b50\u547d\u4ee4\u4e00\u6b21\u6027\u79fb\u9664\u6839\u76ee\u5f55\u4e0b\u6240\u6709\u7684\u7a7a\u6587\u4ef6\u5939\uff08rcdir2\u3001rcdir3\uff09\uff1a</p> <pre><code>$ rclone rmdirs webdav@rpi4b:\n\nrclone lsf webdav@rpi4b:\nCS/\nEnglish_Docs/\nThe_Economist/\nmkdocs/\nrcdir/\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#purge","title":"purge","text":"<p>rmdir/rmdirs \u547d\u4ee4\u53ea\u80fd\u5220\u9664\u7a7a\u6587\u4ef6\u5939\uff0c\u5982\u679c\u60f3\u4e00\u6b65\u6e05\u7406\u6587\u4ef6\u5939\u5185\u5bb9\u5e76\u5220\u9664\u6587\u4ef6\u5939\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>purge</code> \u547d\u4ee4\uff08\u2248 delete + rmdir\uff09\uff1a</p> Command Description rclone purge Remove the path and all of its contents. <p>\u5220\u9664\u8fdc\u7aef\u76ee\u5f55 rcdir/test2.txt \u4e0b\u7684\u6240\u6709\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\uff1a</p> <pre><code>$ rclone purge -v webdav@rpi4b:rcdir/test2.txt\n\nrclone lsf webdav@rpi4b:rcdir\ntest.txt\ntest1.txt\ntest3.txt\n</code></pre>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#syncbisync","title":"sync/bisync","text":"Command Description rclone sync Make source and dest identical, modifying destination only. rclone bisync Perform bidirectional synchronization between two paths.","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#sync","title":"sync","text":"<p>Sync the source to the destination, changing the destination only. Doesn't transfer files that are identical on source and destination, testing by size and modification time or MD5SUM. Destination is updated to match source, including deleting files if necessary (except duplicate objects, see below). If you don't want to delete files from destination, use the\u00a0copy\u00a0command instead.</p> <p>Important: Since this can cause data loss, test first with the\u00a0<code>--dry-run</code>\u00a0or the\u00a0<code>--interactive</code>/<code>-i</code>\u00a0flag.</p> <pre><code>$ rclone sync --interactive SOURCE remote:DESTINATION\n</code></pre> <p>Note that files in the destination won't be deleted if there were any errors at any point. Duplicate objects (files with the same name, on those providers that support it) are also not yet handled.</p> <p>\u672c\u5730\u76ee\u5f55\uff08\u6587\u4ef6\u5939\uff09\u60f3\u548c\u4e91\u76d8\u540c\u6b65\u65f6\uff0c\u53ef\u91c7\u7528 <code>sync</code> \u547d\u4ee4\u3002</p> <p>\u4f8b1\uff1a\u5c06\u672c\u5730\u76ee\u5f55 <code>/usr/local/var/webdav/</code> \u540c\u6b65\u5230 webDAV \u4e91\u76d8 webdav@rpi4b:</p> <pre><code>$ rclone sync -v /usr/local/var/webdav/ webdav@rpi4b:\n# \u8fc7\u6ee4\u6389\u7279\u5b9a\u6587\u4ef6\n$ rclone sync -v /usr/local/var/webdav/ webdav@rpi4b: --exclude \".DS_Store\"\n</code></pre> <p>\u4f8b2\uff1a\u4ec5\u540c\u6b65 srcpath \u4e2d 1h \u4e4b\u5185\u6709\u53d8\u52a8\u7684\u6587\u4ef6\uff1a</p> <pre><code>$ rclone sync -v ~/Downloads/testdir webdav@mbpa2991:testdir --max-age 1h\n</code></pre> <p>\u4f8b3\uff1a\u5c06 ubuntu WebDAV \u4e91\u76d8 webdav\\@rpi4b\uff08\u9664 C-C++/ \u548c English/ \u76ee\u5f55\u5916\uff09\u540c\u6b65\u5907\u4efd\u5230\u5916\u6302\u786c\u76d8\uff08/Volumes/WDHD/\uff09\u4e0b\u7684\u6587\u4ef6\u5939 webdav@rpi4b\uff1a</p> <pre><code># --exclude \"{C-C++/*, English/*}\"\n# 2-stderr \u91cd\u5b9a\u5411\u5230 1-stdout\uff0c\u7ba1\u4f20\u7ed9 tee \u8f93\u51fa\u63a7\u5236\u53f0\u5e76\u4e14\u4fdd\u5b58\uff08-a: append\uff09\u5230\u65e5\u5fd7\u6587\u4ef6\u3002 --exclude \"{C-C++, English}/**\"\n$ rclone sync -v webdav@rpi4b: /Volumes/WDHD/webdav@rpi4b --exclude \"C-C++/\" --exclude \"English/\" 2&gt;&amp;1 | tee -a ~/.config/rclone/rclone.log\n\n# \u8865\u5145\u5907\u4efd English \u6587\u4ef6\u5939\n$ rclone sync -v webdav@rpi4b:English /Volumes/WDHD/webdav@rpi4b/English 2&gt;&amp;1 | tee -a ~/.config/rclone/rclone.log\n\n# \u8865\u5145\u5907\u4efd C-C++ \u6587\u4ef6\u5939\n$ rclone sync -v webdav@rpi4b:C-C++ /Volumes/WDHD/webdav@rpi4b/C-C++ 2&gt;&amp;1 | tee -a ~/.config/rclone/rclone.log\n</code></pre> <p>\u4e5f\u53ef\u6839\u636e\u5b9e\u9645\u9700\u6c42\uff0c\u9009\u62e9\u53ea\u540c\u6b65\u67d0\u4e9b\u5b50\u6587\u4ef6\u5939\u3002</p> <p>\u4e00\u79cd\u5178\u578b\u7684\u5355\u5411\u540c\u6b65\u5de5\u4f5c\u6d41</p> <ol> <li>\u5148\u5c06\u4e91\u76d8\u67d0\u4e2a\u76ee\u5f55 remote:dstpath \u62f7\u8d1d\u68c0\u51fa\uff08\u7c7b\u4f3c git clone check) \u5230\u672c\u5730\u6587\u4ef6\u5939 srcpath\u3002</li> <li>\u7136\u540e\uff0c\u4ee5 srcpath \u4e3a\u5de5\u4f5c\u76ee\u5f55\u8fdb\u884c\u672c\u5730\u6587\u4ef6\u7f16\u8f91\u6d3b\u52a8\uff0c\u5305\u62ec\u65b0\u5efa\u3001\u79fb\u52a8\u3001\u5220\u9664\u7b49\u4e00\u7cfb\u5217\u64cd\u4f5c\u3002</li> <li>\u7f16\u8f91\u5b8c\u6bd5\uff0c\u6267\u884c <code>rclone sync srcpath dest:dstpath</code> \u547d\u4ee4\u5373\u53ef\u540c\u6b65\u672c\u5730\u6570\u636e\u5230\u670d\u52a1\u7aef\u3002</li> </ol>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#bisync","title":"bisync","text":"<p>Perform bidirectional synchronization between two paths.</p> <p>Bisync\u00a0provides a bidirectional cloud sync solution in rclone. It retains the Path1 and Path2 filesystem listings from the prior run. On each successive run it will:</p> <ul> <li>list files on Path1 and Path2, and check for changes on each side. Changes include\u00a0<code>New</code>,\u00a0<code>Newer</code>,\u00a0<code>Older</code>, and\u00a0<code>Deleted</code>\u00a0files.</li> <li>Propagate changes on Path1 to Path2, and vice-versa.</li> </ul> <p>Bisync is\u00a0in beta\u00a0and is considered an\u00a0advanced command, so use with care. Make sure you have read and understood the entire\u00a0manual\u00a0(especially the\u00a0Limitations\u00a0section) before using, or data loss can result. Questions can be asked in the\u00a0Rclone Forum.</p> <p>See\u00a0full bisync description\u00a0for details.</p> <pre><code>$ rclone bisync -v remote1:path1 remote2:path2 [flags]\n</code></pre> <p>\u5047\u8bbe\u914d\u7f6e\u4e86\u4e24\u4e2a\u4e91\u76d8\uff1awebdav@mbpa1398 \u548c webdav@rpi4b\uff0c\u5f7c\u6b64\u4e4b\u95f4\u76f8\u5f53\u4e8e\u5907\u4efd\u3002</p> <p>\u5728\u5185\u7f51\u64cd\u4f5c webdav@mbpa1398\uff0c\u8fdc\u7a0b\u64cd\u4f5c webdav@rpi4b\u3002</p> <p>\u53ef\u91c7\u7528 <code>bisync</code> \u547d\u4ee4\u6267\u884c\u53cc\u5411\u540c\u6b65\uff1a</p> <pre><code>$ rclone bisync -v webdav@mbpa1398: webdav@rpi4b:\n</code></pre> <p>\u5047\u5982\u67d0\u4e2a\u6587\u4ef6\u57fa\u70b9\u4e3a file\uff0c\u5728\u4e91\u76d8 1 \u7f16\u8f91\u4e3a file1\uff0c\u5728\u4e91\u76d8 2 \u7f16\u8f91\u4e3a file2\uff0c\u53cc\u5411\u540c\u6b65\u65f6\u5c06\u4ee5\u6700\u540e\u4fee\u6539\u65f6\u95f4\u6233\u4e3a\u51c6\uff0c\u6ca1\u6cd5\u81ea\u52a8\u5408\u5e76\uff1f</p> <ul> <li>Two-way (bidirectional) synchronization</li> <li>Bisync missed syncing changed file - no error, no warning</li> <li>rclone bisync --resync : discrepency in keeping updated/modified files</li> </ul> <p>\u4e00\u79cd\u53ef\u80fd\u7684\u5b89\u5168\u7684\u5de5\u4f5c\u6d41\u662f\uff0c\u6bcf\u6b21\u5f00\u59cb\u7f16\u8f91\uff08\u6216\u7f16\u8f91\u5b8c\uff09\u4efb\u4f55\u4e00\u4e2a\u4e91\u76d8\uff0c\u603b\u662f\u6267\u884c bisync \uff08\u5148\uff09\u53cc\u5411\u540c\u6b65\uff0c\u786e\u4fdd\u6570\u636e\u540c\u6b65\u3002</p> <p>\u6240\u4ee5\uff0c\u6700\u597d\u4ee5\u4e00\u4e2a\u4e3a\u4e3b\uff08\u7f16\u8f91\uff09\uff0c\u53e6\u4e00\u4e2a\u4e3a\u8f85\uff08\u5907\u4efd\uff09\u3002\u8fd9\u6837\uff0c\u76f8\u5f53\u4e8e\u5c06\u4e3b\u76d8\u589e\u91cf\u540c\u6b65\u5230\u5907\u4efd\u76d8\u3002\u6b64\u65f6\uff0c\u9000\u5316\u4e3a\u5355\u5411 sync\uff1a</p> <pre><code>$ rclone sync -v webdav@mbpa1398: webdav@rpi4b:\n</code></pre> <p>\u4e0b\u4e00\u7bc7 \u300a\u57fa\u4e8ecron\u914d\u7f6erclone\u81ea\u52a8\u540c\u6b65\u4efb\u52a1\u300b\u5c06\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 cron \u914d\u7f6e crontab \u914d\u7f6e rclone \u5b9a\u65f6\u81ea\u52a8\u540c\u6b65\u4efb\u52a1\u3002</p>","tags":["rclone","webDAV"]},{"location":"blog/20240318/rclone-access-webdav/#refs","title":"refs","text":"<p>Rclone\u4e91\u5b58\u50a8\u6570\u636e\u540c\u6b65\u5de5\u5177 \u5907\u4efd\u540c\u6b65\u795e\u5668 Rclone \u4f7f\u7528\u6559\u7a0b rclone \u9009\u9879\u53c2\u6570 --min-age/--max-age \u7684\u7406\u89e3</p>","tags":["rclone","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/","title":"rpi4b-ubuntu\u5b89\u88c5nginx-extras\u5e76\u914d\u7f6eWebDav","text":"<p>\u624b\u5934\u7684 raspberry pi 4b \u5b89\u88c5\u4e86 ubuntu server\uff0c\u9ed8\u8ba4\u5df2\u5185\u7f6e nginx\u3002\u4f46\u662f\uff0c\u548c macOS \u4e0a\u901a\u8fc7 brew \u5b89\u88c5\u7684 nginx \u4e00\u6837\uff0chttp_dav \u6a21\u5757\u53ea\u652f\u6301\u57fa\u7840\u7684 webdav \u670d\u52a1\uff0c\u5982\u679c\u8981\u652f\u6301\u5b8c\u6574\u7684 webdav \u670d\u52a1\uff0c\u9700\u8981\u5b89\u88c5 dav-ext \u6269\u5c55\u6a21\u5757\u3002</p> <p>rpi4b \u7684 CPU \u548c OS \u4fe1\u606f\u5982\u4e0b\uff1a</p> archos <pre><code>pifan@rpi4b-ubuntu $ arch\naarch64\n\npifan@rpi4b-ubuntu $ echo $MACHTYPE\naarch64\n</code></pre> <pre><code>pifan@rpi4b-ubuntu $ cat /etc/issue\nUbuntu 22.04.4 LTS \\n \\l\n\npifan@rpi4b-ubuntu $ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 22.04.4 LTS\nRelease:    22.04\nCodename:   jammy\n</code></pre> <p>How to install Ubuntu Server on Raspberry Pi?</p> <p>Install Ubuntu on a Raspberry Pi How to install Ubuntu Server on your Raspberry Pi</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#installed_nginx","title":"installed nginx","text":"<p>\u5173\u4e8e nginx \u547d\u4ee4\u5e2e\u52a9\uff0c\u6267\u884c <code>nginx -h</code> \u6216 <code>man nginx</code>\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#nginx_-v","title":"nginx -V","text":"<p>\u6267\u884c <code>nginx -V</code> \u53ef\u67e5\u770b\u8be6\u7ec6\u7684 configure arguments\uff0c\u5305\u62ec <code>prefix</code>\u3001<code>conf-path</code>\u3001<code>pid-path</code>\u3001<code>http-log-path</code> \u548c <code>error-log-path</code>\uff0c\u4ee5\u53ca\u4ee5 <code>with</code> \u5f00\u5934\u7684\u5df2\u5b89\u88c5\u7684\u6a21\u5757\uff08module\uff09\u3002</p> <p>nginx -V path</p> <p>\u9ed8\u8ba4\u5de5\u4f5c\u7a7a\u95f4\uff1a--prefix=/usr/share/nginx \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff1a--conf-path=/etc/nginx/nginx.conf \u9ed8\u8ba4\u65e5\u5fd7\u8def\u5f84\uff1a</p> <ul> <li>--http-log-path=/var/log/nginx/access.log</li> <li>--error-log-path=/var/log/nginx/error.log</li> </ul> nginx -V details <pre><code>$ nginx -V\nnginx version: nginx/1.18.0 (Ubuntu)\nbuilt with OpenSSL 3.0.2 15 Mar 2022\nTLS SNI support enabled\nconfigure arguments: --with-cc-opt='-g -O2 -ffile-prefix-map=/build/nginx-glNPkO/nginx-1.18.0=. -flto=auto -ffat-lto-objects -flto=auto -ffat-lto-objects -fstack-protector-strong -Wformat -Werror=format-security -fPIC -Wdate-time -D_FORTIFY_SOURCE=2' --with-ld-opt='-Wl,-Bsymbolic-functions -flto=auto -ffat-lto-objects -flto=auto -Wl,-z,relro -Wl,-z,now -fPIC' --prefix=/usr/share/nginx --conf-path=/etc/nginx/nginx.conf --http-log-path=/var/log/nginx/access.log --error-log-path=/var/log/nginx/error.log --lock-path=/var/lock/nginx.lock --pid-path=/run/nginx.pid --modules-path=/usr/lib/nginx/modules --http-client-body-temp-path=/var/lib/nginx/body --http-fastcgi-temp-path=/var/lib/nginx/fastcgi --http-proxy-temp-path=/var/lib/nginx/proxy --http-scgi-temp-path=/var/lib/nginx/scgi --http-uwsgi-temp-path=/var/lib/nginx/uwsgi --with-compat --with-debug --with-pcre-jit --with-http_ssl_module --with-http_stub_status_module --with-http_realip_module --with-http_auth_request_module --with-http_v2_module --with-http_dav_module --with-http_slice_module --with-threads --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-geoip2 --with-http_addition_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_sub_module\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#curl_localhost","title":"curl localhost","text":"<p>\u6267\u884c <code>curl localhost</code> \u8bf7\u6c42 web \u670d\u52a1\uff0c\u6b63\u5e38\u8fd4\u56de <code>Welcome to nginx!</code> \u6b22\u8fce\u9875\u9762\uff08/var/www/html/index.nginx-debian.html\uff09\uff1a</p> Welcome to nginx! <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Welcome to nginx!&lt;/title&gt;\n&lt;style&gt;\n    body {\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    }\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;\n&lt;p&gt;If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.&lt;/p&gt;\n\n&lt;p&gt;For online documentation and support please refer to\n&lt;a href=\"http://nginx.org/\"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;\nCommercial support is available at\n&lt;a href=\"http://nginx.com/\"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#install_nginx-extras","title":"install nginx-extras","text":"<p><code>nginx -V</code> \u8f93\u51fa\u7684 dav \u76f8\u5173\u7684\u53ea\u6709 <code>--with-http_dav_module</code>\uff0c\u8981\u60f3\u4f7f\u7528\u5b8c\u6574\u7684 webDAV \u670d\u52a1\uff0c\u8fd8\u5f97\u81ea\u884c\u5b89\u88c5 dav-ext \u6269\u5c55\u6a21\u5757\u3002</p> <ul> <li>The\u00a0nginx webdav module\u00a0only supports PUT, DELETE, MKCOL, COPY, and MOVE.</li> <li>The\u00a0dav_ext module\u00a0adds support for PROPFIND, OPTIONS, LOCK and UNLOCK.</li> </ul> <p>\u57fa\u4e8e\u5df2\u7ecf\u5b89\u88c5\u7684 nginx\uff0c\u53ea\u9700\u8981\u5b89\u88c5 <code>nginx-extras</code> \u6269\u5c55\u5305\u5373\u53ef\uff0c\u5176\u4e2d\u5305\u542b\u4e86 dav-ext \u548c headers-more \u6a21\u5757\u3002</p> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5378\u8f7d nginx\uff0c\u91cd\u88c5 nginx-full \u5b8c\u6574\u7248\u3002</p> <pre><code>$ sudo apt install nginx-extras\n\nThe following additional packages will be installed:\n  geoip-database libgeoip1 libnginx-mod-http-auth-pam libnginx-mod-http-cache-purge\n  libnginx-mod-http-dav-ext libnginx-mod-http-echo libnginx-mod-http-fancyindex\n  libnginx-mod-http-geoip libnginx-mod-http-headers-more-filter libnginx-mod-http-perl\n  libnginx-mod-http-subs-filter libnginx-mod-http-uploadprogress libnginx-mod-http-upstream-fair\n  libnginx-mod-nchan libnginx-mod-stream-geoip\n\nThe following NEW packages will be installed:\n  geoip-database libgeoip1 libnginx-mod-http-auth-pam libnginx-mod-http-cache-purge\n  libnginx-mod-http-dav-ext libnginx-mod-http-echo libnginx-mod-http-fancyindex\n  libnginx-mod-http-geoip libnginx-mod-http-headers-more-filter libnginx-mod-http-perl\n  libnginx-mod-http-subs-filter libnginx-mod-http-uploadprogress libnginx-mod-http-upstream-fair\n  libnginx-mod-nchan libnginx-mod-stream-geoip nginx-extras\n\nGet:3 https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports jammy-updates/universe arm64 libnginx-mod-http-dav-ext arm64 1.18.0-6ubuntu14.4 [17.8 kB]\n\nSelecting previously unselected package libnginx-mod-http-dav-ext.\nPreparing to unpack .../02-libnginx-mod-http-dav-ext_1.18.0-6ubuntu14.4_arm64.deb ...\nUnpacking libnginx-mod-http-dav-ext (1.18.0-6ubuntu14.4) ...\n\n\nSetting up libnginx-mod-http-dav-ext (1.18.0-6ubuntu14.4) ...\n</code></pre> <p>\u5b89\u88c5\u5b8c\u6bd5 nginx-extras\uff0c\u91cd\u65b0\u6267\u884c <code>nginx -V</code>\uff0c\u9664\u4e86\u9ed8\u8ba4\u7684 <code>--with-http_dav_module</code>\uff0c\u591a\u4e86\u4e24\u9879\uff1a</p> <ul> <li>--add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-dav-ext</li> <li>--add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-headers-more-filter</li> </ul> nginx -V <pre><code>$ nginx -V\nnginx version: nginx/1.18.0 (Ubuntu)\nbuilt with OpenSSL 3.0.2 15 Mar 2022\nTLS SNI support enabled\nconfigure arguments: --with-cc-opt='-g -O2 -ffile-prefix-map=/build/nginx-glNPkO/nginx-1.18.0=. -flto=auto -ffat-lto-objects -flto=auto -ffat-lto-objects -fstack-protector-strong -Wformat -Werror=format-security -fPIC -Wdate-time -D_FORTIFY_SOURCE=2' --with-ld-opt='-Wl,-Bsymbolic-functions -flto=auto -ffat-lto-objects -flto=auto -Wl,-z,relro -Wl,-z,now -fPIC' --prefix=/usr/share/nginx --conf-path=/etc/nginx/nginx.conf --http-log-path=/var/log/nginx/access.log --error-log-path=/var/log/nginx/error.log --lock-path=/var/lock/nginx.lock --pid-path=/run/nginx.pid --modules-path=/usr/lib/nginx/modules --http-client-body-temp-path=/var/lib/nginx/body --http-fastcgi-temp-path=/var/lib/nginx/fastcgi --http-proxy-temp-path=/var/lib/nginx/proxy --http-scgi-temp-path=/var/lib/nginx/scgi --http-uwsgi-temp-path=/var/lib/nginx/uwsgi --with-compat --with-debug --with-pcre-jit --with-http_ssl_module --with-http_stub_status_module --with-http_realip_module --with-http_auth_request_module --with-http_v2_module --with-http_dav_module --with-http_slice_module --with-threads --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-geoip2 --with-http_addition_module --with-http_flv_module --with-http_geoip_module=dynamic --with-http_gunzip_module --with-http_gzip_static_module --with-http_image_filter_module=dynamic --with-http_mp4_module --with-http_perl_module=dynamic --with-http_random_index_module --with-http_secure_link_module --with-http_sub_module --with-http_xslt_module=dynamic --with-mail=dynamic --with-mail_ssl_module --with-stream=dynamic --with-stream_geoip_module=dynamic --with-stream_ssl_module --with-stream_ssl_preread_module --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-headers-more-filter --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-auth-pam --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-cache-purge --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-dav-ext --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-ndk --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-echo --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-fancyindex --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/nchan --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/rtmp --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-uploadprogress --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-upstream-fair --add-dynamic-module=/build/nginx-glNPkO/nginx-1.18.0/debian/modules/http-subs-filter\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#config_webdav","title":"config webdav","text":"<p>Ubuntu \u4e0b nginx \u914d\u7f6e WebDav \u670d\u52a1\u7684\u6d41\u7a0b\u548c macOS \u4e0b\u5dee\u4e0d\u591a\uff0c\u53c2\u8003\u4e0a\u4e00\u7bc7 macOS\u91cd\u88c5nginx-full\u5e76\u914d\u7f6eWebDav\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#mkdir_for_webdav","title":"mkdir for webdav","text":"<p>nginx \u9ed8\u8ba4\u7684 Docroot \u662f <code>/var/www/html</code>\uff0c\u5728\u5176\u540c\u7ea7\u521b\u5efa webdav \u5171\u4eab\u6587\u4ef6\u5939 <code>/var/www/webdav</code>\uff0c</p> <p>\u8fd9\u91cc\u91c7\u7528\u548c macOS \u4e0a\u4e00\u6837\u7684\u7528\u6237\u7ba1\u7406\u7b56\u7565\uff0cchown \u7528\u6237\u4e3a www-data:www-data\u3002</p> <pre><code>$ mkdir /usr/local/var/webdav\n$ sudo chown -R www-data:www-data /var/www/webdav\n</code></pre> <p>who is www-data?</p> <p>What is the www-data user? linux \u4e0b nginx \u9ed8\u8ba4\u4f7f\u7528 www-data \u7528\u6237\u7ec4</p> <p>nginx.conf \u4e2d\u5b9a\u4e49\u4e86 worker process \u7684\u6267\u884c\u7528\u6237\uff1a</p> nginx.conf<pre><code>user www-data;\n</code></pre> <pre><code>$ id www-data\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n</code></pre> <p>never run a website from within your home directory</p> <p>\u81ea\u5b9a\u4e49\u7684 webdav \u7b49\u670d\u52a1\u7684 Docroot \u4e0d\u8981\u653e\u5728 home \u76ee\u5f55\u4e0b\uff0c\u9632\u6b62\u904d\u5386\u6cc4\u9732\u6570\u636e\uff0c\u8be6\u60c5\u53c2\u8003 Permissions problems with /var/www/html and my own home directory for a website document root\u3002</p> \u4e3a\u4ec0\u4e48\u4e0d\u5efa\u8bae\u628a\u670d\u52a1\u76ee\u5f55\u8bbe\u7f6e\u5230\u5bb6\u76ee\u5f55\u4e0b\uff1f <p>\u4e00\u5f00\u59cb\uff0c\u6211\u5c06 webdav \u5171\u4eab\u76ee\u5f55\u914d\u7f6e\u5230\u5bb6\u76ee\u5f55\u4e0b <code>/home/pifan/Sites/davnas/</code>\uff0c\u7ed3\u679c\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u8bbf\u95ee\u9996\u9875 http://rpi4b-ubuntu.local:81/webdav\uff0c\u5bc6\u7801\u6821\u9a8c\u6210\u529f\u540e\uff0c\u603b\u662f\u62a5\u9519 403 forbidden\u3002</p> <p>\u67e5\u770b\u5b9e\u65f6\u8bbf\u95ee\u9519\u8bef\u65e5\u5fd7\uff1a</p> <pre><code>$ tail -f /var/log/nginx/webdav.error.log\n\n2024/03/23 06:01:25 [crit] 52483#52483: *4 stat() \"/home/pifan/Sites/davnas/\" failed (13: Permission denied), client: 192.168.0.110, server: localhost, request: \"PROPFIND /webdav/ HTTP/1.1\", host: \"rpi4b-ubuntu.local:81\"\n</code></pre> <p>Nginx: stat() failed (13: permission denied)</p> <p><code>ls -al /home/</code> \u53ef\u4ee5\u770b\u5230 HOME pifan \u76ee\u5f55 owner \u662f pifan:ubuntu\uff0c\u6743\u9650\u662f <code>drwxr-x---</code>\uff0c\u5176\u4ed6\u4eba\u6ca1\u6709\u6743\u9650\u3002</p> <p>\u800c nginx \u8981\u6c42\u7528\u6237 www-data \u8981\u80fd cd \u8fdb\u6bcf\u4e00\u7ea7\u76ee\u5f55\u6267\u884c stat \u68c0\u67e5\u6587\u4ef6\u72b6\u6001\uff0c\u4e5f\u5373\u9700\u8981 x \u6743\u9650\u3002</p> <p>cd /home/pifan/ \u4e24\u7ea7\u6d4b\u8bd5\u901a\u8fc7\uff0c\u5728 cd \u4e00\u7ea7\u6d4b\u8bd5\u5931\u8d25\uff1a</p> <pre><code>$ sudo -u www-data stat /home/pifan/Sites\nstat: cannot statx '/home/pifan/Sites': Permission denied\n</code></pre> <p>\u53c2\u8003 Nginx only works when setting worker-process user to root\uff0c\u9700\u8981\u5bf9\u5171\u4eab\u76ee\u5f55 /home/pifan/ \u6dfb\u52a0\u6240\u6709\u4eba\uff08\u5176\u4ed6\u4eba\uff09\u7684 x \u6743\u9650\u3002</p> <p>\u89e3\u51b3Nginx\u51fa\u73b0403 forbidden (13: Permission denied)\u62a5\u9519\u7684\u56db\u79cd\u65b9\u6cd5 Nginx \u65e5\u5fd7 failed (13: Permission denied) \u9519\u8bef\uff0813\uff1a\u6743\u9650\u88ab\u62d2\u7edd\uff09</p> <p>\u7531\u4e8e\u542f\u52a8\u7528\u6237\u548cnginx\u5de5\u4f5c\u7528\u6237\u4e0d\u4e00\u81f4\u6240\u81f4\uff1a\u67e5\u770b nginx: master process \u542f\u52a8\u7528\u6237\u662f root\uff0cnginx: worker process \u7528\u6237\u662f www-data\u3002</p> <p>\u5c06 nginx.conf \u7684 user \u6539\u4e3a\u548c\u542f\u52a8\u7528\u6237\u4e00\u81f4\uff1a<code>sudo vim /etc/nginx/nginx.conf</code> \u4fee\u6539\u7b2c\u4e00\u884c\u7684 <code>user www-data;</code> \u4e3a <code>user root;</code>\uff0c\u7136\u540e\u6267\u884c <code>sudo systemctl restart nginx</code> \u91cd\u542f nginx \u670d\u52a1\u3002</p> <p>\u4e0d\u5efa\u8bae\u8fd9\u4e48\u5e72\uff0c\u8fd8\u662f\u5efa\u8bae\u9075\u4ece nginx \u7684\u8bbe\u8ba1\uff0c\u4fee\u6539 webdav \u5171\u4eab\u76ee\u5f55\u7684 owner\uff0c\u4ee5 www-data \u8eab\u4efd\u6267\u884c web \u64cd\u4f5c\uff01</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#htpasswd_add_user","title":"htpasswd add user","text":"<p>\u5148\u5b89\u88c5 apache2-utils\uff0c\u4ee5\u4fbf\u4f7f\u7528 htpasswd/htdigest \u547d\u4ee4\u521b\u5efa\u5bc6\u7801\u3002</p> <pre><code>$ sudo apt-get install apache2-utils -y\n</code></pre> <p>\u8fd9\u91cc\u4f7f\u7528 Basic \u8ba4\u8bc1\uff0c\u5177\u4f53\u914d\u7f6e\u53c2\u8003 Restricting Access with HTTP Basic Authentication\u3002</p> <pre><code>htpasswd -c /etc/nginx/.htpasswd $username\nNew password:\nRe-type new password:\nAdding password for user $username\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#nginx_conf","title":"nginx conf","text":"<p>nginx \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u4e3a --conf-path=/etc/nginx/nginx.conf\uff0cnginx \u542f\u52a8\u65f6\u4f1a\u52a0\u8f7d\u8be5\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>nginx.conf \u4e2d\u5b9a\u4e49\u4e86 worker process \u6267\u884c\u7528\u6237 <code>user www-data;</code> \u548c\u9ed8\u8ba4\u7684\u65e5\u5fd7\u8def\u5f84\uff1a</p> <p>Logging Settings</p> /etc/nginx/nginx.conf<pre><code>    ##\n    # Logging Settings\n    ##\n\n    access_log /var/log/nginx/access.log;\n    error_log /var/log/nginx/error.log;\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#virtual_host","title":"Virtual Host","text":"<p>nginx.conf \u5bfc\u5165\u52a0\u8f7d\u865a\u62df\u4e3b\u673a\u914d\u7f6e\uff08Virtual Host Configs\uff09\uff0c\u5305\u62ec conf.d \u4e0b\u7684 conf \u6587\u4ef6\u548c sites-enabled \u4e0b\u7684\u6240\u6709\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>Virtual Host Configs</p> /etc/nginx/nginx.conf<pre><code>    ##\n    # Virtual Host Configs\n    ##\n\n    include /etc/nginx/conf.d/*.conf;\n    include /etc/nginx/sites-enabled/*;\n</code></pre> <p>conf.d \u4e0b\u9ed8\u8ba4\u4e3a\u7a7a\uff0c/etc/nginx/sites-enabled \u4e0b\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7684\u914d\u7f6e\u6587\u4ef6 default\uff0c\u5b83\u662f\u7b26\u53f7\u94fe\u63a5\uff08symlink\uff09\uff0c\u6307\u5411 /etc/nginx/sites-available/default\u3002</p> <pre><code>$ ls -l /etc/nginx/sites-enabled\ntotal 0\nlrwxrwxrwx 1 root root 34 Feb 24  2022 default -&gt; /etc/nginx/sites-available/default\n</code></pre> <p>\u8fd9\u4e2a\u9ed8\u8ba4\u542f\u7528\u7684\u7ad9\u70b9\u5c31\u662f nginx \u5b89\u88c5\u4e4b\u540e\u7684 default_server\uff0c\u76d1\u542c\u5468\u77e5\u7684 80 \u7aef\u53e3\uff0cDocroot \u4e3a /var/www/html\uff1a</p> /etc/nginx/sites-enable/default -&gt; /etc/nginx/sites-available/default<pre><code># Default server configuration\n#\nserver {\n    listen 80 default_server;\n    listen [::]:80 default_server;\n\n    root /var/www/html;\n    # Add index.php to the list if you are using PHP\n    index index.html index.htm index.nginx-debian.html;\n\n    server_name _;\n\n    location / {\n        # First attempt to serve request as file, then\n        # as directory, then fall back to displaying a 404.\n        try_files $uri $uri/ =404;\n    }\n\n}\n</code></pre> <p>\u518d\u6765\u770b\u770b sites-available/default \u4e2d\u7684\u6ce8\u91ca\u8bf4\u660e\uff1a</p> <p>/etc/nginx/sites-available/default</p> <p># In most cases, administrators will remove this file from sites-enabled/ and # leave it as reference inside of sites-available where it will continue to be # updated by the nginx packaging team.</p> <p>\u6309\u7167\u8fd9\u4e2a\u6587\u6863\u7684\u5efa\u8bae\uff0c\u6700\u597d\u5148\u5728 /etc/nginx/sites-available/ \u4e0b\u521b\u5efa\u53ef\u7528\u7ad9\u70b9\uff0c\u7136\u540e\u518d\u8f6f\u94fe\uff08symlink\uff09\u5230 /etc/nginx/sites-enabled \u4e0b\u542f\u7528\u7ad9\u70b9\u3002</p> <ul> <li>nginx \u7684 sites-available \u548c sites-enabled \u7684\u533a\u522b</li> <li>sites-available/enabled \u4e0e conf.d \u5bf9\u6bd4</li> <li>nginx \u542f\u7528\u7ad9\u70b9\u548c\u53ef\u7528\u7ad9\u70b9</li> </ul>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#webdavconf","title":"webdav.conf","text":"<p>\u548c macOS \u4e0b\u7684\u914d\u7f6e webdav \u601d\u8def\u4e00\u6837\uff0c\u53ef\u4ee5\u7f16\u8f91 sites-available/default\uff0c\u5728 default_server \u4e0b\u6302\u4e00\u4e2a\u4e8c\u7ea7\u8def\u5f84 <code>location webdav/</code> \u8def\u7531\u3002</p> <p>\u53e6\u4e00\u79cd\u601d\u8def\u662f\u914d\u7f6e\u72ec\u7acb\u7684 webdav server\uff0c\u4e0d\u4e0e default_server \u6405\u5408\u5728\u4e00\u8d77\u3002</p> <p>\u6309\u7167 nginx \u7684\u914d\u7f6e\u7ba1\u7406\u903b\u8f91\uff0c\u5728 sites-available \u4e0b\u65b0\u5efa webdav \u914d\u7f6e\u6587\u4ef6\uff1a</p> \u6dfb\u52a0\u53ef\u7528\u7ad9\u70b9<pre><code>$ sudo vim /etc/nginx/sites-available/webdav.conf\n</code></pre> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u5c06 webdav \u914d\u7f6e\u6587\u4ef6 webdav.conf \u76f4\u63a5\u653e\u5728 conf.d \u76ee\u5f55\u4e0b\uff0c\u4e0d\u9700\u8981\u65f6\u6539\u540e\u7f00\u5373\u53ef\u3002</p> <p>\u9ed8\u8ba4\u7684 server \u76d1\u542c 80 \u7aef\u53e3\uff0c\u8fd9\u91cc\u65b0\u5efa server \u76d1\u542c 81 \u7aef\u53e3\uff0c\u5e76\u8bbe\u7f6e\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\u3002</p> <p>\u5b8c\u6574\u7684 webdav.conf \u8bb0\u5f55\u5907\u5fd8\u5982\u4e0b\uff1a</p> /etc/nginx/sites-available/webdav.conf <pre><code># config lock for macOS Client\ndav_ext_lock_zone zone=webdav:10m;\n\nserver {\n    listen 81;\n    server_name localhost;\n\n    # \u8bbe\u7f6e\u4f7f\u7528UTF-8\u7f16\u7801,\u9632\u6b62\u4e2d\u6587\u6587\u4ef6\u540d\u4e71\u7801\n    charset utf-8;\n\n    # \u8bbe\u7f6e\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\n    error_log /var/log/nginx/webdav.error.log error;\n    access_log /var/log/nginx/webdav.access.log combined;\n\n    # [nginx\u4e0d\u6d4f\u89c8\u76f4\u63a5\u4e0b\u8f7d\u6587\u4ef6](https://www.cnblogs.com/oxspirt/p/10250744.html)\n    location / {\n        if ($request_filename ~* ^.*?\\.(txt|doc|pdf|rar|gz|zip|docx|exe|xlsx|ppt|pptx)$) {\n            add_header Content-Disposition: 'attachment;';\n        }\n    }\n\n    location /webdav {\n        # webdav \u5171\u4eab\u670d\u52a1\u76ee\u5f55\uff08\u53ef\u8003\u8651\u653e\u5728 opt/ \u4e0b\uff09\n        ## \u8bf7\u6ce8\u610f chown \u4e3a nginx worker \u7528\u6237 www-data:www-data\n        root /var/www;\n        # alias /var/www/webdav;\n\n        # webdav \u7528\u6237(www-data)\u7684\u9ed8\u8ba4\u6743\u9650\n        dav_access user:rw group:rw all:r;\n\n        # auth_basic \u53c2\u6570\u88ab\u7528\u4f5c\u57df\uff0c\u5e76\u5728\u6388\u6743\u5f39\u7a97\u4e2d\u663e\u793a\u3002\n        auth_basic \"webdav\";\n        # htpasswd \u7528\u6237\u5bc6\u7801\u6587\u4ef6\u5b58\u653e\u7684\u4f4d\u7f6e\n        auth_basic_user_file /etc/nginx/.htpasswd;\n\n        # webdav \u53ca ext \u5141\u8bb8\u7684\u64cd\u4f5c\n        dav_methods PUT DELETE MKCOL COPY MOVE;\n        dav_ext_methods PROPFIND OPTIONS LOCK UNLOCK;\n        dav_ext_lock zone=webdav;\n\n        # \u5f00\u542f\u652f\u6301\u76ee\u5f55\u6d4f\u89c8\u529f\u80fd\n        autoindex on;\n        # \u663e\u793a\u51fa\u6587\u4ef6\u7684\u5927\u6982\u5927\u5c0f\uff0c\u5355\u4f4d\u662fKB\u6216\u8005MB\u6216\u8005GB\n        autoindex_exact_size off;\n\n        # \u542f\u7528\u5b8c\u6574\u7684\u521b\u5efa\u76ee\u5f55\u652f\u6301\n        ## \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cPUT\u65b9\u6cd5\u53ea\u80fd\u5728\u5df2\u5b58\u5728\u7684\u76ee\u5f55\u91cc\u521b\u5efa\u6587\u4ef6\n        create_full_put_path on;\n\n        # \u4e34\u65f6\u7f13\u5b58\u6587\u4ef6\u4f4d\u7f6e\n        client_body_temp_path /tmp/webdav;\n\n        # \u6700\u5927\u4e0a\u4f20\u6587\u4ef6\u9650\u5236, 0\u8868\u793a\u65e0\u9650\u5236\n        client_max_body_size 4G;\n\n        ########################################\n        # \u4e3a\u5404\u79cd\u65b9\u6cd5\u7684URI\u540e\u52a0\u4e0a\u659c\u6760\uff0c\u89e3\u51b3\u5404\u5e73\u53f0webdav\u5ba2\u6237\u7aef\u7684\u517c\u5bb9\u6027\u95ee\u9898\n        ########################################\n\n        # issue: ngx_http_dav_module.c \u5224\u65ad MKCOL \u6307\u4ee4\u7684 URI \u5fc5\u987b\u4ee5 / \u7ed3\u5c3e\n        # \u6ce8\u610f\uff1a\u5982\u679c\u662f alias\uff0c\u6ce8\u610f\u8c03\u6574 rewrite \u8def\u5f84\uff0c\u6216\u6362\u6210 root\uff01\n        if ($request_method ~ MKCOL) {\n            rewrite ^(.*[^/])$ $1/ break;\n        }\n\n        # issue: ngx_http_dav_module.c \u5224\u65ad MOVE \u6307\u4ee4\u7684 URI \u548c Destination URI \u7ed3\u5c3e\u7684 / \u5fc5\u987b\u5339\u914d\n        # scenario: MOVE \u6587\u4ef6\u5939 Destination URI \u672a\u4ee5 / \u7ed3\u5c3e: /webdav/test/ --&gt; /webdav/test2\n        # error log: both URI and \"Destination\" URI should be either collections or non-collections\n        set $dest $http_destination;\n        if (-d $request_filename) {\n            rewrite ^(.*[^/])$ $1/;\n            set $dest $dest/;\n        }\n\n        # \u9700\u8981\u5b89\u88c5 headers-more module\n        if ($request_method ~ (MOVE|COPY)) {\n            more_set_input_headers 'Destination: $dest';\n        }\n    }\n\n    # Bonus: Stopping Finder's Garbage\n    # https://www.robpeck.com/2020/06/making-webdav-actually-work-on-nginx/\n    location ~ \\.(_.*|DS_Store|Spotlight-V100|TemporaryItems|Trashes|hidden|localized)$ {\n        access_log off;\n        error_log off;\n\n        if ($request_method = PUT) {\n            return 403;\n        }\n        return 404;\n    }\n\n    location ~ \\.metadata_never_index$ {\n        return 200 \"Don't index this drive, Finder!\";\n    }\n\n    error_page 500 502 503 504 /50x.html;\n    location = /50x.html {\n        root /usr/share/nginx/html;\n    }\n}\n</code></pre> <p>\u6700\u540e\uff0c\u8bb0\u5f97\u5c06 sites-available \u4e0b\u7684 webdav.conf \u8f6f\u94fe\u4e00\u4efd\u5230 sites-enabled \u76ee\u5f55\u4e0b\u542f\u7528\u7ad9\u70b9\uff1a</p> \u8f6f\u94fe\u542f\u7528\u7ad9\u70b9<pre><code>$ sudo ln -s /etc/nginx/sites-available/webdav.conf /etc/nginx/sites-enabled\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#restart_nginx_server","title":"restart nginx server","text":"<p>\u6bcf\u6b21\u4fee\u6539\u4e86 nginx \u914d\u7f6e\u6587\u4ef6\uff0c\u9700\u8981\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\uff08\u6216\u91cd\u542f\u670d\u52a1\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e09\u79cd\u65b9\u5f0f\uff1a</p> <ol> <li><code>sudo nginx -s reload</code></li> <li><code>sudo systemctl reload nginx</code></li> <li><code>sudo systemctl restart nginx</code></li> </ol> <p>how to reload nginx - systemctl or nginx -s?</p> <p>\u53ef\u4ee5\u6267\u884c <code>sudo systemctl status nginx</code> \u67e5\u770b nginx \u8fd0\u884c\u72b6\u6001\u3002</p> <p>How to stop nginx service?</p> <pre><code>$ sudo nginx -s stop\n$ sudo systemctl kill nginx\n$ sudo systemctl stop nginx\n</code></pre>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#webdav_test","title":"webdav test","text":"<p>\u5173\u4e8e webdav \u7684\u8fde\u63a5\u6d4b\u8bd5\uff0c\u53c2\u8003 macOS\u4e0a\u57fa\u4e8ehttpd\u642d\u5efaWebDav\u670d\u52a1 - \u5c40\u57df\u7f51\u8fde\u63a5\u9a8c\u8bc1WebDAV\u670d\u52a1 \u548c \u4f7f\u7528\u547d\u4ee4\u884c\u6302\u8f7d\u64cd\u4f5cWebDAV\u4e91\u76d8 \u4e2d\u7684\u76f8\u5173\u8bf4\u660e\u3002</p> <ol> <li>\u6267\u884c curl localhost:81 \u9a8c\u8bc1 web \u670d\u52a1\u662f\u5426\u6b63\u5e38\uff1b</li> </ol> <p>\u81ea\u542f\u7684\u975e80\u670d\u52a1\uff08\u8fd9\u91cc\u76d1\u542c 81 \u7aef\u53e3\uff09\uff0clocation / \u672a\u6307\u5b9a root\uff0cDocroot \u9ed8\u8ba4\u4e3a --prefix=/usr/share/nginx \u4e0b\u7684 html \u76ee\u5f55\u3002</p> <ol> <li>WebDAV \u5ba2\u6237\u7aef\u8bbf\u95ee http://rpi4b-ubuntu.local:81/webdav/ \u9a8c\u8bc1 webDAV \u670d\u52a1\u662f\u5426\u6b63\u5e38\u3002</li> </ol> <p>\u8c03\u8bd5\u671f\u95f4\uff0c\u53ef\u5728 nginx \u670d\u52a1\u5668\u6267\u884c <code>tail -f tail -f /var/log/nginx/webdav.error.log</code>\uff08\u6216 access.log\uff09\u5b9e\u65f6\u67e5\u770b\u6eda\u52a8\u65e5\u5fd7\u3002</p>","tags":["nginx","webDAV"]},{"location":"blog/20240318/ubuntu-install-nginx-full-config-webdav/#refs","title":"refs","text":"<p>Nginx\u5b89\u88c5webdav - Debian+OMV Ubuntu\u4f7f\u7528nginx\u642d\u5efawebdav\u6587\u4ef6\u670d\u52a1\u5668\u7684\u8be6\u7ec6\u8fc7\u7a0b Ubuntu\u4f7f\u7528nginx\u642d\u5efawebdav\u6587\u4ef6\u670d\u52a1\u5668\u7684\u8be6\u7ec6\u8fc7\u7a0b</p> <p>Viewing and monitoring log files | Ubuntu</p>","tags":["nginx","webDAV"]},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/archive/2023/","title":"2023","text":""},{"location":"blog/archive/2022/","title":"2022","text":""},{"location":"blog/archive/2021/","title":"2021","text":""},{"location":"blog/archive/2020/","title":"2020","text":""},{"location":"blog/archive/2019/","title":"2019","text":""},{"location":"blog/archive/2018/","title":"2018","text":""},{"location":"blog/archive/2017/","title":"2017","text":""},{"location":"blog/archive/2015/","title":"2015","text":""},{"location":"blog/archive/2009/","title":"2009","text":""},{"location":"blog/category/macos/","title":"macOS","text":""},{"location":"blog/category/resource/","title":"resource","text":""},{"location":"blog/category/excerpt/","title":"excerpt","text":""},{"location":"blog/category/mkdocs/","title":"mkdocs","text":""},{"location":"blog/category/material/","title":"material","text":""},{"location":"blog/category/markdown/","title":"markdown","text":""},{"location":"blog/category/ubuntu/","title":"ubuntu","text":""},{"location":"blog/category/nginx/","title":"nginx","text":""},{"location":"blog/category/webdav/","title":"webDAV","text":""},{"location":"blog/category/cpp/","title":"cpp","text":""},{"location":"blog/category/cs/","title":"CS","text":""},{"location":"blog/category/c/","title":"c","text":""},{"location":"blog/category/toolchain/","title":"toolchain","text":""},{"location":"blog/category/python/","title":"python","text":""},{"location":"blog/category/linux/","title":"linux","text":""},{"location":"blog/category/shell/","title":"shell","text":""},{"location":"blog/category/wiki/","title":"wiki","text":""},{"location":"blog/category/zsh/","title":"zsh","text":""},{"location":"blog/category/git/","title":"git","text":""},{"location":"blog/category/vim/","title":"vim","text":""},{"location":"blog/category/editor/","title":"editor","text":""},{"location":"blog/page/2/","title":"Blog","text":""},{"location":"blog/page/3/","title":"Blog","text":""},{"location":"blog/page/4/","title":"Blog","text":""},{"location":"blog/page/5/","title":"Blog","text":""},{"location":"blog/page/6/","title":"Blog","text":""},{"location":"blog/page/7/","title":"Blog","text":""},{"location":"blog/page/8/","title":"Blog","text":""},{"location":"blog/page/9/","title":"Blog","text":""},{"location":"blog/page/10/","title":"Blog","text":""},{"location":"blog/page/11/","title":"Blog","text":""},{"location":"blog/page/12/","title":"Blog","text":""},{"location":"blog/page/13/","title":"Blog","text":""},{"location":"blog/page/14/","title":"Blog","text":""},{"location":"blog/page/15/","title":"Blog","text":""},{"location":"blog/page/16/","title":"Blog","text":""},{"location":"blog/page/17/","title":"Blog","text":""},{"location":"blog/page/18/","title":"Blog","text":""},{"location":"blog/page/19/","title":"Blog","text":""},{"location":"blog/page/20/","title":"Blog","text":""},{"location":"blog/archive/2024/page/2/","title":"2024","text":""},{"location":"blog/archive/2024/page/3/","title":"2024","text":""},{"location":"blog/archive/2021/page/2/","title":"2021","text":""},{"location":"blog/archive/2019/page/2/","title":"2019","text":""},{"location":"blog/archive/2019/page/3/","title":"2019","text":""},{"location":"blog/archive/2019/page/4/","title":"2019","text":""},{"location":"blog/archive/2019/page/5/","title":"2019","text":""},{"location":"blog/archive/2019/page/6/","title":"2019","text":""},{"location":"blog/archive/2019/page/7/","title":"2019","text":""},{"location":"blog/archive/2019/page/8/","title":"2019","text":""},{"location":"blog/archive/2019/page/9/","title":"2019","text":""},{"location":"blog/archive/2019/page/10/","title":"2019","text":""},{"location":"blog/archive/2018/page/2/","title":"2018","text":""},{"location":"blog/archive/2017/page/2/","title":"2017","text":""},{"location":"blog/category/cs/page/2/","title":"CS","text":""},{"location":"blog/category/editor/page/2/","title":"editor","text":""},{"location":"blog/category/git/page/2/","title":"git","text":""},{"location":"blog/category/linux/page/2/","title":"linux","text":""},{"location":"blog/category/linux/page/3/","title":"linux","text":""},{"location":"blog/category/linux/page/4/","title":"linux","text":""},{"location":"blog/category/linux/page/5/","title":"linux","text":""},{"location":"blog/category/linux/page/6/","title":"linux","text":""},{"location":"blog/category/mkdocs/page/2/","title":"mkdocs","text":""},{"location":"blog/category/python/page/2/","title":"python","text":""},{"location":"blog/category/python/page/3/","title":"python","text":""},{"location":"blog/category/python/page/4/","title":"python","text":""},{"location":"blog/category/python/page/5/","title":"python","text":""},{"location":"blog/category/shell/page/2/","title":"shell","text":""},{"location":"blog/category/vim/page/2/","title":"vim","text":""},{"location":"blog/category/wiki/page/2/","title":"wiki","text":""},{"location":"blog/category/wiki/page/3/","title":"wiki","text":""},{"location":"blog/category/wiki/page/4/","title":"wiki","text":""}]}