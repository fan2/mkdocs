
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="在别处或在路上">
      
      
        <meta name="author" content="Cliff Fan">
      
      
        <link rel="canonical" href="https://duetorun.com/blog/20230628/plt-puts-analysis/">
      
      
        <link rel="prev" href="../../20230627/elf-obj-tour/">
      
      
        <link rel="next" href="../../20230629/plt-puts-pwndbg/">
      
      
      <link rel="icon" href="../../../assets/hold_yourself.jpg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.15">
    
    
      
        <title>puts@plt/rela/got - static analysis - ElseWhere</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-XGW41EGL31"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-XGW41EGL31",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-XGW41EGL31",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dependency" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="ElseWhere" class="md-header__button md-logo" aria-label="ElseWhere" data-md-component="logo">
      
  <img src="../../../assets/hold_yourself.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ElseWhere
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              puts@plt/rela/got - static analysis
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8v2m9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../link/" class="md-tabs__link">
        
  
    
  
  Link

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ElseWhere" class="md-nav__button md-logo" aria-label="ElseWhere" data-md-component="logo">
      
  <img src="../../../assets/hold_yourself.jpg" alt="logo">

    </a>
    ElseWhere
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2017
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2015/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2015
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2009/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2009
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/arm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/c/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    c
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cpp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cpp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/elf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/excerpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    excerpt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/macos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/material/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    material
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/mkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/resource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    resource
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/toolchain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolchain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/vim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/webdav/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webDAV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/wiki/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wiki
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/zsh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zsh
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Link
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependency" class="md-nav__link">
    <span class="md-ellipsis">
      dependency
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entry_point" class="md-nav__link">
    <span class="md-ellipsis">
      entry point
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sections2segments" class="md-nav__link">
    <span class="md-ellipsis">
      sections2segments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sections2segments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sections" class="md-nav__link">
    <span class="md-ellipsis">
      sections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segments" class="md-nav__link">
    <span class="md-ellipsis">
      segments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping" class="md-nav__link">
    <span class="md-ellipsis">
      mapping
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic_section" class="md-nav__link">
    <span class="md-ellipsis">
      dynamic section
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dynamic section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hexdump" class="md-nav__link">
    <span class="md-ellipsis">
      hexdump
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readelf" class="md-nav__link">
    <span class="md-ellipsis">
      readelf
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic_symbol" class="md-nav__link">
    <span class="md-ellipsis">
      dynamic symbol
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dynamic symbol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynstr" class="md-nav__link">
    <span class="md-ellipsis">
      .dynstr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hexdump_dynsym" class="md-nav__link">
    <span class="md-ellipsis">
      hexdump .dynsym
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readelfobjdump" class="md-nav__link">
    <span class="md-ellipsis">
      readelf/objdump
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#relocation_entries" class="md-nav__link">
    <span class="md-ellipsis">
      relocation entries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="relocation entries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hexdump_sections" class="md-nav__link">
    <span class="md-ellipsis">
      hexdump sections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#readelfobjdump_1" class="md-nav__link">
    <span class="md-ellipsis">
      readelf/objdump
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#global_offset_table" class="md-nav__link">
    <span class="md-ellipsis">
      global offset table
    </span>
  </a>
  
    <nav class="md-nav" aria-label="global offset table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hexdump_got" class="md-nav__link">
    <span class="md-ellipsis">
      hexdump .got
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_global_offset_table_" class="md-nav__link">
    <span class="md-ellipsis">
      _GLOBAL_OFFSET_TABLE_
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#putsplt" class="md-nav__link">
    <span class="md-ellipsis">
      puts@plt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="puts@plt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disassemble" class="md-nav__link">
    <span class="md-ellipsis">
      disassemble
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolution" class="md-nav__link">
    <span class="md-ellipsis">
      resolution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://duetorun.com/assets/carve_yourself.jpg" alt="Cliff Fan">
                    </span>
                    <span class="md-profile__description">
                      <strong>
                        
                          Cliff Fan
                        
                      </strong>
                      <br>
                      Just do IT
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                        <time datetime="2023-06-28 10:00:00" class="md-ellipsis">2023年6月28日</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                          <span class="md-ellipsis">
                            分类于
                            
                              <a href="../../category/elf/">elf</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg>
                          <span class="md-ellipsis">
                            
                              需要 20 分钟阅读时间
                            
                          </span>
                        </div>
                      </li>
                    
                    <!-- Add by Cliff.Fan, 29Mar24. -->
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 1-5 5v11l5-4.5V1m2 4v13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6c-1.45-1.1-3.55-1.5-5.5-1.5-1.95 0-4.05.4-5.5 1.5v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1M10 18.41C8.75 18.09 7.5 18 6.5 18c-1.06 0-2.32.19-3.5.5V7.13c.91-.4 2.14-.63 3.5-.63 1.36 0 2.59.23 3.5.63v11.28Z"/></svg>
                        <span class="md-ellipsis" id="busuanzi_container_page_pv">
                          阅读量：<span id="busuanzi_value_page_pv">N/A</span>
                        </span>
                      </div>
                    </li>
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  
  

<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">.dynamic</span>
    
  
    
    
    
      <span class="md-tag">.dynstr</span>
    
  
    
    
    
      <span class="md-tag">.dynsym</span>
    
  
    
    
    
      <span class="md-tag">.rela.plt</span>
    
  
    
    
    
      <span class="md-tag">.got</span>
    
  
    
    
    
      <span class="md-tag">.plt</span>
    
  
</nav>



  <h1>puts@plt/rela/got - static analysis</h1>

<p>So far we've been through the <a href="../../20230625/gcc-compilation-dynamic/">default gcc compilation process</a> and had a look at <a href="../../20230625/elf-dyn-tour/">the product of our C demo program</a> <code>a.out</code> with <a href="../../20230620/gnu-binutils/">GNU binutils</a>.</p>
<p>It links dynamically by default, a dynamic linker (aka interpreter) is used to resolve the final dependencies on dynamic libraries when the executable is loaded into memory to run.</p>
<p>In this article I'll have a look at how the shared dynamic symbol such as <code>puts</code> is designated at link time in the DYN PIE ELF.</p>
<!-- more -->

<h2 id="dependency">dependency<a class="headerlink" href="#dependency" title="Permanent link">#</a></h2>
<p><code>file</code>: tests the file in an attempt to classify it.</p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$<span class="w"> </span>file<span class="w"> </span>a.out
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>a.out:<span class="w"> </span>ELF<span class="w"> </span><span class="m">64</span>-bit<span class="w"> </span>LSB<span class="w"> </span>pie<span class="w"> </span>executable,<span class="w"> </span>ARM<span class="w"> </span>aarch64,<span class="w"> </span>version<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>SYSV<span class="o">)</span>,<span class="w"> </span>dynamically<span class="w"> </span>linked,<span class="w"> </span>interpreter<span class="w"> </span>/lib/ld-linux-aarch64.so.1,<span class="w"> </span>BuildID<span class="o">[</span>sha1<span class="o">]=</span>429e4cbff3d62b27c644cef2b8aaf62d380b9690,<span class="w"> </span><span class="k">for</span><span class="w"> </span>GNU/Linux<span class="w"> </span><span class="m">3</span>.7.0,<span class="w"> </span>not<span class="w"> </span>stripped
</span></code></pre></div><br />
The output indicates the executable file type and the interpreter.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span>readelf<span class="w"> </span>-p<span class="w"> </span>.interp<span class="w"> </span>a.out
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>String<span class="w"> </span>dump<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span><span class="s1">&#39;.interp&#39;</span>:
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="o">[</span><span class="w">     </span><span class="m">0</span><span class="o">]</span><span class="w">  </span>/lib/ld-linux-aarch64.so.1
</span></code></pre></div>
<p>On the other hand, the program has called dynamic symbols such as <code>printf</code> (optimized out va_list without format specifier, fallback to <code>puts</code>) which are exported by the dynamic shared library <code>libc.so</code>. This means that the DYN PIE ELF depends on <code>libc.so</code> to implement its functionality. In other words, there is a dependency that has to be resolved at run time.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>$<span class="w"> </span>readelf<span class="w"> </span>-d<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-4
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>Dynamic<span class="w"> </span>section<span class="w"> </span>at<span class="w"> </span>offset<span class="w"> </span>0xda0<span class="w"> </span>contains<span class="w"> </span><span class="m">27</span><span class="w"> </span>entries:
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span>Tag<span class="w">        </span>Type<span class="w">                         </span>Name/Value
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w"> </span>0x0000000000000001<span class="w"> </span><span class="o">(</span>NEEDED<span class="o">)</span><span class="w">             </span>Shared<span class="w"> </span>library:<span class="w"> </span><span class="o">[</span>libc.so.6<span class="o">]</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>$<span class="w"> </span>objdump<span class="w"> </span>-x<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;/Dynamic Section/{N;p}&#39;</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>Dynamic<span class="w"> </span>Section:
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">  </span>NEEDED<span class="w">               </span>libc.so.6
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>$<span class="w"> </span>radare2.rabin2<span class="w"> </span>-l<span class="w"> </span>a.out
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="o">[</span>Linked<span class="w"> </span>libraries<span class="o">]</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>libc.so.6
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="m">1</span><span class="w"> </span>library
</span></code></pre></div>
<h2 id="entry_point">entry point<a class="headerlink" href="#entry_point" title="Permanent link">#</a></h2>
<p><code>objdump [-f|--file-headers]</code>: display the contents of the overall file header.<br />
The output indicates the file type and the start logic address.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>$<span class="w"> </span>objdump<span class="w"> </span>-f<span class="w"> </span>a.out
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>a.out:<span class="w">     </span>file<span class="w"> </span>format<span class="w"> </span>elf64-littleaarch64
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>architecture:<span class="w"> </span>aarch64,<span class="w"> </span>flags<span class="w"> </span>0x00000150:
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>HAS_SYMS,<span class="w"> </span>DYNAMIC,<span class="w"> </span>D_PAGED
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>start<span class="w"> </span>address<span class="w"> </span>0x0000000000000640
</span></code></pre></div>
<p><code>readelf  [-h|--file-header]</code>: display the ELF file header.<br />
The output extracts full binary information from the ELF header.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$<span class="w"> </span>readelf<span class="w"> </span>-h<span class="w"> </span>a.out
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>ELF<span class="w"> </span>Header:
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span>Magic:<span class="w">   </span>7f<span class="w"> </span><span class="m">45</span><span class="w"> </span>4c<span class="w"> </span><span class="m">46</span><span class="w"> </span><span class="m">02</span><span class="w"> </span><span class="m">01</span><span class="w"> </span><span class="m">01</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span><span class="w"> </span><span class="m">00</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span>Class:<span class="w">                             </span>ELF64
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span>Data:<span class="w">                              </span><span class="m">2</span><span class="err">&#39;</span>s<span class="w"> </span>complement,<span class="w"> </span>little<span class="w"> </span>endian
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span>Version:<span class="w">                           </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>current<span class="o">)</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span>OS/ABI:<span class="w">                            </span>UNIX<span class="w"> </span>-<span class="w"> </span>System<span class="w"> </span>V
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">  </span>ABI<span class="w"> </span>Version:<span class="w">                       </span><span class="m">0</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">  </span>Type:<span class="w">                              </span>DYN<span class="w"> </span><span class="o">(</span>Position-Independent<span class="w"> </span>Executable<span class="w"> </span>file<span class="o">)</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">  </span>Machine:<span class="w">                           </span>AArch64
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">  </span>Version:<span class="w">                           </span>0x1
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">  </span>Entry<span class="w"> </span>point<span class="w"> </span>address:<span class="w">               </span>0x640
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">  </span>Start<span class="w"> </span>of<span class="w"> </span>program<span class="w"> </span>headers:<span class="w">          </span><span class="m">64</span><span class="w"> </span><span class="o">(</span>bytes<span class="w"> </span>into<span class="w"> </span>file<span class="o">)</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">  </span>Start<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span>headers:<span class="w">          </span><span class="m">7080</span><span class="w"> </span><span class="o">(</span>bytes<span class="w"> </span>into<span class="w"> </span>file<span class="o">)</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">  </span>Flags:<span class="w">                             </span>0x0
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">  </span>Size<span class="w"> </span>of<span class="w"> </span>this<span class="w"> </span>header:<span class="w">               </span><span class="m">64</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">  </span>Size<span class="w"> </span>of<span class="w"> </span>program<span class="w"> </span>headers:<span class="w">           </span><span class="m">56</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span>program<span class="w"> </span>headers:<span class="w">         </span><span class="m">9</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="w">  </span>Size<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span>headers:<span class="w">           </span><span class="m">64</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="w">  </span>Number<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span>headers:<span class="w">         </span><span class="m">28</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="w">  </span>Section<span class="w"> </span>header<span class="w"> </span>string<span class="w"> </span>table<span class="w"> </span>index:<span class="w"> </span><span class="m">27</span>
</span></code></pre></div>
<p>rabin2's <code>-e</code> option can be used to list entrypoints:</p>
<p><code>-e</code>: program entrypoint<br />
<code>-ee</code>: constructor/destructor entrypoints</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$<span class="w"> </span>radare2.rabin2<span class="w"> </span>-eee<span class="w"> </span>a.out
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="o">[</span>Entrypoints<span class="o">]</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="nv">vaddr</span><span class="o">=</span>0x00000640<span class="w"> </span><span class="nv">paddr</span><span class="o">=</span>0x00000640<span class="w"> </span><span class="nv">haddr</span><span class="o">=</span>0x00000018<span class="w"> </span><span class="nv">hvaddr</span><span class="o">=</span>0x00000018<span class="w"> </span><span class="nv">type</span><span class="o">=</span>program
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="m">1</span><span class="w"> </span>entrypoints
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="o">[</span>Constructors<span class="o">]</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="nv">vaddr</span><span class="o">=</span>0x00000750<span class="w"> </span><span class="nv">paddr</span><span class="o">=</span>0x00000750<span class="w"> </span><span class="nv">hvaddr</span><span class="o">=</span>0x00010d90<span class="w"> </span><span class="nv">hpaddr</span><span class="o">=</span>0x00000d90<span class="w"> </span><span class="nv">type</span><span class="o">=</span>init
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="nv">vaddr</span><span class="o">=</span>0x00000700<span class="w"> </span><span class="nv">paddr</span><span class="o">=</span>0x00000700<span class="w"> </span><span class="nv">hvaddr</span><span class="o">=</span>0x00010d98<span class="w"> </span><span class="nv">hpaddr</span><span class="o">=</span>0x00000d98<span class="w"> </span><span class="nv">type</span><span class="o">=</span>fini
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="m">2</span><span class="w"> </span>entrypoints
</span></code></pre></div>
<p>You can extract the address of the entry point by means of one of the following commands.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>radare2.rabin2<span class="w"> </span>-eq<span class="w"> </span>a.out
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>objdump<span class="w"> </span>-f<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;s/^start address //p&#39;</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>objdump<span class="w"> </span>-f<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/start address/ {print $NF}&#39;</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>readelf<span class="w"> </span>-h<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;s/.*Entry point address:\s*//p&#39;</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>readelf<span class="w"> </span>-h<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/Entry point address/ {print $NF}&#39;</span>
</span></code></pre></div>
<h2 id="sections2segments">sections2segments<a class="headerlink" href="#sections2segments" title="Permanent link">#</a></h2>
<h3 id="sections">sections<a class="headerlink" href="#sections" title="Permanent link">#</a></h3>
<p><code>rabin2 -S</code> / <code>r2 &gt; iS</code>: sections</p>
<ul>
<li><code>readelf [-S|--section-headers|--sections]</code>: Display the sections' header.</li>
<li><code>objdump [-h|--section-headers|--headers]</code>: Display the contents of the section headers.</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>$<span class="w"> </span>radare2.rabin2<span class="w"> </span>-S<span class="w"> </span>a.out
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="o">[</span>Sections<span class="o">]</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>nth<span class="w"> </span>paddr<span class="w">        </span>size<span class="w"> </span>vaddr<span class="w">       </span>vsize<span class="w"> </span>perm<span class="w"> </span><span class="nb">type</span><span class="w">        </span>name
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="m">0</span><span class="w">   </span>0x00000000<span class="w">    </span>0x0<span class="w"> </span>0x00000000<span class="w">    </span>0x0<span class="w"> </span>----<span class="w"> </span>NULL
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="m">1</span><span class="w">   </span>0x00000238<span class="w">   </span>0x1b<span class="w"> </span>0x00000238<span class="w">   </span>0x1b<span class="w"> </span>-r--<span class="w"> </span>PROGBITS<span class="w">    </span>.interp
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="m">2</span><span class="w">   </span>0x00000254<span class="w">   </span>0x24<span class="w"> </span>0x00000254<span class="w">   </span>0x24<span class="w"> </span>-r--<span class="w"> </span>NOTE<span class="w">        </span>.note.gnu.build-id
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="m">3</span><span class="w">   </span>0x00000278<span class="w">   </span>0x20<span class="w"> </span>0x00000278<span class="w">   </span>0x20<span class="w"> </span>-r--<span class="w"> </span>NOTE<span class="w">        </span>.note.ABI-tag
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="m">4</span><span class="w">   </span>0x00000298<span class="w">   </span>0x1c<span class="w"> </span>0x00000298<span class="w">   </span>0x1c<span class="w"> </span>-r--<span class="w"> </span>GNU_HASH<span class="w">    </span>.gnu.hash
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="m">5</span><span class="w">   </span>0x000002b8<span class="w">   </span>0xf0<span class="w"> </span>0x000002b8<span class="w">   </span>0xf0<span class="w"> </span>-r--<span class="w"> </span>DYNSYM<span class="w">      </span>.dynsym
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="m">6</span><span class="w">   </span>0x000003a8<span class="w">   </span>0x92<span class="w"> </span>0x000003a8<span class="w">   </span>0x92<span class="w"> </span>-r--<span class="w"> </span>STRTAB<span class="w">      </span>.dynstr
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="m">7</span><span class="w">   </span>0x0000043a<span class="w">   </span>0x14<span class="w"> </span>0x0000043a<span class="w">   </span>0x14<span class="w"> </span>-r--<span class="w"> </span>GNU_VERSYM<span class="w">  </span>.gnu.version
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="m">8</span><span class="w">   </span>0x00000450<span class="w">   </span>0x30<span class="w"> </span>0x00000450<span class="w">   </span>0x30<span class="w"> </span>-r--<span class="w"> </span>GNU_VERNEED<span class="w"> </span>.gnu.version_r
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="m">9</span><span class="w">   </span>0x00000480<span class="w">   </span>0xc0<span class="w"> </span>0x00000480<span class="w">   </span>0xc0<span class="w"> </span>-r--<span class="w"> </span>RELA<span class="w">        </span>.rela.dyn
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="m">10</span><span class="w">  </span>0x00000540<span class="w">   </span>0x78<span class="w"> </span>0x00000540<span class="w">   </span>0x78<span class="w"> </span>-r--<span class="w"> </span>RELA<span class="w">        </span>.rela.plt
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="m">11</span><span class="w">  </span>0x000005b8<span class="w">   </span>0x18<span class="w"> </span>0x000005b8<span class="w">   </span>0x18<span class="w"> </span>-r-x<span class="w"> </span>PROGBITS<span class="w">    </span>.init
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="m">12</span><span class="w">  </span>0x000005d0<span class="w">   </span>0x70<span class="w"> </span>0x000005d0<span class="w">   </span>0x70<span class="w"> </span>-r-x<span class="w"> </span>PROGBITS<span class="w">    </span>.plt
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="m">13</span><span class="w">  </span>0x00000640<span class="w">  </span>0x13c<span class="w"> </span>0x00000640<span class="w">  </span>0x13c<span class="w"> </span>-r-x<span class="w"> </span>PROGBITS<span class="w">    </span>.text
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="m">14</span><span class="w">  </span>0x0000077c<span class="w">   </span>0x14<span class="w"> </span>0x0000077c<span class="w">   </span>0x14<span class="w"> </span>-r-x<span class="w"> </span>PROGBITS<span class="w">    </span>.fini
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="m">15</span><span class="w">  </span>0x00000790<span class="w">   </span>0x16<span class="w"> </span>0x00000790<span class="w">   </span>0x16<span class="w"> </span>-r--<span class="w"> </span>PROGBITS<span class="w">    </span>.rodata
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="m">16</span><span class="w">  </span>0x000007a8<span class="w">   </span>0x3c<span class="w"> </span>0x000007a8<span class="w">   </span>0x3c<span class="w"> </span>-r--<span class="w"> </span>PROGBITS<span class="w">    </span>.eh_frame_hdr
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="m">17</span><span class="w">  </span>0x000007e8<span class="w">   </span>0xac<span class="w"> </span>0x000007e8<span class="w">   </span>0xac<span class="w"> </span>-r--<span class="w"> </span>PROGBITS<span class="w">    </span>.eh_frame
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="m">18</span><span class="w">  </span>0x00000d90<span class="w">    </span>0x8<span class="w"> </span>0x00010d90<span class="w">    </span>0x8<span class="w"> </span>-rw-<span class="w"> </span>INIT_ARRAY<span class="w">  </span>.init_array
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="m">19</span><span class="w">  </span>0x00000d98<span class="w">    </span>0x8<span class="w"> </span>0x00010d98<span class="w">    </span>0x8<span class="w"> </span>-rw-<span class="w"> </span>FINI_ARRAY<span class="w">  </span>.fini_array
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="m">20</span><span class="w">  </span>0x00000da0<span class="w">  </span>0x1f0<span class="w"> </span>0x00010da0<span class="w">  </span>0x1f0<span class="w"> </span>-rw-<span class="w"> </span>DYNAMIC<span class="w">     </span>.dynamic
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="m">21</span><span class="w">  </span>0x00000f90<span class="w">   </span>0x70<span class="w"> </span>0x00010f90<span class="w">   </span>0x70<span class="w"> </span>-rw-<span class="w"> </span>PROGBITS<span class="w">    </span>.got
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="m">22</span><span class="w">  </span>0x00001000<span class="w">   </span>0x10<span class="w"> </span>0x00011000<span class="w">   </span>0x10<span class="w"> </span>-rw-<span class="w"> </span>PROGBITS<span class="w">    </span>.data
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="m">23</span><span class="w">  </span>0x00001010<span class="w">    </span>0x0<span class="w"> </span>0x00011010<span class="w">    </span>0x8<span class="w"> </span>-rw-<span class="w"> </span>NOBITS<span class="w">      </span>.bss
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a><span class="m">24</span><span class="w">  </span>0x00001010<span class="w">   </span>0x2b<span class="w"> </span>0x00000000<span class="w">   </span>0x2b<span class="w"> </span>----<span class="w"> </span>PROGBITS<span class="w">    </span>.comment
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a><span class="m">25</span><span class="w">  </span>0x00001040<span class="w">  </span>0x840<span class="w"> </span>0x00000000<span class="w">  </span>0x840<span class="w"> </span>----<span class="w"> </span>SYMTAB<span class="w">      </span>.symtab
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a><span class="m">26</span><span class="w">  </span>0x00001880<span class="w">  </span>0x22c<span class="w"> </span>0x00000000<span class="w">  </span>0x22c<span class="w"> </span>----<span class="w"> </span>STRTAB<span class="w">      </span>.strtab
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a><span class="m">27</span><span class="w">  </span>0x00001aac<span class="w">   </span>0xfa<span class="w"> </span>0x00000000<span class="w">   </span>0xfa<span class="w"> </span>----<span class="w"> </span>STRTAB<span class="w">      </span>.shstrtab
</span></code></pre></div>
<h3 id="segments">segments<a class="headerlink" href="#segments" title="Permanent link">#</a></h3>
<p><code>rabin2 -SS</code> / <code>r2 &gt; iSS</code>: segments</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>radare2.rabin2<span class="w"> </span>-SS<span class="w"> </span>a.out
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="o">[</span>Segments<span class="o">]</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>nth<span class="w"> </span>paddr<span class="w">        </span>size<span class="w"> </span>vaddr<span class="w">       </span>vsize<span class="w"> </span>perm<span class="w"> </span><span class="nb">type</span><span class="w"> </span>name
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>――――――――――――――――――――――――――――――――――――――――――――――――――――――
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="m">0</span><span class="w">   </span>0x00000040<span class="w">  </span>0x1f8<span class="w"> </span>0x00000040<span class="w">  </span>0x1f8<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>PHDR
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="m">1</span><span class="w">   </span>0x00000238<span class="w">   </span>0x1b<span class="w"> </span>0x00000238<span class="w">   </span>0x1b<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>INTERP
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="m">2</span><span class="w">   </span>0x00000000<span class="w">  </span>0x894<span class="w"> </span>0x00000000<span class="w">  </span>0x894<span class="w"> </span>-r-x<span class="w"> </span>MAP<span class="w">  </span>LOAD0
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="m">3</span><span class="w">   </span>0x00000d90<span class="w">  </span>0x280<span class="w"> </span>0x00010d90<span class="w">  </span>0x288<span class="w"> </span>-rw-<span class="w"> </span>MAP<span class="w">  </span>LOAD1
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="m">4</span><span class="w">   </span>0x00000da0<span class="w">  </span>0x1f0<span class="w"> </span>0x00010da0<span class="w">  </span>0x1f0<span class="w"> </span>-rw-<span class="w"> </span>MAP<span class="w">  </span>DYNAMIC
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="m">5</span><span class="w">   </span>0x00000254<span class="w">   </span>0x44<span class="w"> </span>0x00000254<span class="w">   </span>0x44<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>NOTE
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="m">6</span><span class="w">   </span>0x000007a8<span class="w">   </span>0x3c<span class="w"> </span>0x000007a8<span class="w">   </span>0x3c<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>GNU_EH_FRAME
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="m">7</span><span class="w">   </span>0x00000000<span class="w">    </span>0x0<span class="w"> </span>0x00000000<span class="w">    </span>0x0<span class="w"> </span>-rw-<span class="w"> </span>MAP<span class="w">  </span>GNU_STACK
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="m">8</span><span class="w">   </span>0x00000d90<span class="w">  </span>0x270<span class="w"> </span>0x00010d90<span class="w">  </span>0x270<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>GNU_RELRO
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="m">9</span><span class="w">   </span>0x00000000<span class="w">   </span>0x40<span class="w"> </span>0x00000000<span class="w">   </span>0x40<span class="w"> </span>-rw-<span class="w"> </span>MAP<span class="w">  </span>ehdr
</span></code></pre></div>
<h3 id="mapping">mapping<a class="headerlink" href="#mapping" title="Permanent link">#</a></h3>
<p>Use <code>readelf -S</code>/<code>objdump -h</code> to display the sections' header.</p>
<ul>
<li><code>readelf [-S|--section-headers]</code>: display the sections' header</li>
<li><code>objdump [-h|--[section-]headers]</code>: display the contents of the section headers</li>
</ul>
<p>Use <code>readelf -lW</code> to display the program headers.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>$<span class="w"> </span>readelf<span class="w"> </span>-lW<span class="w"> </span>a.out
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>Elf<span class="w"> </span>file<span class="w"> </span><span class="nb">type</span><span class="w"> </span>is<span class="w"> </span>DYN<span class="w"> </span><span class="o">(</span>Position-Independent<span class="w"> </span>Executable<span class="w"> </span>file<span class="o">)</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>Entry<span class="w"> </span>point<span class="w"> </span>0x640
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>There<span class="w"> </span>are<span class="w"> </span><span class="m">9</span><span class="w"> </span>program<span class="w"> </span>headers,<span class="w"> </span>starting<span class="w"> </span>at<span class="w"> </span>offset<span class="w"> </span><span class="m">64</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>Program<span class="w"> </span>Headers:
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">  </span>Type<span class="w">           </span>Offset<span class="w">   </span>VirtAddr<span class="w">           </span>PhysAddr<span class="w">           </span>FileSiz<span class="w">  </span>MemSiz<span class="w">   </span>Flg<span class="w"> </span>Align
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">  </span>PHDR<span class="w">           </span>0x000040<span class="w"> </span>0x0000000000000040<span class="w"> </span>0x0000000000000040<span class="w"> </span>0x0001f8<span class="w"> </span>0x0001f8<span class="w"> </span>R<span class="w">   </span>0x8
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">  </span>INTERP<span class="w">         </span>0x000238<span class="w"> </span>0x0000000000000238<span class="w"> </span>0x0000000000000238<span class="w"> </span>0x00001b<span class="w"> </span>0x00001b<span class="w"> </span>R<span class="w">   </span>0x1
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">      </span><span class="o">[</span>Requesting<span class="w"> </span>program<span class="w"> </span>interpreter:<span class="w"> </span>/lib/ld-linux-aarch64.so.1<span class="o">]</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">  </span>LOAD<span class="w">           </span>0x000000<span class="w"> </span>0x0000000000000000<span class="w"> </span>0x0000000000000000<span class="w"> </span>0x000894<span class="w"> </span>0x000894<span class="w"> </span>R<span class="w"> </span>E<span class="w"> </span>0x10000
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">  </span>LOAD<span class="w">           </span>0x000d90<span class="w"> </span>0x0000000000010d90<span class="w"> </span>0x0000000000010d90<span class="w"> </span>0x000280<span class="w"> </span>0x000288<span class="w"> </span>RW<span class="w">  </span>0x10000
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">  </span>DYNAMIC<span class="w">        </span>0x000da0<span class="w"> </span>0x0000000000010da0<span class="w"> </span>0x0000000000010da0<span class="w"> </span>0x0001f0<span class="w"> </span>0x0001f0<span class="w"> </span>RW<span class="w">  </span>0x8
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">  </span>NOTE<span class="w">           </span>0x000254<span class="w"> </span>0x0000000000000254<span class="w"> </span>0x0000000000000254<span class="w"> </span>0x000044<span class="w"> </span>0x000044<span class="w"> </span>R<span class="w">   </span>0x4
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">  </span>GNU_EH_FRAME<span class="w">   </span>0x0007a8<span class="w"> </span>0x00000000000007a8<span class="w"> </span>0x00000000000007a8<span class="w"> </span>0x00003c<span class="w"> </span>0x00003c<span class="w"> </span>R<span class="w">   </span>0x4
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">  </span>GNU_STACK<span class="w">      </span>0x000000<span class="w"> </span>0x0000000000000000<span class="w"> </span>0x0000000000000000<span class="w"> </span>0x000000<span class="w"> </span>0x000000<span class="w"> </span>RW<span class="w">  </span>0x10
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">  </span>GNU_RELRO<span class="w">      </span>0x000d90<span class="w"> </span>0x0000000000010d90<span class="w"> </span>0x0000000000010d90<span class="w"> </span>0x000270<span class="w"> </span>0x000270<span class="w"> </span>R<span class="w">   </span>0x1
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w"> </span>Section<span class="w"> </span>to<span class="w"> </span>Segment<span class="w"> </span>mapping:
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">  </span>Segment<span class="w"> </span>Sections...
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">   </span><span class="m">00</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">   </span><span class="m">01</span><span class="w">     </span>.interp
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">   </span><span class="m">02</span><span class="w">     </span>.interp<span class="w"> </span>.note.gnu.build-id<span class="w"> </span>.note.ABI-tag<span class="w"> </span>.gnu.hash<span class="w"> </span>.dynsym<span class="w"> </span>.dynstr<span class="w"> </span>.gnu.version<span class="w"> </span>.gnu.version_r<span class="w"> </span>.rela.dyn<span class="w"> </span>.rela.plt<span class="w"> </span>.init<span class="w"> </span>.plt<span class="w"> </span>.text<span class="w"> </span>.fini<span class="w"> </span>.rodata<span class="w"> </span>.eh_frame_hdr<span class="w"> </span>.eh_frame
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">   </span><span class="m">03</span><span class="w">     </span>.init_array<span class="w"> </span>.fini_array<span class="w"> </span>.dynamic<span class="w"> </span>.got<span class="w"> </span>.data<span class="w"> </span>.bss
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="w">   </span><span class="m">04</span><span class="w">     </span>.dynamic
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="w">   </span><span class="m">05</span><span class="w">     </span>.note.gnu.build-id<span class="w"> </span>.note.ABI-tag
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">   </span><span class="m">06</span><span class="w">     </span>.eh_frame_hdr
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">   </span><span class="m">07</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="w">   </span><span class="m">08</span><span class="w">     </span>.init_array<span class="w"> </span>.fini_array<span class="w"> </span>.dynamic<span class="w"> </span>.got
</span></code></pre></div>
<p>Also, <code>rabin2</code> supports options to list sections and segments and their mapping relationship.</p>
<p><code>rabin2 -SSS</code>: sections mapping to segments.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>$<span class="w"> </span>radare2.rabin2<span class="w"> </span>-SSS<span class="w"> </span>a.out
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>Section<span class="w"> </span>to<span class="w"> </span>Segment<span class="w"> </span>mapping:
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>Segment<span class="w">      </span>Section
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>--------------------
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>PHDR
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>INTERP<span class="w">       </span>.interp
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>LOAD0<span class="w">        </span>.interp<span class="w"> </span>.note.gnu.build-id<span class="w"> </span>.note.ABI-tag<span class="w"> </span>.gnu.hash<span class="w"> </span>.dynsym<span class="w"> </span>.dynstr<span class="w"> </span>.gnu.version<span class="w"> </span>.gnu.version_r<span class="w"> </span>.rela.dyn<span class="w"> </span>.rela.plt<span class="w"> </span>.init<span class="w"> </span>.plt<span class="w"> </span>.text<span class="w"> </span>.fini<span class="w"> </span>.rodata<span class="w"> </span>.eh_frame_hdr<span class="w"> </span>.eh_frame<span class="w"> </span>.comment<span class="w"> </span>.symtab<span class="w"> </span>.strtab<span class="w"> </span>.shstrtab
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>LOAD1<span class="w">        </span>.init_array<span class="w"> </span>.fini_array<span class="w"> </span>.dynamic<span class="w"> </span>.got<span class="w"> </span>.data<span class="w"> </span>.bss
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>DYNAMIC<span class="w">      </span>.dynamic
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>NOTE<span class="w">         </span>.note.gnu.build-id<span class="w"> </span>.note.ABI-tag
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>GNU_EH_FRAME<span class="w"> </span>.eh_frame_hdr
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>GNU_STACK
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>GNU_RELRO<span class="w">    </span>.init_array<span class="w"> </span>.fini_array<span class="w"> </span>.dynamic<span class="w"> </span>.got
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>ehdr<span class="w">         </span>.comment
</span></code></pre></div>
<p>From the above output of the section to segment mapping we can see that the ALLOC|LOAD|READONLY CONTENTS(CODE or DATA) sections <code>.rela.dyn</code>, <code>.rela.plt</code> and <code>.plt</code> along with the <code>.text</code> have been classified into the first loadable text segment <em><code>LOAD0</code></em>.</p>
<blockquote>
<p>The <code>.comment</code>, <code>.symtab</code>, <code>.strtab</code>, <code>.shstrtab</code> sections are counted in the LOAD0 segment?</p>
</blockquote>
<p>Otherwise, the ALLOC but not READONLY sections <code>.dynamic</code> and <code>.got</code> along with the <code>.data</code> and <code>.bss</code> secitons have been categorized into the second loadable data segment <em><code>LOAD1</code></em>.</p>
<p>As <code>readelf -lW a.out</code> indicated, both <em>LOAD0</em> and <em>LOAD1</em> should be aligned at 0x10000(64K).</p>
<ol>
<li><em>LOAD0</em> is placed at the beginning of the ELF, the zero address is aligned naturally.</li>
<li><em>LOAD1</em> contains the sections 18~23. To satisfy the alignment, vaddr is adjusted with an increment of 0x10000 against paddr.</li>
</ol>
<h2 id="dynamic_section">dynamic section<a class="headerlink" href="#dynamic_section" title="Permanent link">#</a></h2>
<p>Refer to <a href="https://refspecs.linuxfoundation.org/elf/elf.pdf">TIS - ELF v1.2</a> | Book III: SYSV - 2. Program Loading and Dynamic Linking - Dynamic Linking - Dynamic Section.</p>
<div class="language-c highlight"><span class="filename">Dynamic section entry</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1">// /usr/include/elf.h</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">Elf64_Xword</span><span class="p">;</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">int64_t</span><span class="w">  </span><span class="n">Elf64_Sxword</span><span class="p">;</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">Elf64_Addr</span><span class="p">;</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="p">{</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">  </span><span class="n">Elf64_Sxword</span><span class="w">  </span><span class="n">d_tag</span><span class="p">;</span><span class="w">          </span><span class="cm">/* Dynamic entry type */</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">  </span><span class="k">union</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">      </span><span class="n">Elf64_Xword</span><span class="w"> </span><span class="n">d_val</span><span class="p">;</span><span class="w">        </span><span class="cm">/* Integer value */</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">      </span><span class="n">Elf64_Addr</span><span class="w"> </span><span class="n">d_ptr</span><span class="p">;</span><span class="w">         </span><span class="cm">/* Address value */</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">d_un</span><span class="p">;</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="p">}</span><span class="w"> </span><span class="n">Elf64_Dyn</span><span class="p">;</span>
</span></code></pre></div>
<p>Legal values for <code>d_tag</code> (dynamic entry type):</p>
<div class="language-c highlight"><span class="filename">elf.h - d_tag</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="cp">#define DT_NULL     0       </span><span class="cm">/* Marks end of dynamic section */</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="cp">#define DT_NEEDED   1       </span><span class="cm">/* Name of needed library */</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="cp">#define DT_PLTRELSZ 2       </span><span class="cm">/* Size in bytes of PLT relocs */</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="cp">#define DT_PLTGOT   3       </span><span class="cm">/* Processor defined value */</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="cp">#define DT_HASH     4       </span><span class="cm">/* Address of symbol hash table */</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="cp">#define DT_STRTAB   5       </span><span class="cm">/* Address of string table */</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="cp">#define DT_SYMTAB   6       </span><span class="cm">/* Address of symbol table */</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="cp">#define DT_RELA     7       </span><span class="cm">/* Address of Rela relocs */</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="cp">#define DT_RELASZ   8       </span><span class="cm">/* Total size of Rela relocs */</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="cp">#define DT_RELAENT  9       </span><span class="cm">/* Size of one Rela reloc */</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="cp">#define DT_STRSZ    10      </span><span class="cm">/* Size of string table */</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="cp">#define DT_SYMENT   11      </span><span class="cm">/* Size of one symbol table entry */</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="cp">#define DT_INIT     12      </span><span class="cm">/* Address of init function */</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="cp">#define DT_FINI     13      </span><span class="cm">/* Address of termination function */</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="cp">#define DT_SONAME   14      </span><span class="cm">/* Name of shared object */</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="cp">#define DT_RPATH    15      </span><span class="cm">/* Library search path (deprecated) */</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="cp">#define DT_SYMBOLIC 16      </span><span class="cm">/* Start symbol search here */</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="cp">#define DT_REL      17      </span><span class="cm">/* Address of Rel relocs */</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="cp">#define DT_RELSZ    18      </span><span class="cm">/* Total size of Rel relocs */</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="cp">#define DT_RELENT   19      </span><span class="cm">/* Size of one Rel reloc */</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="cp">#define DT_PLTREL   20      </span><span class="cm">/* Type of reloc in PLT */</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="cp">#define DT_DEBUG    21      </span><span class="cm">/* For debugging; unspecified */</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="cp">#define DT_TEXTREL  22      </span><span class="cm">/* Reloc might modify .text */</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="cp">#define DT_JMPREL   23      </span><span class="cm">/* Address of PLT relocs */</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="cp">#define DT_BIND_NOW 24      </span><span class="cm">/* Process relocations of object */</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="cp">#define DT_INIT_ARRAY   25      </span><span class="cm">/* Array with addresses of init fct */</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="cp">#define DT_FINI_ARRAY   26      </span><span class="cm">/* Array with addresses of fini fct */</span>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="cp">#define DT_INIT_ARRAYSZ 27      </span><span class="cm">/* Size in bytes of DT_INIT_ARRAY */</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="cp">#define DT_FINI_ARRAYSZ 28      </span><span class="cm">/* Size in bytes of DT_FINI_ARRAY */</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="cp">#define DT_RUNPATH  29      </span><span class="cm">/* Library search path */</span>
</span><span id="__span-12-31"><a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="cp">#define DT_FLAGS    30      </span><span class="cm">/* Flags for the object being loaded */</span>
</span><span id="__span-12-32"><a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a>
</span><span id="__span-12-33"><a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="cm">/* The versioning entry types.  The next are defined as part of the</span>
</span><span id="__span-12-34"><a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="cm">   GNU extension.  */</span>
</span><span id="__span-12-35"><a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="cp">#define DT_VERSYM   0x6ffffff0</span>
</span><span id="__span-12-36"><a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a>
</span><span id="__span-12-37"><a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a><span class="cp">#define DT_RELACOUNT    0x6ffffff9</span>
</span><span id="__span-12-38"><a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a><span class="cp">#define DT_RELCOUNT 0x6ffffffa</span>
</span><span id="__span-12-39"><a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a>
</span><span id="__span-12-40"><a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a><span class="cm">/* These were chosen by Sun.  */</span>
</span><span id="__span-12-41"><a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a><span class="cp">#define DT_FLAGS_1  0x6ffffffb  </span><span class="cm">/* State flags, see DF_1_* below.  */</span>
</span><span id="__span-12-42"><a id="__codelineno-12-42" name="__codelineno-12-42" href="#__codelineno-12-42"></a><span class="cp">#define DT_VERDEF   0x6ffffffc  </span><span class="cm">/* Address of version definition</span>
</span><span id="__span-12-43"><a id="__codelineno-12-43" name="__codelineno-12-43" href="#__codelineno-12-43"></a><span class="cm">                       table */</span>
</span></code></pre></div>
<hr />
<p><code>readelf -x --hex-dump=&lt;number|name&gt;</code>: dump the contents of section &lt;number|name&gt; as bytes.<br />
<code>readelf [-R &lt;number or name&gt;|--relocated-dump=&lt;number or name&gt;]</code>: dump the relocated contents of section.</p>
<ul>
<li><code>objdump [-j section|--section=section]</code>: display information for section name.</li>
</ul>
<h3 id="hexdump">hexdump<a class="headerlink" href="#hexdump" title="Permanent link">#</a></h3>
<p>For AArch64, the <a href="../../20211010/machine-word/">word size</a> is 8-byte/64-bit, and the <a href="../../20211008/data-model/">data model</a> is typical LP64.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nv">__SIZEOF_POINTER__</span><span class="o">=</span><span class="m">8</span>,<span class="w"> </span><span class="nv">__WORDSIZE</span><span class="o">=</span><span class="m">64</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nv">__SIZEOF_LONG__</span><span class="o">=</span><span class="m">8</span>,<span class="w"> </span><span class="nv">LONG_BIT</span><span class="o">=</span><span class="m">64</span>
</span></code></pre></div>
<p>As we can see, the two fields of <code>Elf64_Dyn</code> are all 64-bit, so reorganize the hexdump format to display its giant- or double- word array accordingly.</p>
<blockquote>
<p>65536/0x10000 is the increment of vaddr over paddr for the LOAD1 segment where the <code>.dynamic</code> section is located.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># readelf -R .dynamic a.out</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c1"># dy_offset=$(radare2.rabin2 -S a.out | awk &#39;/.dynamic/{print $2}&#39;)</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1"># dy_offset=$(radare2.rabin2 -S a.out | awk &#39;/.dynamic/{print $3}&#39;)</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>$<span class="w"> </span><span class="nv">dy_offset</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.dynamic/{print &quot;0x&quot;$6}&#39;</span><span class="k">)</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>$<span class="w"> </span><span class="nv">dy_size</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.dynamic/{print &quot;0x&quot;$3}&#39;</span><span class="k">)</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c1"># hexdump -s $dy_offset -n $dy_size -e &#39;&quot;%07.7_ax  &quot; 2/8 &quot;%016x &quot; &quot;\n&quot;&#39; a.out</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>$<span class="w"> </span>hexdump<span class="w"> </span>-v<span class="w"> </span>-s<span class="w"> </span><span class="nv">$dy_offset</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">$dy_size</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;&quot;%08_ax\t&quot; 2/8 &quot;%016x\t&quot; &quot;\n&quot;&#39;</span><span class="w"> </span>a.out<span class="w"> </span><span class="se">\</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;BEGIN{print &quot;offset\t\taddress\t\t\t\td_tag\t\t\t\td_un&quot;} \</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="s1">{printf(&quot;%s\t&quot;, $1); printf(&quot;%016x\t&quot;, ((&quot;0x&quot;$1))+65536); printf(&quot;%s\t&quot;, $2); print $3}&#39;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>offset<span class="w">      </span>address<span class="w">             </span>d_tag<span class="w">               </span>d_un
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>00000da0<span class="w">    </span>0000000000010da0<span class="w">    </span><span class="m">0000000000000001</span><span class="w">    </span>000000000000002d
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>00000db0<span class="w">    </span>0000000000010db0<span class="w">    </span>000000000000000c<span class="w">    </span>00000000000005b8
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>00000dc0<span class="w">    </span>0000000000010dc0<span class="w">    </span>000000000000000d<span class="w">    </span>000000000000077c
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>00000dd0<span class="w">    </span>0000000000010dd0<span class="w">    </span><span class="m">0000000000000019</span><span class="w">    </span>0000000000010d90
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>00000de0<span class="w">    </span>0000000000010de0<span class="w">    </span>000000000000001b<span class="w">    </span><span class="m">0000000000000008</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>00000df0<span class="w">    </span>0000000000010df0<span class="w">    </span>000000000000001a<span class="w">    </span>0000000000010d98
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>00000e00<span class="w">    </span>0000000000010e00<span class="w">    </span>000000000000001c<span class="w">    </span><span class="m">0000000000000008</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>00000e10<span class="w">    </span>0000000000010e10<span class="w">    </span>000000006ffffef5<span class="w">    </span><span class="m">0000000000000298</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>00000e20<span class="w">    </span>0000000000010e20<span class="w">    </span><span class="m">0000000000000005</span><span class="w">    </span>00000000000003a8
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>00000e30<span class="w">    </span>0000000000010e30<span class="w">    </span><span class="m">0000000000000006</span><span class="w">    </span>00000000000002b8
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>00000e40<span class="w">    </span>0000000000010e40<span class="w">    </span>000000000000000a<span class="w">    </span><span class="m">0000000000000092</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>00000e50<span class="w">    </span>0000000000010e50<span class="w">    </span>000000000000000b<span class="w">    </span><span class="m">0000000000000018</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>00000e60<span class="w">    </span>0000000000010e60<span class="w">    </span><span class="m">0000000000000015</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>00000e70<span class="w">    </span>0000000000010e70<span class="w">    </span><span class="m">0000000000000003</span><span class="w">    </span>0000000000010f90
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a>00000e80<span class="w">    </span>0000000000010e80<span class="w">    </span><span class="m">0000000000000002</span><span class="w">    </span><span class="m">0000000000000078</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a>00000e90<span class="w">    </span>0000000000010e90<span class="w">    </span><span class="m">0000000000000014</span><span class="w">    </span><span class="m">0000000000000007</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>00000ea0<span class="w">    </span>0000000000010ea0<span class="w">    </span><span class="m">0000000000000017</span><span class="w">    </span><span class="m">0000000000000540</span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>00000eb0<span class="w">    </span>0000000000010eb0<span class="w">    </span><span class="m">0000000000000007</span><span class="w">    </span><span class="m">0000000000000480</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>00000ec0<span class="w">    </span>0000000000010ec0<span class="w">    </span><span class="m">0000000000000008</span><span class="w">    </span>00000000000000c0
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>00000ed0<span class="w">    </span>0000000000010ed0<span class="w">    </span><span class="m">0000000000000009</span><span class="w">    </span><span class="m">0000000000000018</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a>00000ee0<span class="w">    </span>0000000000010ee0<span class="w">    </span>000000000000001e<span class="w">    </span><span class="m">0000000000000008</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a>00000ef0<span class="w">    </span>0000000000010ef0<span class="w">    </span>000000006ffffffb<span class="w">    </span><span class="m">0000000008000001</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a>00000f00<span class="w">    </span>0000000000010f00<span class="w">    </span>000000006ffffffe<span class="w">    </span><span class="m">0000000000000450</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a>00000f10<span class="w">    </span>0000000000010f10<span class="w">    </span>000000006fffffff<span class="w">    </span><span class="m">0000000000000001</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a>00000f20<span class="w">    </span>0000000000010f20<span class="w">    </span>000000006ffffff0<span class="w">    </span>000000000000043a
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a>00000f30<span class="w">    </span>0000000000010f30<span class="w">    </span>000000006ffffff9<span class="w">    </span><span class="m">0000000000000004</span>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a>00000f40<span class="w">    </span>0000000000010f40<span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a>00000f50<span class="w">    </span>0000000000010f50<span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a>00000f60<span class="w">    </span>0000000000010f60<span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a>00000f70<span class="w">    </span>0000000000010f70<span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a>00000f80<span class="w">    </span>0000000000010f80<span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span></code></pre></div>
<h3 id="readelf">readelf<a class="headerlink" href="#readelf" title="Permanent link">#</a></h3>
<p><code>readelf [-d|--dynamic]</code>: display the dynamic section.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>$<span class="w"> </span>readelf<span class="w"> </span>-d<span class="w"> </span>a.out
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>Dynamic<span class="w"> </span>section<span class="w"> </span>at<span class="w"> </span>offset<span class="w"> </span>0xda0<span class="w"> </span>contains<span class="w"> </span><span class="m">27</span><span class="w"> </span>entries:
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w"> </span>Tag<span class="w">                </span>Type<span class="w">                 </span>Name/Value
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w"> </span>0x0000000000000001<span class="w"> </span><span class="o">(</span>NEEDED<span class="o">)</span><span class="w">             </span>Shared<span class="w"> </span>library:<span class="w"> </span><span class="o">[</span>libc.so.6<span class="o">]</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w"> </span>0x000000000000000c<span class="w"> </span><span class="o">(</span>INIT<span class="o">)</span><span class="w">               </span>0x5b8
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w"> </span>0x000000000000000d<span class="w"> </span><span class="o">(</span>FINI<span class="o">)</span><span class="w">               </span>0x77c
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w"> </span>0x0000000000000019<span class="w"> </span><span class="o">(</span>INIT_ARRAY<span class="o">)</span><span class="w">         </span>0x10d90
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w"> </span>0x000000000000001b<span class="w"> </span><span class="o">(</span>INIT_ARRAYSZ<span class="o">)</span><span class="w">       </span><span class="m">8</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w"> </span>0x000000000000001a<span class="w"> </span><span class="o">(</span>FINI_ARRAY<span class="o">)</span><span class="w">         </span>0x10d98
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w"> </span>0x000000000000001c<span class="w"> </span><span class="o">(</span>FINI_ARRAYSZ<span class="o">)</span><span class="w">       </span><span class="m">8</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w"> </span>0x000000006ffffef5<span class="w"> </span><span class="o">(</span>GNU_HASH<span class="o">)</span><span class="w">           </span>0x298
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w"> </span>0x0000000000000005<span class="w"> </span><span class="o">(</span>STRTAB<span class="o">)</span><span class="w">             </span>0x3a8
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w"> </span>0x0000000000000006<span class="w"> </span><span class="o">(</span>SYMTAB<span class="o">)</span><span class="w">             </span>0x2b8
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w"> </span>0x000000000000000a<span class="w"> </span><span class="o">(</span>STRSZ<span class="o">)</span><span class="w">              </span><span class="m">146</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w"> </span>0x000000000000000b<span class="w"> </span><span class="o">(</span>SYMENT<span class="o">)</span><span class="w">             </span><span class="m">24</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w"> </span>0x0000000000000015<span class="w"> </span><span class="o">(</span>DEBUG<span class="o">)</span><span class="w">              </span>0x0
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w"> </span>0x0000000000000003<span class="w"> </span><span class="o">(</span>PLTGOT<span class="o">)</span><span class="w">             </span>0x10f90
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="w"> </span>0x0000000000000002<span class="w"> </span><span class="o">(</span>PLTRELSZ<span class="o">)</span><span class="w">           </span><span class="m">120</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="w"> </span>0x0000000000000014<span class="w"> </span><span class="o">(</span>PLTREL<span class="o">)</span><span class="w">             </span>RELA
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="w"> </span>0x0000000000000017<span class="w"> </span><span class="o">(</span>JMPREL<span class="o">)</span><span class="w">             </span>0x540
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="w"> </span>0x0000000000000007<span class="w"> </span><span class="o">(</span>RELA<span class="o">)</span><span class="w">               </span>0x480
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="w"> </span>0x0000000000000008<span class="w"> </span><span class="o">(</span>RELASZ<span class="o">)</span><span class="w">             </span><span class="m">192</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="w"> </span>0x0000000000000009<span class="w"> </span><span class="o">(</span>RELAENT<span class="o">)</span><span class="w">            </span><span class="m">24</span><span class="w"> </span><span class="o">(</span>bytes<span class="o">)</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="w"> </span>0x000000000000001e<span class="w"> </span><span class="o">(</span>FLAGS<span class="o">)</span><span class="w">              </span>BIND_NOW
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="w"> </span>0x000000006ffffffb<span class="w"> </span><span class="o">(</span>FLAGS_1<span class="o">)</span><span class="w">            </span>Flags:<span class="w"> </span>NOW<span class="w"> </span>PIE
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="w"> </span>0x000000006ffffffe<span class="w"> </span><span class="o">(</span>VERNEED<span class="o">)</span><span class="w">            </span>0x450
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="w"> </span>0x000000006fffffff<span class="w"> </span><span class="o">(</span>VERNEEDNUM<span class="o">)</span><span class="w">         </span><span class="m">1</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="w"> </span>0x000000006ffffff0<span class="w"> </span><span class="o">(</span>VERSYM<span class="o">)</span><span class="w">             </span>0x43a
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="w"> </span>0x000000006ffffff9<span class="w"> </span><span class="o">(</span>RELACOUNT<span class="o">)</span><span class="w">          </span><span class="m">4</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a><span class="w"> </span>0x0000000000000000<span class="w"> </span><span class="o">(</span>NULL<span class="o">)</span><span class="w">               </span>0x0
</span></code></pre></div>
<p>Check readelf's analysis against the raw hexdump above and the sections dumped by <code>radare2.rabin2 -S a.out</code>.</p>
<ol>
<li><code>DT_NEEDED</code>(0x0000000000000001)=0x2d: offset in STRTAB <code>.dynstr</code>, points to <code>libc.so.6</code>.</li>
<li><code>DT_STRTAB</code>(0000000000000005)=0x3a8: address of section <code>.dynstr</code>.</li>
<li><code>DT_SYMTAB</code>(0000000000000006)=0x2b8: address of section <code>.dynsym</code>.</li>
<li><code>DT_STRSZ</code>(000000000000000a)=0x92/146 - size of section <code>.dynstr</code>.</li>
<li><code>DT_SYMENT</code>(000000000000000b)=0x18/24 - size of one symbol table entry (of <code>.dynsym</code>)</li>
<li><code>DT_PLTGOT</code>(0000000000000003)=0x10f90: address of section <code>.got</code></li>
<li><code>DT_PLTRELSZ</code>(0000000000000002)=0x78/120 - size of section <code>.rela.plt</code></li>
<li><code>DT_PLTREL</code>(0000000000000014)=0x7/<code>DT_RELA</code>: Type of reloc in PLT, <code>DT_REL</code> as alternate.</li>
<li><code>DT_JMPREL</code>(0000000000000017)=0x540: address of section <code>.rela.plt</code>.</li>
<li><code>DT_RELA</code>(0000000000000007)=0x480: address of section <code>.rela.dyn</code>.</li>
<li><code>DT_RELASZ</code>(0000000000000008)=0xc0/192 - size of section <code>.rela.dyn</code>.</li>
<li><code>DT_RELAENT</code>(0000000000000009)=0x18/24 - size of one relocation entry of <code>DT_RELA</code>.</li>
<li><code>DT_RELACOUNT</code>(000000006ffffff9)=0x4: count of sections mapped into <code>GNU_RELRO</code> segment?</li>
<li><code>DT_FLAGS</code>(000000000000001e)=0x8/<code>DF_BIND_NOW</code>: No lazy binding for this object.</li>
<li><code>DT_FLAGS_1</code>(000000006ffffffb)=0x1/<code>DF_1_NOW</code>: Set RTLD_NOW for this object.</li>
</ol>
<h2 id="dynamic_symbol">dynamic symbol<a class="headerlink" href="#dynamic_symbol" title="Permanent link">#</a></h2>
<div class="language-c highlight"><span class="filename">Symbol table entry</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1">// /usr/include/elf.h</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">Elf64_Word</span><span class="p">;</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="k">typedef</span><span class="w"> </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">Elf64_Section</span><span class="p">;</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="p">{</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">  </span><span class="n">Elf64_Word</span><span class="w">    </span><span class="n">st_name</span><span class="p">;</span><span class="w">        </span><span class="cm">/* Symbol name (string tbl index) */</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">st_info</span><span class="p">;</span><span class="w">        </span><span class="cm">/* Symbol type and binding */</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">st_other</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Symbol visibility */</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">  </span><span class="n">Elf64_Section</span><span class="w"> </span><span class="n">st_shndx</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Section index */</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="w">  </span><span class="n">Elf64_Addr</span><span class="w">    </span><span class="n">st_value</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Symbol value */</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">  </span><span class="n">Elf64_Xword</span><span class="w">   </span><span class="n">st_size</span><span class="p">;</span><span class="w">        </span><span class="cm">/* Symbol size */</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="p">}</span><span class="w"> </span><span class="n">Elf64_Sym</span><span class="p">;</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="p">{</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="w">  </span><span class="n">Elf64_Half</span><span class="w"> </span><span class="n">si_boundto</span><span class="p">;</span><span class="w">        </span><span class="cm">/* Direct bindings, symbol bound to */</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="w">  </span><span class="n">Elf64_Half</span><span class="w"> </span><span class="n">si_flags</span><span class="p">;</span><span class="w">          </span><span class="cm">/* Per symbol flags */</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="p">}</span><span class="w"> </span><span class="n">Elf64_Syminfo</span><span class="p">;</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a><span class="cm">/* How to extract and insert information held in the st_info field.  */</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="cp">#define ELF32_ST_BIND(val)      (((unsigned char) (val)) &gt;&gt; 4)</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="cp">#define ELF32_ST_TYPE(val)      ((val) &amp; 0xf)</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="cp">#define ELF32_ST_INFO(bind, type)   (((bind) &lt;&lt; 4) + ((type) &amp; 0xf))</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="cm">/* Both Elf32_Sym and Elf64_Sym use the same one-byte st_info field.  */</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="cp">#define ELF64_ST_BIND(val)      ELF32_ST_BIND (val)</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a><span class="cp">#define ELF64_ST_TYPE(val)      ELF32_ST_TYPE (val)</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="cp">#define ELF64_ST_INFO(bind, type)   ELF32_ST_INFO ((bind), (type))</span>
</span></code></pre></div>
<h3 id="dynstr">.dynstr<a class="headerlink" href="#dynstr" title="Permanent link">#</a></h3>
<p>This <code>.dynstr</code> section holds strings needed for dynamic linking, most commonly the strings that represent the names associated with symbol table entries.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>$<span class="w"> </span>readelf<span class="w"> </span>-p<span class="w"> </span>.dynstr<span class="w"> </span>a.out
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>String<span class="w"> </span>dump<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span><span class="s1">&#39;.dynstr&#39;</span>:
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="o">[</span><span class="w">     </span><span class="m">1</span><span class="o">]</span><span class="w">  </span>__cxa_finalize
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="o">[</span><span class="w">    </span><span class="m">10</span><span class="o">]</span><span class="w">  </span>__libc_start_main
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="hll"><span class="o">[</span><span class="w">    </span><span class="m">22</span><span class="o">]</span><span class="w">  </span>puts
</span></span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="o">[</span><span class="w">    </span><span class="m">27</span><span class="o">]</span><span class="w">  </span>abort
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="o">[</span><span class="w">    </span>2d<span class="o">]</span><span class="w">  </span>libc.so.6
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="o">[</span><span class="w">    </span><span class="m">37</span><span class="o">]</span><span class="w">  </span>GLIBC_2.17
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="o">[</span><span class="w">    </span><span class="m">42</span><span class="o">]</span><span class="w">  </span>GLIBC_2.34
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="o">[</span><span class="w">    </span>4d<span class="o">]</span><span class="w">  </span>_ITM_deregisterTMCloneTable
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="o">[</span><span class="w">    </span><span class="m">69</span><span class="o">]</span><span class="w">  </span>__gmon_start__
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="o">[</span><span class="w">    </span><span class="m">78</span><span class="o">]</span><span class="w">  </span>_ITM_registerTMCloneTable
</span></code></pre></div>
<h3 id="hexdump_dynsym">hexdump .dynsym<a class="headerlink" href="#hexdump_dynsym" title="Permanent link">#</a></h3>
<p>As is shown in <code>readelf -d a.out</code>, <code>DT_SYMENT</code>=0x18, that means size of one symbol table entry (of <code>.dynsym</code>) is 24.</p>
<p>Hexdump contents of section <code>.dynsym</code>(DT_SYMTAB) grouped by unit of giant-word, 3 units per line.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>$<span class="w"> </span><span class="nv">ds_offset</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.dynsym/{print &quot;0x&quot;$6}&#39;</span><span class="k">)</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>$<span class="w"> </span><span class="nv">ds_size</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.dynsym/{print &quot;0x&quot;$3}&#39;</span><span class="k">)</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>$<span class="w"> </span>hexdump<span class="w"> </span>-v<span class="w"> </span>-s<span class="w"> </span><span class="nv">$ds_offset</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">$ds_size</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;&quot;%016_ax &quot; /4 &quot;%08x\t&quot; 2/1 &quot;%02x\t\t\t&quot; /2 &quot;%04x\t&quot; 2/8 &quot;%016x\t&quot; &quot;\n&quot;&#39;</span><span class="w"> </span>a.out<span class="w"> </span><span class="se">\</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;BEGIN{print &quot;offset\t\t\t\tname\tinfo\t\tother\tshndx\tvalue\t\t\t\tsize&quot;} 1&#39;</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>offset<span class="w">              </span>name<span class="w">    </span>info<span class="w">        </span>other<span class="w">   </span>shndx<span class="w">   </span>value<span class="w">               </span>size
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>00000000000002b8<span class="w"> </span><span class="m">00000000</span><span class="w">   </span><span class="m">00</span><span class="w">          </span><span class="m">00</span><span class="w">      </span><span class="m">0000</span><span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>00000000000002d0<span class="w"> </span><span class="m">00000000</span><span class="w">   </span><span class="m">03</span><span class="w">          </span><span class="m">00</span><span class="w">      </span>000b<span class="w">    </span>00000000000005b8<span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>00000000000002e8<span class="w"> </span><span class="m">00000000</span><span class="w">   </span><span class="m">03</span><span class="w">          </span><span class="m">00</span><span class="w">      </span><span class="m">0016</span><span class="w">    </span><span class="m">0000000000011000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="m">0000000000000300</span><span class="w"> </span><span class="m">00000010</span><span class="w">   </span><span class="m">12</span><span class="w">          </span><span class="m">00</span><span class="w">      </span><span class="m">0000</span><span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="m">0000000000000318</span><span class="w"> </span>0000004d<span class="w">   </span><span class="m">20</span><span class="w">          </span><span class="m">00</span><span class="w">      </span><span class="m">0000</span><span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="m">0000000000000330</span><span class="w"> </span><span class="m">00000001</span><span class="w">   </span><span class="m">22</span><span class="w">          </span><span class="m">00</span><span class="w">      </span><span class="m">0000</span><span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="m">0000000000000348</span><span class="w"> </span><span class="m">00000069</span><span class="w">   </span><span class="m">20</span><span class="w">          </span><span class="m">00</span><span class="w">      </span><span class="m">0000</span><span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="m">0000000000000360</span><span class="w"> </span><span class="m">00000027</span><span class="w">   </span><span class="m">12</span><span class="w">          </span><span class="m">00</span><span class="w">      </span><span class="m">0000</span><span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="hll"><span class="m">0000000000000378</span><span class="w"> </span><span class="m">00000022</span><span class="w">   </span><span class="m">12</span><span class="w">          </span><span class="m">00</span><span class="w">      </span><span class="m">0000</span><span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span></span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="m">0000000000000390</span><span class="w"> </span><span class="m">00000078</span><span class="w">   </span><span class="m">20</span><span class="w">          </span><span class="m">00</span><span class="w">      </span><span class="m">0000</span><span class="w">    </span><span class="m">0000000000000000</span><span class="w">    </span><span class="m">0000000000000000</span>
</span></code></pre></div>
<p>The macro <code>ELF32_ST_BIND</code>(:hi:4) and <code>ELF32_ST_TYPE</code>(:lo:4) defines how to extract information(ST_BIND, ST_TYPE) held in the <code>st_info</code> field of <code>Elf64_Sym</code>.</p>
<table>
<thead>
<tr>
<th>offset</th>
<th>name index</th>
<th>symbol name</th>
<th>info</th>
<th>type</th>
<th>bind</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x2b8</td>
<td>0x00000000</td>
<td>N/A</td>
<td>0x00</td>
<td>STT_NOTYPE</td>
<td>ST_LOCAL</td>
</tr>
<tr>
<td>0x2d0</td>
<td>0x00000000</td>
<td>N/A</td>
<td>0x03</td>
<td>STT_SECTION</td>
<td>ST_LOCAL</td>
</tr>
<tr>
<td>0x2e8</td>
<td>0x00000000</td>
<td>N/A</td>
<td>0x03</td>
<td>STT_SECTION</td>
<td>ST_LOCAL</td>
</tr>
<tr>
<td>0x300</td>
<td>0x00000010</td>
<td>__libc_start_main</td>
<td>0x12</td>
<td>STT_FUNC</td>
<td>STB_GLOBAL</td>
</tr>
<tr>
<td>0x318</td>
<td>0x0000004d</td>
<td>_ITM_deregisterTMCloneTable</td>
<td>0x20</td>
<td>STT_NOTYPE</td>
<td>STB_WEAK</td>
</tr>
<tr>
<td>0x330</td>
<td>0x00000001</td>
<td>__cxa_finalize</td>
<td>0x22</td>
<td>STT_FUNC</td>
<td>STB_WEAK</td>
</tr>
<tr>
<td>0x348</td>
<td>0x00000069</td>
<td>__gmon_start__</td>
<td>0x20</td>
<td>STT_NOTYPE</td>
<td>STB_WEAK</td>
</tr>
<tr>
<td>0x360</td>
<td>0x00000027</td>
<td>abort</td>
<td>0x12</td>
<td>STT_FUNC</td>
<td>STB_GLOBAL</td>
</tr>
<tr>
<td>0x378</td>
<td>0x00000022</td>
<td><strong>puts</strong></td>
<td>0x12</td>
<td>STT_FUNC</td>
<td>STB_GLOBAL</td>
</tr>
<tr>
<td>0x390</td>
<td>0x00000078</td>
<td>_ITM_registerTMCloneTable</td>
<td>0x20</td>
<td>STT_NOTYPE</td>
<td>STB_WEAK</td>
</tr>
</tbody>
</table>
<h3 id="readelfobjdump">readelf/objdump<a class="headerlink" href="#readelfobjdump" title="Permanent link">#</a></h3>
<p><code>nm -u|--undefined-only</code>: display only undefined symbols.<br />
<code>nm -D|--dynamic</code>: display dynamic symbols instead of normal symbols.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># nm -u a.out</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>$<span class="w"> </span>nm<span class="w"> </span>-D<span class="w"> </span>a.out
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">                 </span>U<span class="w"> </span>abort@GLIBC_2.17
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">                 </span>w<span class="w"> </span>__cxa_finalize@GLIBC_2.17
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">                 </span>w<span class="w"> </span>__gmon_start__
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">                 </span>w<span class="w"> </span>_ITM_deregisterTMCloneTable
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">                 </span>w<span class="w"> </span>_ITM_registerTMCloneTable
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="hll"><span class="w">                 </span>U<span class="w"> </span>__libc_start_main@GLIBC_2.34
</span></span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">                 </span>U<span class="w"> </span>puts@GLIBC_2.17
</span></code></pre></div>
<p><code>readelf --dyn-syms</code>: display the dynamic symbol table.<br />
<code>objdump [-T|--dynamic-syms]</code>: display the contents of the dynamic symbol table.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">readelf --dyn-syms</label><label for="__tabbed_1_2">objdump -T</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>$<span class="w"> </span>readelf<span class="w"> </span>--dyn-syms<span class="w"> </span>a.out
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>Symbol<span class="w"> </span>table<span class="w"> </span><span class="s1">&#39;.dynsym&#39;</span><span class="w"> </span>contains<span class="w"> </span><span class="m">10</span><span class="w"> </span>entries:
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">  </span>Num:<span class="w">    </span>Value<span class="w">          </span>Size<span class="w"> </span>Type<span class="w">    </span>Bind<span class="w">   </span>Vis<span class="w">      </span>Ndx<span class="w"> </span>Name
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">    </span><span class="m">0</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>NOTYPE<span class="w">  </span>LOCAL<span class="w">  </span>DEFAULT<span class="w">  </span>UND
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">    </span><span class="m">1</span>:<span class="w"> </span>00000000000005b8<span class="w">     </span><span class="m">0</span><span class="w"> </span>SECTION<span class="w"> </span>LOCAL<span class="w">  </span>DEFAULT<span class="w">   </span><span class="m">11</span><span class="w"> </span>.init
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">    </span><span class="m">2</span>:<span class="w"> </span><span class="m">0000000000011000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>SECTION<span class="w"> </span>LOCAL<span class="w">  </span>DEFAULT<span class="w">   </span><span class="m">22</span><span class="w"> </span>.data
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">    </span><span class="m">3</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>FUNC<span class="w">    </span>GLOBAL<span class="w"> </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>_<span class="o">[</span>...<span class="o">]</span>@GLIBC_2.34<span class="w"> </span><span class="o">(</span><span class="m">2</span><span class="o">)</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">    </span><span class="m">4</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>NOTYPE<span class="w">  </span>WEAK<span class="w">   </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>_ITM_deregisterT<span class="o">[</span>...<span class="o">]</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">    </span><span class="m">5</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>FUNC<span class="w">    </span>WEAK<span class="w">   </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>_<span class="o">[</span>...<span class="o">]</span>@GLIBC_2.17<span class="w"> </span><span class="o">(</span><span class="m">3</span><span class="o">)</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">    </span><span class="m">6</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>NOTYPE<span class="w">  </span>WEAK<span class="w">   </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>__gmon_start__
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">    </span><span class="m">7</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>FUNC<span class="w">    </span>GLOBAL<span class="w"> </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>abort@GLIBC_2.17<span class="w"> </span><span class="o">(</span><span class="m">3</span><span class="o">)</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="hll"><span class="w">    </span><span class="m">8</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>FUNC<span class="w">    </span>GLOBAL<span class="w"> </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>puts@GLIBC_2.17<span class="w"> </span><span class="o">(</span><span class="m">3</span><span class="o">)</span>
</span></span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">    </span><span class="m">9</span>:<span class="w"> </span><span class="m">0000000000000000</span><span class="w">     </span><span class="m">0</span><span class="w"> </span>NOTYPE<span class="w">  </span>WEAK<span class="w">   </span>DEFAULT<span class="w">  </span>UND<span class="w"> </span>_ITM_registerTMC<span class="o">[</span>...<span class="o">]</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>$<span class="w"> </span>objdump<span class="w"> </span>-T<span class="w"> </span>a.out
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>a.out:<span class="w">     </span>file<span class="w"> </span>format<span class="w"> </span>elf64-littleaarch64
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>DYNAMIC<span class="w"> </span>SYMBOL<span class="w"> </span>TABLE:
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>00000000000005b8<span class="w"> </span>l<span class="w">    </span>d<span class="w">  </span>.init<span class="w">  </span><span class="m">0000000000000000</span><span class="w">              </span>.init
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="m">0000000000011000</span><span class="w"> </span>l<span class="w">    </span>d<span class="w">  </span>.data<span class="w">  </span><span class="m">0000000000000000</span><span class="w">              </span>.data
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="m">0000000000000000</span><span class="w">      </span>DF<span class="w"> </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w"> </span><span class="o">(</span>GLIBC_2.34<span class="o">)</span><span class="w"> </span>__libc_start_main
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="m">0000000000000000</span><span class="w">  </span>w<span class="w">   </span>D<span class="w">  </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>Base<span class="w">        </span>_ITM_deregisterTMCloneTable
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="m">0000000000000000</span><span class="w">  </span>w<span class="w">   </span>DF<span class="w"> </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w"> </span><span class="o">(</span>GLIBC_2.17<span class="o">)</span><span class="w"> </span>__cxa_finalize
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="m">0000000000000000</span><span class="w">  </span>w<span class="w">   </span>D<span class="w">  </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>Base<span class="w">        </span>__gmon_start__
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="m">0000000000000000</span><span class="w">      </span>DF<span class="w"> </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w"> </span><span class="o">(</span>GLIBC_2.17<span class="o">)</span><span class="w"> </span>abort
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="hll"><span class="m">0000000000000000</span><span class="w">      </span>DF<span class="w"> </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w"> </span><span class="o">(</span>GLIBC_2.17<span class="o">)</span><span class="w"> </span>puts
</span></span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="m">0000000000000000</span><span class="w">  </span>w<span class="w">   </span>D<span class="w">  </span>*UND*<span class="w">  </span><span class="m">0000000000000000</span><span class="w">  </span>Base<span class="w">        </span>_ITM_registerTMCloneTable
</span></code></pre></div>
</div>
</div>
</div>
<h2 id="relocation_entries">relocation entries<a class="headerlink" href="#relocation_entries" title="Permanent link">#</a></h2>
<div class="language-c highlight"><span class="filename">Relocation table entry</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1">// /usr/include/elf.h</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="cm">/* Relocation table entry with addend (in section of type SHT_RELA).  */</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="p">{</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">  </span><span class="n">Elf64_Addr</span><span class="w">    </span><span class="n">r_offset</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Address */</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">  </span><span class="n">Elf64_Xword</span><span class="w">   </span><span class="n">r_info</span><span class="p">;</span><span class="w">         </span><span class="cm">/* Relocation type and symbol index */</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">  </span><span class="n">Elf64_Sxword</span><span class="w">  </span><span class="n">r_addend</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Addend */</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="p">}</span><span class="w"> </span><span class="n">Elf64_Rela</span><span class="p">;</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="cm">/* How to extract and insert information held in the r_info field.  */</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="cp">#define ELF64_R_SYM(i)          ((i) &gt;&gt; 32)</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="cp">#define ELF64_R_TYPE(i)         ((i) &amp; 0xffffffff)</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="cp">#define ELF64_R_INFO(sym,type)      ((((Elf64_Xword) (sym)) &lt;&lt; 32) + (type))</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="cm">/* LP64 AArch64 relocs.  */</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a><span class="cp">#define R_AARCH64_GLOB_DAT     1025 </span><span class="cm">/* 0x401: Create GOT entry.  */</span>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="cp">#define R_AARCH64_JUMP_SLOT    1026 </span><span class="cm">/* 0x402: Create PLT entry.  */</span>
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="cp">#define R_AARCH64_RELATIVE     1027 </span><span class="cm">/* 0x403: Adjust by program base.  */</span>
</span></code></pre></div>
<p>We know the following points from the previous analysis of the dynamic section.</p>
<ol>
<li><code>DT_PLTREL</code>=0x7=<code>DT_RELA</code>: Type of reloc in PLT.</li>
<li><code>DT_RELA</code>=0x480: address of section <code>.rela.dyn</code>.</li>
<li><code>DT_JMPREL</code>=0x540: address of section <code>.rela.plt</code>.</li>
</ol>
<p>Use <code>readelf</code> or <code>objdump</code> to dump related sections.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>readelf<span class="w"> </span>-R<span class="w"> </span>.got<span class="w"> </span>-R<span class="w"> </span>.rela.dyn<span class="w"> </span>-R<span class="w"> </span>.rela.plt<span class="w"> </span>-R<span class="w"> </span>.plt<span class="w"> </span>a.out
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>objdump<span class="w"> </span>-j<span class="w"> </span>.got<span class="w"> </span>-j<span class="w"> </span>.rela.dyn<span class="w"> </span>-j<span class="w"> </span>.rela.plt<span class="w"> </span>-j<span class="w"> </span>.plt<span class="w"> </span>-s<span class="w"> </span>a.out
</span></code></pre></div>
<h3 id="hexdump_sections">hexdump sections<a class="headerlink" href="#hexdump_sections" title="Permanent link">#</a></h3>
<p>As is shown in <code>readelf -d a.out</code>, <code>DT_RELAENT</code>=0x18, that means size of one RELA reloc is 24.</p>
<p>Hexdump contents of section <code>.rela.dyn</code>(DT_RELA) grouped by unit of giant-word, 3 units per line.</p>
<blockquote>
<p>Pay attention to the offset, it points to a <code>.got</code> entry.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>$<span class="w"> </span><span class="nv">rd_offset</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.rela.dyn/{print &quot;0x&quot;$6}&#39;</span><span class="k">)</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>$<span class="w"> </span><span class="nv">rd_size</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.rela.dyn/{print &quot;0x&quot;$3}&#39;</span><span class="k">)</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>$<span class="w"> </span>hexdump<span class="w"> </span>-v<span class="w"> </span>-s<span class="w"> </span><span class="nv">$rd_offset</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">$rd_size</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;&quot;%016_ax  &quot; 3/8 &quot;%016x &quot; &quot;\n&quot;&#39;</span><span class="w"> </span>a.out<span class="w"> </span><span class="se">\</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;BEGIN{print &quot;address\t\t\t\toffset\t\t\tinfo\t\t\taddend&quot;} 1&#39;</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>address<span class="w">             </span>offset<span class="w">          </span>info<span class="w">            </span>addend
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="m">0000000000000480</span><span class="w">  </span>0000000000010d90<span class="w"> </span><span class="m">0000000000000403</span><span class="w"> </span><span class="m">0000000000000750</span><span class="w"> </span><span class="c1"># .init_array</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="m">0000000000000498</span><span class="w">  </span>0000000000010d98<span class="w"> </span><span class="m">0000000000000403</span><span class="w"> </span><span class="m">0000000000000700</span><span class="w"> </span><span class="c1"># .fini_array</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>00000000000004b0<span class="w">  </span>0000000000010ff0<span class="w"> </span><span class="m">0000000000000403</span><span class="w"> </span><span class="m">0000000000000754</span><span class="w"> </span><span class="c1"># GOT</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>00000000000004c8<span class="w">  </span><span class="m">0000000000011008</span><span class="w"> </span><span class="m">0000000000000403</span><span class="w"> </span><span class="m">0000000000011008</span><span class="w"> </span><span class="c1"># .data[1]</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>00000000000004e0<span class="w">  </span>0000000000010fd8<span class="w"> </span><span class="m">0000000400000401</span><span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span><span class="c1"># GOT</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>00000000000004f8<span class="w">  </span>0000000000010fe0<span class="w"> </span><span class="m">0000000500000401</span><span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span><span class="c1"># GOT</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="m">0000000000000510</span><span class="w">  </span>0000000000010fe8<span class="w"> </span><span class="m">0000000600000401</span><span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span><span class="c1"># GOT</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="m">0000000000000528</span><span class="w">  </span>0000000000010ff8<span class="w"> </span><span class="m">0000000900000401</span><span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span><span class="c1"># GOT</span>
</span></code></pre></div>
<p>00004c8 - 0000000000011008: the second giant word of <code>.dynsym</code> - <code>.data</code>(Offset=0x001000, Address=0x0011000 Size=0x000010), can be denoted as .data[1] under AArch64.</p>
<p>Adapt the hexdump format to make it more readable in the unit of the giant-word.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># readelf -x .data a.out</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="c1"># objdump -j .data -s a.out</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>$<span class="w"> </span><span class="nv">d_offset</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/\.data/ &amp;&amp; !/\.nodata/ {print &quot;0x&quot;$6}&#39;</span><span class="k">)</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>$<span class="w"> </span><span class="nv">d_size</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/\.data/ &amp;&amp; !/\.nodata/ {print &quot;0x&quot;$3}&#39;</span><span class="k">)</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>$<span class="w"> </span>hexdump<span class="w"> </span>-v<span class="w"> </span>-s<span class="w"> </span><span class="nv">$d_offset</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">$d_size</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;&quot;%07.7_ax  &quot; 2/8 &quot;%016x &quot; &quot;\n&quot;&#39;</span><span class="w"> </span>a.out
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="m">0001000</span><span class="w">  </span><span class="m">0000000000000000</span><span class="w"> </span><span class="m">0000000000011008</span>
</span></code></pre></div>
<hr />
<p>Hexdump contents of section <code>.rela.plt</code>(DT_JMPREL) grouped by unit of giant-word, 3 units per line.</p>
<blockquote>
<p>Pay attention to the offset, it points to a <code>.got</code> entry.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>$<span class="w"> </span><span class="nv">rp_offset</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.rela.plt/{print &quot;0x&quot;$6}&#39;</span><span class="k">)</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>$<span class="w"> </span><span class="nv">rp_size</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.rela.plt/{print &quot;0x&quot;$3}&#39;</span><span class="k">)</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>$<span class="w"> </span>hexdump<span class="w"> </span>-v<span class="w"> </span>-s<span class="w"> </span><span class="nv">$rp_offset</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">$rp_size</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;&quot;%016_ax  &quot; 3/8 &quot;%016x &quot; &quot;\n&quot;&#39;</span><span class="w"> </span>a.out<span class="w"> </span><span class="se">\</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;BEGIN{print &quot;address\t\t\t\toffset\t\t\tinfo\t\t\taddend&quot;} 1&#39;</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>address<span class="w">             </span>offset<span class="w">          </span>info<span class="w">            </span>addend
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="m">0000000000000540</span><span class="w">  </span>0000000000010fa8<span class="w"> </span><span class="m">0000000300000402</span><span class="w"> </span><span class="m">0000000000000000</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="m">0000000000000558</span><span class="w">  </span>0000000000010fb0<span class="w"> </span><span class="m">0000000500000402</span><span class="w"> </span><span class="m">0000000000000000</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="m">0000000000000570</span><span class="w">  </span>0000000000010fb8<span class="w"> </span><span class="m">0000000600000402</span><span class="w"> </span><span class="m">0000000000000000</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="m">0000000000000588</span><span class="w">  </span>0000000000010fc0<span class="w"> </span><span class="m">0000000700000402</span><span class="w"> </span><span class="m">0000000000000000</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>00000000000005a0<span class="w">  </span>0000000000010fc8<span class="w"> </span><span class="m">0000000800000402</span><span class="w"> </span><span class="m">0000000000000000</span>
</span></code></pre></div>
<p>The macros <code>ELF64_R_SYM</code> and <code>ELF64_R_TYPE</code> demonstrate how to extract information from the <code>r_info</code> field of <code>Elf64_Rela</code>.</p>
<p>Take the last entry as an example:</p>
<ol>
<li><code>ELF64_R_TYPE(0x0000000800000402)</code> = 0x00000402, aka <code>R_AARCH64_JUMP_SLOT</code>.</li>
<li><code>ELF64_R_SYM(0x0000000800000402)</code> = 0x00000008, symbol index.</li>
</ol>
<p>Cast a glance at section <em>dynamic symbol</em>, index 8 corresponds to <code>puts@GLIBC_2.17</code> in symbol table <code>.dynsym</code>.</p>
<p>Next, let's use professional ELF binutils like readelf/objdump/rabin2 to see what they come up with.</p>
<h3 id="readelfobjdump_1">readelf/objdump<a class="headerlink" href="#readelfobjdump_1" title="Permanent link">#</a></h3>
<p><code>readelf [-r|--relocs]</code>: display the relocations.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>$<span class="w"> </span>readelf<span class="w"> </span>-r<span class="w"> </span>a.out
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>Relocation<span class="w"> </span>section<span class="w"> </span><span class="s1">&#39;.rela.dyn&#39;</span><span class="w"> </span>at<span class="w"> </span>offset<span class="w"> </span>0x480<span class="w"> </span>contains<span class="w"> </span><span class="m">8</span><span class="w"> </span>entries:
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">  </span>Offset<span class="w">          </span>Info<span class="w">           </span>Type<span class="w">           </span>Sym.<span class="w"> </span>Value<span class="w">    </span>Sym.<span class="w"> </span>Name<span class="w"> </span>+<span class="w"> </span>Addend
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>000000010d90<span class="w">  </span><span class="m">000000000403</span><span class="w"> </span>R_AARCH64_RELATIV<span class="w">                    </span><span class="m">750</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>000000010d98<span class="w">  </span><span class="m">000000000403</span><span class="w"> </span>R_AARCH64_RELATIV<span class="w">                    </span><span class="m">700</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>000000010ff0<span class="w">  </span><span class="m">000000000403</span><span class="w"> </span>R_AARCH64_RELATIV<span class="w">                    </span><span class="m">754</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="m">000000011008</span><span class="w">  </span><span class="m">000000000403</span><span class="w"> </span>R_AARCH64_RELATIV<span class="w">                    </span><span class="m">11008</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>000000010fd8<span class="w">  </span><span class="m">000400000401</span><span class="w"> </span>R_AARCH64_GLOB_DA<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>_ITM_deregisterTM<span class="o">[</span>...<span class="o">]</span><span class="w"> </span>+<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>000000010fe0<span class="w">  </span><span class="m">000500000401</span><span class="w"> </span>R_AARCH64_GLOB_DA<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>__cxa_finalize@GLIBC_2.17<span class="w"> </span>+<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>000000010fe8<span class="w">  </span><span class="m">000600000401</span><span class="w"> </span>R_AARCH64_GLOB_DA<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>__gmon_start__<span class="w"> </span>+<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>000000010ff8<span class="w">  </span><span class="m">000900000401</span><span class="w"> </span>R_AARCH64_GLOB_DA<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>_ITM_registerTMCl<span class="o">[</span>...<span class="o">]</span><span class="w"> </span>+<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>Relocation<span class="w"> </span>section<span class="w"> </span><span class="s1">&#39;.rela.plt&#39;</span><span class="w"> </span>at<span class="w"> </span>offset<span class="w"> </span>0x540<span class="w"> </span>contains<span class="w"> </span><span class="m">5</span><span class="w"> </span>entries:
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="w">  </span>Offset<span class="w">          </span>Info<span class="w">           </span>Type<span class="w">           </span>Sym.<span class="w"> </span>Value<span class="w">    </span>Sym.<span class="w"> </span>Name<span class="w"> </span>+<span class="w"> </span>Addend
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a>000000010fa8<span class="w">  </span><span class="m">000300000402</span><span class="w"> </span>R_AARCH64_JUMP_SL<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>__libc_start_main@GLIBC_2.34<span class="w"> </span>+<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>000000010fb0<span class="w">  </span><span class="m">000500000402</span><span class="w"> </span>R_AARCH64_JUMP_SL<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>__cxa_finalize@GLIBC_2.17<span class="w"> </span>+<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a>000000010fb8<span class="w">  </span><span class="m">000600000402</span><span class="w"> </span>R_AARCH64_JUMP_SL<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>__gmon_start__<span class="w"> </span>+<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a>000000010fc0<span class="w">  </span><span class="m">000700000402</span><span class="w"> </span>R_AARCH64_JUMP_SL<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>abort@GLIBC_2.17<span class="w"> </span>+<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="hll">000000010fc8<span class="w">  </span><span class="m">000800000402</span><span class="w"> </span>R_AARCH64_JUMP_SL<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>puts@GLIBC_2.17<span class="w"> </span>+<span class="w"> </span><span class="m">0</span>
</span></span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Dual Symbols</p>
<p>No. 5 <code>__cxa_finalize</code> and No. 6 <code>__gmon_start__</code> appear in both <code>.rela.dyn</code> and <code>.rela.plt</code> sections.</p>
</div>
<p><code>objdump [-r|--reloc]</code>: display the relocation entries in the file.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>$<span class="w"> </span>objdump<span class="w"> </span>-r<span class="w"> </span>a.out
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>a.out:<span class="w">     </span>file<span class="w"> </span>format<span class="w"> </span>elf64-littleaarch64
</span></code></pre></div>
<p><code>objdump [-R|--dynamic-reloc]</code>: display the dynamic relocation entries in the file.</p>
<blockquote>
<p>Almost the same as <code>readelf -r a.out</code>, but the full TYPE name is visible.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>$<span class="w"> </span>objdump<span class="w"> </span>-R<span class="w"> </span>a.out
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>a.out:<span class="w">     </span>file<span class="w"> </span>format<span class="w"> </span>elf64-littleaarch64
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>DYNAMIC<span class="w"> </span>RELOCATION<span class="w"> </span>RECORDS
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>OFFSET<span class="w">           </span>TYPE<span class="w">              </span>VALUE
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>0000000000010d90<span class="w"> </span>R_AARCH64_RELATIVE<span class="w">  </span>*ABS*+0x0000000000000750
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>0000000000010d98<span class="w"> </span>R_AARCH64_RELATIVE<span class="w">  </span>*ABS*+0x0000000000000700
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>0000000000010ff0<span class="w"> </span>R_AARCH64_RELATIVE<span class="w">  </span>*ABS*+0x0000000000000754
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="m">0000000000011008</span><span class="w"> </span>R_AARCH64_RELATIVE<span class="w">  </span>*ABS*+0x0000000000011008
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>0000000000010fd8<span class="w"> </span>R_AARCH64_GLOB_DAT<span class="w">  </span>_ITM_deregisterTMCloneTable@Base
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>0000000000010fe0<span class="w"> </span>R_AARCH64_GLOB_DAT<span class="w">  </span>__cxa_finalize@GLIBC_2.17
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>0000000000010fe8<span class="w"> </span>R_AARCH64_GLOB_DAT<span class="w">  </span>__gmon_start__@Base
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>0000000000010ff8<span class="w"> </span>R_AARCH64_GLOB_DAT<span class="w">  </span>_ITM_registerTMCloneTable@Base
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>0000000000010fa8<span class="w"> </span>R_AARCH64_JUMP_SLOT<span class="w">  </span>__libc_start_main@GLIBC_2.34
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a>0000000000010fb0<span class="w"> </span>R_AARCH64_JUMP_SLOT<span class="w">  </span>__cxa_finalize@GLIBC_2.17
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>0000000000010fb8<span class="w"> </span>R_AARCH64_JUMP_SLOT<span class="w">  </span>__gmon_start__@Base
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a>0000000000010fc0<span class="w"> </span>R_AARCH64_JUMP_SLOT<span class="w">  </span>abort@GLIBC_2.17
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a><span class="hll">0000000000010fc8<span class="w"> </span>R_AARCH64_JUMP_SLOT<span class="w">  </span>puts@GLIBC_2.17
</span></span></code></pre></div>
<h2 id="global_offset_table">global offset table<a class="headerlink" href="#global_offset_table" title="Permanent link">#</a></h2>
<p>According to sysvabi64 - <a href="https://github.com/ARM-software/abi-aa/blob/844a79fd4c77252a11342709e3b27b2c9f590cf1/sysvabi64/sysvabi64.rst">System V ABI for the Arm® 64-bit Architecture (AArch64)</a> - 9.2 Global Offset Table (GOT)</p>
<p>Position-independent code cannot, in general, contain absolute (fixed) virtual addresses. Global offset tables hold absolute addresses in private data, thus making the addresses available without compromising the position-independence and shareability of a program's text segment. A program references its global offset table using position-independent addressing and extracts the absolute values from it, thereby <strong>redirecting</strong> position-independent references to their actual locations.</p>
<p>The global offset table (<em><code>GOT</code></em>) is created by the static linker in response to GOT generating relocations. See <a href="https://github.com/ARM-software/abi-aa/blob/main/aaelf64/aaelf64.rst">AAELF64</a> Relocation operations for more information.</p>
<p>AArch64 splits the global offset table (GOT) into two sections:</p>
<ul>
<li><code>.got.plt</code> for code addresses accessed only from the Procedure Linkage Table (PLT).</li>
<li><code>.got</code> all other addresses and offsets.</li>
</ul>
<h3 id="hexdump_got">hexdump .got<a class="headerlink" href="#hexdump_got" title="Permanent link">#</a></h3>
<p>Hexdump contents of PROGBITS section <code>.got</code> grouped by giant-word array.</p>
<blockquote>
<p>65536/0x10000 is the increment of vaddr over paddr for the LOAD1 segment where the <code>.got</code> section is located.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>$<span class="w"> </span><span class="nv">got_offset</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.got/{print &quot;0x&quot;$6}&#39;</span><span class="k">)</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>$<span class="w"> </span><span class="nv">got_size</span><span class="o">=</span><span class="k">$(</span>objdump<span class="w"> </span>-hw<span class="w"> </span>a.out<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;/.got/{print &quot;0x&quot;$3}&#39;</span><span class="k">)</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>$<span class="w"> </span>hexdump<span class="w"> </span>-v<span class="w"> </span>-s<span class="w"> </span><span class="nv">$got_offset</span><span class="w"> </span>-n<span class="w"> </span><span class="nv">$got_size</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;&quot;%_ad\t&quot; /8 &quot;%016x\t&quot; &quot;\n&quot;&#39;</span><span class="w"> </span>a.out<span class="w"> </span><span class="se">\</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;BEGIN{print &quot;Offset\t\tAddress\t\t\t\tValue&quot;} \</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="s1">{printf(&quot;%08x\t&quot;, $1); printf(&quot;%016x\t&quot;, $1+65536); print $2}&#39;</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>Offset<span class="w">      </span>Address<span class="w">             </span>Value
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>00000f90<span class="w">    </span>0000000000010f90<span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>00000f98<span class="w">    </span>0000000000010f98<span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>00000fa0<span class="w">    </span>0000000000010fa0<span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>00000fa8<span class="w">    </span>0000000000010fa8<span class="w">    </span>00000000000005d0
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>00000fb0<span class="w">    </span>0000000000010fb0<span class="w">    </span>00000000000005d0
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>00000fb8<span class="w">    </span>0000000000010fb8<span class="w">    </span>00000000000005d0
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>00000fc0<span class="w">    </span>0000000000010fc0<span class="w">    </span>00000000000005d0
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="hll">00000fc8<span class="w">    </span>0000000000010fc8<span class="w">    </span>00000000000005d0
</span></span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>00000fd0<span class="w">    </span>0000000000010fd0<span class="w">    </span>0000000000010da0
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>00000fd8<span class="w">    </span>0000000000010fd8<span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>00000fe0<span class="w">    </span>0000000000010fe0<span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a>00000fe8<span class="w">    </span>0000000000010fe8<span class="w">    </span><span class="m">0000000000000000</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a>00000ff0<span class="w">    </span>0000000000010ff0<span class="w">    </span><span class="m">0000000000000754</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a>00000ff8<span class="w">    </span>0000000000010ff8<span class="w">    </span><span class="m">0000000000000000</span>
</span></code></pre></div>
<p>As we have discussed, the last entry in the <code>.rela.plt</code> (DT_JMPREL) section describes the <code>R_AARCH64_JUMP_SLOT</code> / GOT entry with address <code>0000000000010fc8</code>(offset 0xfc8 within LOAD1) and symbol index 8, corresponding to <code>puts@GLIBC_2.17</code> in symbol table <code>.dynsym</code>.</p>
<p>The <code>puts@GLIBC_2.17</code> is currently labelled as <code>UND</code>EFINED, the corresponding GOT entry is filled with <code>00000000000005d0</code>, which represents the <code>.plt</code> section in the LOAD0 segment.</p>
<p>When the required(DT_NEEDED) <em>libc.so</em> is loaded, the value would be resolved to be the actual address of symbol <code>puts@GLIBC_2.17</code> during process initialization.</p>
<h3 id="_global_offset_table_">_GLOBAL_OFFSET_TABLE_<a class="headerlink" href="#_global_offset_table_" title="Permanent link">#</a></h3>
<p>For AArch64 the linker defined <code>_GLOBAL_OFFSET_TABLE_</code> symbol should be the address of the first global offset table entry in the <code>.got</code> section.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>$<span class="w"> </span>readelf<span class="w"> </span>-s<span class="w"> </span>a.out
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="w">    </span>Symbol<span class="w"> </span>table<span class="w"> </span><span class="s1">&#39;.symtab&#39;</span><span class="w"> </span>contains<span class="w"> </span><span class="m">88</span><span class="w"> </span>entries:
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="w">    </span>Num:<span class="w">    </span>Value<span class="w">          </span>Size<span class="w"> </span>Type<span class="w">    </span>Bind<span class="w">   </span>Vis<span class="w">      </span>Ndx<span class="w"> </span>Name
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="w">    </span><span class="m">63</span>:<span class="w"> </span>0000000000010fd0<span class="w">     </span><span class="m">0</span><span class="w">  </span>OBJECT<span class="w">  </span>LOCAL<span class="w">  </span>DEFAULT<span class="w">  </span>ABS<span class="w"> </span>_GLOBAL_OFFSET_TABLE_
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>$<span class="w"> </span>objdump<span class="w"> </span>-t<span class="w"> </span>a.out
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="w">    </span>0000000000010fd0<span class="w"> </span>l<span class="w">     </span>O<span class="w"> </span>*ABS*<span class="w">  </span><span class="m">0000000000000000</span><span class="w">              </span>_GLOBAL_OFFSET_TABLE_
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>$<span class="w"> </span>nm<span class="w"> </span>a.out
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="w">    </span>0000000000010fd0<span class="w"> </span>a<span class="w"> </span>_GLOBAL_OFFSET_TABLE_
</span></code></pre></div>
<p>The value of <code>_GLOBAL_OFFSET_TABLE_</code>(0x0000000000010fd0) is 0x0000000000010da0, it's the address of the <code>.dynamic</code> section.</p>
<h2 id="putsplt">puts@plt<a class="headerlink" href="#putsplt" title="Permanent link">#</a></h2>
<p>The <em><code>GOT</code></em>(Global Offset Table) is something like a socket, it connects the internal host and the external required.</p>
<p>Similar to how the global offset table redirects position-independent address calculations to absolute locations, the procedure linkage table(<em><code>PLT</code></em>) redirects position-independent function calls to absolute locations. The link editor cannot resolve execution transfers, such as function calls, from one executable or shared object to another. Consequently, the link editor arranges to have the program transfer control to entries in the procedure linkage table.</p>
<p>The dynamic section <code>DT_PLTREL</code>(0000000000000014)=0x7 shows its type of reloc in PLT is <code>DT_RELA</code>.</p>
<p>Relocation section <code>.rela.plt</code> defines five <code>R_AARCH64_JUMP_SLOT</code>s pointing to GOT entries with offest. The indexes of the dynamic symbols are 3,5,6,7,8.</p>
<p><code>rabin2 -i</code> puts things on the stage, e.g. No.8 0x00000630 points to the PLT stub routine &lt;puts@plt&gt;.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>$<span class="w"> </span>radare2.rabin2<span class="w"> </span>-i<span class="w"> </span>a.out
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="o">[</span>Imports<span class="o">]</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>nth<span class="w"> </span>vaddr<span class="w">      </span><span class="nb">bind</span><span class="w">   </span><span class="nb">type</span><span class="w">   </span>lib<span class="w"> </span>name
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>―――――――――――――――――――――――――――――――――――――
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="m">3</span><span class="w">   </span>0x000005f0<span class="w"> </span>GLOBAL<span class="w"> </span>FUNC<span class="w">       </span>__libc_start_main
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="m">4</span><span class="w">   </span>----------<span class="w"> </span>WEAK<span class="w">   </span>NOTYPE<span class="w">     </span>_ITM_deregisterTMCloneTable
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="m">5</span><span class="w">   </span>0x00000600<span class="w"> </span>WEAK<span class="w">   </span>FUNC<span class="w">       </span>__cxa_finalize
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="m">6</span><span class="w">   </span>0x00000610<span class="w"> </span>WEAK<span class="w">   </span>NOTYPE<span class="w">     </span>__gmon_start__
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="m">7</span><span class="w">   </span>0x00000620<span class="w"> </span>GLOBAL<span class="w"> </span>FUNC<span class="w">       </span>abort
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="hll"><span class="m">8</span><span class="w">   </span>0x00000630<span class="w"> </span>GLOBAL<span class="w"> </span>FUNC<span class="w">       </span>puts
</span></span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="m">9</span><span class="w">   </span>----------<span class="w"> </span>WEAK<span class="w">   </span>NOTYPE<span class="w">     </span>_ITM_registerTMCloneTable
</span></code></pre></div>
<p>&lt;puts@plt&gt; uses <em>ADRP</em>/<em>LDR</em> to load the reloc address stored in <code>R_AARCH64_JUMP_SLOT</code> / GOT entry for <code>puts@GLIBC_2.17</code>, then calls <em>BR</em> to jump to the target.</p>
<p><code>rabin2 -R</code> lists the RELA relocations whose <code>vaddr</code> points to the GOT entry that stores the adjusted address. The highlighted line's vaddr=0x00010fc8 is the GOT slot address for <code>reloc.puts</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>$<span class="w"> </span>radare2.rabin2<span class="w"> </span>-R<span class="w"> </span>a.out
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="o">[</span>Relocations<span class="o">]</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>vaddr<span class="w">      </span>paddr<span class="w">      </span><span class="nb">type</span><span class="w">   </span>ntype<span class="w"> </span>name
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>―――――――――――――――――――――――――――――――――――――――
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>0x00010d90<span class="w"> </span>0x00000d90<span class="w"> </span>ADD_64<span class="w"> </span><span class="m">1027</span><span class="w">   </span>0x00000750
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>0x00010d98<span class="w"> </span>0x00000d98<span class="w"> </span>ADD_64<span class="w"> </span><span class="m">1027</span><span class="w">   </span>0x00000700
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>0x00010fa8<span class="w"> </span>0x00000fa8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>__libc_start_main
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>0x00010fb0<span class="w"> </span>0x00000fb0<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>__cxa_finalize
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>0x00010fb8<span class="w"> </span>0x00000fb8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>__gmon_start__
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>0x00010fc0<span class="w"> </span>0x00000fc0<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>abort
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a><span class="hll">0x00010fc8<span class="w"> </span>0x00000fc8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>puts
</span></span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>0x00010fd8<span class="w"> </span>0x00000fd8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1025</span><span class="w">  </span>_ITM_deregisterTMCloneTable
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>0x00010fe0<span class="w"> </span>0x00000fe0<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1025</span><span class="w">  </span>__cxa_finalize
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>0x00010fe8<span class="w"> </span>0x00000fe8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1025</span><span class="w">  </span>__gmon_start__
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>0x00010ff0<span class="w"> </span>0x00000ff0<span class="w"> </span>ADD_64<span class="w"> </span><span class="m">1027</span><span class="w">   </span>0x00000754
</span><span id="__span-33-18"><a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>0x00010ff8<span class="w"> </span>0x00000ff8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1025</span><span class="w">  </span>_ITM_registerTMCloneTable
</span><span id="__span-33-19"><a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a>0x00011008<span class="w"> </span>0x00001008<span class="w"> </span>ADD_64<span class="w"> </span><span class="m">1027</span><span class="w">   </span>0x00011008
</span></code></pre></div>
<p>The <code>PLT</code> is acting as a go-between, and it's time to lift the veil.</p>
<h3 id="disassemble">disassemble<a class="headerlink" href="#disassemble" title="Permanent link">#</a></h3>
<p>Statically disassemble the <code>.plt</code> section using <code>objdump -d</code> command.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-34-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-34-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-34-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-34-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-34-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-34-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-34-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-34-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-34-10">10</a></span>
<span class="normal"><a href="#__codelineno-34-11">11</a></span>
<span class="normal"><a href="#__codelineno-34-12">12</a></span>
<span class="normal"><a href="#__codelineno-34-13">13</a></span>
<span class="normal"><a href="#__codelineno-34-14">14</a></span>
<span class="normal"><a href="#__codelineno-34-15">15</a></span>
<span class="normal"><a href="#__codelineno-34-16">16</a></span>
<span class="normal"><a href="#__codelineno-34-17">17</a></span>
<span class="normal"><a href="#__codelineno-34-18">18</a></span>
<span class="normal"><a href="#__codelineno-34-19">19</a></span>
<span class="normal"><a href="#__codelineno-34-20">20</a></span>
<span class="normal"><a href="#__codelineno-34-21">21</a></span>
<span class="normal"><a href="#__codelineno-34-22">22</a></span>
<span class="normal"><a href="#__codelineno-34-23">23</a></span>
<span class="normal"><a href="#__codelineno-34-24">24</a></span>
<span class="normal"><a href="#__codelineno-34-25">25</a></span>
<span class="normal"><a href="#__codelineno-34-26">26</a></span>
<span class="normal"><a href="#__codelineno-34-27">27</a></span>
<span class="normal"><a href="#__codelineno-34-28">28</a></span>
<span class="normal"><a href="#__codelineno-34-29">29</a></span>
<span class="normal"><a href="#__codelineno-34-30">30</a></span>
<span class="normal"><a href="#__codelineno-34-31">31</a></span>
<span class="normal"><a href="#__codelineno-34-32">32</a></span>
<span class="normal"><a href="#__codelineno-34-33">33</a></span>
<span class="normal"><a href="#__codelineno-34-34">34</a></span>
<span class="normal"><a href="#__codelineno-34-35">35</a></span>
<span class="normal"><a href="#__codelineno-34-36">36</a></span>
<span class="normal"><a href="#__codelineno-34-37">37</a></span>
<span class="normal"><a href="#__codelineno-34-38">38</a></span>
<span class="normal"><a href="#__codelineno-34-39">39</a></span>
<span class="normal"><a href="#__codelineno-34-40">40</a></span>
<span class="normal"><a href="#__codelineno-34-41">41</a></span>
<span class="normal"><a href="#__codelineno-34-42">42</a></span>
<span class="normal"><a href="#__codelineno-34-43">43</a></span>
<span class="normal"><a href="#__codelineno-34-44">44</a></span>
<span class="normal"><a href="#__codelineno-34-45">45</a></span>
<span class="normal"><a href="#__codelineno-34-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="c1"># objdump -Rd a.out : disassemble all</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2"></a>$<span class="w"> </span>objdump<span class="w"> </span>-j<span class="w"> </span>.plt<span class="w"> </span>-d<span class="w"> </span>a.out
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3"></a>Disassembly<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span>.plt:
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4"></a>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5"></a>00000000000005d0<span class="w"> </span>&lt;.plt&gt;:
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6"></a><span class="w"> </span>5d0:<span class="w">   </span>a9bf7bf0<span class="w">    </span>stp<span class="w"> </span>x16,<span class="w"> </span>x30,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span><span class="c1">#-16]!</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="w"> </span>5d4:<span class="w">   </span><span class="m">90000090</span><span class="w">    </span>adrp<span class="w">    </span>x16,<span class="w"> </span><span class="m">10000</span><span class="w"> </span>&lt;__FRAME_END__+0xf770&gt;
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8"></a><span class="w"> </span>5d8:<span class="w">   </span>f947d211<span class="w">    </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span><span class="c1">#4000]</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9"></a><span class="w"> </span>5dc:<span class="w">   </span>913e8210<span class="w">    </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span><span class="c1">#0xfa0</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10"></a><span class="w"> </span>5e0:<span class="w">   </span>d61f0220<span class="w">    </span>br<span class="w">  </span>x17
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11"></a><span class="w"> </span>5e4:<span class="w">   </span>d503201f<span class="w">    </span>nop
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12"></a><span class="w"> </span>5e8:<span class="w">   </span>d503201f<span class="w">    </span>nop
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13"></a><span class="w"> </span>5ec:<span class="w">   </span>d503201f<span class="w">    </span>nop
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14"></a>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15"></a>00000000000005f0<span class="w"> </span>&lt;__libc_start_main@plt&gt;:
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16"></a><span class="w"> </span>5f0:<span class="w">   </span><span class="m">90000090</span><span class="w">    </span>adrp<span class="w">    </span>x16,<span class="w"> </span><span class="m">10000</span><span class="w"> </span>&lt;__FRAME_END__+0xf770&gt;
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17"></a><span class="w"> </span>5f4:<span class="w">   </span>f947d611<span class="w">    </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span><span class="c1">#4008]</span>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18"></a><span class="w"> </span>5f8:<span class="w">   </span>913ea210<span class="w">    </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span><span class="c1">#0xfa8</span>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19"></a><span class="w"> </span>5fc:<span class="w">   </span>d61f0220<span class="w">    </span>br<span class="w">  </span>x17
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20"></a>
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21"></a><span class="m">0000000000000600</span><span class="w"> </span>&lt;__cxa_finalize@plt&gt;:
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22"></a><span class="w"> </span><span class="m">600</span>:<span class="w">   </span><span class="m">90000090</span><span class="w">    </span>adrp<span class="w">    </span>x16,<span class="w"> </span><span class="m">10000</span><span class="w"> </span>&lt;__FRAME_END__+0xf770&gt;
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23"></a><span class="w"> </span><span class="m">604</span>:<span class="w">   </span>f947da11<span class="w">    </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span><span class="c1">#4016]</span>
</span><span id="__span-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24"></a><span class="w"> </span><span class="m">608</span>:<span class="w">   </span>913ec210<span class="w">    </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span><span class="c1">#0xfb0</span>
</span><span id="__span-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25"></a><span class="w"> </span>60c:<span class="w">   </span>d61f0220<span class="w">    </span>br<span class="w">  </span>x17
</span><span id="__span-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26"></a>
</span><span id="__span-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27"></a><span class="m">0000000000000610</span><span class="w"> </span>&lt;__gmon_start__@plt&gt;:
</span><span id="__span-34-28"><a id="__codelineno-34-28" name="__codelineno-34-28"></a><span class="w"> </span><span class="m">610</span>:<span class="w">   </span><span class="m">90000090</span><span class="w">    </span>adrp<span class="w">    </span>x16,<span class="w"> </span><span class="m">10000</span><span class="w"> </span>&lt;__FRAME_END__+0xf770&gt;
</span><span id="__span-34-29"><a id="__codelineno-34-29" name="__codelineno-34-29"></a><span class="w"> </span><span class="m">614</span>:<span class="w">   </span>f947de11<span class="w">    </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span><span class="c1">#4024]</span>
</span><span id="__span-34-30"><a id="__codelineno-34-30" name="__codelineno-34-30"></a><span class="w"> </span><span class="m">618</span>:<span class="w">   </span>913ee210<span class="w">    </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span><span class="c1">#0xfb8</span>
</span><span id="__span-34-31"><a id="__codelineno-34-31" name="__codelineno-34-31"></a><span class="w"> </span>61c:<span class="w">   </span>d61f0220<span class="w">    </span>br<span class="w">  </span>x17
</span><span id="__span-34-32"><a id="__codelineno-34-32" name="__codelineno-34-32"></a>
</span><span id="__span-34-33"><a id="__codelineno-34-33" name="__codelineno-34-33"></a><span class="m">0000000000000620</span><span class="w"> </span>&lt;abort@plt&gt;:
</span><span id="__span-34-34"><a id="__codelineno-34-34" name="__codelineno-34-34"></a><span class="w"> </span><span class="m">620</span>:<span class="w">   </span><span class="m">90000090</span><span class="w">    </span>adrp<span class="w">    </span>x16,<span class="w"> </span><span class="m">10000</span><span class="w"> </span>&lt;__FRAME_END__+0xf770&gt;
</span><span id="__span-34-35"><a id="__codelineno-34-35" name="__codelineno-34-35"></a><span class="w"> </span><span class="m">624</span>:<span class="w">   </span>f947e211<span class="w">    </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span><span class="c1">#4032]</span>
</span><span id="__span-34-36"><a id="__codelineno-34-36" name="__codelineno-34-36"></a><span class="w"> </span><span class="m">628</span>:<span class="w">   </span>913f0210<span class="w">    </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span><span class="c1">#0xfc0</span>
</span><span id="__span-34-37"><a id="__codelineno-34-37" name="__codelineno-34-37"></a><span class="w"> </span>62c:<span class="w">   </span>d61f0220<span class="w">    </span>br<span class="w">  </span>x17
</span><span id="__span-34-38"><a id="__codelineno-34-38" name="__codelineno-34-38"></a>
</span><span id="__span-34-39"><a id="__codelineno-34-39" name="__codelineno-34-39"></a><span class="hll"><span class="m">0000000000000630</span><span class="w"> </span>&lt;puts@plt&gt;:
</span></span><span id="__span-34-40"><a id="__codelineno-34-40" name="__codelineno-34-40"></a><span class="hll"><span class="w"> </span><span class="m">630</span>:<span class="w">   </span><span class="m">90000090</span><span class="w">    </span>adrp<span class="w">    </span>x16,<span class="w"> </span><span class="m">10000</span><span class="w"> </span>&lt;__FRAME_END__+0xf770&gt;
</span></span><span id="__span-34-41"><a id="__codelineno-34-41" name="__codelineno-34-41"></a><span class="hll"><span class="w"> </span><span class="m">634</span>:<span class="w">   </span>f947e611<span class="w">    </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span><span class="c1">#4040]</span>
</span></span><span id="__span-34-42"><a id="__codelineno-34-42" name="__codelineno-34-42"></a><span class="hll"><span class="w"> </span><span class="m">638</span>:<span class="w">   </span>913f2210<span class="w">    </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span><span class="c1">#0xfc8</span>
</span></span><span id="__span-34-43"><a id="__codelineno-34-43" name="__codelineno-34-43"></a><span class="hll"><span class="w"> </span>63c:<span class="w">   </span>d61f0220<span class="w">    </span>br<span class="w">  </span>x17
</span></span><span id="__span-34-44"><a id="__codelineno-34-44" name="__codelineno-34-44"></a>
</span><span id="__span-34-45"><a id="__codelineno-34-45" name="__codelineno-34-45"></a>$<span class="w"> </span>radare2.rax2<span class="w"> </span><span class="m">4040</span>
</span><span id="__span-34-46"><a id="__codelineno-34-46" name="__codelineno-34-46"></a>0xfc8
</span></code></pre></div></td></tr></table></div>
<p>If you only want to disassemble the <code>puts@plt</code> symbol, not the whole section, you could specify the symbol or an address range for objdump.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1"># puts_plt=$(radare2.rabin2 -i a.out | awk &#39;/puts/ {print $2}&#39;)</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="c1"># objdump -d --start-address=$puts_plt --stop-address=$((puts_plt+16)) a.out</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>$<span class="w"> </span>objdump<span class="w"> </span>--disassemble<span class="o">=</span>puts@plt<span class="w"> </span>a.out
</span></code></pre></div>
<h3 id="resolution">resolution<a class="headerlink" href="#resolution" title="Permanent link">#</a></h3>
<p>As we can see, 0x10000+0xfc8 is the offset of <code>.rela.plt</code> relocation entry. The output of <code>rabin2 -R a.out</code> maybe more clear: the vaddr=0x00010fc8 is relative to virtual baddr, while the paddr=0x00000fc8 is relative to memory segment.</p>
<p>Line 40 <code>adrp x16, 10000</code> is used to form PC-relative address to 4KB page. <code>IMM = 0x10000</code> is the PC-relative literal that encoded in the <a href="../../20230609/arm-adr-demo/">ADRP instruction</a>.</p>
<p>Lines 41~42 are the equivalent expansion of the pre-indexing addressing instruction <code>ldr x17, [x16, #0xfc8]!</code>. Reg <code>x17</code> will load the value stored in GOT entry 0x10fc8 (PC relative). It is currently 0x5d0 and will be adjusted during dynamic linking. This is usually called "lazy symbol binding/loading".</p>
<p>In the following articles, we'll explore how PLT/RELA/GOT work together to resolve lazy symbol binding/loading in dynamic linking.</p>







  
  



  


  



  <h2 id="__comments">评论</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
    data-repo="fan2/mkdocs"
    data-repo-id="R_kgDOLltxSg"
    data-category="Announcements"
    data-category-id="DIC_kwDOLltxSs4CeURH"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../../20230627/elf-obj-tour/" class="md-footer__link md-footer__link--prev" aria-label="上一页: REL ELF Walkthrough">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                REL ELF Walkthrough
              </div>
            </div>
          </a>
        
        
          
          <a href="../../20230629/plt-puts-pwndbg/" class="md-footer__link md-footer__link--next" aria-label="下一页: reloc puts@plt via GOT - pwndbg">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                reloc puts@plt via GOT - pwndbg
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024- Cliff Fan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["toc.follow", "header.autohide", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.tracking", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://vercount.one/js"></script>
      
    
  </body>
</html>