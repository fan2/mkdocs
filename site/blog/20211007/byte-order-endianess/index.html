
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="在别处或在路上">
      
      
        <meta name="author" content="Cliff Fan">
      
      
        <link rel="canonical" href="https://duetorun.com/blog/20211007/byte-order-endianess/">
      
      
        <link rel="prev" href="../../20211006/c-memory-model/">
      
      
        <link rel="next" href="../../20211008/data-model/">
      
      
      <link rel="icon" href="../../../assets/hold_yourself.jpg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Byte Order(Endianess) - ElseWhere</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-XGW41EGL31"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-XGW41EGL31",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-XGW41EGL31",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#storage_order" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="ElseWhere" class="md-header__button md-logo" aria-label="ElseWhere" data-md-component="logo">
      
  <img src="../../../assets/hold_yourself.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ElseWhere
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Byte Order(Endianess)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8v2m9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../link/" class="md-tabs__link">
        
  
    
  
  Link

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ElseWhere" class="md-nav__button md-logo" aria-label="ElseWhere" data-md-component="logo">
      
  <img src="../../../assets/hold_yourself.jpg" alt="logo">

    </a>
    ElseWhere
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2017
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2015/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2015
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2009/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2009
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/arm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/c/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    c
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cpp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cpp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/elf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/excerpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    excerpt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/macos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/material/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    material
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/mkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/resource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    resource
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/toolchain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolchain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/vim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/webdav/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webDAV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/wiki/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wiki
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/zsh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zsh
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Link
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#storage_order" class="md-nav__link">
    <span class="md-ellipsis">
      storage order
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pros_of_little_endian" class="md-nav__link">
    <span class="md-ellipsis">
      Pros of Little Endian
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network_byte_order" class="md-nav__link">
    <span class="md-ellipsis">
      network byte order
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#__byte_order__" class="md-nav__link">
    <span class="md-ellipsis">
      __BYTE_ORDER__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__BYTE_ORDER__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mbpa2991-macos" class="md-nav__link">
    <span class="md-ellipsis">
      mbpa2991-macOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpi4b-ubuntu" class="md-nav__link">
    <span class="md-ellipsis">
      rpi4b-ubuntu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test_endianess" class="md-nav__link">
    <span class="md-ellipsis">
      test endianess
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refs" class="md-nav__link">
    <span class="md-ellipsis">
      refs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://duetorun.com/assets/carve_yourself.jpg" alt="Cliff Fan">
                    </span>
                    <span class="md-profile__description">
                      <strong>
                        
                          Cliff Fan
                        
                      </strong>
                      <br>
                      Just do IT
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                        <time datetime="2021-10-07 10:00:00" class="md-ellipsis">2021年10月7日</time>
                      </div>
                    </li>
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 13h1.5v2.82l2.44 1.41-.75 1.3L15 16.69V13m4-5H5v11h4.67c-.43-.91-.67-1.93-.67-3a7 7 0 0 1 7-7c1.07 0 2.09.24 3 .67V8M5 21a2 2 0 0 1-2-2V5c0-1.11.89-2 2-2h1V1h2v2h8V1h2v2h1a2 2 0 0 1 2 2v6.1c1.24 1.26 2 2.99 2 4.9a7 7 0 0 1-7 7c-1.91 0-3.64-.76-4.9-2H5m11-9.85A4.85 4.85 0 0 0 11.15 16c0 2.68 2.17 4.85 4.85 4.85A4.85 4.85 0 0 0 20.85 16c0-2.68-2.17-4.85-4.85-4.85Z"/></svg>
                          <time datetime="2024-04-30 14:00:00" class="md-ellipsis">2024年4月30日</time>
                        </div>
                      </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                          <span class="md-ellipsis">
                            分类于
                            
                              <a href="../../category/cs/">CS</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg>
                          <span class="md-ellipsis">
                            
                              需要 14 分钟阅读时间
                            
                          </span>
                        </div>
                      </li>
                    
                    <!-- Add by Cliff.Fan, 29Mar24. -->
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 1-5 5v11l5-4.5V1m2 4v13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6c-1.45-1.1-3.55-1.5-5.5-1.5-1.95 0-4.05.4-5.5 1.5v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1M10 18.41C8.75 18.09 7.5 18 6.5 18c-1.06 0-2.32.19-3.5.5V7.13c.91-.4 2.14-.63 3.5-.63 1.36 0 2.59.23 3.5.63v11.28Z"/></svg>
                        <span class="md-ellipsis" id="busuanzi_container_page_pv">
                          阅读量：<span id="busuanzi_value_page_pv">N/A</span>
                        </span>
                      </div>
                    </li>
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  
  

<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">byte_order</span>
    
  
    
    
    
      <span class="md-tag">endianess</span>
    
  
</nav>



  <h1>Byte Order(Endianess)</h1>

<p>在 <a href="../../20211005/binary-bitset-bytes/">Binary —— Bitset &amp; Bytes</a> 中，我们通过打印 bitset 和 byte array，直观感受了二进制的位模式（bit pattern &amp; binary representation）。然后，遗留下了三个问题：</p>
<ol>
<li>hex(2010) 输出十六进制是 0x7da，hexdump(2010) 输出内存中的字节数组是 {0xda, 0x7}，字节顺序为什么不同？</li>
<li>每2个byte组合而成的短整型 short array [0] 为什么是 <code>0x3130</code>，而非 <code>0x3031</code>？</li>
<li>程序 test-conversion-narrow-down.c 输出结果是怎样的？</li>
</ol>
<p>这三个问题的答案都涉及到字节序（Byte Order）问题。</p>
<!-- more -->

<h2 id="storage_order">storage order<a class="headerlink" href="#storage_order" title="Permanent link">#</a></h2>
<p>先来回顾一下 <a href="../../20211004/c-binary-representation/">C Basic Types - Binary Representions</a> 中提到的 <code>LSB</code>/<code>MSB</code> 概念: </p>
<div class="admonition note">
<p class="admonition-title">LSB vs. MSB</p>
<p>The binary representation for non-negative integer values is always exactly what the term indicates: such a number is represented by binary digits <span class="arithmatex">\(b_0, b_1, \ldots, b_{p-1}\)</span> called <strong><em>bits</em></strong>. Each of the bits has a value of 0 or 1. The value of such a number is computed as <span class="arithmatex">\(\sum_{i=0}^{p-1}b_i\ast2^i\)</span>.</p>
<p>The value <em>p</em> in that binary representation is called the <strong><em>precision</em></strong> of the underlying type. Bit <span class="arithmatex">\(b_0\)</span> is called the <strong><em>least-signiﬁcant bit</em></strong>, and LSB, <span class="arithmatex">\(b_{p−1}\)</span> is the <strong><em>most-signiﬁcant bit</em></strong>(MSB).</p>
<p>Of the bits <span class="arithmatex">\(b_i\)</span> that are 1, the one with minimal index <em>i</em> is called the <strong><em>least-signiﬁcant bit set</em></strong>, and the one with the highest index is the <strong><em>most-signiﬁcant bit set</em></strong>.</p>
</div>
<p>在 <a href="../../20211006/c-memory-model/">The C Memory Model</a> 中借 union 一值两析，由 storage order 进一步引出了 <code>endianess</code> 的概念：</p>
<div class="admonition note">
<p class="admonition-title">endianess: big-endian &amp; little-endian</p>
<p>That is, a platform provider might decide to provide a <em>storage order</em> that has the highest-order digits ﬁrst, and then print lower-order digits one by one. The storage order, the <strong><em>endianness</em></strong>, as given for my machine, is called <strong><em>little-endian</em></strong>. A system that has high-order representation digits ﬁrst is called <strong><em>big-endian</em></strong>. Both orders are commonly used by modern processor types. Some processors are even able to switch between the two orders on the ﬂy.</p>
</div>
<p><a href="https://developer.arm.com/documentation/den0024/a/ARMv8-Registers/Endianness">ARM Cortex-A Series Programmer's Guide for ARMv8-A</a> - Endianness:</p>
<p>There are two basic ways of viewing bytes in memory, either as <em>Little-Endian</em> (LE) or <em>Big-Endian</em> (BE). On big-endian machines, the most significant byte of an object in memory is stored at the lowest address, that is the address closest to zero. On little-endian machines, the least significant byte is stored at the lowest address. The term byte-ordering can also be used rather than endianness.</p>
<figure><br />
<img alt="ARM-CortexA-endianess" src="../../cs/images/ARM-CortexA-endianess.svg" /><br />
</figure>
<p>The designers of the ARM processor didn’t want to take sides in the little- vs. big-endian debate, so they made the ARM processor support both.</p>
<p>This data endianness is controlled independently for each Execution level. For <code>EL3</code>, <code>EL2</code> and <code>EL1</code>, the relevant register of <code>SCTLR_ELn.EE</code> sets the endianness. The additional bit at <code>EL1</code>, <code>SCTLR_EL1.E0E</code> controls the data endian setting for <code>EL0</code>. In the AArch64 execution state, data accesses can be <code>LE</code> or <code>BE</code>, while instruction fetches are always <code>LE</code>.</p>
<p><a href="https://github.com/ARM-software/abi-aa/blob/2a70c42d62e9c3eb5887fa50b71257f20daca6f9/aapcs64/aapcs64.rst">aapcs64</a> - 5.8 Byte order ("Endianness"):</p>
<p>From a software perspective, memory is an array of bytes, each of which is addressable. This ABI supports two views of memory implemented by the underlying hardware.</p>
<ul>
<li>In a <code>little-endian</code> view of memory the least significant byte of a data object is at the <em>lowest</em> byte address the data object occupies in memory.</li>
<li>In a <code>big-endian</code> view of memory the least significant byte of a data object is at the <em>highest</em> byte address the data object occupies in memory.</li>
</ul>
<p>The least significant bit in an object is always designated as bit 0.</p>
<p>The mapping of a word-sized data object to memory is shown in the following figures. All objects are pure-endian, so the mappings may be scaled accordingly for larger or smaller objects.</p>
<figure><br />
<img alt="aapcs64-bigendian" src="../../cs/images/aapcs64-bigendian.svg" /><br />
    <figcaption>Memory layout of big-endian data object</figcaption><br />
</figure>
<figure><br />
<img alt="aapcs64-littleendian" src="../../cs/images/aapcs64-littleendian.svg" /><br />
    <figcaption>Memory layout of little-endian data object</figcaption><br />
</figure>
<p>经由上述铺陈，字节序（Byte Order, Endianess）的概念已然明晰，概括来讲就是事关 storage order —— LSB/MSB who store first？</p>
<p>对于小尾端（little endian）系统，在内存起始地址处存放整数的低序号字节（LSB first）；反之，对于大尾端（big endian）系统，在内存起始地址处存放整数的高序号字节（MSB first）。</p>
<p>在 big endian 系统下，更符合人的直观视觉。例如 int 值 0x33323130，在内存中的存储顺序同人眼睛从左到右（高位到低位）的扫描顺序一致，MSB store first，memory byte array 为 {0x33, 0x32, 0x31, 0x30}；在 little endian 系统下，LSB store first，先存储低位字节，int 值 0x33323130 在 memory 中的 byte array 为 {0x30, 0x31, 0x32, 0x33}。</p>
<p>在移动嵌入式领域，统治市场的 MIPS 和 ARM 处理器可通过配置寄存器采用不同的字节序，默认采用 Little-Endian。但 ARM 始终采用 Big-Endian 存储浮点数。早期使用 <a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/LowLevelABI/100-32-bit_PowerPC_Function_Calling_Conventions/32bitPowerPC.html">PowerPC</a> 处理器的 Mac 采用大字节序，后来的 Mac 同 Windows PC 一样都采用 <a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/LowLevelABI/130-IA-32_Function_Calling_Conventions/IA32.html">Intel x86</a> 芯片，因此也都是小字节序存储的。</p>
<blockquote>
<p><a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/LowLevelABI/110-64-bit_PowerPC_Function_Calling_Conventions/64bitPowerPC.html">64-bit PowerPC Function Calling Conventions</a>: This environment uses the big-endian byte ordering scheme to store numeric and pointer data types. That is, the most significant bytes go first, followed by the least significant bytes.</p>
</blockquote>
<p>《<a href="https://item.jd.com/12006637.html">深入理解计算机系统</a>》（<a href="https://www.amazon.com/Computer-Systems-OHallaron-Randal-Bryant/dp/1292101768/">Computer Systems - A Programmer’s Perspective</a>）中 2.1: Information Storage | 2.1.3: Addressing and Byte Ordering 也有关于 endianess 的详细论述。</p>
<p><a href="https://stackoverflow.com/questions/7865511/qword-storing-implementing-using-32-bit-regs">assembly - QWORD Storing / implementing using 32-bit REGs.? - Stack Overflow</a></p>
<p><a href="https://learn.microsoft.com/en-us/cpp/build/arm64-windows-abi-conventions">Overview of ARM64 ABI conventions</a> - <a href="https://learn.microsoft.com/en-us/cpp/build/arm64-windows-abi-conventions#endianness">Endianness</a></p>
<p><a href="https://gcc.gnu.org/onlinedocs/gcc/IA-64-Options.html">GCC | IA-64 Options</a></p>
<blockquote>
<p><code>-mbig-endian</code>: Generate code for a big-endian target. This is the <em>default</em> for HP-UX.<br />
<code>-mlittle-endian</code>: Generate code for a little-endian target. This is the <em>default</em> for AIX5 and GNU/Linux.</p>
</blockquote>
<p><a href="https://gcc.gnu.org/onlinedocs/gcc/AArch64-Options.html">GCC | AArch64 Options</a></p>
<blockquote>
<p><code>-mbig-endian</code>: Generate big-endian code. This is the <em>default</em> when GCC is configured for an ‘<code>aarch64_be-*-*</code>’ target.<br />
<code>-mlittle-endian</code>: Generate little-endian code. This is the <em>default</em> when GCC is configured for an ‘<code>aarch64-*-*</code>’ but not an ‘<code>aarch64_be-*-*</code>’ target.</p>
</blockquote>
<h2 id="pros_of_little_endian">Pros of Little Endian<a class="headerlink" href="#pros_of_little_endian" title="Permanent link">#</a></h2>
<p><a href="https://www.amazon.com/Programming-64-Bit-ARM-Assembly-Language/dp/1484258800/">Programming with 64-Bit ARM Assembly Language: Single Board Computer Development for Raspberry Pi and Mobile Devices</a> | Chapter 2: Loading and Adding - Big vs. Little Endian</p>
<p>The advantage of little-endian format is that it makes it easy to change the size of integers, without requiring any address arithmetic. If you want to convert a 4-byte integer to a 1-byte integer, you take the first byte. Assuming the integer is in the range of 0–255, and the other three bytes are zero. For example, if memory contains the 4 bytes or word for 1, in little endian, the memory contains <code>01 00 00 00</code>.</p>
<p>If we want the 1-byte representation of this number, we take the first byte; for the 16-bit representation, we take the first two bytes. The key point is that the memory address we use is the <em>same</em> in all cases, saving us an instruction cycle adjusting it.</p>
<p>When we are in the debugger, we will see more representations, and these will be pointed out again as we run into them.</p>
<div class="admonition note">
<p class="admonition-title">byte order transformation</p>
<p>Note even though Linux uses little endian, many protocols like TCP/IP used on the internet use big endian and so require a transformation when moving data from the computer to the outside world.</p>
</div>
<h2 id="network_byte_order">network byte order<a class="headerlink" href="#network_byte_order" title="Permanent link">#</a></h2>
<p>从维基百科中关于 <a href="https://en.wikipedia.org/wiki/Endianness">Endianness</a> 的介绍，其最早源起于 <a href="https://blog.csdn.net/phunxm/article/details/5085869">网络编程</a>，核心就是“byte significance compared to earliness”的收发次序问题。</p>
<div class="admonition abstract">
<p class="admonition-title">Endianness</p>
<p>In computing, <strong><em>endianness</em></strong> is the order in which bytes within a word of digital data are transmitted over a data communication medium or addressed (by rising addresses) in computer memory, counting only byte significance compared to earliness.</p>
<p>Endianness is primarily expressed as <strong>big-endian</strong> (BE) or <strong>little-endian</strong> (LE), terms introduced by Danny Cohen into computer science for data ordering in an Internet Experiment Note published in 1980.</p>
</div>
<p>TCP/IP 协议统一规定采用<strong>大端</strong>方式封装解析传输数据，也称为<strong>网络字节顺序</strong>（network byte order，TCP/IP-endian）。</p>
<div class="admonition note">
<p class="admonition-title">RFC 1700 - Assigned Numbers - Data Notations</p>
<p><a href="https://datatracker.ietf.org/doc/rfc1700/">https://datatracker.ietf.org/doc/rfc1700/</a></p>
<p>The convention in the documentation of Internet Protocols is to express numbers in decimal and to picture data in "big-endian" order [COHEN].  That is, fields are described left to right, with the most significant octet on the left and the least significant octet on the right.</p>
<p>The order of transmission of the header and data described in this document is resolved to the octet level.  Whenever a diagram shows a group of octets, the order of transmission of those octets is the normal order in which they are read in English.  For example, in the following diagram the octets are transmitted in the order they are numbered.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>    0                   1                   2                   3
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>|       1       |       2       |       3       |       4       |
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>|       5       |       6       |       7       |       8       |
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>|       9       |      10       |      11       |      12       |
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>                    Transmission Order of Bytes
</span></code></pre></div>
<p>Whenever an octet represents a numeric quantity the left most bit in the diagram is the high order or most significant bit.  That is, the bit labeled 0 is the most significant bit.  For example, the following diagram represents the value 170 (decimal).</p>
<div class="language-text highlight"><pre><span></span><code>                    0 1 2 3 4 5 6 7
                    +-+-+-+-+-+-+-+-+
                    |1 0 1 0 1 0 1 0|
                    +-+-+-+-+-+-+-+-+

                    Significance of Bits
</code></pre></div>
<p>Similarly, whenever a multi-octet field represents a numeric quantity the left most bit of the whole field is the most significant bit.  When a multi-octet quantity is transmitted the most significant octet is transmitted first.</p>
</div>
<p>以下为 MSDN 中关于 <a href="https://msdn.microsoft.com/en-us/library/cc230307.aspx">Packet byte/bit order</a> 的阐述：</p>
<blockquote>
<p>For packets, the bit numbering convention followed is the same as that used in RFCs, namely: the high (most significant) bit of the first byte to hit the wire is in packet bit 0, and the low bit of the last byte to hit the wire is in packet bit 31 (so that the bits are shown from left-to-right in the order they naturally appear over the network).</p>
</blockquote>
<figure><br />
<img alt="ms-dtyp" src="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/ms-dtyp_files/image001.png" /><br />
</figure>
<p>Networking and Internet | Windows Sockets 2 | <a href="https://learn.microsoft.com/en-us/windows/win32/winsock/byte-ordering-2">Byte Ordering</a>:</p>
<blockquote>
<p>Care must always be taken to account for any differences between the byte ordering used for storing integers by the host architecture and the byte ordering used on the wire by individual transport protocols. Any reference to an address or port number passed to or from a Windows Sockets routine must be in the network order (big-endian) for the protocol being utilized.</p>
</blockquote>
<p>在网络通信协议程序中，在进行网络数据的收发时，需要发收双方执行字节序转换（convert values between host and network byte order）。</p>
<p>在 Linux 上执行 <code>man BYTEORDER</code> 可以查看相关编程接口，也可参考 The GNU C Library 文档：Sockets | The Internet Namespace | <a href="https://www.gnu.org/software/libc/manual/html_node/Byte-Order.html">Byte Order Conversion</a>。</p>
<details class="info">
<summary>man BYTEORDER</summary>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span>man<span class="w"> </span>BYTEORDER<span class="w"> </span><span class="c1"># man htonl</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>BYTEORDER<span class="o">(</span><span class="m">3</span><span class="o">)</span><span class="w">                       </span>Linux<span class="w"> </span>Programmer<span class="err">&#39;</span>s<span class="w"> </span>Manual<span class="w">                      </span>BYTEORDER<span class="o">(</span><span class="m">3</span><span class="o">)</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>NAME
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">      </span>htonl,<span class="w"> </span>htons,<span class="w"> </span>ntohl,<span class="w"> </span>ntohs<span class="w"> </span>-<span class="w"> </span>convert<span class="w"> </span>values<span class="w"> </span>between<span class="w"> </span>host<span class="w"> </span>and<span class="w"> </span>network<span class="w"> </span>byte<span class="w"> </span>order
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>SYNOPSIS
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">      </span><span class="c1">#include &lt;arpa/inet.h&gt;</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">      </span>uint32_t<span class="w"> </span>htonl<span class="o">(</span>uint32_t<span class="w"> </span>hostlong<span class="o">)</span><span class="p">;</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">      </span>uint16_t<span class="w"> </span>htons<span class="o">(</span>uint16_t<span class="w"> </span>hostshort<span class="o">)</span><span class="p">;</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">      </span>uint32_t<span class="w"> </span>ntohl<span class="o">(</span>uint32_t<span class="w"> </span>netlong<span class="o">)</span><span class="p">;</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">      </span>uint16_t<span class="w"> </span>ntohs<span class="o">(</span>uint16_t<span class="w"> </span>netshort<span class="o">)</span><span class="p">;</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>DESCRIPTION
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">      </span>The<span class="w">  </span>htonl<span class="o">()</span><span class="w">  </span><span class="k">function</span><span class="w">  </span>converts<span class="w">  </span>the<span class="w"> </span>unsigned<span class="w"> </span>integer<span class="w"> </span>hostlong<span class="w"> </span>from<span class="w"> </span>host<span class="w"> </span>byte<span class="w"> </span>order<span class="w"> </span>to
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="w">      </span>network<span class="w"> </span>byte<span class="w"> </span>order.
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="w">      </span>The<span class="w"> </span>htons<span class="o">()</span><span class="w"> </span><span class="k">function</span><span class="w"> </span>converts<span class="w"> </span>the<span class="w"> </span>unsigned<span class="w"> </span>short<span class="w"> </span>integer<span class="w"> </span>hostshort<span class="w"> </span>from<span class="w"> </span>host<span class="w"> </span>byte<span class="w"> </span>order
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="w">      </span>to<span class="w"> </span>network<span class="w"> </span>byte<span class="w"> </span>order.
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="w">      </span>The<span class="w">  </span>ntohl<span class="o">()</span><span class="w">  </span><span class="k">function</span><span class="w"> </span>converts<span class="w"> </span>the<span class="w"> </span>unsigned<span class="w"> </span>integer<span class="w"> </span>netlong<span class="w"> </span>from<span class="w"> </span>network<span class="w"> </span>byte<span class="w"> </span>order<span class="w"> </span>to
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="w">      </span>host<span class="w"> </span>byte<span class="w"> </span>order.
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="w">      </span>The<span class="w"> </span>ntohs<span class="o">()</span><span class="w"> </span><span class="k">function</span><span class="w"> </span>converts<span class="w"> </span>the<span class="w"> </span>unsigned<span class="w"> </span>short<span class="w"> </span>integer<span class="w"> </span>netshort<span class="w"> </span>from<span class="w"> </span>network<span class="w"> </span>byte<span class="w"> </span>or‐
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="w">      </span>der<span class="w"> </span>to<span class="w"> </span>host<span class="w"> </span>byte<span class="w"> </span>order.
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="w">      </span>On<span class="w">  </span>the<span class="w">  </span>i386<span class="w">  </span>the<span class="w"> </span>host<span class="w"> </span>byte<span class="w"> </span>order<span class="w"> </span>is<span class="w"> </span>Least<span class="w"> </span>Significant<span class="w"> </span>Byte<span class="w"> </span>first,<span class="w"> </span>whereas<span class="w"> </span>the<span class="w"> </span>network
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="w">      </span>byte<span class="w"> </span>order,<span class="w"> </span>as<span class="w"> </span>used<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>Internet,<span class="w"> </span>is<span class="w"> </span>Most<span class="w"> </span>Significant<span class="w"> </span>Byte<span class="w"> </span>first.
</span></code></pre></div>
</details>
<p>在 macOS/ubuntu 下执行 <code>grep -RH "htonl\|ntohl"</code> 可以查找到：</p>
<ol>
<li>macOS: usr/include/sys/_endian.h 中根据 <code>__DARWIN_BYTE_ORDER</code> 的值定义了字节序转换宏 <code>htonl</code>/<code>ntohl</code>，在 usr/include/arpa/inet.h 和 usr/include/netinet/in.h 中包含了 &lt;sys/_endian.h&gt;。</li>
<li>ubuntu: /usr/include/netinet/in.h 中根据 <code>__BYTE_ORDER</code> 的值定义了字节序转换宏 <code>htonl</code>/<code>ntohl</code>。</li>
<li>在 macOS/ubuntu 下，arpa/inet.h 中都包含了 &lt;netinet/in.h&gt;。</li>
</ol>
<p>在C/S通信程序中，发送方将本地数据调用 <code>htons</code>/<code>htonl</code>/<code>htonll</code>，序列化打包到 buffer，再调用 socket API 的 <strong>send</strong>() 接口将数据发送到网络。接收方等待 I/O 通知，实时调用 socket API 的 <strong>recv</strong>() 接口将数据从网卡接收到用户层，用户层需按照 TLV 解包，对等调用 <code>ntohs</code>/<code>ntohl</code>/<code>ntohll</code> 解析复原出原始数值。</p>
<p>假设 A 和 B 都是 Little-Endian，A 要给 B 发送一个短整数 s=0x7da，其在内存中的字节数组是 {0xda, 0x7}。以下程序片段简单示意了发收双方的写/读字节转换：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">sender htons</label><label for="__tabbed_1_2">recver ntohs</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-c highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kt">short</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x7da</span><span class="p">;</span><span class="w"> </span><span class="c1">// EL: {0xda, 0x7}</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kt">short</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">htons</span><span class="p">(</span><span class="n">s</span><span class="p">);</span><span class="w"> </span><span class="c1">// EB: {0x7, 0xda}</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">memcpy</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ns</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="n">ns</span><span class="p">);</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">send</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="n">ns</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-c highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kt">short</span><span class="w"> </span><span class="n">ns</span><span class="p">;</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">recv</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="n">ns</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// EB: {0x7, 0xda}</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ns</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="n">ns</span><span class="p">);</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="kt">short</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ntohs</span><span class="p">(</span><span class="n">ns</span><span class="p">);</span><span class="w"> </span><span class="c1">// EL: {0xda, 0x7}</span>
</span></code></pre></div>
</div>
</div>
</div>
<h2 id="__byte_order__">__BYTE_ORDER__<a class="headerlink" href="#__byte_order__" title="Permanent link">#</a></h2>
<p>在 <a href="../../20200203/dump-compiler-options/">Dump Compiler Options</a> 中有介绍如何 dump compiler predefined macros。</p>
<p>clang/gcc 执行 <code>echo | cpp -dM</code> 预处理，打印出来的预定义宏中字节序相关的宏如下：</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">mbpa2991/arm64</label><label for="__tabbed_2_2">rpi4b-ubuntu/aarch64</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">#define __BYTE_ORDER__ __ORDER_LITTLE_ENDIAN__</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="c1">#define __LITTLE_ENDIAN__ 1</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1">#define __ORDER_BIG_ENDIAN__ 4321</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1">#define __ORDER_LITTLE_ENDIAN__ 1234</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c1">#define __ORDER_PDP_ENDIAN__ 3412</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">#define __FLOAT_WORD_ORDER__ __ORDER_LITTLE_ENDIAN__</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c1">#define __ORDER_PDP_ENDIAN__ 3412</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1">#define __ORDER_BIG_ENDIAN__ 4321</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1">#define __BYTE_ORDER__ __ORDER_LITTLE_ENDIAN__</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1">#define __ORDER_LITTLE_ENDIAN__ 1234</span>
</span></code></pre></div>
</div>
</div>
</div>
<p>从 <code>__BYTE_ORDER__</code> 宏定义来看，两种平台均为小尾端字节序（<code>__ORDER_LITTLE_ENDIAN__</code>），macOS 还定义了宏 <code>__LITTLE_ENDIAN__</code> 的值为 1。</p>
<p>在 macOS/ubuntu 下，可以执行 grep 命令，在 usr/include 中查找哪些头文件中定义了这些宏。</p>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># mbpa2991/arm64</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="sb">`</span>xcrun<span class="w"> </span>--show-sdk-path<span class="sb">`</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>$<span class="w"> </span>grep<span class="w"> </span>-REl<span class="w"> </span><span class="s2">&quot;#.*define.*(BYTE_ORDER|BIG_ENDIAN|LITTLE_ENDIAN|PDP_ENDIAN)&quot;</span><span class="w"> </span>usr/include<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="c1"># rpi4b-ubuntu/aarch64</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>$<span class="w"> </span>grep<span class="w"> </span>-REl<span class="w"> </span><span class="s2">&quot;#.*define.*(BYTE_ORDER|BIG_ENDIAN|LITTLE_ENDIAN|PDP_ENDIAN)&quot;</span><span class="w"> </span>/usr/include<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</span></code></pre></div>
<p>将 grep 命令的选项 <code>l</code> 改为 <code>H</code> 可列出具体匹配的行和内容。</p>
<h3 id="mbpa2991-macos">mbpa2991-macOS<a class="headerlink" href="#mbpa2991-macos" title="Permanent link">#</a></h3>
<p>在 mbpa2991-macOS/arm64 中，i386 和 arm 均定义了 BYTE_ORDER 为 <code>__DARWIN_BYTE_ORDER</code>=<code>__DARWIN_LITTLE_ENDIAN</code>。</p>
<details class="info">
<summary>grep -REH usr/include under macOS</summary>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="sb">`</span>xcrun<span class="w"> </span>--show-sdk-path<span class="sb">`</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>$<span class="w"> </span>grep<span class="w"> </span>-REH<span class="w"> </span><span class="s2">&quot;#.*define.*(BYTE_ORDER|BIG_ENDIAN|LITTLE_ENDIAN|PDP_ENDIAN)&quot;</span><span class="w"> </span>usr/include<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>usr/include/i386/endian.h:#define<span class="w"> </span>__DARWIN_LITTLE_ENDIAN<span class="w">  </span><span class="m">1234</span><span class="w">    </span>/*<span class="w"> </span>LSB<span class="w"> </span>first:<span class="w"> </span>i386,<span class="w"> </span>vax<span class="w"> </span>*/
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>usr/include/i386/endian.h:#define<span class="w"> </span>__DARWIN_BIG_ENDIAN<span class="w">     </span><span class="m">4321</span><span class="w">    </span>/*<span class="w"> </span>MSB<span class="w"> </span>first:<span class="w"> </span><span class="m">68000</span>,<span class="w"> </span>ibm,<span class="w"> </span>net<span class="w"> </span>*/
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>usr/include/i386/endian.h:#define<span class="w"> </span>__DARWIN_PDP_ENDIAN<span class="w">     </span><span class="m">3412</span><span class="w">    </span>/*<span class="w"> </span>LSB<span class="w"> </span>first<span class="w"> </span><span class="k">in</span><span class="w"> </span>word,<span class="w"> </span>MSW<span class="w"> </span>first<span class="w"> </span><span class="k">in</span><span class="w"> </span>long<span class="w"> </span>*/
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>usr/include/i386/endian.h:#define<span class="w"> </span>__DARWIN_BYTE_ORDER<span class="w">     </span>__DARWIN_LITTLE_ENDIAN
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>usr/include/i386/endian.h:#define<span class="w"> </span>LITTLE_ENDIAN<span class="w">   </span>__DARWIN_LITTLE_ENDIAN
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>usr/include/i386/endian.h:#define<span class="w"> </span>BIG_ENDIAN<span class="w">      </span>__DARWIN_BIG_ENDIAN
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>usr/include/i386/endian.h:#define<span class="w"> </span>PDP_ENDIAN<span class="w">      </span>__DARWIN_PDP_ENDIAN
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>usr/include/i386/endian.h:#define<span class="w"> </span>BYTE_ORDER<span class="w">      </span>__DARWIN_BYTE_ORDER
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>usr/include/arm/endian.h:#define<span class="w"> </span>__DARWIN_LITTLE_ENDIAN<span class="w">  </span><span class="m">1234</span><span class="w">    </span>/*<span class="w"> </span>LSB<span class="w"> </span>first:<span class="w"> </span>i386,<span class="w"> </span>vax<span class="w"> </span>*/
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>usr/include/arm/endian.h:#define<span class="w"> </span>__DARWIN_BIG_ENDIAN<span class="w">     </span><span class="m">4321</span><span class="w">    </span>/*<span class="w"> </span>MSB<span class="w"> </span>first:<span class="w"> </span><span class="m">68000</span>,<span class="w"> </span>ibm,<span class="w"> </span>net<span class="w"> </span>*/
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>usr/include/arm/endian.h:#define<span class="w"> </span>__DARWIN_PDP_ENDIAN<span class="w">     </span><span class="m">3412</span><span class="w">    </span>/*<span class="w"> </span>LSB<span class="w"> </span>first<span class="w"> </span><span class="k">in</span><span class="w"> </span>word,<span class="w"> </span>MSW<span class="w"> </span>first<span class="w"> </span><span class="k">in</span><span class="w"> </span>long<span class="w"> </span>*/
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>usr/include/arm/endian.h:#define<span class="w"> </span>__DARWIN_BYTE_ORDER<span class="w">     </span>__DARWIN_LITTLE_ENDIAN
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>usr/include/arm/endian.h:#define<span class="w"> </span>LITTLE_ENDIAN<span class="w">   </span>__DARWIN_LITTLE_ENDIAN
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>usr/include/arm/endian.h:#define<span class="w"> </span>BIG_ENDIAN<span class="w">      </span>__DARWIN_BIG_ENDIAN
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>usr/include/arm/endian.h:#define<span class="w"> </span>PDP_ENDIAN<span class="w">      </span>__DARWIN_PDP_ENDIAN
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>usr/include/arm/endian.h:#define<span class="w"> </span>BYTE_ORDER<span class="w">      </span>__DARWIN_BYTE_ORDER
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>usr/include/libkern/OSByteOrder.h:#if<span class="w"> </span>defined<span class="o">(</span>__LITTLE_ENDIAN__<span class="o">)</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>usr/include/libkern/OSByteOrder.h:#elif<span class="w"> </span>defined<span class="o">(</span>__BIG_ENDIAN__<span class="o">)</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>usr/include/libkern/OSByteOrder.h:#if<span class="w">             </span>defined<span class="o">(</span>__BIG_ENDIAN__<span class="o">)</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>usr/include/libkern/OSByteOrder.h:#elif<span class="w">           </span>defined<span class="o">(</span>__LITTLE_ENDIAN__<span class="o">)</span>
</span></code></pre></div>
</details>
<ol>
<li>usr/include/mach/ndr.h 中定义了 <code>NDR_INT_BIG_ENDIAN</code>=<code>0，NDR_INT_LITTLE_ENDIAN</code>=1。</li>
<li>在 usr/include/TargetConditionals.h 中，gcc based compiler used on Mac OS X 基于 <code>__BYTE_ORDER__</code> 的值定义互斥值 <code>TARGET_RT_LITTLE_ENDIAN</code> / <code>TARGET_RT_BIG_ENDIAN。</code></li>
<li>在 usr/include/c++/v1/__config 中，<code>__BYTE_ORDER__</code> 和 <code>__LITTLE_ENDIAN__</code>/<code>__BIG_ENDIAN__</code> 宏定义与否及其值来定义宏 <code>_LIBCPP_LITTLE_ENDIAN</code>/<code>_LIBCPP_BIG_ENDIAN</code>。</li>
<li>在 usr/include/c++/v1/__bit/endian.h 中，对于 _LIBCPP_STD_VER &gt;= 20（since c++20），判断 <code>_LIBCPP_LITTLE_ENDIAN</code>/<code>_LIBCPP_BIG_ENDIAN</code> 定义 <code>enum class endian</code>。</li>
</ol>
<p>在早期（before C99, c++11）没有定义 64bit long long，需要用两个 int32 复合成结构体来模拟一个 int64 整形数据。两个 32bit 的 WORD 在 struct 中的顺序需要考虑字节序（判断宏 TARGET_RT_BIG_ENDIAN）。</p>
<div class="language-c highlight"><span class="filename">usr/include/MacTypes.h</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="cm">/* avoid redeclaration if libkern/OSTypes.h */</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="cp">#ifndef _OS_OSTYPES_H</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="cp">#if TARGET_RT_BIG_ENDIAN</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="k">struct</span><span class="w"> </span><span class="nc">wide</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="n">SInt32</span><span class="w">              </span><span class="n">hi</span><span class="p">;</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">  </span><span class="n">UInt32</span><span class="w">              </span><span class="n">lo</span><span class="p">;</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="p">};</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">wide</span><span class="w">                     </span><span class="n">wide</span><span class="p">;</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="k">struct</span><span class="w"> </span><span class="nc">UnsignedWide</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">  </span><span class="n">UInt32</span><span class="w">              </span><span class="n">hi</span><span class="p">;</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">  </span><span class="n">UInt32</span><span class="w">              </span><span class="n">lo</span><span class="p">;</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="p">};</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">UnsignedWide</span><span class="w">             </span><span class="n">UnsignedWide</span><span class="p">;</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="cp">#else</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="k">struct</span><span class="w"> </span><span class="nc">wide</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">  </span><span class="n">UInt32</span><span class="w">              </span><span class="n">lo</span><span class="p">;</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">  </span><span class="n">SInt32</span><span class="w">              </span><span class="n">hi</span><span class="p">;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="p">};</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">wide</span><span class="w">                     </span><span class="n">wide</span><span class="p">;</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="k">struct</span><span class="w"> </span><span class="nc">UnsignedWide</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">  </span><span class="n">UInt32</span><span class="w">              </span><span class="n">lo</span><span class="p">;</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">  </span><span class="n">UInt32</span><span class="w">              </span><span class="n">hi</span><span class="p">;</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="p">};</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">UnsignedWide</span><span class="w">             </span><span class="n">UnsignedWide</span><span class="p">;</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="cp">#endif  </span><span class="cm">/* TARGET_RT_BIG_ENDIAN */</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="cp">#endif</span>
</span></code></pre></div>
<h3 id="rpi4b-ubuntu">rpi4b-ubuntu<a class="headerlink" href="#rpi4b-ubuntu" title="Permanent link">#</a></h3>
<p>在 rpi4b-ubuntu/arm64 中，little_endian.h 和 big_endian.h 各自定义了大小端相关的宏及对应 <code>BITFIELD</code>。</p>
<details class="info">
<summary>grep -REH /usr/include under ubuntu</summary>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>$<span class="w"> </span>grep<span class="w"> </span>-REH<span class="w"> </span><span class="s2">&quot;#.*define.*(BYTE_ORDER|BIG_ENDIAN|LITTLE_ENDIAN|PDP_ENDIAN)&quot;</span><span class="w"> </span>/usr/include<span class="w"> </span><span class="m">2</span>&gt;/dev/null
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>/usr/include/linux/byteorder/little_endian.h:#define<span class="w"> </span>__LITTLE_ENDIAN<span class="w"> </span><span class="m">1234</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>/usr/include/linux/byteorder/little_endian.h:#define<span class="w"> </span>__LITTLE_ENDIAN_BITFIELD
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>/usr/include/linux/byteorder/big_endian.h:#define<span class="w"> </span>__BIG_ENDIAN<span class="w"> </span><span class="m">4321</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>/usr/include/linux/byteorder/big_endian.h:#define<span class="w"> </span>__BIG_ENDIAN_BITFIELD
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>/usr/include/aarch64-linux-gnu/bits/endianness.h:#<span class="w"> </span>define<span class="w"> </span>__BYTE_ORDER<span class="w"> </span>__BIG_ENDIAN
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>/usr/include/aarch64-linux-gnu/bits/endianness.h:#<span class="w"> </span>define<span class="w"> </span>__BYTE_ORDER<span class="w"> </span>__LITTLE_ENDIAN
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>/usr/include/aarch64-linux-gnu/bits/endian.h:#define<span class="w">    </span>__LITTLE_ENDIAN<span class="w"> </span><span class="m">1234</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>/usr/include/aarch64-linux-gnu/bits/endian.h:#define<span class="w">    </span>__BIG_ENDIAN<span class="w">    </span><span class="m">4321</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>/usr/include/aarch64-linux-gnu/bits/endian.h:#define<span class="w">    </span>__PDP_ENDIAN<span class="w">    </span><span class="m">3412</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>/usr/include/aarch64-linux-gnu/bits/endian.h:#<span class="w"> </span>define<span class="w"> </span>__FLOAT_WORD_ORDER<span class="w"> </span>__BYTE_ORDER
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>/usr/include/endian.h:#<span class="w"> </span>define<span class="w"> </span>LITTLE_ENDIAN<span class="w">    </span>__LITTLE_ENDIAN
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>/usr/include/endian.h:#<span class="w"> </span>define<span class="w"> </span>BIG_ENDIAN<span class="w">   </span>__BIG_ENDIAN
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>/usr/include/endian.h:#<span class="w"> </span>define<span class="w"> </span>PDP_ENDIAN<span class="w">   </span>__PDP_ENDIAN
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>/usr/include/endian.h:#<span class="w"> </span>define<span class="w"> </span>BYTE_ORDER<span class="w">   </span>__BYTE_ORDER
</span></code></pre></div>
</details>
<p>最底层 bits/endianness.h 中根据是否定义了 <code>__AARCH64EB__</code> 宏，来进一步定义 <code>__BYTE_ORDER</code>：</p>
<div class="language-c highlight"><span class="filename">/usr/include/aarch64-linux-gnu/bits/endianness.h</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="cp">#ifndef _BITS_ENDIAN_H</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="cp"># error &quot;Never use &lt;bits/endianness.h&gt; directly; include &lt;endian.h&gt; instead.&quot;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="cp">#endif</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="cm">/* AArch64 has selectable endianness.  */</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="cp">#ifdef __AARCH64EB__</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="cp"># define __BYTE_ORDER __BIG_ENDIAN</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="cp">#else</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="cp"># define __BYTE_ORDER __LITTLE_ENDIAN</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="cp">#endif</span>
</span></code></pre></div>
<p>bits/endian.h 包含了 &lt;bits/endianness.h&gt;，定义了 <code>__LITTLE_ENDIAN</code>、<code>__BIG_ENDIAN</code>、<code>__PDP_ENDIAN</code> 和 <code>__FLOAT_WORD_ORDER</code>：</p>
<div class="language-c highlight"><span class="filename">/usr/include/aarch64-linux-gnu/bits/endian.h</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="cp">#ifndef _BITS_ENDIAN_H</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="cp">#define _BITS_ENDIAN_H 1</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="cm">/* Definitions for byte order, according to significance of bytes,</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="cm">   from low addresses to high addresses.  The value is what you get by</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="cm">   putting &#39;4&#39; in the most significant byte, &#39;3&#39; in the second most</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="cm">   significant byte, &#39;2&#39; in the second least significant byte, and &#39;1&#39;</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="cm">   in the least significant byte, and then writing down one digit for</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="cm">   each byte, starting with the byte at the lowest address at the left,</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="cm">   and proceeding to the byte with the highest address at the right.  */</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="cp">#define __LITTLE_ENDIAN 1234</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="cp">#define __BIG_ENDIAN    4321</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="cp">#define __PDP_ENDIAN    3412</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="cm">/* This file defines `__BYTE_ORDER&#39; for the particular machine.  */</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/endianness.h&gt;</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="cm">/* Some machines may need to use a different endianness for floating point</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="cm">   values.  */</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="cp">#ifndef __FLOAT_WORD_ORDER</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="cp"># define __FLOAT_WORD_ORDER __BYTE_ORDER</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="cp">#endif</span>
</span></code></pre></div>
<p>/usr/include/endian.h 包含了 &lt;bits/endian.h&gt;，向上层用户提供头文件：</p>
<div class="language-c highlight"><span class="filename">/usr/include/endian.h</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="cm">/* Get the definitions of __*_ENDIAN, __BYTE_ORDER, and __FLOAT_WORD_ORDER.  */</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;bits/endian.h&gt;</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="cp">#ifdef __USE_MISC</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="cp"># define LITTLE_ENDIAN  __LITTLE_ENDIAN</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="cp"># define BIG_ENDIAN __BIG_ENDIAN</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="cp"># define PDP_ENDIAN __PDP_ENDIAN</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="cp"># define BYTE_ORDER __BYTE_ORDER</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="cp">#endif</span>
</span></code></pre></div>
<p>/usr/include/linux 下的网络协议实现相关头文件 if_packet.h,tcp.h,ip.h,icmp.h,igmp.h,cdrom.h 中判断是否定义了 <code>__LITTLE_ENDIAN_BITFIELD</code> / <code>__BIG_ENDIAN_BITFIELD</code>。其他头文件中主要判断 <code>__BYTE_ORDER</code> 的值。</p>
<h2 id="test_endianess">test endianess<a class="headerlink" href="#test_endianess" title="Permanent link">#</a></h2>
<p>我们在前面利用编译器预处理输出了字节序相关的 predefined macros，然后通过 grep 查找 usr/include 下相关宏定义所在的头文件。</p>
<ol>
<li>macOS 上的 i386/endian.h 和 arm/endian.h 不同架构下清晰定义了 <code>BYTE_ORDER</code> 为小尾端，没找到 <code>__LITTLE_ENDIAN__</code> 定义处。</li>
<li>
<p>ubuntu 最底层 bits/endianness.h 中根据是否定义了 <code>__AARCH64EB__</code> 宏，来进一步定义了 <code>__BYTE_ORDER</code>。</p>
<ul>
<li>从 dump 出的 predefined macros 找到了 <code>#define __AARCH64EL__ 1</code>，没有定义 <code>__AARCH64EB__</code>，即小尾端。</li>
</ul>
</li>
</ol>
<p><a href="https://en.cppreference.com/w/cpp/numeric#Bit_manipulation">Numerics library - Bit manipulation</a> c++20 引入了 <a href="https://en.cppreference.com/w/cpp/types/endian">std::endian</a> —— indicates the endianness of scalar types.</p>
<div class="admonition note">
<p class="admonition-title">c++20 std::endian</p>
<p>参考 20230510 <a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2023/n4950.pdf">ISO/IEC-N4950</a> 中 22.15.8 Endian：</p>
<p>Two common methods of byte ordering in multibyte scalar types are big-endian and little-endian in the execution environment. <strong><em>Big-endian</em></strong> is a format for storage of binary data in which the most significant byte is placed first, with the rest in descending order. <strong><em>Little-endian</em></strong> is a format for storage of binary data in which the least significant byte is placed first, with the rest in ascending order. This subclause describes the endianness of the scalar types of the execution environment.</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">enum</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">endian</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span><span class="n">little</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p">,</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">  </span><span class="n">big</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p">,</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">  </span><span class="n">native</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">below</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="p">};</span>
</span></code></pre></div>
<p>If all scalar types have size 1 byte, then all of <code>endian::little</code>, <code>endian::big</code>, and <code>endian::native</code> have the same value. Otherwise, <code>endian::little</code> is not equal to <code>endian::big</code>. If all scalar types are big-endian, <code>endian::native</code> is equal to <code>endian::big</code>. If all scalar types are little-endian, <code>endian::native</code> is equal to <code>endian::little</code>. Otherwise, <code>endian::native</code> is not equal to either <code>endian::big</code> or <code>endian::little</code>.</p>
</div>
<p>最后，我们基于 union 同一块内存的不同解析来测试系统的字节序。</p>
<ul>
<li><strong>isBigEndian</strong>: 无符号短整型 us 占用 2 个字节，字节指针 (unsigned char *)&amp;us 指向第1个字节。如果是大端顺序存放，第1个字节存放高位 0x34。</li>
<li><strong>isLittleEndian</strong>: 联合类型 c，最长单元为短整型 a，占用 2 个字节。c.a、c.b 都指向数据结构的起始位置，即内存中的第 1 个字节。c.a=0x0001，当小端存放时，第 1 个字节存放低位 0x01，即 c.b=0x1。</li>
</ul>
<div class="language-c highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">test-endianess.c</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span>
<span class="normal"><a href="#__codelineno-14-27">27</a></span>
<span class="normal"><a href="#__codelineno-14-28">28</a></span>
<span class="normal"><a href="#__codelineno-14-29">29</a></span>
<span class="normal"><a href="#__codelineno-14-30">30</a></span>
<span class="normal"><a href="#__codelineno-14-31">31</a></span>
<span class="normal"><a href="#__codelineno-14-32">32</a></span>
<span class="normal"><a href="#__codelineno-14-33">33</a></span>
<span class="normal"><a href="#__codelineno-14-34">34</a></span>
<span class="normal"><a href="#__codelineno-14-35">35</a></span>
<span class="normal"><a href="#__codelineno-14-36">36</a></span>
<span class="normal"><a href="#__codelineno-14-37">37</a></span>
<span class="normal"><a href="#__codelineno-14-38">38</a></span>
<span class="normal"><a href="#__codelineno-14-39">39</a></span>
<span class="normal"><a href="#__codelineno-14-40">40</a></span>
<span class="normal"><a href="#__codelineno-14-41">41</a></span>
<span class="normal"><a href="#__codelineno-14-42">42</a></span>
<span class="normal"><a href="#__codelineno-14-43">43</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="p">{</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="w">    </span><span class="n">PDP_ENDIAN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3412</span><span class="p">,</span><span class="w">    </span><span class="c1">// __ORDER_PDP_ENDIAN__</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="w">    </span><span class="n">BIG_ENDIAN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x4321</span><span class="p">,</span><span class="w">    </span><span class="c1">// __ORDER_BIG_ENDIAN__</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="w">    </span><span class="n">LITTLE_ENDIAN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x1234</span><span class="p">,</span><span class="w"> </span><span class="c1">// __ORDER_LITTLE_ENDIAN__</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="p">}</span><span class="w"> </span><span class="n">ByteOrder</span><span class="p">;</span><span class="w"> </span><span class="c1">// __BYTE_ORDER__</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="c1">// 顺序存储(MSB first)</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="kt">int</span><span class="w"> </span><span class="nf">isBigEndian</span><span class="p">()</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="p">{</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">short</span><span class="w"> </span><span class="n">us</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PDP_ENDIAN</span><span class="p">;</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">us</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0x34</span><span class="p">);</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="p">}</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16"></a>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17"></a><span class="c1">// 高位存储低权字节，则为小端(LSB first)</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="n">ByteOrder</span><span class="w"> </span><span class="nf">getByteOrder</span><span class="p">()</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="p">{</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20"></a><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">ByteOrder</span><span class="w"> </span><span class="n">bo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PDP_ENDIAN</span><span class="p">;</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21"></a>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bo</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">PDP_ENDIAN</span><span class="p">)</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24"></a><span class="w">        </span><span class="k">union</span><span class="w"> </span><span class="nc">u</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26"></a><span class="w">            </span><span class="kt">short</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// 2 byte</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27"></a><span class="w">            </span><span class="kt">char</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">  </span><span class="c1">// 1 byte</span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29"></a><span class="w">        </span><span class="n">c</span><span class="p">.</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// 0x0001</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30"></a><span class="w">        </span><span class="n">bo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">LITTLE_ENDIAN</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">BIG_ENDIAN</span><span class="p">);</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32"></a>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">bo</span><span class="p">;</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34"></a><span class="p">}</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35"></a>
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37"></a><span class="p">{</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38"></a><span class="w">    </span><span class="c1">// const char* endianess = isBigEndian() ? &quot;BIG_ENDIAN&quot; : &quot;LITTLE_ENDIAN&quot;;</span>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">endianess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getByteOrder</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BIG_ENDIAN</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;BIG_ENDIAN&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;LITTLE_ENDIAN&quot;</span><span class="p">;</span>
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;endianess = %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">endianess</span><span class="p">);</span>
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41"></a>
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43"></a><span class="p">}</span>
</span></code></pre></div></td></tr></table></div>
<p>win10/x86_64，mbpa2991-macOS/arm64 和 rpi4b-ubuntu/aarch64 下编译运行，均输出如下：</p>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># win10 MSVC 2022/x86_64</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>&gt;cl<span class="w"> </span>test-endianess.c<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>test-endianess.exe
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c1"># mbpa2991-macOS/arm64, rpi4b-ubuntu/aarch64</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>$<span class="w"> </span>cc<span class="w"> </span>test-endianess.c<span class="w"> </span>-o<span class="w"> </span>test-endianess<span class="w"> </span>-g<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>./test-endianess
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="nv">endianess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>LITTLE_ENDIAN
</span></code></pre></div>
<h2 id="refs">refs<a class="headerlink" href="#refs" title="Permanent link">#</a></h2>
<p><a href="http://blog.csdn.net/dandycheung/archive/2010/09/13/5881620.aspx">字节那些事儿</a><br />
<a href="http://blog.csdn.net/lincyang/article/details/17266027">ARM Endian（字节序）初探</a></p>
<p><a href="http://www.cnblogs.com/wuyuegb2312/archive/2013/06/08/3126510.html">轻松记住大小端的含义</a><br />
<a href="http://blog.csdn.net/hackbuteer1/article/details/7722667">大端模式和小端模式</a></p>
<p><a href="http://www.crifan.com/big_endian_big_endian_and_small_end_little_endian_detailed/">大端与小端详解</a><br />
<a href="http://blog.csdn.net/ce123_zhouwei/article/details/6971544">详解大端模式和小端模式</a></p>
<p>IBM z/OS - <a href="https://www.ibm.com/docs/en/zos/3.1.0?topic=domain-network-byte-order">Network byte order</a><br />
IBM z/VM - <a href="https://www.ibm.com/docs/en/zvm/7.3?topic=domains-network-byte-order-host-byte-order">Network byte order and host byte order</a><br />
<a href="https://ask.wireshark.org/question/15501/what-is-the-endianness-of-captured-packet-headers/">What Is The Endianness of Captured Packet Headers? - Ask Wireshark</a></p>







  
  



  


  



  <h2 id="__comments">评论</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
    data-repo="fan2/mkdocs"
    data-repo-id="R_kgDOLltxSg"
    data-category="Announcements"
    data-category-id="DIC_kwDOLltxSs4CeURH"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../../20211006/c-memory-model/" class="md-footer__link md-footer__link--prev" aria-label="上一页: The C Memory Model">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                The C Memory Model
              </div>
            </div>
          </a>
        
        
          
          <a href="../../20211008/data-model/" class="md-footer__link md-footer__link--next" aria-label="下一页: Data Models">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Data Models
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024- Cliff Fan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["toc.follow", "header.autohide", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.tracking", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://vercount.one/js"></script>
      
    
  </body>
</html>