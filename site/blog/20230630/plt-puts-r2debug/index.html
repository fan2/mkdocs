
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="在别处或在路上">
      
      
        <meta name="author" content="Cliff Fan">
      
      
        <link rel="canonical" href="https://duetorun.com/blog/20230630/plt-puts-r2debug/">
      
      
        <link rel="prev" href="../../20230629/plt-puts-pwndbg/">
      
      
        <link rel="next" href="../../20231001/sre-toolkit/">
      
      
      <link rel="icon" href="../../../assets/hold_yourself.jpg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>reloc puts@plt via GOT - r2 debug - ElseWhere</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-XGW41EGL31"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-XGW41EGL31",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-XGW41EGL31",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#entry_point_vaddr" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="ElseWhere" class="md-header__button md-logo" aria-label="ElseWhere" data-md-component="logo">
      
  <img src="../../../assets/hold_yourself.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ElseWhere
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              reloc puts@plt via GOT - r2 debug
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8v2m9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../link/" class="md-tabs__link">
        
  
    
  
  Link

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ElseWhere" class="md-nav__button md-logo" aria-label="ElseWhere" data-md-component="logo">
      
  <img src="../../../assets/hold_yourself.jpg" alt="logo">

    </a>
    ElseWhere
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2017
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2015/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2015
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2009/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2009
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/arm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/c/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    c
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cpp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cpp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/elf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/excerpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    excerpt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/macos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/material/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    material
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/mkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/resource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    resource
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/toolchain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolchain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/vim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/webdav/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webDAV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/wiki/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wiki
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/zsh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zsh
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Link
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#entry_point_vaddr" class="md-nav__link">
    <span class="md-ellipsis">
      entry point vaddr
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loaded_modules" class="md-nav__link">
    <span class="md-ellipsis">
      loaded modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory_maps" class="md-nav__link">
    <span class="md-ellipsis">
      memory maps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sections2segments" class="md-nav__link">
    <span class="md-ellipsis">
      sections2segments
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importsrelocations" class="md-nav__link">
    <span class="md-ellipsis">
      imports/relocations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#entry0_-_main" class="md-nav__link">
    <span class="md-ellipsis">
      entry0 -&gt; main
    </span>
  </a>
  
    <nav class="md-nav" aria-label="entry0 -> main">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dcu_entry0" class="md-nav__link">
    <span class="md-ellipsis">
      dcu entry0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libc_vmmap" class="md-nav__link">
    <span class="md-ellipsis">
      libc vmmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dcu_main" class="md-nav__link">
    <span class="md-ellipsis">
      dcu main
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#putsplt" class="md-nav__link">
    <span class="md-ellipsis">
      puts@plt
    </span>
  </a>
  
    <nav class="md-nav" aria-label="puts@plt">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reloc_fixup" class="md-nav__link">
    <span class="md-ellipsis">
      reloc fixup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adrpldr" class="md-nav__link">
    <span class="md-ellipsis">
      ADRP+LDR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#br_x17" class="md-nav__link">
    <span class="md-ellipsis">
      br x17
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#putsglibc" class="md-nav__link">
    <span class="md-ellipsis">
      puts@GLIBC
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://duetorun.com/assets/carve_yourself.jpg" alt="Cliff Fan">
                    </span>
                    <span class="md-profile__description">
                      <strong>
                        
                          Cliff Fan
                        
                      </strong>
                      <br>
                      Just do IT
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                        <time datetime="2023-06-30 10:00:00" class="md-ellipsis">2023年6月30日</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                          <span class="md-ellipsis">
                            分类于
                            
                              <a href="../../category/elf/">elf</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg>
                          <span class="md-ellipsis">
                            
                              需要 18 分钟阅读时间
                            
                          </span>
                        </div>
                      </li>
                    
                    <!-- Add by Cliff.Fan, 29Mar24. -->
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 1-5 5v11l5-4.5V1m2 4v13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6c-1.45-1.1-3.55-1.5-5.5-1.5-1.95 0-4.05.4-5.5 1.5v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1M10 18.41C8.75 18.09 7.5 18 6.5 18c-1.06 0-2.32.19-3.5.5V7.13c.91-.4 2.14-.63 3.5-.63 1.36 0 2.59.23 3.5.63v11.28Z"/></svg>
                        <span class="md-ellipsis" id="busuanzi_container_page_pv">
                          阅读量：<span id="busuanzi_value_page_pv">N/A</span>
                        </span>
                      </div>
                    </li>
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  
  

<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">.rela.plt</span>
    
  
    
    
    
      <span class="md-tag">.got</span>
    
  
    
    
    
      <span class="md-tag">.plt</span>
    
  
    
    
    
      <span class="md-tag">reloc.puts</span>
    
  
</nav>



  <h1>reloc puts@plt via GOT - r2 debug</h1>

<p><a href="../../20230629/plt-puts-pwndbg/">Previously</a>, we've dynamically analysed how shared dynamic symbols such as <code>puts</code> are resolved and relocated at runtime using gdb-pwndbg.</p>
<p>On this post, we'll do much the same work, but change our dynamic analysis tool to the popular open-source SRE toolkit r2(aka <a href="../../20231002/radare2-basics/">radare2</a>).</p>
<p>It is also a thorough and comprehensive debugging exercise, demonstrating the power and versatility of the <code>r2</code> toolset.</p>
<!-- more -->

<p>Run the DYN ELF <code>a.out</code> with the <code>-d</code> and <code>-A</code> options using r2.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$<span class="w"> </span>r2<span class="w"> </span>-dA<span class="w"> </span>a.out
</span></code></pre></div>
<ol>
<li><code>-d</code>: debug the executable, behaved as <code>gdb -&gt; starti</code>.</li>
<li><code>-A</code> will run <code>aaa</code> command to analyze all referenced code.</li>
</ol>
<p>Check program/process status info:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># list opened binary files and objid</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>ob
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>*<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">3</span><span class="w"> </span>arm-64<span class="w"> </span>ba:0xaaaadc760640<span class="w"> </span>sz:7078<span class="w"> </span>/home/pifan/Projects/cpp/a.out
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="c1"># show path to executable</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>dpe
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>/home/pifan/Projects/cpp/a.out
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c1"># list current pid and children</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>dp
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>INFO:<span class="w"> </span>Selected:<span class="w"> </span><span class="m">501878</span><span class="w"> </span><span class="m">501878</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w"> </span>*<span class="w"> </span><span class="m">501878</span><span class="w"> </span>ppid:501854<span class="w"> </span>uid:1000<span class="w"> </span>s<span class="w"> </span>./a.out
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c1"># show the current process id</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>dpq
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="m">501878</span>
</span></code></pre></div>
<h2 id="entry_point_vaddr">entry point vaddr<a class="headerlink" href="#entry_point_vaddr" title="Permanent link">#</a></h2>
<p>Check base address(<code>baddr</code>) and <code>paddr</code>/<code>vaddr</code> of entry point.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># see ba in `ob`</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>i<span class="w"> </span>~baddr
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>baddr<span class="w">    </span>0xaaaadc760000
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># same as dbg.baddr, progam base address</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span><span class="nv">$DB</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>0xaaaadc760000
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>rabin2<span class="w"> </span>-eq<span class="w"> </span>a.out
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>0x00000640
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>ieq
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>0xaaaadc760640
</span></code></pre></div>
<p>List CRT entries+constructors:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>ieee
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">[</span>Constructors<span class="o">]</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="nv">vaddr</span><span class="o">=</span>0xaaaadc760750<span class="w"> </span><span class="nv">paddr</span><span class="o">=</span>0x00000750<span class="w"> </span><span class="nv">hvaddr</span><span class="o">=</span>0xaaaadc770d90<span class="w"> </span><span class="nv">hpaddr</span><span class="o">=</span>0x00000d90<span class="w"> </span><span class="nv">type</span><span class="o">=</span>init
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="nv">vaddr</span><span class="o">=</span>0xaaaadc760700<span class="w"> </span><span class="nv">paddr</span><span class="o">=</span>0x00000700<span class="w"> </span><span class="nv">hvaddr</span><span class="o">=</span>0xaaaadc770d98<span class="w"> </span><span class="nv">hpaddr</span><span class="o">=</span>0x00000d98<span class="w"> </span><span class="nv">type</span><span class="o">=</span>fini
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="m">2</span><span class="w"> </span>entrypoints
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="o">[</span>Entrypoints<span class="o">]</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="nv">vaddr</span><span class="o">=</span>0xaaaadc760640<span class="w"> </span><span class="nv">paddr</span><span class="o">=</span>0x00000640<span class="w"> </span><span class="nv">haddr</span><span class="o">=</span>0x00000018<span class="w"> </span><span class="nv">hvaddr</span><span class="o">=</span>0xaaaadc760018<span class="w"> </span><span class="nv">type</span><span class="o">=</span>program
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="m">1</span><span class="w"> </span>entrypoints
</span></code></pre></div>
<p>Show main function address.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>iM
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="o">[</span>Main<span class="o">]</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="nv">vaddr</span><span class="o">=</span>0xaaaadc760754<span class="w"> </span><span class="nv">paddr</span><span class="o">=</span>0x00000754
</span></code></pre></div>
<p><a href="https://reverseengineering.stackexchange.com/questions/19782/what-does-paddr-baddr-laddr-haddr-and-hvaddr-refer-to">radare2 - What does paddr, baddr, laddr, haddr, and hvaddr refer to?</a></p>
<ul>
<li><code>vaddr</code> - Virtual Address</li>
<li><code>paddr</code> - Physical Address</li>
<li><code>laddr</code> - Load Address</li>
<li><code>baddr</code> - Base Address</li>
<li><code>haddr</code> - e_entry/AddressOfEntryPoint in binary header</li>
<li><code>hvaddr</code> - Header Physical Address</li>
<li><code>hpaddr</code> - e_entry/AddressOfEntryPoint offset in binary header</li>
</ul>
<p><a href="https://stackoverflow.com/questions/2170843/va-virtual-address-rva-relative-virtual-address">assembly - VA (Virtual Address) &amp; RVA (Relative Virtual Address)</a></p>
<p>Usually the RVA in image files is relative to process base address when being loaded into memory, but some RVA may be relative to the "section" starting address in image or object files (you have to check the PE format spec for detail). No matter which, RVA is relative to "some" base VA.</p>
<ol>
<li>Physical Memory Address is what CPU sees</li>
<li>Virtual Addreess (VA) is relative to Physical Address, per process (managed by OS)</li>
<li>RVA is relative to VA (file base or section base), per file (managed by linker and loader)</li>
</ol>
<p>Most RVAs are given relative to the beginning of the file, but occasionally (especially when looking at object files instead of executables) you'll see an RVA based on the section.</p>
<h2 id="loaded_modules">loaded modules<a class="headerlink" href="#loaded_modules" title="Permanent link">#</a></h2>
<p>First, list modules (libraries, binaries loaded in memory) to see where we are and what's been loaded.</p>
<blockquote>
<p>As the debugging process breaks at a very early stage, it still halts in the interpreter's module.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>dmm.
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>INFO:<span class="w"> </span>modules.get
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>0xffff9847b000<span class="w"> </span>0xffff984a6000<span class="w">  </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1
</span></code></pre></div>
<p>Type <code>?w $$</code> or <code>?w pc</code> to show what's in current address.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="o">[</span>0xffff9fc44c40<span class="o">]</span>&gt;<span class="w"> </span>?w<span class="w"> </span>pc
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span>pc<span class="w"> </span>library<span class="w"> </span>R<span class="w"> </span>X<span class="w"> </span><span class="s1">&#39;bti c&#39;</span><span class="w"> </span><span class="s1">&#39;ld-linux-aarch64.so.1&#39;</span>
</span></code></pre></div>
<p>List modules of target process.</p>
<blockquote>
<p>There are only two modules loaded at the moment, the interpreter and our demo.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>dmm
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>INFO:<span class="w"> </span>modules.get
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>0xaaaadc760000<span class="w"> </span>0xaaaadc761000<span class="w">  </span>/home/pifan/Projects/cpp/a.out
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>0xffff9847b000<span class="w"> </span>0xffff984a6000<span class="w">  </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1
</span></code></pre></div>
<p>At the moment, the dependent <em>libc.so</em> is not loaded.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>il
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="o">[</span>Linked<span class="w"> </span>libraries<span class="o">]</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>libc.so.6
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="m">1</span><span class="w"> </span>library
</span></code></pre></div>
<h2 id="memory_maps">memory maps<a class="headerlink" href="#memory_maps" title="Permanent link">#</a></h2>
<p>Show map name of current address.</p>
<blockquote>
<p>We're staying in the <em>LOAD0</em> segment of the interpreter <code>ld-linux-aarch64.so</code>.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>dm.
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>0x0000ffff9847b000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984a6000<span class="w"> </span>*<span class="w"> </span>usr<span class="w">   </span>172K<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._usr_lib_aarch64_linux_gnu_ld_linux_aarch64.so.1.r_x
</span></code></pre></div>
<p>List memory maps of current/target process.</p>
<ol>
<li>Two loadable segments exist per so, <em>LOAD0</em> and <em>LOAD1</em>.</li>
<li><code>r-x</code> marks <em>LOAD0</em> segment; <code>rw-</code> designates <em>LOAD1</em> segment.</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># dpq get pid then !cat /proc/pid/maps</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>dm
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>0x0000aaaadc760000<span class="w"> </span>-<span class="w"> </span>0x0000aaaadc761000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>4K<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._home_pifan_Projects_cpp_a.out.r_x
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>0x0000aaaadc770000<span class="w"> </span>-<span class="w"> </span>0x0000aaaadc772000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>8K<span class="w"> </span>s<span class="w"> </span>rw-<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._home_pifan_Projects_cpp_a.out.rw_
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>0x0000ffff9847b000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984a6000<span class="w"> </span>*<span class="w"> </span>usr<span class="w">   </span>172K<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._usr_lib_aarch64_linux_gnu_ld_linux_aarch64.so.1.r_x
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>0x0000ffff984b2000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984b4000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>8K<span class="w"> </span>s<span class="w"> </span>r--<span class="w"> </span><span class="o">[</span>vvar<span class="o">]</span><span class="w"> </span><span class="o">[</span>vvar<span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>map._vvar_.r__
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>0x0000ffff984b4000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984b5000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>4K<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span><span class="o">[</span>vdso<span class="o">]</span><span class="w"> </span><span class="o">[</span>vdso<span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>map._vdso_.r_x
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>0x0000ffff984b5000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984b9000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">    </span>16K<span class="w"> </span>s<span class="w"> </span>rw-<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._usr_lib_aarch64_linux_gnu_ld_linux_aarch64.so.1.rw_
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>0x0000ffffc7fcd000<span class="w"> </span>-<span class="w"> </span>0x0000ffffc7fee000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">   </span>132K<span class="w"> </span>s<span class="w"> </span>rw-<span class="w"> </span><span class="o">[</span>stack<span class="o">]</span><span class="w"> </span><span class="o">[</span>stack<span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>map._stack_.rw_
</span></code></pre></div>
<p>Evaluate <code>$D</code> and <code>$DD</code> to confirm current debug map info.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># current debug map base address</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span><span class="nv">$D</span><span class="w"> </span><span class="c1"># @pc</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>0xffff9847b000
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="c1"># current debug map size</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span><span class="nv">$DD</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>0x2b000
</span></code></pre></div>
<h2 id="sections2segments">sections2segments<a class="headerlink" href="#sections2segments" title="Permanent link">#</a></h2>
<p>Use <code>readelf</code> or <code>objdump</code> to display the sections' header.</p>
<ul>
<li><code>readelf [-S|--section-headers]</code>: display the sections' header</li>
<li><code>objdump [-h|--[section-]headers]</code>: display the contents of the section headers</li>
</ul>
<p>Use <code>readelf -lW</code> to display the program headers.</p>
<p>Also, <code>rabin2</code> supports options to list sections and segments and their mapping relationship.</p>
<p><code>rabin2 -SSS</code>: sections mapping to segments.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>$<span class="w"> </span>rabin2<span class="w"> </span>-SSS<span class="w"> </span>a.out
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>Section<span class="w"> </span>to<span class="w"> </span>Segment<span class="w"> </span>mapping:
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>Segment<span class="w">      </span>Section
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>--------------------
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>PHDR
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>INTERP<span class="w">       </span>.interp
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>LOAD0<span class="w">        </span>.interp<span class="w"> </span>.note.gnu.build-id<span class="w"> </span>.note.ABI-tag<span class="w"> </span>.gnu.hash<span class="w"> </span>.dynsym<span class="w"> </span>.dynstr<span class="w"> </span>.gnu.version<span class="w"> </span>.gnu.version_r<span class="w"> </span>.rela.dyn<span class="w"> </span>.rela.plt<span class="w"> </span>.init<span class="w"> </span>.plt<span class="w"> </span>.text<span class="w"> </span>.fini<span class="w"> </span>.rodata<span class="w"> </span>.eh_frame_hdr<span class="w"> </span>.eh_frame<span class="w"> </span>.comment<span class="w"> </span>.symtab<span class="w"> </span>.strtab<span class="w"> </span>.shstrtab
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>LOAD1<span class="w">        </span>.init_array<span class="w"> </span>.fini_array<span class="w"> </span>.dynamic<span class="w"> </span>.got<span class="w"> </span>.data<span class="w"> </span>.bss
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>DYNAMIC<span class="w">      </span>.dynamic
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>NOTE<span class="w">         </span>.note.gnu.build-id<span class="w"> </span>.note.ABI-tag
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>GNU_EH_FRAME<span class="w"> </span>.eh_frame_hdr
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>GNU_STACK
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>GNU_RELRO<span class="w">    </span>.init_array<span class="w"> </span>.fini_array<span class="w"> </span>.dynamic<span class="w"> </span>.got
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>ehdr<span class="w">         </span>.comment
</span></code></pre></div>
<p>From the above output of the section to segment mapping we can see that the sections <code>.rela.dyn</code>, <code>.rela.plt</code> and <code>.plt</code> along with the <code>.text</code> have been classified into the first loadable text segment <em>LOAD0</em>.</p>
<p>Meanwhile, the <code>.dynamic</code> and <code>.got</code> sections along with the <code>.data</code> seciton have been categorized into the second loadable data segment <em>LOAD1</em>.</p>
<p><code>rabin2 -S</code> / <code>iS</code>: sections</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>iS
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="o">[</span>Sections<span class="o">]</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>nth<span class="w"> </span>paddr<span class="w">        </span>size<span class="w"> </span>vaddr<span class="w">           </span>vsize<span class="w"> </span>perm<span class="w"> </span><span class="nb">type</span><span class="w">        </span>name
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="m">0</span><span class="w">   </span>0x00000000<span class="w">    </span>0x0<span class="w"> </span>0x00000000<span class="w">        </span>0x0<span class="w"> </span>----<span class="w"> </span>NULL
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="m">1</span><span class="w">   </span>0x00000238<span class="w">   </span>0x1b<span class="w"> </span>0xaaaadc760238<span class="w">   </span>0x1b<span class="w"> </span>-r--<span class="w"> </span>PROGBITS<span class="w">    </span>.interp
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="m">2</span><span class="w">   </span>0x00000254<span class="w">   </span>0x24<span class="w"> </span>0xaaaadc760254<span class="w">   </span>0x24<span class="w"> </span>-r--<span class="w"> </span>NOTE<span class="w">        </span>.note.gnu.build-id
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="m">3</span><span class="w">   </span>0x00000278<span class="w">   </span>0x20<span class="w"> </span>0xaaaadc760278<span class="w">   </span>0x20<span class="w"> </span>-r--<span class="w"> </span>NOTE<span class="w">        </span>.note.ABI-tag
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="m">4</span><span class="w">   </span>0x00000298<span class="w">   </span>0x1c<span class="w"> </span>0xaaaadc760298<span class="w">   </span>0x1c<span class="w"> </span>-r--<span class="w"> </span>GNU_HASH<span class="w">    </span>.gnu.hash
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="m">5</span><span class="w">   </span>0x000002b8<span class="w">   </span>0xf0<span class="w"> </span>0xaaaadc7602b8<span class="w">   </span>0xf0<span class="w"> </span>-r--<span class="w"> </span>DYNSYM<span class="w">      </span>.dynsym
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="m">6</span><span class="w">   </span>0x000003a8<span class="w">   </span>0x92<span class="w"> </span>0xaaaadc7603a8<span class="w">   </span>0x92<span class="w"> </span>-r--<span class="w"> </span>STRTAB<span class="w">      </span>.dynstr
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="m">7</span><span class="w">   </span>0x0000043a<span class="w">   </span>0x14<span class="w"> </span>0xaaaadc76043a<span class="w">   </span>0x14<span class="w"> </span>-r--<span class="w"> </span>GNU_VERSYM<span class="w">  </span>.gnu.version
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="m">8</span><span class="w">   </span>0x00000450<span class="w">   </span>0x30<span class="w"> </span>0xaaaadc760450<span class="w">   </span>0x30<span class="w"> </span>-r--<span class="w"> </span>GNU_VERNEED<span class="w"> </span>.gnu.version_r
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="m">9</span><span class="w">   </span>0x00000480<span class="w">   </span>0xc0<span class="w"> </span>0xaaaadc760480<span class="w">   </span>0xc0<span class="w"> </span>-r--<span class="w"> </span>RELA<span class="w">        </span>.rela.dyn
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="m">10</span><span class="w">  </span>0x00000540<span class="w">   </span>0x78<span class="w"> </span>0xaaaadc760540<span class="w">   </span>0x78<span class="w"> </span>-r--<span class="w"> </span>RELA<span class="w">        </span>.rela.plt
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="m">11</span><span class="w">  </span>0x000005b8<span class="w">   </span>0x18<span class="w"> </span>0xaaaadc7605b8<span class="w">   </span>0x18<span class="w"> </span>-r-x<span class="w"> </span>PROGBITS<span class="w">    </span>.init
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="m">12</span><span class="w">  </span>0x000005d0<span class="w">   </span>0x70<span class="w"> </span>0xaaaadc7605d0<span class="w">   </span>0x70<span class="w"> </span>-r-x<span class="w"> </span>PROGBITS<span class="w">    </span>.plt
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="m">13</span><span class="w">  </span>0x00000640<span class="w">  </span>0x13c<span class="w"> </span>0xaaaadc760640<span class="w">  </span>0x13c<span class="w"> </span>-r-x<span class="w"> </span>PROGBITS<span class="w">    </span>.text
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="m">14</span><span class="w">  </span>0x0000077c<span class="w">   </span>0x14<span class="w"> </span>0xaaaadc76077c<span class="w">   </span>0x14<span class="w"> </span>-r-x<span class="w"> </span>PROGBITS<span class="w">    </span>.fini
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="m">15</span><span class="w">  </span>0x00000790<span class="w">   </span>0x16<span class="w"> </span>0xaaaadc760790<span class="w">   </span>0x16<span class="w"> </span>-r--<span class="w"> </span>PROGBITS<span class="w">    </span>.rodata
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="m">16</span><span class="w">  </span>0x000007a8<span class="w">   </span>0x3c<span class="w"> </span>0xaaaadc7607a8<span class="w">   </span>0x3c<span class="w"> </span>-r--<span class="w"> </span>PROGBITS<span class="w">    </span>.eh_frame_hdr
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="m">17</span><span class="w">  </span>0x000007e8<span class="w">   </span>0xac<span class="w"> </span>0xaaaadc7607e8<span class="w">   </span>0xac<span class="w"> </span>-r--<span class="w"> </span>PROGBITS<span class="w">    </span>.eh_frame
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="m">18</span><span class="w">  </span>0x00000d90<span class="w">    </span>0x8<span class="w"> </span>0xaaaadc770d90<span class="w">    </span>0x8<span class="w"> </span>-rw-<span class="w"> </span>INIT_ARRAY<span class="w">  </span>.init_array
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="m">19</span><span class="w">  </span>0x00000d98<span class="w">    </span>0x8<span class="w"> </span>0xaaaadc770d98<span class="w">    </span>0x8<span class="w"> </span>-rw-<span class="w"> </span>FINI_ARRAY<span class="w">  </span>.fini_array
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="m">20</span><span class="w">  </span>0x00000da0<span class="w">  </span>0x1f0<span class="w"> </span>0xaaaadc770da0<span class="w">  </span>0x1f0<span class="w"> </span>-rw-<span class="w"> </span>DYNAMIC<span class="w">     </span>.dynamic
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="m">21</span><span class="w">  </span>0x00000f90<span class="w">   </span>0x70<span class="w"> </span>0xaaaadc770f90<span class="w">   </span>0x70<span class="w"> </span>-rw-<span class="w"> </span>PROGBITS<span class="w">    </span>.got
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="m">22</span><span class="w">  </span>0x00001000<span class="w">   </span>0x10<span class="w"> </span>0xaaaadc771000<span class="w">   </span>0x10<span class="w"> </span>-rw-<span class="w"> </span>PROGBITS<span class="w">    </span>.data
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="m">23</span><span class="w">  </span>0x00001010<span class="w">    </span>0x0<span class="w"> </span>0xaaaadc771010<span class="w">    </span>0x8<span class="w"> </span>-rw-<span class="w"> </span>NOBITS<span class="w">      </span>.bss
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="m">24</span><span class="w">  </span>0x00001010<span class="w">   </span>0x2b<span class="w"> </span>0x00000000<span class="w">       </span>0x2b<span class="w"> </span>----<span class="w"> </span>PROGBITS<span class="w">    </span>.comment
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="m">25</span><span class="w">  </span>0x00001040<span class="w">  </span>0x840<span class="w"> </span>0x00000000<span class="w">      </span>0x840<span class="w"> </span>----<span class="w"> </span>SYMTAB<span class="w">      </span>.symtab
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="m">26</span><span class="w">  </span>0x00001880<span class="w">  </span>0x22c<span class="w"> </span>0x00000000<span class="w">      </span>0x22c<span class="w"> </span>----<span class="w"> </span>STRTAB<span class="w">      </span>.strtab
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="m">27</span><span class="w">  </span>0x00001aac<span class="w">   </span>0xfa<span class="w"> </span>0x00000000<span class="w">       </span>0xfa<span class="w"> </span>----<span class="w"> </span>STRTAB<span class="w">      </span>.shstrtab
</span></code></pre></div>
<p><code>rabin2 -SS</code> / <code>iSS</code>: segments</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>iSS
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="o">[</span>Segments<span class="o">]</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>nth<span class="w"> </span>paddr<span class="w">        </span>size<span class="w"> </span>vaddr<span class="w">           </span>vsize<span class="w"> </span>perm<span class="w"> </span><span class="nb">type</span><span class="w"> </span>name
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="m">0</span><span class="w">   </span>0x00000040<span class="w">  </span>0x1f8<span class="w"> </span>0xaaaadc760040<span class="w">  </span>0x1f8<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>PHDR
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="m">1</span><span class="w">   </span>0x00000238<span class="w">   </span>0x1b<span class="w"> </span>0xaaaadc760238<span class="w">   </span>0x1b<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>INTERP
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="m">2</span><span class="w">   </span>0x00000000<span class="w">  </span>0x894<span class="w"> </span>0xaaaadc760000<span class="w">  </span>0x894<span class="w"> </span>-r-x<span class="w"> </span>MAP<span class="w">  </span>LOAD0
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="m">3</span><span class="w">   </span>0x00000d90<span class="w">  </span>0x280<span class="w"> </span>0xaaaadc770d90<span class="w">  </span>0x288<span class="w"> </span>-rw-<span class="w"> </span>MAP<span class="w">  </span>LOAD1
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="m">4</span><span class="w">   </span>0x00000da0<span class="w">  </span>0x1f0<span class="w"> </span>0xaaaadc770da0<span class="w">  </span>0x1f0<span class="w"> </span>-rw-<span class="w"> </span>MAP<span class="w">  </span>DYNAMIC
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="m">5</span><span class="w">   </span>0x00000254<span class="w">   </span>0x44<span class="w"> </span>0xaaaadc760254<span class="w">   </span>0x44<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>NOTE
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="m">6</span><span class="w">   </span>0x000007a8<span class="w">   </span>0x3c<span class="w"> </span>0xaaaadc7607a8<span class="w">   </span>0x3c<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>GNU_EH_FRAME
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="m">7</span><span class="w">   </span>0x00000000<span class="w">    </span>0x0<span class="w"> </span>0xaaaadc760000<span class="w">    </span>0x0<span class="w"> </span>-rw-<span class="w"> </span>MAP<span class="w">  </span>GNU_STACK
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="m">8</span><span class="w">   </span>0x00000d90<span class="w">  </span>0x270<span class="w"> </span>0xaaaadc770d90<span class="w">  </span>0x270<span class="w"> </span>-r--<span class="w"> </span>MAP<span class="w">  </span>GNU_RELRO
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="m">9</span><span class="w">   </span>0x00000000<span class="w">   </span>0x40<span class="w"> </span>0xaaaadc760000<span class="w">   </span>0x40<span class="w"> </span>-rw-<span class="w"> </span>MAP<span class="w">  </span>ehdr
</span></code></pre></div>
<p>According to the mapping relationship, <em>LOAD0</em>'s first section is <code>.interp</code>, of whose vaddr is 0xaaaadc760238.<br />
As <code>readelf -lW a.out</code> indicated, it should be aligned at 0x10000(64K), so the segment vaddr is 0xaaaadc760000.</p>
<div class="admonition question">
<p class="admonition-title">vaddr of LOAD1</p>
<p>Why is the vaddr of the <em>LOAD1</em> segment shown as 0xaaaadc770d90 and not 0xaaaadc770000?<br />
It seems to be the vaddr of the first section <code>.init_array</code>.</p>
</div>
<h2 id="importsrelocations">imports/relocations<a class="headerlink" href="#importsrelocations" title="Permanent link">#</a></h2>
<p><code>nm -u|-D</code>: display only undefined/dynamic symbols.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># nm -D a.out</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>$<span class="w"> </span>nm<span class="w"> </span>-u<span class="w"> </span>a.out
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">                 </span>U<span class="w"> </span>abort@GLIBC_2.17
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">                 </span>w<span class="w"> </span>__cxa_finalize@GLIBC_2.17
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">                 </span>w<span class="w"> </span>__gmon_start__
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">                 </span>w<span class="w"> </span>_ITM_deregisterTMCloneTable
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">                 </span>w<span class="w"> </span>_ITM_registerTMCloneTable
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="hll"><span class="w">                 </span>U<span class="w"> </span>__libc_start_main@GLIBC_2.34
</span></span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">                 </span>U<span class="w"> </span>puts@GLIBC_2.17
</span></code></pre></div>
<p>The PLT stub <code>puts@plt</code> for <code>puts@GLIBC_2.17</code> is labelled as <code>sym.imp.puts</code>/<code>rsym.puts</code> by r2 after loading.</p>
<blockquote>
<p><code>sym.</code> stands for <em>sym</em>bol, e.g., sym.main, sym.func.<br />
<code>imp.</code> stands for <em>imp</em>orted symbols like puts/scanf, to be relocated.<br />
<code>rsym.</code> stands for has-been-<em>r</em>elocated symbols like puts/scanf in libc.so.</p>
</blockquote>
<p>Type <code>ii</code> to list the symbols imported from other libraries.</p>
<blockquote>
<p>The vaddr of relocated symbol <code>rsym.puts</code> in PLT can be calculated as follows.<br />
VA = baddr+offset/RVA = 0xaaaadc760000 + 0x00000630 = 0xaaaadc760630.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>ii
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="o">[</span>Imports<span class="o">]</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>nth<span class="w"> </span>vaddr<span class="w">          </span><span class="nb">bind</span><span class="w">   </span><span class="nb">type</span><span class="w">   </span>lib<span class="w"> </span>name
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>―――――――――――――――――――――――――――――――――――――――――
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="m">3</span><span class="w">   </span>0xaaaadc7605f0<span class="w"> </span>GLOBAL<span class="w"> </span>FUNC<span class="w">       </span>__libc_start_main
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="m">4</span><span class="w">   </span>----------<span class="w">     </span>WEAK<span class="w">   </span>NOTYPE<span class="w">     </span>_ITM_deregisterTMCloneTable
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="m">5</span><span class="w">   </span>0xaaaadc760600<span class="w"> </span>WEAK<span class="w">   </span>FUNC<span class="w">       </span>__cxa_finalize
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="m">6</span><span class="w">   </span>0xaaaadc760610<span class="w"> </span>WEAK<span class="w">   </span>NOTYPE<span class="w">     </span>__gmon_start__
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="m">7</span><span class="w">   </span>0xaaaadc760620<span class="w"> </span>GLOBAL<span class="w"> </span>FUNC<span class="w">       </span>abort
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="hll"><span class="m">8</span><span class="w">   </span>0xaaaadc760630<span class="w"> </span>GLOBAL<span class="w"> </span>FUNC<span class="w">       </span>puts
</span></span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="m">9</span><span class="w">   </span>----------<span class="w">     </span>WEAK<span class="w">   </span>NOTYPE<span class="w">     </span>_ITM_registerTMCloneTable
</span></code></pre></div>
<p>Press <span class="keys"><kbd class="key-tab">Tab</kbd></span> after the dot to view automatic IntelliSense options.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span>sym.
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>sym._init<span class="w">                   </span>sym.imp.__libc_start_main
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>sym.imp.__cxa_finalize<span class="w">      </span>sym.imp.abort
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>sym.imp.puts<span class="w">                </span>sym._start
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>sym.call_weak_fn<span class="w">            </span>sym.deregister_tm_clones
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>sym.register_tm_clones<span class="w">      </span>sym.__do_global_dtors_aux
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>sym.frame_dummy<span class="w">             </span>sym.main
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>sym._fini
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span>sym.imp.
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>sym.imp.__libc_start_main<span class="w">   </span>sym.imp.__cxa_finalize<span class="w">      </span>sym.imp.abort
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>sym.imp.puts
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span>rsym.
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>rsym.__libc_start_main<span class="w">   </span>rsym.__cxa_finalize<span class="w">      </span>rsym.__gmon_start__
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>rsym.abort<span class="w">               </span>rsym.puts
</span></code></pre></div>
<p>Inspect the address of the symbol.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># ii ~puts</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span>rsym.puts<span class="w"> </span><span class="c1"># ?v sym.imp.puts # afo rsym.puts</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>0xaaaadc760630
</span></code></pre></div>
<p>Type <code>ir</code> to list the relocations.</p>
<blockquote>
<p>The vaddr offset of the relocated symbol(<code>reloc.puts</code>) in GOT is 0x00010fc8.<br />
VA = baddr+offset/RVA = 0xaaaadc760000 + 0x00010fc8 = 0xaaaadc770fc8.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>ir
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>WARN:<span class="w"> </span>Relocs<span class="w"> </span>has<span class="w"> </span>not<span class="w"> </span>been<span class="w"> </span>applied.<span class="w"> </span>Please<span class="w"> </span>use<span class="w"> </span><span class="sb">`</span>-e<span class="w"> </span>bin.relocs.apply<span class="o">=</span><span class="nb">true</span><span class="sb">`</span><span class="w"> </span>or<span class="w"> </span><span class="sb">`</span>-e<span class="w"> </span>bin.cache<span class="o">=</span><span class="nb">true</span><span class="sb">`</span><span class="w"> </span>next<span class="w"> </span><span class="nb">time</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="o">[</span>Relocations<span class="o">]</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>vaddr<span class="w">          </span>paddr<span class="w">      </span><span class="nb">type</span><span class="w">   </span>ntype<span class="w"> </span>name
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>―――――――――――――――――――――――――――――――――――――――――――
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>0xaaaadc770d90<span class="w"> </span>0x00000d90<span class="w"> </span>ADD_64<span class="w"> </span><span class="m">1027</span><span class="w">   </span>0x00000750
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>0xaaaadc770d98<span class="w"> </span>0x00000d98<span class="w"> </span>ADD_64<span class="w"> </span><span class="m">1027</span><span class="w">   </span>0x00000700
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>0xaaaadc770fa8<span class="w"> </span>0x00000fa8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>__libc_start_main
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>0xaaaadc770fb0<span class="w"> </span>0x00000fb0<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>__cxa_finalize
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>0xaaaadc770fb8<span class="w"> </span>0x00000fb8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>__gmon_start__
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>0xaaaadc770fc0<span class="w"> </span>0x00000fc0<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>abort
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="hll">0xaaaadc770fc8<span class="w"> </span>0x00000fc8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1026</span><span class="w">  </span>puts
</span></span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>0xaaaadc770fd8<span class="w"> </span>0x00000fd8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1025</span><span class="w">  </span>_ITM_deregisterTMCloneTable
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>0xaaaadc770fe0<span class="w"> </span>0x00000fe0<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1025</span><span class="w">  </span>__cxa_finalize
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>0xaaaadc770fe8<span class="w"> </span>0x00000fe8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1025</span><span class="w">  </span>__gmon_start__
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>0xaaaadc770ff0<span class="w"> </span>0x00000ff0<span class="w"> </span>ADD_64<span class="w"> </span><span class="m">1027</span><span class="w">   </span>0x00000754
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>0xaaaadc770ff8<span class="w"> </span>0x00000ff8<span class="w"> </span>SET_64<span class="w"> </span><span class="m">1025</span><span class="w">  </span>_ITM_registerTMCloneTable
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>0xaaaadc771008<span class="w"> </span>0x00001008<span class="w"> </span>ADD_64<span class="w"> </span><span class="m">1027</span><span class="w">   </span>0x00011008
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="m">13</span><span class="w"> </span>relocations
</span></code></pre></div>
<p>Try to show context disassembly of 15 instructions around <code>puts</code>.</p>
<blockquote>
<p>The GOT entry for <code>puts@plt</code> is labelled as <code>reloc.puts</code> by r2, equivalent to <code>puts@got.plt</code> in pwndbg.</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>pd--<span class="w"> </span><span class="m">15</span><span class="w"> </span>@<span class="w"> </span>reloc.puts<span class="w"> </span><span class="c1"># @ 0xaaaadc770fc8</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">            </span>0xaaaadc770f8c<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>section..got:
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">            </span>0xaaaadc770f90<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid<span class="w">                 </span><span class="p">;</span><span class="w"> </span><span class="o">[</span><span class="m">21</span><span class="o">]</span><span class="w"> </span>-rw-<span class="w"> </span>section<span class="w"> </span>size<span class="w"> </span><span class="m">112</span><span class="w"> </span>named<span class="w"> </span>.got
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">            </span>0xaaaadc770f94<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">            </span>0xaaaadc770f98<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">            </span>0xaaaadc770f9c<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">            </span>0xaaaadc770fa0<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">            </span>0xaaaadc770fa4<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>reloc.__libc_start_main:
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">            </span>0xaaaadc770fa8<span class="w">      </span>d0050000<span class="w">       </span>invalid
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">            </span>0xaaaadc770fac<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">            </span>0xaaaadc770fb0<span class="w">      </span>d0050000<span class="w">       </span>invalid
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">            </span>0xaaaadc770fb4<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="w">            </span>0xaaaadc770fb8<span class="w">      </span>d0050000<span class="w">       </span>invalid
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="w">            </span>0xaaaadc770fbc<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>reloc.abort:
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">            </span>0xaaaadc770fc0<span class="w">      </span>d0050000<span class="w">       </span>invalid
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">            </span>0xaaaadc770fc4<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="hll"><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>reloc.puts:
</span></span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="w">            </span>0xaaaadc770fc8<span class="w">      </span>d0050000<span class="w">       </span>invalid
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">            </span>0xaaaadc770fcc<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>_GLOBAL_OFFSET_TABLE_:
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="w">            </span>0xaaaadc770fd0<span class="w">      </span>a00d0100<span class="w">       </span>invalid
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="w">            </span>0xaaaadc770fd4<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>reloc._ITM_deregisterTMCloneTable:
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="w">            </span>0xaaaadc770fd8<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="w">            </span>0xaaaadc770fdc<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>reloc.__cxa_finalize:
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a><span class="w">            </span>0xaaaadc770fe0<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a><span class="w">            </span>0xaaaadc770fe4<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>reloc.__gmon_start__:
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a><span class="w">            </span>0xaaaadc770fe8<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a><span class="w">            </span>0xaaaadc770fec<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a><span class="w">            </span>0xaaaadc770ff0<span class="w">      </span><span class="m">54070000</span><span class="w">       </span>invalid
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a><span class="w">            </span>0xaaaadc770ff4<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>reloc._ITM_registerTMCloneTable:
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a><span class="w">            </span>0xaaaadc770ff8<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-39"><a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a><span class="w">            </span>0xaaaadc770ffc<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid
</span><span id="__span-20-40"><a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>section..data:
</span><span id="__span-20-41"><a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>data_start:
</span><span id="__span-20-42"><a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>__data_start:
</span><span id="__span-20-43"><a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a><span class="w">            </span><span class="p">;</span><span class="w"> </span>XREFS:<span class="w"> </span>DATA<span class="w"> </span>0xaaaadc760690<span class="w">  </span>DATA<span class="w"> </span>0xaaaadc760698<span class="w">  </span>DATA<span class="w"> </span>0xaaaadc7606c0<span class="w">  </span>DATA<span class="w"> </span>0xaaaadc7606c8<span class="w">  </span>DATA<span class="w"> </span>0xaaaadc76070c
</span><span id="__span-20-44"><a id="__codelineno-20-44" name="__codelineno-20-44" href="#__codelineno-20-44"></a><span class="w">            </span><span class="p">;</span><span class="w"> </span>XREFS:<span class="w"> </span>DATA<span class="w"> </span>0xaaaadc760724
</span><span id="__span-20-45"><a id="__codelineno-20-45" name="__codelineno-20-45" href="#__codelineno-20-45"></a><span class="w">            </span>0xaaaae0071000<span class="w">      </span><span class="m">00000000</span><span class="w">       </span>invalid<span class="w">                 </span><span class="p">;</span><span class="w"> </span><span class="o">[</span><span class="m">22</span><span class="o">]</span><span class="w"> </span>-rw-<span class="w"> </span>section<span class="w"> </span>size<span class="w"> </span><span class="m">16</span><span class="w"> </span>named<span class="w"> </span>.data
</span></code></pre></div>
<p>Press <span class="keys"><kbd class="key-tab">Tab</kbd></span> after the dot to view automatic IntelliSense options.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span>reloc.
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>reloc.__libc_start_main<span class="w">             </span>reloc.abort
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>reloc.puts<span class="w">                          </span>reloc._ITM_deregisterTMCloneTable
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>reloc.__cxa_finalize<span class="w">                </span>reloc.__gmon_start__
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>reloc._ITM_registerTMCloneTable
</span></code></pre></div>
<p>Get the value(address) of label <code>reloc.puts</code> by evaluation:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># ir ~puts</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span>reloc.puts<span class="w"> </span><span class="c1"># dumb afo mutes</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>0xaaaadc770fc8
</span></code></pre></div>
<p>Use the <code>x</code> command to see what is stored at 0xaaaadc770fc8:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>pxq<span class="w"> </span><span class="nv">$w</span><span class="w"> </span>@<span class="w"> </span>0xaaaadc770fc8
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>0xaaaadc770fc8<span class="w">  </span>0x00000000000005d0
</span></code></pre></div>
<p>According to the hexdump content of the <code>.got</code> section, it's originally filled with 0x00000000000005d0, which is the address of the <code>.plt</code> section. It's the original lineage of plt and got.</p>
<ul>
<li>iS</li>
<li>!readelf -SW a.out</li>
<li>!readelf -R .rela.plt -R .plt -R .got a.out</li>
<li>!objdump -j .rela.plt -j .plt -j .got -s a.out</li>
<li>!rabin2 -S a.out</li>
</ul>
<p>Since <em>libc.so</em> is not loaded at the moment, the GOT relocs entry is not resolved. In other words, the dynamic symbol would only be resolved until its module is loaded.</p>
<h2 id="entry0_-_main">entry0 -&gt; main<a class="headerlink" href="#entry0_-_main" title="Permanent link">#</a></h2>
<h3 id="dcu_entry0">dcu entry0<a class="headerlink" href="#dcu_entry0" title="Permanent link">#</a></h3>
<p>Continue until <code>entry0</code>(aka <code>_start</code>), refer to <code>entry point vaddr</code> and check:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>dcu<span class="w"> </span>entry0
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>INFO:<span class="w"> </span>Continue<span class="w"> </span><span class="k">until</span><span class="w"> </span>0xaaaadc760640<span class="w"> </span>using<span class="w"> </span><span class="m">4</span><span class="w"> </span>bpsize
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>INFO:<span class="w"> </span>hit<span class="w"> </span>breakpoint<span class="w"> </span>at:<span class="w"> </span>0xaaaadc760640
</span></code></pre></div>
<p>Type <code>?w $$</code> or <code>?w pc</code> to confirm what's in current address.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span>&gt;<span class="w"> </span>?w<span class="w"> </span>pc
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>/home/pifan/Projects/cpp/a.out<span class="w"> </span>.text<span class="w"> </span>entry0,section..text,_start,x16,x21,pc,d16,d21<span class="w"> </span>entry0<span class="w"> </span>program<span class="w"> </span>R<span class="w"> </span>X<span class="w"> </span><span class="s1">&#39;nop&#39;</span><span class="w"> </span><span class="s1">&#39;a.out&#39;</span>
</span></code></pre></div>
<p>Seek to pc and list current symbol:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="o">[</span>0xffff98492c40<span class="o">]</span><span class="w"> </span>s<span class="w"> </span>pc<span class="p">;</span><span class="w"> </span>is.
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>nth<span class="w"> </span>paddr<span class="w">      </span>vaddr<span class="w">          </span><span class="nb">bind</span><span class="w">  </span><span class="nb">type</span><span class="w"> </span>size<span class="w"> </span>lib<span class="w"> </span>name<span class="w">  </span>demangled
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>―――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="m">13</span><span class="w">  </span>0x00000640<span class="w"> </span>0xaaaadc760640<span class="w"> </span>LOCAL<span class="w"> </span>SECT<span class="w"> </span><span class="m">0</span><span class="w">        </span>.text
</span></code></pre></div>
<p>Type <code>pdf</code> to disassemble function at current pc, that is <code>entry0</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="o">[</span>0xaaaadc760640<span class="o">]</span>&gt;<span class="w"> </span>pdf
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>section..text:
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>_start:
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>x16:
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>x21:
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>pc:
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>d16:
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>d21:
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>┌<span class="w"> </span><span class="m">48</span>:<span class="w"> </span>entry0<span class="w"> </span><span class="o">(</span>int64_t<span class="w"> </span>arg1,<span class="w"> </span>int64_t<span class="w"> </span>arg_0h,<span class="w"> </span>int64_t<span class="w"> </span>arg_8h<span class="o">)</span><span class="p">;</span><span class="w"> </span>//<span class="w"> </span>noreturn
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>│<span class="w">           </span><span class="p">;</span><span class="w"> </span>arg<span class="w"> </span>int64_t<span class="w"> </span>arg1<span class="w"> </span>@<span class="w"> </span>x0
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>│<span class="w">           </span><span class="p">;</span><span class="w"> </span>arg<span class="w"> </span>int64_t<span class="w"> </span>arg_0h<span class="w"> </span>@<span class="w"> </span>sp+0x0
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>│<span class="w">           </span><span class="p">;</span><span class="w"> </span>arg<span class="w"> </span>int64_t<span class="w"> </span>arg_8h<span class="w"> </span>@<span class="w"> </span>sp+0x8
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>│<span class="w">           </span>0xaaaadc760640<span class="w">      </span>1f2003d5<span class="w">       </span>nop<span class="w">                     </span><span class="p">;</span><span class="w"> </span><span class="o">[</span><span class="m">13</span><span class="o">]</span><span class="w"> </span>-r-x<span class="w"> </span>section<span class="w"> </span>size<span class="w"> </span><span class="m">316</span><span class="w"> </span>named<span class="w"> </span>.text
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>│<span class="w">           </span>0xaaaadc760644<span class="w">      </span>1d0080d2<span class="w">       </span>mov<span class="w"> </span>x29,<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a>│<span class="w">           </span>0xaaaadc760648<span class="w">      </span>1e0080d2<span class="w">       </span>mov<span class="w"> </span>x30,<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a>│<span class="w">           </span>0xaaaadc76064c<span class="w">      </span>e50300aa<span class="w">       </span>mov<span class="w"> </span>x5,<span class="w"> </span>x0<span class="w">              </span><span class="p">;</span><span class="w"> </span>arg1
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>│<span class="w">           </span>0xaaaadc760650<span class="w">      </span>e10340f9<span class="w">       </span>ldr<span class="w"> </span>x1,<span class="w"> </span><span class="o">[</span>sp<span class="o">]</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a>│<span class="w">           </span>0xaaaadc760654<span class="w">      </span>e2230091<span class="w">       </span>add<span class="w"> </span>x2,<span class="w"> </span>arg_8h
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a>│<span class="w">           </span>0xaaaadc760658<span class="w">      </span>e6030091<span class="w">       </span>mov<span class="w"> </span>x6,<span class="w"> </span>sp
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a>│<span class="w">           </span>0xaaaadc76065c<span class="w">      </span><span class="m">80000090</span><span class="w">       </span>adrp<span class="w"> </span>x0,<span class="w"> </span>map._home_pifan_Projects_cpp_a.out.rw_<span class="w"> </span><span class="p">;</span><span class="w"> </span>0xaaaadc770000
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a>│<span class="w">           </span>0xaaaadc760660<span class="w">      </span>00f847f9<span class="w">       </span>ldr<span class="w"> </span>x0,<span class="w"> </span><span class="o">[</span>x0,<span class="w"> </span>0xff0<span class="o">]</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a>│<span class="w">           </span>0xaaaadc760664<span class="w">      </span>030080d2<span class="w">       </span>mov<span class="w"> </span>x3,<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a>│<span class="w">           </span>0xaaaadc760668<span class="w">      </span>040080d2<span class="w">       </span>mov<span class="w"> </span>x4,<span class="w"> </span><span class="m">0</span>
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a>└<span class="w">           </span>0xaaaadc76066c<span class="w">      </span>e1ffff97<span class="w">       </span>bl<span class="w"> </span>sym.imp.__libc_start_main<span class="w"> </span><span class="p">;</span><span class="w"> </span>int<span class="w"> </span>__libc_start_main<span class="o">(</span>func<span class="w"> </span>main,<span class="w"> </span>int<span class="w"> </span>argc,<span class="w"> </span>char<span class="w"> </span>**ubp_av,<span class="w"> </span>func<span class="w"> </span>init,<span class="w"> </span>func<span class="w"> </span>fini,<span class="w"> </span>func<span class="w"> </span>rtld_fini,<span class="w"> </span>void<span class="w"> </span>*stack_end<span class="o">)</span>
</span></code></pre></div>
<p>Disassemble 8 instructions backwards. The PLT stubs of the <code>.plt</code> section happen to be above <em>entry0</em>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="o">[</span>0xaaaadc760640<span class="o">]</span>&gt;<span class="w"> </span>pd<span class="w"> </span>-8
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>rsym.abort:
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>┌<span class="w"> </span><span class="m">16</span>:<span class="w"> </span>void<span class="w"> </span>sym.imp.abort<span class="w"> </span><span class="o">()</span><span class="p">;</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>│<span class="w"> </span>rg:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>vars<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>args<span class="w"> </span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>│<span class="w"> </span>bp:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>vars<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>args<span class="w"> </span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>│<span class="w"> </span>sp:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>vars<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>args<span class="w"> </span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>│<span class="w">           </span>0xaaaadc760620<span class="w">      </span><span class="m">90000090</span><span class="w">       </span>adrp<span class="w"> </span>x16,<span class="w"> </span>map._home_pifan_Projects_cpp_a.out.rw_<span class="w"> </span><span class="p">;</span><span class="w"> </span>0xaaaae6890000
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>│<span class="w">           </span>0xaaaadc760624<span class="w">      </span>11e247f9<span class="w">       </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span>0xfc0<span class="o">]</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>│<span class="w">           </span>0xaaaadc760628<span class="w">      </span>10023f91<span class="w">       </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span>0xfc0
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>└<span class="w">           </span>0xaaaadc76062c<span class="w">      </span>20021fd6<span class="w">       </span>br<span class="w"> </span>x17
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>rsym.puts:
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="w">            </span><span class="p">;</span><span class="w"> </span>CALL<span class="w"> </span>XREF<span class="w"> </span>from<span class="w"> </span>main<span class="w"> </span>@<span class="w"> </span>0xaaaadc76076c<span class="o">(</span>x<span class="o">)</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>┌<span class="w"> </span><span class="m">16</span>:<span class="w"> </span>int<span class="w"> </span>sym.imp.puts<span class="w"> </span><span class="o">(</span>const<span class="w"> </span>char<span class="w"> </span>*s<span class="o">)</span><span class="p">;</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>│<span class="w"> </span>rg:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>vars<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>args<span class="w"> </span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>│<span class="w"> </span>bp:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>vars<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>args<span class="w"> </span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>│<span class="w"> </span>sp:<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>vars<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>args<span class="w"> </span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>│<span class="w">           </span>0xaaaadc760630<span class="w">      </span><span class="m">90000090</span><span class="w">       </span>adrp<span class="w"> </span>x16,<span class="w"> </span>map._home_pifan_Projects_cpp_a.out.rw_<span class="w"> </span><span class="p">;</span><span class="w"> </span>0xaaaae6890000
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>│<span class="w">           </span>0xaaaadc760634<span class="w">      </span>11e647f9<span class="w">       </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span>0xfc8<span class="o">]</span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>│<span class="w">           </span>0xaaaadc760638<span class="w">      </span>10223f91<span class="w">       </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span>0xfc8
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>└<span class="w">           </span>0xaaaadc76063c<span class="w">      </span>20021fd6<span class="w">       </span>br<span class="w"> </span>x17
</span></code></pre></div>
<h3 id="libc_vmmap">libc vmmap<a class="headerlink" href="#libc_vmmap" title="Permanent link">#</a></h3>
<p>Type <code>dmm</code> to check the latest modules.</p>
<ol>
<li>We're now in the text segment of <em>a.out</em> - our main routine.</li>
<li>Dynamic library <code>libc.so</code> have been loaded at the moment.</li>
</ol>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="o">[</span>0xaaaadc760640<span class="o">]</span>&gt;<span class="w"> </span>dmm.
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>INFO:<span class="w"> </span>modules.get
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>0xaaaadc760000<span class="w"> </span>0xaaaadc761000<span class="w">  </span>/home/pifan/Projects/cpp/a.out
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="o">[</span>0xaaaadc760640<span class="o">]</span>&gt;<span class="w"> </span>dmm
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>INFO:<span class="w"> </span>modules.get
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>0xaaaadc760000<span class="w"> </span>0xaaaadc761000<span class="w">  </span>/home/pifan/Projects/cpp/a.out
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="hll">0xffff982c0000<span class="w"> </span>0xffff98448000<span class="w">  </span>/usr/lib/aarch64-linux-gnu/libc.so.6
</span></span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>0xffff9847b000<span class="w"> </span>0xffff984a6000<span class="w">  </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1
</span></code></pre></div>
<p>Evaluate <code>$D</code> and <code>$DD</code> to confirm current debug map base address and size.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="o">[</span>0xaaaadc760640<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span><span class="nv">$D</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>0xaaaadc760000
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="o">[</span>0xaaaadc760640<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span><span class="nv">$DD</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>0x1000
</span></code></pre></div>
<p>Type <code>dm</code> to check the latest memory map:</p>
<blockquote>
<p><code>libc.so</code> is loaded into memory with four segments as highlighted.</p>
</blockquote>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span>
<span class="normal"><a href="#__codelineno-31-11">11</a></span>
<span class="normal"><a href="#__codelineno-31-12">12</a></span>
<span class="normal"><a href="#__codelineno-31-13">13</a></span>
<span class="normal"><a href="#__codelineno-31-14">14</a></span>
<span class="normal"><a href="#__codelineno-31-15">15</a></span>
<span class="normal"><a href="#__codelineno-31-16">16</a></span>
<span class="normal"><a href="#__codelineno-31-17">17</a></span>
<span class="normal"><a href="#__codelineno-31-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="o">[</span>0xaaaadc760640<span class="o">]</span>&gt;<span class="w"> </span>dm.
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2"></a>0x0000aaaadc760000<span class="w"> </span>-<span class="w"> </span>0x0000aaaadc761000<span class="w"> </span>*<span class="w"> </span>usr<span class="w">     </span>4K<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._home_pifan_Projects_cpp_a.out.r_x
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="o">[</span>0xaaaadc760640<span class="o">]</span>&gt;<span class="w"> </span>dm
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4"></a>0x0000aaaadc760000<span class="w"> </span>-<span class="w"> </span>0x0000aaaadc761000<span class="w"> </span>*<span class="w"> </span>usr<span class="w">     </span>4K<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._home_pifan_Projects_cpp_a.out.r_x
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5"></a>0x0000aaaadc770000<span class="w"> </span>-<span class="w"> </span>0x0000aaaadc771000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>4K<span class="w"> </span>s<span class="w"> </span>r--<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._home_pifan_Projects_cpp_a.out.rw_
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6"></a>0x0000aaaadc771000<span class="w"> </span>-<span class="w"> </span>0x0000aaaadc772000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>4K<span class="w"> </span>s<span class="w"> </span>rw-<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span><span class="p">;</span><span class="w"> </span>loc.__data_start
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7"></a><span class="hll">0x0000ffff982c0000<span class="w"> </span>-<span class="w"> </span>0x0000ffff98448000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">   </span><span class="m">1</span>.5M<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6
</span></span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8"></a><span class="hll">0x0000ffff98448000<span class="w"> </span>-<span class="w"> </span>0x0000ffff98457000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">    </span>60K<span class="w"> </span>s<span class="w"> </span>---<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6
</span></span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9"></a><span class="hll">0x0000ffff98457000<span class="w"> </span>-<span class="w"> </span>0x0000ffff9845b000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">    </span>16K<span class="w"> </span>s<span class="w"> </span>r--<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6
</span></span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10"></a><span class="hll">0x0000ffff9845b000<span class="w"> </span>-<span class="w"> </span>0x0000ffff9845d000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>8K<span class="w"> </span>s<span class="w"> </span>rw-<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6
</span></span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11"></a>0x0000ffff9845d000<span class="w"> </span>-<span class="w"> </span>0x0000ffff98469000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">    </span>48K<span class="w"> </span>s<span class="w"> </span>rw-<span class="w"> </span>unk0<span class="w"> </span>unk0
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12"></a>0x0000ffff9847b000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984a6000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">   </span>172K<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._usr_lib_aarch64_linux_gnu_ld_linux_aarch64.so.1.r_x
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13"></a>0x0000ffff984ae000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984b2000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">    </span>16K<span class="w"> </span>s<span class="w"> </span>rw-<span class="w"> </span>unk1<span class="w"> </span>unk1
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14"></a>0x0000ffff984b2000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984b4000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>8K<span class="w"> </span>s<span class="w"> </span>r--<span class="w"> </span><span class="o">[</span>vvar<span class="o">]</span><span class="w"> </span><span class="o">[</span>vvar<span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>map._vvar_.r__
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15"></a>0x0000ffff984b4000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984b5000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>4K<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span><span class="o">[</span>vdso<span class="o">]</span><span class="w"> </span><span class="o">[</span>vdso<span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>map._vdso_.r_x
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16"></a>0x0000ffff984b5000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984b7000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>8K<span class="w"> </span>s<span class="w"> </span>r--<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span><span class="p">;</span><span class="w"> </span>map._usr_lib_aarch64_linux_gnu_ld_linux_aarch64.so.1.rw_
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17"></a>0x0000ffff984b7000<span class="w"> </span>-<span class="w"> </span>0x0000ffff984b9000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">     </span>8K<span class="w"> </span>s<span class="w"> </span>rw-<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1<span class="w"> </span>/usr/lib/aarch64-linux-gnu/ld-linux-aarch64.so.1
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18"></a>0x0000ffffc7fcd000<span class="w"> </span>-<span class="w"> </span>0x0000ffffc7fee000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">   </span>132K<span class="w"> </span>s<span class="w"> </span>rw-<span class="w"> </span><span class="o">[</span>stack<span class="o">]</span><span class="w"> </span><span class="o">[</span>stack<span class="o">]</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>map._stack_.rw_
</span></code></pre></div></td></tr></table></div>
<h3 id="dcu_main">dcu main<a class="headerlink" href="#dcu_main" title="Permanent link">#</a></h3>
<p>Set a breakpoint at <code>main</code> and continue.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="o">[</span>0xaaaadc760640<span class="o">]</span>&gt;<span class="w"> </span>db<span class="w"> </span>main<span class="p">;</span><span class="w"> </span>dc
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>SIGNAL<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="nv">errno</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">addr</span><span class="o">=</span>0x00000000<span class="w"> </span><span class="nv">code</span><span class="o">=</span><span class="m">128</span><span class="w"> </span><span class="nv">si_pid</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">ret</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>INFO:<span class="w"> </span>hit<span class="w"> </span>breakpoint<span class="w"> </span>at:<span class="w"> </span>0xaaaadc760754
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>signal<span class="w"> </span><span class="m">28</span><span class="w"> </span>aka<span class="w"> </span>SIGWINCH<span class="w"> </span>received<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>Window<span class="w"> </span>Changed<span class="w"> </span>Size<span class="o">)</span>
</span></code></pre></div>
<p>Confirm what's up and disassemble function.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="o">[</span>0xaaaadc760754<span class="o">]</span>&gt;<span class="w"> </span>?w<span class="w"> </span>pc
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>/home/pifan/Projects/cpp/a.out<span class="w"> </span>.text<span class="w"> </span>main,main,x3,x23,pc,d3,d23<span class="w"> </span>main<span class="w"> </span>program<span class="w"> </span>R<span class="w"> </span>X<span class="w"> </span><span class="s1">&#39;stp x29, x30, [sp, -0x20]!&#39;</span><span class="w"> </span><span class="s1">&#39;a.out&#39;</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="o">[</span>0xaaaadc760754<span class="o">]</span>&gt;<span class="w"> </span>pdf
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>x3:
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>x23:
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>pc:
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>d3:
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>d23:
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>┌<span class="w"> </span><span class="m">40</span>:<span class="w"> </span>int<span class="w"> </span>main<span class="w"> </span><span class="o">(</span>int<span class="w"> </span>argc,<span class="w"> </span>char<span class="w"> </span>**argv<span class="o">)</span><span class="p">;</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>│<span class="w">           </span><span class="p">;</span><span class="w"> </span>arg<span class="w"> </span>int<span class="w"> </span>argc<span class="w"> </span>@<span class="w"> </span>x0
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>│<span class="w">           </span><span class="p">;</span><span class="w"> </span>arg<span class="w"> </span>char<span class="w"> </span>**argv<span class="w"> </span>@<span class="w"> </span>x1
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>│<span class="w">           </span>0xaaaadc760754<span class="w"> </span>b<span class="w">    </span>fd7bbea9<span class="w">       </span>stp<span class="w"> </span>x29,<span class="w"> </span>x30,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span>-0x20<span class="o">]</span>!
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>│<span class="w">           </span>0xaaaadc760758<span class="w">      </span>fd030091<span class="w">       </span>mov<span class="w"> </span>x29,<span class="w"> </span>sp
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>│<span class="w">           </span>0xaaaadc76075c<span class="w">      </span>e01f00b9<span class="w">       </span>str<span class="w"> </span>w0,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span>0x1c<span class="o">]</span><span class="w">      </span><span class="p">;</span><span class="w"> </span>argc
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>│<span class="w">           </span>0xaaaadc760760<span class="w">      </span>e10b00f9<span class="w">       </span>str<span class="w"> </span>x1,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span>0x10<span class="o">]</span><span class="w">      </span><span class="p">;</span><span class="w"> </span>argv
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>│<span class="w">           </span>0xaaaadc760764<span class="w">      </span><span class="m">00000090</span><span class="w">       </span>adrp<span class="w"> </span>x0,<span class="w"> </span>segment.LOAD0<span class="w">  </span><span class="p">;</span><span class="w"> </span>map._home_pifan_Projects_cpp_a.out.r_x
</span><span id="__span-33-18"><a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>│<span class="w">                                                                      </span><span class="p">;</span><span class="w"> </span>0xaaaadc760000
</span><span id="__span-33-19"><a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a>│<span class="w">           </span>0xaaaadc760768<span class="w">      </span>00601e91<span class="w">       </span>add<span class="w"> </span>x0,<span class="w"> </span>x0,<span class="w"> </span>0x798
</span><span id="__span-33-20"><a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a>│<span class="w">           </span>0xaaaadc76076c<span class="w">      </span>b1ffff97<span class="w">       </span>bl<span class="w"> </span>sym.imp.puts<span class="w">         </span><span class="p">;</span><span class="w"> </span>int<span class="w"> </span>puts<span class="o">(</span>const<span class="w"> </span>char<span class="w"> </span>*s<span class="o">)</span>
</span><span id="__span-33-21"><a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a>│<span class="w">           </span>0xaaaadc760770<span class="w">      </span><span class="m">00008052</span><span class="w">       </span>mov<span class="w"> </span>w0,<span class="w"> </span><span class="m">0</span>
</span><span id="__span-33-22"><a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a>│<span class="w">           </span>0xaaaadc760774<span class="w">      </span>fd7bc2a8<span class="w">       </span>ldp<span class="w"> </span>x29,<span class="w"> </span>x30,<span class="w"> </span><span class="o">[</span>sp<span class="o">]</span>,<span class="w"> </span>0x20
</span><span id="__span-33-23"><a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a>└<span class="w">           </span>0xaaaadc760778<span class="w">      </span>c0035fd6<span class="w">       </span>ret
</span></code></pre></div>
<p>Type <code>dcc</code> to continue until call <code>bl sym.imp.puts</code>.</p>
<h2 id="putsplt">puts@plt<a class="headerlink" href="#putsplt" title="Permanent link">#</a></h2>
<p><a href="../../20230628/plt-puts-analysis/">Previously</a>, we've statically disassembled the <code>.plt</code> section using <code>objdump</code> command.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1"># objdump -j .plt -d a.out</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>$<span class="w"> </span>objdump<span class="w"> </span>--disassemble<span class="o">=</span>puts@plt<span class="w"> </span>a.out
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>a.out:<span class="w">     </span>file<span class="w"> </span>format<span class="w"> </span>elf64-littleaarch64
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>Disassembly<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span>.init:
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>Disassembly<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span>.plt:
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="m">0000000000000630</span><span class="w"> </span>&lt;puts@plt&gt;:
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="w"> </span><span class="m">630</span>:<span class="w">   </span><span class="m">90000090</span><span class="w">    </span>adrp<span class="w">    </span>x16,<span class="w"> </span><span class="m">10000</span><span class="w"> </span>&lt;__FRAME_END__+0xf770&gt;
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="w"> </span><span class="m">634</span>:<span class="w">   </span>f947e611<span class="w">    </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span><span class="c1">#4040]</span>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="w"> </span><span class="m">638</span>:<span class="w">   </span>913f2210<span class="w">    </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span><span class="c1">#0xfc8</span>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="w"> </span>63c:<span class="w">   </span>d61f0220<span class="w">    </span>br<span class="w">  </span>x17
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="w"> </span><span class="m">640</span>:<span class="w">   </span>Address<span class="w"> </span>0x0000000000000640<span class="w"> </span>is<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>bounds.
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>Disassembly<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span>.text:
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a>
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>Disassembly<span class="w"> </span>of<span class="w"> </span>section<span class="w"> </span>.fini:
</span></code></pre></div>
<p>As we can see, 0x10000+0xfc8 is the offset of <code>puts</code> in <code>.rela.plt</code> entries of <code>readelf -r a.out</code> and relocation records of <code>objdump -R a.out</code>.</p>
<p>The output of <code>rabin2 -R a.out</code> maybe more clear: the vaddr=0x00010fc8 is relative to virtual baddr, while the paddr=0x00000fc8 is relative to physical segment.</p>
<blockquote>
<p><code>ADRP Xd, label</code>: label is an offset from the page address of this instruction.</p>
</blockquote>
<div class="admonition note">
<p class="admonition-title">Intra-Procedure call scratch registers</p>
<p>Refer to <a href="../../20230601/a64-regs/">Register file of ARM64</a>, <a href="../../20230314/calling-convention/">ABI &amp; Calling conventions</a> - PCS, <a href="https://developer.arm.com/documentation/den0024/latest">ARM Cortex-A Series Programmer's Guide for ARMv8-A</a> - 9.1 Register use in the AArch64 Procedure Call Standard.</p>
<p><code>X16</code> and <code>X17</code> are registers with a special purpose, predeclared as <code>IP0</code> and <code>IP1</code>. <code>IP</code> is abbrev for Intra-Procedure-Call.<br />
These can be used by call veneers and similar code, or as temporary registers for intermediate values between subroutine calls. They are corruptible by a function.<br />
<strong>Veneers</strong> are small pieces of code which are automatically inserted by the linker, for example when the branch target is out of range of the branch instruction. The PLT stub <code>puts@plt</code> is just such a vivid type of veneer.</p>
</div>
<p>Now, continue run until <code>rsym.puts</code>/<code>sym.imp.puts</code>. Then type <code>pdf</code> to see its disassembly in real time.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="o">[</span>0xaaaadc760754<span class="o">]</span>&gt;<span class="w"> </span>dcu<span class="w"> </span>sym.imp.puts
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>INFO:<span class="w"> </span>Continue<span class="w"> </span><span class="k">until</span><span class="w"> </span>0xaaaadc760630<span class="w"> </span>using<span class="w"> </span><span class="m">4</span><span class="w"> </span>bpsize
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>INFO:<span class="w"> </span>hit<span class="w"> </span>breakpoint<span class="w"> </span>at:<span class="w"> </span>0xaaaadc760758
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>INFO:<span class="w"> </span>hit<span class="w"> </span>breakpoint<span class="w"> </span>at:<span class="w"> </span>0xaaaadc760630
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="o">[</span>0xaaaadc760630<span class="o">]</span>&gt;<span class="w"> </span>pdf
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>rsym.puts:
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>pc:
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="w">            </span><span class="p">;</span><span class="w"> </span>CALL<span class="w"> </span>XREF<span class="w"> </span>from<span class="w"> </span>main<span class="w"> </span>@<span class="w"> </span>0xaaaadc76076c<span class="o">(</span>x<span class="o">)</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>┌<span class="w"> </span><span class="m">16</span>:<span class="w"> </span>int<span class="w"> </span>sym.imp.puts<span class="w"> </span><span class="o">(</span>const<span class="w"> </span>char<span class="w"> </span>*s<span class="o">)</span><span class="p">;</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>│<span class="w">           </span>0xaaaadc760630<span class="w">      </span><span class="m">90000090</span><span class="w">       </span>adrp<span class="w"> </span>x16,<span class="w"> </span>map._home_pifan_Projects_cpp_a.out.rw_<span class="w"> </span><span class="p">;</span><span class="w"> </span>0xaaaadc770000
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>│<span class="w">           </span>0xaaaadc760634<span class="w">      </span>11e647f9<span class="w">       </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span>0xfc8<span class="o">]</span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>│<span class="w">           </span>0xaaaadc760638<span class="w">      </span>10223f91<span class="w">       </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span>0xfc8
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>└<span class="w">           </span>0xaaaadc76063c<span class="w">      </span>20021fd6<span class="w">       </span>br<span class="w"> </span>x17
</span></code></pre></div>
<p>View the disassembly against <code>puts@plt</code>, it's easy to find that <code>10000 &lt;__FRAME_END__+0xf770&gt;</code> is dynamically replaced by <code>map._home_pifan_Projects_cpp_a.out.rw_</code>.</p>
<h3 id="reloc_fixup">reloc fixup<a class="headerlink" href="#reloc_fixup" title="Permanent link">#</a></h3>
<p>The <a href="../../20230609/arm-adr-demo/">ADRP instruction</a> is used to form the PC relative address to the 4KB page. As the PC is 0xaaaadc760630, its 4K page boundary aligned address (<code>:pg_hi21:</code>) is <code>0xaaaadc760000</code>, calculated by masking out the lower 12 bits.</p>
<blockquote>
<p>0xaaaadc760000 is also the piebase and page address of the first text segment <em>LOAD0</em>. Look back to chapter <em>loaded modules</em> and <em>memory maps</em>.</p>
</blockquote>
<p>If you add the coded PC literal 0x10000 to the page address 0xaaaadc760000, it becomes <code>0xaaaadc770000</code>.</p>
<p>The above inference was based on baddr and the segment of the current <code>ADRP</code> instruction (<em>LOAD0</em>), it results in PC-relative calculation <code>x16=load0_baddr+offset</code>.</p>
<p>On the other hand, as we've already mentioned, the offset 0x10000 is the increment of vaddr over paddr for the <em>LOAD1</em> data segment where the <code>.got</code> section is located. Therefore, from the point of view of the <em>LOAD1</em> segment, the page address of the <code>.got</code> entries already matches it.</p>
<p>So it's not surprising that the <code>ADRP</code> literal is fixed as <code>map._home_pifan_Projects_cpp_a.out.rw_</code> (see <code>dm</code>) at runtime. It represents the <em>LOAD1</em> segment starting at 0xaaaadc770000. That's <code>x16=load1_baddr</code> according to the results, which is not a coincidence.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="o">[</span>0xaaaadc760630<span class="o">]</span>&gt;<span class="w"> </span>?w<span class="w"> </span>pc
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>/home/pifan/Projects/cpp/a.out<span class="w"> </span>.plt<span class="w"> </span>rsym.puts,puts,pc<span class="w"> </span>sym.imp.puts<span class="w"> </span>program<span class="w"> </span>R<span class="w"> </span>X<span class="w"> </span><span class="s1">&#39;adrp x16, 0xaaaadc770000&#39;</span><span class="w"> </span><span class="s1">&#39;a.out&#39;</span>
</span></code></pre></div>
<p>Look at the next instruction <code>ldr x17, [x16, 0xfc8]!</code>, <code>x16:0xfc8</code> is the address of GOT entry for <code>puts</code>(aka <code>reloc.puts</code>). <code>x16</code>=0xaaaadc770000+0xfc8=0xaaaadc770fc8. Then <code>x17</code> will load the value stored in pointer <code>x16</code>(0xaaaadc770fc8). It matches the output of <code>ir</code> in chapter <em>imports/relocations</em>.</p>
<h3 id="adrpldr">ADRP+LDR<a class="headerlink" href="#adrpldr" title="Permanent link">#</a></h3>
<p>Step 3 instructions and it comes to the last instruction <code>br x17</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="o">[</span>0xaaaadc760630<span class="o">]</span>&gt;<span class="w"> </span>ds<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="c1"># 3ds</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="o">[</span>0xaaaadc760630<span class="o">]</span>&gt;<span class="w"> </span>s<span class="w"> </span>pc
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>pdf
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>rsym.puts:
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="w">            </span><span class="p">;</span><span class="w"> </span>CALL<span class="w"> </span>XREF<span class="w"> </span>from<span class="w"> </span>main<span class="w"> </span>@<span class="w"> </span>0xaaaadc76076c<span class="o">(</span>x<span class="o">)</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>┌<span class="w"> </span><span class="m">16</span>:<span class="w"> </span>int<span class="w"> </span>sym.imp.puts<span class="w"> </span><span class="o">(</span>const<span class="w"> </span>char<span class="w"> </span>*s<span class="o">)</span><span class="p">;</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>│<span class="w">           </span>0xaaaadc760630<span class="w">      </span><span class="m">90000090</span><span class="w">       </span>adrp<span class="w"> </span>x16,<span class="w"> </span>map._home_pifan_Projects_cpp_a.out.rw_<span class="w"> </span><span class="p">;</span><span class="w"> </span>0xaaaadc770000
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>│<span class="w">           </span>0xaaaadc760634<span class="w">      </span>11e647f9<span class="w">       </span>ldr<span class="w"> </span>x17,<span class="w"> </span><span class="o">[</span>x16,<span class="w"> </span>0xfc8<span class="o">]</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>│<span class="w">           </span>0xaaaadc760638<span class="w">      </span>10223f91<span class="w">       </span>add<span class="w"> </span>x16,<span class="w"> </span>x16,<span class="w"> </span>0xfc8
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>│<span class="w">           </span><span class="p">;</span>--<span class="w"> </span>pc:
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>└<span class="w">           </span>0xaaaadc76063c<span class="w">      </span>20021fd6<span class="w">       </span>br<span class="w"> </span>x17
</span></code></pre></div>
<p>Check register <code>x16</code> and <code>x17</code>:</p>
<blockquote>
<p><code>ai @addr</code>: show address information</p>
</blockquote>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>ai<span class="w"> </span>@<span class="w"> </span>x16
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>program
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="nb">read</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>flag
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>reg
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>aij~<span class="o">{}</span><span class="w"> </span>@<span class="w"> </span>x16
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="o">{</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="w">  </span><span class="s2">&quot;program&quot;</span>:<span class="w"> </span><span class="s2">&quot;true&quot;</span>,
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="w">  </span><span class="s2">&quot;exec&quot;</span>:<span class="w"> </span><span class="s2">&quot;true&quot;</span>,
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="w">  </span><span class="s2">&quot;read&quot;</span>:<span class="w"> </span><span class="s2">&quot;true&quot;</span>,
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="w">  </span><span class="s2">&quot;flag&quot;</span>:<span class="w"> </span><span class="s2">&quot;true&quot;</span>,
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="w">  </span><span class="s2">&quot;func&quot;</span>:<span class="w"> </span><span class="s2">&quot;true&quot;</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="o">}</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>dr?x16<span class="w"> </span><span class="c1"># ?v $r{x16}</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>0xaaaadc770fc8
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a>
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>aij<span class="w"> </span>@<span class="w"> </span>x17
</span><span id="__span-38-18"><a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a><span class="o">{</span><span class="s2">&quot;library&quot;</span>:<span class="s2">&quot;true&quot;</span>,<span class="s2">&quot;exec&quot;</span>:<span class="s2">&quot;true&quot;</span>,<span class="s2">&quot;read&quot;</span>:<span class="s2">&quot;true&quot;</span>,<span class="s2">&quot;flag&quot;</span>:<span class="s2">&quot;true&quot;</span>,<span class="s2">&quot;reg&quot;</span>:<span class="s2">&quot;true&quot;</span><span class="o">}</span>
</span><span id="__span-38-19"><a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>dr<span class="w"> </span>x17<span class="w"> </span><span class="c1"># ?v $r:x17</span>
</span><span id="__span-38-20"><a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a>0xffff9832ae70
</span></code></pre></div>
<p>Show whatis and telescope of <code>x16</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>?w<span class="w"> </span>x16
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>/home/pifan/Projects/cpp/a.out<span class="w"> </span>.got<span class="w"> </span>reloc.puts,x16,d16<span class="w"> </span>program<span class="w"> </span>R<span class="w"> </span>0xffff9832ae70
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>drr~x16
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">     </span>x16<span class="w">    </span>0xaaaadc770fc8<span class="w">     </span>/home/pifan/Projects/cpp/a.out<span class="w"> </span>.got<span class="w"> </span>reloc.puts,x16,d16<span class="w"> </span>program<span class="w"> </span>R<span class="w"> </span>0xffff9832ae70
</span></code></pre></div>
<p>Hexdump and try to dereference <code>x16</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c1"># pvp @ x16 # pv8 @ x16</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>pv<span class="w"> </span>@<span class="w"> </span>x16<span class="w"> </span><span class="c1"># pv @ 0xaaaadc770fc8</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>0x0000ffff9cbbae70
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="c1"># printf quadword: pf1q @ x16</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="c1"># pointer reference with label: pfp puts_addr @ x16</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="c1"># 64bit pointer to string: pfS @ x16</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="c1"># show hexadecimal quad-words dump: pxq $w @ x16</span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>xQ<span class="w"> </span><span class="nv">$w</span><span class="w"> </span>@<span class="w"> </span>x16
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a>0xaaaadc770fc8<span class="w">  </span>0x0000ffff9832ae70<span class="w"> </span>x17
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>xr<span class="w"> </span><span class="nv">$w</span><span class="w"> </span>@<span class="w"> </span>x16
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a>0xaaaadc770fc8<span class="w">  </span>0x0000ffff9832ae70<span class="w">   </span>p.......<span class="w"> </span>@<span class="w"> </span>d16<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span>x17,d17<span class="w"> </span>library<span class="w"> </span>R<span class="w"> </span>X<span class="w"> </span><span class="s1">&#39;stp x29, x30, [sp, -0x40]!&#39;</span><span class="w"> </span><span class="s1">&#39;libc.so.6&#39;</span>
</span></code></pre></div>
<p>Actually, when <em>libc.so</em> is loaded, the value of the pointer is immediately updated from <code>0x00000000000005d0</code> to <code>0x0000ffff9832ae70</code>.</p>
<blockquote>
<p>The <code>dbw</code> command is provided to add watchpoints. However, it doesn't work as well as expected, see related <a href="https://github.com/radareorg/radare2/issues/11029">issue</a>.</p>
</blockquote>
<p>Show whatis and telescope of <code>x17</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>?w<span class="w"> </span>x17
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span>x17,d17<span class="w"> </span>library<span class="w"> </span>R<span class="w"> </span>X<span class="w"> </span><span class="s1">&#39;stp x29, x30, [sp, -0x40]!&#39;</span><span class="w"> </span><span class="s1">&#39;libc.so.6&#39;</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>drr~x17
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">     </span>x17<span class="w">    </span>0xffff9832ae70<span class="w">     </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span>x17,d17<span class="w"> </span>library<span class="w"> </span>R<span class="w"> </span>X<span class="w"> </span><span class="s1">&#39;stp x29, x30, [sp, -0x40]!&#39;</span><span class="w"> </span><span class="s1">&#39;libc.so.6&#39;</span>
</span></code></pre></div>
<p>Attempt to analyze instruction resides in <code>x17</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>pfD<span class="w"> </span>@<span class="w"> </span>x17<span class="w"> </span><span class="c1"># pi 1 @ x17</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>stp<span class="w"> </span>x29,<span class="w"> </span>x30,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span>-0x40<span class="o">]</span>!
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>pd<span class="w"> </span><span class="m">1</span><span class="w"> </span>@<span class="w"> </span>x17
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>x17:
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>d17:
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="w">            </span>0xffffa5e1ae70<span class="w">      </span>fd7bbca9<span class="w">       </span>stp<span class="w"> </span>x29,<span class="w"> </span>x30,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span>-0x40<span class="o">]</span>!
</span></code></pre></div>
<h3 id="br_x17">br x17<a class="headerlink" href="#br_x17" title="Permanent link">#</a></h3>
<p>Type <code>dmi</code> to list symbols of <code>libc.so</code> and grep symbol <code>puts</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span><span class="c1"># dmi libc ~..</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>dmi<span class="w"> </span>libc<span class="w"> </span>~puts<span class="w"> </span><span class="c1"># dmi libc puts ~ puts$</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="o">[</span>Symbols<span class="o">]</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>nth<span class="w"> </span>paddr<span class="w">      </span>vaddr<span class="w">          </span><span class="nb">bind</span><span class="w">   </span><span class="nb">type</span><span class="w">  </span>size<span class="w">  </span>lib<span class="w"> </span>name
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="m">1400</span><span class="w"> </span>0x0006ae70<span class="w"> </span>0xffff9832ae70<span class="w"> </span>WEAK<span class="w">   </span>FUNC<span class="w"> </span><span class="m">492</span><span class="w">       </span>puts
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="m">1409</span><span class="w"> </span>0x0006ae70<span class="w"> </span>0xffff9832ae70<span class="w"> </span>GLOBAL<span class="w"> </span>FUNC<span class="w"> </span><span class="m">492</span><span class="w">       </span>_IO_puts
</span></code></pre></div>
<p>The symbol <code>puts</code>(@GLIBC_2.17) is located exactly at <code>0xffff9832ae70</code>! Moreover, it's located between 0x0000ffff982c0000<code>-</code>0x0000ffff98448000, to which the text segment <em>LOAD0</em> is mapped.</p>
<p>Set a breakpoint at puts/0xffff9832ae70 and continue.</p>
<ul>
<li><a href="https://github.com/radareorg/radare2/issues/12811">Cannot set breakpoints · Issue #12811</a></li>
<li><a href="https://reverseengineering.stackexchange.com/questions/13689/radare2-noob-question-cant-set-breakpoint">Radare2 can't set breakpoint?</a></li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>db<span class="w"> </span>puts
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>WARN:<span class="w"> </span>base<span class="w"> </span>addr<span class="w"> </span>should<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>larger<span class="w"> </span>than<span class="w"> </span>the<span class="w"> </span>breakpoint<span class="w"> </span>address
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>WARN:<span class="w"> </span>Cannot<span class="w"> </span><span class="nb">set</span><span class="w"> </span>breakpoint<span class="w"> </span>outside<span class="w"> </span>maps.<span class="w"> </span>Use<span class="w"> </span>dbg.bpinmaps<span class="w"> </span>to<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>e<span class="w"> </span>dbg.bpinmaps
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="nb">true</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>db<span class="w"> </span>x17<span class="p">;</span><span class="w"> </span>dc
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>INFO:<span class="w"> </span>hit<span class="w"> </span>breakpoint<span class="w"> </span>at:<span class="w"> </span>0xffff9832ae70
</span></code></pre></div>
<p>The last instruction <code>br x17</code> jumps to <code>0xffff9832ae70</code>, which slides into <code>puts</code> in <em>libc.so</em>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="o">[</span>0xffff9832ae70<span class="o">]</span>&gt;<span class="w"> </span>dm.
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>0x0000ffff982c0000<span class="w"> </span>-<span class="w"> </span>0x0000ffff98448000<span class="w"> </span>-<span class="w"> </span>usr<span class="w">   </span><span class="m">1</span>.5M<span class="w"> </span>s<span class="w"> </span>r-x<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="o">[</span>0xffff9832ae70<span class="o">]</span>&gt;<span class="w"> </span>pdf
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>ERROR:<span class="w"> </span>Cannot<span class="w"> </span>find<span class="w"> </span><span class="k">function</span><span class="w"> </span>at<span class="w"> </span>0xffff9832ae70
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="c1"># analyze function at current address($$)</span>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="o">[</span>0xffff9832ae70<span class="o">]</span>&gt;<span class="w"> </span>af<span class="p">;</span><span class="w"> </span>pdf
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>x17:
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>d17:
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w">            </span><span class="p">;</span>--<span class="w"> </span>pc:
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a>┌<span class="w"> </span><span class="m">424</span>:<span class="w"> </span>fcn.ffff9799ae70<span class="w"> </span><span class="o">(</span>int64_t<span class="w"> </span>arg1<span class="o">)</span><span class="p">;</span>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a>│<span class="w">           </span><span class="p">;</span><span class="w"> </span>arg<span class="w"> </span>int64_t<span class="w"> </span>arg1<span class="w"> </span>@<span class="w"> </span>x0
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a>│<span class="w">           </span><span class="p">;</span><span class="w"> </span>var<span class="w"> </span>int64_t<span class="w"> </span>var_10h<span class="w"> </span>@<span class="w"> </span>sp+0x10
</span><span id="__span-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a>│<span class="w">           </span><span class="p">;</span><span class="w"> </span>var<span class="w"> </span>int64_t<span class="w"> </span>var_20h<span class="w"> </span>@<span class="w"> </span>sp+0x20
</span><span id="__span-45-15"><a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>│<span class="w">           </span><span class="p">;</span><span class="w"> </span>var<span class="w"> </span>int64_t<span class="w"> </span>var_30h<span class="w"> </span>@<span class="w"> </span>sp+0x30
</span><span id="__span-45-16"><a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a>│<span class="w">           </span>0xffff9832ae70<span class="w"> </span>b<span class="w">    </span>fd7bbca9<span class="w">       </span>stp<span class="w"> </span>x29,<span class="w"> </span>x30,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span>-0x40<span class="o">]</span>!
</span><span id="__span-45-17"><a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a>│<span class="w">           </span>0xffff9832ae74<span class="w">      </span>fd030091<span class="w">       </span>mov<span class="w"> </span>x29,<span class="w"> </span>sp
</span><span id="__span-45-18"><a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a>│<span class="w">           </span>0xffff9832ae78<span class="w">      </span>f35301a9<span class="w">       </span>stp<span class="w"> </span>x19,<span class="w"> </span>x20,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span>0x10<span class="o">]</span>
</span><span id="__span-45-19"><a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a>│<span class="w">           </span>0xffff9832ae7c<span class="w">      </span><span class="m">94090090</span><span class="w">       </span>adrp<span class="w"> </span>x20,<span class="w"> </span>0xffff9845a000<span class="w"> </span><span class="p">;</span><span class="w"> </span>d24
</span><span id="__span-45-20"><a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a>│<span class="w">           </span>0xffff9832ae80<span class="w">      </span>f55b02a9<span class="w">       </span>stp<span class="w"> </span>x21,<span class="w"> </span>x22,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span>0x20<span class="o">]</span>
</span><span id="__span-45-21"><a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a>│<span class="w">           </span>0xffff9832ae84<span class="w">      </span>f60300aa<span class="w">       </span>mov<span class="w"> </span>x22,<span class="w"> </span>x0
</span><span id="__span-45-22"><a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a>│<span class="w">           </span>0xffff9832ae88<span class="w">      </span>f76303a9<span class="w">       </span>stp<span class="w"> </span>x23,<span class="w"> </span>x24,<span class="w"> </span><span class="o">[</span>sp,<span class="w"> </span>0x30<span class="o">]</span>
</span><span id="__span-45-23"><a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a>│<span class="w">           </span>0xffff9832ae8c<span class="w">      </span>8dba0094<span class="w">       </span>bl<span class="w"> </span>0xffff983598c0
</span><span id="__span-45-24"><a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a>
</span><span id="__span-45-25"><a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a><span class="w">            </span><span class="o">[</span>...snip...<span class="o">]</span>
</span></code></pre></div>
<p>Type <code>dc</code> to continue to the end.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="o">[</span>0xffff9832ae70<span class="o">]</span>&gt;<span class="w"> </span>dc
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>Hello,<span class="w"> </span>Linux!
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="o">(</span><span class="m">501878</span><span class="o">)</span><span class="w"> </span>Process<span class="w"> </span>exited<span class="w"> </span>with<span class="w"> </span><span class="nv">status</span><span class="o">=</span>0x0
</span></code></pre></div>
<h2 id="putsglibc">puts@GLIBC<a class="headerlink" href="#putsglibc" title="Permanent link">#</a></h2>
<p>Although everything is clear, we can do some confirmation from the shared library perspective.</p>
<p>Let's look up symbol <code>puts</code> in libc.so.6, the weak symbol <code>puts</code> will be overriden by the global symbol <code>_IO_puts</code>.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>!nm<span class="w"> </span>-gD<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>puts
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>000000000006ae70<span class="w"> </span>T<span class="w"> </span>_IO_puts@@GLIBC_2.17
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>000000000006ae70<span class="w"> </span>W<span class="w"> </span>puts@@GLIBC_2.17
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>!readelf<span class="w"> </span>-s<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>puts
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="w">   </span>Num:<span class="w">    </span>Value<span class="w">          </span>Size<span class="w"> </span>Type<span class="w">    </span>Bind<span class="w">   </span>Vis<span class="w">      </span>Ndx<span class="w"> </span>Name
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="w">  </span><span class="m">1400</span>:<span class="w"> </span>000000000006ae70<span class="w">   </span><span class="m">492</span><span class="w"> </span>FUNC<span class="w">    </span>WEAK<span class="w">   </span>DEFAULT<span class="w">   </span><span class="m">12</span><span class="w"> </span>puts@@GLIBC_2.17
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="w">  </span><span class="m">1409</span>:<span class="w"> </span>000000000006ae70<span class="w">   </span><span class="m">492</span><span class="w"> </span>FUNC<span class="w">    </span>GLOBAL<span class="w"> </span>DEFAULT<span class="w">   </span><span class="m">12</span><span class="w"> </span>_IO_puts@@GLIBC_2.17
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a>
</span><span id="__span-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>!objdump<span class="w"> </span>-t<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libc.so.6<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>puts
</span><span id="__span-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a>
</span><span id="__span-47-15"><a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a>000000000006ae70<span class="w">  </span>w<span class="w">    </span>F<span class="w"> </span>.text<span class="w">  </span>00000000000001ec<span class="w"> </span>puts
</span><span id="__span-47-16"><a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a>000000000006ae70<span class="w"> </span>g<span class="w">     </span>F<span class="w"> </span>.text<span class="w">  </span>00000000000001ec<span class="w"> </span>_IO_puts
</span></code></pre></div>
<p>The value of the symbol <code>puts</code> is <code>000000000006ae70</code>, which is the static absolute paddr and will be adjusted to vaddr when loaded into memory.</p>
<p>Keep in mind the principle <code>VA = baddr+offset/RVA</code>.</p>
<p>According to the latest <code>dm</code> output(linkmap), the <em>Load Bias</em> of libc.so is 0xffff982c0000. It's also the start address of text segment <em>LOAD0</em> according to the latest <code>dmm</code> output(vmmap).</p>
<p>Add the paddr/offset to the baddr/bias to check the correctness of the formula.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>rax2<span class="w"> </span>-k<span class="w"> </span>0xffff982c0000+0x6ae70
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="o">[</span>0xaaaadc76063c<span class="o">]</span>&gt;<span class="w"> </span>?v<span class="w"> </span>0xffff982c0000+0x6ae70<span class="w"> </span><span class="c1"># ?v x17</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>0xffff9832ae70
</span></code></pre></div>
<p>The result is entirely consistent with our earlier research.</p>
<p>Nothing is out of the ordinary. Everything is working out as expected.</p>







  
  



  


  



  <h2 id="__comments">评论</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
    data-repo="fan2/mkdocs"
    data-repo-id="R_kgDOLltxSg"
    data-category="Announcements"
    data-category-id="DIC_kwDOLltxSs4CeURH"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../../20230629/plt-puts-pwndbg/" class="md-footer__link md-footer__link--prev" aria-label="上一页: reloc puts@plt via GOT - pwndbg">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                reloc puts@plt via GOT - pwndbg
              </div>
            </div>
          </a>
        
        
          
          <a href="../../20231001/sre-toolkit/" class="md-footer__link md-footer__link--next" aria-label="下一页: Software Reverse Engineering Toolkits">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Software Reverse Engineering Toolkits
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024- Cliff Fan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["toc.follow", "header.autohide", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.tracking", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://vercount.one/js"></script>
      
    
  </body>
</html>