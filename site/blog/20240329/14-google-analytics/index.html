
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="在别处或在路上">
      
      
        <meta name="author" content="Cliff Fan">
      
      
        <link rel="canonical" href="https://duetorun.com/blog/20240329/14-google-analytics/">
      
      
        <link rel="prev" href="../13-github-giscus/">
      
      
      
      <link rel="icon" href="../../../assets/hold_yourself.jpg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.15">
    
    
      
        <title>为Material博客添加Google Analytics和Vercount访问统计 - ElseWhere</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-XGW41EGL31"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-XGW41EGL31",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-XGW41EGL31",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#google_analytics" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="ElseWhere" class="md-header__button md-logo" aria-label="ElseWhere" data-md-component="logo">
      
  <img src="../../../assets/hold_yourself.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ElseWhere
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              为Material博客添加Google Analytics和Vercount访问统计
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8v2m9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../link/" class="md-tabs__link">
        
  
    
  
  Link

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ElseWhere" class="md-nav__button md-logo" aria-label="ElseWhere" data-md-component="logo">
      
  <img src="../../../assets/hold_yourself.jpg" alt="logo">

    </a>
    ElseWhere
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2017/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2017
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2015/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2015
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/macos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/material/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    material
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/mkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/nginx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nginx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/vim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/webdav/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    webDAV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/wiki/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wiki
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/zsh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    zsh
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../link/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Link
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#google_analytics" class="md-nav__link">
    <span class="md-ellipsis">
      Google Analytics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Google Analytics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set_up_measurement" class="md-nav__link">
    <span class="md-ellipsis">
      Set up measurement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#admin_reports" class="md-nav__link">
    <span class="md-ellipsis">
      Admin Reports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reporting_api" class="md-nav__link">
    <span class="md-ellipsis">
      Reporting API
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#google_search" class="md-nav__link">
    <span class="md-ellipsis">
      Google Search
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Google Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add_a_property" class="md-nav__link">
    <span class="md-ellipsis">
      Add a property
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#link_account_to_analytics" class="md-nav__link">
    <span class="md-ellipsis">
      link account to analytics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloudflare_crawler_hints_indexnow" class="md-nav__link">
    <span class="md-ellipsis">
      Cloudflare Crawler Hints: IndexNow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#meta_tag_robots_customize_indexing_policies" class="md-nav__link">
    <span class="md-ellipsis">
      meta tag robots: customize indexing policies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#busuanzivercount_pageviews_counter" class="md-nav__link">
    <span class="md-ellipsis">
      busuanzi/vercount pageviews counter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="busuanzi/vercount pageviews counter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#首页统计总访问量" class="md-nav__link">
    <span class="md-ellipsis">
      首页统计总访问量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#博客文章阅读量" class="md-nav__link">
    <span class="md-ellipsis">
      博客文章阅读量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#替换为_vercount" class="md-nav__link">
    <span class="md-ellipsis">
      替换为 Vercount
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://duetorun.com/assets/carve_yourself.jpg" alt="Cliff Fan">
                    </span>
                    <span class="md-profile__description">
                      <strong>
                        
                          Cliff Fan
                        
                      </strong>
                      <br>
                      Just do IT
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                        <time datetime="2024-03-29 17:00:00" class="md-ellipsis">2024年3月29日</time>
                      </div>
                    </li>
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 13h1.5v2.82l2.44 1.41-.75 1.3L15 16.69V13m4-5H5v11h4.67c-.43-.91-.67-1.93-.67-3a7 7 0 0 1 7-7c1.07 0 2.09.24 3 .67V8M5 21a2 2 0 0 1-2-2V5c0-1.11.89-2 2-2h1V1h2v2h8V1h2v2h1a2 2 0 0 1 2 2v6.1c1.24 1.26 2 2.99 2 4.9a7 7 0 0 1-7 7c-1.91 0-3.64-.76-4.9-2H5m11-9.85A4.85 4.85 0 0 0 11.15 16c0 2.68 2.17 4.85 4.85 4.85A4.85 4.85 0 0 0 20.85 16c0-2.68-2.17-4.85-4.85-4.85Z"/></svg>
                          <time datetime="2024-04-02 08:30:00" class="md-ellipsis">2024年4月2日</time>
                        </div>
                      </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                          <span class="md-ellipsis">
                            分类于
                            
                              <a href="../../category/mkdocs/">mkdocs</a>, 
                              <a href="../../category/material/">material</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg>
                          <span class="md-ellipsis">
                            
                              需要 5 分钟阅读时间
                            
                          </span>
                        </div>
                      </li>
                    
                    <!-- Add by Cliff.Fan, 29Mar24. -->
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 1-5 5v11l5-4.5V1m2 4v13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V6c-1.45-1.1-3.55-1.5-5.5-1.5-1.95 0-4.05.4-5.5 1.5v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1M10 18.41C8.75 18.09 7.5 18 6.5 18c-1.06 0-2.32.19-3.5.5V7.13c.91-.4 2.14-.63 3.5-.63 1.36 0 2.59.23 3.5.63v11.28Z"/></svg>
                        <span class="md-ellipsis" id="busuanzi_container_page_pv">
                          阅读量：<span id="busuanzi_value_page_pv">N/A</span>
                        </span>
                      </div>
                    </li>
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  
  

<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">analytics</span>
    
  
    
    
    
      <span class="md-tag">search</span>
    
  
    
    
    
      <span class="md-tag">pageviews</span>
    
  
</nav>



  <h1>为Material博客添加Google Analytics和Vercount访问统计</h1>

<p>本文简要记录了为 Mkdocs Material Blog 添加 Google Analytics 统计分析服务。</p>
<p><a href="https://squidfunk.github.io/mkdocs-material/setup/setting-up-site-analytics/">Setting up site analytics</a>: As with any other service offered on the web, understanding how your project documentation is actually used can be an essential success factor. Material for MkDocs natively integrates with <a href="https://developers.google.com/analytics">Google Analytics</a> and offers a customizable cookie consent and a feedback widget.</p>
<!-- more -->

<h2 id="google_analytics">Google Analytics<a class="headerlink" href="#google_analytics" title="Permanent link">#</a></h2>
<p><a href="https://www.google.com/analytics/">Google Analytics</a> - <a href="https://marketingplatform.google.com/about/analytics/">marketingplatform</a></p>
<p><a href="https://analytics.google.com/analytics/web/">Google Analytics</a> @<a href="https://analytics.google.com/analytics/web/?hl=zh-CN">zh-cn</a></p>
<p><a href="https://support.google.com/analytics?hl=en&amp;sjid=9594711740567622827-AP#topic=14090456">Analytics Help</a> @<a href="https://support.google.com/analytics/?hl=zh-Hans&amp;sjid=9594711740567622827-AP#topic=14090456">zh-cn</a></p>
<p><a href="https://developers.google.com/analytics/devguides/collection/ga4">Google Analytics Guides</a> @<a href="https://developers.google.com/analytics/devguides/collection/ga4?hl=zh-cn">zh-cn</a></p>
<div class="admonition abstract">
<p class="admonition-title">Google Analytics 4</p>
<p>Google Analytics（分析）4 是一项分析服务，用于衡量您的网站和应用中的流量和互动情况。本文档提供了面向开发者群体的实现说明和参考资料。</p>
</div>
<p>参考：<a href="https://support.google.com/blogger/answer/7039627">将 Google Analytics（分析）与 Blogger 结合使用</a>。</p>
<h3 id="set_up_measurement">Set up measurement<a class="headerlink" href="#set_up_measurement" title="Permanent link">#</a></h3>
<p>进入 <a href="https://analytics.google.com/">Google Analytics</a>，使用 google 账号登录，然后点击 Set up measurement，按照提示开始创建评估账号。</p>
<ol>
<li>Account creation: 填写名称</li>
<li>Property creation: 填写名称</li>
<li>Business details: 选择 Internet &amp; Telecom, 1-10</li>
<li>Business objectives: 选择 Get baseline reports</li>
<li>Data collection: Web - Set up data stream</li>
</ol>
<p>填写 site_url &amp; site_name 后，获得 MEASUREMENT ID: <code>G-XXXXXXXXXX</code>。</p>
<p>在 mkdocs.yml 中添加配置即可：</p>
<div class="language-YAML highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">extra</span><span class="p">:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="nt">analytics</span><span class="p">:</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">google</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="nt">property</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">G-XXXXXXXXXX</span>
</span></code></pre></div>
<h3 id="admin_reports">Admin Reports<a class="headerlink" href="#admin_reports" title="Permanent link">#</a></h3>
<p>后续登录进入 <a href="https://analytics.google.com/analytics/">Analytics | Home</a>，即可查看对应 Account | Property 的流量统计分析数据。</p>
<p>点击左侧边栏最下方的 ⚙️ 按钮进入 Admin 管理页面，在 Data streams 中点选站点，可以看到 MEASUREMENT ID，默认已经开启 Events | Enhanced Measurement，包括 <code>Page views</code> 和 <code>Site search</code>。</p>
<p>点击左侧边栏的第二个 Reports 按钮，进入面板可以看到报告快照（Reports snapshot），还可查看其他详细指标：</p>
<ol>
<li><code>Acquisition</code>（获客）: User acquisition（用户获取情况），Traffic acquisition（流量来源情况）；</li>
<li><code>Engagement</code>（参与度）: pages and screens, WHICH PAGES AND SCREENS GET THE MOST VIEWS?</li>
<li><code>Retention</code>（留存）: HOW WELL DO YOU RETAIN YOUR USERS?</li>
</ol>
<h3 id="reporting_api">Reporting API<a class="headerlink" href="#reporting_api" title="Permanent link">#</a></h3>
<p>可以借助 Google Analytics 提供的 Reporting API 将管理后台的数据拉取到网站前端，从而实现显示文章访问、阅读数量等功能。</p>
<p><a href="https://developers.google.com/analytics/devguides/collection/ga4/views?client_type=gtag">Measure pageviews  |  Google Analytics  |  Google for Developers</a></p>
<p><a href="https://support.google.com/analytics/answer/9304153">GA4 - Set up Analytics for a website and/or app - Analytics Help</a> - Set up data collection for websites</p>
<p><a href="https://developers.google.com/analytics/devguides/reporting/core/v4">Reporting API V4</a>，<a href="https://developers.google.com/analytics/devguides/reporting/core/v4/rest">Analytics Reporting API v4</a> &amp; <a href="https://developers.google.com/analytics/devguides/reporting/core/v4/samples">Samples</a></p>
<ul>
<li><a href="https://blog.naibabiji.com/tutorial/google-analytics.html">自己建网站怎么添加Google Analytics统计代码查看每日流量</a></li>
<li><a href="https://prinsss.github.io/google-analytics-api-page-views-counter/">使用 Google Analytics API 实现博客阅读量统计 - PRIN BLOG</a></li>
<li><a href="https://spencer-blog-legacy.vercel.app/2020/06/serverless-ga-hit-count-api/">用 Google Analytics + Vercel Serverless 为文章添加浏览量统计</a></li>
</ul>
<h2 id="google_search">Google Search<a class="headerlink" href="#google_search" title="Permanent link">#</a></h2>
<p><a href="https://search.google.com/search-console">Google Search Console</a> @<a href="https://search.google.com/search-console?hl=zh">zh-cn</a></p>
<p><a href="https://support.google.com/webmasters?hl=en&amp;sjid=9594711740567622827-AP#topic=9128571">Search Console Help</a> @<a href="https://support.google.com/webmasters?hl=zh-Hans&amp;sjid=9594711740567622827-AP#topic=9128571">zh-cn</a></p>
<div class="admonition abstract">
<p class="admonition-title">Google Search Console</p>
<p>Google Search Console 是一项由 Google 提供的免费服务，可帮助您监控和维护您的网站在 Google 搜索结果中的展示情况以及排查问题。即使没有注册 Search Console，您的网页也可能会显示在 Google 搜索结果中，但 Search Console 可帮助您了解并改进 Google 处理您网站的方式。</p>
</div>
<p>参考：<a href="https://zoharandroid.github.io/2019-08-03-%E8%AE%A9%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2%E5%88%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/">让Google搜索到自己的博客</a>、<a href="https://juejin.cn/post/6844903600485826567">Hexo 个人博客 SEO 优化（3）：改造你的博客，提升搜索引擎排名</a>。</p>
<h3 id="add_a_property">Add a property<a class="headerlink" href="#add_a_property" title="Permanent link">#</a></h3>
<ol>
<li>查看网站是否被收录: 搜索框输入 site:duetorun.com</li>
<li>在 <a href="https://search.google.com/search-console">Google Search Console</a> 提交搜索资源（Add a property），选择网址前缀，将生成的 html 文件下载放到网站根目录，点击 <a href="https://support.google.com/webmasters/answer/9008080#google_analytics_verification&amp;zippy=%2Cgoogle-analytics%E5%88%86%E6%9E%90%E8%B7%9F%E8%B8%AA%E4%BB%A3%E7%A0%81">验证网站所有权</a>。</li>
</ol>
<div class="admonition note">
<p class="admonition-title">其他验证方法</p>
<ol>
<li>HTML 标记：向您网站的首页添加元标记</li>
<li>Google Analytics（分析）：使用您的 Google Analytics（分析）账号，涉及到 <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/">analytics.js</a> 或 <a href="https://support.google.com/analytics/answer/1008080">gtag.js</a></li>
<li>Google 跟踪代碍管理器：使用您的 Google 跟踪代码管理器账号</li>
<li>域名提供商：将 DNS 记录与 Google 关联</li>
</ol>
</div>
<ol start="3">
<li>提交站点地图：Indexing - Sitemaps 上传 site/sitemap.xml。如果没有 sitemap.xml，可到 <a href="https://www.xml-sitemaps.com/">xml-sitemaps</a> 输入网址生成。</li>
<li>手动请求（重新）编入索引：网址检查（URL inspection）输入博客网址，然后点击 测试实际版本（TEST LIVE URL），请求编入索引（REQUEST INDEXING）。</li>
</ol>
<div class="admonition info">
<p>编制索引：正在处理数据，请过 1 天左右再来查看<br />
Indexing - Pages : Processing data, please check again in a day or so</p>
</div>
<h3 id="link_account_to_analytics">link account to analytics<a class="headerlink" href="#link_account_to_analytics" title="Permanent link">#</a></h3>
<p>回到 <a href="https://analytics.google.com/analytics/">Analytics | Home</a>，检测到本 Google 账号注册了 Google Search Console，推荐关联账号。</p>
<div class="admonition note">
<p class="admonition-title">RECOMMENDATION: Link Account</p>
<p>Link your Search Console property "https://duetorun.com/" to analyze how search behavior relates to on-site behavior</p>
<p>Recommended because you are a verified owner of your Search Console property and you have at least the editor role in Analytics</p>
</div>
<p>点击 Link Account 链接，将打开 Admin 面板，并自动定位到 Product links 底下新增项 <code>Search console links</code>。</p>
<p>点击右侧的 Link 链接按钮，开始 Link setup 流程。</p>
<ol>
<li>
<p><code>Choose Search Console property</code>：点开 Choose accounts -- Link to a property I manage，勾选列出的 property，点击 Confirm。</p>
</li>
<li>
<p>点击 Next，<code>Select Web Stream</code>：Choose a data stream，勾选列出的 data stream。</p>
</li>
<li>
<p>点击 Next，<code>Review and submit</code>，确认前两步的选择，没有问题点击 Submit 提交。</p>
</li>
<li>
<p>Results 显示 LINK CREATED。</p>
</li>
</ol>
<p>返回到 Search Console links，可以看到关联的结果。</p>
<h2 id="cloudflare_crawler_hints_indexnow">Cloudflare Crawler Hints: IndexNow<a class="headerlink" href="#cloudflare_crawler_hints_indexnow" title="Permanent link">#</a></h2>
<p><a href="https://developers.cloudflare.com/cache/advanced-configuration/crawler-hints/">Crawler Hints · Cloudflare Cache (CDN) docs</a></p>
<div class="admonition abstract">
<p class="admonition-title">Crawler Hints</p>
<p>Crawler Hints provide high quality data to search engines and other crawlers when sites using Cloudflare change their content. This allows crawlers to precisely time crawling, avoid wasteful crawls, and generally reduce resource consumption on origins and other Internet infrastructure.</p>
</div>
<p>登录进入 <a href="https://dash.cloudflare.com/">Cloudflare Dash</a>，仪表盘定位 Websites，显示可用域名（站点），点击当前站点域名。<br />
仪表盘点击 Caching - Configuration，Crawler Hints 点击开启。</p>
<ul>
<li><a href="https://blog.cloudflare.com/cloudflare-now-supports-indexnow">Crawler Hints Update: Cloudflare Supports IndexNow and Announces General Availability</a></li>
<li><a href="https://searchengineland.com/60000-websites-using-cloudflare-turned-on-indexnow-376579">60,000 websites using Cloudflare turned on IndexNow</a></li>
</ul>
<h2 id="meta_tag_robots_customize_indexing_policies">meta tag robots: customize indexing policies<a class="headerlink" href="#meta_tag_robots_customize_indexing_policies" title="Permanent link">#</a></h2>
<p><a href="https://squidfunk.github.io/mkdocs-material/reference/#using-metadata-in-templates">Using metadata in templates</a></p>
<p>In order to add custom meta tags to your document, you can extend the theme and override the <code>extrahead</code> block, e.g. to add indexing policies for search engines via the <code>robots</code> property.</p>
<p>复制 templates/main.html 到 overrides/main.html，在其中添加以下内容：</p>
<div class="language-html highlight"><span class="filename">apply meta.robots if specified</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>{% block extrahead %}
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>  {% if page and page.meta and page.meta.robots %}
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;robots&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;{{ page.meta.robots }}&quot;</span> <span class="p">/&gt;</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  {% endif %}
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>{% endblock %}
</span></code></pre></div>
<p>这样，通过在页面头部设置元数据即可定制robots抓捕策略。</p>
<p>例如在 about 页面头部添加元数据禁止（Disallow）搜索引擎抓捕：</p>
<div class="language-Markdown highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>---
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="gu">robots: noindex, nofollow</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="gu">---</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>...
</span></code></pre></div>
<p>其他页面未指定robots策略，采取的是默认的“法无禁止即可为”的开放（Allow）抓取策略。</p>
<div class="admonition info">
<p class="admonition-title">Google Search Central</p>
<ul>
<li><a href="https://developers.google.com/search/docs/crawling-indexing/robots-meta-tag">Robots Meta Tags Specifications</a></li>
<li><a href="https://developers.google.com/search/docs/crawling-indexing/robots/intro">Robots.txt Introduction and Guide</a></li>
<li><a href="https://developers.google.com/search/docs/crawling-indexing/robots/create-robots-txt">Create and Submit a robots.txt File</a></li>
</ul>
</div>
<h2 id="busuanzivercount_pageviews_counter">busuanzi/vercount pageviews counter<a class="headerlink" href="#busuanzivercount_pageviews_counter" title="Permanent link">#</a></h2>
<p>百度统计，谷歌分析等网站统计分析工具，虽然有不错的统计分析功能，但是都不能直接呈现在网站上，都需要进入相应的后台才能查看。</p>
<p>这里尝试使用 <a href="https://busuanzi.ibruce.info/">不蒜子</a> 提供的统计脚本，将访客人数、访问量统计呈现在自己的网站上。</p>
<ul>
<li><a href="https://blog.csdn.net/weixin_43919632/article/details/101086922">不蒜子实现网站访问量访客数统计</a></li>
<li><a href="https://blog.csdn.net/arnolan/article/details/105026738">MkDocs实现网站访问统计(不蒜子)</a></li>
</ul>
<p>首先在引入脚本，直接在线嵌入或下载到本地：</p>
<div class="language-YAML highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nt">extra_javascript</span><span class="p">:</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="c1"># busuanzi statistics</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="c1"># //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">javascripts/busuanzi.pure.mini.js</span>
</span></code></pre></div>
<h3 id="首页统计总访问量">首页统计总访问量<a class="headerlink" href="#首页统计总访问量" title="Permanent link">#</a></h3>
<p>在站点首页 index.md 末尾添加 <code>本站总访问量</code> 和 <code>总访客数</code> 的统计：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_container_site_pv&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;font-size:0.8em;color=grey&quot;</span><span class="p">&gt;</span>本站总访问量 <span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_value_site_pv&quot;</span><span class="p">&gt;</span>pv<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>，<span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_container_site_uv&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;font-size:0.8em;color=grey&quot;</span><span class="p">&gt;</span>总访客数 <span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_value_site_uv&quot;</span><span class="p">&gt;</span>uv<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>。<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></code></pre></div>
<p>本地调试时，这个统计貌似错乱，上线确认 OK。</p>
<div class="admonition note">
<p>也可考虑将 templates/partials/copyright.html 复制一份到 overrides/partials/ 下，将站点全局计数显示在底栏中间部位。</p>
</div>
<h3 id="博客文章阅读量">博客文章阅读量<a class="headerlink" href="#博客文章阅读量" title="Permanent link">#</a></h3>
<p><a href="https://squidfunk.github.io/mkdocs-material/setup/setting-up-a-blog/#overriding-templates">Overriding templates</a></p>
<p>The following templates are added by the built-in blog plugin:</p>
<ul>
<li>blog.html – Template for blog, archive and category index</li>
<li>blog-post.html – Template for blog post</li>
</ul>
<p>首先查看安装 mkdocs-material 的 site-pacages 目录：</p>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$<span class="w"> </span>mkdocs<span class="w"> </span>-V
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>mkdocs,<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.5.3<span class="w"> </span>from<span class="w"> </span>/usr/local/lib/python3.10/site-packages/mkdocs<span class="w"> </span><span class="o">(</span>Python<span class="w"> </span><span class="m">3</span>.10<span class="o">)</span>
</span></code></pre></div>
<p>在 site-packages 目录下找到 material，其 templates 目录下存放着网页模板文件：</p>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>$<span class="w"> </span>tree<span class="w"> </span>-L<span class="w"> </span><span class="m">1</span><span class="w"> </span>/usr/local/lib/python3.10/site-packages/material/templates
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>/usr/local/lib/python3.10/site-packages/material/templates
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>├──<span class="w"> </span><span class="m">404</span>.html
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>├──<span class="w"> </span>__init__.py
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>├──<span class="w"> </span>__pycache__
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>├──<span class="w"> </span>assets
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>├──<span class="w"> </span>base.html
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="hll">├──<span class="w"> </span>blog-post.html
</span></span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>├──<span class="w"> </span>blog.html
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>├──<span class="w"> </span>main.html
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>├──<span class="w"> </span>mkdocs_theme.yml
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>├──<span class="w"> </span>partials
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>└──<span class="w"> </span>redirect.html
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="m">4</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">8</span><span class="w"> </span>files
</span></code></pre></div>
<p>复制 templates/blog-post.html 到 overrides/blog-post.html，在 page.config.readtime，即 【需要 x 分钟阅读时间】后面添加一行【阅读量：N】：</p>
<div class="language-html highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>                    {% if page.config.readtime %}
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>                      {% set time = page.config.readtime %}
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>                      <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;md-nav__item&quot;</span><span class="p">&gt;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;md-nav__link&quot;</span><span class="p">&gt;</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>                          {% include &quot;.icons/material/clock-outline.svg&quot; %}
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>                          <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;md-ellipsis&quot;</span><span class="p">&gt;</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>                            {% if time == 1 %}
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>                              {{ lang.t(&quot;readtime.one&quot;) }}
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>                            {% else %}
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>                              {{ lang.t(&quot;readtime.other&quot;) | replace(&quot;#&quot;, time) }}
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>                            {% endif %}
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>                          <span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>                      <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>                    {% endif %}
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="hll">                    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;md-nav__item&quot;</span><span class="p">&gt;</span>
</span></span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="hll">                      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;md-nav__link&quot;</span><span class="p">&gt;</span>
</span></span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="hll">                        {% include &quot;.icons/material/book-open-page-variant-outline.svg&quot; %}
</span></span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="hll">                        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;md-ellipsis&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_container_page_pv&quot;</span><span class="p">&gt;</span>
</span></span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="hll">                          阅读量：<span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_value_page_pv&quot;</span><span class="p">&gt;</span>N/A<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="hll">                        <span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="hll">                      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="hll">                    <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span></span></code></pre></div>
<p>从本地调试来看，文章阅读量貌似正确，上线确认桌面 Chrome 没问题。<br />
但是 iPhone/iPad Safari 不准确，貌似是多篇全局累计。</p>
<blockquote>
<p>注意：mkdocs-material 包升级时，会覆写掉 blog-post.html！</p>
</blockquote>
<h3 id="替换为_vercount">替换为 Vercount<a class="headerlink" href="#替换为_vercount" title="Permanent link">#</a></h3>
<ul>
<li><a href="https://jdhao.github.io/2020/10/31/busuanzi_pv_count_error/">解决不蒜子 (busuanzi) 文章计数出错问题</a></li>
<li><a href="https://ohevan.com/vercount-website-counter-busuanzi-alternative.html">Vercount: 一个比不蒜子更好的网站计数器</a></li>
</ul>
<p>从不蒜子切换到 <a href="https://vercount.one/">Vercount</a> @<a href="https://github.com/EvanNotFound/vercount">github</a>，只需直接替换不蒜子的 script 标签即可，不需要修改任何代码。数据会在初次访问时自动从不蒜子同步。</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">海外访问优化版本</label><label for="__tabbed_1_2">中国访问优化版本</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-html highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">defer</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://vercount.one/js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-html highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">defer</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cn.vercount.one/js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></code></pre></div>
</div>
</div>
</div>
<p>将 mkdocs.yml 中的 <code>extra_javascript</code> 部分替换 busuanzi statistics 脚本为 https://vercount.one/js。</p>
<div class="language-YAML highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nt">extra_javascript</span><span class="p">:</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="c1"># busuanzi statistics</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://vercount.one/js</span>
</span></code></pre></div>
<p>添加以上脚本之后，复用不蒜子的 pv/uv id，在 html 中插入以下统计标签，即可开始为你的网站统计访问量和访客量。</p>
<div class="admonition note">
<div class="language-html highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>本文总阅读量 <span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_value_page_pv&quot;</span><span class="p">&gt;</span>Loading<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> 次
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>本文总访客量 <span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_value_page_uv&quot;</span><span class="p">&gt;</span>Loading<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> 人
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>本站总访问量 <span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_value_site_pv&quot;</span><span class="p">&gt;</span>Loading<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> 次
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>本站总访客数 <span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;busuanzi_value_site_uv&quot;</span><span class="p">&gt;</span>Loading<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> 人
</span></code></pre></div>
</div>







  
  



  


  



  <h2 id="__comments">评论</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
    data-repo="fan2/mkdocs"
    data-repo-id="R_kgDOLltxSg"
    data-category="Announcements"
    data-category-id="DIC_kwDOLltxSs4CeURH"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="zh-CN"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../13-github-giscus/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 为Material博客配置giscus评论插件">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                为Material博客配置giscus评论插件
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024- Cliff Fan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["toc.follow", "header.autohide", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.tracking", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://vercount.one/js"></script>
      
    
  </body>
</html>